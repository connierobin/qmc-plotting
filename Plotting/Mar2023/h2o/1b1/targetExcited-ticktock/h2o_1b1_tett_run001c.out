Rank =    0  Free Memory = 90182 MB
Rank =    1  Free Memory = 90181 MB
Rank =    2  Free Memory = 90181 MB
Rank =    3  Free Memory = 90180 MB
Rank =    4  Free Memory = 90180 MB
Rank =    5  Free Memory = 90180 MB
Rank =    6  Free Memory = 90179 MB
Rank =    7  Free Memory = 90179 MB
Rank =    8  Free Memory = 90179 MB
Rank =    9  Free Memory = 90179 MB
Rank =   10  Free Memory = 90179 MB
Rank =   11  Free Memory = 90179 MB
Rank =   12  Free Memory = 90179 MB
Rank =   13  Free Memory = 90179 MB
Rank =   14  Free Memory = 90178 MB
Rank =   15  Free Memory = 90164 MB
Rank =   16  Free Memory = 90164 MB
Rank =   17  Free Memory = 90164 MB
Rank =   18  Free Memory = 90164 MB
Rank =   19  Free Memory = 90164 MB
Rank =   20  Free Memory = 90164 MB
Rank =   21  Free Memory = 90164 MB
Rank =   22  Free Memory = 90164 MB
Rank =   23  Free Memory = 90164 MB
Rank =   24  Free Memory = 90164 MB
Rank =   25  Free Memory = 90164 MB
Rank =   26  Free Memory = 90164 MB
Rank =   27  Free Memory = 90164 MB
Rank =   28  Free Memory = 90164 MB
Rank =   29  Free Memory = 90164 MB
Rank =   30  Free Memory = 90164 MB
Rank =   31  Free Memory = 90164 MB
Rank =   32  Free Memory = 89183 MB
Rank =   33  Free Memory = 89183 MB
Rank =   34  Free Memory = 89183 MB
Rank =   35  Free Memory = 89183 MB
Rank =   36  Free Memory = 89183 MB
Rank =   37  Free Memory = 89183 MB
Rank =   38  Free Memory = 89183 MB
Rank =   39  Free Memory = 89183 MB
Rank =   40  Free Memory = 89183 MB
Rank =   41  Free Memory = 89183 MB
Rank =   42  Free Memory = 89183 MB
Rank =   43  Free Memory = 89183 MB
Rank =   44  Free Memory = 89183 MB
Rank =   45  Free Memory = 89183 MB
Rank =   46  Free Memory = 89183 MB
Rank =   47  Free Memory = 89183 MB
Rank =   48  Free Memory = 89183 MB
Rank =   49  Free Memory = 89183 MB
Rank =   50  Free Memory = 89183 MB
Rank =   51  Free Memory = 89183 MB
Rank =   52  Free Memory = 89183 MB
Rank =   53  Free Memory = 89183 MB
Rank =   54  Free Memory = 89183 MB
Rank =   55  Free Memory = 89183 MB
Rank =   56  Free Memory = 89183 MB
Rank =   57  Free Memory = 89183 MB
Rank =   58  Free Memory = 89183 MB
Rank =   59  Free Memory = 89183 MB
Rank =   60  Free Memory = 89183 MB
Rank =   61  Free Memory = 89183 MB
Rank =   62  Free Memory = 89183 MB
Rank =   63  Free Memory = 89183 MB
Rank =   64  Free Memory = 89891 MB
Rank =   65  Free Memory = 89891 MB
Rank =   66  Free Memory = 89891 MB
Rank =   67  Free Memory = 89891 MB
Rank =   68  Free Memory = 89891 MB
Rank =   69  Free Memory = 89891 MB
Rank =   70  Free Memory = 89890 MB
Rank =   71  Free Memory = 89890 MB
Rank =   72  Free Memory = 89890 MB
Rank =   73  Free Memory = 89890 MB
Rank =   74  Free Memory = 89890 MB
Rank =   75  Free Memory = 89890 MB
Rank =   76  Free Memory = 89890 MB
Rank =   77  Free Memory = 89890 MB
Rank =   78  Free Memory = 89890 MB
Rank =   79  Free Memory = 89890 MB
Rank =   80  Free Memory = 89890 MB
Rank =   81  Free Memory = 89890 MB
Rank =   82  Free Memory = 89890 MB
Rank =   83  Free Memory = 89890 MB
Rank =   84  Free Memory = 89890 MB
Rank =   85  Free Memory = 89890 MB
Rank =   86  Free Memory = 89890 MB
Rank =   87  Free Memory = 89890 MB
Rank =   88  Free Memory = 89890 MB
Rank =   89  Free Memory = 89890 MB
Rank =   90  Free Memory = 89890 MB
Rank =   91  Free Memory = 89890 MB
Rank =   92  Free Memory = 89890 MB
Rank =   93  Free Memory = 89890 MB
Rank =   94  Free Memory = 89890 MB
Rank =   95  Free Memory = 89890 MB
Rank =   96  Free Memory = 90381 MB
Rank =   97  Free Memory = 90381 MB
Rank =   98  Free Memory = 90381 MB
Rank =   99  Free Memory = 90381 MB
Rank =  100  Free Memory = 90381 MB
Rank =  101  Free Memory = 90381 MB
Rank =  102  Free Memory = 90381 MB
Rank =  103  Free Memory = 90381 MB
Rank =  104  Free Memory = 90381 MB
Rank =  105  Free Memory = 90381 MB
Rank =  106  Free Memory = 90381 MB
Rank =  107  Free Memory = 90381 MB
Rank =  108  Free Memory = 90381 MB
Rank =  109  Free Memory = 90381 MB
Rank =  110  Free Memory = 90381 MB
Rank =  111  Free Memory = 90381 MB
Rank =  112  Free Memory = 90381 MB
Rank =  113  Free Memory = 90381 MB
Rank =  114  Free Memory = 90381 MB
Rank =  115  Free Memory = 90381 MB
Rank =  116  Free Memory = 90381 MB
Rank =  117  Free Memory = 90381 MB
Rank =  118  Free Memory = 90381 MB
Rank =  119  Free Memory = 90381 MB
Rank =  120  Free Memory = 90381 MB
Rank =  121  Free Memory = 90381 MB
Rank =  122  Free Memory = 90381 MB
Rank =  123  Free Memory = 90381 MB
Rank =  124  Free Memory = 90381 MB
Rank =  125  Free Memory = 90381 MB
Rank =  126  Free Memory = 90381 MB
Rank =  127  Free Memory = 90381 MB
  Input file(s): opt_h2o_1b1_tett_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_tett_run001c.xml

  Project = H2O
  date    = 2023-03-06 20:02:38 PST
  host    = n0014.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 862

  Range of prime numbers to use as seeds over processors and threads = 6701-7853


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.517233e-01    1         1 OFF
     uu_1                 1.009440e-01    1         1 OFF
     uu_2                 1.617079e-02    1         1 OFF
     uu_3                -3.223684e-02    1         1 OFF
     uu_4                -6.387117e-02    1         1 OFF
     uu_5                -8.576607e-02    1         1 OFF
     uu_6                -1.001312e-01    1         1 OFF
     uu_7                -1.065673e-01    1         1 OFF
     uu_8                -9.668739e-02    1         1 OFF
     uu_9                -6.389513e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.492134e-01    1         1 OFF
     ud_1                 1.235409e-01    1         1 OFF
     ud_2                 2.392782e-02    1         1 OFF
     ud_3                -3.019578e-02    1         1 OFF
     ud_4                -6.975615e-02    1         1 OFF
     ud_5                -9.484122e-02    1         1 OFF
     ud_6                -1.085598e-01    1         1 OFF
     ud_7                -1.109505e-01    1         1 OFF
     ud_8                -9.792103e-02    1         1 OFF
     ud_9                -6.281979e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -5.692885e-01    1         1 OFF
     eO_1                -3.060844e-01    1         1 OFF
     eO_2                 4.730127e-02    1         1 OFF
     eO_3                 2.840620e-01    1         1 OFF
     eO_4                 3.913445e-01    1         1 OFF
     eO_5                 3.212389e-01    1         1 OFF
     eO_6                 1.205694e-01    1         1 OFF
     eO_7                -7.888705e-02    1         1 OFF
     eO_8                -1.549102e-01    1         1 OFF
     eO_9                -6.122098e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.277697e-01    1         1 OFF
     eH1_1                -1.106400e-01    1         1 OFF
     eH1_2                -6.162952e-02    1         1 OFF
     eH1_3                -2.530653e-02    1         1 OFF
     eH1_4                 4.247832e-03    1         1 OFF
     eH1_5                 2.367079e-02    1         1 OFF
     eH1_6                 6.569443e-02    1         1 OFF
     eH1_7                 1.154361e-01    1         1 OFF
     eH1_8                 1.435221e-01    1         1 OFF
     eH1_9                 7.467419e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.307043e-01    1         1 OFF
     eH2_1                -1.139386e-01    1         1 OFF
     eH2_2                -6.444539e-02    1         1 OFF
     eH2_3                -2.722663e-02    1         1 OFF
     eH2_4                 1.073593e-03    1         1 OFF
     eH2_5                 2.532957e-02    1         1 OFF
     eH2_6                 7.564477e-02    1         1 OFF
     eH2_7                 1.260027e-01    1         1 OFF
     eH2_8                 1.609124e-01    1         1 OFF
     eH2_9                 6.417217e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.916972e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8998e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8673
    reference variance = 0.232662
====================================================
  Execution time = 1.4926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5207e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9358e-01
  Total weights = 1.950929284e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282917119652
                                         uncertainty =       0.001398403591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282917119652
                                         uncertainty =       0.001398403591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376071962
  error estimate for blocks of size 2^( 2) =       0.000393476868
  error estimate for blocks of size 2^( 3) =       0.000411087086
  error estimate for blocks of size 2^( 4) =       0.000426417604
  error estimate for blocks of size 2^( 5) =       0.000436926238
  error estimate for blocks of size 2^( 6) =       0.000444669990
  error estimate for blocks of size 2^( 7) =       0.000449798468

      target function =      -0.922781325781
              le_mean =     -16.898302945481
             les_mean =     285.846222378446
             stat err =       0.000439453075
             autocorr =       1.365472959031
   target nu stat err =       0.000439453075
   target dn stat err =       0.002227292418
      target stat err =       0.003568246948
              std dev =       0.531846068871
             le_variance =       0.282860240973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.689830294548e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922793762357       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923086129966       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923169546107       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923228183894       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923241670216       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923247468562       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923249655494       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923250197838       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923250360273       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923250784929       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923251121215       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923252090722       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923252673224       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923253128810       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923253153775       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923253332840       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923253413483       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923253413064       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923253396907       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923253394577       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 2.019265e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922793762357       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922882739857       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922906772076       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922922780692       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922926210809       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922927544382       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922928043364       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922928171093       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922928205788       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922928316283       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922928406386       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922928651455       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922928750559       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922928826989       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922928831857       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922928862378       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922928874817       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922928872498       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 5.670797e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922793762357       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922817284379       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922823526578       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922827615496       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922828471854       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922828793952       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922828914495       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922828945785       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922828954078       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922828982054       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922829005014       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922829065674       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922829087104       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922829104036       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922829105238       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922829111984       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922829114633       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922829113989       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.462647e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7799e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.023750e-01                 3 1 ON  0
ci_0002 6.986091e-01                 3 1 ON  1
ci_0003 -3.181659e-02                3 1 ON  2
ci_0004 -3.143599e-02                3 1 ON  3
ci_0005 -2.860002e-02                3 1 ON  4
ci_0006 -2.977368e-02                3 1 ON  5
ci_0007 -1.639546e-02                3 1 ON  6
ci_0008 -1.715367e-02                3 1 ON  7
ci_0009 -1.890836e-02                3 1 ON  8
ci_0010 -1.902355e-02                3 1 ON  9
ci_0011 -1.579084e-02                3 1 ON  10
ci_0012 -1.571056e-02                3 1 ON  11
ci_0013 1.562530e-02                 3 1 ON  12
ci_0014 1.556767e-02                 3 1 ON  13
ci_0015 1.650138e-02                 3 1 ON  14
ci_0016 1.612919e-02                 3 1 ON  15
ci_0017 1.378326e-02                 3 1 ON  16
ci_0018 1.409138e-02                 3 1 ON  17
ci_0019 1.248315e-02                 3 1 ON  18
ci_0020 1.212946e-02                 3 1 ON  19
ci_0021 1.482775e-02                 3 1 ON  20
ci_0022 1.594903e-02                 3 1 ON  21
ci_0023 -1.176933e-02                3 1 ON  22
ci_0024 -1.104126e-02                3 1 ON  23
ci_0025 -2.925918e-03                3 1 ON  24
ci_0026 -2.711698e-03                3 1 ON  25
ci_0027 -1.166090e-02                3 1 ON  26
ci_0028 -1.171191e-02                3 1 ON  27
ci_0029 -1.036475e-02                3 1 ON  28
ci_0030 -1.031366e-02                3 1 ON  29
ci_0031 1.406348e-02                 3 1 ON  30
ci_0032 1.304851e-02                 3 1 ON  31
ci_0033 8.461782e-03                 3 1 ON  32
ci_0034 8.698049e-03                 3 1 ON  33
ci_0035 4.866376e-03                 3 1 ON  34
ci_0036 4.796755e-03                 3 1 ON  35
ci_0037 -1.148657e-02                3 1 ON  36
ci_0038 -1.136534e-02                3 1 ON  37
ci_0039 -3.815450e-03                3 1 ON  38
ci_0040 -3.932025e-03                3 1 ON  39
ci_0041 9.584026e-03                 3 1 ON  40
ci_0042 9.510113e-03                 3 1 ON  41
ci_0043 -6.608623e-03                3 1 ON  42
ci_0044 -7.187517e-03                3 1 ON  43
ci_0045 1.044082e-02                 3 1 ON  44
ci_0046 9.439196e-03                 3 1 ON  45
ci_0047 -3.649091e-03                3 1 ON  46
ci_0048 -3.607097e-03                3 1 ON  47
ci_0049 -2.285312e-03                3 1 ON  48
ci_0050 -2.915649e-03                3 1 ON  49
ci_0051 -1.820866e-03                3 1 ON  50
ci_0052 -1.728166e-03                3 1 ON  51
ci_0053 -4.016918e-03                3 1 ON  52
ci_0054 -3.884816e-03                3 1 ON  53
ci_0055 2.504139e-03                 3 1 ON  54
ci_0056 2.067818e-03                 3 1 ON  55
ci_0057 2.423968e-03                 3 1 ON  56
ci_0058 3.094077e-03                 3 1 ON  57
ci_0059 -4.072424e-03                3 1 ON  58
ci_0060 -3.680173e-03                3 1 ON  59
ci_0061 -2.972299e-03                3 1 ON  60
ci_0062 -3.130578e-03                3 1 ON  61
ci_0063 -9.723129e-03                3 1 ON  62
ci_0064 -9.673823e-03                3 1 ON  63
ci_0065 -7.099308e-03                3 1 ON  64
ci_0066 -6.591899e-03                3 1 ON  65
ci_0067 -3.981909e-03                3 1 ON  66
ci_0068 -3.921192e-03                3 1 ON  67
ci_0069 3.740125e-03                 3 1 ON  68
ci_0070 3.504510e-03                 3 1 ON  69
ci_0071 4.382625e-03                 3 1 ON  70
ci_0072 4.449678e-03                 3 1 ON  71
ci_0073 3.385846e-03                 3 1 ON  72
ci_0074 3.222365e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9325
    reference variance = 0.207623
====================================================
  Execution time = 1.4235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9362e-01
  Total weights = 1.9508e+06
  Execution time = 1.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284024624303
                                         uncertainty =       0.002186394911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284024624303
                                         uncertainty =       0.002186394911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376844648
  error estimate for blocks of size 2^( 2) =       0.000394269056
  error estimate for blocks of size 2^( 3) =       0.000412353908
  error estimate for blocks of size 2^( 4) =       0.000427590654
  error estimate for blocks of size 2^( 5) =       0.000440914323
  error estimate for blocks of size 2^( 6) =       0.000448991322
  error estimate for blocks of size 2^( 7) =       0.000451581978

      target function =      -0.920575895448
              le_mean =     -16.897737271221
             les_mean =     285.828506326969
             stat err =       0.000442269569
             autocorr =       1.377366172886
   target nu stat err =       0.000442269569
   target dn stat err =       0.003196010531
      target stat err =       0.005033931935
              std dev =       0.532938812351
             le_variance =       0.284023777710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283524756456
                                         uncertainty =       0.002154203244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283524756456
                                         uncertainty =       0.002154203244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376513466
  error estimate for blocks of size 2^( 2) =       0.000393891045
  error estimate for blocks of size 2^( 3) =       0.000411915108
  error estimate for blocks of size 2^( 4) =       0.000427076996
  error estimate for blocks of size 2^( 5) =       0.000440354196
  error estimate for blocks of size 2^( 6) =       0.000448401702
  error estimate for blocks of size 2^( 7) =       0.000450999340

      target function =      -0.917605259898
              le_mean =     -16.897747278901
             les_mean =     285.830723055868
             stat err =       0.000441708058
             autocorr =       1.376288934448
   target nu stat err =       0.000441708058
   target dn stat err =       0.005564505827
      target stat err =       0.008644078514
              std dev =       0.532470450164
             le_variance =       0.283524780298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283714139711
                                         uncertainty =       0.002168008896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283714139711
                                         uncertainty =       0.002168008896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376638948
  error estimate for blocks of size 2^( 2) =       0.000394037019
  error estimate for blocks of size 2^( 3) =       0.000412087347
  error estimate for blocks of size 2^( 4) =       0.000427281298
  error estimate for blocks of size 2^( 5) =       0.000440579202
  error estimate for blocks of size 2^( 6) =       0.000448640797
  error estimate for blocks of size 2^( 7) =       0.000451236514

      target function =      -0.921363929906
              le_mean =     -16.897737847581
             les_mean =     285.828016372613
             stat err =       0.000441934453
             autocorr =       1.376782271333
   target nu stat err =       0.000441934453
   target dn stat err =       0.003539215769
      target stat err =       0.005572534751
              std dev =       0.532647907788
             le_variance =       0.283713793670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283980300349
                                         uncertainty =       0.002183953007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283980300349
                                         uncertainty =       0.002183953007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376815287
  error estimate for blocks of size 2^( 2) =       0.000394236192
  error estimate for blocks of size 2^( 3) =       0.000412316370
  error estimate for blocks of size 2^( 4) =       0.000427547237
  error estimate for blocks of size 2^( 5) =       0.000440867573
  error estimate for blocks of size 2^( 6) =       0.000448942551
  error estimate for blocks of size 2^( 7) =       0.000451533807

      target function =      -0.922255995988
              le_mean =     -16.897736553528
             les_mean =     285.827408830693
             stat err =       0.000442222792
             autocorr =       1.377289441161
   target nu stat err =       0.000442222792
   target dn stat err =       0.002853139663
      target stat err =       0.004522711572
              std dev =       0.532897289065
             le_variance =       0.283979520693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920575895448        initial
     2.5000e-01     2.5000e+00             2.0193e-03        -0.917605259898
     1.0000e+00     1.0000e+01             5.6708e-04        -0.921363929906
     4.0000e+00     4.0000e+01             1.4626e-04        -0.922255995988  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.4000e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.025658e-01 3 1  ON 0
ci_0002                 6.983985e-01 3 1  ON 1
ci_0003                -3.181712e-02 3 1  ON 2
ci_0004                -3.147499e-02 3 1  ON 3
ci_0005                -2.846857e-02 3 1  ON 4
ci_0006                -2.966278e-02 3 1  ON 5
ci_0007                -1.643329e-02 3 1  ON 6
ci_0008                -1.720200e-02 3 1  ON 7
ci_0009                -1.894569e-02 3 1  ON 8
ci_0010                -1.907801e-02 3 1  ON 9
ci_0011                -1.578566e-02 3 1  ON 10
ci_0012                -1.577106e-02 3 1  ON 11
ci_0013                 1.566914e-02 3 1  ON 12
ci_0014                 1.560124e-02 3 1  ON 13
ci_0015                 1.648432e-02 3 1  ON 14
ci_0016                 1.617835e-02 3 1  ON 15
ci_0017                 1.383018e-02 3 1  ON 16
ci_0018                 1.413649e-02 3 1  ON 17
ci_0019                 1.245035e-02 3 1  ON 18
ci_0020                 1.207208e-02 3 1  ON 19
ci_0021                 1.524856e-02 3 1  ON 20
ci_0022                 1.629511e-02 3 1  ON 21
ci_0023                -1.177578e-02 3 1  ON 22
ci_0024                -1.103833e-02 3 1  ON 23
ci_0025                -2.972358e-03 3 1  ON 24
ci_0026                -2.671611e-03 3 1  ON 25
ci_0027                -1.172474e-02 3 1  ON 26
ci_0028                -1.171887e-02 3 1  ON 27
ci_0029                -1.034546e-02 3 1  ON 28
ci_0030                -1.029412e-02 3 1  ON 29
ci_0031                 1.406880e-02 3 1  ON 30
ci_0032                 1.308697e-02 3 1  ON 31
ci_0033                 8.462708e-03 3 1  ON 32
ci_0034                 8.669598e-03 3 1  ON 33
ci_0035                 4.998044e-03 3 1  ON 34
ci_0036                 4.818723e-03 3 1  ON 35
ci_0037                -1.144731e-02 3 1  ON 36
ci_0038                -1.139353e-02 3 1  ON 37
ci_0039                -3.807127e-03 3 1  ON 38
ci_0040                -3.933107e-03 3 1  ON 39
ci_0041                 9.622686e-03 3 1  ON 40
ci_0042                 9.526980e-03 3 1  ON 41
ci_0043                -6.411936e-03 3 1  ON 42
ci_0044                -6.881176e-03 3 1  ON 43
ci_0045                 1.045464e-02 3 1  ON 44
ci_0046                 9.397965e-03 3 1  ON 45
ci_0047                -3.645559e-03 3 1  ON 46
ci_0048                -3.598211e-03 3 1  ON 47
ci_0049                -2.446351e-03 3 1  ON 48
ci_0050                -2.847546e-03 3 1  ON 49
ci_0051                -1.831924e-03 3 1  ON 50
ci_0052                -1.719230e-03 3 1  ON 51
ci_0053                -4.031055e-03 3 1  ON 52
ci_0054                -3.924026e-03 3 1  ON 53
ci_0055                 2.507043e-03 3 1  ON 54
ci_0056                 2.125757e-03 3 1  ON 55
ci_0057                 2.399943e-03 3 1  ON 56
ci_0058                 3.117001e-03 3 1  ON 57
ci_0059                -4.064082e-03 3 1  ON 58
ci_0060                -3.661708e-03 3 1  ON 59
ci_0061                -2.893812e-03 3 1  ON 60
ci_0062                -3.092967e-03 3 1  ON 61
ci_0063                -9.736822e-03 3 1  ON 62
ci_0064                -9.702953e-03 3 1  ON 63
ci_0065                -7.159688e-03 3 1  ON 64
ci_0066                -6.624431e-03 3 1  ON 65
ci_0067                -3.959577e-03 3 1  ON 66
ci_0068                -3.948155e-03 3 1  ON 67
ci_0069                 3.802944e-03 3 1  ON 68
ci_0070                 3.560683e-03 3 1  ON 69
ci_0071                 4.381606e-03 3 1  ON 70
ci_0072                 4.597775e-03 3 1  ON 71
ci_0073                 3.392045e-03 3 1  ON 72
ci_0074                 3.198143e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1806e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9264
    reference variance = 0.191576
====================================================
  Execution time = 1.4496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9820e-01
  Total weights = 1.950700697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283494399913
                                         uncertainty =       0.001601721617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283494399913
                                         uncertainty =       0.001601721617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376499389
  error estimate for blocks of size 2^( 2) =       0.000394250231
  error estimate for blocks of size 2^( 3) =       0.000411995020
  error estimate for blocks of size 2^( 4) =       0.000427912014
  error estimate for blocks of size 2^( 5) =       0.000440903476
  error estimate for blocks of size 2^( 6) =       0.000449348315
  error estimate for blocks of size 2^( 7) =       0.000456030676

      target function =      -0.915567125663
              le_mean =     -16.897202674551
             les_mean =     285.813655237481
             stat err =       0.000443548620
             autocorr =       1.387886383384
   target nu stat err =       0.000443548620
   target dn stat err =       0.004695524073
      target stat err =       0.007265731526
              std dev =       0.532450541511
             le_variance =       0.283503579155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689720267455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915623339392       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915701602205       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915717045890       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915727619858       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915734311657       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915738098079       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915739383930       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915740807433       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915742093857       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915742921422       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915743967041       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915744607544       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915744627273       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915744700922       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915744709863       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915744711890       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915744695058       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915744700597       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915744693768       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 7.039487e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915623339392       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915644002651       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915648033148       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915650743271       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915652445235       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915653394962       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915653717453       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915654083201       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915654397911       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915654589575       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915654831333       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915654979094       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915654978816       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915654993809       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915654995447       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915654995742       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915654991883       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915654993058       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915654991551       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.763363e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915623339392       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915628578676       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915629597458       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915630279193       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915630706461       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915630944010       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915631024678       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915631116757       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915631194908       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915631241805       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915631300984       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915631337146       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915631336768       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915631340316       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915631340692       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915631340754       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915631339812       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915631340093       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.6000e+01 is 4.410519e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7072e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.027421e-01 3 1  ON 0
ci_0002                 6.982264e-01 3 1  ON 1
ci_0003                -3.180748e-02 3 1  ON 2
ci_0004                -3.150580e-02 3 1  ON 3
ci_0005                -2.851773e-02 3 1  ON 4
ci_0006                -2.965453e-02 3 1  ON 5
ci_0007                -1.640007e-02 3 1  ON 6
ci_0008                -1.715437e-02 3 1  ON 7
ci_0009                -1.893373e-02 3 1  ON 8
ci_0010                -1.905615e-02 3 1  ON 9
ci_0011                -1.576921e-02 3 1  ON 10
ci_0012                -1.577295e-02 3 1  ON 11
ci_0013                 1.566214e-02 3 1  ON 12
ci_0014                 1.557766e-02 3 1  ON 13
ci_0015                 1.646859e-02 3 1  ON 14
ci_0016                 1.616232e-02 3 1  ON 15
ci_0017                 1.383103e-02 3 1  ON 16
ci_0018                 1.412342e-02 3 1  ON 17
ci_0019                 1.245559e-02 3 1  ON 18
ci_0020                 1.209585e-02 3 1  ON 19
ci_0021                 1.515977e-02 3 1  ON 20
ci_0022                 1.629125e-02 3 1  ON 21
ci_0023                -1.178075e-02 3 1  ON 22
ci_0024                -1.105375e-02 3 1  ON 23
ci_0025                -2.966836e-03 3 1  ON 24
ci_0026                -2.626484e-03 3 1  ON 25
ci_0027                -1.172432e-02 3 1  ON 26
ci_0028                -1.170671e-02 3 1  ON 27
ci_0029                -1.035128e-02 3 1  ON 28
ci_0030                -1.029372e-02 3 1  ON 29
ci_0031                 1.403255e-02 3 1  ON 30
ci_0032                 1.307680e-02 3 1  ON 31
ci_0033                 8.404755e-03 3 1  ON 32
ci_0034                 8.654273e-03 3 1  ON 33
ci_0035                 4.974744e-03 3 1  ON 34
ci_0036                 4.809957e-03 3 1  ON 35
ci_0037                -1.144115e-02 3 1  ON 36
ci_0038                -1.139086e-02 3 1  ON 37
ci_0039                -3.805094e-03 3 1  ON 38
ci_0040                -3.931382e-03 3 1  ON 39
ci_0041                 9.626169e-03 3 1  ON 40
ci_0042                 9.542422e-03 3 1  ON 41
ci_0043                -6.527680e-03 3 1  ON 42
ci_0044                -6.923899e-03 3 1  ON 43
ci_0045                 1.044112e-02 3 1  ON 44
ci_0046                 9.432203e-03 3 1  ON 45
ci_0047                -3.645192e-03 3 1  ON 46
ci_0048                -3.620302e-03 3 1  ON 47
ci_0049                -2.426153e-03 3 1  ON 48
ci_0050                -2.820107e-03 3 1  ON 49
ci_0051                -1.839991e-03 3 1  ON 50
ci_0052                -1.719435e-03 3 1  ON 51
ci_0053                -4.019326e-03 3 1  ON 52
ci_0054                -3.896106e-03 3 1  ON 53
ci_0055                 2.489573e-03 3 1  ON 54
ci_0056                 2.141892e-03 3 1  ON 55
ci_0057                 2.379395e-03 3 1  ON 56
ci_0058                 3.086738e-03 3 1  ON 57
ci_0059                -4.056684e-03 3 1  ON 58
ci_0060                -3.673455e-03 3 1  ON 59
ci_0061                -2.911961e-03 3 1  ON 60
ci_0062                -3.125499e-03 3 1  ON 61
ci_0063                -9.732971e-03 3 1  ON 62
ci_0064                -9.700779e-03 3 1  ON 63
ci_0065                -7.136548e-03 3 1  ON 64
ci_0066                -6.607238e-03 3 1  ON 65
ci_0067                -3.960827e-03 3 1  ON 66
ci_0068                -3.927851e-03 3 1  ON 67
ci_0069                 3.798402e-03 3 1  ON 68
ci_0070                 3.564694e-03 3 1  ON 69
ci_0071                 4.366272e-03 3 1  ON 70
ci_0072                 4.550438e-03 3 1  ON 71
ci_0073                 3.385524e-03 3 1  ON 72
ci_0074                 3.212009e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9143
    reference variance = 0.221789
====================================================
  Execution time = 1.4191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0848e-01
  Total weights = 1.9510e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294867387149
                                         uncertainty =       0.007791799265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294867387149
                                         uncertainty =       0.007791799265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383883114
  error estimate for blocks of size 2^( 2) =       0.000400982453
  error estimate for blocks of size 2^( 3) =       0.000418701460
  error estimate for blocks of size 2^( 4) =       0.000434599340
  error estimate for blocks of size 2^( 5) =       0.000447099788
  error estimate for blocks of size 2^( 6) =       0.000454398791
  error estimate for blocks of size 2^( 7) =       0.000459722787

      target function =      -0.899586464975
              le_mean =     -16.897557564676
             les_mean =     285.836069186286
             stat err =       0.000448955177
             autocorr =       1.367753861393
   target nu stat err =       0.000448955177
   target dn stat err =       0.010352922399
      target stat err =       0.015415258022
              std dev =       0.542892705748
             le_variance =       0.294732489954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294817221689
                                         uncertainty =       0.007847861100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294817221689
                                         uncertainty =       0.007847861100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383850297
  error estimate for blocks of size 2^( 2) =       0.000400942370
  error estimate for blocks of size 2^( 3) =       0.000418647908
  error estimate for blocks of size 2^( 4) =       0.000434534685
  error estimate for blocks of size 2^( 5) =       0.000447020961
  error estimate for blocks of size 2^( 6) =       0.000454308308
  error estimate for blocks of size 2^( 7) =       0.000459625524

      target function =      -0.899930900290
              le_mean =     -16.897555100486
             les_mean =     285.835751751742
             stat err =       0.000448872369
             autocorr =       1.367483152991
   target nu stat err =       0.000448872369
   target dn stat err =       0.010428464700
      target stat err =       0.015539350687
              std dev =       0.542846295616
             le_variance =       0.294682100664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294839541035
                                         uncertainty =       0.007821483275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294839541035
                                         uncertainty =       0.007821483275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383864904
  error estimate for blocks of size 2^( 2) =       0.000400960497
  error estimate for blocks of size 2^( 3) =       0.000418672530
  error estimate for blocks of size 2^( 4) =       0.000434564772
  error estimate for blocks of size 2^( 5) =       0.000447058138
  error estimate for blocks of size 2^( 6) =       0.000454351212
  error estimate for blocks of size 2^( 7) =       0.000459671539

      target function =      -0.896342597341
              le_mean =     -16.897555892814
             les_mean =     285.838193193362
             stat err =       0.000448911415
             autocorr =       1.367616976536
   target nu stat err =       0.000448911415
   target dn stat err =       0.010638120883
      target stat err =       0.015725212398
              std dev =       0.542866953807
             le_variance =       0.294704529535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294863629286
                                         uncertainty =       0.007795546264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294863629286
                                         uncertainty =       0.007795546264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383880657
  error estimate for blocks of size 2^( 2) =       0.000400979482
  error estimate for blocks of size 2^( 3) =       0.000418697522
  error estimate for blocks of size 2^( 4) =       0.000434594345
  error estimate for blocks of size 2^( 5) =       0.000447093902
  error estimate for blocks of size 2^( 6) =       0.000454392360
  error estimate for blocks of size 2^( 7) =       0.000459716672

      target function =      -0.894832046649
              le_mean =     -16.897557448336
             les_mean =     285.839263037629
             stat err =       0.000448949320
             autocorr =       1.367735679622
   target nu stat err =       0.000448949320
   target dn stat err =       0.010865410573
      target stat err =       0.016006671216
              std dev =       0.542889231726
             le_variance =       0.294728717924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899586464975        initial
     1.0000e+00     1.0000e+01             7.0395e-04        -0.899930900290  <--
     4.0000e+00     4.0000e+01             1.7634e-04        -0.896342597341
     1.6000e+01     1.6000e+02             4.4105e-05        -0.894832046649

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.7230e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.032697e-01 3 1  ON 0
ci_0002                 6.977106e-01 3 1  ON 1
ci_0003                -3.178132e-02 3 1  ON 2
ci_0004                -3.159181e-02 3 1  ON 3
ci_0005                -2.865851e-02 3 1  ON 4
ci_0006                -2.962957e-02 3 1  ON 5
ci_0007                -1.630373e-02 3 1  ON 6
ci_0008                -1.701642e-02 3 1  ON 7
ci_0009                -1.890076e-02 3 1  ON 8
ci_0010                -1.899379e-02 3 1  ON 9
ci_0011                -1.572304e-02 3 1  ON 10
ci_0012                -1.577737e-02 3 1  ON 11
ci_0013                 1.564302e-02 3 1  ON 12
ci_0014                 1.551033e-02 3 1  ON 13
ci_0015                 1.642473e-02 3 1  ON 14
ci_0016                 1.611629e-02 3 1  ON 15
ci_0017                 1.383401e-02 3 1  ON 16
ci_0018                 1.408589e-02 3 1  ON 17
ci_0019                 1.247083e-02 3 1  ON 18
ci_0020                 1.216239e-02 3 1  ON 19
ci_0021                 1.490499e-02 3 1  ON 20
ci_0022                 1.628006e-02 3 1  ON 21
ci_0023                -1.179538e-02 3 1  ON 22
ci_0024                -1.109676e-02 3 1  ON 23
ci_0025                -2.951532e-03 3 1  ON 24
ci_0026                -2.500623e-03 3 1  ON 25
ci_0027                -1.172381e-02 3 1  ON 26
ci_0028                -1.167187e-02 3 1  ON 27
ci_0029                -1.036847e-02 3 1  ON 28
ci_0030                -1.029214e-02 3 1  ON 29
ci_0031                 1.392892e-02 3 1  ON 30
ci_0032                 1.304729e-02 3 1  ON 31
ci_0033                 8.239207e-03 3 1  ON 32
ci_0034                 8.610050e-03 3 1  ON 33
ci_0035                 4.909922e-03 3 1  ON 34
ci_0036                 4.785395e-03 3 1  ON 35
ci_0037                -1.142404e-02 3 1  ON 36
ci_0038                -1.138287e-02 3 1  ON 37
ci_0039                -3.799617e-03 3 1  ON 38
ci_0040                -3.926329e-03 3 1  ON 39
ci_0041                 9.636456e-03 3 1  ON 40
ci_0042                 9.585790e-03 3 1  ON 41
ci_0043                -6.860934e-03 3 1  ON 42
ci_0044                -7.046968e-03 3 1  ON 43
ci_0045                 1.040285e-02 3 1  ON 44
ci_0046                 9.529349e-03 3 1  ON 45
ci_0047                -3.644309e-03 3 1  ON 46
ci_0048                -3.681847e-03 3 1  ON 47
ci_0049                -2.370042e-03 3 1  ON 48
ci_0050                -2.743731e-03 3 1  ON 49
ci_0051                -1.862358e-03 3 1  ON 50
ci_0052                -1.719920e-03 3 1  ON 51
ci_0053                -3.986874e-03 3 1  ON 52
ci_0054                -3.818299e-03 3 1  ON 53
ci_0055                 2.441003e-03 3 1  ON 54
ci_0056                 2.186790e-03 3 1  ON 55
ci_0057                 2.322002e-03 3 1  ON 56
ci_0058                 3.002234e-03 3 1  ON 57
ci_0059                -4.036285e-03 3 1  ON 58
ci_0060                -3.705961e-03 3 1  ON 59
ci_0061                -2.963374e-03 3 1  ON 60
ci_0062                -3.216977e-03 3 1  ON 61
ci_0063                -9.722275e-03 3 1  ON 62
ci_0064                -9.694031e-03 3 1  ON 63
ci_0065                -7.071525e-03 3 1  ON 64
ci_0066                -6.558479e-03 3 1  ON 65
ci_0067                -3.964522e-03 3 1  ON 66
ci_0068                -3.871132e-03 3 1  ON 67
ci_0069                 3.785930e-03 3 1  ON 68
ci_0070                 3.575596e-03 3 1  ON 69
ci_0071                 4.323828e-03 3 1  ON 70
ci_0072                 4.418470e-03 3 1  ON 71
ci_0073                 3.367469e-03 3 1  ON 72
ci_0074                 3.250348e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9949
    reference variance = 0.452316
====================================================
  Execution time = 1.4572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9281e-01
  Total weights = 1.950817781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537869664
                                         uncertainty =       0.001564440556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283537869664
                                         uncertainty =       0.001564440556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376527826
  error estimate for blocks of size 2^( 2) =       0.000394216004
  error estimate for blocks of size 2^( 3) =       0.000412199134
  error estimate for blocks of size 2^( 4) =       0.000427988994
  error estimate for blocks of size 2^( 5) =       0.000439666841
  error estimate for blocks of size 2^( 6) =       0.000447645655
  error estimate for blocks of size 2^( 7) =       0.000451984328

      target function =      -0.923983909087
              le_mean =     -16.897591142693
             les_mean =     285.821395040048
             stat err =       0.000441821455
             autocorr =       1.376890643223
   target nu stat err =       0.000441821455
   target dn stat err =       0.002330606824
      target stat err =       0.003732129438
              std dev =       0.532490758153
             le_variance =       0.283546407518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689759114269e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923997565891       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924148024672       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924213787486       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924261891141       residual = 9.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924284465374       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924290003469       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924291529414       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924292224461       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924292494038       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924292841327       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924293090102       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924293294540       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924293407169       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924293502233       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924293452074       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924293364956       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924293344779       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924293337810       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924293342563       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.688436e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923997565891       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924042940211       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924061787999       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924074744515       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924080519320       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924081803688       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924082161740       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924082325618       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924082376780       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924082458489       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924082515878       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924082561890       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924082570836       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924082581199       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924082567022       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924082550229       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924082547269       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924082546865       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 4.742010e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923997565891       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924009526194       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924014414100       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924017709254       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924019154358       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924019465968       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924019553279       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924019593329       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924019604849       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924019624843       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924019638747       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924019649680       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924019650621       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924019652498       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924019648979       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924019645163       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924019644558       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924019644525       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.223314e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7156e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.031412e-01 3 1  ON 0
ci_0002                 6.978805e-01 3 1  ON 1
ci_0003                -3.166202e-02 3 1  ON 2
ci_0004                -3.152349e-02 3 1  ON 3
ci_0005                -2.869569e-02 3 1  ON 4
ci_0006                -2.974109e-02 3 1  ON 5
ci_0007                -1.611022e-02 3 1  ON 6
ci_0008                -1.682937e-02 3 1  ON 7
ci_0009                -1.881935e-02 3 1  ON 8
ci_0010                -1.896881e-02 3 1  ON 9
ci_0011                -1.563578e-02 3 1  ON 10
ci_0012                -1.565395e-02 3 1  ON 11
ci_0013                 1.556904e-02 3 1  ON 12
ci_0014                 1.545889e-02 3 1  ON 13
ci_0015                 1.638375e-02 3 1  ON 14
ci_0016                 1.608575e-02 3 1  ON 15
ci_0017                 1.376812e-02 3 1  ON 16
ci_0018                 1.403900e-02 3 1  ON 17
ci_0019                 1.246567e-02 3 1  ON 18
ci_0020                 1.221431e-02 3 1  ON 19
ci_0021                 1.443079e-02 3 1  ON 20
ci_0022                 1.582751e-02 3 1  ON 21
ci_0023                -1.188180e-02 3 1  ON 22
ci_0024                -1.112552e-02 3 1  ON 23
ci_0025                -2.906432e-03 3 1  ON 24
ci_0026                -2.492646e-03 3 1  ON 25
ci_0027                -1.177067e-02 3 1  ON 26
ci_0028                -1.168614e-02 3 1  ON 27
ci_0029                -1.033486e-02 3 1  ON 28
ci_0030                -1.030426e-02 3 1  ON 29
ci_0031                 1.386068e-02 3 1  ON 30
ci_0032                 1.298619e-02 3 1  ON 31
ci_0033                 8.243814e-03 3 1  ON 32
ci_0034                 8.644137e-03 3 1  ON 33
ci_0035                 4.936168e-03 3 1  ON 34
ci_0036                 4.750424e-03 3 1  ON 35
ci_0037                -1.139227e-02 3 1  ON 36
ci_0038                -1.132222e-02 3 1  ON 37
ci_0039                -3.814277e-03 3 1  ON 38
ci_0040                -3.889524e-03 3 1  ON 39
ci_0041                 9.576375e-03 3 1  ON 40
ci_0042                 9.582169e-03 3 1  ON 41
ci_0043                -7.277293e-03 3 1  ON 42
ci_0044                -7.470124e-03 3 1  ON 43
ci_0045                 1.035247e-02 3 1  ON 44
ci_0046                 9.551606e-03 3 1  ON 45
ci_0047                -3.656137e-03 3 1  ON 46
ci_0048                -3.645787e-03 3 1  ON 47
ci_0049                -2.341518e-03 3 1  ON 48
ci_0050                -2.777753e-03 3 1  ON 49
ci_0051                -1.890027e-03 3 1  ON 50
ci_0052                -1.709829e-03 3 1  ON 51
ci_0053                -3.981535e-03 3 1  ON 52
ci_0054                -3.833367e-03 3 1  ON 53
ci_0055                 2.421836e-03 3 1  ON 54
ci_0056                 2.196622e-03 3 1  ON 55
ci_0057                 2.487418e-03 3 1  ON 56
ci_0058                 3.022005e-03 3 1  ON 57
ci_0059                -3.962756e-03 3 1  ON 58
ci_0060                -3.699307e-03 3 1  ON 59
ci_0061                -2.953549e-03 3 1  ON 60
ci_0062                -3.267081e-03 3 1  ON 61
ci_0063                -9.742858e-03 3 1  ON 62
ci_0064                -9.651251e-03 3 1  ON 63
ci_0065                -7.061993e-03 3 1  ON 64
ci_0066                -6.540330e-03 3 1  ON 65
ci_0067                -3.982954e-03 3 1  ON 66
ci_0068                -3.880262e-03 3 1  ON 67
ci_0069                 3.775880e-03 3 1  ON 68
ci_0070                 3.544803e-03 3 1  ON 69
ci_0071                 4.254447e-03 3 1  ON 70
ci_0072                 4.460499e-03 3 1  ON 71
ci_0073                 3.355033e-03 3 1  ON 72
ci_0074                 3.234356e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.282925
====================================================
  Execution time = 1.4221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9701e-01
  Total weights = 1.9512e+06
  Execution time = 1.8891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750856528
                                         uncertainty =       0.001822601994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750856528
                                         uncertainty =       0.001822601994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377375573
  error estimate for blocks of size 2^( 2) =       0.000394782490
  error estimate for blocks of size 2^( 3) =       0.000411968905
  error estimate for blocks of size 2^( 4) =       0.000426846739
  error estimate for blocks of size 2^( 5) =       0.000438866761
  error estimate for blocks of size 2^( 6) =       0.000445963133
  error estimate for blocks of size 2^( 7) =       0.000450827830

      target function =      -0.917031555621
              le_mean =     -16.898488102490
             les_mean =     285.856166230566
             stat err =       0.000440626116
             autocorr =       1.363304590338
   target nu stat err =       0.000440626116
   target dn stat err =       0.002969559100
      target stat err =       0.004655841889
              std dev =       0.533689653844
             le_variance =       0.284824646620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284547077804
                                         uncertainty =       0.001802319682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284547077804
                                         uncertainty =       0.001802319682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377239308
  error estimate for blocks of size 2^( 2) =       0.000394623712
  error estimate for blocks of size 2^( 3) =       0.000411732330
  error estimate for blocks of size 2^( 4) =       0.000426574190
  error estimate for blocks of size 2^( 5) =       0.000438548538
  error estimate for blocks of size 2^( 6) =       0.000445610736
  error estimate for blocks of size 2^( 7) =       0.000450456206

      target function =      -0.720930422911
              le_mean =     -16.898505987325
             les_mean =     285.992600096863
             stat err =       0.000440297417
             autocorr =       1.362254956469
   target nu stat err =       0.000440297417
   target dn stat err =       0.135938313895
      target stat err =       0.134561839360
              std dev =       0.533496945903
             le_variance =       0.284618991288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284483153331
                                         uncertainty =       0.001814126421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284483153331
                                         uncertainty =       0.001814126421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377197656
  error estimate for blocks of size 2^( 2) =       0.000394579988
  error estimate for blocks of size 2^( 3) =       0.000411738871
  error estimate for blocks of size 2^( 4) =       0.000426579960
  error estimate for blocks of size 2^( 5) =       0.000438572171
  error estimate for blocks of size 2^( 6) =       0.000445673586
  error estimate for blocks of size 2^( 7) =       0.000450511714

      target function =      -0.915056998878
              le_mean =     -16.898488801183
             les_mean =     285.857467132377
             stat err =       0.000440334358
             autocorr =       1.362784471979
   target nu stat err =       0.000440334358
   target dn stat err =       0.003098169362
      target stat err =       0.004831755796
              std dev =       0.533438040294
             le_variance =       0.284556142833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284712098932
                                         uncertainty =       0.001821288518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284712098932
                                         uncertainty =       0.001821288518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377349828
  error estimate for blocks of size 2^( 2) =       0.000394753699
  error estimate for blocks of size 2^( 3) =       0.000411936476
  error estimate for blocks of size 2^( 4) =       0.000426809698
  error estimate for blocks of size 2^( 5) =       0.000438826233
  error estimate for blocks of size 2^( 6) =       0.000445923238
  error estimate for blocks of size 2^( 7) =       0.000450784269

      target function =      -0.916980710788
              le_mean =     -16.898487667400
             les_mean =     285.856184471676
             stat err =       0.000440585860
             autocorr =       1.363241491177
   target nu stat err =       0.000440585860
   target dn stat err =       0.002960501202
      target stat err =       0.004641479827
              std dev =       0.533653245023
             le_variance =       0.284785785923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917031555621        initial  <--
     2.5000e-01     2.5000e+00             1.6884e-03        -0.720930422911
     1.0000e+00     1.0000e+01             4.7420e-04        -0.915056998878
     4.0000e+00     4.0000e+01             1.2233e-04        -0.916980710788

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7593
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.032697e-01 3 1  ON 0
ci_0002                 6.977106e-01 3 1  ON 1
ci_0003                -3.178132e-02 3 1  ON 2
ci_0004                -3.159181e-02 3 1  ON 3
ci_0005                -2.865851e-02 3 1  ON 4
ci_0006                -2.962957e-02 3 1  ON 5
ci_0007                -1.630373e-02 3 1  ON 6
ci_0008                -1.701642e-02 3 1  ON 7
ci_0009                -1.890076e-02 3 1  ON 8
ci_0010                -1.899379e-02 3 1  ON 9
ci_0011                -1.572304e-02 3 1  ON 10
ci_0012                -1.577737e-02 3 1  ON 11
ci_0013                 1.564302e-02 3 1  ON 12
ci_0014                 1.551033e-02 3 1  ON 13
ci_0015                 1.642473e-02 3 1  ON 14
ci_0016                 1.611629e-02 3 1  ON 15
ci_0017                 1.383401e-02 3 1  ON 16
ci_0018                 1.408589e-02 3 1  ON 17
ci_0019                 1.247083e-02 3 1  ON 18
ci_0020                 1.216239e-02 3 1  ON 19
ci_0021                 1.490499e-02 3 1  ON 20
ci_0022                 1.628006e-02 3 1  ON 21
ci_0023                -1.179538e-02 3 1  ON 22
ci_0024                -1.109676e-02 3 1  ON 23
ci_0025                -2.951532e-03 3 1  ON 24
ci_0026                -2.500623e-03 3 1  ON 25
ci_0027                -1.172381e-02 3 1  ON 26
ci_0028                -1.167187e-02 3 1  ON 27
ci_0029                -1.036847e-02 3 1  ON 28
ci_0030                -1.029214e-02 3 1  ON 29
ci_0031                 1.392892e-02 3 1  ON 30
ci_0032                 1.304729e-02 3 1  ON 31
ci_0033                 8.239207e-03 3 1  ON 32
ci_0034                 8.610050e-03 3 1  ON 33
ci_0035                 4.909922e-03 3 1  ON 34
ci_0036                 4.785395e-03 3 1  ON 35
ci_0037                -1.142404e-02 3 1  ON 36
ci_0038                -1.138287e-02 3 1  ON 37
ci_0039                -3.799617e-03 3 1  ON 38
ci_0040                -3.926329e-03 3 1  ON 39
ci_0041                 9.636456e-03 3 1  ON 40
ci_0042                 9.585790e-03 3 1  ON 41
ci_0043                -6.860934e-03 3 1  ON 42
ci_0044                -7.046968e-03 3 1  ON 43
ci_0045                 1.040285e-02 3 1  ON 44
ci_0046                 9.529349e-03 3 1  ON 45
ci_0047                -3.644309e-03 3 1  ON 46
ci_0048                -3.681847e-03 3 1  ON 47
ci_0049                -2.370042e-03 3 1  ON 48
ci_0050                -2.743731e-03 3 1  ON 49
ci_0051                -1.862358e-03 3 1  ON 50
ci_0052                -1.719920e-03 3 1  ON 51
ci_0053                -3.986874e-03 3 1  ON 52
ci_0054                -3.818299e-03 3 1  ON 53
ci_0055                 2.441003e-03 3 1  ON 54
ci_0056                 2.186790e-03 3 1  ON 55
ci_0057                 2.322002e-03 3 1  ON 56
ci_0058                 3.002234e-03 3 1  ON 57
ci_0059                -4.036285e-03 3 1  ON 58
ci_0060                -3.705961e-03 3 1  ON 59
ci_0061                -2.963374e-03 3 1  ON 60
ci_0062                -3.216977e-03 3 1  ON 61
ci_0063                -9.722275e-03 3 1  ON 62
ci_0064                -9.694031e-03 3 1  ON 63
ci_0065                -7.071525e-03 3 1  ON 64
ci_0066                -6.558479e-03 3 1  ON 65
ci_0067                -3.964522e-03 3 1  ON 66
ci_0068                -3.871132e-03 3 1  ON 67
ci_0069                 3.785930e-03 3 1  ON 68
ci_0070                 3.575596e-03 3 1  ON 69
ci_0071                 4.323828e-03 3 1  ON 70
ci_0072                 4.418470e-03 3 1  ON 71
ci_0073                 3.367469e-03 3 1  ON 72
ci_0074                 3.250348e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9639
    reference variance = 0.424191
====================================================
  Execution time = 1.4750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9524e-01
  Total weights = 1.950904564e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285400282288
                                         uncertainty =       0.001857638563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285400282288
                                         uncertainty =       0.001857638563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377723995
  error estimate for blocks of size 2^( 2) =       0.000394958943
  error estimate for blocks of size 2^( 3) =       0.000412736526
  error estimate for blocks of size 2^( 4) =       0.000427863826
  error estimate for blocks of size 2^( 5) =       0.000440121185
  error estimate for blocks of size 2^( 6) =       0.000445773767
  error estimate for blocks of size 2^( 7) =       0.000449467511

      target function =      -0.920183930894
              le_mean =     -16.898286123511
             les_mean =     285.847315115800
             stat err =       0.000440806572
             autocorr =       1.361905494073
   target nu stat err =       0.000440806572
   target dn stat err =       0.002391305842
      target stat err =       0.003799172378
              std dev =       0.534182397162
             le_variance =       0.285350833438


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689828612351e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920198427166       residual = 8.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920219155800       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920225887175       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920231347159       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920233386996       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920234009186       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920234087030       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920234092660       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920234210300       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920234278908       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920234349590       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920234313751       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920234333800       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920234335989       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920234339145       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920234332975       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920234336335       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920234334080       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.999024e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920198427166       residual = 8.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920203725391       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920205434614       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920206810537       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920207320704       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920207474288       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920207493236       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920207494567       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920207524138       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920207541016       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920207558284       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920207548959       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920207553778       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920207554282       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920207554999       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920207553518       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920207554334       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920207553797       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 5.057402e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920198427166       residual = 8.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920199759180       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920200188164       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920200532824       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920200660369       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920200698638       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920200703341       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920200703670       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920200711072       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920200715274       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920200719565       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920200717211       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920200718404       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920200718527       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920200718702       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920200718336       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920200718538       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920200718406       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.268147e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7337e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.032440e-01 3 1  ON 0
ci_0002                 6.977400e-01 3 1  ON 1
ci_0003                -3.176543e-02 3 1  ON 2
ci_0004                -3.158618e-02 3 1  ON 3
ci_0005                -2.866631e-02 3 1  ON 4
ci_0006                -2.964364e-02 3 1  ON 5
ci_0007                -1.627773e-02 3 1  ON 6
ci_0008                -1.700550e-02 3 1  ON 7
ci_0009                -1.889121e-02 3 1  ON 8
ci_0010                -1.899481e-02 3 1  ON 9
ci_0011                -1.571644e-02 3 1  ON 10
ci_0012                -1.577392e-02 3 1  ON 11
ci_0013                 1.563590e-02 3 1  ON 12
ci_0014                 1.551049e-02 3 1  ON 13
ci_0015                 1.642781e-02 3 1  ON 14
ci_0016                 1.611104e-02 3 1  ON 15
ci_0017                 1.382657e-02 3 1  ON 16
ci_0018                 1.408010e-02 3 1  ON 17
ci_0019                 1.247824e-02 3 1  ON 18
ci_0020                 1.216531e-02 3 1  ON 19
ci_0021                 1.485442e-02 3 1  ON 20
ci_0022                 1.623058e-02 3 1  ON 21
ci_0023                -1.179951e-02 3 1  ON 22
ci_0024                -1.109616e-02 3 1  ON 23
ci_0025                -2.955845e-03 3 1  ON 24
ci_0026                -2.503140e-03 3 1  ON 25
ci_0027                -1.173219e-02 3 1  ON 26
ci_0028                -1.167859e-02 3 1  ON 27
ci_0029                -1.037219e-02 3 1  ON 28
ci_0030                -1.028993e-02 3 1  ON 29
ci_0031                 1.392722e-02 3 1  ON 30
ci_0032                 1.304481e-02 3 1  ON 31
ci_0033                 8.236044e-03 3 1  ON 32
ci_0034                 8.601707e-03 3 1  ON 33
ci_0035                 4.918156e-03 3 1  ON 34
ci_0036                 4.774468e-03 3 1  ON 35
ci_0037                -1.142455e-02 3 1  ON 36
ci_0038                -1.137798e-02 3 1  ON 37
ci_0039                -3.801860e-03 3 1  ON 38
ci_0040                -3.924515e-03 3 1  ON 39
ci_0041                 9.630323e-03 3 1  ON 40
ci_0042                 9.582576e-03 3 1  ON 41
ci_0043                -6.883972e-03 3 1  ON 42
ci_0044                -7.076020e-03 3 1  ON 43
ci_0045                 1.040084e-02 3 1  ON 44
ci_0046                 9.535045e-03 3 1  ON 45
ci_0047                -3.643073e-03 3 1  ON 46
ci_0048                -3.680333e-03 3 1  ON 47
ci_0049                -2.370211e-03 3 1  ON 48
ci_0050                -2.736539e-03 3 1  ON 49
ci_0051                -1.859469e-03 3 1  ON 50
ci_0052                -1.719989e-03 3 1  ON 51
ci_0053                -3.985115e-03 3 1  ON 52
ci_0054                -3.818843e-03 3 1  ON 53
ci_0055                 2.455327e-03 3 1  ON 54
ci_0056                 2.177789e-03 3 1  ON 55
ci_0057                 2.326435e-03 3 1  ON 56
ci_0058                 3.003270e-03 3 1  ON 57
ci_0059                -4.034243e-03 3 1  ON 58
ci_0060                -3.701382e-03 3 1  ON 59
ci_0061                -2.972364e-03 3 1  ON 60
ci_0062                -3.226430e-03 3 1  ON 61
ci_0063                -9.723563e-03 3 1  ON 62
ci_0064                -9.697061e-03 3 1  ON 63
ci_0065                -7.063509e-03 3 1  ON 64
ci_0066                -6.555242e-03 3 1  ON 65
ci_0067                -3.965365e-03 3 1  ON 66
ci_0068                -3.871905e-03 3 1  ON 67
ci_0069                 3.778693e-03 3 1  ON 68
ci_0070                 3.572462e-03 3 1  ON 69
ci_0071                 4.317917e-03 3 1  ON 70
ci_0072                 4.422077e-03 3 1  ON 71
ci_0073                 3.364264e-03 3 1  ON 72
ci_0074                 3.253223e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9695
    reference variance = 0.687989
====================================================
  Execution time = 1.4212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0111e-01
  Total weights = 1.9508e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287763410640
                                         uncertainty =       0.002955083372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287763410640
                                         uncertainty =       0.002955083372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379331735
  error estimate for blocks of size 2^( 2) =       0.000396782127
  error estimate for blocks of size 2^( 3) =       0.000414453910
  error estimate for blocks of size 2^( 4) =       0.000430582280
  error estimate for blocks of size 2^( 5) =       0.000442978166
  error estimate for blocks of size 2^( 6) =       0.000449832864
  error estimate for blocks of size 2^( 7) =       0.000454357726

      target function =      -0.911065888102
              le_mean =     -16.898182912860
             les_mean =     285.849714250927
             stat err =       0.000444437759
             autocorr =       1.372725000909
   target nu stat err =       0.000444437759
   target dn stat err =       0.004603415522
      target stat err =       0.007068078491
              std dev =       0.536456084023
             le_variance =       0.287785130085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287712991981
                                         uncertainty =       0.002956607830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287712991981
                                         uncertainty =       0.002956607830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379298408
  error estimate for blocks of size 2^( 2) =       0.000396743479
  error estimate for blocks of size 2^( 3) =       0.000414409205
  error estimate for blocks of size 2^( 4) =       0.000430531874
  error estimate for blocks of size 2^( 5) =       0.000442921103
  error estimate for blocks of size 2^( 6) =       0.000449767666
  error estimate for blocks of size 2^( 7) =       0.000454290891

      target function =      -0.911154683817
              le_mean =     -16.898183812334
             les_mean =     285.849686257436
             stat err =       0.000444377883
             autocorr =       1.372596328939
   target nu stat err =       0.000444377883
   target dn stat err =       0.004618205033
      target stat err =       0.007091913061
              std dev =       0.536408952442
             le_variance =       0.287734564260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287737338931
                                         uncertainty =       0.002955828164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287737338931
                                         uncertainty =       0.002955828164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379314503
  error estimate for blocks of size 2^( 2) =       0.000396762208
  error estimate for blocks of size 2^( 3) =       0.000414430919
  error estimate for blocks of size 2^( 4) =       0.000430556411
  error estimate for blocks of size 2^( 5) =       0.000442948932
  error estimate for blocks of size 2^( 6) =       0.000449799509
  error estimate for blocks of size 2^( 7) =       0.000454323541

      target function =      -0.911122910808
              le_mean =     -16.898183332154
             les_mean =     285.849690958460
             stat err =       0.000444407098
             autocorr =       1.372660317375
   target nu stat err =       0.000444407098
   target dn stat err =       0.004610634946
      target stat err =       0.007079922865
              std dev =       0.536431713998
             le_variance =       0.287758983782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287760084833
                                         uncertainty =       0.002955174157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287760084833
                                         uncertainty =       0.002955174157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379329537
  error estimate for blocks of size 2^( 2) =       0.000396779593
  error estimate for blocks of size 2^( 3) =       0.000414450990
  error estimate for blocks of size 2^( 4) =       0.000430579000
  error estimate for blocks of size 2^( 5) =       0.000442974465
  error estimate for blocks of size 2^( 6) =       0.000449828646
  error estimate for blocks of size 2^( 7) =       0.000454353404

      target function =      -0.911075057181
              le_mean =     -16.898182960998
             les_mean =     285.849709858133
             stat err =       0.000444433879
             autocorr =       1.372716941040
   target nu stat err =       0.000444433879
   target dn stat err =       0.004604290001
      target stat err =       0.007069547870
              std dev =       0.536452975518
             le_variance =       0.287781794942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911065888102        initial
     2.5000e+00     2.5000e+01             1.9990e-04        -0.911154683817  <--
     1.0000e+01     1.0000e+02             5.0574e-05        -0.911122910808
     4.0000e+01     4.0000e+02             1.2681e-05        -0.911075057181

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3769e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.031669e-01 3 1  ON 0
ci_0002                 6.978280e-01 3 1  ON 1
ci_0003                -3.171875e-02 3 1  ON 2
ci_0004                -3.156973e-02 3 1  ON 3
ci_0005                -2.868903e-02 3 1  ON 4
ci_0006                -2.968496e-02 3 1  ON 5
ci_0007                -1.620085e-02 3 1  ON 6
ci_0008                -1.697316e-02 3 1  ON 7
ci_0009                -1.886320e-02 3 1  ON 8
ci_0010                -1.899784e-02 3 1  ON 9
ci_0011                -1.569702e-02 3 1  ON 10
ci_0012                -1.576382e-02 3 1  ON 11
ci_0013                 1.561501e-02 3 1  ON 12
ci_0014                 1.551101e-02 3 1  ON 13
ci_0015                 1.643680e-02 3 1  ON 14
ci_0016                 1.609571e-02 3 1  ON 15
ci_0017                 1.380475e-02 3 1  ON 16
ci_0018                 1.406318e-02 3 1  ON 17
ci_0019                 1.249990e-02 3 1  ON 18
ci_0020                 1.217390e-02 3 1  ON 19
ci_0021                 1.470509e-02 3 1  ON 20
ci_0022                 1.608463e-02 3 1  ON 21
ci_0023                -1.181157e-02 3 1  ON 22
ci_0024                -1.109445e-02 3 1  ON 23
ci_0025                -2.968363e-03 3 1  ON 24
ci_0026                -2.510476e-03 3 1  ON 25
ci_0027                -1.175669e-02 3 1  ON 26
ci_0028                -1.169834e-02 3 1  ON 27
ci_0029                -1.038315e-02 3 1  ON 28
ci_0030                -1.028352e-02 3 1  ON 29
ci_0031                 1.392216e-02 3 1  ON 30
ci_0032                 1.303750e-02 3 1  ON 31
ci_0033                 8.226679e-03 3 1  ON 32
ci_0034                 8.577172e-03 3 1  ON 33
ci_0035                 4.942056e-03 3 1  ON 34
ci_0036                 4.742656e-03 3 1  ON 35
ci_0037                -1.142602e-02 3 1  ON 36
ci_0038                -1.136364e-02 3 1  ON 37
ci_0039                -3.808396e-03 3 1  ON 38
ci_0040                -3.919243e-03 3 1  ON 39
ci_0041                 9.612317e-03 3 1  ON 40
ci_0042                 9.573173e-03 3 1  ON 41
ci_0043                -6.951676e-03 3 1  ON 42
ci_0044                -7.161597e-03 3 1  ON 43
ci_0045                 1.039491e-02 3 1  ON 44
ci_0046                 9.551779e-03 3 1  ON 45
ci_0047                -3.639459e-03 3 1  ON 46
ci_0048                -3.675937e-03 3 1  ON 47
ci_0049                -2.370713e-03 3 1  ON 48
ci_0050                -2.715606e-03 3 1  ON 49
ci_0051                -1.851070e-03 3 1  ON 50
ci_0052                -1.720186e-03 3 1  ON 51
ci_0053                -3.979989e-03 3 1  ON 52
ci_0054                -3.820451e-03 3 1  ON 53
ci_0055                 2.496982e-03 3 1  ON 54
ci_0056                 2.151607e-03 3 1  ON 55
ci_0057                 2.339313e-03 3 1  ON 56
ci_0058                 3.006254e-03 3 1  ON 57
ci_0059                -4.028285e-03 3 1  ON 58
ci_0060                -3.688067e-03 3 1  ON 59
ci_0061                -2.998653e-03 3 1  ON 60
ci_0062                -3.254106e-03 3 1  ON 61
ci_0063                -9.727273e-03 3 1  ON 62
ci_0064                -9.705910e-03 3 1  ON 63
ci_0065                -7.040039e-03 3 1  ON 64
ci_0066                -6.545799e-03 3 1  ON 65
ci_0067                -3.967797e-03 3 1  ON 66
ci_0068                -3.874166e-03 3 1  ON 67
ci_0069                 3.757630e-03 3 1  ON 68
ci_0070                 3.563347e-03 3 1  ON 69
ci_0071                 4.300715e-03 3 1  ON 70
ci_0072                 4.432613e-03 3 1  ON 71
ci_0073                 3.354926e-03 3 1  ON 72
ci_0074                 3.261592e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6934e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8589
    reference variance = 0.215565
====================================================
  Execution time = 1.4835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9157e-01
  Total weights = 1.951090436e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282425161406
                                         uncertainty =       0.001699161472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282425161406
                                         uncertainty =       0.001699161472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375933339
  error estimate for blocks of size 2^( 2) =       0.000393116880
  error estimate for blocks of size 2^( 3) =       0.000410534794
  error estimate for blocks of size 2^( 4) =       0.000425924097
  error estimate for blocks of size 2^( 5) =       0.000437775579
  error estimate for blocks of size 2^( 6) =       0.000446113228
  error estimate for blocks of size 2^( 7) =       0.000450708511

      target function =      -0.925932567355
              le_mean =     -16.897927742412
             les_mean =     285.831535403479
             stat err =       0.000440130354
             autocorr =       1.370695404797
   target nu stat err =       0.000440130354
   target dn stat err =       0.002090498255
      target stat err =       0.003379306219
              std dev =       0.531650026817
             le_variance =       0.282651751015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689792774241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925943641078       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926003324147       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926039264936       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926060494310       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926066731773       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926069507385       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926069953749       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926070250994       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926070137990       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926070084165       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926070057006       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926070159372       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926070229475       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926070230979       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926070267255       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926070264764       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926070254732       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926070263958       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 7.147610e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925943641078       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925959935547       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925969524799       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925975004561       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925976573979       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925977258506       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925977357083       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925977427894       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925977398026       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925977383632       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925977377870       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925977405466       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925977421122       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925977420621       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925977428295       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925977427449       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925977425228       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925977427085       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.877487e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925943641078       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925947810658       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925950248731       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925951629281       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925952021902       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925952192206       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925952215945       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925952233400       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925952225836       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925952222179       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925952220817       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925952227848       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925952231616       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925952231441       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925952233273       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925952233049       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925952232514       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925952232951       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.754016e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7426e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.032134e-01 3 1  ON 0
ci_0002                 6.977967e-01 3 1  ON 1
ci_0003                -3.166918e-02 3 1  ON 2
ci_0004                -3.153365e-02 3 1  ON 3
ci_0005                -2.872565e-02 3 1  ON 4
ci_0006                -2.973227e-02 3 1  ON 5
ci_0007                -1.616195e-02 3 1  ON 6
ci_0008                -1.691632e-02 3 1  ON 7
ci_0009                -1.885079e-02 3 1  ON 8
ci_0010                -1.895228e-02 3 1  ON 9
ci_0011                -1.566816e-02 3 1  ON 10
ci_0012                -1.573053e-02 3 1  ON 11
ci_0013                 1.562648e-02 3 1  ON 12
ci_0014                 1.548336e-02 3 1  ON 13
ci_0015                 1.640477e-02 3 1  ON 14
ci_0016                 1.607714e-02 3 1  ON 15
ci_0017                 1.379742e-02 3 1  ON 16
ci_0018                 1.405078e-02 3 1  ON 17
ci_0019                 1.252378e-02 3 1  ON 18
ci_0020                 1.217426e-02 3 1  ON 19
ci_0021                 1.451919e-02 3 1  ON 20
ci_0022                 1.589689e-02 3 1  ON 21
ci_0023                -1.180918e-02 3 1  ON 22
ci_0024                -1.110404e-02 3 1  ON 23
ci_0025                -2.953371e-03 3 1  ON 24
ci_0026                -2.499468e-03 3 1  ON 25
ci_0027                -1.175191e-02 3 1  ON 26
ci_0028                -1.170733e-02 3 1  ON 27
ci_0029                -1.038792e-02 3 1  ON 28
ci_0030                -1.029279e-02 3 1  ON 29
ci_0031                 1.389192e-02 3 1  ON 30
ci_0032                 1.303998e-02 3 1  ON 31
ci_0033                 8.243780e-03 3 1  ON 32
ci_0034                 8.558196e-03 3 1  ON 33
ci_0035                 4.932911e-03 3 1  ON 34
ci_0036                 4.727297e-03 3 1  ON 35
ci_0037                -1.140715e-02 3 1  ON 36
ci_0038                -1.133913e-02 3 1  ON 37
ci_0039                -3.802937e-03 3 1  ON 38
ci_0040                -3.917532e-03 3 1  ON 39
ci_0041                 9.616570e-03 3 1  ON 40
ci_0042                 9.546820e-03 3 1  ON 41
ci_0043                -7.091590e-03 3 1  ON 42
ci_0044                -7.311767e-03 3 1  ON 43
ci_0045                 1.038640e-02 3 1  ON 44
ci_0046                 9.549450e-03 3 1  ON 45
ci_0047                -3.623729e-03 3 1  ON 46
ci_0048                -3.660481e-03 3 1  ON 47
ci_0049                -2.385553e-03 3 1  ON 48
ci_0050                -2.705868e-03 3 1  ON 49
ci_0051                -1.881973e-03 3 1  ON 50
ci_0052                -1.749047e-03 3 1  ON 51
ci_0053                -3.982791e-03 3 1  ON 52
ci_0054                -3.810751e-03 3 1  ON 53
ci_0055                 2.498467e-03 3 1  ON 54
ci_0056                 2.162376e-03 3 1  ON 55
ci_0057                 2.342411e-03 3 1  ON 56
ci_0058                 2.955028e-03 3 1  ON 57
ci_0059                -4.017544e-03 3 1  ON 58
ci_0060                -3.679772e-03 3 1  ON 59
ci_0061                -3.022549e-03 3 1  ON 60
ci_0062                -3.263623e-03 3 1  ON 61
ci_0063                -9.707092e-03 3 1  ON 62
ci_0064                -9.706015e-03 3 1  ON 63
ci_0065                -7.026517e-03 3 1  ON 64
ci_0066                -6.507542e-03 3 1  ON 65
ci_0067                -3.975042e-03 3 1  ON 66
ci_0068                -3.851811e-03 3 1  ON 67
ci_0069                 3.755961e-03 3 1  ON 68
ci_0070                 3.573575e-03 3 1  ON 69
ci_0071                 4.270303e-03 3 1  ON 70
ci_0072                 4.397378e-03 3 1  ON 71
ci_0073                 3.358635e-03 3 1  ON 72
ci_0074                 3.260649e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.7821
    reference variance = 0.382895
====================================================
  Execution time = 1.4203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.5317e-01
  Total weights = 1.9511e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313111648100
                                         uncertainty =       0.031698508220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313111648100
                                         uncertainty =       0.031698508220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395632159
  error estimate for blocks of size 2^( 2) =       0.000412138433
  error estimate for blocks of size 2^( 3) =       0.000428752576
  error estimate for blocks of size 2^( 4) =       0.000442963271
  error estimate for blocks of size 2^( 5) =       0.000454700336
  error estimate for blocks of size 2^( 6) =       0.000463452327
  error estimate for blocks of size 2^( 7) =       0.000467832566

      target function =      -0.831271742826
              le_mean =     -16.897571581281
             les_mean =     285.881062874307
             stat err =       0.000457237125
             autocorr =       1.335671929715
   target nu stat err =       0.000457237125
   target dn stat err =       0.059190915032
      target stat err =       0.075774687210
              std dev =       0.559508364782
             le_variance =       0.313049610261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313465848567
                                         uncertainty =       0.032271158405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313465848567
                                         uncertainty =       0.032271158405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395855496
  error estimate for blocks of size 2^( 2) =       0.000412328802
  error estimate for blocks of size 2^( 3) =       0.000428906031
  error estimate for blocks of size 2^( 4) =       0.000443080183
  error estimate for blocks of size 2^( 5) =       0.000454792283
  error estimate for blocks of size 2^( 6) =       0.000463523372
  error estimate for blocks of size 2^( 7) =       0.000467878978

      target function =      -0.826747852046
              le_mean =     -16.897576773514
             les_mean =     285.884644206929
             stat err =       0.000457318704
             autocorr =       1.334641332001
   target nu stat err =       0.000457318704
   target dn stat err =       0.060309837125
      target stat err =       0.076386871411
              std dev =       0.559824210901
             le_variance =       0.313403147111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313300279302
                                         uncertainty =       0.032006160075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313300279302
                                         uncertainty =       0.032006160075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395751114
  error estimate for blocks of size 2^( 2) =       0.000412239659
  error estimate for blocks of size 2^( 3) =       0.000428833503
  error estimate for blocks of size 2^( 4) =       0.000443025087
  error estimate for blocks of size 2^( 5) =       0.000454748368
  error estimate for blocks of size 2^( 6) =       0.000463489080
  error estimate for blocks of size 2^( 7) =       0.000467856968

      target function =      -0.830584711848
              le_mean =     -16.897573989529
             les_mean =     285.881585768620
             stat err =       0.000457279876
             autocorr =       1.335118724465
   target nu stat err =       0.000457279876
   target dn stat err =       0.059757565857
      target stat err =       0.076385190770
              std dev =       0.559676592210
             le_variance =       0.313237887868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313135113592
                                         uncertainty =       0.031737499717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313135113592
                                         uncertainty =       0.031737499717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395646958
  error estimate for blocks of size 2^( 2) =       0.000412150988
  error estimate for blocks of size 2^( 3) =       0.000428762494
  error estimate for blocks of size 2^( 4) =       0.000442970775
  error estimate for blocks of size 2^( 5) =       0.000454706049
  error estimate for blocks of size 2^( 6) =       0.000463456619
  error estimate for blocks of size 2^( 7) =       0.000467835022

      target function =      -0.831312583567
              le_mean =     -16.897571843097
             les_mean =     285.881026143252
             stat err =       0.000457242116
             autocorr =       1.335601166928
   target nu stat err =       0.000457242116
   target dn stat err =       0.059262389011
      target stat err =       0.075875264524
              std dev =       0.559529294349
             le_variance =       0.313073031235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.831271742826        initial
     6.2500e-01     6.2500e+00             7.1476e-04        -0.826747852046
     2.5000e+00     2.5000e+01             1.8775e-04        -0.830584711848
     1.0000e+01     1.0000e+02             4.7540e-05        -0.831312583567  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.6280e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.031786e-01 3 1  ON 0
ci_0002                 6.978202e-01 3 1  ON 1
ci_0003                -3.170614e-02 3 1  ON 2
ci_0004                -3.156056e-02 3 1  ON 3
ci_0005                -2.869836e-02 3 1  ON 4
ci_0006                -2.969701e-02 3 1  ON 5
ci_0007                -1.619102e-02 3 1  ON 6
ci_0008                -1.695880e-02 3 1  ON 7
ci_0009                -1.886003e-02 3 1  ON 8
ci_0010                -1.898624e-02 3 1  ON 9
ci_0011                -1.568968e-02 3 1  ON 10
ci_0012                -1.575536e-02 3 1  ON 11
ci_0013                 1.561792e-02 3 1  ON 12
ci_0014                 1.550398e-02 3 1  ON 13
ci_0015                 1.642864e-02 3 1  ON 14
ci_0016                 1.609098e-02 3 1  ON 15
ci_0017                 1.380287e-02 3 1  ON 16
ci_0018                 1.406002e-02 3 1  ON 17
ci_0019                 1.250598e-02 3 1  ON 18
ci_0020                 1.217399e-02 3 1  ON 19
ci_0021                 1.465802e-02 3 1  ON 20
ci_0022                 1.603709e-02 3 1  ON 21
ci_0023                -1.181095e-02 3 1  ON 22
ci_0024                -1.109690e-02 3 1  ON 23
ci_0025                -2.964530e-03 3 1  ON 24
ci_0026                -2.507660e-03 3 1  ON 25
ci_0027                -1.175546e-02 3 1  ON 26
ci_0028                -1.170063e-02 3 1  ON 27
ci_0029                -1.038435e-02 3 1  ON 28
ci_0030                -1.028587e-02 3 1  ON 29
ci_0031                 1.391450e-02 3 1  ON 30
ci_0032                 1.303814e-02 3 1  ON 31
ci_0033                 8.231007e-03 3 1  ON 32
ci_0034                 8.572356e-03 3 1  ON 33
ci_0035                 4.939729e-03 3 1  ON 34
ci_0036                 4.738741e-03 3 1  ON 35
ci_0037                -1.142122e-02 3 1  ON 36
ci_0038                -1.135741e-02 3 1  ON 37
ci_0039                -3.806999e-03 3 1  ON 38
ci_0040                -3.918806e-03 3 1  ON 39
ci_0041                 9.613404e-03 3 1  ON 40
ci_0042                 9.566468e-03 3 1  ON 41
ci_0043                -6.987135e-03 3 1  ON 42
ci_0044                -7.199663e-03 3 1  ON 43
ci_0045                 1.039275e-02 3 1  ON 44
ci_0046                 9.551192e-03 3 1  ON 45
ci_0047                -3.635439e-03 3 1  ON 46
ci_0048                -3.671989e-03 3 1  ON 47
ci_0049                -2.374508e-03 3 1  ON 48
ci_0050                -2.713117e-03 3 1  ON 49
ci_0051                -1.858990e-03 3 1  ON 50
ci_0052                -1.727582e-03 3 1  ON 51
ci_0053                -3.980705e-03 3 1  ON 52
ci_0054                -3.817971e-03 3 1  ON 53
ci_0055                 2.497360e-03 3 1  ON 54
ci_0056                 2.154363e-03 3 1  ON 55
ci_0057                 2.340115e-03 3 1  ON 56
ci_0058                 2.993157e-03 3 1  ON 57
ci_0059                -4.025535e-03 3 1  ON 58
ci_0060                -3.685948e-03 3 1  ON 59
ci_0061                -3.004741e-03 3 1  ON 60
ci_0062                -3.256531e-03 3 1  ON 61
ci_0063                -9.722132e-03 3 1  ON 62
ci_0064                -9.705948e-03 3 1  ON 63
ci_0065                -7.036594e-03 3 1  ON 64
ci_0066                -6.536051e-03 3 1  ON 65
ci_0067                -3.969649e-03 3 1  ON 66
ci_0068                -3.868450e-03 3 1  ON 67
ci_0069                 3.757204e-03 3 1  ON 68
ci_0070                 3.565966e-03 3 1  ON 69
ci_0071                 4.292929e-03 3 1  ON 70
ci_0072                 4.423600e-03 3 1  ON 71
ci_0073                 3.355873e-03 3 1  ON 72
ci_0074                 3.261354e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8519
    reference variance = 0.214046
====================================================
  Execution time = 1.4559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9326e-01
  Total weights = 1.950933199e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282950078113
                                         uncertainty =       0.001686224569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282950078113
                                         uncertainty =       0.001686224569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376139578
  error estimate for blocks of size 2^( 2) =       0.000393466740
  error estimate for blocks of size 2^( 3) =       0.000411242145
  error estimate for blocks of size 2^( 4) =       0.000426418576
  error estimate for blocks of size 2^( 5) =       0.000437529696
  error estimate for blocks of size 2^( 6) =       0.000445935700
  error estimate for blocks of size 2^( 7) =       0.000451848419

      target function =      -0.923280083102
              le_mean =     -16.898679983566
             les_mean =     285.858648228256
             stat err =       0.000440433098
             autocorr =       1.371076951948
   target nu stat err =       0.000440433098
   target dn stat err =       0.002239185072
      target stat err =       0.003593102279
              std dev =       0.531941692209
             le_variance =       0.282961963910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689867998357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923292650442       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923314282498       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923321077883       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923325169143       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923327103596       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923327797940       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923327916523       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923328108597       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923328186147       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923328303025       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923328352052       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923328443225       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923328470600       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923328476677       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923328491025       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923328493148       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923328493370       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923328494636       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923328495104       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.739626e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923292650442       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923298180232       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923299905802       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923300936387       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923301420730       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923301593235       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923301622383       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923301670768       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923301690001       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923301718781       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923301730651       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923301752867       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923301759136       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923301760494       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923301763932       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923301764398       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923301764449       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923301764748       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.403958e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923292650442       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923294040716       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923294473808       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923294731936       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923294853060       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923294896114       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923294903369       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923294915489       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923294920286       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923294927453       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923294930395       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923294935912       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923294937444       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923294937774       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923294938624       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923294938737       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923294938749       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923294938823       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.104528e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7148e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.032163e-01 3 1  ON 0
ci_0002                 6.977851e-01 3 1  ON 1
ci_0003                -3.170334e-02 3 1  ON 2
ci_0004                -3.154999e-02 3 1  ON 3
ci_0005                -2.870829e-02 3 1  ON 4
ci_0006                -2.970849e-02 3 1  ON 5
ci_0007                -1.617969e-02 3 1  ON 6
ci_0008                -1.693666e-02 3 1  ON 7
ci_0009                -1.885671e-02 3 1  ON 8
ci_0010                -1.898732e-02 3 1  ON 9
ci_0011                -1.568396e-02 3 1  ON 10
ci_0012                -1.575291e-02 3 1  ON 11
ci_0013                 1.561693e-02 3 1  ON 12
ci_0014                 1.550310e-02 3 1  ON 13
ci_0015                 1.642230e-02 3 1  ON 14
ci_0016                 1.607985e-02 3 1  ON 15
ci_0017                 1.380283e-02 3 1  ON 16
ci_0018                 1.405070e-02 3 1  ON 17
ci_0019                 1.250584e-02 3 1  ON 18
ci_0020                 1.217970e-02 3 1  ON 19
ci_0021                 1.461398e-02 3 1  ON 20
ci_0022                 1.600090e-02 3 1  ON 21
ci_0023                -1.181176e-02 3 1  ON 22
ci_0024                -1.109971e-02 3 1  ON 23
ci_0025                -2.962652e-03 3 1  ON 24
ci_0026                -2.498869e-03 3 1  ON 25
ci_0027                -1.175958e-02 3 1  ON 26
ci_0028                -1.169679e-02 3 1  ON 27
ci_0029                -1.038800e-02 3 1  ON 28
ci_0030                -1.029484e-02 3 1  ON 29
ci_0031                 1.391325e-02 3 1  ON 30
ci_0032                 1.303036e-02 3 1  ON 31
ci_0033                 8.226017e-03 3 1  ON 32
ci_0034                 8.559758e-03 3 1  ON 33
ci_0035                 4.940649e-03 3 1  ON 34
ci_0036                 4.745406e-03 3 1  ON 35
ci_0037                -1.142303e-02 3 1  ON 36
ci_0038                -1.135922e-02 3 1  ON 37
ci_0039                -3.809006e-03 3 1  ON 38
ci_0040                -3.920495e-03 3 1  ON 39
ci_0041                 9.607027e-03 3 1  ON 40
ci_0042                 9.557634e-03 3 1  ON 41
ci_0043                -7.019556e-03 3 1  ON 42
ci_0044                -7.242279e-03 3 1  ON 43
ci_0045                 1.039784e-02 3 1  ON 44
ci_0046                 9.558107e-03 3 1  ON 45
ci_0047                -3.633409e-03 3 1  ON 46
ci_0048                -3.671908e-03 3 1  ON 47
ci_0049                -2.380461e-03 3 1  ON 48
ci_0050                -2.706265e-03 3 1  ON 49
ci_0051                -1.856789e-03 3 1  ON 50
ci_0052                -1.727182e-03 3 1  ON 51
ci_0053                -3.972579e-03 3 1  ON 52
ci_0054                -3.814400e-03 3 1  ON 53
ci_0055                 2.487841e-03 3 1  ON 54
ci_0056                 2.146363e-03 3 1  ON 55
ci_0057                 2.348640e-03 3 1  ON 56
ci_0058                 2.986066e-03 3 1  ON 57
ci_0059                -4.020368e-03 3 1  ON 58
ci_0060                -3.682134e-03 3 1  ON 59
ci_0061                -3.008529e-03 3 1  ON 60
ci_0062                -3.259813e-03 3 1  ON 61
ci_0063                -9.724200e-03 3 1  ON 62
ci_0064                -9.701994e-03 3 1  ON 63
ci_0065                -7.036689e-03 3 1  ON 64
ci_0066                -6.526762e-03 3 1  ON 65
ci_0067                -3.972822e-03 3 1  ON 66
ci_0068                -3.859542e-03 3 1  ON 67
ci_0069                 3.754844e-03 3 1  ON 68
ci_0070                 3.566126e-03 3 1  ON 69
ci_0071                 4.284945e-03 3 1  ON 70
ci_0072                 4.413549e-03 3 1  ON 71
ci_0073                 3.356188e-03 3 1  ON 72
ci_0074                 3.256693e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8703
    reference variance = 0.193779
====================================================
  Execution time = 1.4218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9327e-01
  Total weights = 1.9509e+06
  Execution time = 1.9313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282798428680
                                         uncertainty =       0.001740913164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282798428680
                                         uncertainty =       0.001740913164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376011241
  error estimate for blocks of size 2^( 2) =       0.000393477429
  error estimate for blocks of size 2^( 3) =       0.000411340816
  error estimate for blocks of size 2^( 4) =       0.000427655973
  error estimate for blocks of size 2^( 5) =       0.000439617212
  error estimate for blocks of size 2^( 6) =       0.000446889340
  error estimate for blocks of size 2^( 7) =       0.000452634359

      target function =      -0.922904663479
              le_mean =     -16.897529420549
             les_mean =     285.819996058300
             stat err =       0.000441699221
             autocorr =       1.379912690847
   target nu stat err =       0.000441699221
   target dn stat err =       0.002533603639
      target stat err =       0.004034809009
              std dev =       0.531760197311
             le_variance =       0.282768907444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282748074116
                                         uncertainty =       0.001739291741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282748074116
                                         uncertainty =       0.001739291741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375977825
  error estimate for blocks of size 2^( 2) =       0.000393439281
  error estimate for blocks of size 2^( 3) =       0.000411296735
  error estimate for blocks of size 2^( 4) =       0.000427606388
  error estimate for blocks of size 2^( 5) =       0.000439564052
  error estimate for blocks of size 2^( 6) =       0.000446831937
  error estimate for blocks of size 2^( 7) =       0.000452573361

      target function =      -0.923849296659
              le_mean =     -16.897528345077
             les_mean =     285.819357698846
             stat err =       0.000441643934
             autocorr =       1.379812510830
   target nu stat err =       0.000441643934
   target dn stat err =       0.002408309962
      target stat err =       0.003850011054
              std dev =       0.531712939062
             le_variance =       0.282718649566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282772434137
                                         uncertainty =       0.001740096371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282772434137
                                         uncertainty =       0.001740096371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375993991
  error estimate for blocks of size 2^( 2) =       0.000393457786
  error estimate for blocks of size 2^( 3) =       0.000411318157
  error estimate for blocks of size 2^( 4) =       0.000427630537
  error estimate for blocks of size 2^( 5) =       0.000439589950
  error estimate for blocks of size 2^( 6) =       0.000446859939
  error estimate for blocks of size 2^( 7) =       0.000452603107

      target function =      -0.923520588018
              le_mean =     -16.897528821880
             les_mean =     285.819583230877
             stat err =       0.000441670883
             autocorr =       1.379862243709
   target nu stat err =       0.000441670883
   target dn stat err =       0.002443921562
      target stat err =       0.003902085166
              std dev =       0.531735800987
             le_variance =       0.282742962051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282795119479
                                         uncertainty =       0.001740811172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282795119479
                                         uncertainty =       0.001740811172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376009045
  error estimate for blocks of size 2^( 2) =       0.000393474933
  error estimate for blocks of size 2^( 3) =       0.000411337940
  error estimate for blocks of size 2^( 4) =       0.000427652751
  error estimate for blocks of size 2^( 5) =       0.000439613759
  error estimate for blocks of size 2^( 6) =       0.000446885621
  error estimate for blocks of size 2^( 7) =       0.000452630405

      target function =      -0.923006072330
              le_mean =     -16.897529339063
             les_mean =     285.819928647773
             stat err =       0.000441695634
             autocorr =       1.379906396834
   target nu stat err =       0.000441695634
   target dn stat err =       0.002516925564
      target stat err =       0.004010029936
              std dev =       0.531757091551
             le_variance =       0.282765604415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922904663479        initial
     2.5000e+00     2.5000e+01             1.7396e-04        -0.923849296659  <--
     1.0000e+01     1.0000e+02             4.4040e-05        -0.923520588018
     4.0000e+01     4.0000e+02             1.1045e-05        -0.923006072330

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3809e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.033293e-01 3 1  ON 0
ci_0002                 6.976795e-01 3 1  ON 1
ci_0003                -3.169523e-02 3 1  ON 2
ci_0004                -3.151877e-02 3 1  ON 3
ci_0005                -2.873740e-02 3 1  ON 4
ci_0006                -2.974188e-02 3 1  ON 5
ci_0007                -1.614622e-02 3 1  ON 6
ci_0008                -1.687128e-02 3 1  ON 7
ci_0009                -1.884704e-02 3 1  ON 8
ci_0010                -1.899040e-02 3 1  ON 9
ci_0011                -1.566721e-02 3 1  ON 10
ci_0012                -1.574560e-02 3 1  ON 11
ci_0013                 1.561409e-02 3 1  ON 12
ci_0014                 1.550048e-02 3 1  ON 13
ci_0015                 1.640379e-02 3 1  ON 14
ci_0016                 1.604720e-02 3 1  ON 15
ci_0017                 1.380276e-02 3 1  ON 16
ci_0018                 1.402333e-02 3 1  ON 17
ci_0019                 1.250548e-02 3 1  ON 18
ci_0020                 1.219636e-02 3 1  ON 19
ci_0021                 1.448405e-02 3 1  ON 20
ci_0022                 1.589418e-02 3 1  ON 21
ci_0023                -1.181415e-02 3 1  ON 22
ci_0024                -1.110793e-02 3 1  ON 23
ci_0025                -2.957200e-03 3 1  ON 24
ci_0026                -2.473231e-03 3 1  ON 25
ci_0027                -1.177170e-02 3 1  ON 26
ci_0028                -1.168555e-02 3 1  ON 27
ci_0029                -1.039874e-02 3 1  ON 28
ci_0030                -1.032109e-02 3 1  ON 29
ci_0031                 1.390965e-02 3 1  ON 30
ci_0032                 1.300733e-02 3 1  ON 31
ci_0033                 8.211362e-03 3 1  ON 32
ci_0034                 8.522675e-03 3 1  ON 33
ci_0035                 4.943319e-03 3 1  ON 34
ci_0036                 4.764708e-03 3 1  ON 35
ci_0037                -1.142838e-02 3 1  ON 36
ci_0038                -1.136452e-02 3 1  ON 37
ci_0039                -3.814872e-03 3 1  ON 38
ci_0040                -3.925409e-03 3 1  ON 39
ci_0041                 9.588395e-03 3 1  ON 40
ci_0042                 9.531718e-03 3 1  ON 41
ci_0043                -7.115105e-03 3 1  ON 42
ci_0044                -7.367859e-03 3 1  ON 43
ci_0045                 1.041286e-02 3 1  ON 44
ci_0046                 9.578445e-03 3 1  ON 45
ci_0047                -3.627489e-03 3 1  ON 46
ci_0048                -3.671657e-03 3 1  ON 47
ci_0049                -2.397782e-03 3 1  ON 48
ci_0050                -2.686306e-03 3 1  ON 49
ci_0051                -1.850394e-03 3 1  ON 50
ci_0052                -1.725993e-03 3 1  ON 51
ci_0053                -3.948979e-03 3 1  ON 52
ci_0054                -3.803970e-03 3 1  ON 53
ci_0055                 2.460143e-03 3 1  ON 54
ci_0056                 2.123081e-03 3 1  ON 55
ci_0057                 2.373419e-03 3 1  ON 56
ci_0058                 2.965422e-03 3 1  ON 57
ci_0059                -4.005317e-03 3 1  ON 58
ci_0060                -3.671004e-03 3 1  ON 59
ci_0061                -3.019615e-03 3 1  ON 60
ci_0062                -3.269394e-03 3 1  ON 61
ci_0063                -9.730232e-03 3 1  ON 62
ci_0064                -9.690357e-03 3 1  ON 63
ci_0065                -7.036984e-03 3 1  ON 64
ci_0066                -6.499525e-03 3 1  ON 65
ci_0067                -3.982079e-03 3 1  ON 66
ci_0068                -3.833628e-03 3 1  ON 67
ci_0069                 3.747964e-03 3 1  ON 68
ci_0070                 3.566560e-03 3 1  ON 69
ci_0071                 4.261718e-03 3 1  ON 70
ci_0072                 4.384355e-03 3 1  ON 71
ci_0073                 3.357180e-03 3 1  ON 72
ci_0074                 3.243133e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9456
    reference variance = 0.191868
====================================================
  Execution time = 1.4652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9360e-01
  Total weights = 1.951115436e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283627944458
                                         uncertainty =       0.001458036252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283627944458
                                         uncertainty =       0.001458036252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376556724
  error estimate for blocks of size 2^( 2) =       0.000393810041
  error estimate for blocks of size 2^( 3) =       0.000411408921
  error estimate for blocks of size 2^( 4) =       0.000426787383
  error estimate for blocks of size 2^( 5) =       0.000438244048
  error estimate for blocks of size 2^( 6) =       0.000445602056
  error estimate for blocks of size 2^( 7) =       0.000449558621

      target function =      -0.922744078272
              le_mean =     -16.896981557967
             les_mean =     285.801582980294
             stat err =       0.000440048027
             autocorr =       1.365649791858
   target nu stat err =       0.000440048027
   target dn stat err =       0.002264450414
      target stat err =       0.003616325941
              std dev =       0.532531625753
             le_variance =       0.283589932428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689698155797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922756990520       residual = 9.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922836178116       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922858030031       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922876320959       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922882816130       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922884561348       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922884930515       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922885078453       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922885043463       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922885059787       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922885131653       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922885317505       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922885390669       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922885332231       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922885375399       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922885408119       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922885395591       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922885402414       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922885402389       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 7.340665e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922756990520       residual = 9.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922778553814       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922784365794       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922789103981       residual = 9.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922790720839       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922791141285       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922791229596       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922791264191       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922791253561       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922791257730       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922791275221       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922791322784       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922791336223       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922791322075       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922791332097       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922791338897       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922791335951       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922791337381       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.929710e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922756990520       residual = 9.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922762504326       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922763980753       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922765175672       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922765578914       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922765682834       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922765704630       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922765713112       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922765710332       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922765711388       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922765715727       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922765727662       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922765730707       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922765727220       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922765729675       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922765731288       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922765730566       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922765730907       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.887217e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7240e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.034098e-01 3 1  ON 0
ci_0002                 6.976121e-01 3 1  ON 1
ci_0003                -3.167038e-02 3 1  ON 2
ci_0004                -3.148785e-02 3 1  ON 3
ci_0005                -2.877010e-02 3 1  ON 4
ci_0006                -2.977275e-02 3 1  ON 5
ci_0007                -1.611473e-02 3 1  ON 6
ci_0008                -1.680109e-02 3 1  ON 7
ci_0009                -1.884194e-02 3 1  ON 8
ci_0010                -1.896729e-02 3 1  ON 9
ci_0011                -1.566279e-02 3 1  ON 10
ci_0012                -1.572091e-02 3 1  ON 11
ci_0013                 1.559734e-02 3 1  ON 12
ci_0014                 1.548225e-02 3 1  ON 13
ci_0015                 1.638695e-02 3 1  ON 14
ci_0016                 1.602245e-02 3 1  ON 15
ci_0017                 1.378425e-02 3 1  ON 16
ci_0018                 1.399451e-02 3 1  ON 17
ci_0019                 1.252317e-02 3 1  ON 18
ci_0020                 1.219568e-02 3 1  ON 19
ci_0021                 1.429108e-02 3 1  ON 20
ci_0022                 1.570337e-02 3 1  ON 21
ci_0023                -1.181407e-02 3 1  ON 22
ci_0024                -1.113296e-02 3 1  ON 23
ci_0025                -2.937539e-03 3 1  ON 24
ci_0026                -2.435592e-03 3 1  ON 25
ci_0027                -1.179635e-02 3 1  ON 26
ci_0028                -1.166626e-02 3 1  ON 27
ci_0029                -1.040753e-02 3 1  ON 28
ci_0030                -1.034950e-02 3 1  ON 29
ci_0031                 1.387963e-02 3 1  ON 30
ci_0032                 1.301183e-02 3 1  ON 31
ci_0033                 8.176997e-03 3 1  ON 32
ci_0034                 8.484735e-03 3 1  ON 33
ci_0035                 4.879822e-03 3 1  ON 34
ci_0036                 4.789324e-03 3 1  ON 35
ci_0037                -1.141715e-02 3 1  ON 36
ci_0038                -1.135033e-02 3 1  ON 37
ci_0039                -3.824595e-03 3 1  ON 38
ci_0040                -3.922474e-03 3 1  ON 39
ci_0041                 9.593013e-03 3 1  ON 40
ci_0042                 9.523287e-03 3 1  ON 41
ci_0043                -7.256315e-03 3 1  ON 42
ci_0044                -7.491307e-03 3 1  ON 43
ci_0045                 1.039079e-02 3 1  ON 44
ci_0046                 9.596676e-03 3 1  ON 45
ci_0047                -3.639081e-03 3 1  ON 46
ci_0048                -3.672250e-03 3 1  ON 47
ci_0049                -2.331662e-03 3 1  ON 48
ci_0050                -2.705331e-03 3 1  ON 49
ci_0051                -1.858397e-03 3 1  ON 50
ci_0052                -1.713301e-03 3 1  ON 51
ci_0053                -3.933072e-03 3 1  ON 52
ci_0054                -3.803183e-03 3 1  ON 53
ci_0055                 2.434010e-03 3 1  ON 54
ci_0056                 2.112833e-03 3 1  ON 55
ci_0057                 2.383108e-03 3 1  ON 56
ci_0058                 2.974012e-03 3 1  ON 57
ci_0059                -3.991961e-03 3 1  ON 58
ci_0060                -3.652336e-03 3 1  ON 59
ci_0061                -3.048112e-03 3 1  ON 60
ci_0062                -3.285954e-03 3 1  ON 61
ci_0063                -9.734744e-03 3 1  ON 62
ci_0064                -9.677656e-03 3 1  ON 63
ci_0065                -7.010797e-03 3 1  ON 64
ci_0066                -6.500322e-03 3 1  ON 65
ci_0067                -3.984478e-03 3 1  ON 66
ci_0068                -3.848761e-03 3 1  ON 67
ci_0069                 3.742782e-03 3 1  ON 68
ci_0070                 3.573477e-03 3 1  ON 69
ci_0071                 4.222480e-03 3 1  ON 70
ci_0072                 4.361596e-03 3 1  ON 71
ci_0073                 3.357255e-03 3 1  ON 72
ci_0074                 3.276559e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8757
    reference variance = 0.302792
====================================================
  Execution time = 1.4407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9252e-01
  Total weights = 1.9512e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282487363043
                                         uncertainty =       0.001912321986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282487363043
                                         uncertainty =       0.001912321986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375815723
  error estimate for blocks of size 2^( 2) =       0.000393047239
  error estimate for blocks of size 2^( 3) =       0.000410883203
  error estimate for blocks of size 2^( 4) =       0.000427521455
  error estimate for blocks of size 2^( 5) =       0.000439771295
  error estimate for blocks of size 2^( 6) =       0.000447968008
  error estimate for blocks of size 2^( 7) =       0.000450768760

      target function =      -0.923794588650
              le_mean =     -16.897811771245
             les_mean =     285.828969330649
             stat err =       0.000441507379
             autocorr =       1.380149212691
   target nu stat err =       0.000441507379
   target dn stat err =       0.002787322896
      target stat err =       0.004436234647
              std dev =       0.531483692643
             le_variance =       0.282474915546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282343449209
                                         uncertainty =       0.001917554408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282343449209
                                         uncertainty =       0.001917554408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375720030
  error estimate for blocks of size 2^( 2) =       0.000392935914
  error estimate for blocks of size 2^( 3) =       0.000410751605
  error estimate for blocks of size 2^( 4) =       0.000427360806
  error estimate for blocks of size 2^( 5) =       0.000439595645
  error estimate for blocks of size 2^( 6) =       0.000447770809
  error estimate for blocks of size 2^( 7) =       0.000450582759

      target function =      -0.923865982361
              le_mean =     -16.897814982963
             les_mean =     285.829031572088
             stat err =       0.000441327505
             autocorr =       1.379727409148
   target nu stat err =       0.000441327505
   target dn stat err =       0.002871637426
      target stat err =       0.004567329133
              std dev =       0.531348362432
             le_variance =       0.282331082259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282407514207
                                         uncertainty =       0.001915006137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282407514207
                                         uncertainty =       0.001915006137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375762633
  error estimate for blocks of size 2^( 2) =       0.000392985870
  error estimate for blocks of size 2^( 3) =       0.000410811252
  error estimate for blocks of size 2^( 4) =       0.000427434073
  error estimate for blocks of size 2^( 5) =       0.000439676080
  error estimate for blocks of size 2^( 6) =       0.000447861366
  error estimate for blocks of size 2^( 7) =       0.000450668421

      target function =      -0.922982271801
              le_mean =     -16.897812815626
             les_mean =     285.829521279698
             stat err =       0.000441409985
             autocorr =       1.379930218335
   target nu stat err =       0.000441409985
   target dn stat err =       0.002957588207
      target stat err =       0.004691541155
              std dev =       0.531408611914
             le_variance =       0.282395112816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282476716503
                                         uncertainty =       0.001912644525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282476716503
                                         uncertainty =       0.001912644525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375808645
  error estimate for blocks of size 2^( 2) =       0.000393039105
  error estimate for blocks of size 2^( 3) =       0.000410873737
  error estimate for blocks of size 2^( 4) =       0.000427509976
  error estimate for blocks of size 2^( 5) =       0.000439758862
  error estimate for blocks of size 2^( 6) =       0.000447954254
  error estimate for blocks of size 2^( 7) =       0.000450755931

      target function =      -0.924298472740
              le_mean =     -16.897811812546
             les_mean =     285.828649780372
             stat err =       0.000441494756
             autocorr =       1.380122277895
   target nu stat err =       0.000441494756
   target dn stat err =       0.002776126818
      target stat err =       0.004423673698
              std dev =       0.531473682442
             le_variance =       0.282464275128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923794588650        initial
     6.2500e-01     6.2500e+00             7.3407e-04        -0.923865982361
     2.5000e+00     2.5000e+01             1.9297e-04        -0.922982271801
     1.0000e+01     1.0000e+02             4.8872e-05        -0.924298472740  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.3973e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.033495e-01 3 1  ON 0
ci_0002                 6.976626e-01 3 1  ON 1
ci_0003                -3.168890e-02 3 1  ON 2
ci_0004                -3.151092e-02 3 1  ON 3
ci_0005                -2.874573e-02 3 1  ON 4
ci_0006                -2.974976e-02 3 1  ON 5
ci_0007                -1.613827e-02 3 1  ON 6
ci_0008                -1.685354e-02 3 1  ON 7
ci_0009                -1.884573e-02 3 1  ON 8
ci_0010                -1.898452e-02 3 1  ON 9
ci_0011                -1.566609e-02 3 1  ON 10
ci_0012                -1.573934e-02 3 1  ON 11
ci_0013                 1.560982e-02 3 1  ON 12
ci_0014                 1.549585e-02 3 1  ON 13
ci_0015                 1.639950e-02 3 1  ON 14
ci_0016                 1.604091e-02 3 1  ON 15
ci_0017                 1.379803e-02 3 1  ON 16
ci_0018                 1.401600e-02 3 1  ON 17
ci_0019                 1.250998e-02 3 1  ON 18
ci_0020                 1.219619e-02 3 1  ON 19
ci_0021                 1.443518e-02 3 1  ON 20
ci_0022                 1.584588e-02 3 1  ON 21
ci_0023                -1.181412e-02 3 1  ON 22
ci_0024                -1.111431e-02 3 1  ON 23
ci_0025                -2.952170e-03 3 1  ON 24
ci_0026                -2.463603e-03 3 1  ON 25
ci_0027                -1.177796e-02 3 1  ON 26
ci_0028                -1.168064e-02 3 1  ON 27
ci_0029                -1.040097e-02 3 1  ON 28
ci_0030                -1.032831e-02 3 1  ON 29
ci_0031                 1.390205e-02 3 1  ON 30
ci_0032                 1.300849e-02 3 1  ON 31
ci_0033                 8.202631e-03 3 1  ON 32
ci_0034                 8.513053e-03 3 1  ON 33
ci_0035                 4.927082e-03 3 1  ON 34
ci_0036                 4.771016e-03 3 1  ON 35
ci_0037                -1.142553e-02 3 1  ON 36
ci_0038                -1.136092e-02 3 1  ON 37
ci_0039                -3.817351e-03 3 1  ON 38
ci_0040                -3.924660e-03 3 1  ON 39
ci_0041                 9.589572e-03 3 1  ON 40
ci_0042                 9.529581e-03 3 1  ON 41
ci_0043                -7.150893e-03 3 1  ON 42
ci_0044                -7.399162e-03 3 1  ON 43
ci_0045                 1.040726e-02 3 1  ON 44
ci_0046                 9.583083e-03 3 1  ON 45
ci_0047                -3.630450e-03 3 1  ON 46
ci_0048                -3.671811e-03 3 1  ON 47
ci_0049                -2.380869e-03 3 1  ON 48
ci_0050                -2.691172e-03 3 1  ON 49
ci_0051                -1.852447e-03 3 1  ON 50
ci_0052                -1.722747e-03 3 1  ON 51
ci_0053                -3.944910e-03 3 1  ON 52
ci_0054                -3.803773e-03 3 1  ON 53
ci_0055                 2.453456e-03 3 1  ON 54
ci_0056                 2.120452e-03 3 1  ON 55
ci_0057                 2.375902e-03 3 1  ON 56
ci_0058                 2.967626e-03 3 1  ON 57
ci_0059                -4.001904e-03 3 1  ON 58
ci_0060                -3.666231e-03 3 1  ON 59
ci_0061                -3.026874e-03 3 1  ON 60
ci_0062                -3.273615e-03 3 1  ON 61
ci_0063                -9.731387e-03 3 1  ON 62
ci_0064                -9.687133e-03 3 1  ON 63
ci_0065                -7.030311e-03 3 1  ON 64
ci_0066                -6.499729e-03 3 1  ON 65
ci_0067                -3.982689e-03 3 1  ON 66
ci_0068                -3.837504e-03 3 1  ON 67
ci_0069                 3.746637e-03 3 1  ON 68
ci_0070                 3.568331e-03 3 1  ON 69
ci_0071                 4.251682e-03 3 1  ON 70
ci_0072                 4.378531e-03 3 1  ON 71
ci_0073                 3.357195e-03 3 1  ON 72
ci_0074                 3.251689e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.915
    reference variance = 0.240401
====================================================
  Execution time = 1.4665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8867e-01
  Total weights = 1.951172868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280301326052
                                         uncertainty =       0.002098750624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280301326052
                                         uncertainty =       0.002098750624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374371796
  error estimate for blocks of size 2^( 2) =       0.000391745649
  error estimate for blocks of size 2^( 3) =       0.000409605196
  error estimate for blocks of size 2^( 4) =       0.000425281197
  error estimate for blocks of size 2^( 5) =       0.000437690051
  error estimate for blocks of size 2^( 6) =       0.000446016040
  error estimate for blocks of size 2^( 7) =       0.000448898053

      target function =      -0.930526766883
              le_mean =     -16.897918678997
             les_mean =     285.828326601587
             stat err =       0.000439471335
             autocorr =       1.378017906639
   target nu stat err =       0.000439471335
   target dn stat err =       0.002391731433
      target stat err =       0.003880998110
              std dev =       0.529441670848
             le_variance =       0.280308482830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689791867900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930541353777       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930570213718       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930576448298       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930581680537       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930583927284       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930584413973       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930584473836       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930584528603       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930584525781       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930584545448       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930584563561       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930584576874       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930584595549       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930584598678       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930584595756       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930584591702       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930584593581       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930584594673       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.909544e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930541353777       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930548737499       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930550323860       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930551643108       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930552206127       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930552326347       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930552340995       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930552354521       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930552353678       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930552358594       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930552363154       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930552366454       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930552370967       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930552371613       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930552370881       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930552369900       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930552370349       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930552370609       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.835433e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930541353777       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930543210563       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930543608922       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930543939431       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930544080260       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930544110220       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930544113862       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930544117233       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930544117013       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930544118242       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930544119384       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930544120207       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930544121325       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930544121478       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930544121295       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930544121052       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930544121163       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930544121227       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.212769e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7286e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.033382e-01 3 1  ON 0
ci_0002                 6.976770e-01 3 1  ON 1
ci_0003                -3.167575e-02 3 1  ON 2
ci_0004                -3.150620e-02 3 1  ON 3
ci_0005                -2.876070e-02 3 1  ON 4
ci_0006                -2.976166e-02 3 1  ON 5
ci_0007                -1.613328e-02 3 1  ON 6
ci_0008                -1.683632e-02 3 1  ON 7
ci_0009                -1.883969e-02 3 1  ON 8
ci_0010                -1.898277e-02 3 1  ON 9
ci_0011                -1.565562e-02 3 1  ON 10
ci_0012                -1.573816e-02 3 1  ON 11
ci_0013                 1.560484e-02 3 1  ON 12
ci_0014                 1.548662e-02 3 1  ON 13
ci_0015                 1.639277e-02 3 1  ON 14
ci_0016                 1.602932e-02 3 1  ON 15
ci_0017                 1.379143e-02 3 1  ON 16
ci_0018                 1.401009e-02 3 1  ON 17
ci_0019                 1.251424e-02 3 1  ON 18
ci_0020                 1.219790e-02 3 1  ON 19
ci_0021                 1.438683e-02 3 1  ON 20
ci_0022                 1.580804e-02 3 1  ON 21
ci_0023                -1.181892e-02 3 1  ON 22
ci_0024                -1.111280e-02 3 1  ON 23
ci_0025                -2.945613e-03 3 1  ON 24
ci_0026                -2.461768e-03 3 1  ON 25
ci_0027                -1.178115e-02 3 1  ON 26
ci_0028                -1.168301e-02 3 1  ON 27
ci_0029                -1.040122e-02 3 1  ON 28
ci_0030                -1.032893e-02 3 1  ON 29
ci_0031                 1.390059e-02 3 1  ON 30
ci_0032                 1.300534e-02 3 1  ON 31
ci_0033                 8.207337e-03 3 1  ON 32
ci_0034                 8.512858e-03 3 1  ON 33
ci_0035                 4.930908e-03 3 1  ON 34
ci_0036                 4.755692e-03 3 1  ON 35
ci_0037                -1.142491e-02 3 1  ON 36
ci_0038                -1.136058e-02 3 1  ON 37
ci_0039                -3.816187e-03 3 1  ON 38
ci_0040                -3.926641e-03 3 1  ON 39
ci_0041                 9.588060e-03 3 1  ON 40
ci_0042                 9.521163e-03 3 1  ON 41
ci_0043                -7.182459e-03 3 1  ON 42
ci_0044                -7.446246e-03 3 1  ON 43
ci_0045                 1.041045e-02 3 1  ON 44
ci_0046                 9.588271e-03 3 1  ON 45
ci_0047                -3.629982e-03 3 1  ON 46
ci_0048                -3.669256e-03 3 1  ON 47
ci_0049                -2.386168e-03 3 1  ON 48
ci_0050                -2.669208e-03 3 1  ON 49
ci_0051                -1.853444e-03 3 1  ON 50
ci_0052                -1.716642e-03 3 1  ON 51
ci_0053                -3.935147e-03 3 1  ON 52
ci_0054                -3.799797e-03 3 1  ON 53
ci_0055                 2.455243e-03 3 1  ON 54
ci_0056                 2.119527e-03 3 1  ON 55
ci_0057                 2.384188e-03 3 1  ON 56
ci_0058                 2.961226e-03 3 1  ON 57
ci_0059                -3.989166e-03 3 1  ON 58
ci_0060                -3.665177e-03 3 1  ON 59
ci_0061                -3.028835e-03 3 1  ON 60
ci_0062                -3.275133e-03 3 1  ON 61
ci_0063                -9.729911e-03 3 1  ON 62
ci_0064                -9.684429e-03 3 1  ON 63
ci_0065                -7.028135e-03 3 1  ON 64
ci_0066                -6.493515e-03 3 1  ON 65
ci_0067                -3.979313e-03 3 1  ON 66
ci_0068                -3.839900e-03 3 1  ON 67
ci_0069                 3.744407e-03 3 1  ON 68
ci_0070                 3.564353e-03 3 1  ON 69
ci_0071                 4.239332e-03 3 1  ON 70
ci_0072                 4.378872e-03 3 1  ON 71
ci_0073                 3.362264e-03 3 1  ON 72
ci_0074                 3.254450e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.313812
====================================================
  Execution time = 1.4235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9784e-01
  Total weights = 1.9511e+06
  Execution time = 1.8852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286667956739
                                         uncertainty =       0.002167942442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286667956739
                                         uncertainty =       0.002167942442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378584658
  error estimate for blocks of size 2^( 2) =       0.000396047536
  error estimate for blocks of size 2^( 3) =       0.000413882651
  error estimate for blocks of size 2^( 4) =       0.000430441909
  error estimate for blocks of size 2^( 5) =       0.000442294925
  error estimate for blocks of size 2^( 6) =       0.000450280466
  error estimate for blocks of size 2^( 7) =       0.000455176424

      target function =      -0.915935394794
              le_mean =     -16.897347083629
             les_mean =     285.818316633849
             stat err =       0.000444548431
             autocorr =       1.378834501717
   target nu stat err =       0.000444548431
   target dn stat err =       0.003115171954
      target stat err =       0.004857753969
              std dev =       0.535399558225
             le_variance =       0.286652686948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286605891119
                                         uncertainty =       0.002167466778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286605891119
                                         uncertainty =       0.002167466778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378543764
  error estimate for blocks of size 2^( 2) =       0.000396004094
  error estimate for blocks of size 2^( 3) =       0.000413833373
  error estimate for blocks of size 2^( 4) =       0.000430385746
  error estimate for blocks of size 2^( 5) =       0.000442232182
  error estimate for blocks of size 2^( 6) =       0.000450216562
  error estimate for blocks of size 2^( 7) =       0.000455113198

      target function =      -0.916300992857
              le_mean =     -16.897347098323
             les_mean =     285.818080198932
             stat err =       0.000444486922
             autocorr =       1.378750817420
   target nu stat err =       0.000444486922
   target dn stat err =       0.003090223526
      target stat err =       0.004823559501
              std dev =       0.535341724602
             le_variance =       0.286590762100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286636122671
                                         uncertainty =       0.002167673300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286636122671
                                         uncertainty =       0.002167673300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378563683
  error estimate for blocks of size 2^( 2) =       0.000396025406
  error estimate for blocks of size 2^( 3) =       0.000413857630
  error estimate for blocks of size 2^( 4) =       0.000430413505
  error estimate for blocks of size 2^( 5) =       0.000442262759
  error estimate for blocks of size 2^( 6) =       0.000450247520
  error estimate for blocks of size 2^( 7) =       0.000455143090

      target function =      -0.785770406061
              le_mean =     -16.897347230424
             les_mean =     285.905573802154
             stat err =       0.000444516718
             autocorr =       1.378790563333
   target nu stat err =       0.000444516718
   target dn stat err =       0.087581164203
      target stat err =       0.100952525663
              std dev =       0.535369895035
             le_variance =       0.286620924510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286663900740
                                         uncertainty =       0.002167906253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286663900740
                                         uncertainty =       0.002167906253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378581986
  error estimate for blocks of size 2^( 2) =       0.000396044701
  error estimate for blocks of size 2^( 3) =       0.000413879445
  error estimate for blocks of size 2^( 4) =       0.000430438262
  error estimate for blocks of size 2^( 5) =       0.000442290858
  error estimate for blocks of size 2^( 6) =       0.000450276326
  error estimate for blocks of size 2^( 7) =       0.000455172326

      target function =      -0.916001377662
              le_mean =     -16.897347069313
             les_mean =     285.818273385211
             stat err =       0.000444544443
             autocorr =       1.378829231139
   target nu stat err =       0.000444544443
   target dn stat err =       0.003109654928
      target stat err =       0.004850043643
              std dev =       0.535395778892
             le_variance =       0.286648640055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915935394794        initial
     2.5000e+00     2.5000e+01             1.9095e-04        -0.916300992857  <--
     1.0000e+01     1.0000e+02             4.8354e-05        -0.785770406061
     4.0000e+01     4.0000e+02             1.2128e-05        -0.916001377662

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3828e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.033044e-01 3 1  ON 0
ci_0002                 6.977201e-01 3 1  ON 1
ci_0003                -3.163715e-02 3 1  ON 2
ci_0004                -3.149240e-02 3 1  ON 3
ci_0005                -2.880455e-02 3 1  ON 4
ci_0006                -2.979647e-02 3 1  ON 5
ci_0007                -1.611854e-02 3 1  ON 6
ci_0008                -1.678536e-02 3 1  ON 7
ci_0009                -1.882202e-02 3 1  ON 8
ci_0010                -1.897771e-02 3 1  ON 9
ci_0011                -1.562489e-02 3 1  ON 10
ci_0012                -1.573471e-02 3 1  ON 11
ci_0013                 1.559025e-02 3 1  ON 12
ci_0014                 1.545963e-02 3 1  ON 13
ci_0015                 1.637303e-02 3 1  ON 14
ci_0016                 1.599541e-02 3 1  ON 15
ci_0017                 1.377209e-02 3 1  ON 16
ci_0018                 1.399284e-02 3 1  ON 17
ci_0019                 1.252670e-02 3 1  ON 18
ci_0020                 1.220291e-02 3 1  ON 19
ci_0021                 1.424423e-02 3 1  ON 20
ci_0022                 1.569655e-02 3 1  ON 21
ci_0023                -1.183294e-02 3 1  ON 22
ci_0024                -1.110843e-02 3 1  ON 23
ci_0025                -2.926542e-03 3 1  ON 24
ci_0026                -2.456429e-03 3 1  ON 25
ci_0027                -1.179050e-02 3 1  ON 26
ci_0028                -1.168999e-02 3 1  ON 27
ci_0029                -1.040202e-02 3 1  ON 28
ci_0030                -1.033080e-02 3 1  ON 29
ci_0031                 1.389632e-02 3 1  ON 30
ci_0032                 1.299600e-02 3 1  ON 31
ci_0033                 8.221155e-03 3 1  ON 32
ci_0034                 8.512283e-03 3 1  ON 33
ci_0035                 4.941960e-03 3 1  ON 34
ci_0036                 4.711121e-03 3 1  ON 35
ci_0037                -1.142307e-02 3 1  ON 36
ci_0038                -1.135959e-02 3 1  ON 37
ci_0039                -3.812794e-03 3 1  ON 38
ci_0040                -3.932421e-03 3 1  ON 39
ci_0041                 9.583599e-03 3 1  ON 40
ci_0042                 9.496511e-03 3 1  ON 41
ci_0043                -7.275344e-03 3 1  ON 42
ci_0044                -7.585066e-03 3 1  ON 43
ci_0045                 1.041982e-02 3 1  ON 44
ci_0046                 9.603511e-03 3 1  ON 45
ci_0047                -3.628615e-03 3 1  ON 46
ci_0048                -3.661814e-03 3 1  ON 47
ci_0049                -2.401575e-03 3 1  ON 48
ci_0050                -2.605353e-03 3 1  ON 49
ci_0051                -1.856318e-03 3 1  ON 50
ci_0052                -1.698906e-03 3 1  ON 51
ci_0053                -3.906745e-03 3 1  ON 52
ci_0054                -3.788246e-03 3 1  ON 53
ci_0055                 2.460438e-03 3 1  ON 54
ci_0056                 2.116839e-03 3 1  ON 55
ci_0057                 2.408275e-03 3 1  ON 56
ci_0058                 2.942598e-03 3 1  ON 57
ci_0059                -3.952126e-03 3 1  ON 58
ci_0060                -3.662108e-03 3 1  ON 59
ci_0061                -3.034558e-03 3 1  ON 60
ci_0062                -3.279578e-03 3 1  ON 61
ci_0063                -9.725551e-03 3 1  ON 62
ci_0064                -9.676495e-03 3 1  ON 63
ci_0065                -7.021764e-03 3 1  ON 64
ci_0066                -6.475373e-03 3 1  ON 65
ci_0067                -3.969471e-03 3 1  ON 66
ci_0068                -3.846872e-03 3 1  ON 67
ci_0069                 3.737905e-03 3 1  ON 68
ci_0070                 3.552792e-03 3 1  ON 69
ci_0071                 4.203407e-03 3 1  ON 70
ci_0072                 4.379867e-03 3 1  ON 71
ci_0073                 3.376992e-03 3 1  ON 72
ci_0074                 3.262488e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9421
    reference variance = 0.693149
====================================================
  Execution time = 1.4653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9441e-01
  Total weights = 1.951148050e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284494716745
                                         uncertainty =       0.001817257558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284494716745
                                         uncertainty =       0.001817257558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377143146
  error estimate for blocks of size 2^( 2) =       0.000394332875
  error estimate for blocks of size 2^( 3) =       0.000411605727
  error estimate for blocks of size 2^( 4) =       0.000427366904
  error estimate for blocks of size 2^( 5) =       0.000439045690
  error estimate for blocks of size 2^( 6) =       0.000446107264
  error estimate for blocks of size 2^( 7) =       0.000449521795

      target function =      -0.921474522277
              le_mean =     -16.898343549521
             les_mean =     285.848424288151
             stat err =       0.000440510413
             autocorr =       1.364268713219
   target nu stat err =       0.000440510413
   target dn stat err =       0.002889893506
      target stat err =       0.004576363115
              std dev =       0.533360951720
             le_variance =       0.284473904820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689834354952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921495955300       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921642112224       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921664344300       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921678840364       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921691145360       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921693088935       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921693706283       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921694448977       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921695084980       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921695483225       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921696066326       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921696569688       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921696963464       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921696918225       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921696988184       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921696977042       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921696978473       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921696992901       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921696994820       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 7.549490e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921495955300       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921535851942       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921541827478       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921545602255       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921548721461       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921549200467       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921549348994       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921549534896       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921549697374       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921549793771       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921549940067       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921550053168       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921550133929       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921550120621       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921550134525       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921550131708       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921550132137       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921550135081       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921550135420       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.983707e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921495955300       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921506163927       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921507686321       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921508639596       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921509421559       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921509540714       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921509577417       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921509623892       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921509664732       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921509688584       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921509725132       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921509752502       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921509771581       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921509768171       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921509771435       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921509770737       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921509770850       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921509771545       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921509771622       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 5.023459e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7250e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.031834e-01 3 1  ON 0
ci_0002                 6.978543e-01 3 1  ON 1
ci_0003                -3.161166e-02 3 1  ON 2
ci_0004                -3.147866e-02 3 1  ON 3
ci_0005                -2.880907e-02 3 1  ON 4
ci_0006                -2.984301e-02 3 1  ON 5
ci_0007                -1.603675e-02 3 1  ON 6
ci_0008                -1.671799e-02 3 1  ON 7
ci_0009                -1.881537e-02 3 1  ON 8
ci_0010                -1.897723e-02 3 1  ON 9
ci_0011                -1.561365e-02 3 1  ON 10
ci_0012                -1.572606e-02 3 1  ON 11
ci_0013                 1.558205e-02 3 1  ON 12
ci_0014                 1.545168e-02 3 1  ON 13
ci_0015                 1.636594e-02 3 1  ON 14
ci_0016                 1.599965e-02 3 1  ON 15
ci_0017                 1.374920e-02 3 1  ON 16
ci_0018                 1.398082e-02 3 1  ON 17
ci_0019                 1.253575e-02 3 1  ON 18
ci_0020                 1.220922e-02 3 1  ON 19
ci_0021                 1.404586e-02 3 1  ON 20
ci_0022                 1.556174e-02 3 1  ON 21
ci_0023                -1.182085e-02 3 1  ON 22
ci_0024                -1.112303e-02 3 1  ON 23
ci_0025                -2.899246e-03 3 1  ON 24
ci_0026                -2.389502e-03 3 1  ON 25
ci_0027                -1.180779e-02 3 1  ON 26
ci_0028                -1.167013e-02 3 1  ON 27
ci_0029                -1.041251e-02 3 1  ON 28
ci_0030                -1.033540e-02 3 1  ON 29
ci_0031                 1.389806e-02 3 1  ON 30
ci_0032                 1.299265e-02 3 1  ON 31
ci_0033                 8.202452e-03 3 1  ON 32
ci_0034                 8.497846e-03 3 1  ON 33
ci_0035                 4.825001e-03 3 1  ON 34
ci_0036                 4.737629e-03 3 1  ON 35
ci_0037                -1.142250e-02 3 1  ON 36
ci_0038                -1.134261e-02 3 1  ON 37
ci_0039                -3.820215e-03 3 1  ON 38
ci_0040                -3.940790e-03 3 1  ON 39
ci_0041                 9.567875e-03 3 1  ON 40
ci_0042                 9.482215e-03 3 1  ON 41
ci_0043                -7.374527e-03 3 1  ON 42
ci_0044                -7.738980e-03 3 1  ON 43
ci_0045                 1.042278e-02 3 1  ON 44
ci_0046                 9.647444e-03 3 1  ON 45
ci_0047                -3.614685e-03 3 1  ON 46
ci_0048                -3.662993e-03 3 1  ON 47
ci_0049                -2.442340e-03 3 1  ON 48
ci_0050                -2.616503e-03 3 1  ON 49
ci_0051                -1.835863e-03 3 1  ON 50
ci_0052                -1.710230e-03 3 1  ON 51
ci_0053                -3.845819e-03 3 1  ON 52
ci_0054                -3.766441e-03 3 1  ON 53
ci_0055                 2.439765e-03 3 1  ON 54
ci_0056                 2.121098e-03 3 1  ON 55
ci_0057                 2.395129e-03 3 1  ON 56
ci_0058                 2.948007e-03 3 1  ON 57
ci_0059                -3.916500e-03 3 1  ON 58
ci_0060                -3.649383e-03 3 1  ON 59
ci_0061                -3.035106e-03 3 1  ON 60
ci_0062                -3.274979e-03 3 1  ON 61
ci_0063                -9.726996e-03 3 1  ON 62
ci_0064                -9.668447e-03 3 1  ON 63
ci_0065                -6.999902e-03 3 1  ON 64
ci_0066                -6.471843e-03 3 1  ON 65
ci_0067                -3.930407e-03 3 1  ON 66
ci_0068                -3.830738e-03 3 1  ON 67
ci_0069                 3.715661e-03 3 1  ON 68
ci_0070                 3.560457e-03 3 1  ON 69
ci_0071                 4.117888e-03 3 1  ON 70
ci_0072                 4.359302e-03 3 1  ON 71
ci_0073                 3.375875e-03 3 1  ON 72
ci_0074                 3.277087e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8712
    reference variance = 0.153391
====================================================
  Execution time = 1.4290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9043e-01
  Total weights = 1.9512e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279426066592
                                         uncertainty =       0.001531665614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279426066592
                                         uncertainty =       0.001531665614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373801966
  error estimate for blocks of size 2^( 2) =       0.000391326795
  error estimate for blocks of size 2^( 3) =       0.000409016887
  error estimate for blocks of size 2^( 4) =       0.000424272799
  error estimate for blocks of size 2^( 5) =       0.000435525162
  error estimate for blocks of size 2^( 6) =       0.000443214254
  error estimate for blocks of size 2^( 7) =       0.000448649085

      target function =      -0.927476213347
              le_mean =     -16.898055392492
             les_mean =     285.834867653965
             stat err =       0.000437915325
             autocorr =       1.372451872521
   target nu stat err =       0.000437915325
   target dn stat err =       0.002737491035
      target stat err =       0.004394429965
              std dev =       0.528635810394
             le_variance =       0.279455820030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279387149904
                                         uncertainty =       0.001558835149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279387149904
                                         uncertainty =       0.001558835149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775048
  error estimate for blocks of size 2^( 2) =       0.000391280929
  error estimate for blocks of size 2^( 3) =       0.000408950640
  error estimate for blocks of size 2^( 4) =       0.000424185124
  error estimate for blocks of size 2^( 5) =       0.000435426902
  error estimate for blocks of size 2^( 6) =       0.000443112179
  error estimate for blocks of size 2^( 7) =       0.000448543248

      target function =      -0.927304308619
              le_mean =     -16.898059057986
             les_mean =     285.835100136025
             stat err =       0.000437816863
             autocorr =       1.372032367634
   target nu stat err =       0.000437816863
   target dn stat err =       0.002749929748
      target stat err =       0.004412211580
              std dev =       0.528597742637
             le_variance =       0.279415573521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279391130942
                                         uncertainty =       0.001542018934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279391130942
                                         uncertainty =       0.001542018934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373778157
  error estimate for blocks of size 2^( 2) =       0.000391293549
  error estimate for blocks of size 2^( 3) =       0.000408972590
  error estimate for blocks of size 2^( 4) =       0.000424217431
  error estimate for blocks of size 2^( 5) =       0.000435464111
  error estimate for blocks of size 2^( 6) =       0.000443151203
  error estimate for blocks of size 2^( 7) =       0.000448583685

      target function =      -0.726028669211
              le_mean =     -16.898056934401
             les_mean =     285.971683056227
             stat err =       0.000437854107
             autocorr =       1.372242987475
   target nu stat err =       0.000437854107
   target dn stat err =       0.136984930872
      target stat err =       0.137548689889
              std dev =       0.528602138712
             le_variance =       0.279420221051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279419981255
                                         uncertainty =       0.001532636051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279419981255
                                         uncertainty =       0.001532636051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373797843
  error estimate for blocks of size 2^( 2) =       0.000391321478
  error estimate for blocks of size 2^( 3) =       0.000409010239
  error estimate for blocks of size 2^( 4) =       0.000424264746
  error estimate for blocks of size 2^( 5) =       0.000435516289
  error estimate for blocks of size 2^( 6) =       0.000443204974
  error estimate for blocks of size 2^( 7) =       0.000448639607

      target function =      -0.927663828265
              le_mean =     -16.898055421116
             les_mean =     285.834750062998
             stat err =       0.000437906404
             autocorr =       1.372426234113
   target nu stat err =       0.000437906404
   target dn stat err =       0.002735117876
      target stat err =       0.004392478844
              std dev =       0.528629978995
             le_variance =       0.279449654692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927476213347        initial
     6.2500e-01     6.2500e+00             7.5495e-04        -0.927304308619
     2.5000e+00     2.5000e+01             1.9837e-04        -0.726028669211
     1.0000e+01     1.0000e+02             5.0235e-05        -0.927663828265  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.3815e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.032742e-01 3 1  ON 0
ci_0002                 6.977537e-01 3 1  ON 1
ci_0003                -3.163070e-02 3 1  ON 2
ci_0004                -3.148888e-02 3 1  ON 3
ci_0005                -2.880575e-02 3 1  ON 4
ci_0006                -2.980829e-02 3 1  ON 5
ci_0007                -1.609788e-02 3 1  ON 6
ci_0008                -1.676833e-02 3 1  ON 7
ci_0009                -1.882034e-02 3 1  ON 8
ci_0010                -1.897757e-02 3 1  ON 9
ci_0011                -1.562205e-02 3 1  ON 10
ci_0012                -1.573251e-02 3 1  ON 11
ci_0013                 1.558817e-02 3 1  ON 12
ci_0014                 1.545759e-02 3 1  ON 13
ci_0015                 1.637125e-02 3 1  ON 14
ci_0016                 1.599648e-02 3 1  ON 15
ci_0017                 1.376627e-02 3 1  ON 16
ci_0018                 1.398977e-02 3 1  ON 17
ci_0019                 1.252902e-02 3 1  ON 18
ci_0020                 1.220451e-02 3 1  ON 19
ci_0021                 1.419399e-02 3 1  ON 20
ci_0022                 1.566240e-02 3 1  ON 21
ci_0023                -1.182987e-02 3 1  ON 22
ci_0024                -1.111214e-02 3 1  ON 23
ci_0025                -2.919564e-03 3 1  ON 24
ci_0026                -2.439289e-03 3 1  ON 25
ci_0027                -1.179491e-02 3 1  ON 26
ci_0028                -1.168492e-02 3 1  ON 27
ci_0029                -1.040469e-02 3 1  ON 28
ci_0030                -1.033195e-02 3 1  ON 29
ci_0031                 1.389677e-02 3 1  ON 30
ci_0032                 1.299515e-02 3 1  ON 31
ci_0033                 8.216404e-03 3 1  ON 32
ci_0034                 8.508612e-03 3 1  ON 33
ci_0035                 4.912048e-03 3 1  ON 34
ci_0036                 4.717902e-03 3 1  ON 35
ci_0037                -1.142294e-02 3 1  ON 36
ci_0038                -1.135526e-02 3 1  ON 37
ci_0039                -3.814693e-03 3 1  ON 38
ci_0040                -3.934556e-03 3 1  ON 39
ci_0041                 9.579613e-03 3 1  ON 40
ci_0042                 9.492871e-03 3 1  ON 41
ci_0043                -7.300500e-03 3 1  ON 42
ci_0044                -7.624036e-03 3 1  ON 43
ci_0045                 1.042058e-02 3 1  ON 44
ci_0046                 9.614659e-03 3 1  ON 45
ci_0047                -3.625059e-03 3 1  ON 46
ci_0048                -3.662111e-03 3 1  ON 47
ci_0049                -2.411999e-03 3 1  ON 48
ci_0050                -2.608205e-03 3 1  ON 49
ci_0051                -1.851084e-03 3 1  ON 50
ci_0052                -1.701808e-03 3 1  ON 51
ci_0053                -3.891164e-03 3 1  ON 52
ci_0054                -3.782665e-03 3 1  ON 53
ci_0055                 2.455152e-03 3 1  ON 54
ci_0056                 2.117940e-03 3 1  ON 55
ci_0057                 2.404916e-03 3 1  ON 56
ci_0058                 2.943992e-03 3 1  ON 57
ci_0059                -3.943015e-03 3 1  ON 58
ci_0060                -3.658850e-03 3 1  ON 59
ci_0061                -3.034697e-03 3 1  ON 60
ci_0062                -3.278404e-03 3 1  ON 61
ci_0063                -9.725937e-03 3 1  ON 62
ci_0064                -9.674445e-03 3 1  ON 63
ci_0065                -7.016202e-03 3 1  ON 64
ci_0066                -6.474469e-03 3 1  ON 65
ci_0067                -3.959480e-03 3 1  ON 66
ci_0068                -3.842743e-03 3 1  ON 67
ci_0069                 3.732218e-03 3 1  ON 68
ci_0070                 3.554748e-03 3 1  ON 69
ci_0071                 4.181533e-03 3 1  ON 70
ci_0072                 4.374599e-03 3 1  ON 71
ci_0073                 3.376711e-03 3 1  ON 72
ci_0074                 3.266222e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.227011
====================================================
  Execution time = 1.6886e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8963e-01
  Total weights = 1.951314480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281292702262
                                         uncertainty =       0.001696161722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281292702262
                                         uncertainty =       0.001696161722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375035172
  error estimate for blocks of size 2^( 2) =       0.000392800312
  error estimate for blocks of size 2^( 3) =       0.000410962081
  error estimate for blocks of size 2^( 4) =       0.000425605822
  error estimate for blocks of size 2^( 5) =       0.000437763584
  error estimate for blocks of size 2^( 6) =       0.000445949818
  error estimate for blocks of size 2^( 7) =       0.000448520522

      target function =      -0.929018045991
              le_mean =     -16.898179872254
             les_mean =     285.838109479067
             stat err =       0.000439459937
             autocorr =       1.373076009236
   target nu stat err =       0.000439459937
   target dn stat err =       0.001926244962
      target stat err =       0.003148827318
              std dev =       0.530379826757
             le_variance =       0.281302760631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689817987225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929027256930       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929050215347       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929057013786       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929064786287       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929066715407       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929067199362       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929067612820       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929067698892       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929067785031       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929067880667       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929067972043       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929068006423       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929068072999       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929068087189       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929068095437       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929068095632       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929068091982       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929068093223       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 2.099442e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929027256930       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929033132052       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929034862532       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929036823330       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929037306163       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929037426236       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929037529095       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929037550336       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929037571788       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929037595669       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929037618329       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929037626535       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929037642419       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929037645711       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929037647665       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929037647666       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929037646772       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929037647056       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 5.318725e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929027256930       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929028734431       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929029169022       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929029660326       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929029781060       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929029811018       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929029836699       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929029841992       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929029847349       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929029853317       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929029858970       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929029860996       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929029864920       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929029865727       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929029866209       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929029866206       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929029865984       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929029866054       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.334137e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9473e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.032446e-01 3 1  ON 0
ci_0002                 6.977863e-01 3 1  ON 1
ci_0003                -3.162234e-02 3 1  ON 2
ci_0004                -3.148355e-02 3 1  ON 3
ci_0005                -2.881745e-02 3 1  ON 4
ci_0006                -2.981941e-02 3 1  ON 5
ci_0007                -1.606999e-02 3 1  ON 6
ci_0008                -1.675953e-02 3 1  ON 7
ci_0009                -1.881434e-02 3 1  ON 8
ci_0010                -1.897418e-02 3 1  ON 9
ci_0011                -1.561171e-02 3 1  ON 10
ci_0012                -1.572990e-02 3 1  ON 11
ci_0013                 1.557761e-02 3 1  ON 12
ci_0014                 1.544930e-02 3 1  ON 13
ci_0015                 1.636574e-02 3 1  ON 14
ci_0016                 1.599650e-02 3 1  ON 15
ci_0017                 1.376527e-02 3 1  ON 16
ci_0018                 1.398488e-02 3 1  ON 17
ci_0019                 1.253279e-02 3 1  ON 18
ci_0020                 1.220691e-02 3 1  ON 19
ci_0021                 1.415826e-02 3 1  ON 20
ci_0022                 1.560921e-02 3 1  ON 21
ci_0023                -1.183005e-02 3 1  ON 22
ci_0024                -1.111188e-02 3 1  ON 23
ci_0025                -2.906352e-03 3 1  ON 24
ci_0026                -2.439796e-03 3 1  ON 25
ci_0027                -1.179677e-02 3 1  ON 26
ci_0028                -1.168849e-02 3 1  ON 27
ci_0029                -1.040501e-02 3 1  ON 28
ci_0030                -1.033311e-02 3 1  ON 29
ci_0031                 1.389988e-02 3 1  ON 30
ci_0032                 1.298836e-02 3 1  ON 31
ci_0033                 8.225095e-03 3 1  ON 32
ci_0034                 8.511918e-03 3 1  ON 33
ci_0035                 4.904248e-03 3 1  ON 34
ci_0036                 4.710040e-03 3 1  ON 35
ci_0037                -1.142398e-02 3 1  ON 36
ci_0038                -1.135470e-02 3 1  ON 37
ci_0039                -3.816305e-03 3 1  ON 38
ci_0040                -3.932823e-03 3 1  ON 39
ci_0041                 9.576970e-03 3 1  ON 40
ci_0042                 9.491364e-03 3 1  ON 41
ci_0043                -7.324363e-03 3 1  ON 42
ci_0044                -7.677080e-03 3 1  ON 43
ci_0045                 1.042302e-02 3 1  ON 44
ci_0046                 9.627656e-03 3 1  ON 45
ci_0047                -3.623079e-03 3 1  ON 46
ci_0048                -3.661219e-03 3 1  ON 47
ci_0049                -2.417989e-03 3 1  ON 48
ci_0050                -2.601138e-03 3 1  ON 49
ci_0051                -1.849030e-03 3 1  ON 50
ci_0052                -1.706813e-03 3 1  ON 51
ci_0053                -3.887370e-03 3 1  ON 52
ci_0054                -3.781241e-03 3 1  ON 53
ci_0055                 2.440745e-03 3 1  ON 54
ci_0056                 2.105065e-03 3 1  ON 55
ci_0057                 2.388742e-03 3 1  ON 56
ci_0058                 2.936483e-03 3 1  ON 57
ci_0059                -3.940345e-03 3 1  ON 58
ci_0060                -3.659443e-03 3 1  ON 59
ci_0061                -3.039011e-03 3 1  ON 60
ci_0062                -3.276110e-03 3 1  ON 61
ci_0063                -9.727989e-03 3 1  ON 62
ci_0064                -9.674195e-03 3 1  ON 63
ci_0065                -7.011199e-03 3 1  ON 64
ci_0066                -6.471242e-03 3 1  ON 65
ci_0067                -3.958675e-03 3 1  ON 66
ci_0068                -3.840647e-03 3 1  ON 67
ci_0069                 3.730801e-03 3 1  ON 68
ci_0070                 3.555513e-03 3 1  ON 69
ci_0071                 4.181078e-03 3 1  ON 70
ci_0072                 4.366765e-03 3 1  ON 71
ci_0073                 3.378949e-03 3 1  ON 72
ci_0074                 3.270921e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.280872
====================================================
  Execution time = 1.4414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9429e-01
  Total weights = 1.9508e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283850888480
                                         uncertainty =       0.002104313627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283850888480
                                         uncertainty =       0.002104313627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376748786
  error estimate for blocks of size 2^( 2) =       0.000394275093
  error estimate for blocks of size 2^( 3) =       0.000411579695
  error estimate for blocks of size 2^( 4) =       0.000426860659
  error estimate for blocks of size 2^( 5) =       0.000438178642
  error estimate for blocks of size 2^( 6) =       0.000445520489
  error estimate for blocks of size 2^( 7) =       0.000449391271

      target function =      -0.921318891570
              le_mean =     -16.897877537189
             les_mean =     285.832776819232
             stat err =       0.000439987765
             autocorr =       1.363884131318
   target nu stat err =       0.000439987765
   target dn stat err =       0.002540908123
      target stat err =       0.004034431956
              std dev =       0.532803243318
             le_variance =       0.283879296090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283795803677
                                         uncertainty =       0.002099574854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283795803677
                                         uncertainty =       0.002099574854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376712203
  error estimate for blocks of size 2^( 2) =       0.000394235020
  error estimate for blocks of size 2^( 3) =       0.000411533907
  error estimate for blocks of size 2^( 4) =       0.000426809700
  error estimate for blocks of size 2^( 5) =       0.000438125995
  error estimate for blocks of size 2^( 6) =       0.000445466882
  error estimate for blocks of size 2^( 7) =       0.000449342034

      target function =      -0.922167587336
              le_mean =     -16.897876803406
             les_mean =     285.832209550804
             stat err =       0.000439936153
             autocorr =       1.363829024437
   target nu stat err =       0.000439936153
   target dn stat err =       0.002430954512
      target stat err =       0.003872900526
              std dev =       0.532751506134
             le_variance =       0.283824167288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283822554103
                                         uncertainty =       0.002101899553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283822554103
                                         uncertainty =       0.002101899553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376729969
  error estimate for blocks of size 2^( 2) =       0.000394254501
  error estimate for blocks of size 2^( 3) =       0.000411556206
  error estimate for blocks of size 2^( 4) =       0.000426834567
  error estimate for blocks of size 2^( 5) =       0.000438151712
  error estimate for blocks of size 2^( 6) =       0.000445493123
  error estimate for blocks of size 2^( 7) =       0.000449366127

      target function =      -0.921886633310
              le_mean =     -16.897877100035
             les_mean =     285.832399143017
             stat err =       0.000439961382
             autocorr =       1.363856803875
   target nu stat err =       0.000439961382
   target dn stat err =       0.002456165062
      target stat err =       0.003909254699
              std dev =       0.532776632195
             le_variance =       0.283850939813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283847291445
                                         uncertainty =       0.002104010069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283847291445
                                         uncertainty =       0.002104010069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376746398
  error estimate for blocks of size 2^( 2) =       0.000394272478
  error estimate for blocks of size 2^( 3) =       0.000411576716
  error estimate for blocks of size 2^( 4) =       0.000426857355
  error estimate for blocks of size 2^( 5) =       0.000438175236
  error estimate for blocks of size 2^( 6) =       0.000445517033
  error estimate for blocks of size 2^( 7) =       0.000449388093

      target function =      -0.921417870637
              le_mean =     -16.897877475104
             les_mean =     285.832711448367
             stat err =       0.000439984429
             autocorr =       1.363880744474
   target nu stat err =       0.000439984429
   target dn stat err =       0.002523143082
      target stat err =       0.004008034108
              std dev =       0.532799865191
             le_variance =       0.283875696348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921318891570        initial
     2.5000e+00     2.5000e+01             2.0994e-04        -0.922167587336  <--
     1.0000e+01     1.0000e+02             5.3187e-05        -0.921886633310
     4.0000e+01     4.0000e+02             1.3341e-05        -0.921417870637

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3960e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.031560e-01 3 1  ON 0
ci_0002                 6.978840e-01 3 1  ON 1
ci_0003                -3.159773e-02 3 1  ON 2
ci_0004                -3.146797e-02 3 1  ON 3
ci_0005                -2.885169e-02 3 1  ON 4
ci_0006                -2.985197e-02 3 1  ON 5
ci_0007                -1.598760e-02 3 1  ON 6
ci_0008                -1.673349e-02 3 1  ON 7
ci_0009                -1.879677e-02 3 1  ON 8
ci_0010                -1.896436e-02 3 1  ON 9
ci_0011                -1.558135e-02 3 1  ON 10
ci_0012                -1.572229e-02 3 1  ON 11
ci_0013                 1.554667e-02 3 1  ON 12
ci_0014                 1.542508e-02 3 1  ON 13
ci_0015                 1.634959e-02 3 1  ON 14
ci_0016                 1.599660e-02 3 1  ON 15
ci_0017                 1.376229e-02 3 1  ON 16
ci_0018                 1.397063e-02 3 1  ON 17
ci_0019                 1.254379e-02 3 1  ON 18
ci_0020                 1.221395e-02 3 1  ON 19
ci_0021                 1.405288e-02 3 1  ON 20
ci_0022                 1.545245e-02 3 1  ON 21
ci_0023                -1.183055e-02 3 1  ON 22
ci_0024                -1.111117e-02 3 1  ON 23
ci_0025                -2.867910e-03 3 1  ON 24
ci_0026                -2.441276e-03 3 1  ON 25
ci_0027                -1.180220e-02 3 1  ON 26
ci_0028                -1.169900e-02 3 1  ON 27
ci_0029                -1.040599e-02 3 1  ON 28
ci_0030                -1.033658e-02 3 1  ON 29
ci_0031                 1.390897e-02 3 1  ON 30
ci_0032                 1.296832e-02 3 1  ON 31
ci_0033                 8.250650e-03 3 1  ON 32
ci_0034                 8.521658e-03 3 1  ON 33
ci_0035                 4.881514e-03 3 1  ON 34
ci_0036                 4.687136e-03 3 1  ON 35
ci_0037                -1.142703e-02 3 1  ON 36
ci_0038                -1.135305e-02 3 1  ON 37
ci_0039                -3.820994e-03 3 1  ON 38
ci_0040                -3.927791e-03 3 1  ON 39
ci_0041                 9.569195e-03 3 1  ON 40
ci_0042                 9.486958e-03 3 1  ON 41
ci_0043                -7.394581e-03 3 1  ON 42
ci_0044                -7.833406e-03 3 1  ON 43
ci_0045                 1.043014e-02 3 1  ON 44
ci_0046                 9.665853e-03 3 1  ON 45
ci_0047                -3.617292e-03 3 1  ON 46
ci_0048                -3.658630e-03 3 1  ON 47
ci_0049                -2.435401e-03 3 1  ON 48
ci_0050                -2.580614e-03 3 1  ON 49
ci_0051                -1.843050e-03 3 1  ON 50
ci_0052                -1.721326e-03 3 1  ON 51
ci_0053                -3.876327e-03 3 1  ON 52
ci_0054                -3.777118e-03 3 1  ON 53
ci_0055                 2.398880e-03 3 1  ON 54
ci_0056                 2.067618e-03 3 1  ON 55
ci_0057                 2.341748e-03 3 1  ON 56
ci_0058                 2.914620e-03 3 1  ON 57
ci_0059                -3.932553e-03 3 1  ON 58
ci_0060                -3.661178e-03 3 1  ON 59
ci_0061                -3.051615e-03 3 1  ON 60
ci_0062                -3.269405e-03 3 1  ON 61
ci_0063                -9.733928e-03 3 1  ON 62
ci_0064                -9.673451e-03 3 1  ON 63
ci_0065                -6.996561e-03 3 1  ON 64
ci_0066                -6.461822e-03 3 1  ON 65
ci_0067                -3.956321e-03 3 1  ON 66
ci_0068                -3.834557e-03 3 1  ON 67
ci_0069                 3.726674e-03 3 1  ON 68
ci_0070                 3.557744e-03 3 1  ON 69
ci_0071                 4.179745e-03 3 1  ON 70
ci_0072                 4.344005e-03 3 1  ON 71
ci_0073                 3.385445e-03 3 1  ON 72
ci_0074                 3.284595e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8328
    reference variance = 0.29614
====================================================
  Execution time = 1.4632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9662e-01
  Total weights = 1.950888630e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284510642482
                                         uncertainty =       0.001742223418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284510642482
                                         uncertainty =       0.001742223418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377141939
  error estimate for blocks of size 2^( 2) =       0.000394499586
  error estimate for blocks of size 2^( 3) =       0.000411827614
  error estimate for blocks of size 2^( 4) =       0.000427326920
  error estimate for blocks of size 2^( 5) =       0.000438815416
  error estimate for blocks of size 2^( 6) =       0.000446625345
  error estimate for blocks of size 2^( 7) =       0.000452330354

      target function =      -0.918039723376
              le_mean =     -16.898671633384
             les_mean =     285.861719468364
             stat err =       0.000441274509
             autocorr =       1.369014416019
   target nu stat err =       0.000441274509
   target dn stat err =       0.002803806028
      target stat err =       0.004413997796
              std dev =       0.533359245018
             le_variance =       0.284472084247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689867163338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918059437969       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918144400638       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918169247549       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918184945539       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918194340148       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918196488548       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918197015490       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918196954668       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918197152590       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918197055613       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918197077079       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918197206008       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918197324263       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918197456329       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918197420512       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918197421069       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918197413598       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918197404213       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918197398775       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 7.113892e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918059437969       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918082569157       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918089185112       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918093274747       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918095648255       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918096154522       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918096275155       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918096257369       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918096308212       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918096282793       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918096289203       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918096321847       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918096350287       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918096377808       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918096368814       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918096368507       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918096366666       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918096364700       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918096363704       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.864204e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918059437969       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918065352355       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918067033540       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918068066529       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918068660941       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918068785246       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918068814630       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918068810019       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918068822827       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918068816398       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918068818075       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918068826251       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918068833262       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918068839788       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918068837550       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918068837451       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918068836996       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918068836529       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.717503e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7218e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.032267e-01 3 1  ON 0
ci_0002                 6.978257e-01 3 1  ON 1
ci_0003                -3.159919e-02 3 1  ON 2
ci_0004                -3.144019e-02 3 1  ON 3
ci_0005                -2.885584e-02 3 1  ON 4
ci_0006                -2.984920e-02 3 1  ON 5
ci_0007                -1.597640e-02 3 1  ON 6
ci_0008                -1.664186e-02 3 1  ON 7
ci_0009                -1.876706e-02 3 1  ON 8
ci_0010                -1.892782e-02 3 1  ON 9
ci_0011                -1.553355e-02 3 1  ON 10
ci_0012                -1.570111e-02 3 1  ON 11
ci_0013                 1.553709e-02 3 1  ON 12
ci_0014                 1.540977e-02 3 1  ON 13
ci_0015                 1.632425e-02 3 1  ON 14
ci_0016                 1.598302e-02 3 1  ON 15
ci_0017                 1.374776e-02 3 1  ON 16
ci_0018                 1.399897e-02 3 1  ON 17
ci_0019                 1.258815e-02 3 1  ON 18
ci_0020                 1.222392e-02 3 1  ON 19
ci_0021                 1.386646e-02 3 1  ON 20
ci_0022                 1.530910e-02 3 1  ON 21
ci_0023                -1.184483e-02 3 1  ON 22
ci_0024                -1.112396e-02 3 1  ON 23
ci_0025                -2.858067e-03 3 1  ON 24
ci_0026                -2.424875e-03 3 1  ON 25
ci_0027                -1.178948e-02 3 1  ON 26
ci_0028                -1.173584e-02 3 1  ON 27
ci_0029                -1.042873e-02 3 1  ON 28
ci_0030                -1.034115e-02 3 1  ON 29
ci_0031                 1.384956e-02 3 1  ON 30
ci_0032                 1.296033e-02 3 1  ON 31
ci_0033                 8.251385e-03 3 1  ON 32
ci_0034                 8.534676e-03 3 1  ON 33
ci_0035                 4.908298e-03 3 1  ON 34
ci_0036                 4.727552e-03 3 1  ON 35
ci_0037                -1.144597e-02 3 1  ON 36
ci_0038                -1.133481e-02 3 1  ON 37
ci_0039                -3.825389e-03 3 1  ON 38
ci_0040                -3.926190e-03 3 1  ON 39
ci_0041                 9.567079e-03 3 1  ON 40
ci_0042                 9.491198e-03 3 1  ON 41
ci_0043                -7.516902e-03 3 1  ON 42
ci_0044                -7.957190e-03 3 1  ON 43
ci_0045                 1.042263e-02 3 1  ON 44
ci_0046                 9.653182e-03 3 1  ON 45
ci_0047                -3.596470e-03 3 1  ON 46
ci_0048                -3.637571e-03 3 1  ON 47
ci_0049                -2.456024e-03 3 1  ON 48
ci_0050                -2.609005e-03 3 1  ON 49
ci_0051                -1.836816e-03 3 1  ON 50
ci_0052                -1.738452e-03 3 1  ON 51
ci_0053                -3.847944e-03 3 1  ON 52
ci_0054                -3.757239e-03 3 1  ON 53
ci_0055                 2.365566e-03 3 1  ON 54
ci_0056                 2.078190e-03 3 1  ON 55
ci_0057                 2.333742e-03 3 1  ON 56
ci_0058                 2.901732e-03 3 1  ON 57
ci_0059                -3.930466e-03 3 1  ON 58
ci_0060                -3.672362e-03 3 1  ON 59
ci_0061                -3.055341e-03 3 1  ON 60
ci_0062                -3.294064e-03 3 1  ON 61
ci_0063                -9.712574e-03 3 1  ON 62
ci_0064                -9.659248e-03 3 1  ON 63
ci_0065                -6.957416e-03 3 1  ON 64
ci_0066                -6.461231e-03 3 1  ON 65
ci_0067                -3.940470e-03 3 1  ON 66
ci_0068                -3.857063e-03 3 1  ON 67
ci_0069                 3.745769e-03 3 1  ON 68
ci_0070                 3.491481e-03 3 1  ON 69
ci_0071                 4.127974e-03 3 1  ON 70
ci_0072                 4.332498e-03 3 1  ON 71
ci_0073                 3.361267e-03 3 1  ON 72
ci_0074                 3.303830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8678
    reference variance = 0.354681
====================================================
  Execution time = 1.4458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9374e-01
  Total weights = 1.9506e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282315397683
                                         uncertainty =       0.001760550365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282315397683
                                         uncertainty =       0.001760550365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375805934
  error estimate for blocks of size 2^( 2) =       0.000392844308
  error estimate for blocks of size 2^( 3) =       0.000410253703
  error estimate for blocks of size 2^( 4) =       0.000425414167
  error estimate for blocks of size 2^( 5) =       0.000437057090
  error estimate for blocks of size 2^( 6) =       0.000442153216
  error estimate for blocks of size 2^( 7) =       0.000444013945

      target function =      -0.922413741368
              le_mean =     -16.897941705464
             les_mean =     285.834243842174
             stat err =       0.000437159604
             autocorr =       1.353171309045
   target nu stat err =       0.000437159604
   target dn stat err =       0.002642337143
      target stat err =       0.004199547619
              std dev =       0.531469849328
             le_variance =       0.282460200745

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0562382
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282182499166
                                         uncertainty =       0.001765836721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282182499166
                                         uncertainty =       0.001765836721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375718741
  error estimate for blocks of size 2^( 2) =       0.000392740070
  error estimate for blocks of size 2^( 3) =       0.000410126728
  error estimate for blocks of size 2^( 4) =       0.000425272762
  error estimate for blocks of size 2^( 5) =       0.000436896982
  error estimate for blocks of size 2^( 6) =       0.000441974410
  error estimate for blocks of size 2^( 7) =       0.000443847358

      target function =      -0.922079379845
              le_mean =     -16.897950478396
             les_mean =     285.834754009608
             stat err =       0.000436997878
             autocorr =       1.352797957990
   target nu stat err =       0.000436997878
   target dn stat err =       0.002660706288
      target stat err =       0.004224839235
              std dev =       0.531346539444
             le_variance =       0.282329144979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282240010053
                                         uncertainty =       0.001763376906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282240010053
                                         uncertainty =       0.001763376906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375756439
  error estimate for blocks of size 2^( 2) =       0.000392785576
  error estimate for blocks of size 2^( 3) =       0.000410183311
  error estimate for blocks of size 2^( 4) =       0.000425335846
  error estimate for blocks of size 2^( 5) =       0.000436969577
  error estimate for blocks of size 2^( 6) =       0.000442056110
  error estimate for blocks of size 2^( 7) =       0.000443923872

      target function =      -0.922514534717
              le_mean =     -16.897945655242
             les_mean =     285.834313011669
             stat err =       0.000437071351
             autocorr =       1.352981374296
   target nu stat err =       0.000437071351
   target dn stat err =       0.002631429473
      target stat err =       0.004183656126
              std dev =       0.531399852505
             le_variance =       0.282385803243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282305228452
                                         uncertainty =       0.001760881303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282305228452
                                         uncertainty =       0.001760881303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375799253
  error estimate for blocks of size 2^( 2) =       0.000392836450
  error estimate for blocks of size 2^( 3) =       0.000410244378
  error estimate for blocks of size 2^( 4) =       0.000425403808
  error estimate for blocks of size 2^( 5) =       0.000437045590
  error estimate for blocks of size 2^( 6) =       0.000442140527
  error estimate for blocks of size 2^( 7) =       0.000444002146

      target function =      -0.922462531872
              le_mean =     -16.897942102643
             les_mean =     285.834226102733
             stat err =       0.000437148018
             autocorr =       1.353147696862
   target nu stat err =       0.000437148018
   target dn stat err =       0.002639596436
      target stat err =       0.004195763886
              std dev =       0.531460399725
             le_variance =       0.282450156476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922413741368        initial
     6.2500e-01     6.2500e+00             7.1139e-04        -0.922079379845
     2.5000e+00     2.5000e+01             1.8642e-04        -0.922514534717  <--
     1.0000e+01     1.0000e+02             4.7175e-05        -0.922462531872

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3977e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.032267e-01 3 1  ON 0
ci_0002                 6.978257e-01 3 1  ON 1
ci_0003                -3.159919e-02 3 1  ON 2
ci_0004                -3.144019e-02 3 1  ON 3
ci_0005                -2.885584e-02 3 1  ON 4
ci_0006                -2.984920e-02 3 1  ON 5
ci_0007                -1.597640e-02 3 1  ON 6
ci_0008                -1.664186e-02 3 1  ON 7
ci_0009                -1.876706e-02 3 1  ON 8
ci_0010                -1.892782e-02 3 1  ON 9
ci_0011                -1.553355e-02 3 1  ON 10
ci_0012                -1.570111e-02 3 1  ON 11
ci_0013                 1.553709e-02 3 1  ON 12
ci_0014                 1.540977e-02 3 1  ON 13
ci_0015                 1.632425e-02 3 1  ON 14
ci_0016                 1.598302e-02 3 1  ON 15
ci_0017                 1.374776e-02 3 1  ON 16
ci_0018                 1.399897e-02 3 1  ON 17
ci_0019                 1.258815e-02 3 1  ON 18
ci_0020                 1.222392e-02 3 1  ON 19
ci_0021                 1.386646e-02 3 1  ON 20
ci_0022                 1.530910e-02 3 1  ON 21
ci_0023                -1.184483e-02 3 1  ON 22
ci_0024                -1.112396e-02 3 1  ON 23
ci_0025                -2.858067e-03 3 1  ON 24
ci_0026                -2.424875e-03 3 1  ON 25
ci_0027                -1.178948e-02 3 1  ON 26
ci_0028                -1.173584e-02 3 1  ON 27
ci_0029                -1.042873e-02 3 1  ON 28
ci_0030                -1.034115e-02 3 1  ON 29
ci_0031                 1.384956e-02 3 1  ON 30
ci_0032                 1.296033e-02 3 1  ON 31
ci_0033                 8.251385e-03 3 1  ON 32
ci_0034                 8.534676e-03 3 1  ON 33
ci_0035                 4.908298e-03 3 1  ON 34
ci_0036                 4.727552e-03 3 1  ON 35
ci_0037                -1.144597e-02 3 1  ON 36
ci_0038                -1.133481e-02 3 1  ON 37
ci_0039                -3.825389e-03 3 1  ON 38
ci_0040                -3.926190e-03 3 1  ON 39
ci_0041                 9.567079e-03 3 1  ON 40
ci_0042                 9.491198e-03 3 1  ON 41
ci_0043                -7.516902e-03 3 1  ON 42
ci_0044                -7.957190e-03 3 1  ON 43
ci_0045                 1.042263e-02 3 1  ON 44
ci_0046                 9.653182e-03 3 1  ON 45
ci_0047                -3.596470e-03 3 1  ON 46
ci_0048                -3.637571e-03 3 1  ON 47
ci_0049                -2.456024e-03 3 1  ON 48
ci_0050                -2.609005e-03 3 1  ON 49
ci_0051                -1.836816e-03 3 1  ON 50
ci_0052                -1.738452e-03 3 1  ON 51
ci_0053                -3.847944e-03 3 1  ON 52
ci_0054                -3.757239e-03 3 1  ON 53
ci_0055                 2.365566e-03 3 1  ON 54
ci_0056                 2.078190e-03 3 1  ON 55
ci_0057                 2.333742e-03 3 1  ON 56
ci_0058                 2.901732e-03 3 1  ON 57
ci_0059                -3.930466e-03 3 1  ON 58
ci_0060                -3.672362e-03 3 1  ON 59
ci_0061                -3.055341e-03 3 1  ON 60
ci_0062                -3.294064e-03 3 1  ON 61
ci_0063                -9.712574e-03 3 1  ON 62
ci_0064                -9.659248e-03 3 1  ON 63
ci_0065                -6.957416e-03 3 1  ON 64
ci_0066                -6.461231e-03 3 1  ON 65
ci_0067                -3.940470e-03 3 1  ON 66
ci_0068                -3.857063e-03 3 1  ON 67
ci_0069                 3.745769e-03 3 1  ON 68
ci_0070                 3.491481e-03 3 1  ON 69
ci_0071                 4.127974e-03 3 1  ON 70
ci_0072                 4.332498e-03 3 1  ON 71
ci_0073                 3.361267e-03 3 1  ON 72
ci_0074                 3.303830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1206e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.25066
====================================================
  Execution time = 1.4615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5217e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9084e-01
  Total weights = 1.951144702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281116695153
                                         uncertainty =       0.001409099885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281116695153
                                         uncertainty =       0.001409099885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374892836
  error estimate for blocks of size 2^( 2) =       0.000392410075
  error estimate for blocks of size 2^( 3) =       0.000410444832
  error estimate for blocks of size 2^( 4) =       0.000426939260
  error estimate for blocks of size 2^( 5) =       0.000440141590
  error estimate for blocks of size 2^( 6) =       0.000448282080
  error estimate for blocks of size 2^( 7) =       0.000454908441

      target function =      -0.927080359896
              le_mean =     -16.897440579687
             les_mean =     285.814339892537
             stat err =       0.000442567843
             autocorr =       1.393623389918
   target nu stat err =       0.000442567843
   target dn stat err =       0.002070381484
      target stat err =       0.003354416732
              std dev =       0.530178533139
             le_variance =       0.281089277002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689744057969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927090950830       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927142576444       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927165143725       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927183883971       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927193004016       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927194722603       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927195840062       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927196343707       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927196894564       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927197160677       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927197182180       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927197250441       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927197400885       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927197503532       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927197541689       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927197548240       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927197566705       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927197569482       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927197568858       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 6.193302e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927090950830       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927104992367       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927111036775       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927115917688       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927118230121       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927118646886       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927118923491       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927119049275       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927119187709       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927119252170       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927119253263       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927119268411       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927119302102       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927119323634       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927119331368       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927119332350       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927119336169       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927119336595       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927119336466       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.629565e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927090950830       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927094540130       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927096078598       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927097311347       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927097891102       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927097994304       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927098063217       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927098094643       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927098129274       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927098145215       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927098145186       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927098148843       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927098157000       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927098162132       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927098163959       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927098164168       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927098165074       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927098165166       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.127021e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7215e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.031474e-01 3 1  ON 0
ci_0002                 6.979181e-01 3 1  ON 1
ci_0003                -3.156436e-02 3 1  ON 2
ci_0004                -3.140146e-02 3 1  ON 3
ci_0005                -2.887345e-02 3 1  ON 4
ci_0006                -2.991395e-02 3 1  ON 5
ci_0007                -1.592085e-02 3 1  ON 6
ci_0008                -1.656651e-02 3 1  ON 7
ci_0009                -1.873680e-02 3 1  ON 8
ci_0010                -1.890809e-02 3 1  ON 9
ci_0011                -1.552945e-02 3 1  ON 10
ci_0012                -1.566368e-02 3 1  ON 11
ci_0013                 1.552731e-02 3 1  ON 12
ci_0014                 1.539800e-02 3 1  ON 13
ci_0015                 1.632053e-02 3 1  ON 14
ci_0016                 1.596938e-02 3 1  ON 15
ci_0017                 1.373984e-02 3 1  ON 16
ci_0018                 1.397217e-02 3 1  ON 17
ci_0019                 1.260173e-02 3 1  ON 18
ci_0020                 1.223250e-02 3 1  ON 19
ci_0021                 1.370351e-02 3 1  ON 20
ci_0022                 1.516822e-02 3 1  ON 21
ci_0023                -1.182696e-02 3 1  ON 22
ci_0024                -1.112019e-02 3 1  ON 23
ci_0025                -2.850868e-03 3 1  ON 24
ci_0026                -2.420716e-03 3 1  ON 25
ci_0027                -1.179727e-02 3 1  ON 26
ci_0028                -1.174427e-02 3 1  ON 27
ci_0029                -1.042560e-02 3 1  ON 28
ci_0030                -1.034982e-02 3 1  ON 29
ci_0031                 1.383508e-02 3 1  ON 30
ci_0032                 1.293223e-02 3 1  ON 31
ci_0033                 8.252854e-03 3 1  ON 32
ci_0034                 8.515169e-03 3 1  ON 33
ci_0035                 4.865208e-03 3 1  ON 34
ci_0036                 4.723974e-03 3 1  ON 35
ci_0037                -1.141789e-02 3 1  ON 36
ci_0038                -1.132239e-02 3 1  ON 37
ci_0039                -3.814964e-03 3 1  ON 38
ci_0040                -3.937573e-03 3 1  ON 39
ci_0041                 9.550888e-03 3 1  ON 40
ci_0042                 9.465803e-03 3 1  ON 41
ci_0043                -7.664060e-03 3 1  ON 42
ci_0044                -8.100395e-03 3 1  ON 43
ci_0045                 1.042730e-02 3 1  ON 44
ci_0046                 9.655608e-03 3 1  ON 45
ci_0047                -3.607898e-03 3 1  ON 46
ci_0048                -3.626917e-03 3 1  ON 47
ci_0049                -2.496520e-03 3 1  ON 48
ci_0050                -2.571367e-03 3 1  ON 49
ci_0051                -1.849565e-03 3 1  ON 50
ci_0052                -1.730249e-03 3 1  ON 51
ci_0053                -3.847426e-03 3 1  ON 52
ci_0054                -3.737416e-03 3 1  ON 53
ci_0055                 2.346131e-03 3 1  ON 54
ci_0056                 2.067576e-03 3 1  ON 55
ci_0057                 2.327455e-03 3 1  ON 56
ci_0058                 2.897435e-03 3 1  ON 57
ci_0059                -3.919401e-03 3 1  ON 58
ci_0060                -3.670856e-03 3 1  ON 59
ci_0061                -3.077353e-03 3 1  ON 60
ci_0062                -3.304886e-03 3 1  ON 61
ci_0063                -9.719215e-03 3 1  ON 62
ci_0064                -9.678435e-03 3 1  ON 63
ci_0065                -6.930936e-03 3 1  ON 64
ci_0066                -6.468089e-03 3 1  ON 65
ci_0067                -3.922101e-03 3 1  ON 66
ci_0068                -3.861814e-03 3 1  ON 67
ci_0069                 3.733839e-03 3 1  ON 68
ci_0070                 3.463021e-03 3 1  ON 69
ci_0071                 4.096945e-03 3 1  ON 70
ci_0072                 4.307697e-03 3 1  ON 71
ci_0073                 3.378614e-03 3 1  ON 72
ci_0074                 3.319044e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.226491
====================================================
  Execution time = 1.4326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9494e-01
  Total weights = 1.9509e+06
  Execution time = 1.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285481147284
                                         uncertainty =       0.001809006343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285481147284
                                         uncertainty =       0.001809006343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377857710
  error estimate for blocks of size 2^( 2) =       0.000394929857
  error estimate for blocks of size 2^( 3) =       0.000412430278
  error estimate for blocks of size 2^( 4) =       0.000428405117
  error estimate for blocks of size 2^( 5) =       0.000439793440
  error estimate for blocks of size 2^( 6) =       0.000447106871
  error estimate for blocks of size 2^( 7) =       0.000450851507

      target function =      -0.920507855420
              le_mean =     -16.897950064046
             les_mean =     285.835749130766
             stat err =       0.000441539234
             autocorr =       1.365469558636
   target nu stat err =       0.000441539234
   target dn stat err =       0.002427069751
      target stat err =       0.003854336941
              std dev =       0.534371498154
             le_variance =       0.285552898039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285388887507
                                         uncertainty =       0.001815042955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285388887507
                                         uncertainty =       0.001815042955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377796888
  error estimate for blocks of size 2^( 2) =       0.000394856780
  error estimate for blocks of size 2^( 3) =       0.000412337346
  error estimate for blocks of size 2^( 4) =       0.000428292397
  error estimate for blocks of size 2^( 5) =       0.000439662078
  error estimate for blocks of size 2^( 6) =       0.000446976452
  error estimate for blocks of size 2^( 7) =       0.000450709071

      target function =      -0.920292044581
              le_mean =     -16.897957065789
             les_mean =     285.836123581232
             stat err =       0.000441409999
             autocorr =       1.365109790346
   target nu stat err =       0.000441409999
   target dn stat err =       0.002516888357
      target stat err =       0.003989881579
              std dev =       0.534285483120
             le_variance =       0.285460977473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285428174738
                                         uncertainty =       0.001812092049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285428174738
                                         uncertainty =       0.001812092049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377822775
  error estimate for blocks of size 2^( 2) =       0.000394888449
  error estimate for blocks of size 2^( 3) =       0.000412378430
  error estimate for blocks of size 2^( 4) =       0.000428342871
  error estimate for blocks of size 2^( 5) =       0.000439721196
  error estimate for blocks of size 2^( 6) =       0.000447035089
  error estimate for blocks of size 2^( 7) =       0.000450773132

      target function =      -0.920590474334
              le_mean =     -16.897953272500
             les_mean =     285.835804268746
             stat err =       0.000441468072
             autocorr =       1.365281901434
   target nu stat err =       0.000441468072
   target dn stat err =       0.002460014047
      target stat err =       0.003905390461
              std dev =       0.534322092145
             le_variance =       0.285500098154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285473938936
                                         uncertainty =       0.001809381757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285473938936
                                         uncertainty =       0.001809381757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377852955
  error estimate for blocks of size 2^( 2) =       0.000394924225
  error estimate for blocks of size 2^( 3) =       0.000412423261
  error estimate for blocks of size 2^( 4) =       0.000428396789
  error estimate for blocks of size 2^( 5) =       0.000439783989
  error estimate for blocks of size 2^( 6) =       0.000447097695
  error estimate for blocks of size 2^( 7) =       0.000450841026

      target function =      -0.920014171836
              le_mean =     -16.897950481844
             les_mean =     285.836080015167
             stat err =       0.000441529875
             autocorr =       1.365446038735
   target nu stat err =       0.000441529875
   target dn stat err =       0.002463349923
      target stat err =       0.003905687479
              std dev =       0.534364773768
             le_variance =       0.285545711444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920507855420        initial
     6.2500e-01     6.2500e+00             6.1933e-04        -0.920292044581
     2.5000e+00     2.5000e+01             1.6296e-04        -0.920590474334  <--
     1.0000e+01     1.0000e+02             4.1270e-05        -0.920014171836

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3874e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.031474e-01 3 1  ON 0
ci_0002                 6.979181e-01 3 1  ON 1
ci_0003                -3.156436e-02 3 1  ON 2
ci_0004                -3.140146e-02 3 1  ON 3
ci_0005                -2.887345e-02 3 1  ON 4
ci_0006                -2.991395e-02 3 1  ON 5
ci_0007                -1.592085e-02 3 1  ON 6
ci_0008                -1.656651e-02 3 1  ON 7
ci_0009                -1.873680e-02 3 1  ON 8
ci_0010                -1.890809e-02 3 1  ON 9
ci_0011                -1.552945e-02 3 1  ON 10
ci_0012                -1.566368e-02 3 1  ON 11
ci_0013                 1.552731e-02 3 1  ON 12
ci_0014                 1.539800e-02 3 1  ON 13
ci_0015                 1.632053e-02 3 1  ON 14
ci_0016                 1.596938e-02 3 1  ON 15
ci_0017                 1.373984e-02 3 1  ON 16
ci_0018                 1.397217e-02 3 1  ON 17
ci_0019                 1.260173e-02 3 1  ON 18
ci_0020                 1.223250e-02 3 1  ON 19
ci_0021                 1.370351e-02 3 1  ON 20
ci_0022                 1.516822e-02 3 1  ON 21
ci_0023                -1.182696e-02 3 1  ON 22
ci_0024                -1.112019e-02 3 1  ON 23
ci_0025                -2.850868e-03 3 1  ON 24
ci_0026                -2.420716e-03 3 1  ON 25
ci_0027                -1.179727e-02 3 1  ON 26
ci_0028                -1.174427e-02 3 1  ON 27
ci_0029                -1.042560e-02 3 1  ON 28
ci_0030                -1.034982e-02 3 1  ON 29
ci_0031                 1.383508e-02 3 1  ON 30
ci_0032                 1.293223e-02 3 1  ON 31
ci_0033                 8.252854e-03 3 1  ON 32
ci_0034                 8.515169e-03 3 1  ON 33
ci_0035                 4.865208e-03 3 1  ON 34
ci_0036                 4.723974e-03 3 1  ON 35
ci_0037                -1.141789e-02 3 1  ON 36
ci_0038                -1.132239e-02 3 1  ON 37
ci_0039                -3.814964e-03 3 1  ON 38
ci_0040                -3.937573e-03 3 1  ON 39
ci_0041                 9.550888e-03 3 1  ON 40
ci_0042                 9.465803e-03 3 1  ON 41
ci_0043                -7.664060e-03 3 1  ON 42
ci_0044                -8.100395e-03 3 1  ON 43
ci_0045                 1.042730e-02 3 1  ON 44
ci_0046                 9.655608e-03 3 1  ON 45
ci_0047                -3.607898e-03 3 1  ON 46
ci_0048                -3.626917e-03 3 1  ON 47
ci_0049                -2.496520e-03 3 1  ON 48
ci_0050                -2.571367e-03 3 1  ON 49
ci_0051                -1.849565e-03 3 1  ON 50
ci_0052                -1.730249e-03 3 1  ON 51
ci_0053                -3.847426e-03 3 1  ON 52
ci_0054                -3.737416e-03 3 1  ON 53
ci_0055                 2.346131e-03 3 1  ON 54
ci_0056                 2.067576e-03 3 1  ON 55
ci_0057                 2.327455e-03 3 1  ON 56
ci_0058                 2.897435e-03 3 1  ON 57
ci_0059                -3.919401e-03 3 1  ON 58
ci_0060                -3.670856e-03 3 1  ON 59
ci_0061                -3.077353e-03 3 1  ON 60
ci_0062                -3.304886e-03 3 1  ON 61
ci_0063                -9.719215e-03 3 1  ON 62
ci_0064                -9.678435e-03 3 1  ON 63
ci_0065                -6.930936e-03 3 1  ON 64
ci_0066                -6.468089e-03 3 1  ON 65
ci_0067                -3.922101e-03 3 1  ON 66
ci_0068                -3.861814e-03 3 1  ON 67
ci_0069                 3.733839e-03 3 1  ON 68
ci_0070                 3.463021e-03 3 1  ON 69
ci_0071                 4.096945e-03 3 1  ON 70
ci_0072                 4.307697e-03 3 1  ON 71
ci_0073                 3.378614e-03 3 1  ON 72
ci_0074                 3.319044e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8381
    reference variance = 0.138569
====================================================
  Execution time = 1.6868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5214e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9117e-01
  Total weights = 1.951032609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282282627153
                                         uncertainty =       0.001678794343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282282627153
                                         uncertainty =       0.001678794343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375685165
  error estimate for blocks of size 2^( 2) =       0.000392911438
  error estimate for blocks of size 2^( 3) =       0.000410666790
  error estimate for blocks of size 2^( 4) =       0.000426464684
  error estimate for blocks of size 2^( 5) =       0.000438838522
  error estimate for blocks of size 2^( 6) =       0.000448196171
  error estimate for blocks of size 2^( 7) =       0.000455841336

      target function =      -0.926578882657
              le_mean =     -16.898363508564
             les_mean =     285.845856476487
             stat err =       0.000442335178
             autocorr =       1.386292479410
   target nu stat err =       0.000442335178
   target dn stat err =       0.002111394614
      target stat err =       0.003419648025
              std dev =       0.531299055330
             le_variance =       0.282278686194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689836350856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926590005623       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926661724308       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926682725858       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926693993315       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926697601753       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926698311337       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926698272667       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926698453092       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926698503711       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926698601826       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926698608973       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926698672302       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926698710365       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926698795554       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926698827988       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926698826397       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926698816020       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926698811743       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.926698817489       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 6.846901e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926590005623       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926609516343       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926615088650       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926617994024       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926618882754       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926619041863       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926619028925       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926619073600       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926619086189       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926619110407       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926619111762       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926619127887       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926619137905       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926619157402       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926619162978       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926619162161       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926619160058       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926619159140       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.800810e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926590005623       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926594993247       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926596407829       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926597139554       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926597360498       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926597398981       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926597395538       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926597406675       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926597409818       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926597415847       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926597416157       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926597420206       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926597422738       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926597427480       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926597428717       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926597428493       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926597428000       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926597427781       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.561412e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.429384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9507e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.031245e-01 3 1  ON 0
ci_0002                 6.979489e-01 3 1  ON 1
ci_0003                -3.154263e-02 3 1  ON 2
ci_0004                -3.137780e-02 3 1  ON 3
ci_0005                -2.893046e-02 3 1  ON 4
ci_0006                -2.996800e-02 3 1  ON 5
ci_0007                -1.590468e-02 3 1  ON 6
ci_0008                -1.649563e-02 3 1  ON 7
ci_0009                -1.874383e-02 3 1  ON 8
ci_0010                -1.885457e-02 3 1  ON 9
ci_0011                -1.550945e-02 3 1  ON 10
ci_0012                -1.566413e-02 3 1  ON 11
ci_0013                 1.550048e-02 3 1  ON 12
ci_0014                 1.535260e-02 3 1  ON 13
ci_0015                 1.629602e-02 3 1  ON 14
ci_0016                 1.594606e-02 3 1  ON 15
ci_0017                 1.373434e-02 3 1  ON 16
ci_0018                 1.394557e-02 3 1  ON 17
ci_0019                 1.260788e-02 3 1  ON 18
ci_0020                 1.224394e-02 3 1  ON 19
ci_0021                 1.355019e-02 3 1  ON 20
ci_0022                 1.504755e-02 3 1  ON 21
ci_0023                -1.180110e-02 3 1  ON 22
ci_0024                -1.113423e-02 3 1  ON 23
ci_0025                -2.808938e-03 3 1  ON 24
ci_0026                -2.385795e-03 3 1  ON 25
ci_0027                -1.179783e-02 3 1  ON 26
ci_0028                -1.174465e-02 3 1  ON 27
ci_0029                -1.041385e-02 3 1  ON 28
ci_0030                -1.036543e-02 3 1  ON 29
ci_0031                 1.382831e-02 3 1  ON 30
ci_0032                 1.292286e-02 3 1  ON 31
ci_0033                 8.269970e-03 3 1  ON 32
ci_0034                 8.535649e-03 3 1  ON 33
ci_0035                 4.837462e-03 3 1  ON 34
ci_0036                 4.715738e-03 3 1  ON 35
ci_0037                -1.142019e-02 3 1  ON 36
ci_0038                -1.131259e-02 3 1  ON 37
ci_0039                -3.825699e-03 3 1  ON 38
ci_0040                -3.938327e-03 3 1  ON 39
ci_0041                 9.537403e-03 3 1  ON 40
ci_0042                 9.447533e-03 3 1  ON 41
ci_0043                -7.758634e-03 3 1  ON 42
ci_0044                -8.280476e-03 3 1  ON 43
ci_0045                 1.040352e-02 3 1  ON 44
ci_0046                 9.695301e-03 3 1  ON 45
ci_0047                -3.596331e-03 3 1  ON 46
ci_0048                -3.630043e-03 3 1  ON 47
ci_0049                -2.495893e-03 3 1  ON 48
ci_0050                -2.571910e-03 3 1  ON 49
ci_0051                -1.838284e-03 3 1  ON 50
ci_0052                -1.736891e-03 3 1  ON 51
ci_0053                -3.812367e-03 3 1  ON 52
ci_0054                -3.720917e-03 3 1  ON 53
ci_0055                 2.325957e-03 3 1  ON 54
ci_0056                 2.077278e-03 3 1  ON 55
ci_0057                 2.362239e-03 3 1  ON 56
ci_0058                 2.863515e-03 3 1  ON 57
ci_0059                -3.918018e-03 3 1  ON 58
ci_0060                -3.685692e-03 3 1  ON 59
ci_0061                -3.103512e-03 3 1  ON 60
ci_0062                -3.329132e-03 3 1  ON 61
ci_0063                -9.741624e-03 3 1  ON 62
ci_0064                -9.679962e-03 3 1  ON 63
ci_0065                -6.922104e-03 3 1  ON 64
ci_0066                -6.458231e-03 3 1  ON 65
ci_0067                -3.904631e-03 3 1  ON 66
ci_0068                -3.858743e-03 3 1  ON 67
ci_0069                 3.718277e-03 3 1  ON 68
ci_0070                 3.467959e-03 3 1  ON 69
ci_0071                 4.063746e-03 3 1  ON 70
ci_0072                 4.295816e-03 3 1  ON 71
ci_0073                 3.377043e-03 3 1  ON 72
ci_0074                 3.344403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8661
    reference variance = 0.245112
====================================================
  Execution time = 1.4160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9057e-01
  Total weights = 1.9511e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281473395466
                                         uncertainty =       0.001913421057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281473395466
                                         uncertainty =       0.001913421057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375129522
  error estimate for blocks of size 2^( 2) =       0.000392205687
  error estimate for blocks of size 2^( 3) =       0.000409919763
  error estimate for blocks of size 2^( 4) =       0.000425818276
  error estimate for blocks of size 2^( 5) =       0.000437705098
  error estimate for blocks of size 2^( 6) =       0.000446382977
  error estimate for blocks of size 2^( 7) =       0.000451684281

      target function =      -0.927417453953
              le_mean =     -16.898712543774
             les_mean =     285.857124580961
             stat err =       0.000440397658
             autocorr =       1.378248453012
   target nu stat err =       0.000440397658
   target dn stat err =       0.002216537790
      target stat err =       0.003589803707
              std dev =       0.530513258066
             le_variance =       0.281444316983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281301536000
                                         uncertainty =       0.001909739458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281301536000
                                         uncertainty =       0.001909739458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375014720
  error estimate for blocks of size 2^( 2) =       0.000392080878
  error estimate for blocks of size 2^( 3) =       0.000409781027
  error estimate for blocks of size 2^( 4) =       0.000425659189
  error estimate for blocks of size 2^( 5) =       0.000437522897
  error estimate for blocks of size 2^( 6) =       0.000446191108
  error estimate for blocks of size 2^( 7) =       0.000451486463

      target function =      -0.927149884243
              le_mean =     -16.898719048038
             les_mean =     285.857513393204
             stat err =       0.000440214914
             autocorr =       1.377948144392
   target nu stat err =       0.000440214914
   target dn stat err =       0.002227193918
      target stat err =       0.003604249459
              std dev =       0.530350903408
             le_variance =       0.281272080746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281379050158
                                         uncertainty =       0.001911396338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281379050158
                                         uncertainty =       0.001911396338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375066510
  error estimate for blocks of size 2^( 2) =       0.000392137507
  error estimate for blocks of size 2^( 3) =       0.000409844311
  error estimate for blocks of size 2^( 4) =       0.000425731981
  error estimate for blocks of size 2^( 5) =       0.000437606579
  error estimate for blocks of size 2^( 6) =       0.000446279488
  error estimate for blocks of size 2^( 7) =       0.000451577689

      target function =      -0.926730108616
              le_mean =     -16.898715371510
             les_mean =     285.857654046996
             stat err =       0.000440298934
             autocorr =       1.378093527658
   target nu stat err =       0.000440298934
   target dn stat err =       0.002280424992
      target stat err =       0.003683428445
              std dev =       0.530424145484
             le_variance =       0.281349774112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281461027354
                                         uncertainty =       0.001913159139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281461027354
                                         uncertainty =       0.001913159139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375121263
  error estimate for blocks of size 2^( 2) =       0.000392196757
  error estimate for blocks of size 2^( 3) =       0.000409909912
  error estimate for blocks of size 2^( 4) =       0.000425807037
  error estimate for blocks of size 2^( 5) =       0.000437692311
  error estimate for blocks of size 2^( 6) =       0.000446369570
  error estimate for blocks of size 2^( 7) =       0.000451670561

      target function =      -0.927497410028
              le_mean =     -16.898712844918
             les_mean =     285.857084282037
             stat err =       0.000440384870
             autocorr =       1.378229099658
   target nu stat err =       0.000440384870
   target dn stat err =       0.002215615765
      target stat err =       0.003588978532
              std dev =       0.530501577702
             le_variance =       0.281431923944


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927417453953        initial
     6.2500e-01     6.2500e+00             6.8469e-04        -0.927149884243
     2.5000e+00     2.5000e+01             1.8008e-04        -0.926730108616
     1.0000e+01     1.0000e+02             4.5614e-05        -0.927497410028  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.3717e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.031417e-01 3 1  ON 0
ci_0002                 6.979258e-01 3 1  ON 1
ci_0003                -3.155884e-02 3 1  ON 2
ci_0004                -3.139544e-02 3 1  ON 3
ci_0005                -2.888794e-02 3 1  ON 4
ci_0006                -2.992770e-02 3 1  ON 5
ci_0007                -1.591677e-02 3 1  ON 6
ci_0008                -1.654859e-02 3 1  ON 7
ci_0009                -1.873859e-02 3 1  ON 8
ci_0010                -1.889444e-02 3 1  ON 9
ci_0011                -1.552437e-02 3 1  ON 10
ci_0012                -1.566380e-02 3 1  ON 11
ci_0013                 1.552048e-02 3 1  ON 12
ci_0014                 1.538644e-02 3 1  ON 13
ci_0015                 1.631429e-02 3 1  ON 14
ci_0016                 1.596344e-02 3 1  ON 15
ci_0017                 1.373844e-02 3 1  ON 16
ci_0018                 1.396539e-02 3 1  ON 17
ci_0019                 1.260330e-02 3 1  ON 18
ci_0020                 1.223542e-02 3 1  ON 19
ci_0021                 1.366468e-02 3 1  ON 20
ci_0022                 1.513764e-02 3 1  ON 21
ci_0023                -1.182037e-02 3 1  ON 22
ci_0024                -1.112376e-02 3 1  ON 23
ci_0025                -2.840142e-03 3 1  ON 24
ci_0026                -2.411782e-03 3 1  ON 25
ci_0027                -1.179741e-02 3 1  ON 26
ci_0028                -1.174435e-02 3 1  ON 27
ci_0029                -1.042260e-02 3 1  ON 28
ci_0030                -1.035378e-02 3 1  ON 29
ci_0031                 1.383336e-02 3 1  ON 30
ci_0032                 1.292987e-02 3 1  ON 31
ci_0033                 8.257191e-03 3 1  ON 32
ci_0034                 8.520359e-03 3 1  ON 33
ci_0035                 4.858121e-03 3 1  ON 34
ci_0036                 4.721873e-03 3 1  ON 35
ci_0037                -1.141849e-02 3 1  ON 36
ci_0038                -1.131990e-02 3 1  ON 37
ci_0039                -3.817708e-03 3 1  ON 38
ci_0040                -3.937765e-03 3 1  ON 39
ci_0041                 9.547462e-03 3 1  ON 40
ci_0042                 9.461154e-03 3 1  ON 41
ci_0043                -7.688053e-03 3 1  ON 42
ci_0044                -8.146009e-03 3 1  ON 43
ci_0045                 1.042126e-02 3 1  ON 44
ci_0046                 9.665689e-03 3 1  ON 45
ci_0047                -3.604944e-03 3 1  ON 46
ci_0048                -3.627714e-03 3 1  ON 47
ci_0049                -2.496362e-03 3 1  ON 48
ci_0050                -2.571507e-03 3 1  ON 49
ci_0051                -1.846679e-03 3 1  ON 50
ci_0052                -1.731952e-03 3 1  ON 51
ci_0053                -3.838459e-03 3 1  ON 52
ci_0054                -3.733196e-03 3 1  ON 53
ci_0055                 2.340964e-03 3 1  ON 54
ci_0056                 2.070060e-03 3 1  ON 55
ci_0057                 2.336358e-03 3 1  ON 56
ci_0058                 2.888764e-03 3 1  ON 57
ci_0059                -3.919050e-03 3 1  ON 58
ci_0060                -3.674654e-03 3 1  ON 59
ci_0061                -3.084021e-03 3 1  ON 60
ci_0062                -3.311063e-03 3 1  ON 61
ci_0063                -9.724940e-03 3 1  ON 62
ci_0064                -9.678830e-03 3 1  ON 63
ci_0065                -6.928686e-03 3 1  ON 64
ci_0066                -6.465576e-03 3 1  ON 65
ci_0067                -3.917634e-03 3 1  ON 66
ci_0068                -3.861028e-03 3 1  ON 67
ci_0069                 3.729858e-03 3 1  ON 68
ci_0070                 3.464283e-03 3 1  ON 69
ci_0071                 4.088455e-03 3 1  ON 70
ci_0072                 4.304655e-03 3 1  ON 71
ci_0073                 3.378215e-03 3 1  ON 72
ci_0074                 3.325532e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3230e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8514
    reference variance = 0.27776
====================================================
  Execution time = 1.4887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9972e-01
  Total weights = 1.951187726e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283924571860
                                         uncertainty =       0.002061767554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283924571860
                                         uncertainty =       0.002061767554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376755643
  error estimate for blocks of size 2^( 2) =       0.000393679357
  error estimate for blocks of size 2^( 3) =       0.000411400634
  error estimate for blocks of size 2^( 4) =       0.000426452626
  error estimate for blocks of size 2^( 5) =       0.000438337493
  error estimate for blocks of size 2^( 6) =       0.000446235413
  error estimate for blocks of size 2^( 7) =       0.000448927901

      target function =      -0.913205908318
              le_mean =     -16.897707637640
             les_mean =     285.832240560732
             stat err =       0.000439988358
             autocorr =       1.363838161569
   target nu stat err =       0.000439988358
   target dn stat err =       0.005549260935
      target stat err =       0.008537536824
              std dev =       0.532812940723
             le_variance =       0.283889629802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689770763764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913284579849       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913328610640       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913335423267       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913338941369       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913342417251       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913343844519       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913344317762       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913344971160       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913346087090       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913346656264       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913346877935       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913346997358       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913346997246       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913346971473       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913346966505       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913346962123       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913346962989       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913346964189       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 3.327125e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913284579849       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913295842355       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913297578311       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913298466882       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913299342677       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913299699979       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913299818172       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913299982851       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913300261019       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913300396735       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913300448944       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913300477269       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913300476724       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913300470349       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913300469127       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913300468100       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913300468328       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913300468618       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 8.324690e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913284579849       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913287411864       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913287847951       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913288070661       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913288290035       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913288379387       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913288408926       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913288450180       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913288519660       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913288553172       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913288566026       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913288573012       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913288572845       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913288571256       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913288570951       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913288570699       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913288570757       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913288570829       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 2.081613e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.439724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7478e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.030612e-01 3 1  ON 0
ci_0002                 6.980090e-01 3 1  ON 1
ci_0003                -3.155779e-02 3 1  ON 2
ci_0004                -3.139483e-02 3 1  ON 3
ci_0005                -2.888990e-02 3 1  ON 4
ci_0006                -2.993589e-02 3 1  ON 5
ci_0007                -1.591503e-02 3 1  ON 6
ci_0008                -1.653777e-02 3 1  ON 7
ci_0009                -1.873678e-02 3 1  ON 8
ci_0010                -1.889082e-02 3 1  ON 9
ci_0011                -1.551721e-02 3 1  ON 10
ci_0012                -1.565977e-02 3 1  ON 11
ci_0013                 1.551153e-02 3 1  ON 12
ci_0014                 1.537979e-02 3 1  ON 13
ci_0015                 1.631126e-02 3 1  ON 14
ci_0016                 1.595679e-02 3 1  ON 15
ci_0017                 1.373315e-02 3 1  ON 16
ci_0018                 1.395549e-02 3 1  ON 17
ci_0019                 1.259369e-02 3 1  ON 18
ci_0020                 1.224181e-02 3 1  ON 19
ci_0021                 1.363020e-02 3 1  ON 20
ci_0022                 1.510122e-02 3 1  ON 21
ci_0023                -1.181943e-02 3 1  ON 22
ci_0024                -1.113041e-02 3 1  ON 23
ci_0025                -2.834825e-03 3 1  ON 24
ci_0026                -2.399341e-03 3 1  ON 25
ci_0027                -1.178703e-02 3 1  ON 26
ci_0028                -1.174934e-02 3 1  ON 27
ci_0029                -1.042907e-02 3 1  ON 28
ci_0030                -1.035400e-02 3 1  ON 29
ci_0031                 1.382966e-02 3 1  ON 30
ci_0032                 1.292353e-02 3 1  ON 31
ci_0033                 8.266440e-03 3 1  ON 32
ci_0034                 8.533849e-03 3 1  ON 33
ci_0035                 4.870731e-03 3 1  ON 34
ci_0036                 4.719766e-03 3 1  ON 35
ci_0037                -1.140910e-02 3 1  ON 36
ci_0038                -1.132286e-02 3 1  ON 37
ci_0039                -3.815978e-03 3 1  ON 38
ci_0040                -3.936767e-03 3 1  ON 39
ci_0041                 9.549626e-03 3 1  ON 40
ci_0042                 9.466657e-03 3 1  ON 41
ci_0043                -7.707541e-03 3 1  ON 42
ci_0044                -8.176048e-03 3 1  ON 43
ci_0045                 1.041864e-02 3 1  ON 44
ci_0046                 9.663531e-03 3 1  ON 45
ci_0047                -3.602090e-03 3 1  ON 46
ci_0048                -3.628298e-03 3 1  ON 47
ci_0049                -2.502663e-03 3 1  ON 48
ci_0050                -2.574412e-03 3 1  ON 49
ci_0051                -1.847417e-03 3 1  ON 50
ci_0052                -1.725264e-03 3 1  ON 51
ci_0053                -3.856645e-03 3 1  ON 52
ci_0054                -3.739072e-03 3 1  ON 53
ci_0055                 2.329564e-03 3 1  ON 54
ci_0056                 2.087503e-03 3 1  ON 55
ci_0057                 2.315779e-03 3 1  ON 56
ci_0058                 2.906402e-03 3 1  ON 57
ci_0059                -3.908807e-03 3 1  ON 58
ci_0060                -3.676563e-03 3 1  ON 59
ci_0061                -3.094661e-03 3 1  ON 60
ci_0062                -3.312990e-03 3 1  ON 61
ci_0063                -9.716755e-03 3 1  ON 62
ci_0064                -9.670232e-03 3 1  ON 63
ci_0065                -6.926190e-03 3 1  ON 64
ci_0066                -6.466907e-03 3 1  ON 65
ci_0067                -3.910615e-03 3 1  ON 66
ci_0068                -3.861474e-03 3 1  ON 67
ci_0069                 3.718888e-03 3 1  ON 68
ci_0070                 3.467645e-03 3 1  ON 69
ci_0071                 4.106812e-03 3 1  ON 70
ci_0072                 4.297563e-03 3 1  ON 71
ci_0073                 3.369775e-03 3 1  ON 72
ci_0074                 3.326656e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8733
    reference variance = 0.151039
====================================================
  Execution time = 1.4175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9101e-01
  Total weights = 1.9511e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282345206249
                                         uncertainty =       0.001656529223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282345206249
                                         uncertainty =       0.001656529223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375772274
  error estimate for blocks of size 2^( 2) =       0.000393281414
  error estimate for blocks of size 2^( 3) =       0.000411426033
  error estimate for blocks of size 2^( 4) =       0.000427321595
  error estimate for blocks of size 2^( 5) =       0.000440196263
  error estimate for blocks of size 2^( 6) =       0.000449810573
  error estimate for blocks of size 2^( 7) =       0.000455308350

      target function =      -0.926798093451
              le_mean =     -16.897839626002
             les_mean =     285.828006541848
             stat err =       0.000443159195
             autocorr =       1.390817233639
   target nu stat err =       0.000443159195
   target dn stat err =       0.002314925925
      target stat err =       0.003732358458
              std dev =       0.531422246583
             le_variance =       0.282409604163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282271994644
                                         uncertainty =       0.001630895686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282271994644
                                         uncertainty =       0.001630895686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375723562
  error estimate for blocks of size 2^( 2) =       0.000393232801
  error estimate for blocks of size 2^( 3) =       0.000411376419
  error estimate for blocks of size 2^( 4) =       0.000427268441
  error estimate for blocks of size 2^( 5) =       0.000440139403
  error estimate for blocks of size 2^( 6) =       0.000449754681
  error estimate for blocks of size 2^( 7) =       0.000455247635

      target function =      -0.926787820945
              le_mean =     -16.897839351603
             les_mean =     285.828004082279
             stat err =       0.000443102540
             autocorr =       1.390822207497
   target nu stat err =       0.000443102540
   target dn stat err =       0.002274816899
      target stat err =       0.003670255868
              std dev =       0.531353357321
             le_variance =       0.282336390336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282307209781
                                         uncertainty =       0.001643178531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282307209781
                                         uncertainty =       0.001643178531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375746994
  error estimate for blocks of size 2^( 2) =       0.000393256205
  error estimate for blocks of size 2^( 3) =       0.000411400339
  error estimate for blocks of size 2^( 4) =       0.000427294116
  error estimate for blocks of size 2^( 5) =       0.000440166895
  error estimate for blocks of size 2^( 6) =       0.000449781695
  error estimate for blocks of size 2^( 7) =       0.000455277029

      target function =      -0.926832611351
              le_mean =     -16.897839426080
             les_mean =     285.827978088197
             stat err =       0.000443129934
             autocorr =       1.390820701215
   target nu stat err =       0.000443129934
   target dn stat err =       0.002293641067
      target stat err =       0.003699708620
              std dev =       0.531386494772
             le_variance =       0.282371606826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282340342727
                                         uncertainty =       0.001654815203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282340342727
                                         uncertainty =       0.001654815203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375769038
  error estimate for blocks of size 2^( 2) =       0.000393278189
  error estimate for blocks of size 2^( 3) =       0.000411422749
  error estimate for blocks of size 2^( 4) =       0.000427318088
  error estimate for blocks of size 2^( 5) =       0.000440192520
  error estimate for blocks of size 2^( 6) =       0.000449806893
  error estimate for blocks of size 2^( 7) =       0.000455304364

      target function =      -0.926803947347
              le_mean =     -16.897839595117
             les_mean =     285.828001811798
             stat err =       0.000443155466
             autocorr =       1.390817781116
   target nu stat err =       0.000443155466
   target dn stat err =       0.002312169030
      target stat err =       0.003728139996
              std dev =       0.531417670557
             le_variance =       0.282404740580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926798093451        initial
     2.5000e+00     2.5000e+01             3.3271e-04        -0.926787820945
     1.0000e+01     1.0000e+02             8.3247e-05        -0.926832611351  <--
     4.0000e+01     4.0000e+02             2.0816e-05        -0.926803947347

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.3730e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.030612e-01 3 1  ON 0
ci_0002                 6.980090e-01 3 1  ON 1
ci_0003                -3.155779e-02 3 1  ON 2
ci_0004                -3.139483e-02 3 1  ON 3
ci_0005                -2.888990e-02 3 1  ON 4
ci_0006                -2.993589e-02 3 1  ON 5
ci_0007                -1.591503e-02 3 1  ON 6
ci_0008                -1.653777e-02 3 1  ON 7
ci_0009                -1.873678e-02 3 1  ON 8
ci_0010                -1.889082e-02 3 1  ON 9
ci_0011                -1.551721e-02 3 1  ON 10
ci_0012                -1.565977e-02 3 1  ON 11
ci_0013                 1.551153e-02 3 1  ON 12
ci_0014                 1.537979e-02 3 1  ON 13
ci_0015                 1.631126e-02 3 1  ON 14
ci_0016                 1.595679e-02 3 1  ON 15
ci_0017                 1.373315e-02 3 1  ON 16
ci_0018                 1.395549e-02 3 1  ON 17
ci_0019                 1.259369e-02 3 1  ON 18
ci_0020                 1.224181e-02 3 1  ON 19
ci_0021                 1.363020e-02 3 1  ON 20
ci_0022                 1.510122e-02 3 1  ON 21
ci_0023                -1.181943e-02 3 1  ON 22
ci_0024                -1.113041e-02 3 1  ON 23
ci_0025                -2.834825e-03 3 1  ON 24
ci_0026                -2.399341e-03 3 1  ON 25
ci_0027                -1.178703e-02 3 1  ON 26
ci_0028                -1.174934e-02 3 1  ON 27
ci_0029                -1.042907e-02 3 1  ON 28
ci_0030                -1.035400e-02 3 1  ON 29
ci_0031                 1.382966e-02 3 1  ON 30
ci_0032                 1.292353e-02 3 1  ON 31
ci_0033                 8.266440e-03 3 1  ON 32
ci_0034                 8.533849e-03 3 1  ON 33
ci_0035                 4.870731e-03 3 1  ON 34
ci_0036                 4.719766e-03 3 1  ON 35
ci_0037                -1.140910e-02 3 1  ON 36
ci_0038                -1.132286e-02 3 1  ON 37
ci_0039                -3.815978e-03 3 1  ON 38
ci_0040                -3.936767e-03 3 1  ON 39
ci_0041                 9.549626e-03 3 1  ON 40
ci_0042                 9.466657e-03 3 1  ON 41
ci_0043                -7.707541e-03 3 1  ON 42
ci_0044                -8.176048e-03 3 1  ON 43
ci_0045                 1.041864e-02 3 1  ON 44
ci_0046                 9.663531e-03 3 1  ON 45
ci_0047                -3.602090e-03 3 1  ON 46
ci_0048                -3.628298e-03 3 1  ON 47
ci_0049                -2.502663e-03 3 1  ON 48
ci_0050                -2.574412e-03 3 1  ON 49
ci_0051                -1.847417e-03 3 1  ON 50
ci_0052                -1.725264e-03 3 1  ON 51
ci_0053                -3.856645e-03 3 1  ON 52
ci_0054                -3.739072e-03 3 1  ON 53
ci_0055                 2.329564e-03 3 1  ON 54
ci_0056                 2.087503e-03 3 1  ON 55
ci_0057                 2.315779e-03 3 1  ON 56
ci_0058                 2.906402e-03 3 1  ON 57
ci_0059                -3.908807e-03 3 1  ON 58
ci_0060                -3.676563e-03 3 1  ON 59
ci_0061                -3.094661e-03 3 1  ON 60
ci_0062                -3.312990e-03 3 1  ON 61
ci_0063                -9.716755e-03 3 1  ON 62
ci_0064                -9.670232e-03 3 1  ON 63
ci_0065                -6.926190e-03 3 1  ON 64
ci_0066                -6.466907e-03 3 1  ON 65
ci_0067                -3.910615e-03 3 1  ON 66
ci_0068                -3.861474e-03 3 1  ON 67
ci_0069                 3.718888e-03 3 1  ON 68
ci_0070                 3.467645e-03 3 1  ON 69
ci_0071                 4.106812e-03 3 1  ON 70
ci_0072                 4.297563e-03 3 1  ON 71
ci_0073                 3.369775e-03 3 1  ON 72
ci_0074                 3.326656e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8855
    reference variance = 0.248927
====================================================
  Execution time = 1.4628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9571e-01
  Total weights = 1.950900963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283890008157
                                         uncertainty =       0.001803717787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283890008157
                                         uncertainty =       0.001803717787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376779450
  error estimate for blocks of size 2^( 2) =       0.000393769117
  error estimate for blocks of size 2^( 3) =       0.000411092596
  error estimate for blocks of size 2^( 4) =       0.000426888587
  error estimate for blocks of size 2^( 5) =       0.000438267050
  error estimate for blocks of size 2^( 6) =       0.000445351639
  error estimate for blocks of size 2^( 7) =       0.000450273097

      target function =      -0.919441683380
              le_mean =     -16.898181012594
             les_mean =     285.844234728285
             stat err =       0.000440195093
             autocorr =       1.364947600089
   target nu stat err =       0.000440195093
   target dn stat err =       0.002940599363
      target stat err =       0.004632821575
              std dev =       0.532846608090
             le_variance =       0.283925507753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689818101259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919463797860       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919507974291       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919514326699       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919519168671       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919521132355       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919521665797       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919522079330       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919522414661       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919522580445       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919522707351       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919522837085       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919522894509       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919522892004       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919522910531       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919522926212       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919522925832       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919522924806       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919522923005       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919522924219       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.982413e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919463797860       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919475101804       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919476719369       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919477941857       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919478434088       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919478566915       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919478670275       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919478754415       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919478795335       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919478825724       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919478857156       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919478870749       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919478869890       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919478874265       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919478877965       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919478877840       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919478877581       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919478877161       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919478877462       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.956743e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919463797860       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919466640565       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919467046839       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919467353212       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919467476345       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919467509516       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919467535353       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919467556407       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919467566602       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919467574112       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919467581907       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919467585258       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919467585029       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919467586108       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919467587019       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919467586986       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919467586921       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919467586818       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919467586893       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.239229e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.451245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7237e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.031108e-01 3 1  ON 0
ci_0002                 6.979614e-01 3 1  ON 1
ci_0003                -3.155156e-02 3 1  ON 2
ci_0004                -3.138216e-02 3 1  ON 3
ci_0005                -2.890765e-02 3 1  ON 4
ci_0006                -2.993977e-02 3 1  ON 5
ci_0007                -1.590355e-02 3 1  ON 6
ci_0008                -1.652744e-02 3 1  ON 7
ci_0009                -1.873380e-02 3 1  ON 8
ci_0010                -1.888433e-02 3 1  ON 9
ci_0011                -1.551311e-02 3 1  ON 10
ci_0012                -1.565198e-02 3 1  ON 11
ci_0013                 1.550923e-02 3 1  ON 12
ci_0014                 1.537862e-02 3 1  ON 13
ci_0015                 1.630688e-02 3 1  ON 14
ci_0016                 1.595666e-02 3 1  ON 15
ci_0017                 1.373281e-02 3 1  ON 16
ci_0018                 1.394581e-02 3 1  ON 17
ci_0019                 1.259639e-02 3 1  ON 18
ci_0020                 1.224466e-02 3 1  ON 19
ci_0021                 1.359252e-02 3 1  ON 20
ci_0022                 1.506641e-02 3 1  ON 21
ci_0023                -1.182438e-02 3 1  ON 22
ci_0024                -1.113165e-02 3 1  ON 23
ci_0025                -2.828004e-03 3 1  ON 24
ci_0026                -2.405417e-03 3 1  ON 25
ci_0027                -1.178781e-02 3 1  ON 26
ci_0028                -1.174726e-02 3 1  ON 27
ci_0029                -1.043489e-02 3 1  ON 28
ci_0030                -1.036415e-02 3 1  ON 29
ci_0031                 1.383613e-02 3 1  ON 30
ci_0032                 1.291187e-02 3 1  ON 31
ci_0033                 8.264245e-03 3 1  ON 32
ci_0034                 8.529439e-03 3 1  ON 33
ci_0035                 4.880589e-03 3 1  ON 34
ci_0036                 4.717317e-03 3 1  ON 35
ci_0037                -1.141572e-02 3 1  ON 36
ci_0038                -1.131012e-02 3 1  ON 37
ci_0039                -3.816663e-03 3 1  ON 38
ci_0040                -3.939515e-03 3 1  ON 39
ci_0041                 9.551622e-03 3 1  ON 40
ci_0042                 9.460881e-03 3 1  ON 41
ci_0043                -7.742599e-03 3 1  ON 42
ci_0044                -8.208701e-03 3 1  ON 43
ci_0045                 1.041984e-02 3 1  ON 44
ci_0046                 9.665304e-03 3 1  ON 45
ci_0047                -3.600096e-03 3 1  ON 46
ci_0048                -3.625321e-03 3 1  ON 47
ci_0049                -2.513670e-03 3 1  ON 48
ci_0050                -2.561600e-03 3 1  ON 49
ci_0051                -1.836542e-03 3 1  ON 50
ci_0052                -1.720066e-03 3 1  ON 51
ci_0053                -3.855019e-03 3 1  ON 52
ci_0054                -3.735213e-03 3 1  ON 53
ci_0055                 2.328797e-03 3 1  ON 54
ci_0056                 2.080392e-03 3 1  ON 55
ci_0057                 2.321204e-03 3 1  ON 56
ci_0058                 2.898923e-03 3 1  ON 57
ci_0059                -3.901547e-03 3 1  ON 58
ci_0060                -3.680885e-03 3 1  ON 59
ci_0061                -3.105877e-03 3 1  ON 60
ci_0062                -3.313842e-03 3 1  ON 61
ci_0063                -9.715932e-03 3 1  ON 62
ci_0064                -9.666166e-03 3 1  ON 63
ci_0065                -6.925709e-03 3 1  ON 64
ci_0066                -6.471298e-03 3 1  ON 65
ci_0067                -3.905832e-03 3 1  ON 66
ci_0068                -3.853067e-03 3 1  ON 67
ci_0069                 3.722507e-03 3 1  ON 68
ci_0070                 3.464596e-03 3 1  ON 69
ci_0071                 4.099543e-03 3 1  ON 70
ci_0072                 4.261311e-03 3 1  ON 71
ci_0073                 3.371406e-03 3 1  ON 72
ci_0074                 3.324922e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9767
    reference variance = 0.290622
====================================================
  Execution time = 1.4348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0191e-01
  Total weights = 1.9508e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286806813478
                                         uncertainty =       0.004233195329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286806813478
                                         uncertainty =       0.004233195329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378656287
  error estimate for blocks of size 2^( 2) =       0.000395997302
  error estimate for blocks of size 2^( 3) =       0.000413477469
  error estimate for blocks of size 2^( 4) =       0.000428900898
  error estimate for blocks of size 2^( 5) =       0.000440125308
  error estimate for blocks of size 2^( 6) =       0.000447558952
  error estimate for blocks of size 2^( 7) =       0.000452621104

      target function =      -0.909673747903
              le_mean =     -16.898347206125
             les_mean =     285.856059229236
             stat err =       0.000442301566
             autocorr =       1.364415391399
   target nu stat err =       0.000442301566
   target dn stat err =       0.009629986007
      target stat err =       0.014684669345
              std dev =       0.535500856291
             le_variance =       0.286761167089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286762878953
                                         uncertainty =       0.004233615759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286762878953
                                         uncertainty =       0.004233615759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378627332
  error estimate for blocks of size 2^( 2) =       0.000395962685
  error estimate for blocks of size 2^( 3) =       0.000413436813
  error estimate for blocks of size 2^( 4) =       0.000428854575
  error estimate for blocks of size 2^( 5) =       0.000440072780
  error estimate for blocks of size 2^( 6) =       0.000447504828
  error estimate for blocks of size 2^( 7) =       0.000452561432

      target function =      -0.909547972984
              le_mean =     -16.898348934737
             les_mean =     285.856200148136
             stat err =       0.000442248403
             autocorr =       1.364296059431
   target nu stat err =       0.000442248403
   target dn stat err =       0.009633773412
      target stat err =       0.014686417346
              std dev =       0.535459908225
             le_variance =       0.286717313316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286784114764
                                         uncertainty =       0.004233388173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286784114764
                                         uncertainty =       0.004233388173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378641327
  error estimate for blocks of size 2^( 2) =       0.000395979465
  error estimate for blocks of size 2^( 3) =       0.000413456569
  error estimate for blocks of size 2^( 4) =       0.000428877139
  error estimate for blocks of size 2^( 5) =       0.000440098401
  error estimate for blocks of size 2^( 6) =       0.000447531231
  error estimate for blocks of size 2^( 7) =       0.000452590484

      target function =      -0.909682365204
              le_mean =     -16.898348043353
             les_mean =     285.856081822371
             stat err =       0.000442274314
             autocorr =       1.364355063783
   target nu stat err =       0.000442274314
   target dn stat err =       0.009630955957
      target stat err =       0.014686443706
              std dev =       0.535479700108
             le_variance =       0.286738509228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286803920159
                                         uncertainty =       0.004233218291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286803920159
                                         uncertainty =       0.004233218291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378654380
  error estimate for blocks of size 2^( 2) =       0.000395995033
  error estimate for blocks of size 2^( 3) =       0.000413474816
  error estimate for blocks of size 2^( 4) =       0.000428897888
  error estimate for blocks of size 2^( 5) =       0.000440121903
  error estimate for blocks of size 2^( 6) =       0.000447555445
  error estimate for blocks of size 2^( 7) =       0.000452617227

      target function =      -0.909678834731
              le_mean =     -16.898347305956
             les_mean =     285.856059257485
             stat err =       0.000442298116
             autocorr =       1.364407850493
   target nu stat err =       0.000442298116
   target dn stat err =       0.009630069677
      target stat err =       0.014684963147
              std dev =       0.535498159574
             le_variance =       0.286758278907


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909673747903        initial
     2.5000e+00     2.5000e+01             1.9824e-04        -0.909547972984
     1.0000e+01     1.0000e+02             4.9567e-05        -0.909682365204  <--
     4.0000e+01     4.0000e+02             1.2392e-05        -0.909678834731

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.3936e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.031108e-01 3 1  ON 0
ci_0002                 6.979614e-01 3 1  ON 1
ci_0003                -3.155156e-02 3 1  ON 2
ci_0004                -3.138216e-02 3 1  ON 3
ci_0005                -2.890765e-02 3 1  ON 4
ci_0006                -2.993977e-02 3 1  ON 5
ci_0007                -1.590355e-02 3 1  ON 6
ci_0008                -1.652744e-02 3 1  ON 7
ci_0009                -1.873380e-02 3 1  ON 8
ci_0010                -1.888433e-02 3 1  ON 9
ci_0011                -1.551311e-02 3 1  ON 10
ci_0012                -1.565198e-02 3 1  ON 11
ci_0013                 1.550923e-02 3 1  ON 12
ci_0014                 1.537862e-02 3 1  ON 13
ci_0015                 1.630688e-02 3 1  ON 14
ci_0016                 1.595666e-02 3 1  ON 15
ci_0017                 1.373281e-02 3 1  ON 16
ci_0018                 1.394581e-02 3 1  ON 17
ci_0019                 1.259639e-02 3 1  ON 18
ci_0020                 1.224466e-02 3 1  ON 19
ci_0021                 1.359252e-02 3 1  ON 20
ci_0022                 1.506641e-02 3 1  ON 21
ci_0023                -1.182438e-02 3 1  ON 22
ci_0024                -1.113165e-02 3 1  ON 23
ci_0025                -2.828004e-03 3 1  ON 24
ci_0026                -2.405417e-03 3 1  ON 25
ci_0027                -1.178781e-02 3 1  ON 26
ci_0028                -1.174726e-02 3 1  ON 27
ci_0029                -1.043489e-02 3 1  ON 28
ci_0030                -1.036415e-02 3 1  ON 29
ci_0031                 1.383613e-02 3 1  ON 30
ci_0032                 1.291187e-02 3 1  ON 31
ci_0033                 8.264245e-03 3 1  ON 32
ci_0034                 8.529439e-03 3 1  ON 33
ci_0035                 4.880589e-03 3 1  ON 34
ci_0036                 4.717317e-03 3 1  ON 35
ci_0037                -1.141572e-02 3 1  ON 36
ci_0038                -1.131012e-02 3 1  ON 37
ci_0039                -3.816663e-03 3 1  ON 38
ci_0040                -3.939515e-03 3 1  ON 39
ci_0041                 9.551622e-03 3 1  ON 40
ci_0042                 9.460881e-03 3 1  ON 41
ci_0043                -7.742599e-03 3 1  ON 42
ci_0044                -8.208701e-03 3 1  ON 43
ci_0045                 1.041984e-02 3 1  ON 44
ci_0046                 9.665304e-03 3 1  ON 45
ci_0047                -3.600096e-03 3 1  ON 46
ci_0048                -3.625321e-03 3 1  ON 47
ci_0049                -2.513670e-03 3 1  ON 48
ci_0050                -2.561600e-03 3 1  ON 49
ci_0051                -1.836542e-03 3 1  ON 50
ci_0052                -1.720066e-03 3 1  ON 51
ci_0053                -3.855019e-03 3 1  ON 52
ci_0054                -3.735213e-03 3 1  ON 53
ci_0055                 2.328797e-03 3 1  ON 54
ci_0056                 2.080392e-03 3 1  ON 55
ci_0057                 2.321204e-03 3 1  ON 56
ci_0058                 2.898923e-03 3 1  ON 57
ci_0059                -3.901547e-03 3 1  ON 58
ci_0060                -3.680885e-03 3 1  ON 59
ci_0061                -3.105877e-03 3 1  ON 60
ci_0062                -3.313842e-03 3 1  ON 61
ci_0063                -9.715932e-03 3 1  ON 62
ci_0064                -9.666166e-03 3 1  ON 63
ci_0065                -6.925709e-03 3 1  ON 64
ci_0066                -6.471298e-03 3 1  ON 65
ci_0067                -3.905832e-03 3 1  ON 66
ci_0068                -3.853067e-03 3 1  ON 67
ci_0069                 3.722507e-03 3 1  ON 68
ci_0070                 3.464596e-03 3 1  ON 69
ci_0071                 4.099543e-03 3 1  ON 70
ci_0072                 4.261311e-03 3 1  ON 71
ci_0073                 3.371406e-03 3 1  ON 72
ci_0074                 3.324922e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.230461
====================================================
  Execution time = 1.4657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9138e-01
  Total weights = 1.951098868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282354462926
                                         uncertainty =       0.001827618452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282354462926
                                         uncertainty =       0.001827618452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375695522
  error estimate for blocks of size 2^( 2) =       0.000392909937
  error estimate for blocks of size 2^( 3) =       0.000410359241
  error estimate for blocks of size 2^( 4) =       0.000426240466
  error estimate for blocks of size 2^( 5) =       0.000437758583
  error estimate for blocks of size 2^( 6) =       0.000445970144
  error estimate for blocks of size 2^( 7) =       0.000450094072

      target function =      -0.926232455120
              le_mean =     -16.897497303961
             les_mean =     285.816793554850
             stat err =       0.000440015816
             autocorr =       1.371717052124
   target nu stat err =       0.000440015816
   target dn stat err =       0.002242692318
      target stat err =       0.003613023917
              std dev =       0.531313702451
             le_variance =       0.282294250412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689749730396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926245254223       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926275196082       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926281214428       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926285093467       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926287657905       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926288013284       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926288180420       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926288249001       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926288286330       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926288298779       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926288264726       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926288317775       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926288329572       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926288345005       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926288337173       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926288334529       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926288334793       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926288332424       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.817106e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926245254223       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926252913339       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926254445721       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926255425286       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926256067889       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926256155211       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926256196771       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926256213741       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926256222856       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926256225758       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926256217177       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926256230301       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926256233074       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926256236738       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926256234805       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926256234159       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926256234222       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926256233661       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.599725e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926245254223       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926247180171       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926247565043       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926247810549       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926247971284       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926247993015       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926248003390       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926248007622       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926248009886       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926248010598       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926248008449       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926248011721       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926248012403       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926248013307       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926248012826       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926248012665       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926248012681       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926248012542       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.153547e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7233e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.031388e-01 3 1  ON 0
ci_0002                 6.979367e-01 3 1  ON 1
ci_0003                -3.154713e-02 3 1  ON 2
ci_0004                -3.137457e-02 3 1  ON 3
ci_0005                -2.891126e-02 3 1  ON 4
ci_0006                -2.994928e-02 3 1  ON 5
ci_0007                -1.588245e-02 3 1  ON 6
ci_0008                -1.650812e-02 3 1  ON 7
ci_0009                -1.873553e-02 3 1  ON 8
ci_0010                -1.888010e-02 3 1  ON 9
ci_0011                -1.550779e-02 3 1  ON 10
ci_0012                -1.564693e-02 3 1  ON 11
ci_0013                 1.550486e-02 3 1  ON 12
ci_0014                 1.537676e-02 3 1  ON 13
ci_0015                 1.630069e-02 3 1  ON 14
ci_0016                 1.595350e-02 3 1  ON 15
ci_0017                 1.373008e-02 3 1  ON 16
ci_0018                 1.393614e-02 3 1  ON 17
ci_0019                 1.260233e-02 3 1  ON 18
ci_0020                 1.224440e-02 3 1  ON 19
ci_0021                 1.354653e-02 3 1  ON 20
ci_0022                 1.502658e-02 3 1  ON 21
ci_0023                -1.182693e-02 3 1  ON 22
ci_0024                -1.113298e-02 3 1  ON 23
ci_0025                -2.818973e-03 3 1  ON 24
ci_0026                -2.395211e-03 3 1  ON 25
ci_0027                -1.178311e-02 3 1  ON 26
ci_0028                -1.174750e-02 3 1  ON 27
ci_0029                -1.043243e-02 3 1  ON 28
ci_0030                -1.036435e-02 3 1  ON 29
ci_0031                 1.383535e-02 3 1  ON 30
ci_0032                 1.290574e-02 3 1  ON 31
ci_0033                 8.265064e-03 3 1  ON 32
ci_0034                 8.524216e-03 3 1  ON 33
ci_0035                 4.884405e-03 3 1  ON 34
ci_0036                 4.714797e-03 3 1  ON 35
ci_0037                -1.141840e-02 3 1  ON 36
ci_0038                -1.130643e-02 3 1  ON 37
ci_0039                -3.817534e-03 3 1  ON 38
ci_0040                -3.938293e-03 3 1  ON 39
ci_0041                 9.551653e-03 3 1  ON 40
ci_0042                 9.462753e-03 3 1  ON 41
ci_0043                -7.768775e-03 3 1  ON 42
ci_0044                -8.237881e-03 3 1  ON 43
ci_0045                 1.041959e-02 3 1  ON 44
ci_0046                 9.670297e-03 3 1  ON 45
ci_0047                -3.597321e-03 3 1  ON 46
ci_0048                -3.624081e-03 3 1  ON 47
ci_0049                -2.498937e-03 3 1  ON 48
ci_0050                -2.560105e-03 3 1  ON 49
ci_0051                -1.838412e-03 3 1  ON 50
ci_0052                -1.723053e-03 3 1  ON 51
ci_0053                -3.846058e-03 3 1  ON 52
ci_0054                -3.729804e-03 3 1  ON 53
ci_0055                 2.326381e-03 3 1  ON 54
ci_0056                 2.068611e-03 3 1  ON 55
ci_0057                 2.317852e-03 3 1  ON 56
ci_0058                 2.903604e-03 3 1  ON 57
ci_0059                -3.893024e-03 3 1  ON 58
ci_0060                -3.693035e-03 3 1  ON 59
ci_0061                -3.111805e-03 3 1  ON 60
ci_0062                -3.322266e-03 3 1  ON 61
ci_0063                -9.716393e-03 3 1  ON 62
ci_0064                -9.664890e-03 3 1  ON 63
ci_0065                -6.918859e-03 3 1  ON 64
ci_0066                -6.466108e-03 3 1  ON 65
ci_0067                -3.912656e-03 3 1  ON 66
ci_0068                -3.843198e-03 3 1  ON 67
ci_0069                 3.714341e-03 3 1  ON 68
ci_0070                 3.468382e-03 3 1  ON 69
ci_0071                 4.083934e-03 3 1  ON 70
ci_0072                 4.245244e-03 3 1  ON 71
ci_0073                 3.377856e-03 3 1  ON 72
ci_0074                 3.334079e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.306696
====================================================
  Execution time = 1.4190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9784e-01
  Total weights = 1.9508e+06
  Execution time = 1.8900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283156557035
                                         uncertainty =       0.001667781628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283156557035
                                         uncertainty =       0.001667781628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376292224
  error estimate for blocks of size 2^( 2) =       0.000393457046
  error estimate for blocks of size 2^( 3) =       0.000411315812
  error estimate for blocks of size 2^( 4) =       0.000426893645
  error estimate for blocks of size 2^( 5) =       0.000438445861
  error estimate for blocks of size 2^( 6) =       0.000447497637
  error estimate for blocks of size 2^( 7) =       0.000452546585

      target function =      -0.916174070031
              le_mean =     -16.897754276068
             les_mean =     285.831898933836
             stat err =       0.000441345932
             autocorr =       1.375649414196
   target nu stat err =       0.000441345932
   target dn stat err =       0.004810922687
      target stat err =       0.007459470158
              std dev =       0.532157567233
             le_variance =       0.283191676364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283115140243
                                         uncertainty =       0.001667653867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283115140243
                                         uncertainty =       0.001667653867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376265092
  error estimate for blocks of size 2^( 2) =       0.000393426361
  error estimate for blocks of size 2^( 3) =       0.000411280262
  error estimate for blocks of size 2^( 4) =       0.000426852162
  error estimate for blocks of size 2^( 5) =       0.000438400067
  error estimate for blocks of size 2^( 6) =       0.000447450227
  error estimate for blocks of size 2^( 7) =       0.000452493679

      target function =      -0.915121474627
              le_mean =     -16.897755686887
             les_mean =     285.832622640428
             stat err =       0.000441299034
             autocorr =       1.375555428691
   target nu stat err =       0.000441299034
   target dn stat err =       0.005230987016
      target stat err =       0.008086158504
              std dev =       0.532119196860
             le_variance =       0.283150839667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283135100706
                                         uncertainty =       0.001667701651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283135100706
                                         uncertainty =       0.001667701651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376278163
  error estimate for blocks of size 2^( 2) =       0.000393441194
  error estimate for blocks of size 2^( 3) =       0.000411297496
  error estimate for blocks of size 2^( 4) =       0.000426872306
  error estimate for blocks of size 2^( 5) =       0.000438422320
  error estimate for blocks of size 2^( 6) =       0.000447473261
  error estimate for blocks of size 2^( 7) =       0.000452519556

      target function =      -0.915949768993
              le_mean =     -16.897754921868
             les_mean =     285.832062884613
             stat err =       0.000441321861
             autocorr =       1.375602164905
   target nu stat err =       0.000441321861
   target dn stat err =       0.005011082246
      target stat err =       0.007763066494
              std dev =       0.532137681707
             le_variance =       0.283170512292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283153815121
                                         uncertainty =       0.001667769934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283153815121
                                         uncertainty =       0.001667769934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376290427
  error estimate for blocks of size 2^( 2) =       0.000393455023
  error estimate for blocks of size 2^( 3) =       0.000411313482
  error estimate for blocks of size 2^( 4) =       0.000426890936
  error estimate for blocks of size 2^( 5) =       0.000438442871
  error estimate for blocks of size 2^( 6) =       0.000447494533
  error estimate for blocks of size 2^( 7) =       0.000452543153

      target function =      -0.916184282441
              le_mean =     -16.897754348548
             les_mean =     285.831894372227
             stat err =       0.000441342873
             autocorr =       1.375643485724
   target nu stat err =       0.000441342873
   target dn stat err =       0.004834968130
      target stat err =       0.007496555828
              std dev =       0.532155025346
             le_variance =       0.283188971001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916174070031        initial
     2.5000e+00     2.5000e+01             1.8171e-04        -0.915121474627
     1.0000e+01     1.0000e+02             4.5997e-05        -0.915949768993
     4.0000e+01     4.0000e+02             1.1535e-05        -0.916184282441  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 2.3725e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.031178e-01 3 1  ON 0
ci_0002                 6.979552e-01 3 1  ON 1
ci_0003                -3.155045e-02 3 1  ON 2
ci_0004                -3.138026e-02 3 1  ON 3
ci_0005                -2.890856e-02 3 1  ON 4
ci_0006                -2.994216e-02 3 1  ON 5
ci_0007                -1.589826e-02 3 1  ON 6
ci_0008                -1.652260e-02 3 1  ON 7
ci_0009                -1.873423e-02 3 1  ON 8
ci_0010                -1.888327e-02 3 1  ON 9
ci_0011                -1.551177e-02 3 1  ON 10
ci_0012                -1.565071e-02 3 1  ON 11
ci_0013                 1.550813e-02 3 1  ON 12
ci_0014                 1.537815e-02 3 1  ON 13
ci_0015                 1.630532e-02 3 1  ON 14
ci_0016                 1.595587e-02 3 1  ON 15
ci_0017                 1.373212e-02 3 1  ON 16
ci_0018                 1.394338e-02 3 1  ON 17
ci_0019                 1.259788e-02 3 1  ON 18
ci_0020                 1.224459e-02 3 1  ON 19
ci_0021                 1.358099e-02 3 1  ON 20
ci_0022                 1.505642e-02 3 1  ON 21
ci_0023                -1.182502e-02 3 1  ON 22
ci_0024                -1.113199e-02 3 1  ON 23
ci_0025                -2.825733e-03 3 1  ON 24
ci_0026                -2.402851e-03 3 1  ON 25
ci_0027                -1.178663e-02 3 1  ON 26
ci_0028                -1.174732e-02 3 1  ON 27
ci_0029                -1.043427e-02 3 1  ON 28
ci_0030                -1.036420e-02 3 1  ON 29
ci_0031                 1.383593e-02 3 1  ON 30
ci_0032                 1.291033e-02 3 1  ON 31
ci_0033                 8.264450e-03 3 1  ON 32
ci_0034                 8.528129e-03 3 1  ON 33
ci_0035                 4.881549e-03 3 1  ON 34
ci_0036                 4.716684e-03 3 1  ON 35
ci_0037                -1.141639e-02 3 1  ON 36
ci_0038                -1.130919e-02 3 1  ON 37
ci_0039                -3.816881e-03 3 1  ON 38
ci_0040                -3.939208e-03 3 1  ON 39
ci_0041                 9.551629e-03 3 1  ON 40
ci_0042                 9.461352e-03 3 1  ON 41
ci_0043                -7.749166e-03 3 1  ON 42
ci_0044                -8.216022e-03 3 1  ON 43
ci_0045                 1.041978e-02 3 1  ON 44
ci_0046                 9.666558e-03 3 1  ON 45
ci_0047                -3.599398e-03 3 1  ON 46
ci_0048                -3.625009e-03 3 1  ON 47
ci_0049                -2.509966e-03 3 1  ON 48
ci_0050                -2.561224e-03 3 1  ON 49
ci_0051                -1.837012e-03 3 1  ON 50
ci_0052                -1.720817e-03 3 1  ON 51
ci_0053                -3.852765e-03 3 1  ON 52
ci_0054                -3.733853e-03 3 1  ON 53
ci_0055                 2.328189e-03 3 1  ON 54
ci_0056                 2.077429e-03 3 1  ON 55
ci_0057                 2.320361e-03 3 1  ON 56
ci_0058                 2.900100e-03 3 1  ON 57
ci_0059                -3.899403e-03 3 1  ON 58
ci_0060                -3.683940e-03 3 1  ON 59
ci_0061                -3.107366e-03 3 1  ON 60
ci_0062                -3.315958e-03 3 1  ON 61
ci_0063                -9.716048e-03 3 1  ON 62
ci_0064                -9.665846e-03 3 1  ON 63
ci_0065                -6.923988e-03 3 1  ON 64
ci_0066                -6.469995e-03 3 1  ON 65
ci_0067                -3.907548e-03 3 1  ON 66
ci_0068                -3.850585e-03 3 1  ON 67
ci_0069                 3.720454e-03 3 1  ON 68
ci_0070                 3.465548e-03 3 1  ON 69
ci_0071                 4.095618e-03 3 1  ON 70
ci_0072                 4.257271e-03 3 1  ON 71
ci_0073                 3.373028e-03 3 1  ON 72
ci_0074                 3.327225e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9595
    reference variance = 0.265539
====================================================
  Execution time = 1.6512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9868e-01
  Total weights = 1.951001303e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285253190918
                                         uncertainty =       0.002371999672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285253190918
                                         uncertainty =       0.002371999672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377646074
  error estimate for blocks of size 2^( 2) =       0.000395026500
  error estimate for blocks of size 2^( 3) =       0.000412711536
  error estimate for blocks of size 2^( 4) =       0.000427685252
  error estimate for blocks of size 2^( 5) =       0.000439026889
  error estimate for blocks of size 2^( 6) =       0.000446460973
  error estimate for blocks of size 2^( 7) =       0.000452538891

      target function =      -0.914814269275
              le_mean =     -16.897779840638
             les_mean =     285.833647521859
             stat err =       0.000441428001
             autocorr =       1.366311767727
   target nu stat err =       0.000441428001
   target dn stat err =       0.004706214471
      target stat err =       0.007277539899
              std dev =       0.534072199600
             le_variance =       0.285233114385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689777984064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914870512540       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914876755278       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914878672356       residual = 9.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914879316588       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914879650022       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914879770764       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914879807654       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914879812452       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914879849928       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914879881060       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914879905466       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914879910571       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914879912059       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914879908890       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914879907758       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914879905306       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914879904379       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914879904183       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.440569e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914870512540       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914872081905       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914872562995       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914872724395       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914872807658       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914872837779       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914872846977       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914872848167       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914872857559       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914872865313       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914872871383       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914872872608       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914872872957       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914872872164       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914872871881       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914872871273       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914872871045       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914872870998       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.113736e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914870512540       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914870905427       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914871025814       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914871066185       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914871086995       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914871094521       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914871096819       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914871097116       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914871099465       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914871101402       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914871102918       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914871103221       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914871103307       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914871103108       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914871103037       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914871102886       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914871102829       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914871102817       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.6000e+02 is 2.786596e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.472011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9138e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.031108e-01 3 1  ON 0
ci_0002                 6.979628e-01 3 1  ON 1
ci_0003                -3.154848e-02 3 1  ON 2
ci_0004                -3.137842e-02 3 1  ON 3
ci_0005                -2.891145e-02 3 1  ON 4
ci_0006                -2.994278e-02 3 1  ON 5
ci_0007                -1.589657e-02 3 1  ON 6
ci_0008                -1.651735e-02 3 1  ON 7
ci_0009                -1.873286e-02 3 1  ON 8
ci_0010                -1.888447e-02 3 1  ON 9
ci_0011                -1.551100e-02 3 1  ON 10
ci_0012                -1.565014e-02 3 1  ON 11
ci_0013                 1.550892e-02 3 1  ON 12
ci_0014                 1.537932e-02 3 1  ON 13
ci_0015                 1.630379e-02 3 1  ON 14
ci_0016                 1.595751e-02 3 1  ON 15
ci_0017                 1.373194e-02 3 1  ON 16
ci_0018                 1.393997e-02 3 1  ON 17
ci_0019                 1.259846e-02 3 1  ON 18
ci_0020                 1.224785e-02 3 1  ON 19
ci_0021                 1.357335e-02 3 1  ON 20
ci_0022                 1.504906e-02 3 1  ON 21
ci_0023                -1.182389e-02 3 1  ON 22
ci_0024                -1.113131e-02 3 1  ON 23
ci_0025                -2.826594e-03 3 1  ON 24
ci_0026                -2.401215e-03 3 1  ON 25
ci_0027                -1.178544e-02 3 1  ON 26
ci_0028                -1.174715e-02 3 1  ON 27
ci_0029                -1.043270e-02 3 1  ON 28
ci_0030                -1.036581e-02 3 1  ON 29
ci_0031                 1.383723e-02 3 1  ON 30
ci_0032                 1.290774e-02 3 1  ON 31
ci_0033                 8.264605e-03 3 1  ON 32
ci_0034                 8.526260e-03 3 1  ON 33
ci_0035                 4.878803e-03 3 1  ON 34
ci_0036                 4.716159e-03 3 1  ON 35
ci_0037                -1.141555e-02 3 1  ON 36
ci_0038                -1.130662e-02 3 1  ON 37
ci_0039                -3.817082e-03 3 1  ON 38
ci_0040                -3.938577e-03 3 1  ON 39
ci_0041                 9.550981e-03 3 1  ON 40
ci_0042                 9.461982e-03 3 1  ON 41
ci_0043                -7.760303e-03 3 1  ON 42
ci_0044                -8.220648e-03 3 1  ON 43
ci_0045                 1.042024e-02 3 1  ON 44
ci_0046                 9.667950e-03 3 1  ON 45
ci_0047                -3.599383e-03 3 1  ON 46
ci_0048                -3.625083e-03 3 1  ON 47
ci_0049                -2.508626e-03 3 1  ON 48
ci_0050                -2.560643e-03 3 1  ON 49
ci_0051                -1.837146e-03 3 1  ON 50
ci_0052                -1.720883e-03 3 1  ON 51
ci_0053                -3.851915e-03 3 1  ON 52
ci_0054                -3.737779e-03 3 1  ON 53
ci_0055                 2.329368e-03 3 1  ON 54
ci_0056                 2.077512e-03 3 1  ON 55
ci_0057                 2.318517e-03 3 1  ON 56
ci_0058                 2.900508e-03 3 1  ON 57
ci_0059                -3.899141e-03 3 1  ON 58
ci_0060                -3.683965e-03 3 1  ON 59
ci_0061                -3.108149e-03 3 1  ON 60
ci_0062                -3.314331e-03 3 1  ON 61
ci_0063                -9.715296e-03 3 1  ON 62
ci_0064                -9.661619e-03 3 1  ON 63
ci_0065                -6.922377e-03 3 1  ON 64
ci_0066                -6.467895e-03 3 1  ON 65
ci_0067                -3.906047e-03 3 1  ON 66
ci_0068                -3.852070e-03 3 1  ON 67
ci_0069                 3.719039e-03 3 1  ON 68
ci_0070                 3.466435e-03 3 1  ON 69
ci_0071                 4.092937e-03 3 1  ON 70
ci_0072                 4.257735e-03 3 1  ON 71
ci_0073                 3.373801e-03 3 1  ON 72
ci_0074                 3.328707e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.633561
====================================================
  Execution time = 1.4335e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0001e-01
  Total weights = 1.9509e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288262383061
                                         uncertainty =       0.002427180239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288262383061
                                         uncertainty =       0.002427180239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379686522
  error estimate for blocks of size 2^( 2) =       0.000397243903
  error estimate for blocks of size 2^( 3) =       0.000415303784
  error estimate for blocks of size 2^( 4) =       0.000431774474
  error estimate for blocks of size 2^( 5) =       0.000444349266
  error estimate for blocks of size 2^( 6) =       0.000454317249
  error estimate for blocks of size 2^( 7) =       0.000459986736

      target function =      -0.912787245838
              le_mean =     -16.897678099774
             les_mean =     285.831552493421
             stat err =       0.000447606931
             autocorr =       1.389770996265
   target nu stat err =       0.000447606931
   target dn stat err =       0.003004197226
      target stat err =       0.004660756436
              std dev =       0.536957828962
             le_variance =       0.288323710083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288252507576
                                         uncertainty =       0.002427250337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288252507576
                                         uncertainty =       0.002427250337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379680015
  error estimate for blocks of size 2^( 2) =       0.000397236558
  error estimate for blocks of size 2^( 3) =       0.000415295252
  error estimate for blocks of size 2^( 4) =       0.000431764488
  error estimate for blocks of size 2^( 5) =       0.000444337527
  error estimate for blocks of size 2^( 6) =       0.000454304994
  error estimate for blocks of size 2^( 7) =       0.000459974155

      target function =      -0.912818081618
              le_mean =     -16.897677997092
             les_mean =     285.831528920113
             stat err =       0.000447595291
             autocorr =       1.389746346095
   target nu stat err =       0.000447595291
   target dn stat err =       0.003000696891
      target stat err =       0.004655773140
              std dev =       0.536948627125
             le_variance =       0.288313828171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288257406279
                                         uncertainty =       0.002427212657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288257406279
                                         uncertainty =       0.002427212657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379683243
  error estimate for blocks of size 2^( 2) =       0.000397240202
  error estimate for blocks of size 2^( 3) =       0.000415299489
  error estimate for blocks of size 2^( 4) =       0.000431769450
  error estimate for blocks of size 2^( 5) =       0.000444343361
  error estimate for blocks of size 2^( 6) =       0.000454311084
  error estimate for blocks of size 2^( 7) =       0.000459980406

      target function =      -0.912821874792
              le_mean =     -16.897678047920
             les_mean =     285.831528143795
             stat err =       0.000447601075
             autocorr =       1.389758635896
   target nu stat err =       0.000447601075
   target dn stat err =       0.003002323058
      target stat err =       0.004658270976
              std dev =       0.536953191741
             le_variance =       0.288318730120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288261758001
                                         uncertainty =       0.002427184096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288261758001
                                         uncertainty =       0.002427184096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379686110
  error estimate for blocks of size 2^( 2) =       0.000397243438
  error estimate for blocks of size 2^( 3) =       0.000415303245
  error estimate for blocks of size 2^( 4) =       0.000431773844
  error estimate for blocks of size 2^( 5) =       0.000444348526
  error estimate for blocks of size 2^( 6) =       0.000454316476
  error estimate for blocks of size 2^( 7) =       0.000459985943

      target function =      -0.912794975870
              le_mean =     -16.897678093286
             les_mean =     285.831547228021
             stat err =       0.000447606197
             autocorr =       1.389769453386
   target nu stat err =       0.000447606197
   target dn stat err =       0.003003947972
      target stat err =       0.004660457415
              std dev =       0.536957246555
             le_variance =       0.288323084628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912787245838        initial
     1.0000e+01     1.0000e+02             4.4406e-05        -0.912818081618
     4.0000e+01     4.0000e+02             1.1137e-05        -0.912821874792  <--
     1.6000e+02     1.6000e+03             2.7866e-06        -0.912794975870

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 2.3819e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.031108e-01 3 1  ON 0
ci_0002                 6.979628e-01 3 1  ON 1
ci_0003                -3.154848e-02 3 1  ON 2
ci_0004                -3.137842e-02 3 1  ON 3
ci_0005                -2.891145e-02 3 1  ON 4
ci_0006                -2.994278e-02 3 1  ON 5
ci_0007                -1.589657e-02 3 1  ON 6
ci_0008                -1.651735e-02 3 1  ON 7
ci_0009                -1.873286e-02 3 1  ON 8
ci_0010                -1.888447e-02 3 1  ON 9
ci_0011                -1.551100e-02 3 1  ON 10
ci_0012                -1.565014e-02 3 1  ON 11
ci_0013                 1.550892e-02 3 1  ON 12
ci_0014                 1.537932e-02 3 1  ON 13
ci_0015                 1.630379e-02 3 1  ON 14
ci_0016                 1.595751e-02 3 1  ON 15
ci_0017                 1.373194e-02 3 1  ON 16
ci_0018                 1.393997e-02 3 1  ON 17
ci_0019                 1.259846e-02 3 1  ON 18
ci_0020                 1.224785e-02 3 1  ON 19
ci_0021                 1.357335e-02 3 1  ON 20
ci_0022                 1.504906e-02 3 1  ON 21
ci_0023                -1.182389e-02 3 1  ON 22
ci_0024                -1.113131e-02 3 1  ON 23
ci_0025                -2.826594e-03 3 1  ON 24
ci_0026                -2.401215e-03 3 1  ON 25
ci_0027                -1.178544e-02 3 1  ON 26
ci_0028                -1.174715e-02 3 1  ON 27
ci_0029                -1.043270e-02 3 1  ON 28
ci_0030                -1.036581e-02 3 1  ON 29
ci_0031                 1.383723e-02 3 1  ON 30
ci_0032                 1.290774e-02 3 1  ON 31
ci_0033                 8.264605e-03 3 1  ON 32
ci_0034                 8.526260e-03 3 1  ON 33
ci_0035                 4.878803e-03 3 1  ON 34
ci_0036                 4.716159e-03 3 1  ON 35
ci_0037                -1.141555e-02 3 1  ON 36
ci_0038                -1.130662e-02 3 1  ON 37
ci_0039                -3.817082e-03 3 1  ON 38
ci_0040                -3.938577e-03 3 1  ON 39
ci_0041                 9.550981e-03 3 1  ON 40
ci_0042                 9.461982e-03 3 1  ON 41
ci_0043                -7.760303e-03 3 1  ON 42
ci_0044                -8.220648e-03 3 1  ON 43
ci_0045                 1.042024e-02 3 1  ON 44
ci_0046                 9.667950e-03 3 1  ON 45
ci_0047                -3.599383e-03 3 1  ON 46
ci_0048                -3.625083e-03 3 1  ON 47
ci_0049                -2.508626e-03 3 1  ON 48
ci_0050                -2.560643e-03 3 1  ON 49
ci_0051                -1.837146e-03 3 1  ON 50
ci_0052                -1.720883e-03 3 1  ON 51
ci_0053                -3.851915e-03 3 1  ON 52
ci_0054                -3.737779e-03 3 1  ON 53
ci_0055                 2.329368e-03 3 1  ON 54
ci_0056                 2.077512e-03 3 1  ON 55
ci_0057                 2.318517e-03 3 1  ON 56
ci_0058                 2.900508e-03 3 1  ON 57
ci_0059                -3.899141e-03 3 1  ON 58
ci_0060                -3.683965e-03 3 1  ON 59
ci_0061                -3.108149e-03 3 1  ON 60
ci_0062                -3.314331e-03 3 1  ON 61
ci_0063                -9.715296e-03 3 1  ON 62
ci_0064                -9.661619e-03 3 1  ON 63
ci_0065                -6.922377e-03 3 1  ON 64
ci_0066                -6.467895e-03 3 1  ON 65
ci_0067                -3.906047e-03 3 1  ON 66
ci_0068                -3.852070e-03 3 1  ON 67
ci_0069                 3.719039e-03 3 1  ON 68
ci_0070                 3.466435e-03 3 1  ON 69
ci_0071                 4.092937e-03 3 1  ON 70
ci_0072                 4.257735e-03 3 1  ON 71
ci_0073                 3.373801e-03 3 1  ON 72
ci_0074                 3.328707e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.218268
====================================================
  Execution time = 1.4735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9239e-01
  Total weights = 1.950922618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281089672331
                                         uncertainty =       0.002162316723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281089672331
                                         uncertainty =       0.002162316723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374902401
  error estimate for blocks of size 2^( 2) =       0.000392157742
  error estimate for blocks of size 2^( 3) =       0.000409803429
  error estimate for blocks of size 2^( 4) =       0.000425512096
  error estimate for blocks of size 2^( 5) =       0.000436432906
  error estimate for blocks of size 2^( 6) =       0.000443153246
  error estimate for blocks of size 2^( 7) =       0.000447357255

      target function =      -0.924631256859
              le_mean =     -16.897868958129
             les_mean =     285.830368072290
             stat err =       0.000438113876
             autocorr =       1.365644224206
   target nu stat err =       0.000438113876
   target dn stat err =       0.002921740969
      target stat err =       0.004652077761
              std dev =       0.530192060168
             le_variance =       0.281103620665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689786895813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924653341409       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924661542976       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924663389027       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924664377898       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924664672557       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924664862364       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924664889454       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924664913700       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924664911925       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924664907858       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924664910836       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924664909455       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924664910245       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924664910617       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924664910196       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924664911329       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924664911157       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924664911190       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.572647e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924653341409       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924655403504       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924655866867       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924656114549       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924656188090       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924656235455       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924656242205       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924656248253       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924656247799       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924656246781       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924656247525       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924656247179       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924656247379       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924656247471       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924656247366       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924656247648       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924656247604       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924656247612       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.146761e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924653341409       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924653857669       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924653973627       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924654035576       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924654053953       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924654065789       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924654067475       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924654068986       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924654068872       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924654068617       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924654068804       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924654068717       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924654068767       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924654068790       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924654068764       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924654068834       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924654068823       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924654068825       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.6000e+02 is 2.869162e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7303e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.031131e-01 3 1  ON 0
ci_0002                 6.979615e-01 3 1  ON 1
ci_0003                -3.154608e-02 3 1  ON 2
ci_0004                -3.137703e-02 3 1  ON 3
ci_0005                -2.891300e-02 3 1  ON 4
ci_0006                -2.994555e-02 3 1  ON 5
ci_0007                -1.588989e-02 3 1  ON 6
ci_0008                -1.651319e-02 3 1  ON 7
ci_0009                -1.873037e-02 3 1  ON 8
ci_0010                -1.888349e-02 3 1  ON 9
ci_0011                -1.550987e-02 3 1  ON 10
ci_0012                -1.564642e-02 3 1  ON 11
ci_0013                 1.550422e-02 3 1  ON 12
ci_0014                 1.537829e-02 3 1  ON 13
ci_0015                 1.630145e-02 3 1  ON 14
ci_0016                 1.595636e-02 3 1  ON 15
ci_0017                 1.373323e-02 3 1  ON 16
ci_0018                 1.393841e-02 3 1  ON 17
ci_0019                 1.259797e-02 3 1  ON 18
ci_0020                 1.224684e-02 3 1  ON 19
ci_0021                 1.356261e-02 3 1  ON 20
ci_0022                 1.503760e-02 3 1  ON 21
ci_0023                -1.182456e-02 3 1  ON 22
ci_0024                -1.113165e-02 3 1  ON 23
ci_0025                -2.825798e-03 3 1  ON 24
ci_0026                -2.399143e-03 3 1  ON 25
ci_0027                -1.178697e-02 3 1  ON 26
ci_0028                -1.174771e-02 3 1  ON 27
ci_0029                -1.043540e-02 3 1  ON 28
ci_0030                -1.036577e-02 3 1  ON 29
ci_0031                 1.383651e-02 3 1  ON 30
ci_0032                 1.290698e-02 3 1  ON 31
ci_0033                 8.261848e-03 3 1  ON 32
ci_0034                 8.527942e-03 3 1  ON 33
ci_0035                 4.879414e-03 3 1  ON 34
ci_0036                 4.721076e-03 3 1  ON 35
ci_0037                -1.141525e-02 3 1  ON 36
ci_0038                -1.130724e-02 3 1  ON 37
ci_0039                -3.817221e-03 3 1  ON 38
ci_0040                -3.938707e-03 3 1  ON 39
ci_0041                 9.550724e-03 3 1  ON 40
ci_0042                 9.460152e-03 3 1  ON 41
ci_0043                -7.769291e-03 3 1  ON 42
ci_0044                -8.229092e-03 3 1  ON 43
ci_0045                 1.041991e-02 3 1  ON 44
ci_0046                 9.667876e-03 3 1  ON 45
ci_0047                -3.598722e-03 3 1  ON 46
ci_0048                -3.624496e-03 3 1  ON 47
ci_0049                -2.507503e-03 3 1  ON 48
ci_0050                -2.565435e-03 3 1  ON 49
ci_0051                -1.837645e-03 3 1  ON 50
ci_0052                -1.720955e-03 3 1  ON 51
ci_0053                -3.851406e-03 3 1  ON 52
ci_0054                -3.737007e-03 3 1  ON 53
ci_0055                 2.330597e-03 3 1  ON 54
ci_0056                 2.076902e-03 3 1  ON 55
ci_0057                 2.316487e-03 3 1  ON 56
ci_0058                 2.898496e-03 3 1  ON 57
ci_0059                -3.898827e-03 3 1  ON 58
ci_0060                -3.680250e-03 3 1  ON 59
ci_0061                -3.109361e-03 3 1  ON 60
ci_0062                -3.317372e-03 3 1  ON 61
ci_0063                -9.713226e-03 3 1  ON 62
ci_0064                -9.661258e-03 3 1  ON 63
ci_0065                -6.921905e-03 3 1  ON 64
ci_0066                -6.467150e-03 3 1  ON 65
ci_0067                -3.906352e-03 3 1  ON 66
ci_0068                -3.851786e-03 3 1  ON 67
ci_0069                 3.718753e-03 3 1  ON 68
ci_0070                 3.466338e-03 3 1  ON 69
ci_0071                 4.089691e-03 3 1  ON 70
ci_0072                 4.256692e-03 3 1  ON 71
ci_0073                 3.373372e-03 3 1  ON 72
ci_0074                 3.329434e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.972
    reference variance = 0.255419
====================================================
  Execution time = 1.4127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9383e-01
  Total weights = 1.9511e+06
  Execution time = 1.8842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282629189590
                                         uncertainty =       0.001638668678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282629189590
                                         uncertainty =       0.001638668678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375867715
  error estimate for blocks of size 2^( 2) =       0.000392968320
  error estimate for blocks of size 2^( 3) =       0.000410646406
  error estimate for blocks of size 2^( 4) =       0.000425727975
  error estimate for blocks of size 2^( 5) =       0.000436594303
  error estimate for blocks of size 2^( 6) =       0.000443297258
  error estimate for blocks of size 2^( 7) =       0.000449200840

      target function =      -0.922376221261
              le_mean =     -16.898390377631
             les_mean =     285.849434122047
             stat err =       0.000438705094
             autocorr =       1.362307999974
   target nu stat err =       0.000438705094
   target dn stat err =       0.002486817667
      target stat err =       0.003963747862
              std dev =       0.531557220325
             le_variance =       0.282553078480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282618919120
                                         uncertainty =       0.001638561451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282618919120
                                         uncertainty =       0.001638561451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375860890
  error estimate for blocks of size 2^( 2) =       0.000392960601
  error estimate for blocks of size 2^( 3) =       0.000410636899
  error estimate for blocks of size 2^( 4) =       0.000425717078
  error estimate for blocks of size 2^( 5) =       0.000436582546
  error estimate for blocks of size 2^( 6) =       0.000443285655
  error estimate for blocks of size 2^( 7) =       0.000449188284

      target function =      -0.922384503666
              le_mean =     -16.898390443241
             les_mean =     285.849431045930
             stat err =       0.000438693391
             autocorr =       1.362284790109
   target nu stat err =       0.000438693391
   target dn stat err =       0.002487160389
      target stat err =       0.003964341561
              std dev =       0.531547567916
             le_variance =       0.282542816957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282624012498
                                         uncertainty =       0.001638613880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282624012498
                                         uncertainty =       0.001638613880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375864275
  error estimate for blocks of size 2^( 2) =       0.000392964431
  error estimate for blocks of size 2^( 3) =       0.000410641619
  error estimate for blocks of size 2^( 4) =       0.000425722490
  error estimate for blocks of size 2^( 5) =       0.000436588388
  error estimate for blocks of size 2^( 6) =       0.000443291420
  error estimate for blocks of size 2^( 7) =       0.000449194524

      target function =      -0.922381864625
              le_mean =     -16.898390406779
             les_mean =     285.849431501065
             stat err =       0.000438699205
             autocorr =       1.362296367337
   target nu stat err =       0.000438699205
   target dn stat err =       0.002486962011
      target stat err =       0.003964015810
              std dev =       0.531552354779
             le_variance =       0.282547905871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282628539215
                                         uncertainty =       0.001638661709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282628539215
                                         uncertainty =       0.001638661709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375867283
  error estimate for blocks of size 2^( 2) =       0.000392967832
  error estimate for blocks of size 2^( 3) =       0.000410645806
  error estimate for blocks of size 2^( 4) =       0.000425727287
  error estimate for blocks of size 2^( 5) =       0.000436593561
  error estimate for blocks of size 2^( 6) =       0.000443296526
  error estimate for blocks of size 2^( 7) =       0.000449200048

      target function =      -0.922377181557
              le_mean =     -16.898390380861
             les_mean =     285.849433617671
             stat err =       0.000438704356
             autocorr =       1.362306546008
   target nu stat err =       0.000438704356
   target dn stat err =       0.002486832535
      target stat err =       0.003963778622
              std dev =       0.531556609090
             le_variance =       0.282552428667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922376221261        initial
     1.0000e+01     1.0000e+02             4.5726e-05        -0.922384503666  <--
     4.0000e+01     4.0000e+02             1.1468e-05        -0.922381864625
     1.6000e+02     1.6000e+03             2.8692e-06        -0.922377181557

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.3643e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979577e-01 3 1  ON 1
ci_0003                -3.153891e-02 3 1  ON 2
ci_0004                -3.137287e-02 3 1  ON 3
ci_0005                -2.891764e-02 3 1  ON 4
ci_0006                -2.995378e-02 3 1  ON 5
ci_0007                -1.586994e-02 3 1  ON 6
ci_0008                -1.650074e-02 3 1  ON 7
ci_0009                -1.872294e-02 3 1  ON 8
ci_0010                -1.888059e-02 3 1  ON 9
ci_0011                -1.550651e-02 3 1  ON 10
ci_0012                -1.563532e-02 3 1  ON 11
ci_0013                 1.549019e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629447e-02 3 1  ON 14
ci_0016                 1.595294e-02 3 1  ON 15
ci_0017                 1.373708e-02 3 1  ON 16
ci_0018                 1.393374e-02 3 1  ON 17
ci_0019                 1.259650e-02 3 1  ON 18
ci_0020                 1.224383e-02 3 1  ON 19
ci_0021                 1.353053e-02 3 1  ON 20
ci_0022                 1.500334e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113266e-02 3 1  ON 23
ci_0025                -2.823427e-03 3 1  ON 24
ci_0026                -2.392975e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174939e-02 3 1  ON 27
ci_0029                -1.044345e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383436e-02 3 1  ON 30
ci_0032                 1.290472e-02 3 1  ON 31
ci_0033                 8.253616e-03 3 1  ON 32
ci_0034                 8.532968e-03 3 1  ON 33
ci_0035                 4.881229e-03 3 1  ON 34
ci_0036                 4.735711e-03 3 1  ON 35
ci_0037                -1.141437e-02 3 1  ON 36
ci_0038                -1.130908e-02 3 1  ON 37
ci_0039                -3.817634e-03 3 1  ON 38
ci_0040                -3.939096e-03 3 1  ON 39
ci_0041                 9.549956e-03 3 1  ON 40
ci_0042                 9.454694e-03 3 1  ON 41
ci_0043                -7.796134e-03 3 1  ON 42
ci_0044                -8.254308e-03 3 1  ON 43
ci_0045                 1.041891e-02 3 1  ON 44
ci_0046                 9.667656e-03 3 1  ON 45
ci_0047                -3.596753e-03 3 1  ON 46
ci_0048                -3.622747e-03 3 1  ON 47
ci_0049                -2.504158e-03 3 1  ON 48
ci_0050                -2.579699e-03 3 1  ON 49
ci_0051                -1.839126e-03 3 1  ON 50
ci_0052                -1.721168e-03 3 1  ON 51
ci_0053                -3.849893e-03 3 1  ON 52
ci_0054                -3.734709e-03 3 1  ON 53
ci_0055                 2.334255e-03 3 1  ON 54
ci_0056                 2.075089e-03 3 1  ON 55
ci_0057                 2.310441e-03 3 1  ON 56
ci_0058                 2.892503e-03 3 1  ON 57
ci_0059                -3.897891e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.112976e-03 3 1  ON 60
ci_0062                -3.326434e-03 3 1  ON 61
ci_0063                -9.707055e-03 3 1  ON 62
ci_0064                -9.660178e-03 3 1  ON 63
ci_0065                -6.920499e-03 3 1  ON 64
ci_0066                -6.464930e-03 3 1  ON 65
ci_0067                -3.907262e-03 3 1  ON 66
ci_0068                -3.850938e-03 3 1  ON 67
ci_0069                 3.717903e-03 3 1  ON 68
ci_0070                 3.466049e-03 3 1  ON 69
ci_0071                 4.080031e-03 3 1  ON 70
ci_0072                 4.253588e-03 3 1  ON 71
ci_0073                 3.372094e-03 3 1  ON 72
ci_0074                 3.331598e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.305075
====================================================
  Execution time = 1.4808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0069e-01
  Total weights = 1.951035030e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282729949258
                                         uncertainty =       0.001986776252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282729949258
                                         uncertainty =       0.001986776252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375972700
  error estimate for blocks of size 2^( 2) =       0.000393264546
  error estimate for blocks of size 2^( 3) =       0.000410872989
  error estimate for blocks of size 2^( 4) =       0.000426363239
  error estimate for blocks of size 2^( 5) =       0.000437878754
  error estimate for blocks of size 2^( 6) =       0.000445042664
  error estimate for blocks of size 2^( 7) =       0.000449772497

      target function =      -0.911586037866
              le_mean =     -16.898560197205
             les_mean =     285.862022885288
             stat err =       0.000439764289
             autocorr =       1.368129778156
   target nu stat err =       0.000439764289
   target dn stat err =       0.008922808271
      target stat err =       0.013671004898
              std dev =       0.531705691659
             le_variance =       0.282710942543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689856019721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911789507610       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911994886336       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912011466089       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912017276467       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912023469142       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912025363735       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912025798474       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912025827349       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912025948961       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912026128123       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912026245175       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912026209609       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912026181575       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912026193022       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912026167199       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912026148926       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912026149589       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912026150044       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912026151351       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 2.807220e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911789507610       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911842101840       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911846333860       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911847808715       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911849366457       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911849838981       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911849946683       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911849953222       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911849983742       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911850027996       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911850056567       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911850047023       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911850039787       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911850042441       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911850036210       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911850031819       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911850032026       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911850032148       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911850032448       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 7.192336e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911789507610       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911802736636       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911803800222       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911804170349       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911804560371       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911804678422       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911804705283       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911804706875       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911804714512       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911804725540       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911804732638       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911804730212       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911804728389       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911804729040       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911804727497       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911804726410       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911804726465       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911804726496       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911804726569       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.809312e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.493790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7374e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.031613e-01 3 1  ON 0
ci_0002                 6.979209e-01 3 1  ON 1
ci_0003                -3.153203e-02 3 1  ON 2
ci_0004                -3.135765e-02 3 1  ON 3
ci_0005                -2.892578e-02 3 1  ON 4
ci_0006                -2.994194e-02 3 1  ON 5
ci_0007                -1.584755e-02 3 1  ON 6
ci_0008                -1.648141e-02 3 1  ON 7
ci_0009                -1.871785e-02 3 1  ON 8
ci_0010                -1.887935e-02 3 1  ON 9
ci_0011                -1.550483e-02 3 1  ON 10
ci_0012                -1.561994e-02 3 1  ON 11
ci_0013                 1.548619e-02 3 1  ON 12
ci_0014                 1.537876e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.594415e-02 3 1  ON 15
ci_0017                 1.373324e-02 3 1  ON 16
ci_0018                 1.392885e-02 3 1  ON 17
ci_0019                 1.259701e-02 3 1  ON 18
ci_0020                 1.224629e-02 3 1  ON 19
ci_0021                 1.350145e-02 3 1  ON 20
ci_0022                 1.494516e-02 3 1  ON 21
ci_0023                -1.183050e-02 3 1  ON 22
ci_0024                -1.112721e-02 3 1  ON 23
ci_0025                -2.832204e-03 3 1  ON 24
ci_0026                -2.417277e-03 3 1  ON 25
ci_0027                -1.179071e-02 3 1  ON 26
ci_0028                -1.174788e-02 3 1  ON 27
ci_0029                -1.044575e-02 3 1  ON 28
ci_0030                -1.036789e-02 3 1  ON 29
ci_0031                 1.383615e-02 3 1  ON 30
ci_0032                 1.289886e-02 3 1  ON 31
ci_0033                 8.258071e-03 3 1  ON 32
ci_0034                 8.525922e-03 3 1  ON 33
ci_0035                 4.849871e-03 3 1  ON 34
ci_0036                 4.736933e-03 3 1  ON 35
ci_0037                -1.141036e-02 3 1  ON 36
ci_0038                -1.130965e-02 3 1  ON 37
ci_0039                -3.816333e-03 3 1  ON 38
ci_0040                -3.934380e-03 3 1  ON 39
ci_0041                 9.551714e-03 3 1  ON 40
ci_0042                 9.443489e-03 3 1  ON 41
ci_0043                -7.839995e-03 3 1  ON 42
ci_0044                -8.287495e-03 3 1  ON 43
ci_0045                 1.042094e-02 3 1  ON 44
ci_0046                 9.667456e-03 3 1  ON 45
ci_0047                -3.594949e-03 3 1  ON 46
ci_0048                -3.623787e-03 3 1  ON 47
ci_0049                -2.481494e-03 3 1  ON 48
ci_0050                -2.583465e-03 3 1  ON 49
ci_0051                -1.839532e-03 3 1  ON 50
ci_0052                -1.716038e-03 3 1  ON 51
ci_0053                -3.850793e-03 3 1  ON 52
ci_0054                -3.729794e-03 3 1  ON 53
ci_0055                 2.338636e-03 3 1  ON 54
ci_0056                 2.048257e-03 3 1  ON 55
ci_0057                 2.317094e-03 3 1  ON 56
ci_0058                 2.900315e-03 3 1  ON 57
ci_0059                -3.896816e-03 3 1  ON 58
ci_0060                -3.597266e-03 3 1  ON 59
ci_0061                -3.119496e-03 3 1  ON 60
ci_0062                -3.329301e-03 3 1  ON 61
ci_0063                -9.701153e-03 3 1  ON 62
ci_0064                -9.658648e-03 3 1  ON 63
ci_0065                -6.916380e-03 3 1  ON 64
ci_0066                -6.465218e-03 3 1  ON 65
ci_0067                -3.902599e-03 3 1  ON 66
ci_0068                -3.850369e-03 3 1  ON 67
ci_0069                 3.713520e-03 3 1  ON 68
ci_0070                 3.466411e-03 3 1  ON 69
ci_0071                 4.067638e-03 3 1  ON 70
ci_0072                 4.250904e-03 3 1  ON 71
ci_0073                 3.375712e-03 3 1  ON 72
ci_0074                 3.337993e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9231
    reference variance = 0.198337
====================================================
  Execution time = 1.4291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9277e-01
  Total weights = 1.9509e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281817217398
                                         uncertainty =       0.001560162098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281817217398
                                         uncertainty =       0.001560162098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375394942
  error estimate for blocks of size 2^( 2) =       0.000392916805
  error estimate for blocks of size 2^( 3) =       0.000411121399
  error estimate for blocks of size 2^( 4) =       0.000426206132
  error estimate for blocks of size 2^( 5) =       0.000438687685
  error estimate for blocks of size 2^( 6) =       0.000445260793
  error estimate for blocks of size 2^( 7) =       0.000450071088

      target function =      -0.923990887849
              le_mean =     -16.897459978406
             les_mean =     285.816956428345
             stat err =       0.000440056425
             autocorr =       1.374168211372
   target nu stat err =       0.000440056425
   target dn stat err =       0.002400701790
      target stat err =       0.003838457484
              std dev =       0.530888618570
             le_variance =       0.281842725327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797298140
                                         uncertainty =       0.001560828606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797298140
                                         uncertainty =       0.001560828606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375381836
  error estimate for blocks of size 2^( 2) =       0.000392903869
  error estimate for blocks of size 2^( 3) =       0.000411109494
  error estimate for blocks of size 2^( 4) =       0.000426189014
  error estimate for blocks of size 2^( 5) =       0.000438668195
  error estimate for blocks of size 2^( 6) =       0.000445246992
  error estimate for blocks of size 2^( 7) =       0.000450054339

      target function =      -0.923951528401
              le_mean =     -16.897460764101
             les_mean =     285.817008323121
             stat err =       0.000440039635
             autocorr =       1.374159305556
   target nu stat err =       0.000440039635
   target dn stat err =       0.002371584607
      target stat err =       0.003793356947
              std dev =       0.530870083193
             le_variance =       0.281823045229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806183756
                                         uncertainty =       0.001560483108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806183756
                                         uncertainty =       0.001560483108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375387675
  error estimate for blocks of size 2^( 2) =       0.000392909609
  error estimate for blocks of size 2^( 3) =       0.000411114829
  error estimate for blocks of size 2^( 4) =       0.000426197004
  error estimate for blocks of size 2^( 5) =       0.000438677754
  error estimate for blocks of size 2^( 6) =       0.000445253963
  error estimate for blocks of size 2^( 7) =       0.000450062748

      target function =      -0.923881710384
              le_mean =     -16.897460175017
             les_mean =     285.817032788356
             stat err =       0.000440047867
             autocorr =       1.374167974404
   target nu stat err =       0.000440047867
   target dn stat err =       0.002389649523
      target stat err =       0.003820568919
              std dev =       0.530878340571
             le_variance =       0.281831812487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815718900
                                         uncertainty =       0.001560199771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815718900
                                         uncertainty =       0.001560199771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375393954
  error estimate for blocks of size 2^( 2) =       0.000392915827
  error estimate for blocks of size 2^( 3) =       0.000411120491
  error estimate for blocks of size 2^( 4) =       0.000426204891
  error estimate for blocks of size 2^( 5) =       0.000438686351
  error estimate for blocks of size 2^( 6) =       0.000445259841
  error estimate for blocks of size 2^( 7) =       0.000450069934

      target function =      -0.923610546806
              le_mean =     -16.897459996294
             les_mean =     285.817199531161
             stat err =       0.000440055254
             autocorr =       1.374168133671
   target nu stat err =       0.000440055254
   target dn stat err =       0.002417091143
      target stat err =       0.003860553024
              std dev =       0.530887221572
             le_variance =       0.281841242029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923990887849        initial  <--
     2.5000e+00     2.5000e+01             2.8072e-04        -0.923951528401
     1.0000e+01     1.0000e+02             7.1923e-05        -0.923881710384
     4.0000e+01     4.0000e+02             1.8093e-05        -0.923610546806

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7766
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979577e-01 3 1  ON 1
ci_0003                -3.153891e-02 3 1  ON 2
ci_0004                -3.137287e-02 3 1  ON 3
ci_0005                -2.891764e-02 3 1  ON 4
ci_0006                -2.995378e-02 3 1  ON 5
ci_0007                -1.586994e-02 3 1  ON 6
ci_0008                -1.650074e-02 3 1  ON 7
ci_0009                -1.872294e-02 3 1  ON 8
ci_0010                -1.888059e-02 3 1  ON 9
ci_0011                -1.550651e-02 3 1  ON 10
ci_0012                -1.563532e-02 3 1  ON 11
ci_0013                 1.549019e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629447e-02 3 1  ON 14
ci_0016                 1.595294e-02 3 1  ON 15
ci_0017                 1.373708e-02 3 1  ON 16
ci_0018                 1.393374e-02 3 1  ON 17
ci_0019                 1.259650e-02 3 1  ON 18
ci_0020                 1.224383e-02 3 1  ON 19
ci_0021                 1.353053e-02 3 1  ON 20
ci_0022                 1.500334e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113266e-02 3 1  ON 23
ci_0025                -2.823427e-03 3 1  ON 24
ci_0026                -2.392975e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174939e-02 3 1  ON 27
ci_0029                -1.044345e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383436e-02 3 1  ON 30
ci_0032                 1.290472e-02 3 1  ON 31
ci_0033                 8.253616e-03 3 1  ON 32
ci_0034                 8.532968e-03 3 1  ON 33
ci_0035                 4.881229e-03 3 1  ON 34
ci_0036                 4.735711e-03 3 1  ON 35
ci_0037                -1.141437e-02 3 1  ON 36
ci_0038                -1.130908e-02 3 1  ON 37
ci_0039                -3.817634e-03 3 1  ON 38
ci_0040                -3.939096e-03 3 1  ON 39
ci_0041                 9.549956e-03 3 1  ON 40
ci_0042                 9.454694e-03 3 1  ON 41
ci_0043                -7.796134e-03 3 1  ON 42
ci_0044                -8.254308e-03 3 1  ON 43
ci_0045                 1.041891e-02 3 1  ON 44
ci_0046                 9.667656e-03 3 1  ON 45
ci_0047                -3.596753e-03 3 1  ON 46
ci_0048                -3.622747e-03 3 1  ON 47
ci_0049                -2.504158e-03 3 1  ON 48
ci_0050                -2.579699e-03 3 1  ON 49
ci_0051                -1.839126e-03 3 1  ON 50
ci_0052                -1.721168e-03 3 1  ON 51
ci_0053                -3.849893e-03 3 1  ON 52
ci_0054                -3.734709e-03 3 1  ON 53
ci_0055                 2.334255e-03 3 1  ON 54
ci_0056                 2.075089e-03 3 1  ON 55
ci_0057                 2.310441e-03 3 1  ON 56
ci_0058                 2.892503e-03 3 1  ON 57
ci_0059                -3.897891e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.112976e-03 3 1  ON 60
ci_0062                -3.326434e-03 3 1  ON 61
ci_0063                -9.707055e-03 3 1  ON 62
ci_0064                -9.660178e-03 3 1  ON 63
ci_0065                -6.920499e-03 3 1  ON 64
ci_0066                -6.464930e-03 3 1  ON 65
ci_0067                -3.907262e-03 3 1  ON 66
ci_0068                -3.850938e-03 3 1  ON 67
ci_0069                 3.717903e-03 3 1  ON 68
ci_0070                 3.466049e-03 3 1  ON 69
ci_0071                 4.080031e-03 3 1  ON 70
ci_0072                 4.253588e-03 3 1  ON 71
ci_0073                 3.372094e-03 3 1  ON 72
ci_0074                 3.331598e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9597
    reference variance = 0.272823
====================================================
  Execution time = 1.5118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9491e-01
  Total weights = 1.951249352e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.0908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285103435991
                                         uncertainty =       0.001784528473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285103435991
                                         uncertainty =       0.001784528473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377653028
  error estimate for blocks of size 2^( 2) =       0.000394636970
  error estimate for blocks of size 2^( 3) =       0.000412355456
  error estimate for blocks of size 2^( 4) =       0.000427651173
  error estimate for blocks of size 2^( 5) =       0.000439850307
  error estimate for blocks of size 2^( 6) =       0.000444871492
  error estimate for blocks of size 2^( 7) =       0.000448696801

      target function =      -0.920695296696
              le_mean =     -16.898044484583
             les_mean =     285.838820173800
             stat err =       0.000440267443
             autocorr =       1.359086822038
   target nu stat err =       0.000440267443
   target dn stat err =       0.002419581963
      target stat err =       0.003844677656
              std dev =       0.534082033856
             le_variance =       0.285243618887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689804448458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920709884022       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920712214040       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920712753655       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920713090285       residual = 6.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920713197309       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920713242006       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920713252265       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920713267217       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920713286191       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920713291354       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920713295212       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920713297514       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920713301080       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920713301385       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920713300790       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920713301703       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920713301779       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920713301878       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 1.536770e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920709884022       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920710467872       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920710602989       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920710687218       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920710713967       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920710725135       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920710727695       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920710731436       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920710736179       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920710737467       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920710738427       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920710738997       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920710739884       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920710739959       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920710739811       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920710740038       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920710740057       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920710740082       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 3.846913e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920709884022       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920710030069       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920710063862       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920710084924       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920710091611       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920710094402       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920710095043       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920710095977       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920710097163       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920710097486       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920710097724       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920710097867       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920710098088       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920710098106       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920710098070       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920710098126       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920710098131       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920710098136       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+02 is 9.620405e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.504086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8650e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.031170e-01 3 1  ON 0
ci_0002                 6.979607e-01 3 1  ON 1
ci_0003                -3.153811e-02 3 1  ON 2
ci_0004                -3.137277e-02 3 1  ON 3
ci_0005                -2.891836e-02 3 1  ON 4
ci_0006                -2.995483e-02 3 1  ON 5
ci_0007                -1.586924e-02 3 1  ON 6
ci_0008                -1.649843e-02 3 1  ON 7
ci_0009                -1.872289e-02 3 1  ON 8
ci_0010                -1.888047e-02 3 1  ON 9
ci_0011                -1.550635e-02 3 1  ON 10
ci_0012                -1.563509e-02 3 1  ON 11
ci_0013                 1.548939e-02 3 1  ON 12
ci_0014                 1.537564e-02 3 1  ON 13
ci_0015                 1.629374e-02 3 1  ON 14
ci_0016                 1.595258e-02 3 1  ON 15
ci_0017                 1.373645e-02 3 1  ON 16
ci_0018                 1.393308e-02 3 1  ON 17
ci_0019                 1.259675e-02 3 1  ON 18
ci_0020                 1.224443e-02 3 1  ON 19
ci_0021                 1.352668e-02 3 1  ON 20
ci_0022                 1.500042e-02 3 1  ON 21
ci_0023                -1.182651e-02 3 1  ON 22
ci_0024                -1.113295e-02 3 1  ON 23
ci_0025                -2.822572e-03 3 1  ON 24
ci_0026                -2.391450e-03 3 1  ON 25
ci_0027                -1.179128e-02 3 1  ON 26
ci_0028                -1.174958e-02 3 1  ON 27
ci_0029                -1.044391e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383453e-02 3 1  ON 30
ci_0032                 1.290472e-02 3 1  ON 31
ci_0033                 8.252521e-03 3 1  ON 32
ci_0034                 8.532252e-03 3 1  ON 33
ci_0035                 4.880724e-03 3 1  ON 34
ci_0036                 4.736583e-03 3 1  ON 35
ci_0037                -1.141431e-02 3 1  ON 36
ci_0038                -1.130864e-02 3 1  ON 37
ci_0039                -3.817782e-03 3 1  ON 38
ci_0040                -3.939055e-03 3 1  ON 39
ci_0041                 9.548810e-03 3 1  ON 40
ci_0042                 9.454534e-03 3 1  ON 41
ci_0043                -7.799598e-03 3 1  ON 42
ci_0044                -8.257831e-03 3 1  ON 43
ci_0045                 1.041879e-02 3 1  ON 44
ci_0046                 9.668583e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622349e-03 3 1  ON 47
ci_0049                -2.503161e-03 3 1  ON 48
ci_0050                -2.579553e-03 3 1  ON 49
ci_0051                -1.838965e-03 3 1  ON 50
ci_0052                -1.721055e-03 3 1  ON 51
ci_0053                -3.849041e-03 3 1  ON 52
ci_0054                -3.733879e-03 3 1  ON 53
ci_0055                 2.334489e-03 3 1  ON 54
ci_0056                 2.075938e-03 3 1  ON 55
ci_0057                 2.311078e-03 3 1  ON 56
ci_0058                 2.890955e-03 3 1  ON 57
ci_0059                -3.897754e-03 3 1  ON 58
ci_0060                -3.669750e-03 3 1  ON 59
ci_0061                -3.113765e-03 3 1  ON 60
ci_0062                -3.326626e-03 3 1  ON 61
ci_0063                -9.706689e-03 3 1  ON 62
ci_0064                -9.660163e-03 3 1  ON 63
ci_0065                -6.920409e-03 3 1  ON 64
ci_0066                -6.464608e-03 3 1  ON 65
ci_0067                -3.906616e-03 3 1  ON 66
ci_0068                -3.850606e-03 3 1  ON 67
ci_0069                 3.717667e-03 3 1  ON 68
ci_0070                 3.466028e-03 3 1  ON 69
ci_0071                 4.080078e-03 3 1  ON 70
ci_0072                 4.252501e-03 3 1  ON 71
ci_0073                 3.371986e-03 3 1  ON 72
ci_0074                 3.330948e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9422
    reference variance = 0.321143
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9026e-01
  Total weights = 1.9511e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280846537269
                                         uncertainty =       0.001495327523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280846537269
                                         uncertainty =       0.001495327523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374706438
  error estimate for blocks of size 2^( 2) =       0.000392241759
  error estimate for blocks of size 2^( 3) =       0.000410280452
  error estimate for blocks of size 2^( 4) =       0.000425315443
  error estimate for blocks of size 2^( 5) =       0.000437250635
  error estimate for blocks of size 2^( 6) =       0.000445888103
  error estimate for blocks of size 2^( 7) =       0.000450413896

      target function =      -0.928029316107
              le_mean =     -16.898400504467
             les_mean =     285.846187123509
             stat err =       0.000439717019
             autocorr =       1.377096072240
   target nu stat err =       0.000439717019
   target dn stat err =       0.002529094103
      target stat err =       0.004077858683
              std dev =       0.529914927023
             le_variance =       0.280809829881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280841967057
                                         uncertainty =       0.001495118209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280841967057
                                         uncertainty =       0.001495118209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374703391
  error estimate for blocks of size 2^( 2) =       0.000392238419
  error estimate for blocks of size 2^( 3) =       0.000410276631
  error estimate for blocks of size 2^( 4) =       0.000425311055
  error estimate for blocks of size 2^( 5) =       0.000437245633
  error estimate for blocks of size 2^( 6) =       0.000445882739
  error estimate for blocks of size 2^( 7) =       0.000450407737

      target function =      -0.927915107952
              le_mean =     -16.898400494487
             les_mean =     285.846258783837
             stat err =       0.000439711791
             autocorr =       1.377085724610
   target nu stat err =       0.000439711791
   target dn stat err =       0.002538109655
      target stat err =       0.004090911794
              std dev =       0.529910617385
             le_variance =       0.280805262418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280844245600
                                         uncertainty =       0.001495222600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280844245600
                                         uncertainty =       0.001495222600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374704910
  error estimate for blocks of size 2^( 2) =       0.000392240084
  error estimate for blocks of size 2^( 3) =       0.000410278536
  error estimate for blocks of size 2^( 4) =       0.000425313243
  error estimate for blocks of size 2^( 5) =       0.000437248129
  error estimate for blocks of size 2^( 6) =       0.000445885416
  error estimate for blocks of size 2^( 7) =       0.000450410811

      target function =      -0.927978350769
              le_mean =     -16.898400499480
             les_mean =     285.846219084385
             stat err =       0.000439714400
             autocorr =       1.377090895858
   target nu stat err =       0.000439714400
   target dn stat err =       0.002532806188
      target stat err =       0.004083199583
              std dev =       0.529912766021
             le_variance =       0.280807539592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280846250372
                                         uncertainty =       0.001495314391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280846250372
                                         uncertainty =       0.001495314391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374706247
  error estimate for blocks of size 2^( 2) =       0.000392241549
  error estimate for blocks of size 2^( 3) =       0.000410280212
  error estimate for blocks of size 2^( 4) =       0.000425315167
  error estimate for blocks of size 2^( 5) =       0.000437250322
  error estimate for blocks of size 2^( 6) =       0.000445887766
  error estimate for blocks of size 2^( 7) =       0.000450413510

      target function =      -0.928023532753
              le_mean =     -16.898400503841
             les_mean =     285.846190748351
             stat err =       0.000439716691
             autocorr =       1.377095425380
   target nu stat err =       0.000439716691
   target dn stat err =       0.002529488677
      target stat err =       0.004078423258
              std dev =       0.529914656484
             le_variance =       0.280809543157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928029316107        initial  <--
     2.5000e+01     2.5000e+02             1.5368e-05        -0.927915107952
     1.0000e+02     1.0000e+03             3.8469e-06        -0.927978350769
     4.0000e+02     4.0000e+03             9.6204e-07        -0.928023532753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8628
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979577e-01 3 1  ON 1
ci_0003                -3.153891e-02 3 1  ON 2
ci_0004                -3.137287e-02 3 1  ON 3
ci_0005                -2.891764e-02 3 1  ON 4
ci_0006                -2.995378e-02 3 1  ON 5
ci_0007                -1.586994e-02 3 1  ON 6
ci_0008                -1.650074e-02 3 1  ON 7
ci_0009                -1.872294e-02 3 1  ON 8
ci_0010                -1.888059e-02 3 1  ON 9
ci_0011                -1.550651e-02 3 1  ON 10
ci_0012                -1.563532e-02 3 1  ON 11
ci_0013                 1.549019e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629447e-02 3 1  ON 14
ci_0016                 1.595294e-02 3 1  ON 15
ci_0017                 1.373708e-02 3 1  ON 16
ci_0018                 1.393374e-02 3 1  ON 17
ci_0019                 1.259650e-02 3 1  ON 18
ci_0020                 1.224383e-02 3 1  ON 19
ci_0021                 1.353053e-02 3 1  ON 20
ci_0022                 1.500334e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113266e-02 3 1  ON 23
ci_0025                -2.823427e-03 3 1  ON 24
ci_0026                -2.392975e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174939e-02 3 1  ON 27
ci_0029                -1.044345e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383436e-02 3 1  ON 30
ci_0032                 1.290472e-02 3 1  ON 31
ci_0033                 8.253616e-03 3 1  ON 32
ci_0034                 8.532968e-03 3 1  ON 33
ci_0035                 4.881229e-03 3 1  ON 34
ci_0036                 4.735711e-03 3 1  ON 35
ci_0037                -1.141437e-02 3 1  ON 36
ci_0038                -1.130908e-02 3 1  ON 37
ci_0039                -3.817634e-03 3 1  ON 38
ci_0040                -3.939096e-03 3 1  ON 39
ci_0041                 9.549956e-03 3 1  ON 40
ci_0042                 9.454694e-03 3 1  ON 41
ci_0043                -7.796134e-03 3 1  ON 42
ci_0044                -8.254308e-03 3 1  ON 43
ci_0045                 1.041891e-02 3 1  ON 44
ci_0046                 9.667656e-03 3 1  ON 45
ci_0047                -3.596753e-03 3 1  ON 46
ci_0048                -3.622747e-03 3 1  ON 47
ci_0049                -2.504158e-03 3 1  ON 48
ci_0050                -2.579699e-03 3 1  ON 49
ci_0051                -1.839126e-03 3 1  ON 50
ci_0052                -1.721168e-03 3 1  ON 51
ci_0053                -3.849893e-03 3 1  ON 52
ci_0054                -3.734709e-03 3 1  ON 53
ci_0055                 2.334255e-03 3 1  ON 54
ci_0056                 2.075089e-03 3 1  ON 55
ci_0057                 2.310441e-03 3 1  ON 56
ci_0058                 2.892503e-03 3 1  ON 57
ci_0059                -3.897891e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.112976e-03 3 1  ON 60
ci_0062                -3.326434e-03 3 1  ON 61
ci_0063                -9.707055e-03 3 1  ON 62
ci_0064                -9.660178e-03 3 1  ON 63
ci_0065                -6.920499e-03 3 1  ON 64
ci_0066                -6.464930e-03 3 1  ON 65
ci_0067                -3.907262e-03 3 1  ON 66
ci_0068                -3.850938e-03 3 1  ON 67
ci_0069                 3.717903e-03 3 1  ON 68
ci_0070                 3.466049e-03 3 1  ON 69
ci_0071                 4.080031e-03 3 1  ON 70
ci_0072                 4.253588e-03 3 1  ON 71
ci_0073                 3.372094e-03 3 1  ON 72
ci_0074                 3.331598e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8221
    reference variance = 0.410538
====================================================
  Execution time = 1.4592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9464e-01
  Total weights = 1.951080562e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282860555848
                                         uncertainty =       0.001685284092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282860555848
                                         uncertainty =       0.001685284092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376100461
  error estimate for blocks of size 2^( 2) =       0.000393641220
  error estimate for blocks of size 2^( 3) =       0.000411435156
  error estimate for blocks of size 2^( 4) =       0.000426956705
  error estimate for blocks of size 2^( 5) =       0.000438597285
  error estimate for blocks of size 2^( 6) =       0.000445732918
  error estimate for blocks of size 2^( 7) =       0.000449475261

      target function =      -0.921119321336
              le_mean =     -16.897897764618
             les_mean =     285.833586914700
             stat err =       0.000440190542
             autocorr =       1.369852111750
   target nu stat err =       0.000440190542
   target dn stat err =       0.002715009106
      target stat err =       0.004300123424
              std dev =       0.531886372607
             le_variance =       0.282903113365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689789776462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921137842501       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921138055613       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921138116446       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921138156101       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921138172531       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921138177514       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921138178144       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921138178386       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921138178494       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921138178547       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921138178502       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921138178593       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921138178729       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921138178671       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921138178670       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921138178655       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921138178663       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921138178664       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+02 is 1.836698e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921137842501       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921137895791       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921137911002       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921137920917       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921137925025       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921137926269       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921137926426       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921137926489       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921137926515       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921137926530       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921137926517       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921137926541       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921137926573       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921137926560       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921137926559       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921137926554       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921137926559       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921137926556       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+03 is 4.592312e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921137842501       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921137855824       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921137859627       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921137862106       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921137863132       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921137863442       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921137863490       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921137863498       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921137863498       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921137863500       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921137863509       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921137863508       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921137863521       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921137863516       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921137863518       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921137863508       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921137863513       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921137863513       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+03 is 1.148114e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.514307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7157e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979578e-01 3 1  ON 1
ci_0003                -3.153885e-02 3 1  ON 2
ci_0004                -3.137278e-02 3 1  ON 3
ci_0005                -2.891762e-02 3 1  ON 4
ci_0006                -2.995373e-02 3 1  ON 5
ci_0007                -1.586975e-02 3 1  ON 6
ci_0008                -1.650069e-02 3 1  ON 7
ci_0009                -1.872296e-02 3 1  ON 8
ci_0010                -1.888059e-02 3 1  ON 9
ci_0011                -1.550645e-02 3 1  ON 10
ci_0012                -1.563531e-02 3 1  ON 11
ci_0013                 1.549016e-02 3 1  ON 12
ci_0014                 1.537514e-02 3 1  ON 13
ci_0015                 1.629441e-02 3 1  ON 14
ci_0016                 1.595287e-02 3 1  ON 15
ci_0017                 1.373706e-02 3 1  ON 16
ci_0018                 1.393363e-02 3 1  ON 17
ci_0019                 1.259654e-02 3 1  ON 18
ci_0020                 1.224390e-02 3 1  ON 19
ci_0021                 1.353007e-02 3 1  ON 20
ci_0022                 1.500301e-02 3 1  ON 21
ci_0023                -1.182665e-02 3 1  ON 22
ci_0024                -1.113270e-02 3 1  ON 23
ci_0025                -2.823326e-03 3 1  ON 24
ci_0026                -2.393001e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174944e-02 3 1  ON 27
ci_0029                -1.044346e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383435e-02 3 1  ON 30
ci_0032                 1.290476e-02 3 1  ON 31
ci_0033                 8.253473e-03 3 1  ON 32
ci_0034                 8.532828e-03 3 1  ON 33
ci_0035                 4.881215e-03 3 1  ON 34
ci_0036                 4.735536e-03 3 1  ON 35
ci_0037                -1.141447e-02 3 1  ON 36
ci_0038                -1.130906e-02 3 1  ON 37
ci_0039                -3.817673e-03 3 1  ON 38
ci_0040                -3.939088e-03 3 1  ON 39
ci_0041                 9.549884e-03 3 1  ON 40
ci_0042                 9.454697e-03 3 1  ON 41
ci_0043                -7.796401e-03 3 1  ON 42
ci_0044                -8.254603e-03 3 1  ON 43
ci_0045                 1.041892e-02 3 1  ON 44
ci_0046                 9.667692e-03 3 1  ON 45
ci_0047                -3.596757e-03 3 1  ON 46
ci_0048                -3.622696e-03 3 1  ON 47
ci_0049                -2.504196e-03 3 1  ON 48
ci_0050                -2.579678e-03 3 1  ON 49
ci_0051                -1.839154e-03 3 1  ON 50
ci_0052                -1.721204e-03 3 1  ON 51
ci_0053                -3.849851e-03 3 1  ON 52
ci_0054                -3.734713e-03 3 1  ON 53
ci_0055                 2.334205e-03 3 1  ON 54
ci_0056                 2.075129e-03 3 1  ON 55
ci_0057                 2.310530e-03 3 1  ON 56
ci_0058                 2.892466e-03 3 1  ON 57
ci_0059                -3.897849e-03 3 1  ON 58
ci_0060                -3.669131e-03 3 1  ON 59
ci_0061                -3.113054e-03 3 1  ON 60
ci_0062                -3.326436e-03 3 1  ON 61
ci_0063                -9.707024e-03 3 1  ON 62
ci_0064                -9.660188e-03 3 1  ON 63
ci_0065                -6.920426e-03 3 1  ON 64
ci_0066                -6.464907e-03 3 1  ON 65
ci_0067                -3.907233e-03 3 1  ON 66
ci_0068                -3.850852e-03 3 1  ON 67
ci_0069                 3.717863e-03 3 1  ON 68
ci_0070                 3.466037e-03 3 1  ON 69
ci_0071                 4.079911e-03 3 1  ON 70
ci_0072                 4.253509e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331608e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.296569
====================================================
  Execution time = 1.4400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9240e-01
  Total weights = 1.9508e+06
  Execution time = 1.8904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825944768
                                         uncertainty =       0.001825581394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825944768
                                         uncertainty =       0.001825581394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376029145
  error estimate for blocks of size 2^( 2) =       0.000393456861
  error estimate for blocks of size 2^( 3) =       0.000411303936
  error estimate for blocks of size 2^( 4) =       0.000428107938
  error estimate for blocks of size 2^( 5) =       0.000441161304
  error estimate for blocks of size 2^( 6) =       0.000450121889
  error estimate for blocks of size 2^( 7) =       0.000457858450

      target function =      -0.924626209224
              le_mean =     -16.897997369977
             les_mean =     285.834717913855
             stat err =       0.000444312395
             autocorr =       1.396155665022
   target nu stat err =       0.000444312395
   target dn stat err =       0.002283937411
      target stat err =       0.003669030862
              std dev =       0.531785517394
             le_variance =       0.282795836510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825573832
                                         uncertainty =       0.001825589108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825573832
                                         uncertainty =       0.001825589108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376028899
  error estimate for blocks of size 2^( 2) =       0.000393456588
  error estimate for blocks of size 2^( 3) =       0.000411303621
  error estimate for blocks of size 2^( 4) =       0.000428107573
  error estimate for blocks of size 2^( 5) =       0.000441160898
  error estimate for blocks of size 2^( 6) =       0.000450121469
  error estimate for blocks of size 2^( 7) =       0.000457857986

      target function =      -0.924622478414
              le_mean =     -16.897997376206
             les_mean =     285.834720494271
             stat err =       0.000444311981
             autocorr =       1.396154896808
   target nu stat err =       0.000444311981
   target dn stat err =       0.002284382742
      target stat err =       0.003669686872
              std dev =       0.531785168397
             le_variance =       0.282795465327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825759244
                                         uncertainty =       0.001825585251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825759244
                                         uncertainty =       0.001825585251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376029022
  error estimate for blocks of size 2^( 2) =       0.000393456724
  error estimate for blocks of size 2^( 3) =       0.000411303779
  error estimate for blocks of size 2^( 4) =       0.000428107756
  error estimate for blocks of size 2^( 5) =       0.000441161101
  error estimate for blocks of size 2^( 6) =       0.000450121679
  error estimate for blocks of size 2^( 7) =       0.000457858218

      target function =      -0.924624349220
              le_mean =     -16.897997373088
             les_mean =     285.834719200511
             stat err =       0.000444312188
             autocorr =       1.396155280868
   target nu stat err =       0.000444312188
   target dn stat err =       0.002284159229
      target stat err =       0.003669357606
              std dev =       0.531785342843
             le_variance =       0.282795650863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825921574
                                         uncertainty =       0.001825581876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282825921574
                                         uncertainty =       0.001825581876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376029130
  error estimate for blocks of size 2^( 2) =       0.000393456844
  error estimate for blocks of size 2^( 3) =       0.000411303917
  error estimate for blocks of size 2^( 4) =       0.000428107915
  error estimate for blocks of size 2^( 5) =       0.000441161279
  error estimate for blocks of size 2^( 6) =       0.000450121863
  error estimate for blocks of size 2^( 7) =       0.000457858421

      target function =      -0.924625977346
              le_mean =     -16.897997370365
             les_mean =     285.834718074278
             stat err =       0.000444312369
             autocorr =       1.396155617004
   target nu stat err =       0.000444312369
   target dn stat err =       0.002283965042
      target stat err =       0.003669071562
              std dev =       0.531785495572
             le_variance =       0.282795813301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924626209224        initial  <--
     2.5000e+02     2.5000e+03             1.8367e-06        -0.924622478414
     1.0000e+03     1.0000e+04             4.5923e-07        -0.924624349220
     4.0000e+03     4.0000e+04             1.1481e-07        -0.924625977346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9491
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979577e-01 3 1  ON 1
ci_0003                -3.153891e-02 3 1  ON 2
ci_0004                -3.137287e-02 3 1  ON 3
ci_0005                -2.891764e-02 3 1  ON 4
ci_0006                -2.995378e-02 3 1  ON 5
ci_0007                -1.586994e-02 3 1  ON 6
ci_0008                -1.650074e-02 3 1  ON 7
ci_0009                -1.872294e-02 3 1  ON 8
ci_0010                -1.888059e-02 3 1  ON 9
ci_0011                -1.550651e-02 3 1  ON 10
ci_0012                -1.563532e-02 3 1  ON 11
ci_0013                 1.549019e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629447e-02 3 1  ON 14
ci_0016                 1.595294e-02 3 1  ON 15
ci_0017                 1.373708e-02 3 1  ON 16
ci_0018                 1.393374e-02 3 1  ON 17
ci_0019                 1.259650e-02 3 1  ON 18
ci_0020                 1.224383e-02 3 1  ON 19
ci_0021                 1.353053e-02 3 1  ON 20
ci_0022                 1.500334e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113266e-02 3 1  ON 23
ci_0025                -2.823427e-03 3 1  ON 24
ci_0026                -2.392975e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174939e-02 3 1  ON 27
ci_0029                -1.044345e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383436e-02 3 1  ON 30
ci_0032                 1.290472e-02 3 1  ON 31
ci_0033                 8.253616e-03 3 1  ON 32
ci_0034                 8.532968e-03 3 1  ON 33
ci_0035                 4.881229e-03 3 1  ON 34
ci_0036                 4.735711e-03 3 1  ON 35
ci_0037                -1.141437e-02 3 1  ON 36
ci_0038                -1.130908e-02 3 1  ON 37
ci_0039                -3.817634e-03 3 1  ON 38
ci_0040                -3.939096e-03 3 1  ON 39
ci_0041                 9.549956e-03 3 1  ON 40
ci_0042                 9.454694e-03 3 1  ON 41
ci_0043                -7.796134e-03 3 1  ON 42
ci_0044                -8.254308e-03 3 1  ON 43
ci_0045                 1.041891e-02 3 1  ON 44
ci_0046                 9.667656e-03 3 1  ON 45
ci_0047                -3.596753e-03 3 1  ON 46
ci_0048                -3.622747e-03 3 1  ON 47
ci_0049                -2.504158e-03 3 1  ON 48
ci_0050                -2.579699e-03 3 1  ON 49
ci_0051                -1.839126e-03 3 1  ON 50
ci_0052                -1.721168e-03 3 1  ON 51
ci_0053                -3.849893e-03 3 1  ON 52
ci_0054                -3.734709e-03 3 1  ON 53
ci_0055                 2.334255e-03 3 1  ON 54
ci_0056                 2.075089e-03 3 1  ON 55
ci_0057                 2.310441e-03 3 1  ON 56
ci_0058                 2.892503e-03 3 1  ON 57
ci_0059                -3.897891e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.112976e-03 3 1  ON 60
ci_0062                -3.326434e-03 3 1  ON 61
ci_0063                -9.707055e-03 3 1  ON 62
ci_0064                -9.660178e-03 3 1  ON 63
ci_0065                -6.920499e-03 3 1  ON 64
ci_0066                -6.464930e-03 3 1  ON 65
ci_0067                -3.907262e-03 3 1  ON 66
ci_0068                -3.850938e-03 3 1  ON 67
ci_0069                 3.717903e-03 3 1  ON 68
ci_0070                 3.466049e-03 3 1  ON 69
ci_0071                 4.080031e-03 3 1  ON 70
ci_0072                 4.253588e-03 3 1  ON 71
ci_0073                 3.372094e-03 3 1  ON 72
ci_0074                 3.331598e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.130005
====================================================
  Execution time = 1.4545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9493e-01
  Total weights = 1.951061668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283709111417
                                         uncertainty =       0.001908927811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283709111417
                                         uncertainty =       0.001908927811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376623386
  error estimate for blocks of size 2^( 2) =       0.000393926862
  error estimate for blocks of size 2^( 3) =       0.000411824060
  error estimate for blocks of size 2^( 4) =       0.000426421395
  error estimate for blocks of size 2^( 5) =       0.000438746348
  error estimate for blocks of size 2^( 6) =       0.000447518367
  error estimate for blocks of size 2^( 7) =       0.000452132165

      target function =      -0.920668791676
              le_mean =     -16.898195032651
             les_mean =     285.843922471087
             stat err =       0.000441204569
             autocorr =       1.372351730328
   target nu stat err =       0.000441204569
   target dn stat err =       0.002745973541
      target stat err =       0.004346183189
              std dev =       0.532625900788
             le_variance =       0.283690350190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689819503265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920687837398       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920687860983       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920687867403       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920687871753       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920687873706       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920687874381       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920687874521       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920687874519       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920687874501       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920687874490       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920687874491       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920687874490       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920687874488       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920687874487       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920687874482       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920687874480       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 1.977336e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920687837398       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920687843295       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920687844900       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920687845987       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920687846475       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920687846644       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920687846707       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920687846679       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920687846674       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920687846671       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920687846687       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920687846672       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920687846674       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920687846671       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920687846673       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920687846669       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+04 is 4.943402e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920687837398       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920687838872       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920687839274       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920687839546       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920687839581       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920687839710       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920687839637       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920687839600       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920687839701       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920687839708       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920687839781       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920687839724       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920687839607       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920687839717       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920687839818       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920687839637       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+04 is 1.235854e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.522397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7104e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979577e-01 3 1  ON 1
ci_0003                -3.153891e-02 3 1  ON 2
ci_0004                -3.137285e-02 3 1  ON 3
ci_0005                -2.891765e-02 3 1  ON 4
ci_0006                -2.995379e-02 3 1  ON 5
ci_0007                -1.586992e-02 3 1  ON 6
ci_0008                -1.650072e-02 3 1  ON 7
ci_0009                -1.872294e-02 3 1  ON 8
ci_0010                -1.888058e-02 3 1  ON 9
ci_0011                -1.550651e-02 3 1  ON 10
ci_0012                -1.563531e-02 3 1  ON 11
ci_0013                 1.549018e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629447e-02 3 1  ON 14
ci_0016                 1.595294e-02 3 1  ON 15
ci_0017                 1.373708e-02 3 1  ON 16
ci_0018                 1.393373e-02 3 1  ON 17
ci_0019                 1.259651e-02 3 1  ON 18
ci_0020                 1.224384e-02 3 1  ON 19
ci_0021                 1.353048e-02 3 1  ON 20
ci_0022                 1.500330e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113267e-02 3 1  ON 23
ci_0025                -2.823419e-03 3 1  ON 24
ci_0026                -2.392967e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174939e-02 3 1  ON 27
ci_0029                -1.044345e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383436e-02 3 1  ON 30
ci_0032                 1.290472e-02 3 1  ON 31
ci_0033                 8.253616e-03 3 1  ON 32
ci_0034                 8.532965e-03 3 1  ON 33
ci_0035                 4.881228e-03 3 1  ON 34
ci_0036                 4.735700e-03 3 1  ON 35
ci_0037                -1.141437e-02 3 1  ON 36
ci_0038                -1.130908e-02 3 1  ON 37
ci_0039                -3.817632e-03 3 1  ON 38
ci_0040                -3.939096e-03 3 1  ON 39
ci_0041                 9.549948e-03 3 1  ON 40
ci_0042                 9.454687e-03 3 1  ON 41
ci_0043                -7.796174e-03 3 1  ON 42
ci_0044                -8.254342e-03 3 1  ON 43
ci_0045                 1.041890e-02 3 1  ON 44
ci_0046                 9.667660e-03 3 1  ON 45
ci_0047                -3.596754e-03 3 1  ON 46
ci_0048                -3.622747e-03 3 1  ON 47
ci_0049                -2.504150e-03 3 1  ON 48
ci_0050                -2.579705e-03 3 1  ON 49
ci_0051                -1.839132e-03 3 1  ON 50
ci_0052                -1.721168e-03 3 1  ON 51
ci_0053                -3.849883e-03 3 1  ON 52
ci_0054                -3.734710e-03 3 1  ON 53
ci_0055                 2.334253e-03 3 1  ON 54
ci_0056                 2.075094e-03 3 1  ON 55
ci_0057                 2.310440e-03 3 1  ON 56
ci_0058                 2.892503e-03 3 1  ON 57
ci_0059                -3.897886e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.112983e-03 3 1  ON 60
ci_0062                -3.326435e-03 3 1  ON 61
ci_0063                -9.707056e-03 3 1  ON 62
ci_0064                -9.660175e-03 3 1  ON 63
ci_0065                -6.920495e-03 3 1  ON 64
ci_0066                -6.464928e-03 3 1  ON 65
ci_0067                -3.907257e-03 3 1  ON 66
ci_0068                -3.850927e-03 3 1  ON 67
ci_0069                 3.717896e-03 3 1  ON 68
ci_0070                 3.466041e-03 3 1  ON 69
ci_0071                 4.080013e-03 3 1  ON 70
ci_0072                 4.253582e-03 3 1  ON 71
ci_0073                 3.372093e-03 3 1  ON 72
ci_0074                 3.331601e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8532
    reference variance = 0.249802
====================================================
  Execution time = 1.4301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8986e-01
  Total weights = 1.9512e+06
  Execution time = 1.8769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488678943
                                         uncertainty =       0.002126823731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488678943
                                         uncertainty =       0.002126823731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141863
  error estimate for blocks of size 2^( 2) =       0.000392344128
  error estimate for blocks of size 2^( 3) =       0.000410259744
  error estimate for blocks of size 2^( 4) =       0.000425869643
  error estimate for blocks of size 2^( 5) =       0.000436793676
  error estimate for blocks of size 2^( 6) =       0.000443476145
  error estimate for blocks of size 2^( 7) =       0.000446189751

      target function =      -0.928646774643
              le_mean =     -16.898292856312
             les_mean =     285.842158298788
             stat err =       0.000438082304
             autocorr =       1.363704766073
   target nu stat err =       0.000438082304
   target dn stat err =       0.002529236105
      target stat err =       0.004082096126
              std dev =       0.530530710764
             le_variance =       0.281462835064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488626532
                                         uncertainty =       0.002126824035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488626532
                                         uncertainty =       0.002126824035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141828
  error estimate for blocks of size 2^( 2) =       0.000392344089
  error estimate for blocks of size 2^( 3) =       0.000410259699
  error estimate for blocks of size 2^( 4) =       0.000425869592
  error estimate for blocks of size 2^( 5) =       0.000436793621
  error estimate for blocks of size 2^( 6) =       0.000443476088
  error estimate for blocks of size 2^( 7) =       0.000446189693

      target function =      -0.928646992673
              le_mean =     -16.898292857542
             les_mean =     285.842158202954
             stat err =       0.000438082248
             autocorr =       1.363704677130
   target nu stat err =       0.000438082248
   target dn stat err =       0.002529231739
      target stat err =       0.004082091194
              std dev =       0.530530661000
             le_variance =       0.281462782261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488652737
                                         uncertainty =       0.002126823883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488652737
                                         uncertainty =       0.002126823883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141846
  error estimate for blocks of size 2^( 2) =       0.000392344109
  error estimate for blocks of size 2^( 3) =       0.000410259722
  error estimate for blocks of size 2^( 4) =       0.000425869618
  error estimate for blocks of size 2^( 5) =       0.000436793648
  error estimate for blocks of size 2^( 6) =       0.000443476116
  error estimate for blocks of size 2^( 7) =       0.000446189722

      target function =      -0.928646883674
              le_mean =     -16.898292856927
             les_mean =     285.842158250859
             stat err =       0.000438082276
             autocorr =       1.363704721606
   target nu stat err =       0.000438082276
   target dn stat err =       0.002529233921
      target stat err =       0.004082093659
              std dev =       0.530530685882
             le_variance =       0.281462808662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488675667
                                         uncertainty =       0.002126823750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281488675667
                                         uncertainty =       0.002126823750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141861
  error estimate for blocks of size 2^( 2) =       0.000392344126
  error estimate for blocks of size 2^( 3) =       0.000410259742
  error estimate for blocks of size 2^( 4) =       0.000425869640
  error estimate for blocks of size 2^( 5) =       0.000436793672
  error estimate for blocks of size 2^( 6) =       0.000443476142
  error estimate for blocks of size 2^( 7) =       0.000446189747

      target function =      -0.928646788274
              le_mean =     -16.898292856389
             les_mean =     285.842158292795
             stat err =       0.000438082300
             autocorr =       1.363704760519
   target nu stat err =       0.000438082300
   target dn stat err =       0.002529235832
      target stat err =       0.004082095818
              std dev =       0.530530707654
             le_variance =       0.281462831764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928646774643        initial
     2.5000e+03     2.5000e+04             1.9773e-07        -0.928646992673  <--
     1.0000e+04     1.0000e+05             4.9434e-08        -0.928646883674
     4.0000e+04     4.0000e+05             1.2359e-08        -0.928646788274

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 2.3771e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979577e-01 3 1  ON 1
ci_0003                -3.153889e-02 3 1  ON 2
ci_0004                -3.137282e-02 3 1  ON 3
ci_0005                -2.891767e-02 3 1  ON 4
ci_0006                -2.995380e-02 3 1  ON 5
ci_0007                -1.586988e-02 3 1  ON 6
ci_0008                -1.650068e-02 3 1  ON 7
ci_0009                -1.872291e-02 3 1  ON 8
ci_0010                -1.888056e-02 3 1  ON 9
ci_0011                -1.550650e-02 3 1  ON 10
ci_0012                -1.563529e-02 3 1  ON 11
ci_0013                 1.549015e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629445e-02 3 1  ON 14
ci_0016                 1.595294e-02 3 1  ON 15
ci_0017                 1.373706e-02 3 1  ON 16
ci_0018                 1.393372e-02 3 1  ON 17
ci_0019                 1.259654e-02 3 1  ON 18
ci_0020                 1.224387e-02 3 1  ON 19
ci_0021                 1.353033e-02 3 1  ON 20
ci_0022                 1.500319e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113270e-02 3 1  ON 23
ci_0025                -2.823395e-03 3 1  ON 24
ci_0026                -2.392943e-03 3 1  ON 25
ci_0027                -1.179153e-02 3 1  ON 26
ci_0028                -1.174939e-02 3 1  ON 27
ci_0029                -1.044347e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290471e-02 3 1  ON 31
ci_0033                 8.253614e-03 3 1  ON 32
ci_0034                 8.532958e-03 3 1  ON 33
ci_0035                 4.881224e-03 3 1  ON 34
ci_0036                 4.735668e-03 3 1  ON 35
ci_0037                -1.141435e-02 3 1  ON 36
ci_0038                -1.130907e-02 3 1  ON 37
ci_0039                -3.817624e-03 3 1  ON 38
ci_0040                -3.939097e-03 3 1  ON 39
ci_0041                 9.549923e-03 3 1  ON 40
ci_0042                 9.454667e-03 3 1  ON 41
ci_0043                -7.796293e-03 3 1  ON 42
ci_0044                -8.254444e-03 3 1  ON 43
ci_0045                 1.041887e-02 3 1  ON 44
ci_0046                 9.667673e-03 3 1  ON 45
ci_0047                -3.596758e-03 3 1  ON 46
ci_0048                -3.622745e-03 3 1  ON 47
ci_0049                -2.504126e-03 3 1  ON 48
ci_0050                -2.579723e-03 3 1  ON 49
ci_0051                -1.839149e-03 3 1  ON 50
ci_0052                -1.721169e-03 3 1  ON 51
ci_0053                -3.849851e-03 3 1  ON 52
ci_0054                -3.734711e-03 3 1  ON 53
ci_0055                 2.334250e-03 3 1  ON 54
ci_0056                 2.075110e-03 3 1  ON 55
ci_0057                 2.310438e-03 3 1  ON 56
ci_0058                 2.892505e-03 3 1  ON 57
ci_0059                -3.897873e-03 3 1  ON 58
ci_0060                -3.669182e-03 3 1  ON 59
ci_0061                -3.113005e-03 3 1  ON 60
ci_0062                -3.326436e-03 3 1  ON 61
ci_0063                -9.707056e-03 3 1  ON 62
ci_0064                -9.660167e-03 3 1  ON 63
ci_0065                -6.920484e-03 3 1  ON 64
ci_0066                -6.464924e-03 3 1  ON 65
ci_0067                -3.907242e-03 3 1  ON 66
ci_0068                -3.850897e-03 3 1  ON 67
ci_0069                 3.717877e-03 3 1  ON 68
ci_0070                 3.466019e-03 3 1  ON 69
ci_0071                 4.079960e-03 3 1  ON 70
ci_0072                 4.253561e-03 3 1  ON 71
ci_0073                 3.372088e-03 3 1  ON 72
ci_0074                 3.331608e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0881e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.161288
====================================================
  Execution time = 1.4585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9235e-01
  Total weights = 1.950968768e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538566677
                                         uncertainty =       0.001287261212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538566677
                                         uncertainty =       0.001287261212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374565222
  error estimate for blocks of size 2^( 2) =       0.000392016644
  error estimate for blocks of size 2^( 3) =       0.000409971155
  error estimate for blocks of size 2^( 4) =       0.000425430211
  error estimate for blocks of size 2^( 5) =       0.000437382012
  error estimate for blocks of size 2^( 6) =       0.000444868068
  error estimate for blocks of size 2^( 7) =       0.000447778799

      target function =      -0.924713532726
              le_mean =     -16.897952540897
             les_mean =     285.833145996635
             stat err =       0.000438864773
             autocorr =       1.372797698863
   target nu stat err =       0.000438864773
   target dn stat err =       0.002378974385
      target stat err =       0.003813931147
              std dev =       0.529715216269
             le_variance =       0.280598210347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689795254090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924727791458       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924727867896       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924727899567       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924727915527       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924727919227       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924727921021       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924727921190       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924727921194       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924727921155       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924727921188       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924727921267       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924727921249       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924727921264       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924727921282       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924727921244       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924727921244       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924727921272       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924727921246       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924727921238       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 6.262072e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924727791458       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924727810569       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924727818488       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924727822478       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924727823401       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924727823854       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924727823893       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924727823891       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924727823884       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924727823895       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924727823913       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924727823907       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924727823912       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924727823914       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924727823911       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924727823906       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924727823909       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924727823909       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924727823902       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 1.565602e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924727791458       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924727796236       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924727798216       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924727799213       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924727799443       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924727799565       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924727799582       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924727799574       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924727799580       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924727799566       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924727799580       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924727799577       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924727799565       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924727799568       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924727799535       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924727799583       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924727799603       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924727799559       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924727799610       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+04 is 3.914058e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.534034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7165e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.031197e-01 3 1  ON 0
ci_0002                 6.979578e-01 3 1  ON 1
ci_0003                -3.153885e-02 3 1  ON 2
ci_0004                -3.137280e-02 3 1  ON 3
ci_0005                -2.891773e-02 3 1  ON 4
ci_0006                -2.995384e-02 3 1  ON 5
ci_0007                -1.586982e-02 3 1  ON 6
ci_0008                -1.650059e-02 3 1  ON 7
ci_0009                -1.872289e-02 3 1  ON 8
ci_0010                -1.888054e-02 3 1  ON 9
ci_0011                -1.550646e-02 3 1  ON 10
ci_0012                -1.563527e-02 3 1  ON 11
ci_0013                 1.549014e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629440e-02 3 1  ON 14
ci_0016                 1.595291e-02 3 1  ON 15
ci_0017                 1.373702e-02 3 1  ON 16
ci_0018                 1.393368e-02 3 1  ON 17
ci_0019                 1.259655e-02 3 1  ON 18
ci_0020                 1.224389e-02 3 1  ON 19
ci_0021                 1.353018e-02 3 1  ON 20
ci_0022                 1.500306e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113273e-02 3 1  ON 23
ci_0025                -2.823383e-03 3 1  ON 24
ci_0026                -2.392935e-03 3 1  ON 25
ci_0027                -1.179154e-02 3 1  ON 26
ci_0028                -1.174937e-02 3 1  ON 27
ci_0029                -1.044349e-02 3 1  ON 28
ci_0030                -1.036568e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290469e-02 3 1  ON 31
ci_0033                 8.253582e-03 3 1  ON 32
ci_0034                 8.532934e-03 3 1  ON 33
ci_0035                 4.881232e-03 3 1  ON 34
ci_0036                 4.735643e-03 3 1  ON 35
ci_0037                -1.141431e-02 3 1  ON 36
ci_0038                -1.130905e-02 3 1  ON 37
ci_0039                -3.817614e-03 3 1  ON 38
ci_0040                -3.939101e-03 3 1  ON 39
ci_0041                 9.549916e-03 3 1  ON 40
ci_0042                 9.454641e-03 3 1  ON 41
ci_0043                -7.796449e-03 3 1  ON 42
ci_0044                -8.254599e-03 3 1  ON 43
ci_0045                 1.041891e-02 3 1  ON 44
ci_0046                 9.667664e-03 3 1  ON 45
ci_0047                -3.596746e-03 3 1  ON 46
ci_0048                -3.622738e-03 3 1  ON 47
ci_0049                -2.504093e-03 3 1  ON 48
ci_0050                -2.579712e-03 3 1  ON 49
ci_0051                -1.839144e-03 3 1  ON 50
ci_0052                -1.721171e-03 3 1  ON 51
ci_0053                -3.849856e-03 3 1  ON 52
ci_0054                -3.734671e-03 3 1  ON 53
ci_0055                 2.334212e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310444e-03 3 1  ON 56
ci_0058                 2.892510e-03 3 1  ON 57
ci_0059                -3.897882e-03 3 1  ON 58
ci_0060                -3.669183e-03 3 1  ON 59
ci_0061                -3.113032e-03 3 1  ON 60
ci_0062                -3.326448e-03 3 1  ON 61
ci_0063                -9.707057e-03 3 1  ON 62
ci_0064                -9.660133e-03 3 1  ON 63
ci_0065                -6.920458e-03 3 1  ON 64
ci_0066                -6.464928e-03 3 1  ON 65
ci_0067                -3.907235e-03 3 1  ON 66
ci_0068                -3.850880e-03 3 1  ON 67
ci_0069                 3.717876e-03 3 1  ON 68
ci_0070                 3.466013e-03 3 1  ON 69
ci_0071                 4.079940e-03 3 1  ON 70
ci_0072                 4.253535e-03 3 1  ON 71
ci_0073                 3.372067e-03 3 1  ON 72
ci_0074                 3.331572e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.168219
====================================================
  Execution time = 1.4234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9019e-01
  Total weights = 1.9510e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706893188
                                         uncertainty =       0.001666993725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706893188
                                         uncertainty =       0.001666993725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375272282
  error estimate for blocks of size 2^( 2) =       0.000392452660
  error estimate for blocks of size 2^( 3) =       0.000409960391
  error estimate for blocks of size 2^( 4) =       0.000425965366
  error estimate for blocks of size 2^( 5) =       0.000436336679
  error estimate for blocks of size 2^( 6) =       0.000444026534
  error estimate for blocks of size 2^( 7) =       0.000448737817

      target function =      -0.928125848286
              le_mean =     -16.898110222126
             les_mean =     285.836316520253
             stat err =       0.000438766599
             autocorr =       1.367017717334
   target nu stat err =       0.000438766599
   target dn stat err =       0.002053451923
      target stat err =       0.003338342739
              std dev =       0.530715150365
             le_variance =       0.281658570827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706711333
                                         uncertainty =       0.001666990154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706711333
                                         uncertainty =       0.001666990154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375272161
  error estimate for blocks of size 2^( 2) =       0.000392452531
  error estimate for blocks of size 2^( 3) =       0.000409960250
  error estimate for blocks of size 2^( 4) =       0.000425965205
  error estimate for blocks of size 2^( 5) =       0.000436336505
  error estimate for blocks of size 2^( 6) =       0.000444026346
  error estimate for blocks of size 2^( 7) =       0.000448737625

      target function =      -0.928126637856
              le_mean =     -16.898110221679
             les_mean =     285.836316006829
             stat err =       0.000438766420
             autocorr =       1.367017486708
   target nu stat err =       0.000438766420
   target dn stat err =       0.002053438253
      target stat err =       0.003338327098
              std dev =       0.530714979105
             le_variance =       0.281658389046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706802251
                                         uncertainty =       0.001666991939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706802251
                                         uncertainty =       0.001666991939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375272221
  error estimate for blocks of size 2^( 2) =       0.000392452596
  error estimate for blocks of size 2^( 3) =       0.000409960321
  error estimate for blocks of size 2^( 4) =       0.000425965285
  error estimate for blocks of size 2^( 5) =       0.000436336592
  error estimate for blocks of size 2^( 6) =       0.000444026440
  error estimate for blocks of size 2^( 7) =       0.000448737721

      target function =      -0.928126243397
              le_mean =     -16.898110221902
             les_mean =     285.836316263309
             stat err =       0.000438766510
             autocorr =       1.367017602015
   target nu stat err =       0.000438766510
   target dn stat err =       0.002053445080
      target stat err =       0.003338334908
              std dev =       0.530715064726
             le_variance =       0.281658479927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706881820
                                         uncertainty =       0.001666993502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281706881820
                                         uncertainty =       0.001666993502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375272274
  error estimate for blocks of size 2^( 2) =       0.000392452652
  error estimate for blocks of size 2^( 3) =       0.000409960382
  error estimate for blocks of size 2^( 4) =       0.000425965356
  error estimate for blocks of size 2^( 5) =       0.000436336668
  error estimate for blocks of size 2^( 6) =       0.000444026522
  error estimate for blocks of size 2^( 7) =       0.000448737805

      target function =      -0.928125897709
              le_mean =     -16.898110222098
             les_mean =     285.836316488111
             stat err =       0.000438766588
             autocorr =       1.367017702912
   target nu stat err =       0.000438766588
   target dn stat err =       0.002053451067
      target stat err =       0.003338341759
              std dev =       0.530715139659
             le_variance =       0.281658559464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928125848286        initial
     6.2500e+02     6.2500e+03             6.2621e-07        -0.928126637856  <--
     2.5000e+03     2.5000e+04             1.5656e-07        -0.928126243397
     1.0000e+04     1.0000e+05             3.9141e-08        -0.928125897709

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.3738e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352971e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823348e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253486e-03 3 1  ON 32
ci_0034                 8.532863e-03 3 1  ON 33
ci_0035                 4.881259e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796919e-03 3 1  ON 42
ci_0044                -8.255065e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503993e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721178e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310461e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907213e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.192587
====================================================
  Execution time = 1.4712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9061e-01
  Total weights = 1.951019224e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280795755908
                                         uncertainty =       0.002044307815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280795755908
                                         uncertainty =       0.002044307815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374765337
  error estimate for blocks of size 2^( 2) =       0.000392318321
  error estimate for blocks of size 2^( 3) =       0.000409994820
  error estimate for blocks of size 2^( 4) =       0.000425498627
  error estimate for blocks of size 2^( 5) =       0.000437738711
  error estimate for blocks of size 2^( 6) =       0.000444170061
  error estimate for blocks of size 2^( 7) =       0.000450390926

      target function =      -0.927463040873
              le_mean =     -16.898420849798
             les_mean =     285.847232266839
             stat err =       0.000439449581
             autocorr =       1.374989173062
   target nu stat err =       0.000439449581
   target dn stat err =       0.002545602749
      target stat err =       0.004098725639
              std dev =       0.529998222950
             le_variance =       0.280898116330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689842084980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927479723976       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927480035344       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927480090265       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927480137051       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927480154874       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927480166309       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927480168606       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927480170682       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927480171754       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927480171815       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927480172121       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927480173060       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927480173223       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927480173499       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927480173479       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927480173401       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927480173406       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 2.079548e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927479723976       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927479801846       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927479815580       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927479827278       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927479831734       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927479834593       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927479835167       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927479835686       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927479835954       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927479835969       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927479836045       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927479836279       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927479836321       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927479836391       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927479836385       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927479836366       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927479836367       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 5.198905e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927479723976       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927479743445       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927479746879       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927479749802       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927479750918       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927479751627       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927479751776       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927479751901       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927479751971       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927479751976       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927479751995       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927479752057       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927479752064       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927479752081       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927479752080       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927479752087       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927479752074       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 1.299728e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.543109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7280e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.031201e-01 3 1  ON 0
ci_0002                 6.979574e-01 3 1  ON 1
ci_0003                -3.153868e-02 3 1  ON 2
ci_0004                -3.137272e-02 3 1  ON 3
ci_0005                -2.891793e-02 3 1  ON 4
ci_0006                -2.995409e-02 3 1  ON 5
ci_0007                -1.586947e-02 3 1  ON 6
ci_0008                -1.650014e-02 3 1  ON 7
ci_0009                -1.872292e-02 3 1  ON 8
ci_0010                -1.888031e-02 3 1  ON 9
ci_0011                -1.550638e-02 3 1  ON 10
ci_0012                -1.563513e-02 3 1  ON 11
ci_0013                 1.549002e-02 3 1  ON 12
ci_0014                 1.537515e-02 3 1  ON 13
ci_0015                 1.629416e-02 3 1  ON 14
ci_0016                 1.595270e-02 3 1  ON 15
ci_0017                 1.373684e-02 3 1  ON 16
ci_0018                 1.393353e-02 3 1  ON 17
ci_0019                 1.259666e-02 3 1  ON 18
ci_0020                 1.224403e-02 3 1  ON 19
ci_0021                 1.352923e-02 3 1  ON 20
ci_0022                 1.500219e-02 3 1  ON 21
ci_0023                -1.182655e-02 3 1  ON 22
ci_0024                -1.113288e-02 3 1  ON 23
ci_0025                -2.823421e-03 3 1  ON 24
ci_0026                -2.392799e-03 3 1  ON 25
ci_0027                -1.179166e-02 3 1  ON 26
ci_0028                -1.174936e-02 3 1  ON 27
ci_0029                -1.044362e-02 3 1  ON 28
ci_0030                -1.036582e-02 3 1  ON 29
ci_0031                 1.383433e-02 3 1  ON 30
ci_0032                 1.290464e-02 3 1  ON 31
ci_0033                 8.253386e-03 3 1  ON 32
ci_0034                 8.532749e-03 3 1  ON 33
ci_0035                 4.881287e-03 3 1  ON 34
ci_0036                 4.735630e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130902e-02 3 1  ON 37
ci_0039                -3.817613e-03 3 1  ON 38
ci_0040                -3.939085e-03 3 1  ON 39
ci_0041                 9.549833e-03 3 1  ON 40
ci_0042                 9.454452e-03 3 1  ON 41
ci_0043                -7.797415e-03 3 1  ON 42
ci_0044                -8.255548e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667761e-03 3 1  ON 45
ci_0047                -3.596711e-03 3 1  ON 46
ci_0048                -3.622743e-03 3 1  ON 47
ci_0049                -2.504050e-03 3 1  ON 48
ci_0050                -2.579589e-03 3 1  ON 49
ci_0051                -1.839104e-03 3 1  ON 50
ci_0052                -1.721114e-03 3 1  ON 51
ci_0053                -3.849952e-03 3 1  ON 52
ci_0054                -3.734429e-03 3 1  ON 53
ci_0055                 2.334082e-03 3 1  ON 54
ci_0056                 2.075190e-03 3 1  ON 55
ci_0057                 2.310532e-03 3 1  ON 56
ci_0058                 2.892518e-03 3 1  ON 57
ci_0059                -3.897859e-03 3 1  ON 58
ci_0060                -3.669246e-03 3 1  ON 59
ci_0061                -3.113120e-03 3 1  ON 60
ci_0062                -3.326485e-03 3 1  ON 61
ci_0063                -9.706956e-03 3 1  ON 62
ci_0064                -9.660121e-03 3 1  ON 63
ci_0065                -6.920281e-03 3 1  ON 64
ci_0066                -6.464917e-03 3 1  ON 65
ci_0067                -3.907226e-03 3 1  ON 66
ci_0068                -3.850853e-03 3 1  ON 67
ci_0069                 3.717839e-03 3 1  ON 68
ci_0070                 3.465998e-03 3 1  ON 69
ci_0071                 4.079767e-03 3 1  ON 70
ci_0072                 4.253019e-03 3 1  ON 71
ci_0073                 3.372015e-03 3 1  ON 72
ci_0074                 3.331457e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8369
    reference variance = 0.284384
====================================================
  Execution time = 1.6169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9449e-01
  Total weights = 1.9508e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448439756
                                         uncertainty =       0.001799435410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448439756
                                         uncertainty =       0.001799435410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375148532
  error estimate for blocks of size 2^( 2) =       0.000392151612
  error estimate for blocks of size 2^( 3) =       0.000409699577
  error estimate for blocks of size 2^( 4) =       0.000425729323
  error estimate for blocks of size 2^( 5) =       0.000437298186
  error estimate for blocks of size 2^( 6) =       0.000445143256
  error estimate for blocks of size 2^( 7) =       0.000451236135

      target function =      -0.921321301332
              le_mean =     -16.897425529580
             les_mean =     285.817479640800
             stat err =       0.000439851725
             autocorr =       1.374694187415
   target nu stat err =       0.000439851725
   target dn stat err =       0.004173189612
      target stat err =       0.006549404326
              std dev =       0.530540141862
             le_variance =       0.281472842127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281447950247
                                         uncertainty =       0.001799489720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281447950247
                                         uncertainty =       0.001799489720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375148207
  error estimate for blocks of size 2^( 2) =       0.000392151197
  error estimate for blocks of size 2^( 3) =       0.000409699048
  error estimate for blocks of size 2^( 4) =       0.000425728662
  error estimate for blocks of size 2^( 5) =       0.000437297444
  error estimate for blocks of size 2^( 6) =       0.000445142533
  error estimate for blocks of size 2^( 7) =       0.000451235334

      target function =      -0.921315583398
              le_mean =     -16.897425529919
             les_mean =     285.817483278204
             stat err =       0.000439850993
             autocorr =       1.374691994448
   target nu stat err =       0.000439850993
   target dn stat err =       0.004176134938
      target stat err =       0.006553886523
              std dev =       0.530539682604
             le_variance =       0.281472354818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448194895
                                         uncertainty =       0.001799462576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448194895
                                         uncertainty =       0.001799462576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375148370
  error estimate for blocks of size 2^( 2) =       0.000392151405
  error estimate for blocks of size 2^( 3) =       0.000409699313
  error estimate for blocks of size 2^( 4) =       0.000425728992
  error estimate for blocks of size 2^( 5) =       0.000437297815
  error estimate for blocks of size 2^( 6) =       0.000445142895
  error estimate for blocks of size 2^( 7) =       0.000451235735

      target function =      -0.921318444957
              le_mean =     -16.897425529741
             les_mean =     285.817481457549
             stat err =       0.000439851359
             autocorr =       1.374693090657
   target nu stat err =       0.000439851359
   target dn stat err =       0.004174662297
      target stat err =       0.006551645504
              std dev =       0.530539912133
             le_variance =       0.281472598366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448409140
                                         uncertainty =       0.001799438806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281448409140
                                         uncertainty =       0.001799438806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375148512
  error estimate for blocks of size 2^( 2) =       0.000392151586
  error estimate for blocks of size 2^( 3) =       0.000409699544
  error estimate for blocks of size 2^( 4) =       0.000425729281
  error estimate for blocks of size 2^( 5) =       0.000437298139
  error estimate for blocks of size 2^( 6) =       0.000445143211
  error estimate for blocks of size 2^( 7) =       0.000451236085

      target function =      -0.921320944674
              le_mean =     -16.897425529599
             les_mean =     285.817479867614
             stat err =       0.000439851679
             autocorr =       1.374694050312
   target nu stat err =       0.000439851679
   target dn stat err =       0.004173373648
      target stat err =       0.006549684403
              std dev =       0.530540113139
             le_variance =       0.281472811650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921321301332        initial  <--
     1.5625e+02     1.5625e+03             2.0795e-06        -0.921315583398
     6.2500e+02     6.2500e+03             5.1989e-07        -0.921318444957
     2.5000e+03     2.5000e+04             1.2997e-07        -0.921320944674

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.6901
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352971e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823348e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253486e-03 3 1  ON 32
ci_0034                 8.532863e-03 3 1  ON 33
ci_0035                 4.881259e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796919e-03 3 1  ON 42
ci_0044                -8.255065e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503993e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721178e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310461e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907213e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 0.403189
====================================================
  Execution time = 1.4632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9676e-01
  Total weights = 1.950997290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283597726004
                                         uncertainty =       0.001973895610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283597726004
                                         uncertainty =       0.001973895610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376593890
  error estimate for blocks of size 2^( 2) =       0.000393538434
  error estimate for blocks of size 2^( 3) =       0.000410477319
  error estimate for blocks of size 2^( 4) =       0.000425830783
  error estimate for blocks of size 2^( 5) =       0.000437818594
  error estimate for blocks of size 2^( 6) =       0.000445661606
  error estimate for blocks of size 2^( 7) =       0.000450814280

      target function =      -0.917791485074
              le_mean =     -16.898295349616
             les_mean =     285.849149906180
             stat err =       0.000440031316
             autocorr =       1.365276548494
   target nu stat err =       0.000440031316
   target dn stat err =       0.003972985112
      target stat err =       0.006201900011
              std dev =       0.532584186973
             le_variance =       0.283645916213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689829534962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917831964756       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917832026864       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917832039380       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917832045838       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917832049608       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917832050335       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917832050541       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917832050494       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917832050480       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917832050523       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917832050541       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917832050525       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917832050528       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917832050526       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917832050524       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917832050525       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917832050528       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917832050528       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 3.457994e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917831964756       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917831980284       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917831983413       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917831985028       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917831985970       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917831986152       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917831986204       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917831986191       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917831986187       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917831986192       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917831986206       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917831986210       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917831986205       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917831986186       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917831986185       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917831986197       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917831986196       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917831986214       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+03 is 8.645158e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917831964756       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917831968638       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917831969420       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917831969823       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917831970030       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917831970154       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917831970114       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917831970104       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917831970143       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917831970113       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917831970120       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917831970160       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917831970081       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917831970107       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917831970125       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917831970120       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917831970048       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917831970150       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+04 is 2.161300e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.553339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7250e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137274e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586965e-02 3 1  ON 6
ci_0008                -1.650029e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888045e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549009e-02 3 1  ON 12
ci_0014                 1.537519e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595282e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393356e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224396e-02 3 1  ON 19
ci_0021                 1.352964e-02 3 1  ON 20
ci_0022                 1.500260e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113283e-02 3 1  ON 23
ci_0025                -2.823337e-03 3 1  ON 24
ci_0026                -2.392910e-03 3 1  ON 25
ci_0027                -1.179158e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036571e-02 3 1  ON 29
ci_0031                 1.383440e-02 3 1  ON 30
ci_0032                 1.290464e-02 3 1  ON 31
ci_0033                 8.253482e-03 3 1  ON 32
ci_0034                 8.532847e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735572e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130896e-02 3 1  ON 37
ci_0039                -3.817581e-03 3 1  ON 38
ci_0040                -3.939115e-03 3 1  ON 39
ci_0041                 9.549887e-03 3 1  ON 40
ci_0042                 9.454556e-03 3 1  ON 41
ci_0043                -7.796946e-03 3 1  ON 42
ci_0044                -8.255113e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596702e-03 3 1  ON 46
ci_0048                -3.622710e-03 3 1  ON 47
ci_0049                -2.503992e-03 3 1  ON 48
ci_0050                -2.579657e-03 3 1  ON 49
ci_0051                -1.839129e-03 3 1  ON 50
ci_0052                -1.721169e-03 3 1  ON 51
ci_0053                -3.849859e-03 3 1  ON 52
ci_0054                -3.734548e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075089e-03 3 1  ON 55
ci_0057                 2.310464e-03 3 1  ON 56
ci_0058                 2.892523e-03 3 1  ON 57
ci_0059                -3.897902e-03 3 1  ON 58
ci_0060                -3.669143e-03 3 1  ON 59
ci_0061                -3.113120e-03 3 1  ON 60
ci_0062                -3.326485e-03 3 1  ON 61
ci_0063                -9.707065e-03 3 1  ON 62
ci_0064                -9.660026e-03 3 1  ON 63
ci_0065                -6.920363e-03 3 1  ON 64
ci_0066                -6.464941e-03 3 1  ON 65
ci_0067                -3.907211e-03 3 1  ON 66
ci_0068                -3.850819e-03 3 1  ON 67
ci_0069                 3.717864e-03 3 1  ON 68
ci_0070                 3.466000e-03 3 1  ON 69
ci_0071                 4.079870e-03 3 1  ON 70
ci_0072                 4.253440e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331443e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.33485
====================================================
  Execution time = 1.4091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9357e-01
  Total weights = 1.9512e+06
  Execution time = 1.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216530494
                                         uncertainty =       0.001946883265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216530494
                                         uncertainty =       0.001946883265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375625078
  error estimate for blocks of size 2^( 2) =       0.000393137918
  error estimate for blocks of size 2^( 3) =       0.000411459791
  error estimate for blocks of size 2^( 4) =       0.000426345243
  error estimate for blocks of size 2^( 5) =       0.000437981946
  error estimate for blocks of size 2^( 6) =       0.000444487895
  error estimate for blocks of size 2^( 7) =       0.000451813377

      target function =      -0.922786860852
              le_mean =     -16.898812793643
             les_mean =     285.863447958485
             stat err =       0.000440157115
             autocorr =       1.373113049510
   target nu stat err =       0.000440157115
   target dn stat err =       0.002671768611
      target stat err =       0.004255965267
              std dev =       0.531214079759
             le_variance =       0.282188398534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216459804
                                         uncertainty =       0.001946876259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216459804
                                         uncertainty =       0.001946876259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375625031
  error estimate for blocks of size 2^( 2) =       0.000393137869
  error estimate for blocks of size 2^( 3) =       0.000411459738
  error estimate for blocks of size 2^( 4) =       0.000426345188
  error estimate for blocks of size 2^( 5) =       0.000437981883
  error estimate for blocks of size 2^( 6) =       0.000444487830
  error estimate for blocks of size 2^( 7) =       0.000451813305

      target function =      -0.922786782923
              le_mean =     -16.898812796792
             les_mean =     285.863448114285
             stat err =       0.000440157052
             autocorr =       1.373112994749
   target nu stat err =       0.000440157052
   target dn stat err =       0.002671804048
      target stat err =       0.004256019272
              std dev =       0.531214013388
             le_variance =       0.282188328019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216495147
                                         uncertainty =       0.001946879762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216495147
                                         uncertainty =       0.001946879762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375625055
  error estimate for blocks of size 2^( 2) =       0.000393137893
  error estimate for blocks of size 2^( 3) =       0.000411459764
  error estimate for blocks of size 2^( 4) =       0.000426345216
  error estimate for blocks of size 2^( 5) =       0.000437981915
  error estimate for blocks of size 2^( 6) =       0.000444487862
  error estimate for blocks of size 2^( 7) =       0.000451813341

      target function =      -0.922786823324
              le_mean =     -16.898812795217
             les_mean =     285.863448035464
             stat err =       0.000440157083
             autocorr =       1.373113022121
   target nu stat err =       0.000440157083
   target dn stat err =       0.002671786327
      target stat err =       0.004255992278
              std dev =       0.531214046571
             le_variance =       0.282188363275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216526075
                                         uncertainty =       0.001946882827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282216526075
                                         uncertainty =       0.001946882827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375625075
  error estimate for blocks of size 2^( 2) =       0.000393137915
  error estimate for blocks of size 2^( 3) =       0.000411459788
  error estimate for blocks of size 2^( 4) =       0.000426345240
  error estimate for blocks of size 2^( 5) =       0.000437981942
  error estimate for blocks of size 2^( 6) =       0.000444487891
  error estimate for blocks of size 2^( 7) =       0.000451813373

      target function =      -0.922786856322
              le_mean =     -16.898812793840
             les_mean =     285.863447968004
             stat err =       0.000440157111
             autocorr =       1.373113046083
   target nu stat err =       0.000440157111
   target dn stat err =       0.002671770825
      target stat err =       0.004255968645
              std dev =       0.531214075610
             le_variance =       0.282188394126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922786860852        initial  <--
     1.5625e+03     1.5625e+04             3.4580e-07        -0.922786782923
     6.2500e+03     6.2500e+04             8.6452e-08        -0.922786823324
     2.5000e+04     2.5000e+05             2.1613e-08        -0.922786856322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5935
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352971e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823348e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253486e-03 3 1  ON 32
ci_0034                 8.532863e-03 3 1  ON 33
ci_0035                 4.881259e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796919e-03 3 1  ON 42
ci_0044                -8.255065e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503993e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721178e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310461e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907213e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.884
    reference variance = 0.201581
====================================================
  Execution time = 1.4550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9118e-01
  Total weights = 1.950955481e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281980504838
                                         uncertainty =       0.001725101149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281980504838
                                         uncertainty =       0.001725101149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375534763
  error estimate for blocks of size 2^( 2) =       0.000393047873
  error estimate for blocks of size 2^( 3) =       0.000411040401
  error estimate for blocks of size 2^( 4) =       0.000427476773
  error estimate for blocks of size 2^( 5) =       0.000439360798
  error estimate for blocks of size 2^( 6) =       0.000445890392
  error estimate for blocks of size 2^( 7) =       0.000448539989

      target function =      -0.926547995106
              le_mean =     -16.898012780866
             les_mean =     285.834019392262
             stat err =       0.000440316988
             autocorr =       1.374771729538
   target nu stat err =       0.000440316988
   target dn stat err =       0.002167501116
      target stat err =       0.003502929502
              std dev =       0.531086354271
             le_variance =       0.282052715693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689801278087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926559888656       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926559891802       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926559892741       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926559893491       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926559893700       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926559893784       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926559893780       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926559893775       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926559893812       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926559893807       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926559893790       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926559893812       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926559893805       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926559893805       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926559893809       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926559893761       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926559893768       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926559893766       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+04 is 3.003195e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926559888656       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926559889442       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926559889677       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926559889865       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926559889881       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926559890088       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926559889936       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926559889832       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926559889942       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926559890067       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926559889874       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926559889863       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926559889937       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926559889897       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926559889768       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926559889815       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926559889837       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926559889813       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+04 is 7.508002e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926559888656       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926559888853       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926559888911       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926559888956       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926559888948       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926559888942       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926559889291       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926559888743       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926559888978       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926559888843       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926559888219       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926559889009       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926559888958       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926559888873       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926559888336       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926559888689       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926559887967       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926559889114       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+05 is 1.877001e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.563566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7111e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823346e-03 3 1  ON 24
ci_0026                -2.392910e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253486e-03 3 1  ON 32
ci_0034                 8.532863e-03 3 1  ON 33
ci_0035                 4.881259e-03 3 1  ON 34
ci_0036                 4.735567e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549895e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796924e-03 3 1  ON 42
ci_0044                -8.255072e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503992e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721178e-03 3 1  ON 51
ci_0053                -3.849873e-03 3 1  ON 52
ci_0054                -3.734550e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075107e-03 3 1  ON 55
ci_0057                 2.310461e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.113116e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707060e-03 3 1  ON 62
ci_0064                -9.660030e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079881e-03 3 1  ON 70
ci_0072                 4.253457e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8629
    reference variance = 0.224183
====================================================
  Execution time = 1.4090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9274e-01
  Total weights = 1.9510e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094817561
                                         uncertainty =       0.001719965912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094817561
                                         uncertainty =       0.001719965912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375502075
  error estimate for blocks of size 2^( 2) =       0.000392798707
  error estimate for blocks of size 2^( 3) =       0.000410118970
  error estimate for blocks of size 2^( 4) =       0.000424616443
  error estimate for blocks of size 2^( 5) =       0.000436484050
  error estimate for blocks of size 2^( 6) =       0.000444355610
  error estimate for blocks of size 2^( 7) =       0.000448238791

      target function =      -0.924087943811
              le_mean =     -16.898210714847
             les_mean =     285.842267860969
             stat err =       0.000438423724
             autocorr =       1.363212028788
   target nu stat err =       0.000438423724
   target dn stat err =       0.002717335961
      target stat err =       0.004333043634
              std dev =       0.531040127561
             le_variance =       0.282003617080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094811190
                                         uncertainty =       0.001719965924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094811190
                                         uncertainty =       0.001719965924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375502071
  error estimate for blocks of size 2^( 2) =       0.000392798702
  error estimate for blocks of size 2^( 3) =       0.000410118964
  error estimate for blocks of size 2^( 4) =       0.000424616436
  error estimate for blocks of size 2^( 5) =       0.000436484042
  error estimate for blocks of size 2^( 6) =       0.000444355602
  error estimate for blocks of size 2^( 7) =       0.000448238784

      target function =      -0.924087940541
              le_mean =     -16.898210715155
             les_mean =     285.842267873427
             stat err =       0.000438423716
             autocorr =       1.363212011873
   target nu stat err =       0.000438423716
   target dn stat err =       0.002717337925
      target stat err =       0.004333046644
              std dev =       0.531040121561
             le_variance =       0.282003610708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094814376
                                         uncertainty =       0.001719965918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094814376
                                         uncertainty =       0.001719965918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375502073
  error estimate for blocks of size 2^( 2) =       0.000392798705
  error estimate for blocks of size 2^( 3) =       0.000410118967
  error estimate for blocks of size 2^( 4) =       0.000424616440
  error estimate for blocks of size 2^( 5) =       0.000436484046
  error estimate for blocks of size 2^( 6) =       0.000444355606
  error estimate for blocks of size 2^( 7) =       0.000448238787

      target function =      -0.924087942176
              le_mean =     -16.898210715001
             les_mean =     285.842267867198
             stat err =       0.000438423720
             autocorr =       1.363212020340
   target nu stat err =       0.000438423720
   target dn stat err =       0.002717336943
      target stat err =       0.004333045139
              std dev =       0.531040124561
             le_variance =       0.282003613894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094817163
                                         uncertainty =       0.001719965913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282094817163
                                         uncertainty =       0.001719965913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375502075
  error estimate for blocks of size 2^( 2) =       0.000392798707
  error estimate for blocks of size 2^( 3) =       0.000410118970
  error estimate for blocks of size 2^( 4) =       0.000424616443
  error estimate for blocks of size 2^( 5) =       0.000436484050
  error estimate for blocks of size 2^( 6) =       0.000444355609
  error estimate for blocks of size 2^( 7) =       0.000448238791

      target function =      -0.924087943607
              le_mean =     -16.898210714866
             les_mean =     285.842267861748
             stat err =       0.000438423723
             autocorr =       1.363212027734
   target nu stat err =       0.000438423723
   target dn stat err =       0.002717336083
      target stat err =       0.004333043822
              std dev =       0.531040127186
             le_variance =       0.282003616681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924087943811        initial  <--
     1.5625e+04     1.5625e+05             3.0032e-08        -0.924087940541
     6.2500e+04     6.2500e+05             7.5080e-09        -0.924087942176
     2.5000e+05     2.5000e+06             1.8770e-09        -0.924087943607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6122
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352971e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823348e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253486e-03 3 1  ON 32
ci_0034                 8.532863e-03 3 1  ON 33
ci_0035                 4.881259e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796919e-03 3 1  ON 42
ci_0044                -8.255065e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503993e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721178e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310461e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907213e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.82
    reference variance = 0.211526
====================================================
  Execution time = 1.4505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9319e-01
  Total weights = 1.951365695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283724081302
                                         uncertainty =       0.002555219418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283724081302
                                         uncertainty =       0.002555219418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376589453
  error estimate for blocks of size 2^( 2) =       0.000393575557
  error estimate for blocks of size 2^( 3) =       0.000411030547
  error estimate for blocks of size 2^( 4) =       0.000426028674
  error estimate for blocks of size 2^( 5) =       0.000437167850
  error estimate for blocks of size 2^( 6) =       0.000445133151
  error estimate for blocks of size 2^( 7) =       0.000451013867

      target function =      -0.923373318729
              le_mean =     -16.898623278879
             les_mean =     285.856660216915
             stat err =       0.000439835886
             autocorr =       1.364096246590
   target nu stat err =       0.000439835886
   target dn stat err =       0.003460902340
      target stat err =       0.005483488070
              std dev =       0.532577912370
             le_variance =       0.283639232745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689862327888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923404646490       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923404647340       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923404647458       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923404647540       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923404647212       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923404647579       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923404647795       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923404647520       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923404647581       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923404647581       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923404647766       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923404647581       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923404647581       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923404647998       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923404647421       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923404647582       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923404647392       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923404647338       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+05 is 2.786443e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923404646490       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923404646703       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923404646732       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923404646752       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923404646761       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923404646025       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923404646763       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923404646763       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923404646033       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923404645509       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923404646763       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923404646618       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923404647298       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923404646326       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923404646763       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923404644972       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923404645710       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923404647522       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+05 is 6.966110e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923404646490       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923404646543       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923404646551       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923404646556       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923404646558       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923404646558       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923404646558       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923404642743       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923404655374       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923404646558       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923404642852       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923404652550       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923404646558       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923404651436       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923404644458       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923404652533       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923404648818       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923404641587       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+06 is 1.741527e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.573803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7085e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352971e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823348e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253486e-03 3 1  ON 32
ci_0034                 8.532863e-03 3 1  ON 33
ci_0035                 4.881258e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796919e-03 3 1  ON 42
ci_0044                -8.255066e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667640e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503994e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721178e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310461e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326483e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907213e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8295
    reference variance = 0.163216
====================================================
  Execution time = 1.6333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9165e-01
  Total weights = 1.9510e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876025614
                                         uncertainty =       0.001420536991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876025614
                                         uncertainty =       0.001420536991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374854401
  error estimate for blocks of size 2^( 2) =       0.000392339964
  error estimate for blocks of size 2^( 3) =       0.000409980252
  error estimate for blocks of size 2^( 4) =       0.000424895491
  error estimate for blocks of size 2^( 5) =       0.000435936994
  error estimate for blocks of size 2^( 6) =       0.000441727253
  error estimate for blocks of size 2^( 7) =       0.000443994133

      target function =      -0.925804704258
              le_mean =     -16.897619759709
             les_mean =     285.821203518914
             stat err =       0.000436638468
             autocorr =       1.356809139385
   target nu stat err =       0.000436638468
   target dn stat err =       0.002380709406
      target stat err =       0.003822370094
              std dev =       0.530124177835
             le_variance =       0.281031643926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876024895
                                         uncertainty =       0.001420536988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876024895
                                         uncertainty =       0.001420536988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374854401
  error estimate for blocks of size 2^( 2) =       0.000392339963
  error estimate for blocks of size 2^( 3) =       0.000409980251
  error estimate for blocks of size 2^( 4) =       0.000424895490
  error estimate for blocks of size 2^( 5) =       0.000435936994
  error estimate for blocks of size 2^( 6) =       0.000441727252
  error estimate for blocks of size 2^( 7) =       0.000443994132

      target function =      -0.925804706040
              le_mean =     -16.897619759693
             les_mean =     285.821203517222
             stat err =       0.000436638467
             autocorr =       1.356809138375
   target nu stat err =       0.000436638467
   target dn stat err =       0.002380709405
      target stat err =       0.003822370106
              std dev =       0.530124177153
             le_variance =       0.281031643202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876025255
                                         uncertainty =       0.001420536990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876025255
                                         uncertainty =       0.001420536990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374854401
  error estimate for blocks of size 2^( 2) =       0.000392339963
  error estimate for blocks of size 2^( 3) =       0.000409980252
  error estimate for blocks of size 2^( 4) =       0.000424895490
  error estimate for blocks of size 2^( 5) =       0.000435936994
  error estimate for blocks of size 2^( 6) =       0.000441727252
  error estimate for blocks of size 2^( 7) =       0.000443994133

      target function =      -0.925804705149
              le_mean =     -16.897619759701
             les_mean =     285.821203518068
             stat err =       0.000436638467
             autocorr =       1.356809138878
   target nu stat err =       0.000436638467
   target dn stat err =       0.002380709405
      target stat err =       0.003822370100
              std dev =       0.530124177494
             le_variance =       0.281031643564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876025569
                                         uncertainty =       0.001420536991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280876025569
                                         uncertainty =       0.001420536991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374854401
  error estimate for blocks of size 2^( 2) =       0.000392339963
  error estimate for blocks of size 2^( 3) =       0.000409980252
  error estimate for blocks of size 2^( 4) =       0.000424895491
  error estimate for blocks of size 2^( 5) =       0.000435936994
  error estimate for blocks of size 2^( 6) =       0.000441727252
  error estimate for blocks of size 2^( 7) =       0.000443994133

      target function =      -0.925804704370
              le_mean =     -16.897619759708
             les_mean =     285.821203518808
             stat err =       0.000436638468
             autocorr =       1.356809139320
   target nu stat err =       0.000436638468
   target dn stat err =       0.002380709406
      target stat err =       0.003822370095
              std dev =       0.530124177793
             le_variance =       0.281031643880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925804704258        initial
     1.5625e+05     1.5625e+06             2.7864e-09        -0.925804706040  <--
     6.2500e+05     6.2500e+06             6.9661e-10        -0.925804705149
     2.5000e+06     2.5000e+07             1.7415e-10        -0.925804704370

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 2.5841e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532862e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796921e-03 3 1  ON 42
ci_0044                -8.255068e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667641e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892529e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113113e-03 3 1  ON 60
ci_0062                -3.326483e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.21627
====================================================
  Execution time = 1.4665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9560e-01
  Total weights = 1.950778973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283451719904
                                         uncertainty =       0.001711782657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283451719904
                                         uncertainty =       0.001711782657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376440121
  error estimate for blocks of size 2^( 2) =       0.000393497635
  error estimate for blocks of size 2^( 3) =       0.000411267197
  error estimate for blocks of size 2^( 4) =       0.000426087108
  error estimate for blocks of size 2^( 5) =       0.000438180186
  error estimate for blocks of size 2^( 6) =       0.000444880778
  error estimate for blocks of size 2^( 7) =       0.000449840462

      target function =      -0.919608664958
              le_mean =     -16.897819576665
             les_mean =     285.831909563136
             stat err =       0.000439747133
             autocorr =       1.364627836990
   target nu stat err =       0.000439747133
   target dn stat err =       0.003195970128
      target stat err =       0.005023541583
              std dev =       0.532366724203
             le_variance =       0.283414329038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689781957667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919634833043       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919634836817       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919634837473       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919634837768       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919634837898       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919634837933       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919634838069       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919634838044       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919634838074       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919634837954       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919634838200       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919634838112       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919634838109       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919634837949       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919634838045       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919634838048       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919634838038       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919634838008       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919634838075       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+04 is 1.386992e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919634833043       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919634833987       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919634834151       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919634834263       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919634834277       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919634834363       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919634834469       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919634834568       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919634834457       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919634834115       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919634833831       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919634834212       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919634834398       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919634834219       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919634834202       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919634834185       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919634834429       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919634834703       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919634834181       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+05 is 3.467483e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919634833043       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919634833279       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919634833320       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919634833339       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919634833352       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919634833740       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919634834220       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919634832787       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919634834057       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919634833735       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919634833648       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919634833485       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919634834439       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919634833645       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919634833359       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919634833087       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919634834420       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919634833163       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919634833459       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+05 is 8.668709e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.585183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7225e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823348e-03 3 1  ON 24
ci_0026                -2.392908e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881257e-03 3 1  ON 34
ci_0036                 4.735567e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796923e-03 3 1  ON 42
ci_0044                -8.255069e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667641e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503996e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839130e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075107e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669186e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079881e-03 3 1  ON 70
ci_0072                 4.253457e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.270222
====================================================
  Execution time = 1.4321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9213e-01
  Total weights = 1.9512e+06
  Execution time = 1.9053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426183107
                                         uncertainty =       0.002065909950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426183107
                                         uncertainty =       0.002065909950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816677
  error estimate for blocks of size 2^( 2) =       0.000392943097
  error estimate for blocks of size 2^( 3) =       0.000410537438
  error estimate for blocks of size 2^( 4) =       0.000426350643
  error estimate for blocks of size 2^( 5) =       0.000439236496
  error estimate for blocks of size 2^( 6) =       0.000447177232
  error estimate for blocks of size 2^( 7) =       0.000451978777

      target function =      -0.925051993535
              le_mean =     -16.897979840729
             les_mean =     285.833854272558
             stat err =       0.000441185787
             autocorr =       1.378132358819
   target nu stat err =       0.000441185787
   target dn stat err =       0.002319228293
      target stat err =       0.003725504980
              std dev =       0.531485041218
             le_variance =       0.282476349038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426180155
                                         uncertainty =       0.002065910045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426180155
                                         uncertainty =       0.002065910045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816675
  error estimate for blocks of size 2^( 2) =       0.000392943094
  error estimate for blocks of size 2^( 3) =       0.000410537435
  error estimate for blocks of size 2^( 4) =       0.000426350639
  error estimate for blocks of size 2^( 5) =       0.000439236492
  error estimate for blocks of size 2^( 6) =       0.000447177228
  error estimate for blocks of size 2^( 7) =       0.000451978773

      target function =      -0.925051988456
              le_mean =     -16.897979840767
             les_mean =     285.833854277076
             stat err =       0.000441185783
             autocorr =       1.378132349088
   target nu stat err =       0.000441185783
   target dn stat err =       0.002319228776
      target stat err =       0.003725505682
              std dev =       0.531485038401
             le_variance =       0.282476346044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426181631
                                         uncertainty =       0.002065909998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426181631
                                         uncertainty =       0.002065909998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816676
  error estimate for blocks of size 2^( 2) =       0.000392943095
  error estimate for blocks of size 2^( 3) =       0.000410537436
  error estimate for blocks of size 2^( 4) =       0.000426350641
  error estimate for blocks of size 2^( 5) =       0.000439236494
  error estimate for blocks of size 2^( 6) =       0.000447177230
  error estimate for blocks of size 2^( 7) =       0.000451978775

      target function =      -0.925051990996
              le_mean =     -16.897979840748
             les_mean =     285.833854274817
             stat err =       0.000441185785
             autocorr =       1.378132353958
   target nu stat err =       0.000441185785
   target dn stat err =       0.002319228534
      target stat err =       0.003725505331
              std dev =       0.531485039809
             le_variance =       0.282476347541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426182922
                                         uncertainty =       0.002065909956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426182922
                                         uncertainty =       0.002065909956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816677
  error estimate for blocks of size 2^( 2) =       0.000392943096
  error estimate for blocks of size 2^( 3) =       0.000410537438
  error estimate for blocks of size 2^( 4) =       0.000426350642
  error estimate for blocks of size 2^( 5) =       0.000439236496
  error estimate for blocks of size 2^( 6) =       0.000447177232
  error estimate for blocks of size 2^( 7) =       0.000451978777

      target function =      -0.925051993218
              le_mean =     -16.897979840731
             les_mean =     285.833854272841
             stat err =       0.000441185787
             autocorr =       1.378132358218
   target nu stat err =       0.000441185787
   target dn stat err =       0.002319228323
      target stat err =       0.003725505024
              std dev =       0.531485041042
             le_variance =       0.282476348851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925051993535        initial  <--
     3.9062e+04     3.9062e+05             1.3870e-08        -0.925051988456
     1.5625e+05     1.5625e+06             3.4675e-09        -0.925051990996
     6.2500e+05     6.2500e+06             8.6687e-10        -0.925051993218

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9360
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532862e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796921e-03 3 1  ON 42
ci_0044                -8.255068e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667641e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892529e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113113e-03 3 1  ON 60
ci_0062                -3.326483e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.92
    reference variance = 0.327353
====================================================
  Execution time = 1.4627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9356e-01
  Total weights = 1.950965002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282651990980
                                         uncertainty =       0.001622456005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282651990980
                                         uncertainty =       0.001622456005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375981523
  error estimate for blocks of size 2^( 2) =       0.000393365085
  error estimate for blocks of size 2^( 3) =       0.000411006341
  error estimate for blocks of size 2^( 4) =       0.000426358081
  error estimate for blocks of size 2^( 5) =       0.000437710042
  error estimate for blocks of size 2^( 6) =       0.000445411745
  error estimate for blocks of size 2^( 7) =       0.000448779031

      target function =      -0.922805199970
              le_mean =     -16.897575752289
             les_mean =     285.821628774954
             stat err =       0.000439564725
             autocorr =       1.366824201188
   target nu stat err =       0.000439564725
   target dn stat err =       0.002108488523
      target stat err =       0.003382144162
              std dev =       0.531718169120
             le_variance =       0.282724211372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689757575229e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922816382122       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922816382249       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922816382295       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922816382336       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922816382534       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922816382390       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922816381787       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922816382207       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922816382734       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922816381624       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922816381720       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922816382783       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922816381394       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922816382703       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922816382432       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922816382438       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922816380866       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922816382672       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+05 is 1.062712e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922816382122       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922816382154       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922816382165       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922816382146       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922816382189       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922816382828       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922816384406       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922816383189       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922816382447       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922816384025       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922816382669       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922816381215       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922816385528       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922816383760       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922816385244       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922816383340       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922816382057       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922816381007       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+06 is 2.656779e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922816382122       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922816382130       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922816382133       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922816382135       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922816382662       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922816389035       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922816375116       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922816382772       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922816376510       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922816377473       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922816380077       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922816393523       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922816386235       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922816384074       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922816385610       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922816379990       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922816394537       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922816371593       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+06 is 6.641948e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.595502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7176e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532862e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735567e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796921e-03 3 1  ON 42
ci_0044                -8.255068e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667641e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892529e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113113e-03 3 1  ON 60
ci_0062                -3.326483e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8345
    reference variance = 0.482956
====================================================
  Execution time = 1.4305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9757e-01
  Total weights = 1.9510e+06
  Execution time = 1.9008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723835
                                         uncertainty =       0.002115765357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723835
                                         uncertainty =       0.002115765357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378271740
  error estimate for blocks of size 2^( 2) =       0.000394998130
  error estimate for blocks of size 2^( 3) =       0.000412309430
  error estimate for blocks of size 2^( 4) =       0.000428270560
  error estimate for blocks of size 2^( 5) =       0.000439878965
  error estimate for blocks of size 2^( 6) =       0.000448214093
  error estimate for blocks of size 2^( 7) =       0.000453009563

      target function =      -0.916569965932
              le_mean =     -16.897590803466
             les_mean =     285.826143641549
             stat err =       0.000442343295
             autocorr =       1.367448892489
   target nu stat err =       0.000442343295
   target dn stat err =       0.002864112491
      target stat err =       0.004483416071
              std dev =       0.534957024843
             le_variance =       0.286179018428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723562
                                         uncertainty =       0.002115765347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723562
                                         uncertainty =       0.002115765347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378271740
  error estimate for blocks of size 2^( 2) =       0.000394998129
  error estimate for blocks of size 2^( 3) =       0.000412309429
  error estimate for blocks of size 2^( 4) =       0.000428270559
  error estimate for blocks of size 2^( 5) =       0.000439878965
  error estimate for blocks of size 2^( 6) =       0.000448214093
  error estimate for blocks of size 2^( 7) =       0.000453009563

      target function =      -0.916569966611
              le_mean =     -16.897590803468
             les_mean =     285.826143641159
             stat err =       0.000442343295
             autocorr =       1.367448891712
   target nu stat err =       0.000442343295
   target dn stat err =       0.002864112494
      target stat err =       0.004483416082
              std dev =       0.534957024587
             le_variance =       0.286179018155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723699
                                         uncertainty =       0.002115765352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723699
                                         uncertainty =       0.002115765352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378271740
  error estimate for blocks of size 2^( 2) =       0.000394998129
  error estimate for blocks of size 2^( 3) =       0.000412309430
  error estimate for blocks of size 2^( 4) =       0.000428270559
  error estimate for blocks of size 2^( 5) =       0.000439878965
  error estimate for blocks of size 2^( 6) =       0.000448214093
  error estimate for blocks of size 2^( 7) =       0.000453009563

      target function =      -0.916569966272
              le_mean =     -16.897590803467
             les_mean =     285.826143641354
             stat err =       0.000442343295
             autocorr =       1.367448892100
   target nu stat err =       0.000442343295
   target dn stat err =       0.002864112492
      target stat err =       0.004483416077
              std dev =       0.534957024715
             le_variance =       0.286179018292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723818
                                         uncertainty =       0.002115765357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286242723818
                                         uncertainty =       0.002115765357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378271740
  error estimate for blocks of size 2^( 2) =       0.000394998130
  error estimate for blocks of size 2^( 3) =       0.000412309430
  error estimate for blocks of size 2^( 4) =       0.000428270560
  error estimate for blocks of size 2^( 5) =       0.000439878965
  error estimate for blocks of size 2^( 6) =       0.000448214093
  error estimate for blocks of size 2^( 7) =       0.000453009563

      target function =      -0.916569965975
              le_mean =     -16.897590803466
             les_mean =     285.826143641525
             stat err =       0.000442343295
             autocorr =       1.367448892438
   target nu stat err =       0.000442343295
   target dn stat err =       0.002864112491
      target stat err =       0.004483416071
              std dev =       0.534957024827
             le_variance =       0.286179018411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916569965932        initial
     3.9062e+05     3.9062e+06             1.0627e-09        -0.916569966611  <--
     1.5625e+06     1.5625e+07             2.6568e-10        -0.916569966272
     6.2500e+06     6.2500e+07             6.6419e-11        -0.916569965975

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 2.3897e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735567e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796922e-03 3 1  ON 42
ci_0044                -8.255068e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667641e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503996e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326483e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253458e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8512
    reference variance = 0.323118
====================================================
  Execution time = 1.4545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9575e-01
  Total weights = 1.951313162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272331472
                                         uncertainty =       0.001985119286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272331472
                                         uncertainty =       0.001985119286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377736546
  error estimate for blocks of size 2^( 2) =       0.000394806130
  error estimate for blocks of size 2^( 3) =       0.000412535156
  error estimate for blocks of size 2^( 4) =       0.000428500139
  error estimate for blocks of size 2^( 5) =       0.000440378676
  error estimate for blocks of size 2^( 6) =       0.000448442664
  error estimate for blocks of size 2^( 7) =       0.000454028185

      target function =      -0.919394847995
              le_mean =     -16.897740488104
             les_mean =     285.829379856397
             stat err =       0.000442837416
             autocorr =       1.374391959123
   target nu stat err =       0.000442837416
   target dn stat err =       0.002636555225
      target stat err =       0.004163859914
              std dev =       0.534200146609
             le_variance =       0.285369796637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689774048810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919412314567       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919412314961       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919412315133       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919412315254       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919412315321       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919412315240       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919412315070       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919412315400       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919412315504       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919412315131       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919412315222       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919412315404       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919412315454       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919412315334       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919412315407       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919412315419       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919412315282       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919412315343       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+04 is 5.002065e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919412314567       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919412314665       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919412314708       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919412314738       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919412314305       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919412314761       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919412314524       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919412314770       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919412314755       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919412314839       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919412314195       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919412314636       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919412314964       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919412314417       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919412315551       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919412315825       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919412314433       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919412316025       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+05 is 1.250517e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919412314567       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919412314591       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919412314602       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919412315263       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919412314613       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919412314614       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919412314613       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919412314614       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919412312066       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919412314567       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919412316397       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919412317728       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919412314630       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919412311660       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919412313895       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919412319994       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919412319372       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919412316880       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+06 is 3.126292e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.605655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7100e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500268e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735567e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796923e-03 3 1  ON 42
ci_0044                -8.255069e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667641e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334100e-03 3 1  ON 54
ci_0056                 2.075108e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897911e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326483e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079882e-03 3 1  ON 70
ci_0072                 4.253457e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8814
    reference variance = 0.587572
====================================================
  Execution time = 1.4145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9783e-01
  Total weights = 1.9507e+06
  Execution time = 1.8776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424073207
                                         uncertainty =       0.002725357819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424073207
                                         uncertainty =       0.002725357819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377880962
  error estimate for blocks of size 2^( 2) =       0.000395232286
  error estimate for blocks of size 2^( 3) =       0.000412926018
  error estimate for blocks of size 2^( 4) =       0.000429188733
  error estimate for blocks of size 2^( 5) =       0.000440599919
  error estimate for blocks of size 2^( 6) =       0.000448954152
  error estimate for blocks of size 2^( 7) =       0.000451674241

      target function =      -0.916128544716
              le_mean =     -16.897914076716
             les_mean =     285.837328769499
             stat err =       0.000442604261
             autocorr =       1.371895898091
   target nu stat err =       0.000442604261
   target dn stat err =       0.004818130886
      target stat err =       0.007472198914
              std dev =       0.534404381286
             le_variance =       0.285588042738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424071367
                                         uncertainty =       0.002725357495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424071367
                                         uncertainty =       0.002725357495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377880961
  error estimate for blocks of size 2^( 2) =       0.000395232285
  error estimate for blocks of size 2^( 3) =       0.000412926016
  error estimate for blocks of size 2^( 4) =       0.000429188732
  error estimate for blocks of size 2^( 5) =       0.000440599917
  error estimate for blocks of size 2^( 6) =       0.000448954150
  error estimate for blocks of size 2^( 7) =       0.000451674239

      target function =      -0.916128551379
              le_mean =     -16.897914076708
             les_mean =     285.837328764938
             stat err =       0.000442604260
             autocorr =       1.371895895999
   target nu stat err =       0.000442604260
   target dn stat err =       0.004818130296
      target stat err =       0.007472198116
              std dev =       0.534404379566
             le_variance =       0.285588040900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424072287
                                         uncertainty =       0.002725357657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424072287
                                         uncertainty =       0.002725357657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377880961
  error estimate for blocks of size 2^( 2) =       0.000395232285
  error estimate for blocks of size 2^( 3) =       0.000412926017
  error estimate for blocks of size 2^( 4) =       0.000429188733
  error estimate for blocks of size 2^( 5) =       0.000440599918
  error estimate for blocks of size 2^( 6) =       0.000448954151
  error estimate for blocks of size 2^( 7) =       0.000451674240

      target function =      -0.916128548048
              le_mean =     -16.897914076712
             les_mean =     285.837328767219
             stat err =       0.000442604260
             autocorr =       1.371895897050
   target nu stat err =       0.000442604260
   target dn stat err =       0.004818130591
      target stat err =       0.007472198515
              std dev =       0.534404380426
             le_variance =       0.285588041818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424073092
                                         uncertainty =       0.002725357799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285424073092
                                         uncertainty =       0.002725357799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377880962
  error estimate for blocks of size 2^( 2) =       0.000395232286
  error estimate for blocks of size 2^( 3) =       0.000412926018
  error estimate for blocks of size 2^( 4) =       0.000429188733
  error estimate for blocks of size 2^( 5) =       0.000440599919
  error estimate for blocks of size 2^( 6) =       0.000448954152
  error estimate for blocks of size 2^( 7) =       0.000451674241

      target function =      -0.916128545132
              le_mean =     -16.897914076715
             les_mean =     285.837328769214
             stat err =       0.000442604261
             autocorr =       1.371895897970
   target nu stat err =       0.000442604261
   target dn stat err =       0.004818130849
      target stat err =       0.007472198864
              std dev =       0.534404381178
             le_variance =       0.285588042623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916128544716        initial
     9.7656e+04     9.7656e+05             5.0021e-09        -0.916128551379  <--
     3.9062e+05     3.9062e+06             1.2505e-09        -0.916128548048
     1.5625e+06     1.5625e+07             3.1263e-10        -0.916128545132

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 2.3716e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454562e-03 3 1  ON 41
ci_0043                -7.796925e-03 3 1  ON 42
ci_0044                -8.255072e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667642e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897910e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113113e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717871e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079881e-03 3 1  ON 70
ci_0072                 4.253456e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.854
    reference variance = 0.365
====================================================
  Execution time = 1.4496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9436e-01
  Total weights = 1.950951707e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285071125675
                                         uncertainty =       0.001870925453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285071125675
                                         uncertainty =       0.001870925453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377547834
  error estimate for blocks of size 2^( 2) =       0.000394601538
  error estimate for blocks of size 2^( 3) =       0.000412136157
  error estimate for blocks of size 2^( 4) =       0.000427339834
  error estimate for blocks of size 2^( 5) =       0.000438815438
  error estimate for blocks of size 2^( 6) =       0.000446329737
  error estimate for blocks of size 2^( 7) =       0.000448837484

      target function =      -0.921551119349
              le_mean =     -16.898149298226
             les_mean =     285.841814633464
             stat err =       0.000440330623
             autocorr =       1.360234588952
   target nu stat err =       0.000440330623
   target dn stat err =       0.002363318333
      target stat err =       0.003766272734
              std dev =       0.533933267051
             le_variance =       0.285084733663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689814929823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921565076292       residual = 9.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921565078177       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921565078881       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921565079277       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921565079478       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921565079568       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921565079546       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921565079581       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921565079592       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921565079637       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921565079639       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921565079594       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921565079619       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921565079649       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921565079601       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921565079589       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921565079640       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921565079596       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+04 is 2.316044e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921565076292       residual = 9.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921565076763       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921565076939       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921565077030       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921565077093       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921565076976       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921565077113       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921565077092       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921565077074       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921565077346       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921565076985       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921565076993       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921565077380       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921565077060       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921565076946       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921565077122       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921565077177       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921565077061       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+04 is 5.790116e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921565076292       residual = 9.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921565076409       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921565076453       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921565076478       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921565076492       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921565076334       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921565076498       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921565076498       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921565076499       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921565076800       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921565076487       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921565076005       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921565076009       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921565074557       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921565077585       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921565075586       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921565076789       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921565076205       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+05 is 1.447529e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.615818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7061e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586962e-02 3 1  ON 6
ci_0008                -1.650032e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352969e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823346e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253484e-03 3 1  ON 32
ci_0034                 8.532860e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735565e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549893e-03 3 1  ON 40
ci_0042                 9.454562e-03 3 1  ON 41
ci_0043                -7.796926e-03 3 1  ON 42
ci_0044                -8.255074e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667643e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503994e-03 3 1  ON 48
ci_0050                -2.579678e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310463e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897910e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707061e-03 3 1  ON 62
ci_0064                -9.660030e-03 3 1  ON 63
ci_0065                -6.920376e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717871e-03 3 1  ON 68
ci_0070                 3.465993e-03 3 1  ON 69
ci_0071                 4.079881e-03 3 1  ON 70
ci_0072                 4.253455e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.331371
====================================================
  Execution time = 1.6078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9479e-01
  Total weights = 1.9511e+06
  Execution time = 1.8923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241595953
                                         uncertainty =       0.002200524485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241595953
                                         uncertainty =       0.002200524485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636647
  error estimate for blocks of size 2^( 2) =       0.000394834857
  error estimate for blocks of size 2^( 3) =       0.000412662968
  error estimate for blocks of size 2^( 4) =       0.000428353916
  error estimate for blocks of size 2^( 5) =       0.000441532564
  error estimate for blocks of size 2^( 6) =       0.000450742497
  error estimate for blocks of size 2^( 7) =       0.000455539750

      target function =      -0.920892011087
              le_mean =     -16.897803569021
             les_mean =     285.830550539459
             stat err =       0.000444042182
             autocorr =       1.382611578531
   target nu stat err =       0.000444042182
   target dn stat err =       0.002540438510
      target stat err =       0.004030764654
              std dev =       0.534058868102
             le_variance =       0.285218874599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241589835
                                         uncertainty =       0.002200523870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241589835
                                         uncertainty =       0.002200523870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636643
  error estimate for blocks of size 2^( 2) =       0.000394834853
  error estimate for blocks of size 2^( 3) =       0.000412662963
  error estimate for blocks of size 2^( 4) =       0.000428353912
  error estimate for blocks of size 2^( 5) =       0.000441532558
  error estimate for blocks of size 2^( 6) =       0.000450742492
  error estimate for blocks of size 2^( 7) =       0.000455539744

      target function =      -0.920892010179
              le_mean =     -16.897803568966
             les_mean =     285.830550538202
             stat err =       0.000444042176
             autocorr =       1.382611574481
   target nu stat err =       0.000444042176
   target dn stat err =       0.002540438640
      target stat err =       0.004030764843
              std dev =       0.534058862384
             le_variance =       0.285218868490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241592894
                                         uncertainty =       0.002200524178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241592894
                                         uncertainty =       0.002200524178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636645
  error estimate for blocks of size 2^( 2) =       0.000394834855
  error estimate for blocks of size 2^( 3) =       0.000412662966
  error estimate for blocks of size 2^( 4) =       0.000428353914
  error estimate for blocks of size 2^( 5) =       0.000441532561
  error estimate for blocks of size 2^( 6) =       0.000450742494
  error estimate for blocks of size 2^( 7) =       0.000455539747

      target function =      -0.920892010633
              le_mean =     -16.897803568994
             les_mean =     285.830550538831
             stat err =       0.000444042179
             autocorr =       1.382611576502
   target nu stat err =       0.000444042179
   target dn stat err =       0.002540438575
      target stat err =       0.004030764749
              std dev =       0.534058865243
             le_variance =       0.285218871545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241595570
                                         uncertainty =       0.002200524447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285241595570
                                         uncertainty =       0.002200524447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636647
  error estimate for blocks of size 2^( 2) =       0.000394834857
  error estimate for blocks of size 2^( 3) =       0.000412662968
  error estimate for blocks of size 2^( 4) =       0.000428353916
  error estimate for blocks of size 2^( 5) =       0.000441532563
  error estimate for blocks of size 2^( 6) =       0.000450742497
  error estimate for blocks of size 2^( 7) =       0.000455539750

      target function =      -0.920892011030
              le_mean =     -16.897803569017
             les_mean =     285.830550539381
             stat err =       0.000444042181
             autocorr =       1.382611578271
   target nu stat err =       0.000444042181
   target dn stat err =       0.002540438518
      target stat err =       0.004030764666
              std dev =       0.534058867745
             le_variance =       0.285218874217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920892011087        initial  <--
     2.4414e+04     2.4414e+05             2.3160e-08        -0.920892010179
     9.7656e+04     9.7656e+05             5.7901e-09        -0.920892010633
     3.9062e+05     3.9062e+06             1.4475e-09        -0.920892011030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.6160
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650033e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454562e-03 3 1  ON 41
ci_0043                -7.796925e-03 3 1  ON 42
ci_0044                -8.255072e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667642e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897910e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113113e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920377e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717871e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079881e-03 3 1  ON 70
ci_0072                 4.253456e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.126399
====================================================
  Execution time = 1.4709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8921e-01
  Total weights = 1.951012107e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281641490392
                                         uncertainty =       0.001599479967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281641490392
                                         uncertainty =       0.001599479967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375220431
  error estimate for blocks of size 2^( 2) =       0.000392120062
  error estimate for blocks of size 2^( 3) =       0.000409652209
  error estimate for blocks of size 2^( 4) =       0.000424979404
  error estimate for blocks of size 2^( 5) =       0.000437122011
  error estimate for blocks of size 2^( 6) =       0.000444245251
  error estimate for blocks of size 2^( 7) =       0.000449480295

      target function =      -0.929692840390
              le_mean =     -16.898484190046
             les_mean =     285.847973122588
             stat err =       0.000438956740
             autocorr =       1.368580945462
   target nu stat err =       0.000438956740
   target dn stat err =       0.001909584901
      target stat err =       0.003129100848
              std dev =       0.530641821798
             le_variance =       0.281580743041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689848419005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929702065331       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929702065514       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929702065572       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929702065602       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929702065617       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929702065525       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929702065457       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929702065829       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929702065729       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929702065380       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929702065398       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929702065522       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929702065624       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929702065597       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929702065769       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929702065082       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929702065644       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929702065984       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+05 is 1.630534e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929702065331       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929702065377       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929702065392       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929702065616       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929702064907       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929702065359       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929702064737       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929702066651       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929702065404       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929702064927       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929702066937       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929702067139       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929702065172       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929702066778       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929702066529       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929702066092       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929702063842       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929702064883       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+05 is 4.076336e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929702065331       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929702065343       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929702065346       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929702065348       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929702065349       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929702070290       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929702065350       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929702065350       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929702065350       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929702062886       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929702055328       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929702065350       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929702066369       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929702076139       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929702065350       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929702065350       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929702065350       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929702065350       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+06 is 1.019083e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.626069 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7289e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650032e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881257e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454562e-03 3 1  ON 41
ci_0043                -7.796925e-03 3 1  ON 42
ci_0044                -8.255072e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667642e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503995e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892528e-03 3 1  ON 57
ci_0059                -3.897910e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113113e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920376e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717871e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079881e-03 3 1  ON 70
ci_0072                 4.253456e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.152786
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9327e-01
  Total weights = 1.9509e+06
  Execution time = 1.8831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388511
                                         uncertainty =       0.001697233966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388511
                                         uncertainty =       0.001697233966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377044386
  error estimate for blocks of size 2^( 2) =       0.000394739245
  error estimate for blocks of size 2^( 3) =       0.000413072530
  error estimate for blocks of size 2^( 4) =       0.000428795603
  error estimate for blocks of size 2^( 5) =       0.000439947822
  error estimate for blocks of size 2^( 6) =       0.000447917477
  error estimate for blocks of size 2^( 7) =       0.000452457313

      target function =      -0.923273905927
              le_mean =     -16.898727912686
             les_mean =     285.860272530300
             stat err =       0.000442279554
             autocorr =       1.375969373448
   target nu stat err =       0.000442279554
   target dn stat err =       0.002193894391
      target stat err =       0.003524544152
              std dev =       0.533221284751
             le_variance =       0.284324938511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388106
                                         uncertainty =       0.001697233969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388106
                                         uncertainty =       0.001697233969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377044386
  error estimate for blocks of size 2^( 2) =       0.000394739245
  error estimate for blocks of size 2^( 3) =       0.000413072530
  error estimate for blocks of size 2^( 4) =       0.000428795602
  error estimate for blocks of size 2^( 5) =       0.000439947822
  error estimate for blocks of size 2^( 6) =       0.000447917476
  error estimate for blocks of size 2^( 7) =       0.000452457313

      target function =      -0.923273906463
              le_mean =     -16.898727912670
             les_mean =     285.860272529410
             stat err =       0.000442279553
             autocorr =       1.375969372552
   target nu stat err =       0.000442279553
   target dn stat err =       0.002193894392
      target stat err =       0.003524544158
              std dev =       0.533221284372
             le_variance =       0.284324938108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388308
                                         uncertainty =       0.001697233967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388308
                                         uncertainty =       0.001697233967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377044386
  error estimate for blocks of size 2^( 2) =       0.000394739245
  error estimate for blocks of size 2^( 3) =       0.000413072530
  error estimate for blocks of size 2^( 4) =       0.000428795603
  error estimate for blocks of size 2^( 5) =       0.000439947822
  error estimate for blocks of size 2^( 6) =       0.000447917477
  error estimate for blocks of size 2^( 7) =       0.000452457313

      target function =      -0.923273906195
              le_mean =     -16.898727912678
             les_mean =     285.860272529855
             stat err =       0.000442279554
             autocorr =       1.375969372998
   target nu stat err =       0.000442279554
   target dn stat err =       0.002193894391
      target stat err =       0.003524544155
              std dev =       0.533221284562
             le_variance =       0.284324938310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388485
                                         uncertainty =       0.001697233966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284392388485
                                         uncertainty =       0.001697233966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377044386
  error estimate for blocks of size 2^( 2) =       0.000394739245
  error estimate for blocks of size 2^( 3) =       0.000413072530
  error estimate for blocks of size 2^( 4) =       0.000428795603
  error estimate for blocks of size 2^( 5) =       0.000439947822
  error estimate for blocks of size 2^( 6) =       0.000447917477
  error estimate for blocks of size 2^( 7) =       0.000452457313

      target function =      -0.923273905961
              le_mean =     -16.898727912685
             les_mean =     285.860272530244
             stat err =       0.000442279554
             autocorr =       1.375969373381
   target nu stat err =       0.000442279554
   target dn stat err =       0.002193894391
      target stat err =       0.003524544153
              std dev =       0.533221284727
             le_variance =       0.284324938486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923273905927        initial
     2.4414e+05     2.4414e+06             1.6305e-09        -0.923273906463  <--
     9.7656e+05     9.7656e+06             4.0763e-10        -0.923273906195
     3.9062e+06     3.9062e+07             1.0191e-10        -0.923273905961

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 2.3745e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153874e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650032e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823347e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532860e-03 3 1  ON 33
ci_0035                 4.881257e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454562e-03 3 1  ON 41
ci_0043                -7.796926e-03 3 1  ON 42
ci_0044                -8.255073e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667642e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503996e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839131e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734551e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892527e-03 3 1  ON 57
ci_0059                -3.897910e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660031e-03 3 1  ON 63
ci_0065                -6.920376e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717871e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079880e-03 3 1  ON 70
ci_0072                 4.253456e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1041e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.223133
====================================================
  Execution time = 1.4658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8913e-01
  Total weights = 1.950686315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280815078629
                                         uncertainty =       0.001438115535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280815078629
                                         uncertainty =       0.001438115535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374693391
  error estimate for blocks of size 2^( 2) =       0.000391928996
  error estimate for blocks of size 2^( 3) =       0.000410178438
  error estimate for blocks of size 2^( 4) =       0.000426212645
  error estimate for blocks of size 2^( 5) =       0.000438045946
  error estimate for blocks of size 2^( 6) =       0.000445666053
  error estimate for blocks of size 2^( 7) =       0.000450405478

      target function =      -0.929799098585
              le_mean =     -16.897889196137
             les_mean =     285.827790949980
             stat err =       0.000440082530
             autocorr =       1.379482487170
   target nu stat err =       0.000440082530
   target dn stat err =       0.001884820942
      target stat err =       0.003088644932
              std dev =       0.529896475898
             le_variance =       0.280790275170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689788919614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929807862862       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929807863776       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929807864022       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929807864224       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929807864284       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929807864308       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929807864337       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929807864309       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929807864354       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929807864423       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929807864279       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929807864457       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929807864252       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929807864320       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929807864294       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929807864249       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929807864377       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929807864312       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 8.203581e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929807862862       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929807863091       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929807863152       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929807863203       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929807863218       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929807863127       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929807863071       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929807863043       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929807863449       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929807862962       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929807863616       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929807863594       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929807862546       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929807863441       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929807863498       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929807862609       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929807863162       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929807863436       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+05 is 2.050896e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929807862862       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929807862919       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929807862935       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929807862947       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929807862747       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929807862335       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929807863156       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929807865320       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929807861413       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929807863978       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929807863125       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929807863364       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929807862635       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929807863129       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929807861091       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929807862953       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929807858943       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929807863951       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+05 is 5.127241e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.636185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7220e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586963e-02 3 1  ON 6
ci_0008                -1.650032e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550637e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352970e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113280e-02 3 1  ON 23
ci_0025                -2.823346e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881256e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549894e-03 3 1  ON 40
ci_0042                 9.454562e-03 3 1  ON 41
ci_0043                -7.796928e-03 3 1  ON 42
ci_0044                -8.255074e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667642e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503996e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839130e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734550e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310462e-03 3 1  ON 56
ci_0058                 2.892527e-03 3 1  ON 57
ci_0059                -3.897910e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113114e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707062e-03 3 1  ON 62
ci_0064                -9.660030e-03 3 1  ON 63
ci_0065                -6.920376e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907212e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079880e-03 3 1  ON 70
ci_0072                 4.253455e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.36421
====================================================
  Execution time = 1.4189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9030e-01
  Total weights = 1.9506e+06
  Execution time = 1.8840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459622014
                                         uncertainty =       0.001371941698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459622014
                                         uncertainty =       0.001371941698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375104792
  error estimate for blocks of size 2^( 2) =       0.000392586903
  error estimate for blocks of size 2^( 3) =       0.000410488233
  error estimate for blocks of size 2^( 4) =       0.000425915448
  error estimate for blocks of size 2^( 5) =       0.000437059356
  error estimate for blocks of size 2^( 6) =       0.000445624395
  error estimate for blocks of size 2^( 7) =       0.000449189561

      target function =      -0.927947996883
              le_mean =     -16.897897899141
             les_mean =     285.829251503446
             stat err =       0.000439447190
             autocorr =       1.372486748649
   target nu stat err =       0.000439447190
   target dn stat err =       0.001989366881
      target stat err =       0.003237275958
              std dev =       0.530478283587
             le_variance =       0.281407209358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459620352
                                         uncertainty =       0.001371941668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459620352
                                         uncertainty =       0.001371941668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375104790
  error estimate for blocks of size 2^( 2) =       0.000392586901
  error estimate for blocks of size 2^( 3) =       0.000410488232
  error estimate for blocks of size 2^( 4) =       0.000425915446
  error estimate for blocks of size 2^( 5) =       0.000437059354
  error estimate for blocks of size 2^( 6) =       0.000445624393
  error estimate for blocks of size 2^( 7) =       0.000449189559

      target function =      -0.927947999117
              le_mean =     -16.897897899151
             les_mean =     285.829251502398
             stat err =       0.000439447188
             autocorr =       1.372486743634
   target nu stat err =       0.000439447188
   target dn stat err =       0.001989365939
      target stat err =       0.003237274521
              std dev =       0.530478282023
             le_variance =       0.281407207698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459621183
                                         uncertainty =       0.001371941683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459621183
                                         uncertainty =       0.001371941683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375104791
  error estimate for blocks of size 2^( 2) =       0.000392586902
  error estimate for blocks of size 2^( 3) =       0.000410488233
  error estimate for blocks of size 2^( 4) =       0.000425915447
  error estimate for blocks of size 2^( 5) =       0.000437059355
  error estimate for blocks of size 2^( 6) =       0.000445624394
  error estimate for blocks of size 2^( 7) =       0.000449189560

      target function =      -0.927947998000
              le_mean =     -16.897897899146
             les_mean =     285.829251502922
             stat err =       0.000439447189
             autocorr =       1.372486746150
   target nu stat err =       0.000439447189
   target dn stat err =       0.001989366410
      target stat err =       0.003237275240
              std dev =       0.530478282805
             le_variance =       0.281407208528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459621911
                                         uncertainty =       0.001371941696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281459621911
                                         uncertainty =       0.001371941696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375104792
  error estimate for blocks of size 2^( 2) =       0.000392586902
  error estimate for blocks of size 2^( 3) =       0.000410488233
  error estimate for blocks of size 2^( 4) =       0.000425915448
  error estimate for blocks of size 2^( 5) =       0.000437059356
  error estimate for blocks of size 2^( 6) =       0.000445624395
  error estimate for blocks of size 2^( 7) =       0.000449189561

      target function =      -0.927947997023
              le_mean =     -16.897897899141
             les_mean =     285.829251503381
             stat err =       0.000439447190
             autocorr =       1.372486748334
   target nu stat err =       0.000439447190
   target dn stat err =       0.001989366822
      target stat err =       0.003237275868
              std dev =       0.530478283489
             le_variance =       0.281407209254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927947996883        initial
     6.1035e+04     6.1035e+05             8.2036e-09        -0.927947999117  <--
     2.4414e+05     2.4414e+06             2.0509e-09        -0.927947998000
     9.7656e+05     9.7656e+06             5.1272e-10        -0.927947997023

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 2.3707e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995397e-02 3 1  ON 5
ci_0007                -1.586962e-02 3 1  ON 6
ci_0008                -1.650032e-02 3 1  ON 7
ci_0009                -1.872284e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352969e-02 3 1  ON 20
ci_0022                 1.500267e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113281e-02 3 1  ON 23
ci_0025                -2.823346e-03 3 1  ON 24
ci_0026                -2.392908e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253485e-03 3 1  ON 32
ci_0034                 8.532861e-03 3 1  ON 33
ci_0035                 4.881255e-03 3 1  ON 34
ci_0036                 4.735565e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817585e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549893e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796931e-03 3 1  ON 42
ci_0044                -8.255079e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667643e-03 3 1  ON 45
ci_0047                -3.596710e-03 3 1  ON 46
ci_0048                -3.622716e-03 3 1  ON 47
ci_0049                -2.503996e-03 3 1  ON 48
ci_0050                -2.579678e-03 3 1  ON 49
ci_0051                -1.839130e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849873e-03 3 1  ON 52
ci_0054                -3.734550e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075111e-03 3 1  ON 55
ci_0057                 2.310463e-03 3 1  ON 56
ci_0058                 2.892526e-03 3 1  ON 57
ci_0059                -3.897909e-03 3 1  ON 58
ci_0060                -3.669189e-03 3 1  ON 59
ci_0061                -3.113116e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707061e-03 3 1  ON 62
ci_0064                -9.660030e-03 3 1  ON 63
ci_0065                -6.920376e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907211e-03 3 1  ON 66
ci_0068                -3.850831e-03 3 1  ON 67
ci_0069                 3.717872e-03 3 1  ON 68
ci_0070                 3.465994e-03 3 1  ON 69
ci_0071                 4.079879e-03 3 1  ON 70
ci_0072                 4.253453e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.334374
====================================================
  Execution time = 1.4591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9248e-01
  Total weights = 1.951392685e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282436171450
                                         uncertainty =       0.002129050840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282436171450
                                         uncertainty =       0.002129050840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375788041
  error estimate for blocks of size 2^( 2) =       0.000393180823
  error estimate for blocks of size 2^( 3) =       0.000411248035
  error estimate for blocks of size 2^( 4) =       0.000427264433
  error estimate for blocks of size 2^( 5) =       0.000439975111
  error estimate for blocks of size 2^( 6) =       0.000448288112
  error estimate for blocks of size 2^( 7) =       0.000451802962

      target function =      -0.924493367596
              le_mean =     -16.897857822840
             les_mean =     285.830079785835
             stat err =       0.000441832654
             autocorr =       1.382387215794
   target nu stat err =       0.000441832654
   target dn stat err =       0.002880294181
      target stat err =       0.004587371315
              std dev =       0.531444544757
             le_variance =       0.282433304152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689785782284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924514879347       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924514888470       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924514889430       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924514890162       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924514890573       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924514890696       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924514890713       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924514890694       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924514890695       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924514890706       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924514890736       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924514890719       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924514890731       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924514890673       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924514890730       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924514890700       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924514890750       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924514890704       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 2.715905e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924514879347       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924514881628       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924514881868       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924514882051       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924514882153       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924514882185       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924514882175       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924514882208       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924514882236       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924514882214       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924514882143       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924514882080       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924514882148       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924514882133       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924514882424       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924514882145       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924514882107       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924514882038       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 6.789778e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924514879347       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924514879918       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924514879978       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924514880023       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924514880049       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924514880057       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924514880232       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924514880311       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924514879992       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924514879528       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924514879888       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924514879703       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924514880087       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924514880323       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924514880414       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924514880056       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924514879707       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924514880591       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+05 is 1.697445e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.646404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7150e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137276e-02 3 1  ON 3
ci_0005                -2.891791e-02 3 1  ON 4
ci_0006                -2.995398e-02 3 1  ON 5
ci_0007                -1.586962e-02 3 1  ON 6
ci_0008                -1.650032e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563524e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629425e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373690e-02 3 1  ON 16
ci_0018                 1.393358e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352968e-02 3 1  ON 20
ci_0022                 1.500266e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113281e-02 3 1  ON 23
ci_0025                -2.823344e-03 3 1  ON 24
ci_0026                -2.392908e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253484e-03 3 1  ON 32
ci_0034                 8.532859e-03 3 1  ON 33
ci_0035                 4.881249e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817584e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549893e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796938e-03 3 1  ON 42
ci_0044                -8.255084e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667643e-03 3 1  ON 45
ci_0047                -3.596709e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503994e-03 3 1  ON 48
ci_0050                -2.579678e-03 3 1  ON 49
ci_0051                -1.839129e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849873e-03 3 1  ON 52
ci_0054                -3.734549e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075115e-03 3 1  ON 55
ci_0057                 2.310463e-03 3 1  ON 56
ci_0058                 2.892524e-03 3 1  ON 57
ci_0059                -3.897908e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113116e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707061e-03 3 1  ON 62
ci_0064                -9.660029e-03 3 1  ON 63
ci_0065                -6.920374e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907211e-03 3 1  ON 66
ci_0068                -3.850830e-03 3 1  ON 67
ci_0069                 3.717870e-03 3 1  ON 68
ci_0070                 3.465993e-03 3 1  ON 69
ci_0071                 4.079877e-03 3 1  ON 70
ci_0072                 4.253450e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331466e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8599
    reference variance = 0.163642
====================================================
  Execution time = 1.4324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9531e-01
  Total weights = 1.9511e+06
  Execution time = 1.8967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139371573
                                         uncertainty =       0.003326567165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139371573
                                         uncertainty =       0.003326567165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611839
  error estimate for blocks of size 2^( 2) =       0.000394311258
  error estimate for blocks of size 2^( 3) =       0.000411893771
  error estimate for blocks of size 2^( 4) =       0.000426859417
  error estimate for blocks of size 2^( 5) =       0.000438670356
  error estimate for blocks of size 2^( 6) =       0.000444152462
  error estimate for blocks of size 2^( 7) =       0.000448843546

      target function =      -0.920025618593
              le_mean =     -16.897676241704
             les_mean =     285.826772790391
             stat err =       0.000439631445
             autocorr =       1.355458713543
   target nu stat err =       0.000439631445
   target dn stat err =       0.005006753616
      target stat err =       0.007823879062
              std dev =       0.534023783523
             le_variance =       0.285181401368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139365471
                                         uncertainty =       0.003326567739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139365471
                                         uncertainty =       0.003326567739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611835
  error estimate for blocks of size 2^( 2) =       0.000394311254
  error estimate for blocks of size 2^( 3) =       0.000411893766
  error estimate for blocks of size 2^( 4) =       0.000426859411
  error estimate for blocks of size 2^( 5) =       0.000438670350
  error estimate for blocks of size 2^( 6) =       0.000444152456
  error estimate for blocks of size 2^( 7) =       0.000448843540

      target function =      -0.920025632660
              le_mean =     -16.897676241907
             les_mean =     285.826772788210
             stat err =       0.000439631439
             autocorr =       1.355458705421
   target nu stat err =       0.000439631439
   target dn stat err =       0.005006754335
      target stat err =       0.007823880416
              std dev =       0.534023777817
             le_variance =       0.285181395274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139368522
                                         uncertainty =       0.003326567452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139368522
                                         uncertainty =       0.003326567452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611837
  error estimate for blocks of size 2^( 2) =       0.000394311256
  error estimate for blocks of size 2^( 3) =       0.000411893768
  error estimate for blocks of size 2^( 4) =       0.000426859414
  error estimate for blocks of size 2^( 5) =       0.000438670353
  error estimate for blocks of size 2^( 6) =       0.000444152459
  error estimate for blocks of size 2^( 7) =       0.000448843543

      target function =      -0.920025625627
              le_mean =     -16.897676241806
             les_mean =     285.826772789301
             stat err =       0.000439631442
             autocorr =       1.355458709486
   target nu stat err =       0.000439631442
   target dn stat err =       0.005006753975
      target stat err =       0.007823879739
              std dev =       0.534023780670
             le_variance =       0.285181398321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139371192
                                         uncertainty =       0.003326567201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285139371192
                                         uncertainty =       0.003326567201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611838
  error estimate for blocks of size 2^( 2) =       0.000394311258
  error estimate for blocks of size 2^( 3) =       0.000411893770
  error estimate for blocks of size 2^( 4) =       0.000426859416
  error estimate for blocks of size 2^( 5) =       0.000438670356
  error estimate for blocks of size 2^( 6) =       0.000444152462
  error estimate for blocks of size 2^( 7) =       0.000448843546

      target function =      -0.920025619472
              le_mean =     -16.897676241717
             les_mean =     285.826772790255
             stat err =       0.000439631445
             autocorr =       1.355458713048
   target nu stat err =       0.000439631445
   target dn stat err =       0.005006753661
      target stat err =       0.007823879147
              std dev =       0.534023783166
             le_variance =       0.285181400987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920025618593        initial
     1.5259e+04     1.5259e+05             2.7159e-08        -0.920025632660  <--
     6.1035e+04     6.1035e+05             6.7898e-09        -0.920025625627
     2.4414e+05     2.4414e+06             1.6974e-09        -0.920025619472

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 2.6526e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137275e-02 3 1  ON 3
ci_0005                -2.891792e-02 3 1  ON 4
ci_0006                -2.995398e-02 3 1  ON 5
ci_0007                -1.586961e-02 3 1  ON 6
ci_0008                -1.650031e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352966e-02 3 1  ON 20
ci_0022                 1.500264e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113281e-02 3 1  ON 23
ci_0025                -2.823340e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253481e-03 3 1  ON 32
ci_0034                 8.532853e-03 3 1  ON 33
ci_0035                 4.881230e-03 3 1  ON 34
ci_0036                 4.735569e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817583e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549891e-03 3 1  ON 40
ci_0042                 9.454564e-03 3 1  ON 41
ci_0043                -7.796959e-03 3 1  ON 42
ci_0044                -8.255099e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667645e-03 3 1  ON 45
ci_0047                -3.596707e-03 3 1  ON 46
ci_0048                -3.622720e-03 3 1  ON 47
ci_0049                -2.503988e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839128e-03 3 1  ON 50
ci_0052                -1.721175e-03 3 1  ON 51
ci_0053                -3.849874e-03 3 1  ON 52
ci_0054                -3.734546e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075128e-03 3 1  ON 55
ci_0057                 2.310466e-03 3 1  ON 56
ci_0058                 2.892517e-03 3 1  ON 57
ci_0059                -3.897906e-03 3 1  ON 58
ci_0060                -3.669185e-03 3 1  ON 59
ci_0061                -3.113117e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707059e-03 3 1  ON 62
ci_0064                -9.660028e-03 3 1  ON 63
ci_0065                -6.920371e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907210e-03 3 1  ON 66
ci_0068                -3.850828e-03 3 1  ON 67
ci_0069                 3.717866e-03 3 1  ON 68
ci_0070                 3.465989e-03 3 1  ON 69
ci_0071                 4.079872e-03 3 1  ON 70
ci_0072                 4.253442e-03 3 1  ON 71
ci_0073                 3.372005e-03 3 1  ON 72
ci_0074                 3.331468e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.288467
====================================================
  Execution time = 1.4590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9057e-01
  Total weights = 1.950700591e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282975750043
                                         uncertainty =       0.001769980576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282975750043
                                         uncertainty =       0.001769980576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376162648
  error estimate for blocks of size 2^( 2) =       0.000393197372
  error estimate for blocks of size 2^( 3) =       0.000410775893
  error estimate for blocks of size 2^( 4) =       0.000426822249
  error estimate for blocks of size 2^( 5) =       0.000439871417
  error estimate for blocks of size 2^( 6) =       0.000449121586
  error estimate for blocks of size 2^( 7) =       0.000454143990

      target function =      -0.927527192735
              le_mean =     -16.898615864367
             les_mean =     285.853788331433
             stat err =       0.000442489810
             autocorr =       1.383742279380
   target nu stat err =       0.000442489810
   target dn stat err =       0.002023595733
      target stat err =       0.003292641667
              std dev =       0.531974318190
             le_variance =       0.282996675214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689861586437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927537528087       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927537542390       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927537547301       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927537549281       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927537550023       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927537550193       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927537550289       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927537550286       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927537550242       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927537550249       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927537550280       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927537550308       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927537550306       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927537550309       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927537550319       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927537550321       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927537550312       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927537550311       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 1.212075e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927537528087       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927537531663       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927537532891       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927537533388       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927537533583       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927537533615       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927537533628       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927537533677       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927537533610       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927537533633       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927537533609       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927537533607       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927537533621       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927537533670       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927537533703       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927537533669       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927537533606       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927537533660       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 3.030213e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927537528087       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927537528981       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927537529288       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927537529412       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927537529496       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927537529518       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927537529474       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927537529491       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927537529595       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927537529488       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927537529474       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927537529553       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927537529425       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927537529551       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927537529401       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927537529491       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927537529329       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927537529391       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 7.575548e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.656651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7174e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153872e-02 3 1  ON 2
ci_0004                -3.137275e-02 3 1  ON 3
ci_0005                -2.891793e-02 3 1  ON 4
ci_0006                -2.995398e-02 3 1  ON 5
ci_0007                -1.586960e-02 3 1  ON 6
ci_0008                -1.650030e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550635e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549009e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224396e-02 3 1  ON 19
ci_0021                 1.352964e-02 3 1  ON 20
ci_0022                 1.500262e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113282e-02 3 1  ON 23
ci_0025                -2.823334e-03 3 1  ON 24
ci_0026                -2.392908e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044355e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253476e-03 3 1  ON 32
ci_0034                 8.532856e-03 3 1  ON 33
ci_0035                 4.881222e-03 3 1  ON 34
ci_0036                 4.735566e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817586e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549890e-03 3 1  ON 40
ci_0042                 9.454558e-03 3 1  ON 41
ci_0043                -7.796981e-03 3 1  ON 42
ci_0044                -8.255129e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667648e-03 3 1  ON 45
ci_0047                -3.596707e-03 3 1  ON 46
ci_0048                -3.622720e-03 3 1  ON 47
ci_0049                -2.503994e-03 3 1  ON 48
ci_0050                -2.579678e-03 3 1  ON 49
ci_0051                -1.839129e-03 3 1  ON 50
ci_0052                -1.721175e-03 3 1  ON 51
ci_0053                -3.849869e-03 3 1  ON 52
ci_0054                -3.734540e-03 3 1  ON 53
ci_0055                 2.334096e-03 3 1  ON 54
ci_0056                 2.075137e-03 3 1  ON 55
ci_0057                 2.310468e-03 3 1  ON 56
ci_0058                 2.892515e-03 3 1  ON 57
ci_0059                -3.897904e-03 3 1  ON 58
ci_0060                -3.669183e-03 3 1  ON 59
ci_0061                -3.113122e-03 3 1  ON 60
ci_0062                -3.326491e-03 3 1  ON 61
ci_0063                -9.707060e-03 3 1  ON 62
ci_0064                -9.660027e-03 3 1  ON 63
ci_0065                -6.920368e-03 3 1  ON 64
ci_0066                -6.464935e-03 3 1  ON 65
ci_0067                -3.907204e-03 3 1  ON 66
ci_0068                -3.850832e-03 3 1  ON 67
ci_0069                 3.717863e-03 3 1  ON 68
ci_0070                 3.465987e-03 3 1  ON 69
ci_0071                 4.079867e-03 3 1  ON 70
ci_0072                 4.253438e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.229112
====================================================
  Execution time = 1.4260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9476e-01
  Total weights = 1.9510e+06
  Execution time = 1.8687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720153429
                                         uncertainty =       0.003208312368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720153429
                                         uncertainty =       0.003208312368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376649169
  error estimate for blocks of size 2^( 2) =       0.000393901124
  error estimate for blocks of size 2^( 3) =       0.000411597005
  error estimate for blocks of size 2^( 4) =       0.000426936891
  error estimate for blocks of size 2^( 5) =       0.000438643447
  error estimate for blocks of size 2^( 6) =       0.000446366715
  error estimate for blocks of size 2^( 7) =       0.000451924865

      target function =      -0.920905875921
              le_mean =     -16.898106514893
             les_mean =     285.840760286994
             stat err =       0.000440967979
             autocorr =       1.370692643557
   target nu stat err =       0.000440967979
   target dn stat err =       0.004274514168
      target stat err =       0.006709005284
              std dev =       0.532662363100
             le_variance =       0.283729193063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720123101
                                         uncertainty =       0.003208311850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720123101
                                         uncertainty =       0.003208311850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376649149
  error estimate for blocks of size 2^( 2) =       0.000393901102
  error estimate for blocks of size 2^( 3) =       0.000411596980
  error estimate for blocks of size 2^( 4) =       0.000426936863
  error estimate for blocks of size 2^( 5) =       0.000438643415
  error estimate for blocks of size 2^( 6) =       0.000446366684
  error estimate for blocks of size 2^( 7) =       0.000451924831

      target function =      -0.920898481407
              le_mean =     -16.898106515728
             les_mean =     285.840765056351
             stat err =       0.000440967948
             autocorr =       1.370692597838
   target nu stat err =       0.000440967948
   target dn stat err =       0.004274523106
      target stat err =       0.006708912066
              std dev =       0.532662334644
             le_variance =       0.283729162749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720138265
                                         uncertainty =       0.003208312109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720138265
                                         uncertainty =       0.003208312109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376649159
  error estimate for blocks of size 2^( 2) =       0.000393901113
  error estimate for blocks of size 2^( 3) =       0.000411596993
  error estimate for blocks of size 2^( 4) =       0.000426936877
  error estimate for blocks of size 2^( 5) =       0.000438643431
  error estimate for blocks of size 2^( 6) =       0.000446366700
  error estimate for blocks of size 2^( 7) =       0.000451924848

      target function =      -0.920902998651
              le_mean =     -16.898106515311
             les_mean =     285.840762145925
             stat err =       0.000440967964
             autocorr =       1.370692620697
   target nu stat err =       0.000440967964
   target dn stat err =       0.004274517000
      target stat err =       0.006708968011
              std dev =       0.532662348872
             le_variance =       0.283729177906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720151533
                                         uncertainty =       0.003208312336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283720151533
                                         uncertainty =       0.003208312336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376649168
  error estimate for blocks of size 2^( 2) =       0.000393901123
  error estimate for blocks of size 2^( 3) =       0.000411597003
  error estimate for blocks of size 2^( 4) =       0.000426936889
  error estimate for blocks of size 2^( 5) =       0.000438643445
  error estimate for blocks of size 2^( 6) =       0.000446366713
  error estimate for blocks of size 2^( 7) =       0.000451924863

      target function =      -0.920905576465
              le_mean =     -16.898106514946
             les_mean =     285.840760480760
             stat err =       0.000440967977
             autocorr =       1.370692640705
   target nu stat err =       0.000440967977
   target dn stat err =       0.004274514423
      target stat err =       0.006709001344
              std dev =       0.532662361321
             le_variance =       0.283729191168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920905875921        initial  <--
     3.8147e+03     3.8147e+04             1.2121e-07        -0.920898481407
     1.5259e+04     1.5259e+05             3.0302e-08        -0.920902998651
     6.1035e+04     6.1035e+05             7.5755e-09        -0.920905576465

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6997
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137275e-02 3 1  ON 3
ci_0005                -2.891792e-02 3 1  ON 4
ci_0006                -2.995398e-02 3 1  ON 5
ci_0007                -1.586961e-02 3 1  ON 6
ci_0008                -1.650031e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352966e-02 3 1  ON 20
ci_0022                 1.500264e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113281e-02 3 1  ON 23
ci_0025                -2.823340e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253481e-03 3 1  ON 32
ci_0034                 8.532853e-03 3 1  ON 33
ci_0035                 4.881230e-03 3 1  ON 34
ci_0036                 4.735569e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817583e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549891e-03 3 1  ON 40
ci_0042                 9.454564e-03 3 1  ON 41
ci_0043                -7.796959e-03 3 1  ON 42
ci_0044                -8.255099e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667645e-03 3 1  ON 45
ci_0047                -3.596707e-03 3 1  ON 46
ci_0048                -3.622720e-03 3 1  ON 47
ci_0049                -2.503988e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839128e-03 3 1  ON 50
ci_0052                -1.721175e-03 3 1  ON 51
ci_0053                -3.849874e-03 3 1  ON 52
ci_0054                -3.734546e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075128e-03 3 1  ON 55
ci_0057                 2.310466e-03 3 1  ON 56
ci_0058                 2.892517e-03 3 1  ON 57
ci_0059                -3.897906e-03 3 1  ON 58
ci_0060                -3.669185e-03 3 1  ON 59
ci_0061                -3.113117e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707059e-03 3 1  ON 62
ci_0064                -9.660028e-03 3 1  ON 63
ci_0065                -6.920371e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907210e-03 3 1  ON 66
ci_0068                -3.850828e-03 3 1  ON 67
ci_0069                 3.717866e-03 3 1  ON 68
ci_0070                 3.465989e-03 3 1  ON 69
ci_0071                 4.079872e-03 3 1  ON 70
ci_0072                 4.253442e-03 3 1  ON 71
ci_0073                 3.372005e-03 3 1  ON 72
ci_0074                 3.331468e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.376831
====================================================
  Execution time = 1.4630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9217e-01
  Total weights = 1.950980546e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282096583015
                                         uncertainty =       0.001795563049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282096583015
                                         uncertainty =       0.001795563049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375568673
  error estimate for blocks of size 2^( 2) =       0.000392509854
  error estimate for blocks of size 2^( 3) =       0.000410097774
  error estimate for blocks of size 2^( 4) =       0.000425468775
  error estimate for blocks of size 2^( 5) =       0.000437245082
  error estimate for blocks of size 2^( 6) =       0.000444348452
  error estimate for blocks of size 2^( 7) =       0.000446591442

      target function =      -0.924980731310
              le_mean =     -16.897598326247
             les_mean =     285.821002166917
             stat err =       0.000438413437
             autocorr =       1.362664661947
   target nu stat err =       0.000438413437
   target dn stat err =       0.002434642076
      target stat err =       0.003899328513
              std dev =       0.531134311600
             le_variance =       0.282103656958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689759832625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924995860933       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924995862031       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924995862473       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924995862696       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924995862788       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924995862827       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924995862819       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924995862836       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924995862843       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924995862709       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924995862900       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924995862748       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924995862868       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924995862669       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924995862869       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924995862894       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924995862939       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924995862869       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.123715e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924995860933       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924995861207       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924995861318       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924995861370       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924995861439       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924995861210       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924995861642       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924995861429       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924995861139       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924995861499       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924995861167       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924995861285       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924995861577       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924995861138       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924995861112       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924995861689       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924995861665       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924995861242       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+05 is 2.809291e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924995860933       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924995861001       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924995861029       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924995861042       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924995861049       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924995861407       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924995860401       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924995861028       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924995860373       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924995862094       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924995862078       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924995860963       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924995861491       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924995861048       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924995861211       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924995860768       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924995860511       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924995860244       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+05 is 7.023228e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.666913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7201e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153873e-02 3 1  ON 2
ci_0004                -3.137275e-02 3 1  ON 3
ci_0005                -2.891792e-02 3 1  ON 4
ci_0006                -2.995398e-02 3 1  ON 5
ci_0007                -1.586961e-02 3 1  ON 6
ci_0008                -1.650031e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224395e-02 3 1  ON 19
ci_0021                 1.352966e-02 3 1  ON 20
ci_0022                 1.500264e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113281e-02 3 1  ON 23
ci_0025                -2.823340e-03 3 1  ON 24
ci_0026                -2.392909e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253480e-03 3 1  ON 32
ci_0034                 8.532853e-03 3 1  ON 33
ci_0035                 4.881231e-03 3 1  ON 34
ci_0036                 4.735569e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817583e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549891e-03 3 1  ON 40
ci_0042                 9.454564e-03 3 1  ON 41
ci_0043                -7.796960e-03 3 1  ON 42
ci_0044                -8.255102e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667645e-03 3 1  ON 45
ci_0047                -3.596707e-03 3 1  ON 46
ci_0048                -3.622720e-03 3 1  ON 47
ci_0049                -2.503988e-03 3 1  ON 48
ci_0050                -2.579677e-03 3 1  ON 49
ci_0051                -1.839128e-03 3 1  ON 50
ci_0052                -1.721175e-03 3 1  ON 51
ci_0053                -3.849873e-03 3 1  ON 52
ci_0054                -3.734547e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075128e-03 3 1  ON 55
ci_0057                 2.310466e-03 3 1  ON 56
ci_0058                 2.892517e-03 3 1  ON 57
ci_0059                -3.897905e-03 3 1  ON 58
ci_0060                -3.669186e-03 3 1  ON 59
ci_0061                -3.113118e-03 3 1  ON 60
ci_0062                -3.326484e-03 3 1  ON 61
ci_0063                -9.707059e-03 3 1  ON 62
ci_0064                -9.660027e-03 3 1  ON 63
ci_0065                -6.920370e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907210e-03 3 1  ON 66
ci_0068                -3.850828e-03 3 1  ON 67
ci_0069                 3.717866e-03 3 1  ON 68
ci_0070                 3.465989e-03 3 1  ON 69
ci_0071                 4.079872e-03 3 1  ON 70
ci_0072                 4.253442e-03 3 1  ON 71
ci_0073                 3.372005e-03 3 1  ON 72
ci_0074                 3.331468e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8944
    reference variance = 0.255716
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9664e-01
  Total weights = 1.9509e+06
  Execution time = 1.8923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460400197
                                         uncertainty =       0.002026753876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460400197
                                         uncertainty =       0.002026753876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377258581
  error estimate for blocks of size 2^( 2) =       0.000394366389
  error estimate for blocks of size 2^( 3) =       0.000411799819
  error estimate for blocks of size 2^( 4) =       0.000427342220
  error estimate for blocks of size 2^( 5) =       0.000437241412
  error estimate for blocks of size 2^( 6) =       0.000443722925
  error estimate for blocks of size 2^( 7) =       0.000444281777

      target function =      -0.917995619438
              le_mean =     -16.898522226318
             les_mean =     285.856693221023
             stat err =       0.000438147084
             autocorr =       1.348843601119
   target nu stat err =       0.000438147084
   target dn stat err =       0.003331947271
      target stat err =       0.005220905298
              std dev =       0.533524202261
             le_variance =       0.284648074399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460397307
                                         uncertainty =       0.002026753772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460397307
                                         uncertainty =       0.002026753772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377258579
  error estimate for blocks of size 2^( 2) =       0.000394366387
  error estimate for blocks of size 2^( 3) =       0.000411799817
  error estimate for blocks of size 2^( 4) =       0.000427342217
  error estimate for blocks of size 2^( 5) =       0.000437241409
  error estimate for blocks of size 2^( 6) =       0.000443722922
  error estimate for blocks of size 2^( 7) =       0.000444281774

      target function =      -0.917995712990
              le_mean =     -16.898522226403
             les_mean =     285.856693163571
             stat err =       0.000438147081
             autocorr =       1.348843595972
   target nu stat err =       0.000438147081
   target dn stat err =       0.003331945870
      target stat err =       0.005220904200
              std dev =       0.533524199556
             le_variance =       0.284648071512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460398752
                                         uncertainty =       0.002026753824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460398752
                                         uncertainty =       0.002026753824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377258580
  error estimate for blocks of size 2^( 2) =       0.000394366388
  error estimate for blocks of size 2^( 3) =       0.000411799818
  error estimate for blocks of size 2^( 4) =       0.000427342218
  error estimate for blocks of size 2^( 5) =       0.000437241411
  error estimate for blocks of size 2^( 6) =       0.000443722923
  error estimate for blocks of size 2^( 7) =       0.000444281776

      target function =      -0.917995666228
              le_mean =     -16.898522226361
             les_mean =     285.856693192288
             stat err =       0.000438147082
             autocorr =       1.348843598540
   target nu stat err =       0.000438147082
   target dn stat err =       0.003331946571
      target stat err =       0.005220904748
              std dev =       0.533524200909
             le_variance =       0.284648072955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460400016
                                         uncertainty =       0.002026753870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284460400016
                                         uncertainty =       0.002026753870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377258581
  error estimate for blocks of size 2^( 2) =       0.000394366389
  error estimate for blocks of size 2^( 3) =       0.000411799819
  error estimate for blocks of size 2^( 4) =       0.000427342219
  error estimate for blocks of size 2^( 5) =       0.000437241412
  error estimate for blocks of size 2^( 6) =       0.000443722925
  error estimate for blocks of size 2^( 7) =       0.000444281777

      target function =      -0.917995625288
              le_mean =     -16.898522226324
             les_mean =     285.856693217430
             stat err =       0.000438147083
             autocorr =       1.348843600799
   target nu stat err =       0.000438147083
   target dn stat err =       0.003331947184
      target stat err =       0.005220905229
              std dev =       0.533524202092
             le_variance =       0.284648074218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917995619438        initial
     3.8147e+04     3.8147e+05             1.1237e-08        -0.917995712990  <--
     1.5259e+05     1.5259e+06             2.8093e-09        -0.917995666228
     6.1035e+05     6.1035e+06             7.0232e-10        -0.917995625288

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.3740e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153872e-02 3 1  ON 2
ci_0004                -3.137275e-02 3 1  ON 3
ci_0005                -2.891793e-02 3 1  ON 4
ci_0006                -2.995399e-02 3 1  ON 5
ci_0007                -1.586961e-02 3 1  ON 6
ci_0008                -1.650031e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888046e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549010e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224396e-02 3 1  ON 19
ci_0021                 1.352966e-02 3 1  ON 20
ci_0022                 1.500263e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113282e-02 3 1  ON 23
ci_0025                -2.823338e-03 3 1  ON 24
ci_0026                -2.392910e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253478e-03 3 1  ON 32
ci_0034                 8.532851e-03 3 1  ON 33
ci_0035                 4.881233e-03 3 1  ON 34
ci_0036                 4.735570e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817582e-03 3 1  ON 38
ci_0040                -3.939114e-03 3 1  ON 39
ci_0041                 9.549890e-03 3 1  ON 40
ci_0042                 9.454563e-03 3 1  ON 41
ci_0043                -7.796966e-03 3 1  ON 42
ci_0044                -8.255110e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667645e-03 3 1  ON 45
ci_0047                -3.596708e-03 3 1  ON 46
ci_0048                -3.622719e-03 3 1  ON 47
ci_0049                -2.503989e-03 3 1  ON 48
ci_0050                -2.579676e-03 3 1  ON 49
ci_0051                -1.839128e-03 3 1  ON 50
ci_0052                -1.721175e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734548e-03 3 1  ON 53
ci_0055                 2.334098e-03 3 1  ON 54
ci_0056                 2.075130e-03 3 1  ON 55
ci_0057                 2.310466e-03 3 1  ON 56
ci_0058                 2.892516e-03 3 1  ON 57
ci_0059                -3.897904e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.113120e-03 3 1  ON 60
ci_0062                -3.326485e-03 3 1  ON 61
ci_0063                -9.707059e-03 3 1  ON 62
ci_0064                -9.660026e-03 3 1  ON 63
ci_0065                -6.920369e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907210e-03 3 1  ON 66
ci_0068                -3.850827e-03 3 1  ON 67
ci_0069                 3.717865e-03 3 1  ON 68
ci_0070                 3.465989e-03 3 1  ON 69
ci_0071                 4.079873e-03 3 1  ON 70
ci_0072                 4.253442e-03 3 1  ON 71
ci_0073                 3.372005e-03 3 1  ON 72
ci_0074                 3.331467e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.22896
====================================================
  Execution time = 1.4710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9063e-01
  Total weights = 1.951154818e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282149543145
                                         uncertainty =       0.002423904321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282149543145
                                         uncertainty =       0.002423904321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375595000
  error estimate for blocks of size 2^( 2) =       0.000393048310
  error estimate for blocks of size 2^( 3) =       0.000410485332
  error estimate for blocks of size 2^( 4) =       0.000426019350
  error estimate for blocks of size 2^( 5) =       0.000438280603
  error estimate for blocks of size 2^( 6) =       0.000445843624
  error estimate for blocks of size 2^( 7) =       0.000449111649

      target function =      -0.927432721918
              le_mean =     -16.898927858391
             les_mean =     285.864389876883
             stat err =       0.000439813806
             autocorr =       1.371191498384
   target nu stat err =       0.000439813806
   target dn stat err =       0.002685066491
      target stat err =       0.004319818212
              std dev =       0.531171543294
             le_variance =       0.282143208405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689892785839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927451313322       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927451319742       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927451321337       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927451322208       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927451322729       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927451322877       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927451323001       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927451323030       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927451323034       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927451323053       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927451323050       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927451323084       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927451323095       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927451323101       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927451323098       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927451323106       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927451323087       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927451323079       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 4.359224e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927451313322       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927451314927       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927451315326       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927451315544       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927451315625       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927451315746       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927451315769       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927451315748       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927451315768       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927451315691       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927451315666       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927451315763       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927451315759       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927451315744       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927451315781       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927451315760       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927451315778       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927451315717       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.089810e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927451313322       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927451313723       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927451313823       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927451313873       residual = 8.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927451313912       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927451314146       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927451314041       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927451313797       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927451313978       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927451313746       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927451314118       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927451313897       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927451314036       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927451313980       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927451314177       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927451313954       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927451313990       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927451313830       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+05 is 2.724526e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.677033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7269e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153872e-02 3 1  ON 2
ci_0004                -3.137275e-02 3 1  ON 3
ci_0005                -2.891793e-02 3 1  ON 4
ci_0006                -2.995399e-02 3 1  ON 5
ci_0007                -1.586960e-02 3 1  ON 6
ci_0008                -1.650030e-02 3 1  ON 7
ci_0009                -1.872283e-02 3 1  ON 8
ci_0010                -1.888045e-02 3 1  ON 9
ci_0011                -1.550636e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549009e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629424e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373689e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259657e-02 3 1  ON 18
ci_0020                 1.224396e-02 3 1  ON 19
ci_0021                 1.352964e-02 3 1  ON 20
ci_0022                 1.500262e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113282e-02 3 1  ON 23
ci_0025                -2.823337e-03 3 1  ON 24
ci_0026                -2.392911e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253475e-03 3 1  ON 32
ci_0034                 8.532849e-03 3 1  ON 33
ci_0035                 4.881235e-03 3 1  ON 34
ci_0036                 4.735571e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817582e-03 3 1  ON 38
ci_0040                -3.939115e-03 3 1  ON 39
ci_0041                 9.549891e-03 3 1  ON 40
ci_0042                 9.454564e-03 3 1  ON 41
ci_0043                -7.796970e-03 3 1  ON 42
ci_0044                -8.255118e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667646e-03 3 1  ON 45
ci_0047                -3.596708e-03 3 1  ON 46
ci_0048                -3.622719e-03 3 1  ON 47
ci_0049                -2.503989e-03 3 1  ON 48
ci_0050                -2.579680e-03 3 1  ON 49
ci_0051                -1.839129e-03 3 1  ON 50
ci_0052                -1.721177e-03 3 1  ON 51
ci_0053                -3.849871e-03 3 1  ON 52
ci_0054                -3.734547e-03 3 1  ON 53
ci_0055                 2.334098e-03 3 1  ON 54
ci_0056                 2.075128e-03 3 1  ON 55
ci_0057                 2.310465e-03 3 1  ON 56
ci_0058                 2.892516e-03 3 1  ON 57
ci_0059                -3.897904e-03 3 1  ON 58
ci_0060                -3.669188e-03 3 1  ON 59
ci_0061                -3.113123e-03 3 1  ON 60
ci_0062                -3.326487e-03 3 1  ON 61
ci_0063                -9.707057e-03 3 1  ON 62
ci_0064                -9.660026e-03 3 1  ON 63
ci_0065                -6.920368e-03 3 1  ON 64
ci_0066                -6.464937e-03 3 1  ON 65
ci_0067                -3.907208e-03 3 1  ON 66
ci_0068                -3.850825e-03 3 1  ON 67
ci_0069                 3.717862e-03 3 1  ON 68
ci_0070                 3.465988e-03 3 1  ON 69
ci_0071                 4.079869e-03 3 1  ON 70
ci_0072                 4.253439e-03 3 1  ON 71
ci_0073                 3.372004e-03 3 1  ON 72
ci_0074                 3.331465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8134
    reference variance = 0.346122
====================================================
  Execution time = 1.4317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9580e-01
  Total weights = 1.9506e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810218041
                                         uncertainty =       0.002134807966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810218041
                                         uncertainty =       0.002134807966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376723472
  error estimate for blocks of size 2^( 2) =       0.000394015377
  error estimate for blocks of size 2^( 3) =       0.000412030540
  error estimate for blocks of size 2^( 4) =       0.000428052528
  error estimate for blocks of size 2^( 5) =       0.000440152574
  error estimate for blocks of size 2^( 6) =       0.000446802166
  error estimate for blocks of size 2^( 7) =       0.000452321068

      target function =      -0.919302313895
              le_mean =     -16.898329620885
             les_mean =     285.849344836153
             stat err =       0.000441832084
             autocorr =       1.375527063177
   target nu stat err =       0.000441832084
   target dn stat err =       0.003142797318
      target stat err =       0.004943713457
              std dev =       0.532767443081
             le_variance =       0.283841148407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810203779
                                         uncertainty =       0.002134806023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810203779
                                         uncertainty =       0.002134806023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376723462
  error estimate for blocks of size 2^( 2) =       0.000394015366
  error estimate for blocks of size 2^( 3) =       0.000412030529
  error estimate for blocks of size 2^( 4) =       0.000428052516
  error estimate for blocks of size 2^( 5) =       0.000440152562
  error estimate for blocks of size 2^( 6) =       0.000446802153
  error estimate for blocks of size 2^( 7) =       0.000452321055

      target function =      -0.919303071116
              le_mean =     -16.898329620854
             les_mean =     285.849344348531
             stat err =       0.000441832072
             autocorr =       1.375527053405
   target nu stat err =       0.000441832072
   target dn stat err =       0.003142757620
      target stat err =       0.004943660482
              std dev =       0.532767429690
             le_variance =       0.283841134139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810210910
                                         uncertainty =       0.002134806994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810210910
                                         uncertainty =       0.002134806994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376723467
  error estimate for blocks of size 2^( 2) =       0.000394015372
  error estimate for blocks of size 2^( 3) =       0.000412030535
  error estimate for blocks of size 2^( 4) =       0.000428052522
  error estimate for blocks of size 2^( 5) =       0.000440152568
  error estimate for blocks of size 2^( 6) =       0.000446802160
  error estimate for blocks of size 2^( 7) =       0.000452321062

      target function =      -0.919302692787
              le_mean =     -16.898329620869
             les_mean =     285.849344592161
             stat err =       0.000441832078
             autocorr =       1.375527058292
   target nu stat err =       0.000441832078
   target dn stat err =       0.003142777450
      target stat err =       0.004943686942
              std dev =       0.532767436386
             le_variance =       0.283841141273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810217149
                                         uncertainty =       0.002134807844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283810217149
                                         uncertainty =       0.002134807844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376723471
  error estimate for blocks of size 2^( 2) =       0.000394015376
  error estimate for blocks of size 2^( 3) =       0.000412030540
  error estimate for blocks of size 2^( 4) =       0.000428052528
  error estimate for blocks of size 2^( 5) =       0.000440152573
  error estimate for blocks of size 2^( 6) =       0.000446802165
  error estimate for blocks of size 2^( 7) =       0.000452321067

      target function =      -0.919302361287
              le_mean =     -16.898329620883
             les_mean =     285.849344805634
             stat err =       0.000441832083
             autocorr =       1.375527062561
   target nu stat err =       0.000441832083
   target dn stat err =       0.003142794833
      target stat err =       0.004943710139
              std dev =       0.532767442245
             le_variance =       0.283841147516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919302313895        initial
     9.5367e+03     9.5367e+04             4.3592e-08        -0.919303071116  <--
     3.8147e+04     3.8147e+05             1.0898e-08        -0.919302692787
     1.5259e+05     1.5259e+06             2.7245e-09        -0.919302361287

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.3807e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153871e-02 3 1  ON 2
ci_0004                -3.137274e-02 3 1  ON 3
ci_0005                -2.891793e-02 3 1  ON 4
ci_0006                -2.995400e-02 3 1  ON 5
ci_0007                -1.586960e-02 3 1  ON 6
ci_0008                -1.650029e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888045e-02 3 1  ON 9
ci_0011                -1.550635e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549009e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629423e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373688e-02 3 1  ON 16
ci_0018                 1.393357e-02 3 1  ON 17
ci_0019                 1.259658e-02 3 1  ON 18
ci_0020                 1.224396e-02 3 1  ON 19
ci_0021                 1.352961e-02 3 1  ON 20
ci_0022                 1.500259e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113282e-02 3 1  ON 23
ci_0025                -2.823337e-03 3 1  ON 24
ci_0026                -2.392911e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036571e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253468e-03 3 1  ON 32
ci_0034                 8.532841e-03 3 1  ON 33
ci_0035                 4.881244e-03 3 1  ON 34
ci_0036                 4.735573e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130896e-02 3 1  ON 37
ci_0039                -3.817582e-03 3 1  ON 38
ci_0040                -3.939115e-03 3 1  ON 39
ci_0041                 9.549891e-03 3 1  ON 40
ci_0042                 9.454567e-03 3 1  ON 41
ci_0043                -7.796985e-03 3 1  ON 42
ci_0044                -8.255143e-03 3 1  ON 43
ci_0045                 1.041901e-02 3 1  ON 44
ci_0046                 9.667649e-03 3 1  ON 45
ci_0047                -3.596707e-03 3 1  ON 46
ci_0048                -3.622719e-03 3 1  ON 47
ci_0049                -2.503989e-03 3 1  ON 48
ci_0050                -2.579691e-03 3 1  ON 49
ci_0051                -1.839130e-03 3 1  ON 50
ci_0052                -1.721180e-03 3 1  ON 51
ci_0053                -3.849865e-03 3 1  ON 52
ci_0054                -3.734544e-03 3 1  ON 53
ci_0055                 2.334098e-03 3 1  ON 54
ci_0056                 2.075123e-03 3 1  ON 55
ci_0057                 2.310460e-03 3 1  ON 56
ci_0058                 2.892516e-03 3 1  ON 57
ci_0059                -3.897904e-03 3 1  ON 58
ci_0060                -3.669192e-03 3 1  ON 59
ci_0061                -3.113133e-03 3 1  ON 60
ci_0062                -3.326492e-03 3 1  ON 61
ci_0063                -9.707054e-03 3 1  ON 62
ci_0064                -9.660024e-03 3 1  ON 63
ci_0065                -6.920364e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907201e-03 3 1  ON 66
ci_0068                -3.850819e-03 3 1  ON 67
ci_0069                 3.717854e-03 3 1  ON 68
ci_0070                 3.465986e-03 3 1  ON 69
ci_0071                 4.079859e-03 3 1  ON 70
ci_0072                 4.253429e-03 3 1  ON 71
ci_0073                 3.372003e-03 3 1  ON 72
ci_0074                 3.331458e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.354574
====================================================
  Execution time = 1.4678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9379e-01
  Total weights = 1.950879923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283554824781
                                         uncertainty =       0.002058655342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283554824781
                                         uncertainty =       0.002058655342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376512704
  error estimate for blocks of size 2^( 2) =       0.000393675612
  error estimate for blocks of size 2^( 3) =       0.000411094477
  error estimate for blocks of size 2^( 4) =       0.000426618523
  error estimate for blocks of size 2^( 5) =       0.000438634286
  error estimate for blocks of size 2^( 6) =       0.000446738136
  error estimate for blocks of size 2^( 7) =       0.000449826482

      target function =      -0.922446459059
              le_mean =     -16.898332716320
             les_mean =     285.847437770932
             stat err =       0.000440454357
             autocorr =       1.368492911557
   target nu stat err =       0.000440454357
   target dn stat err =       0.002764357952
      target stat err =       0.004391984720
              std dev =       0.532469371968
             le_variance =       0.283523632084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689833271632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922466212265       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922466237874       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922466244480       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922466249138       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922466250453       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922466250816       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922466251041       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922466251124       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922466251158       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922466251183       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922466251187       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922466251200       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922466251220       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922466251209       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922466251204       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922466251208       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922466251199       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922466251203       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 1.782078e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922466212265       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922466218667       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922466220319       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922466221484       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922466221799       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922466221895       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922466221973       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922466221993       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922466222001       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922466221991       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922466221978       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922466221978       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922466222019       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922466221995       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922466221970       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922466221994       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922466221986       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922466221991       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 4.455253e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922466212265       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922466213865       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922466214278       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922466214569       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922466214652       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922466214674       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922466214668       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922466214727       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922466214696       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922466214568       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922466214735       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922466214701       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922466214673       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922466214735       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922466214683       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922466214679       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922466214691       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922466214631       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.113817e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.687195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7241e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153871e-02 3 1  ON 2
ci_0004                -3.137273e-02 3 1  ON 3
ci_0005                -2.891794e-02 3 1  ON 4
ci_0006                -2.995401e-02 3 1  ON 5
ci_0007                -1.586958e-02 3 1  ON 6
ci_0008                -1.650028e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888044e-02 3 1  ON 9
ci_0011                -1.550634e-02 3 1  ON 10
ci_0012                -1.563523e-02 3 1  ON 11
ci_0013                 1.549008e-02 3 1  ON 12
ci_0014                 1.537521e-02 3 1  ON 13
ci_0015                 1.629423e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373688e-02 3 1  ON 16
ci_0018                 1.393356e-02 3 1  ON 17
ci_0019                 1.259658e-02 3 1  ON 18
ci_0020                 1.224396e-02 3 1  ON 19
ci_0021                 1.352957e-02 3 1  ON 20
ci_0022                 1.500256e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113282e-02 3 1  ON 23
ci_0025                -2.823331e-03 3 1  ON 24
ci_0026                -2.392926e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253468e-03 3 1  ON 32
ci_0034                 8.532834e-03 3 1  ON 33
ci_0035                 4.881247e-03 3 1  ON 34
ci_0036                 4.735573e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817580e-03 3 1  ON 38
ci_0040                -3.939113e-03 3 1  ON 39
ci_0041                 9.549884e-03 3 1  ON 40
ci_0042                 9.454560e-03 3 1  ON 41
ci_0043                -7.797010e-03 3 1  ON 42
ci_0044                -8.255184e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667659e-03 3 1  ON 45
ci_0047                -3.596711e-03 3 1  ON 46
ci_0048                -3.622717e-03 3 1  ON 47
ci_0049                -2.503999e-03 3 1  ON 48
ci_0050                -2.579696e-03 3 1  ON 49
ci_0051                -1.839134e-03 3 1  ON 50
ci_0052                -1.721184e-03 3 1  ON 51
ci_0053                -3.849866e-03 3 1  ON 52
ci_0054                -3.734538e-03 3 1  ON 53
ci_0055                 2.334099e-03 3 1  ON 54
ci_0056                 2.075122e-03 3 1  ON 55
ci_0057                 2.310469e-03 3 1  ON 56
ci_0058                 2.892512e-03 3 1  ON 57
ci_0059                -3.897904e-03 3 1  ON 58
ci_0060                -3.669193e-03 3 1  ON 59
ci_0061                -3.113134e-03 3 1  ON 60
ci_0062                -3.326500e-03 3 1  ON 61
ci_0063                -9.707046e-03 3 1  ON 62
ci_0064                -9.660027e-03 3 1  ON 63
ci_0065                -6.920353e-03 3 1  ON 64
ci_0066                -6.464943e-03 3 1  ON 65
ci_0067                -3.907198e-03 3 1  ON 66
ci_0068                -3.850809e-03 3 1  ON 67
ci_0069                 3.717849e-03 3 1  ON 68
ci_0070                 3.465987e-03 3 1  ON 69
ci_0071                 4.079852e-03 3 1  ON 70
ci_0072                 4.253404e-03 3 1  ON 71
ci_0073                 3.371996e-03 3 1  ON 72
ci_0074                 3.331464e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.015
    reference variance = 1.28156
====================================================
  Execution time = 1.4330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9136e-01
  Total weights = 1.9510e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230638077
                                         uncertainty =       0.001865657487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230638077
                                         uncertainty =       0.001865657487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141535
  error estimate for blocks of size 2^( 2) =       0.000392787505
  error estimate for blocks of size 2^( 3) =       0.000410947856
  error estimate for blocks of size 2^( 4) =       0.000427336782
  error estimate for blocks of size 2^( 5) =       0.000439969406
  error estimate for blocks of size 2^( 6) =       0.000447839614
  error estimate for blocks of size 2^( 7) =       0.000454062514

      target function =      -0.926253541716
              le_mean =     -16.897276113639
             les_mean =     285.809301525886
             stat err =       0.000442302079
             autocorr =       1.390105173899
   target nu stat err =       0.000442302079
   target dn stat err =       0.002458930094
      target stat err =       0.003946382327
              std dev =       0.530530246158
             le_variance =       0.281462342089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230600878
                                         uncertainty =       0.001865656356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230600878
                                         uncertainty =       0.001865656356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141510
  error estimate for blocks of size 2^( 2) =       0.000392787474
  error estimate for blocks of size 2^( 3) =       0.000410947820
  error estimate for blocks of size 2^( 4) =       0.000427336739
  error estimate for blocks of size 2^( 5) =       0.000439969359
  error estimate for blocks of size 2^( 6) =       0.000447839559
  error estimate for blocks of size 2^( 7) =       0.000454062456

      target function =      -0.926253967752
              le_mean =     -16.897276115861
             les_mean =     285.809301330627
             stat err =       0.000442302028
             autocorr =       1.390105041012
   target nu stat err =       0.000442302028
   target dn stat err =       0.002458925501
      target stat err =       0.003946378788
              std dev =       0.530530211015
             le_variance =       0.281462304799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230619477
                                         uncertainty =       0.001865656921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230619477
                                         uncertainty =       0.001865656921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141522
  error estimate for blocks of size 2^( 2) =       0.000392787489
  error estimate for blocks of size 2^( 3) =       0.000410947838
  error estimate for blocks of size 2^( 4) =       0.000427336761
  error estimate for blocks of size 2^( 5) =       0.000439969382
  error estimate for blocks of size 2^( 6) =       0.000447839586
  error estimate for blocks of size 2^( 7) =       0.000454062485

      target function =      -0.926253755102
              le_mean =     -16.897276114750
             les_mean =     285.809301428021
             stat err =       0.000442302054
             autocorr =       1.390105107454
   target nu stat err =       0.000442302054
   target dn stat err =       0.002458927793
      target stat err =       0.003946380553
              std dev =       0.530530228586
             le_variance =       0.281462323443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230635752
                                         uncertainty =       0.001865657416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281230635752
                                         uncertainty =       0.001865657416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141533
  error estimate for blocks of size 2^( 2) =       0.000392787503
  error estimate for blocks of size 2^( 3) =       0.000410947854
  error estimate for blocks of size 2^( 4) =       0.000427336779
  error estimate for blocks of size 2^( 5) =       0.000439969403
  error estimate for blocks of size 2^( 6) =       0.000447839610
  error estimate for blocks of size 2^( 7) =       0.000454062511

      target function =      -0.926253568429
              le_mean =     -16.897276113778
             les_mean =     285.809301513627
             stat err =       0.000442302076
             autocorr =       1.390105165598
   target nu stat err =       0.000442302076
   target dn stat err =       0.002458929806
      target stat err =       0.003946382105
              std dev =       0.530530243962
             le_variance =       0.281462339758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926253541716        initial
     2.3842e+03     2.3842e+04             1.7821e-07        -0.926253967752  <--
     9.5367e+03     9.5367e+04             4.4553e-08        -0.926253755102
     3.8147e+04     3.8147e+05             1.1138e-08        -0.926253568429

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 2.7747e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153868e-02 3 1  ON 2
ci_0004                -3.137268e-02 3 1  ON 3
ci_0005                -2.891795e-02 3 1  ON 4
ci_0006                -2.995403e-02 3 1  ON 5
ci_0007                -1.586954e-02 3 1  ON 6
ci_0008                -1.650025e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888041e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563522e-02 3 1  ON 11
ci_0013                 1.549007e-02 3 1  ON 12
ci_0014                 1.537524e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595283e-02 3 1  ON 15
ci_0017                 1.373687e-02 3 1  ON 16
ci_0018                 1.393354e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224397e-02 3 1  ON 19
ci_0021                 1.352943e-02 3 1  ON 20
ci_0022                 1.500246e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113283e-02 3 1  ON 23
ci_0025                -2.823315e-03 3 1  ON 24
ci_0026                -2.392970e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036568e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253467e-03 3 1  ON 32
ci_0034                 8.532812e-03 3 1  ON 33
ci_0035                 4.881254e-03 3 1  ON 34
ci_0036                 4.735575e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817572e-03 3 1  ON 38
ci_0040                -3.939108e-03 3 1  ON 39
ci_0041                 9.549862e-03 3 1  ON 40
ci_0042                 9.454540e-03 3 1  ON 41
ci_0043                -7.797086e-03 3 1  ON 42
ci_0044                -8.255308e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667688e-03 3 1  ON 45
ci_0047                -3.596720e-03 3 1  ON 46
ci_0048                -3.622712e-03 3 1  ON 47
ci_0049                -2.504027e-03 3 1  ON 48
ci_0050                -2.579710e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721199e-03 3 1  ON 51
ci_0053                -3.849870e-03 3 1  ON 52
ci_0054                -3.734519e-03 3 1  ON 53
ci_0055                 2.334103e-03 3 1  ON 54
ci_0056                 2.075118e-03 3 1  ON 55
ci_0057                 2.310494e-03 3 1  ON 56
ci_0058                 2.892500e-03 3 1  ON 57
ci_0059                -3.897903e-03 3 1  ON 58
ci_0060                -3.669193e-03 3 1  ON 59
ci_0061                -3.113139e-03 3 1  ON 60
ci_0062                -3.326524e-03 3 1  ON 61
ci_0063                -9.707023e-03 3 1  ON 62
ci_0064                -9.660036e-03 3 1  ON 63
ci_0065                -6.920318e-03 3 1  ON 64
ci_0066                -6.464955e-03 3 1  ON 65
ci_0067                -3.907188e-03 3 1  ON 66
ci_0068                -3.850779e-03 3 1  ON 67
ci_0069                 3.717834e-03 3 1  ON 68
ci_0070                 3.465988e-03 3 1  ON 69
ci_0071                 4.079832e-03 3 1  ON 70
ci_0072                 4.253329e-03 3 1  ON 71
ci_0073                 3.371975e-03 3 1  ON 72
ci_0074                 3.331481e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.291411
====================================================
  Execution time = 1.4613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.8923e-01
  Total weights = 1.950960085e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280661489878
                                         uncertainty =       0.001877165419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280661489878
                                         uncertainty =       0.001877165419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374578955
  error estimate for blocks of size 2^( 2) =       0.000392135929
  error estimate for blocks of size 2^( 3) =       0.000409854349
  error estimate for blocks of size 2^( 4) =       0.000425328228
  error estimate for blocks of size 2^( 5) =       0.000437041272
  error estimate for blocks of size 2^( 6) =       0.000443300514
  error estimate for blocks of size 2^( 7) =       0.000445518416

      target function =      -0.929618683625
              le_mean =     -16.897183017027
             les_mean =     285.804028664493
             stat err =       0.000437797108
             autocorr =       1.366026195930
   target nu stat err =       0.000437797108
   target dn stat err =       0.002078809751
      target stat err =       0.003381978107
              std dev =       0.529734638828
             le_variance =       0.280618787574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689718301703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929629551804       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929629625138       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929629656485       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929629679734       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929629686901       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929629688021       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929629689078       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929629690755       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929629691896       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929629692563       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929629692704       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929629693127       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929629692834       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929629693015       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929629693014       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929629692999       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929629693005       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929629693016       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+02 is 8.482336e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929629551804       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929629570139       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929629577976       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929629583789       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929629585583       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929629585860       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929629586128       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929629586546       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929629586825       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929629586994       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929629587030       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929629587137       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929629587069       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929629587109       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929629587108       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929629587103       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929629587108       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929629587111       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 2.120700e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929629551804       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929629556388       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929629558347       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929629559796       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929629560248       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929629560318       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929629560390       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929629560491       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929629560550       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929629560588       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929629560616       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929629560628       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929629560621       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929629560611       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929629560622       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929629560636       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929629560637       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929629560669       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 5.301822e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.697456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7187e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.031193e-01 3 1  ON 0
ci_0002                 6.979582e-01 3 1  ON 1
ci_0003                -3.153865e-02 3 1  ON 2
ci_0004                -3.137267e-02 3 1  ON 3
ci_0005                -2.891795e-02 3 1  ON 4
ci_0006                -2.995407e-02 3 1  ON 5
ci_0007                -1.586946e-02 3 1  ON 6
ci_0008                -1.650013e-02 3 1  ON 7
ci_0009                -1.872279e-02 3 1  ON 8
ci_0010                -1.888042e-02 3 1  ON 9
ci_0011                -1.550629e-02 3 1  ON 10
ci_0012                -1.563521e-02 3 1  ON 11
ci_0013                 1.549007e-02 3 1  ON 12
ci_0014                 1.537524e-02 3 1  ON 13
ci_0015                 1.629421e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373688e-02 3 1  ON 16
ci_0018                 1.393353e-02 3 1  ON 17
ci_0019                 1.259661e-02 3 1  ON 18
ci_0020                 1.224399e-02 3 1  ON 19
ci_0021                 1.352922e-02 3 1  ON 20
ci_0022                 1.500227e-02 3 1  ON 21
ci_0023                -1.182655e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823289e-03 3 1  ON 24
ci_0026                -2.393030e-03 3 1  ON 25
ci_0027                -1.179156e-02 3 1  ON 26
ci_0028                -1.174931e-02 3 1  ON 27
ci_0029                -1.044355e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383438e-02 3 1  ON 30
ci_0032                 1.290464e-02 3 1  ON 31
ci_0033                 8.253435e-03 3 1  ON 32
ci_0034                 8.532786e-03 3 1  ON 33
ci_0035                 4.881198e-03 3 1  ON 34
ci_0036                 4.735585e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817587e-03 3 1  ON 38
ci_0040                -3.939089e-03 3 1  ON 39
ci_0041                 9.549827e-03 3 1  ON 40
ci_0042                 9.454552e-03 3 1  ON 41
ci_0043                -7.797237e-03 3 1  ON 42
ci_0044                -8.255445e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667705e-03 3 1  ON 45
ci_0047                -3.596729e-03 3 1  ON 46
ci_0048                -3.622712e-03 3 1  ON 47
ci_0049                -2.504040e-03 3 1  ON 48
ci_0050                -2.579735e-03 3 1  ON 49
ci_0051                -1.839142e-03 3 1  ON 50
ci_0052                -1.721185e-03 3 1  ON 51
ci_0053                -3.849883e-03 3 1  ON 52
ci_0054                -3.734521e-03 3 1  ON 53
ci_0055                 2.334111e-03 3 1  ON 54
ci_0056                 2.075083e-03 3 1  ON 55
ci_0057                 2.310487e-03 3 1  ON 56
ci_0058                 2.892479e-03 3 1  ON 57
ci_0059                -3.897889e-03 3 1  ON 58
ci_0060                -3.669214e-03 3 1  ON 59
ci_0061                -3.113141e-03 3 1  ON 60
ci_0062                -3.326519e-03 3 1  ON 61
ci_0063                -9.707023e-03 3 1  ON 62
ci_0064                -9.660021e-03 3 1  ON 63
ci_0065                -6.920298e-03 3 1  ON 64
ci_0066                -6.464952e-03 3 1  ON 65
ci_0067                -3.907186e-03 3 1  ON 66
ci_0068                -3.850780e-03 3 1  ON 67
ci_0069                 3.717808e-03 3 1  ON 68
ci_0070                 3.466008e-03 3 1  ON 69
ci_0071                 4.079767e-03 3 1  ON 70
ci_0072                 4.253324e-03 3 1  ON 71
ci_0073                 3.371962e-03 3 1  ON 72
ci_0074                 3.331483e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8423
    reference variance = 0.491988
====================================================
  Execution time = 1.4331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9771e-01
  Total weights = 1.9513e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750274878
                                         uncertainty =       0.001572032326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750274878
                                         uncertainty =       0.001572032326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377317207
  error estimate for blocks of size 2^( 2) =       0.000394772989
  error estimate for blocks of size 2^( 3) =       0.000412428958
  error estimate for blocks of size 2^( 4) =       0.000427541158
  error estimate for blocks of size 2^( 5) =       0.000439209433
  error estimate for blocks of size 2^( 6) =       0.000445770387
  error estimate for blocks of size 2^( 7) =       0.000450367931

      target function =      -0.916341990468
              le_mean =     -16.898138194998
             les_mean =     285.844785043018
             stat err =       0.000440722227
             autocorr =       1.364321384228
   target nu stat err =       0.000440722227
   target dn stat err =       0.003241500296
      target stat err =       0.005061020429
              std dev =       0.533607111222
             le_variance =       0.284736549147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750107143
                                         uncertainty =       0.001572027812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750107143
                                         uncertainty =       0.001572027812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377317096
  error estimate for blocks of size 2^( 2) =       0.000394772857
  error estimate for blocks of size 2^( 3) =       0.000412428804
  error estimate for blocks of size 2^( 4) =       0.000427540980
  error estimate for blocks of size 2^( 5) =       0.000439209238
  error estimate for blocks of size 2^( 6) =       0.000445770185
  error estimate for blocks of size 2^( 7) =       0.000450367711

      target function =      -0.916341206061
              le_mean =     -16.898138196507
             les_mean =     285.844785600780
             stat err =       0.000440722029
             autocorr =       1.364320958739
   target nu stat err =       0.000440722029
   target dn stat err =       0.003241606535
      target stat err =       0.005061174133
              std dev =       0.533606954128
             le_variance =       0.284736381493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750191000
                                         uncertainty =       0.001572030069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750191000
                                         uncertainty =       0.001572030069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377317151
  error estimate for blocks of size 2^( 2) =       0.000394772923
  error estimate for blocks of size 2^( 3) =       0.000412428881
  error estimate for blocks of size 2^( 4) =       0.000427541069
  error estimate for blocks of size 2^( 5) =       0.000439209335
  error estimate for blocks of size 2^( 6) =       0.000445770286
  error estimate for blocks of size 2^( 7) =       0.000450367821

      target function =      -0.916341598911
              le_mean =     -16.898138195751
             les_mean =     285.844785321452
             stat err =       0.000440722128
             autocorr =       1.364321171481
   target nu stat err =       0.000440722128
   target dn stat err =       0.003241553388
      target stat err =       0.005061097247
              std dev =       0.533607032665
             le_variance =       0.284736465309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750264393
                                         uncertainty =       0.001572032044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284750264393
                                         uncertainty =       0.001572032044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377317200
  error estimate for blocks of size 2^( 2) =       0.000394772981
  error estimate for blocks of size 2^( 3) =       0.000412428948
  error estimate for blocks of size 2^( 4) =       0.000427541147
  error estimate for blocks of size 2^( 5) =       0.000439209420
  error estimate for blocks of size 2^( 6) =       0.000445770374
  error estimate for blocks of size 2^( 7) =       0.000450367917

      target function =      -0.916341941596
              le_mean =     -16.898138195092
             les_mean =     285.844785077772
             stat err =       0.000440722215
             autocorr =       1.364321357631
   target nu stat err =       0.000440722215
   target dn stat err =       0.003241506929
      target stat err =       0.005061030027
              std dev =       0.533607101402
             le_variance =       0.284736538666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916341990468        initial  <--
     5.9605e+02     5.9605e+03             8.4823e-07        -0.916341206061
     2.3842e+03     2.3842e+04             2.1207e-07        -0.916341598911
     9.5367e+03     9.5367e+04             5.3018e-08        -0.916341941596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8690
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153868e-02 3 1  ON 2
ci_0004                -3.137268e-02 3 1  ON 3
ci_0005                -2.891795e-02 3 1  ON 4
ci_0006                -2.995403e-02 3 1  ON 5
ci_0007                -1.586954e-02 3 1  ON 6
ci_0008                -1.650025e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888041e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563522e-02 3 1  ON 11
ci_0013                 1.549007e-02 3 1  ON 12
ci_0014                 1.537524e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595283e-02 3 1  ON 15
ci_0017                 1.373687e-02 3 1  ON 16
ci_0018                 1.393354e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224397e-02 3 1  ON 19
ci_0021                 1.352943e-02 3 1  ON 20
ci_0022                 1.500246e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113283e-02 3 1  ON 23
ci_0025                -2.823315e-03 3 1  ON 24
ci_0026                -2.392970e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036568e-02 3 1  ON 29
ci_0031                 1.383439e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253467e-03 3 1  ON 32
ci_0034                 8.532812e-03 3 1  ON 33
ci_0035                 4.881254e-03 3 1  ON 34
ci_0036                 4.735575e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817572e-03 3 1  ON 38
ci_0040                -3.939108e-03 3 1  ON 39
ci_0041                 9.549862e-03 3 1  ON 40
ci_0042                 9.454540e-03 3 1  ON 41
ci_0043                -7.797086e-03 3 1  ON 42
ci_0044                -8.255308e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667688e-03 3 1  ON 45
ci_0047                -3.596720e-03 3 1  ON 46
ci_0048                -3.622712e-03 3 1  ON 47
ci_0049                -2.504027e-03 3 1  ON 48
ci_0050                -2.579710e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721199e-03 3 1  ON 51
ci_0053                -3.849870e-03 3 1  ON 52
ci_0054                -3.734519e-03 3 1  ON 53
ci_0055                 2.334103e-03 3 1  ON 54
ci_0056                 2.075118e-03 3 1  ON 55
ci_0057                 2.310494e-03 3 1  ON 56
ci_0058                 2.892500e-03 3 1  ON 57
ci_0059                -3.897903e-03 3 1  ON 58
ci_0060                -3.669193e-03 3 1  ON 59
ci_0061                -3.113139e-03 3 1  ON 60
ci_0062                -3.326524e-03 3 1  ON 61
ci_0063                -9.707023e-03 3 1  ON 62
ci_0064                -9.660036e-03 3 1  ON 63
ci_0065                -6.920318e-03 3 1  ON 64
ci_0066                -6.464955e-03 3 1  ON 65
ci_0067                -3.907188e-03 3 1  ON 66
ci_0068                -3.850779e-03 3 1  ON 67
ci_0069                 3.717834e-03 3 1  ON 68
ci_0070                 3.465988e-03 3 1  ON 69
ci_0071                 4.079832e-03 3 1  ON 70
ci_0072                 4.253329e-03 3 1  ON 71
ci_0073                 3.371975e-03 3 1  ON 72
ci_0074                 3.331481e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.0117
    reference variance = 0.377477
====================================================
  Execution time = 1.4613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9070e-01
  Total weights = 1.951000325e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282488141562
                                         uncertainty =       0.001597501629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282488141562
                                         uncertainty =       0.001597501629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375807209
  error estimate for blocks of size 2^( 2) =       0.000392724957
  error estimate for blocks of size 2^( 3) =       0.000410611366
  error estimate for blocks of size 2^( 4) =       0.000425947014
  error estimate for blocks of size 2^( 5) =       0.000438379030
  error estimate for blocks of size 2^( 6) =       0.000444534337
  error estimate for blocks of size 2^( 7) =       0.000447030778

      target function =      -0.927310934321
              le_mean =     -16.898101034495
             les_mean =     285.836521157134
             stat err =       0.000438972790
             autocorr =       1.364410299105
   target nu stat err =       0.000438972790
   target dn stat err =       0.002000314106
      target stat err =       0.003250817551
              std dev =       0.531471651542
             le_variance =       0.282462116393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689810103450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927320907274       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927320914817       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927320917044       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927320918379       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927320919409       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927320919544       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927320919569       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927320919594       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927320919617       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927320919625       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927320919622       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927320919613       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927320919635       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927320919628       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927320919619       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927320919617       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927320919634       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927320919619       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 6.723001e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927320907274       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927320909160       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927320909717       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927320910040       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927320910308       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927320910340       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927320910347       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927320910355       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927320910358       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927320910347       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927320910364       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927320910405       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927320910338       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927320910361       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927320910389       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927320910357       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927320910362       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927320910362       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 1.680759e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927320907274       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927320907746       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927320907885       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927320907968       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927320908033       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927320908041       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927320908056       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927320908045       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927320907847       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927320908046       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927320908063       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927320908046       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927320907996       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927320907721       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927320907939       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927320908047       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927320907645       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927320907834       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+04 is 4.201904e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.707611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7177e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153868e-02 3 1  ON 2
ci_0004                -3.137267e-02 3 1  ON 3
ci_0005                -2.891796e-02 3 1  ON 4
ci_0006                -2.995403e-02 3 1  ON 5
ci_0007                -1.586953e-02 3 1  ON 6
ci_0008                -1.650024e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888041e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563522e-02 3 1  ON 11
ci_0013                 1.549006e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595283e-02 3 1  ON 15
ci_0017                 1.373687e-02 3 1  ON 16
ci_0018                 1.393353e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224397e-02 3 1  ON 19
ci_0021                 1.352942e-02 3 1  ON 20
ci_0022                 1.500245e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113283e-02 3 1  ON 23
ci_0025                -2.823311e-03 3 1  ON 24
ci_0026                -2.392970e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383438e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253469e-03 3 1  ON 32
ci_0034                 8.532812e-03 3 1  ON 33
ci_0035                 4.881258e-03 3 1  ON 34
ci_0036                 4.735579e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817572e-03 3 1  ON 38
ci_0040                -3.939107e-03 3 1  ON 39
ci_0041                 9.549863e-03 3 1  ON 40
ci_0042                 9.454539e-03 3 1  ON 41
ci_0043                -7.797098e-03 3 1  ON 42
ci_0044                -8.255320e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667687e-03 3 1  ON 45
ci_0047                -3.596720e-03 3 1  ON 46
ci_0048                -3.622711e-03 3 1  ON 47
ci_0049                -2.504029e-03 3 1  ON 48
ci_0050                -2.579712e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721201e-03 3 1  ON 51
ci_0053                -3.849871e-03 3 1  ON 52
ci_0054                -3.734520e-03 3 1  ON 53
ci_0055                 2.334101e-03 3 1  ON 54
ci_0056                 2.075116e-03 3 1  ON 55
ci_0057                 2.310496e-03 3 1  ON 56
ci_0058                 2.892498e-03 3 1  ON 57
ci_0059                -3.897898e-03 3 1  ON 58
ci_0060                -3.669192e-03 3 1  ON 59
ci_0061                -3.113142e-03 3 1  ON 60
ci_0062                -3.326523e-03 3 1  ON 61
ci_0063                -9.707023e-03 3 1  ON 62
ci_0064                -9.660037e-03 3 1  ON 63
ci_0065                -6.920318e-03 3 1  ON 64
ci_0066                -6.464953e-03 3 1  ON 65
ci_0067                -3.907186e-03 3 1  ON 66
ci_0068                -3.850778e-03 3 1  ON 67
ci_0069                 3.717832e-03 3 1  ON 68
ci_0070                 3.465987e-03 3 1  ON 69
ci_0071                 4.079831e-03 3 1  ON 70
ci_0072                 4.253325e-03 3 1  ON 71
ci_0073                 3.371974e-03 3 1  ON 72
ci_0074                 3.331480e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8038
    reference variance = 0.298069
====================================================
  Execution time = 1.4321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9326e-01
  Total weights = 1.9509e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794345176
                                         uncertainty =       0.001634217581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794345176
                                         uncertainty =       0.001634217581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376676908
  error estimate for blocks of size 2^( 2) =       0.000394075783
  error estimate for blocks of size 2^( 3) =       0.000411984137
  error estimate for blocks of size 2^( 4) =       0.000427686704
  error estimate for blocks of size 2^( 5) =       0.000440684334
  error estimate for blocks of size 2^( 6) =       0.000448989725
  error estimate for blocks of size 2^( 7) =       0.000453094901

      target function =      -0.923283230473
              le_mean =     -16.898337249513
             les_mean =     285.847062986669
             stat err =       0.000442613916
             autocorr =       1.380740724365
   target nu stat err =       0.000442613916
   target dn stat err =       0.002046402420
      target stat err =       0.003296564585
              std dev =       0.532701592085
             le_variance =       0.283770986210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794324864
                                         uncertainty =       0.001634216660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794324864
                                         uncertainty =       0.001634216660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376676895
  error estimate for blocks of size 2^( 2) =       0.000394075768
  error estimate for blocks of size 2^( 3) =       0.000411984119
  error estimate for blocks of size 2^( 4) =       0.000427686684
  error estimate for blocks of size 2^( 5) =       0.000440684313
  error estimate for blocks of size 2^( 6) =       0.000448989703
  error estimate for blocks of size 2^( 7) =       0.000453094879

      target function =      -0.923283234784
              le_mean =     -16.898337249272
             les_mean =     285.847062975775
             stat err =       0.000442613895
             autocorr =       1.380740690701
   target nu stat err =       0.000442613895
   target dn stat err =       0.002046403570
      target stat err =       0.003296566363
              std dev =       0.532701573044
             le_variance =       0.283770965924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794335020
                                         uncertainty =       0.001634217120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794335020
                                         uncertainty =       0.001634217120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376676901
  error estimate for blocks of size 2^( 2) =       0.000394075775
  error estimate for blocks of size 2^( 3) =       0.000411984128
  error estimate for blocks of size 2^( 4) =       0.000427686694
  error estimate for blocks of size 2^( 5) =       0.000440684323
  error estimate for blocks of size 2^( 6) =       0.000448989714
  error estimate for blocks of size 2^( 7) =       0.000453094890

      target function =      -0.923283232644
              le_mean =     -16.898337249392
             les_mean =     285.847062981211
             stat err =       0.000442613905
             autocorr =       1.380740707543
   target nu stat err =       0.000442613905
   target dn stat err =       0.002046402995
      target stat err =       0.003296565474
              std dev =       0.532701582565
             le_variance =       0.283770976067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794343906
                                         uncertainty =       0.001634217523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283794343906
                                         uncertainty =       0.001634217523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376676907
  error estimate for blocks of size 2^( 2) =       0.000394075782
  error estimate for blocks of size 2^( 3) =       0.000411984136
  error estimate for blocks of size 2^( 4) =       0.000427686702
  error estimate for blocks of size 2^( 5) =       0.000440684332
  error estimate for blocks of size 2^( 6) =       0.000448989723
  error estimate for blocks of size 2^( 7) =       0.000453094900

      target function =      -0.923283230746
              le_mean =     -16.898337249498
             les_mean =     285.847062985985
             stat err =       0.000442613915
             autocorr =       1.380740722271
   target nu stat err =       0.000442613915
   target dn stat err =       0.002046402492
      target stat err =       0.003296564696
              std dev =       0.532701590895
             le_variance =       0.283770984942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923283230473        initial
     5.9605e+03     5.9605e+04             6.7230e-08        -0.923283234784  <--
     2.3842e+04     2.3842e+05             1.6808e-08        -0.923283232644
     9.5367e+04     9.5367e+05             4.2019e-09        -0.923283230746

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.3824e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153867e-02 3 1  ON 2
ci_0004                -3.137266e-02 3 1  ON 3
ci_0005                -2.891798e-02 3 1  ON 4
ci_0006                -2.995404e-02 3 1  ON 5
ci_0007                -1.586951e-02 3 1  ON 6
ci_0008                -1.650023e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888039e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563522e-02 3 1  ON 11
ci_0013                 1.549006e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595282e-02 3 1  ON 15
ci_0017                 1.373686e-02 3 1  ON 16
ci_0018                 1.393352e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224397e-02 3 1  ON 19
ci_0021                 1.352937e-02 3 1  ON 20
ci_0022                 1.500240e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823299e-03 3 1  ON 24
ci_0026                -2.392968e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290466e-02 3 1  ON 31
ci_0033                 8.253475e-03 3 1  ON 32
ci_0034                 8.532812e-03 3 1  ON 33
ci_0035                 4.881269e-03 3 1  ON 34
ci_0036                 4.735591e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817574e-03 3 1  ON 38
ci_0040                -3.939103e-03 3 1  ON 39
ci_0041                 9.549865e-03 3 1  ON 40
ci_0042                 9.454536e-03 3 1  ON 41
ci_0043                -7.797135e-03 3 1  ON 42
ci_0044                -8.255357e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667687e-03 3 1  ON 45
ci_0047                -3.596719e-03 3 1  ON 46
ci_0048                -3.622706e-03 3 1  ON 47
ci_0049                -2.504033e-03 3 1  ON 48
ci_0050                -2.579721e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721208e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734522e-03 3 1  ON 53
ci_0055                 2.334093e-03 3 1  ON 54
ci_0056                 2.075110e-03 3 1  ON 55
ci_0057                 2.310503e-03 3 1  ON 56
ci_0058                 2.892491e-03 3 1  ON 57
ci_0059                -3.897883e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.113150e-03 3 1  ON 60
ci_0062                -3.326523e-03 3 1  ON 61
ci_0063                -9.707025e-03 3 1  ON 62
ci_0064                -9.660038e-03 3 1  ON 63
ci_0065                -6.920316e-03 3 1  ON 64
ci_0066                -6.464947e-03 3 1  ON 65
ci_0067                -3.907180e-03 3 1  ON 66
ci_0068                -3.850778e-03 3 1  ON 67
ci_0069                 3.717827e-03 3 1  ON 68
ci_0070                 3.465983e-03 3 1  ON 69
ci_0071                 4.079826e-03 3 1  ON 70
ci_0072                 4.253313e-03 3 1  ON 71
ci_0073                 3.371971e-03 3 1  ON 72
ci_0074                 3.331477e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.94
    reference variance = 0.213395
====================================================
  Execution time = 1.4530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9227e-01
  Total weights = 1.951348267e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282861265819
                                         uncertainty =       0.001724857998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282861265819
                                         uncertainty =       0.001724857998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376100099
  error estimate for blocks of size 2^( 2) =       0.000393338882
  error estimate for blocks of size 2^( 3) =       0.000410841747
  error estimate for blocks of size 2^( 4) =       0.000426779408
  error estimate for blocks of size 2^( 5) =       0.000439301863
  error estimate for blocks of size 2^( 6) =       0.000445194950
  error estimate for blocks of size 2^( 7) =       0.000447755248

      target function =      -0.924835122679
              le_mean =     -16.898092965833
             les_mean =     285.837816511793
             stat err =       0.000439757867
             autocorr =       1.367163133697
   target nu stat err =       0.000439757867
   target dn stat err =       0.002235104041
      target stat err =       0.003594542674
              std dev =       0.531885861134
             le_variance =       0.282902569275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689809296583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924847595054       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924847626032       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924847636030       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924847643700       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924847646918       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924847647569       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924847648044       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924847648020       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924847648125       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924847648126       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924847648201       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924847648240       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924847648349       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924847648342       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924847648346       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924847648341       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924847648341       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924847648345       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+03 is 3.046633e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924847595054       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924847602798       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924847605298       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924847607216       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924847608020       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924847608183       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924847608302       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924847608314       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924847608322       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924847608316       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924847608341       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924847608347       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924847608370       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924847608358       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924847608372       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924847608370       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924847608376       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924847608384       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 7.616739e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924847595054       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924847596990       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924847597615       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924847598084       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924847598295       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924847598351       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924847598366       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924847598364       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924847598371       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924847598362       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924847598376       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924847598406       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924847598385       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924847598377       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924847598385       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924847598431       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924847598481       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924847598367       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 1.904194e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.717806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7100e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153865e-02 3 1  ON 2
ci_0004                -3.137266e-02 3 1  ON 3
ci_0005                -2.891798e-02 3 1  ON 4
ci_0006                -2.995405e-02 3 1  ON 5
ci_0007                -1.586949e-02 3 1  ON 6
ci_0008                -1.650021e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888039e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563520e-02 3 1  ON 11
ci_0013                 1.549005e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629421e-02 3 1  ON 14
ci_0016                 1.595282e-02 3 1  ON 15
ci_0017                 1.373687e-02 3 1  ON 16
ci_0018                 1.393351e-02 3 1  ON 17
ci_0019                 1.259662e-02 3 1  ON 18
ci_0020                 1.224399e-02 3 1  ON 19
ci_0021                 1.352929e-02 3 1  ON 20
ci_0022                 1.500234e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823288e-03 3 1  ON 24
ci_0026                -2.392971e-03 3 1  ON 25
ci_0027                -1.179158e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044355e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253470e-03 3 1  ON 32
ci_0034                 8.532806e-03 3 1  ON 33
ci_0035                 4.881273e-03 3 1  ON 34
ci_0036                 4.735575e-03 3 1  ON 35
ci_0037                -1.141422e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817579e-03 3 1  ON 38
ci_0040                -3.939103e-03 3 1  ON 39
ci_0041                 9.549861e-03 3 1  ON 40
ci_0042                 9.454531e-03 3 1  ON 41
ci_0043                -7.797166e-03 3 1  ON 42
ci_0044                -8.255408e-03 3 1  ON 43
ci_0045                 1.041904e-02 3 1  ON 44
ci_0046                 9.667688e-03 3 1  ON 45
ci_0047                -3.596720e-03 3 1  ON 46
ci_0048                -3.622698e-03 3 1  ON 47
ci_0049                -2.504024e-03 3 1  ON 48
ci_0050                -2.579721e-03 3 1  ON 49
ci_0051                -1.839136e-03 3 1  ON 50
ci_0052                -1.721204e-03 3 1  ON 51
ci_0053                -3.849875e-03 3 1  ON 52
ci_0054                -3.734491e-03 3 1  ON 53
ci_0055                 2.334092e-03 3 1  ON 54
ci_0056                 2.075109e-03 3 1  ON 55
ci_0057                 2.310492e-03 3 1  ON 56
ci_0058                 2.892507e-03 3 1  ON 57
ci_0059                -3.897876e-03 3 1  ON 58
ci_0060                -3.669186e-03 3 1  ON 59
ci_0061                -3.113166e-03 3 1  ON 60
ci_0062                -3.326531e-03 3 1  ON 61
ci_0063                -9.707019e-03 3 1  ON 62
ci_0064                -9.660032e-03 3 1  ON 63
ci_0065                -6.920306e-03 3 1  ON 64
ci_0066                -6.464950e-03 3 1  ON 65
ci_0067                -3.907191e-03 3 1  ON 66
ci_0068                -3.850781e-03 3 1  ON 67
ci_0069                 3.717830e-03 3 1  ON 68
ci_0070                 3.465981e-03 3 1  ON 69
ci_0071                 4.079810e-03 3 1  ON 70
ci_0072                 4.253301e-03 3 1  ON 71
ci_0073                 3.371981e-03 3 1  ON 72
ci_0074                 3.331488e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.183586
====================================================
  Execution time = 1.4427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9558e-01
  Total weights = 1.9513e+06
  Execution time = 1.8812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916576575
                                         uncertainty =       0.001914824703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916576575
                                         uncertainty =       0.001914824703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376768264
  error estimate for blocks of size 2^( 2) =       0.000394093427
  error estimate for blocks of size 2^( 3) =       0.000411870824
  error estimate for blocks of size 2^( 4) =       0.000427871460
  error estimate for blocks of size 2^( 5) =       0.000439634445
  error estimate for blocks of size 2^( 6) =       0.000447160696
  error estimate for blocks of size 2^( 7) =       0.000450152545

      target function =      -0.919646841709
              le_mean =     -16.898711427294
             les_mean =     285.862027212990
             stat err =       0.000441204787
             autocorr =       1.371297874044
   target nu stat err =       0.000441204787
   target dn stat err =       0.003119359557
      target stat err =       0.004914616596
              std dev =       0.532830788768
             le_variance =       0.283908649459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916522583
                                         uncertainty =       0.001914824017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916522583
                                         uncertainty =       0.001914824017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376768228
  error estimate for blocks of size 2^( 2) =       0.000394093385
  error estimate for blocks of size 2^( 3) =       0.000411870772
  error estimate for blocks of size 2^( 4) =       0.000427871397
  error estimate for blocks of size 2^( 5) =       0.000439634372
  error estimate for blocks of size 2^( 6) =       0.000447160619
  error estimate for blocks of size 2^( 7) =       0.000450152470

      target function =      -0.919646653138
              le_mean =     -16.898711429815
             les_mean =     285.862027418998
             stat err =       0.000441204715
             autocorr =       1.371297688940
   target nu stat err =       0.000441204715
   target dn stat err =       0.003119388157
      target stat err =       0.004914658630
              std dev =       0.532830737894
             le_variance =       0.283908595245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916549578
                                         uncertainty =       0.001914824360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916549578
                                         uncertainty =       0.001914824360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376768246
  error estimate for blocks of size 2^( 2) =       0.000394093406
  error estimate for blocks of size 2^( 3) =       0.000411870798
  error estimate for blocks of size 2^( 4) =       0.000427871429
  error estimate for blocks of size 2^( 5) =       0.000439634408
  error estimate for blocks of size 2^( 6) =       0.000447160658
  error estimate for blocks of size 2^( 7) =       0.000450152508

      target function =      -0.919646747487
              le_mean =     -16.898711428554
             les_mean =     285.862027315951
             stat err =       0.000441204751
             autocorr =       1.371297781492
   target nu stat err =       0.000441204751
   target dn stat err =       0.003119373856
      target stat err =       0.004914637612
              std dev =       0.532830763330
             le_variance =       0.283908622351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916573200
                                         uncertainty =       0.001914824660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283916573200
                                         uncertainty =       0.001914824660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376768262
  error estimate for blocks of size 2^( 2) =       0.000394093425
  error estimate for blocks of size 2^( 3) =       0.000411870821
  error estimate for blocks of size 2^( 4) =       0.000427871456
  error estimate for blocks of size 2^( 5) =       0.000439634440
  error estimate for blocks of size 2^( 6) =       0.000447160692
  error estimate for blocks of size 2^( 7) =       0.000450152540

      target function =      -0.919646829938
              le_mean =     -16.898711427451
             les_mean =     285.862027225856
             stat err =       0.000441204782
             autocorr =       1.371297862462
   target nu stat err =       0.000441204782
   target dn stat err =       0.003119361344
      target stat err =       0.004914619223
              std dev =       0.532830785588
             le_variance =       0.283908646071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919646841709        initial  <--
     1.4901e+03     1.4901e+04             3.0466e-07        -0.919646653138
     5.9605e+03     5.9605e+04             7.6167e-08        -0.919646747487
     2.3842e+04     2.3842e+05             1.9042e-08        -0.919646829938

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8224
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153867e-02 3 1  ON 2
ci_0004                -3.137266e-02 3 1  ON 3
ci_0005                -2.891798e-02 3 1  ON 4
ci_0006                -2.995404e-02 3 1  ON 5
ci_0007                -1.586951e-02 3 1  ON 6
ci_0008                -1.650023e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888039e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563522e-02 3 1  ON 11
ci_0013                 1.549006e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595282e-02 3 1  ON 15
ci_0017                 1.373686e-02 3 1  ON 16
ci_0018                 1.393352e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224397e-02 3 1  ON 19
ci_0021                 1.352937e-02 3 1  ON 20
ci_0022                 1.500240e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823299e-03 3 1  ON 24
ci_0026                -2.392968e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290466e-02 3 1  ON 31
ci_0033                 8.253475e-03 3 1  ON 32
ci_0034                 8.532812e-03 3 1  ON 33
ci_0035                 4.881269e-03 3 1  ON 34
ci_0036                 4.735591e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817574e-03 3 1  ON 38
ci_0040                -3.939103e-03 3 1  ON 39
ci_0041                 9.549865e-03 3 1  ON 40
ci_0042                 9.454536e-03 3 1  ON 41
ci_0043                -7.797135e-03 3 1  ON 42
ci_0044                -8.255357e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667687e-03 3 1  ON 45
ci_0047                -3.596719e-03 3 1  ON 46
ci_0048                -3.622706e-03 3 1  ON 47
ci_0049                -2.504033e-03 3 1  ON 48
ci_0050                -2.579721e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721208e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734522e-03 3 1  ON 53
ci_0055                 2.334093e-03 3 1  ON 54
ci_0056                 2.075110e-03 3 1  ON 55
ci_0057                 2.310503e-03 3 1  ON 56
ci_0058                 2.892491e-03 3 1  ON 57
ci_0059                -3.897883e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.113150e-03 3 1  ON 60
ci_0062                -3.326523e-03 3 1  ON 61
ci_0063                -9.707025e-03 3 1  ON 62
ci_0064                -9.660038e-03 3 1  ON 63
ci_0065                -6.920316e-03 3 1  ON 64
ci_0066                -6.464947e-03 3 1  ON 65
ci_0067                -3.907180e-03 3 1  ON 66
ci_0068                -3.850778e-03 3 1  ON 67
ci_0069                 3.717827e-03 3 1  ON 68
ci_0070                 3.465983e-03 3 1  ON 69
ci_0071                 4.079826e-03 3 1  ON 70
ci_0072                 4.253313e-03 3 1  ON 71
ci_0073                 3.371971e-03 3 1  ON 72
ci_0074                 3.331477e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8957
    reference variance = 0.147128
====================================================
  Execution time = 1.4736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9605e-01
  Total weights = 1.950690215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157477610
                                         uncertainty =       0.003496918661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288157477610
                                         uncertainty =       0.003496918661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379521058
  error estimate for blocks of size 2^( 2) =       0.000396503964
  error estimate for blocks of size 2^( 3) =       0.000413772610
  error estimate for blocks of size 2^( 4) =       0.000428589382
  error estimate for blocks of size 2^( 5) =       0.000439576031
  error estimate for blocks of size 2^( 6) =       0.000446398293
  error estimate for blocks of size 2^( 7) =       0.000451272877

      target function =      -0.918899487354
              le_mean =     -16.897805385421
             les_mean =     285.831880089806
             stat err =       0.000441459146
             autocorr =       1.353035781351
   target nu stat err =       0.000441459146
   target dn stat err =       0.003566854871
      target stat err =       0.005586147820
              std dev =       0.536723826942
             le_variance =       0.288072466407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689780538542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918935612029       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918935617619       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918935618684       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918935619310       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918935619544       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918935619671       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918935619697       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918935619685       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918935619695       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918935619662       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918935619704       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918935619757       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918935619721       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918935619711       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918935619717       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918935619702       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918935619699       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918935619710       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 2.643862e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918935612029       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918935613427       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918935613693       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918935613848       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918935613910       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918935613940       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918935613947       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918935613947       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918935613947       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918935613900       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918935613990       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918935613948       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918935613812       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918935613949       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918935613949       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918935613949       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918935613732       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918935613949       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+04 is 6.609669e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918935612029       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918935612378       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918935612445       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918935612484       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918935612499       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918935612507       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918935612508       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918935612509       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918935612509       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918935612509       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918935612509       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918935612509       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918935612776       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918935612986       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918935612509       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918935612509       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918935612208       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918935612424       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+05 is 1.652418e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.728013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7309e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153867e-02 3 1  ON 2
ci_0004                -3.137266e-02 3 1  ON 3
ci_0005                -2.891798e-02 3 1  ON 4
ci_0006                -2.995404e-02 3 1  ON 5
ci_0007                -1.586951e-02 3 1  ON 6
ci_0008                -1.650022e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888039e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563522e-02 3 1  ON 11
ci_0013                 1.549006e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629421e-02 3 1  ON 14
ci_0016                 1.595282e-02 3 1  ON 15
ci_0017                 1.373686e-02 3 1  ON 16
ci_0018                 1.393352e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224398e-02 3 1  ON 19
ci_0021                 1.352936e-02 3 1  ON 20
ci_0022                 1.500239e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823298e-03 3 1  ON 24
ci_0026                -2.392964e-03 3 1  ON 25
ci_0027                -1.179157e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290466e-02 3 1  ON 31
ci_0033                 8.253474e-03 3 1  ON 32
ci_0034                 8.532813e-03 3 1  ON 33
ci_0035                 4.881272e-03 3 1  ON 34
ci_0036                 4.735591e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817574e-03 3 1  ON 38
ci_0040                -3.939103e-03 3 1  ON 39
ci_0041                 9.549865e-03 3 1  ON 40
ci_0042                 9.454536e-03 3 1  ON 41
ci_0043                -7.797141e-03 3 1  ON 42
ci_0044                -8.255363e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667689e-03 3 1  ON 45
ci_0047                -3.596719e-03 3 1  ON 46
ci_0048                -3.622706e-03 3 1  ON 47
ci_0049                -2.504034e-03 3 1  ON 48
ci_0050                -2.579722e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721206e-03 3 1  ON 51
ci_0053                -3.849872e-03 3 1  ON 52
ci_0054                -3.734521e-03 3 1  ON 53
ci_0055                 2.334092e-03 3 1  ON 54
ci_0056                 2.075107e-03 3 1  ON 55
ci_0057                 2.310504e-03 3 1  ON 56
ci_0058                 2.892491e-03 3 1  ON 57
ci_0059                -3.897882e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.113152e-03 3 1  ON 60
ci_0062                -3.326523e-03 3 1  ON 61
ci_0063                -9.707025e-03 3 1  ON 62
ci_0064                -9.660037e-03 3 1  ON 63
ci_0065                -6.920316e-03 3 1  ON 64
ci_0066                -6.464946e-03 3 1  ON 65
ci_0067                -3.907180e-03 3 1  ON 66
ci_0068                -3.850776e-03 3 1  ON 67
ci_0069                 3.717826e-03 3 1  ON 68
ci_0070                 3.465982e-03 3 1  ON 69
ci_0071                 4.079824e-03 3 1  ON 70
ci_0072                 4.253313e-03 3 1  ON 71
ci_0073                 3.371970e-03 3 1  ON 72
ci_0074                 3.331476e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8728
    reference variance = 0.221231
====================================================
  Execution time = 1.4337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9189e-01
  Total weights = 1.9509e+06
  Execution time = 1.8931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815569952
                                         uncertainty =       0.001706538733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815569952
                                         uncertainty =       0.001706538733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375401826
  error estimate for blocks of size 2^( 2) =       0.000393042678
  error estimate for blocks of size 2^( 3) =       0.000411371531
  error estimate for blocks of size 2^( 4) =       0.000427137458
  error estimate for blocks of size 2^( 5) =       0.000439034404
  error estimate for blocks of size 2^( 6) =       0.000446276158
  error estimate for blocks of size 2^( 7) =       0.000450278970

      target function =      -0.925434617018
              le_mean =     -16.898444927270
             les_mean =     285.849330495120
             stat err =       0.000440681747
             autocorr =       1.378025847090
   target nu stat err =       0.000440681747
   target dn stat err =       0.002534588870
      target stat err =       0.004064620599
              std dev =       0.530898354143
             le_variance =       0.281853062431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815560997
                                         uncertainty =       0.001706537986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815560997
                                         uncertainty =       0.001706537986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375401820
  error estimate for blocks of size 2^( 2) =       0.000393042672
  error estimate for blocks of size 2^( 3) =       0.000411371525
  error estimate for blocks of size 2^( 4) =       0.000427137451
  error estimate for blocks of size 2^( 5) =       0.000439034397
  error estimate for blocks of size 2^( 6) =       0.000446276150
  error estimate for blocks of size 2^( 7) =       0.000450278963

      target function =      -0.925435360060
              le_mean =     -16.898444927557
             les_mean =     285.849330033660
             stat err =       0.000440681740
             autocorr =       1.378025843842
   target nu stat err =       0.000440681740
   target dn stat err =       0.002534555677
      target stat err =       0.004064575597
              std dev =       0.530898345735
             le_variance =       0.281853053505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815565474
                                         uncertainty =       0.001706538360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815565474
                                         uncertainty =       0.001706538360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375401823
  error estimate for blocks of size 2^( 2) =       0.000393042675
  error estimate for blocks of size 2^( 3) =       0.000411371528
  error estimate for blocks of size 2^( 4) =       0.000427137454
  error estimate for blocks of size 2^( 5) =       0.000439034401
  error estimate for blocks of size 2^( 6) =       0.000446276154
  error estimate for blocks of size 2^( 7) =       0.000450278966

      target function =      -0.925434988955
              le_mean =     -16.898444927413
             les_mean =     285.849330264126
             stat err =       0.000440681744
             autocorr =       1.378025845459
   target nu stat err =       0.000440681744
   target dn stat err =       0.002534572246
      target stat err =       0.004064598058
              std dev =       0.530898349939
             le_variance =       0.281853057968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815569392
                                         uncertainty =       0.001706538686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281815569392
                                         uncertainty =       0.001706538686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375401826
  error estimate for blocks of size 2^( 2) =       0.000393042678
  error estimate for blocks of size 2^( 3) =       0.000411371531
  error estimate for blocks of size 2^( 4) =       0.000427137457
  error estimate for blocks of size 2^( 5) =       0.000439034404
  error estimate for blocks of size 2^( 6) =       0.000446276157
  error estimate for blocks of size 2^( 7) =       0.000450278969

      target function =      -0.925434663555
              le_mean =     -16.898444927288
             les_mean =     285.849330466217
             stat err =       0.000440681747
             autocorr =       1.378025846895
   target nu stat err =       0.000440681747
   target dn stat err =       0.002534586789
      target stat err =       0.004064617777
              std dev =       0.530898353617
             le_variance =       0.281853061873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925434617018        initial
     1.4901e+04     1.4901e+05             2.6439e-08        -0.925435360060  <--
     5.9605e+04     5.9605e+05             6.6097e-09        -0.925434988955
     2.3842e+05     2.3842e+06             1.6524e-09        -0.925434663555

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.3920e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153866e-02 3 1  ON 2
ci_0004                -3.137266e-02 3 1  ON 3
ci_0005                -2.891798e-02 3 1  ON 4
ci_0006                -2.995404e-02 3 1  ON 5
ci_0007                -1.586950e-02 3 1  ON 6
ci_0008                -1.650021e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888039e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563521e-02 3 1  ON 11
ci_0013                 1.549006e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629421e-02 3 1  ON 14
ci_0016                 1.595281e-02 3 1  ON 15
ci_0017                 1.373686e-02 3 1  ON 16
ci_0018                 1.393351e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224398e-02 3 1  ON 19
ci_0021                 1.352934e-02 3 1  ON 20
ci_0022                 1.500237e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823296e-03 3 1  ON 24
ci_0026                -2.392952e-03 3 1  ON 25
ci_0027                -1.179158e-02 3 1  ON 26
ci_0028                -1.174929e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290466e-02 3 1  ON 31
ci_0033                 8.253472e-03 3 1  ON 32
ci_0034                 8.532813e-03 3 1  ON 33
ci_0035                 4.881280e-03 3 1  ON 34
ci_0036                 4.735591e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817576e-03 3 1  ON 38
ci_0040                -3.939102e-03 3 1  ON 39
ci_0041                 9.549863e-03 3 1  ON 40
ci_0042                 9.454534e-03 3 1  ON 41
ci_0043                -7.797157e-03 3 1  ON 42
ci_0044                -8.255378e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667694e-03 3 1  ON 45
ci_0047                -3.596719e-03 3 1  ON 46
ci_0048                -3.622706e-03 3 1  ON 47
ci_0049                -2.504039e-03 3 1  ON 48
ci_0050                -2.579725e-03 3 1  ON 49
ci_0051                -1.839141e-03 3 1  ON 50
ci_0052                -1.721203e-03 3 1  ON 51
ci_0053                -3.849870e-03 3 1  ON 52
ci_0054                -3.734520e-03 3 1  ON 53
ci_0055                 2.334086e-03 3 1  ON 54
ci_0056                 2.075100e-03 3 1  ON 55
ci_0057                 2.310505e-03 3 1  ON 56
ci_0058                 2.892492e-03 3 1  ON 57
ci_0059                -3.897879e-03 3 1  ON 58
ci_0060                -3.669187e-03 3 1  ON 59
ci_0061                -3.113156e-03 3 1  ON 60
ci_0062                -3.326524e-03 3 1  ON 61
ci_0063                -9.707024e-03 3 1  ON 62
ci_0064                -9.660036e-03 3 1  ON 63
ci_0065                -6.920315e-03 3 1  ON 64
ci_0066                -6.464944e-03 3 1  ON 65
ci_0067                -3.907178e-03 3 1  ON 66
ci_0068                -3.850770e-03 3 1  ON 67
ci_0069                 3.717821e-03 3 1  ON 68
ci_0070                 3.465977e-03 3 1  ON 69
ci_0071                 4.079818e-03 3 1  ON 70
ci_0072                 4.253312e-03 3 1  ON 71
ci_0073                 3.371966e-03 3 1  ON 72
ci_0074                 3.331473e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.0078
    reference variance = 0.238452
====================================================
  Execution time = 1.4509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9664e-01
  Total weights = 1.951022495e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502444557
                                         uncertainty =       0.002042477893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502444557
                                         uncertainty =       0.002042477893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377769548
  error estimate for blocks of size 2^( 2) =       0.000394895513
  error estimate for blocks of size 2^( 3) =       0.000412319700
  error estimate for blocks of size 2^( 4) =       0.000427787889
  error estimate for blocks of size 2^( 5) =       0.000440179319
  error estimate for blocks of size 2^( 6) =       0.000445862458
  error estimate for blocks of size 2^( 7) =       0.000451200027

      target function =      -0.917996031217
              le_mean =     -16.898548143599
             les_mean =     285.857567776283
             stat err =       0.000441257423
             autocorr =       1.364363703629
   target nu stat err =       0.000441257423
   target dn stat err =       0.003428509255
      target stat err =       0.005370207713
              std dev =       0.534246817559
             le_variance =       0.285419662072


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689854814360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918025969352       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918025984947       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918025988827       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918025991427       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918025992740       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918025993072       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918025993125       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918025993127       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918025993178       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918025993214       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918025993251       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918025993310       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918025993309       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918025993343       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918025993328       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918025993341       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918025993334       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918025993342       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 1.178013e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918025969352       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918025973250       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918025974220       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918025974871       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918025975197       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918025975282       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918025975295       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918025975297       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918025975348       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918025975329       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918025975328       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918025975309       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918025975366       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918025975403       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918025975307       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918025975330       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918025975356       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918025975354       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 2.945056e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918025969352       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918025970326       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918025970569       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918025970731       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918025970840       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918025970834       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918025970903       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918025970939       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918025970865       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918025970739       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918025970863       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918025970785       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918025970853       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918025970901       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918025970756       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918025970824       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918025970861       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918025970930       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+04 is 7.362656e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.738184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7101e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.031195e-01 3 1  ON 0
ci_0002                 6.979580e-01 3 1  ON 1
ci_0003                -3.153866e-02 3 1  ON 2
ci_0004                -3.137266e-02 3 1  ON 3
ci_0005                -2.891799e-02 3 1  ON 4
ci_0006                -2.995404e-02 3 1  ON 5
ci_0007                -1.586950e-02 3 1  ON 6
ci_0008                -1.650020e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888037e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563520e-02 3 1  ON 11
ci_0013                 1.549005e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629421e-02 3 1  ON 14
ci_0016                 1.595280e-02 3 1  ON 15
ci_0017                 1.373686e-02 3 1  ON 16
ci_0018                 1.393352e-02 3 1  ON 17
ci_0019                 1.259660e-02 3 1  ON 18
ci_0020                 1.224398e-02 3 1  ON 19
ci_0021                 1.352931e-02 3 1  ON 20
ci_0022                 1.500235e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823295e-03 3 1  ON 24
ci_0026                -2.392940e-03 3 1  ON 25
ci_0027                -1.179158e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036569e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290465e-02 3 1  ON 31
ci_0033                 8.253473e-03 3 1  ON 32
ci_0034                 8.532803e-03 3 1  ON 33
ci_0035                 4.881276e-03 3 1  ON 34
ci_0036                 4.735589e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130897e-02 3 1  ON 37
ci_0039                -3.817577e-03 3 1  ON 38
ci_0040                -3.939099e-03 3 1  ON 39
ci_0041                 9.549863e-03 3 1  ON 40
ci_0042                 9.454532e-03 3 1  ON 41
ci_0043                -7.797168e-03 3 1  ON 42
ci_0044                -8.255393e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667695e-03 3 1  ON 45
ci_0047                -3.596718e-03 3 1  ON 46
ci_0048                -3.622704e-03 3 1  ON 47
ci_0049                -2.504033e-03 3 1  ON 48
ci_0050                -2.579725e-03 3 1  ON 49
ci_0051                -1.839141e-03 3 1  ON 50
ci_0052                -1.721201e-03 3 1  ON 51
ci_0053                -3.849875e-03 3 1  ON 52
ci_0054                -3.734514e-03 3 1  ON 53
ci_0055                 2.334085e-03 3 1  ON 54
ci_0056                 2.075099e-03 3 1  ON 55
ci_0057                 2.310510e-03 3 1  ON 56
ci_0058                 2.892492e-03 3 1  ON 57
ci_0059                -3.897880e-03 3 1  ON 58
ci_0060                -3.669182e-03 3 1  ON 59
ci_0061                -3.113160e-03 3 1  ON 60
ci_0062                -3.326528e-03 3 1  ON 61
ci_0063                -9.707023e-03 3 1  ON 62
ci_0064                -9.660036e-03 3 1  ON 63
ci_0065                -6.920316e-03 3 1  ON 64
ci_0066                -6.464942e-03 3 1  ON 65
ci_0067                -3.907177e-03 3 1  ON 66
ci_0068                -3.850769e-03 3 1  ON 67
ci_0069                 3.717820e-03 3 1  ON 68
ci_0070                 3.465979e-03 3 1  ON 69
ci_0071                 4.079812e-03 3 1  ON 70
ci_0072                 4.253303e-03 3 1  ON 71
ci_0073                 3.371966e-03 3 1  ON 72
ci_0074                 3.331472e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.92
    reference variance = 0.436166
====================================================
  Execution time = 1.4263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9277e-01
  Total weights = 1.9511e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327998045
                                         uncertainty =       0.002212966280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327998045
                                         uncertainty =       0.002212966280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375725321
  error estimate for blocks of size 2^( 2) =       0.000392767899
  error estimate for blocks of size 2^( 3) =       0.000410498574
  error estimate for blocks of size 2^( 4) =       0.000425612872
  error estimate for blocks of size 2^( 5) =       0.000437309755
  error estimate for blocks of size 2^( 6) =       0.000444471740
  error estimate for blocks of size 2^( 7) =       0.000447857849

      target function =      -0.924048154411
              le_mean =     -16.898532431788
             les_mean =     285.853170589997
             stat err =       0.000438813054
             autocorr =       1.364011865698
   target nu stat err =       0.000438813054
   target dn stat err =       0.002387751954
      target stat err =       0.003826126988
              std dev =       0.531355845147
             le_variance =       0.282339034172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327958634
                                         uncertainty =       0.002212960784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327958634
                                         uncertainty =       0.002212960784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375725295
  error estimate for blocks of size 2^( 2) =       0.000392767871
  error estimate for blocks of size 2^( 3) =       0.000410498544
  error estimate for blocks of size 2^( 4) =       0.000425612839
  error estimate for blocks of size 2^( 5) =       0.000437309720
  error estimate for blocks of size 2^( 6) =       0.000444471705
  error estimate for blocks of size 2^( 7) =       0.000447857812

      target function =      -0.924048619161
              le_mean =     -16.898532432639
             les_mean =     285.853170323081
             stat err =       0.000438813019
             autocorr =       1.364011837220
   target nu stat err =       0.000438813019
   target dn stat err =       0.002387743549
      target stat err =       0.003826117801
              std dev =       0.531355808134
             le_variance =       0.282338994838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327978339
                                         uncertainty =       0.002212963532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327978339
                                         uncertainty =       0.002212963532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375725308
  error estimate for blocks of size 2^( 2) =       0.000392767885
  error estimate for blocks of size 2^( 3) =       0.000410498559
  error estimate for blocks of size 2^( 4) =       0.000425612855
  error estimate for blocks of size 2^( 5) =       0.000437309737
  error estimate for blocks of size 2^( 6) =       0.000444471723
  error estimate for blocks of size 2^( 7) =       0.000447857830

      target function =      -0.924048387050
              le_mean =     -16.898532432214
             les_mean =     285.853170456370
             stat err =       0.000438813036
             autocorr =       1.364011851468
   target nu stat err =       0.000438813036
   target dn stat err =       0.002387747745
      target stat err =       0.003826122387
              std dev =       0.531355826640
             le_variance =       0.282339014505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327995581
                                         uncertainty =       0.002212965937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327995581
                                         uncertainty =       0.002212965937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375725320
  error estimate for blocks of size 2^( 2) =       0.000392767897
  error estimate for blocks of size 2^( 3) =       0.000410498572
  error estimate for blocks of size 2^( 4) =       0.000425612870
  error estimate for blocks of size 2^( 5) =       0.000437309753
  error estimate for blocks of size 2^( 6) =       0.000444471738
  error estimate for blocks of size 2^( 7) =       0.000447857846

      target function =      -0.924048183519
              le_mean =     -16.898532431841
             les_mean =     285.853170573276
             stat err =       0.000438813052
             autocorr =       1.364011863933
   target nu stat err =       0.000438813052
   target dn stat err =       0.002387751427
      target stat err =       0.003826126412
              std dev =       0.531355842834
             le_variance =       0.282339031714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924048154411        initial
     3.7253e+03     3.7253e+04             1.1780e-07        -0.924048619161  <--
     1.4901e+04     1.4901e+05             2.9451e-08        -0.924048387050
     5.9605e+04     5.9605e+05             7.3627e-09        -0.924048183519

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.3787e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.031196e-01 3 1  ON 0
ci_0002                 6.979579e-01 3 1  ON 1
ci_0003                -3.153865e-02 3 1  ON 2
ci_0004                -3.137265e-02 3 1  ON 3
ci_0005                -2.891802e-02 3 1  ON 4
ci_0006                -2.995404e-02 3 1  ON 5
ci_0007                -1.586948e-02 3 1  ON 6
ci_0008                -1.650017e-02 3 1  ON 7
ci_0009                -1.872282e-02 3 1  ON 8
ci_0010                -1.888033e-02 3 1  ON 9
ci_0011                -1.550631e-02 3 1  ON 10
ci_0012                -1.563518e-02 3 1  ON 11
ci_0013                 1.549005e-02 3 1  ON 12
ci_0014                 1.537523e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595276e-02 3 1  ON 15
ci_0017                 1.373686e-02 3 1  ON 16
ci_0018                 1.393352e-02 3 1  ON 17
ci_0019                 1.259661e-02 3 1  ON 18
ci_0020                 1.224398e-02 3 1  ON 19
ci_0021                 1.352922e-02 3 1  ON 20
ci_0022                 1.500226e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113285e-02 3 1  ON 23
ci_0025                -2.823293e-03 3 1  ON 24
ci_0026                -2.392906e-03 3 1  ON 25
ci_0027                -1.179158e-02 3 1  ON 26
ci_0028                -1.174931e-02 3 1  ON 27
ci_0029                -1.044354e-02 3 1  ON 28
ci_0030                -1.036567e-02 3 1  ON 29
ci_0031                 1.383437e-02 3 1  ON 30
ci_0032                 1.290463e-02 3 1  ON 31
ci_0033                 8.253475e-03 3 1  ON 32
ci_0034                 8.532772e-03 3 1  ON 33
ci_0035                 4.881264e-03 3 1  ON 34
ci_0036                 4.735583e-03 3 1  ON 35
ci_0037                -1.141420e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817581e-03 3 1  ON 38
ci_0040                -3.939093e-03 3 1  ON 39
ci_0041                 9.549862e-03 3 1  ON 40
ci_0042                 9.454523e-03 3 1  ON 41
ci_0043                -7.797204e-03 3 1  ON 42
ci_0044                -8.255437e-03 3 1  ON 43
ci_0045                 1.041903e-02 3 1  ON 44
ci_0046                 9.667697e-03 3 1  ON 45
ci_0047                -3.596715e-03 3 1  ON 46
ci_0048                -3.622701e-03 3 1  ON 47
ci_0049                -2.504016e-03 3 1  ON 48
ci_0050                -2.579725e-03 3 1  ON 49
ci_0051                -1.839143e-03 3 1  ON 50
ci_0052                -1.721196e-03 3 1  ON 51
ci_0053                -3.849890e-03 3 1  ON 52
ci_0054                -3.734495e-03 3 1  ON 53
ci_0055                 2.334082e-03 3 1  ON 54
ci_0056                 2.075095e-03 3 1  ON 55
ci_0057                 2.310522e-03 3 1  ON 56
ci_0058                 2.892491e-03 3 1  ON 57
ci_0059                -3.897884e-03 3 1  ON 58
ci_0060                -3.669166e-03 3 1  ON 59
ci_0061                -3.113171e-03 3 1  ON 60
ci_0062                -3.326539e-03 3 1  ON 61
ci_0063                -9.707021e-03 3 1  ON 62
ci_0064                -9.660034e-03 3 1  ON 63
ci_0065                -6.920319e-03 3 1  ON 64
ci_0066                -6.464938e-03 3 1  ON 65
ci_0067                -3.907174e-03 3 1  ON 66
ci_0068                -3.850767e-03 3 1  ON 67
ci_0069                 3.717815e-03 3 1  ON 68
ci_0070                 3.465984e-03 3 1  ON 69
ci_0071                 4.079794e-03 3 1  ON 70
ci_0072                 4.253279e-03 3 1  ON 71
ci_0073                 3.371965e-03 3 1  ON 72
ci_0074                 3.331470e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.8161
    reference variance = 0.254731
====================================================
  Execution time = 1.4684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9080e-01
  Total weights = 1.950984668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279230102034
                                         uncertainty =       0.001684534532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279230102034
                                         uncertainty =       0.001684534532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373649113
  error estimate for blocks of size 2^( 2) =       0.000390663179
  error estimate for blocks of size 2^( 3) =       0.000407922713
  error estimate for blocks of size 2^( 4) =       0.000423494813
  error estimate for blocks of size 2^( 5) =       0.000435488342
  error estimate for blocks of size 2^( 6) =       0.000442291485
  error estimate for blocks of size 2^( 7) =       0.000446386807

      target function =      -0.927136708261
              le_mean =     -16.898575297274
             les_mean =     285.852651307708
             stat err =       0.000436915362
             autocorr =       1.367309140055
   target nu stat err =       0.000436915362
   target dn stat err =       0.003371559214
      target stat err =       0.005386647786
              std dev =       0.528419643627
             le_variance =       0.279227319771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689857529727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927166523131       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927166628980       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927166655544       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927166666244       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927166674060       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927166675731       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927166677082       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927166677972       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927166678968       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927166679568       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927166679882       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927166680141       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927166680391       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927166680386       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927166680412       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927166680418       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927166680414       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927166680423       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927166680425       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 6.577360e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927166523131       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927166549595       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927166556236       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927166558911       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927166560866       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927166561286       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927166561621       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927166561843       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927166562088       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927166562239       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927166562318       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927166562388       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927166562442       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927166562450       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927166562455       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927166562459       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927166562467       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927166562464       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927166562457       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 1.644343e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927166523131       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927166529748       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927166531408       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927166532077       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927166532565       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927166532670       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927166532776       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927166532826       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927166532859       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927166532889       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927166532913       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927166533014       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927166532987       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927166532978       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927166532977       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927166532978       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927166532980       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927166532978       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927166532963       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 4.110858e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.749534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7263e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.031198e-01 3 1  ON 0
ci_0002                 6.979578e-01 3 1  ON 1
ci_0003                -3.153862e-02 3 1  ON 2
ci_0004                -3.137264e-02 3 1  ON 3
ci_0005                -2.891804e-02 3 1  ON 4
ci_0006                -2.995407e-02 3 1  ON 5
ci_0007                -1.586945e-02 3 1  ON 6
ci_0008                -1.650012e-02 3 1  ON 7
ci_0009                -1.872281e-02 3 1  ON 8
ci_0010                -1.888028e-02 3 1  ON 9
ci_0011                -1.550630e-02 3 1  ON 10
ci_0012                -1.563517e-02 3 1  ON 11
ci_0013                 1.549005e-02 3 1  ON 12
ci_0014                 1.537522e-02 3 1  ON 13
ci_0015                 1.629423e-02 3 1  ON 14
ci_0016                 1.595273e-02 3 1  ON 15
ci_0017                 1.373687e-02 3 1  ON 16
ci_0018                 1.393350e-02 3 1  ON 17
ci_0019                 1.259661e-02 3 1  ON 18
ci_0020                 1.224398e-02 3 1  ON 19
ci_0021                 1.352912e-02 3 1  ON 20
ci_0022                 1.500216e-02 3 1  ON 21
ci_0023                -1.182656e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823278e-03 3 1  ON 24
ci_0026                -2.392880e-03 3 1  ON 25
ci_0027                -1.179156e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044355e-02 3 1  ON 28
ci_0030                -1.036570e-02 3 1  ON 29
ci_0031                 1.383436e-02 3 1  ON 30
ci_0032                 1.290464e-02 3 1  ON 31
ci_0033                 8.253477e-03 3 1  ON 32
ci_0034                 8.532764e-03 3 1  ON 33
ci_0035                 4.881270e-03 3 1  ON 34
ci_0036                 4.735618e-03 3 1  ON 35
ci_0037                -1.141421e-02 3 1  ON 36
ci_0038                -1.130898e-02 3 1  ON 37
ci_0039                -3.817585e-03 3 1  ON 38
ci_0040                -3.939094e-03 3 1  ON 39
ci_0041                 9.549874e-03 3 1  ON 40
ci_0042                 9.454516e-03 3 1  ON 41
ci_0043                -7.797312e-03 3 1  ON 42
ci_0044                -8.255496e-03 3 1  ON 43
ci_0045                 1.041902e-02 3 1  ON 44
ci_0046                 9.667700e-03 3 1  ON 45
ci_0047                -3.596709e-03 3 1  ON 46
ci_0048                -3.622699e-03 3 1  ON 47
ci_0049                -2.504080e-03 3 1  ON 48
ci_0050                -2.579720e-03 3 1  ON 49
ci_0051                -1.839136e-03 3 1  ON 50
ci_0052                -1.721202e-03 3 1  ON 51
ci_0053                -3.849888e-03 3 1  ON 52
ci_0054                -3.734470e-03 3 1  ON 53
ci_0055                 2.334070e-03 3 1  ON 54
ci_0056                 2.075088e-03 3 1  ON 55
ci_0057                 2.310538e-03 3 1  ON 56
ci_0058                 2.892515e-03 3 1  ON 57
ci_0059                -3.897895e-03 3 1  ON 58
ci_0060                -3.669156e-03 3 1  ON 59
ci_0061                -3.113172e-03 3 1  ON 60
ci_0062                -3.326555e-03 3 1  ON 61
ci_0063                -9.707016e-03 3 1  ON 62
ci_0064                -9.660039e-03 3 1  ON 63
ci_0065                -6.920294e-03 3 1  ON 64
ci_0066                -6.464926e-03 3 1  ON 65
ci_0067                -3.907157e-03 3 1  ON 66
ci_0068                -3.850732e-03 3 1  ON 67
ci_0069                 3.717798e-03 3 1  ON 68
ci_0070                 3.465917e-03 3 1  ON 69
ci_0071                 4.079790e-03 3 1  ON 70
ci_0072                 4.253268e-03 3 1  ON 71
ci_0073                 3.371966e-03 3 1  ON 72
ci_0074                 3.331474e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9082
    reference variance = 0.193021
====================================================
  Execution time = 1.4144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9397e-01
  Total weights = 1.9511e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284580015511
                                         uncertainty =       0.001965702342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284580015511
                                         uncertainty =       0.001965702342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377164635
  error estimate for blocks of size 2^( 2) =       0.000394732098
  error estimate for blocks of size 2^( 3) =       0.000412876606
  error estimate for blocks of size 2^( 4) =       0.000428902460
  error estimate for blocks of size 2^( 5) =       0.000440811144
  error estimate for blocks of size 2^( 6) =       0.000447861028
  error estimate for blocks of size 2^( 7) =       0.000449724087

      target function =      -0.922166741885
              le_mean =     -16.897709275905
             les_mean =     285.826546759458
             stat err =       0.000441824680
             autocorr =       1.372265083395
   target nu stat err =       0.000441824680
   target dn stat err =       0.002546981072
      target stat err =       0.004050387883
              std dev =       0.533391342735
             le_variance =       0.284506324504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284579844052
                                         uncertainty =       0.001965693840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284579844052
                                         uncertainty =       0.001965693840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377164522
  error estimate for blocks of size 2^( 2) =       0.000394731981
  error estimate for blocks of size 2^( 3) =       0.000412876482
  error estimate for blocks of size 2^( 4) =       0.000428902323
  error estimate for blocks of size 2^( 5) =       0.000440810996
  error estimate for blocks of size 2^( 6) =       0.000447860876
  error estimate for blocks of size 2^( 7) =       0.000449723936

      target function =      -0.922167136399
              le_mean =     -16.897709278482
             les_mean =     285.826546594533
             stat err =       0.000441824533
             autocorr =       1.372264997133
   target nu stat err =       0.000441824533
   target dn stat err =       0.002546934553
      target stat err =       0.004050319811
              std dev =       0.533391182217
             le_variance =       0.284506153267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284579929775
                                         uncertainty =       0.001965698090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284579929775
                                         uncertainty =       0.001965698090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377164579
  error estimate for blocks of size 2^( 2) =       0.000394732040
  error estimate for blocks of size 2^( 3) =       0.000412876544
  error estimate for blocks of size 2^( 4) =       0.000428902392
  error estimate for blocks of size 2^( 5) =       0.000440811070
  error estimate for blocks of size 2^( 6) =       0.000447860952
  error estimate for blocks of size 2^( 7) =       0.000449724011

      target function =      -0.922166939238
              le_mean =     -16.897709277193
             les_mean =     285.826546676922
             stat err =       0.000441824606
             autocorr =       1.372265040262
   target nu stat err =       0.000441824606
   target dn stat err =       0.002546957809
      target stat err =       0.004050353844
              std dev =       0.533391262470
             le_variance =       0.284506238879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284580004794
                                         uncertainty =       0.001965701810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284580004794
                                         uncertainty =       0.001965701810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377164628
  error estimate for blocks of size 2^( 2) =       0.000394732091
  error estimate for blocks of size 2^( 3) =       0.000412876599
  error estimate for blocks of size 2^( 4) =       0.000428902452
  error estimate for blocks of size 2^( 5) =       0.000440811135
  error estimate for blocks of size 2^( 6) =       0.000447861018
  error estimate for blocks of size 2^( 7) =       0.000449724077

      target function =      -0.922166766564
              le_mean =     -16.897709276066
             les_mean =     285.826546749134
             stat err =       0.000441824670
             autocorr =       1.372265078005
   target nu stat err =       0.000441824670
   target dn stat err =       0.002546978164
      target stat err =       0.004050383628
              std dev =       0.533391332701
             le_variance =       0.284506313801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922166741885        initial
     9.3132e+02     9.3132e+03             6.5774e-07        -0.922167136399  <--
     3.7253e+03     3.7253e+04             1.6443e-07        -0.922166939238
     1.4901e+04     1.4901e+05             4.1109e-08        -0.922166766564

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 2.3689e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.031203e-01 3 1  ON 0
ci_0002                 6.979573e-01 3 1  ON 1
ci_0003                -3.153852e-02 3 1  ON 2
ci_0004                -3.137259e-02 3 1  ON 3
ci_0005                -2.891810e-02 3 1  ON 4
ci_0006                -2.995419e-02 3 1  ON 5
ci_0007                -1.586935e-02 3 1  ON 6
ci_0008                -1.649997e-02 3 1  ON 7
ci_0009                -1.872279e-02 3 1  ON 8
ci_0010                -1.888013e-02 3 1  ON 9
ci_0011                -1.550626e-02 3 1  ON 10
ci_0012                -1.563514e-02 3 1  ON 11
ci_0013                 1.549004e-02 3 1  ON 12
ci_0014                 1.537520e-02 3 1  ON 13
ci_0015                 1.629426e-02 3 1  ON 14
ci_0016                 1.595264e-02 3 1  ON 15
ci_0017                 1.373688e-02 3 1  ON 16
ci_0018                 1.393344e-02 3 1  ON 17
ci_0019                 1.259663e-02 3 1  ON 18
ci_0020                 1.224397e-02 3 1  ON 19
ci_0021                 1.352880e-02 3 1  ON 20
ci_0022                 1.500185e-02 3 1  ON 21
ci_0023                -1.182657e-02 3 1  ON 22
ci_0024                -1.113279e-02 3 1  ON 23
ci_0025                -2.823234e-03 3 1  ON 24
ci_0026                -2.392803e-03 3 1  ON 25
ci_0027                -1.179151e-02 3 1  ON 26
ci_0028                -1.174928e-02 3 1  ON 27
ci_0029                -1.044357e-02 3 1  ON 28
ci_0030                -1.036579e-02 3 1  ON 29
ci_0031                 1.383430e-02 3 1  ON 30
ci_0032                 1.290466e-02 3 1  ON 31
ci_0033                 8.253483e-03 3 1  ON 32
ci_0034                 8.532739e-03 3 1  ON 33
ci_0035                 4.881288e-03 3 1  ON 34
ci_0036                 4.735724e-03 3 1  ON 35
ci_0037                -1.141425e-02 3 1  ON 36
ci_0038                -1.130899e-02 3 1  ON 37
ci_0039                -3.817599e-03 3 1  ON 38
ci_0040                -3.939099e-03 3 1  ON 39
ci_0041                 9.549910e-03 3 1  ON 40
ci_0042                 9.454495e-03 3 1  ON 41
ci_0043                -7.797634e-03 3 1  ON 42
ci_0044                -8.255673e-03 3 1  ON 43
ci_0045                 1.041899e-02 3 1  ON 44
ci_0046                 9.667709e-03 3 1  ON 45
ci_0047                -3.596694e-03 3 1  ON 46
ci_0048                -3.622695e-03 3 1  ON 47
ci_0049                -2.504272e-03 3 1  ON 48
ci_0050                -2.579705e-03 3 1  ON 49
ci_0051                -1.839115e-03 3 1  ON 50
ci_0052                -1.721219e-03 3 1  ON 51
ci_0053                -3.849882e-03 3 1  ON 52
ci_0054                -3.734395e-03 3 1  ON 53
ci_0055                 2.334032e-03 3 1  ON 54
ci_0056                 2.075065e-03 3 1  ON 55
ci_0057                 2.310585e-03 3 1  ON 56
ci_0058                 2.892585e-03 3 1  ON 57
ci_0059                -3.897926e-03 3 1  ON 58
ci_0060                -3.669124e-03 3 1  ON 59
ci_0061                -3.113174e-03 3 1  ON 60
ci_0062                -3.326601e-03 3 1  ON 61
ci_0063                -9.707002e-03 3 1  ON 62
ci_0064                -9.660056e-03 3 1  ON 63
ci_0065                -6.920217e-03 3 1  ON 64
ci_0066                -6.464891e-03 3 1  ON 65
ci_0067                -3.907107e-03 3 1  ON 66
ci_0068                -3.850626e-03 3 1  ON 67
ci_0069                 3.717746e-03 3 1  ON 68
ci_0070                 3.465715e-03 3 1  ON 69
ci_0071                 4.079778e-03 3 1  ON 70
ci_0072                 4.253235e-03 3 1  ON 71
ci_0073                 3.371968e-03 3 1  ON 72
ci_0074                 3.331484e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8697
    reference variance = 0.269684
====================================================
  Execution time = 1.4694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9032e-01
  Total weights = 1.950841226e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281157592578
                                         uncertainty =       0.001822591582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281157592578
                                         uncertainty =       0.001822591582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374905073
  error estimate for blocks of size 2^( 2) =       0.000392430602
  error estimate for blocks of size 2^( 3) =       0.000410636621
  error estimate for blocks of size 2^( 4) =       0.000427078498
  error estimate for blocks of size 2^( 5) =       0.000438915240
  error estimate for blocks of size 2^( 6) =       0.000446447379
  error estimate for blocks of size 2^( 7) =       0.000451835446

      target function =      -0.927909874306
              le_mean =     -16.897902559282
             les_mean =     285.829431522711
             stat err =       0.000441069141
             autocorr =       1.384110339396
   target nu stat err =       0.000441069141
   target dn stat err =       0.002214381608
      target stat err =       0.003585084437
              std dev =       0.530195839119
             le_variance =       0.281107627819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689790255928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927922228949       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927922466454       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927922529463       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927922566636       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927922586820       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927922591376       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927922593938       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927922595494       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927922595667       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927922595642       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927922596960       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927922596862       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927922597104       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927922597198       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927922597234       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927922597233       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927922597216       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927922597220       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 2.108486e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927922228949       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927922288340       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927922304096       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927922313390       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927922318435       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927922319575       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927922320215       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927922320603       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927922320645       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927922320642       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927922320971       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927922320946       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927922321004       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927922321031       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927922321036       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927922321038       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927922321034       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927922321034       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 5.271943e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927922228949       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927922243798       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927922247737       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927922250060       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927922251321       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927922251601       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927922251773       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927922251859       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927922251874       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927922251873       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927922251951       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927922251957       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927922251963       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927922251976       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927922251970       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927922251970       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927922251974       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927922251973       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 1.318031e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.760010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7280e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.031201e-01 3 1  ON 0
ci_0002                 6.979576e-01 3 1  ON 1
ci_0003                -3.153838e-02 3 1  ON 2
ci_0004                -3.137251e-02 3 1  ON 3
ci_0005                -2.891816e-02 3 1  ON 4
ci_0006                -2.995435e-02 3 1  ON 5
ci_0007                -1.586922e-02 3 1  ON 6
ci_0008                -1.649976e-02 3 1  ON 7
ci_0009                -1.872272e-02 3 1  ON 8
ci_0010                -1.888004e-02 3 1  ON 9
ci_0011                -1.550620e-02 3 1  ON 10
ci_0012                -1.563510e-02 3 1  ON 11
ci_0013                 1.548996e-02 3 1  ON 12
ci_0014                 1.537511e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595260e-02 3 1  ON 15
ci_0017                 1.373681e-02 3 1  ON 16
ci_0018                 1.393339e-02 3 1  ON 17
ci_0019                 1.259662e-02 3 1  ON 18
ci_0020                 1.224402e-02 3 1  ON 19
ci_0021                 1.352827e-02 3 1  ON 20
ci_0022                 1.500144e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823119e-03 3 1  ON 24
ci_0026                -2.392804e-03 3 1  ON 25
ci_0027                -1.179153e-02 3 1  ON 26
ci_0028                -1.174931e-02 3 1  ON 27
ci_0029                -1.044358e-02 3 1  ON 28
ci_0030                -1.036586e-02 3 1  ON 29
ci_0031                 1.383431e-02 3 1  ON 30
ci_0032                 1.290462e-02 3 1  ON 31
ci_0033                 8.253500e-03 3 1  ON 32
ci_0034                 8.532636e-03 3 1  ON 33
ci_0035                 4.881086e-03 3 1  ON 34
ci_0036                 4.735783e-03 3 1  ON 35
ci_0037                -1.141422e-02 3 1  ON 36
ci_0038                -1.130903e-02 3 1  ON 37
ci_0039                -3.817641e-03 3 1  ON 38
ci_0040                -3.939112e-03 3 1  ON 39
ci_0041                 9.549873e-03 3 1  ON 40
ci_0042                 9.454489e-03 3 1  ON 41
ci_0043                -7.797932e-03 3 1  ON 42
ci_0044                -8.255997e-03 3 1  ON 43
ci_0045                 1.041897e-02 3 1  ON 44
ci_0046                 9.667674e-03 3 1  ON 45
ci_0047                -3.596682e-03 3 1  ON 46
ci_0048                -3.622708e-03 3 1  ON 47
ci_0049                -2.504423e-03 3 1  ON 48
ci_0050                -2.579609e-03 3 1  ON 49
ci_0051                -1.839117e-03 3 1  ON 50
ci_0052                -1.721261e-03 3 1  ON 51
ci_0053                -3.849896e-03 3 1  ON 52
ci_0054                -3.734483e-03 3 1  ON 53
ci_0055                 2.334052e-03 3 1  ON 54
ci_0056                 2.075099e-03 3 1  ON 55
ci_0057                 2.310664e-03 3 1  ON 56
ci_0058                 2.892711e-03 3 1  ON 57
ci_0059                -3.897825e-03 3 1  ON 58
ci_0060                -3.669105e-03 3 1  ON 59
ci_0061                -3.113286e-03 3 1  ON 60
ci_0062                -3.326615e-03 3 1  ON 61
ci_0063                -9.707051e-03 3 1  ON 62
ci_0064                -9.659985e-03 3 1  ON 63
ci_0065                -6.920149e-03 3 1  ON 64
ci_0066                -6.464894e-03 3 1  ON 65
ci_0067                -3.907064e-03 3 1  ON 66
ci_0068                -3.850585e-03 3 1  ON 67
ci_0069                 3.717772e-03 3 1  ON 68
ci_0070                 3.465722e-03 3 1  ON 69
ci_0071                 4.079810e-03 3 1  ON 70
ci_0072                 4.253216e-03 3 1  ON 71
ci_0073                 3.371948e-03 3 1  ON 72
ci_0074                 3.331445e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8901
    reference variance = 0.247626
====================================================
  Execution time = 1.4163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9108e-01
  Total weights = 1.9507e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685153380
                                         uncertainty =       0.002077269922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685153380
                                         uncertainty =       0.002077269922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375315729
  error estimate for blocks of size 2^( 2) =       0.000392920315
  error estimate for blocks of size 2^( 3) =       0.000410856754
  error estimate for blocks of size 2^( 4) =       0.000426581420
  error estimate for blocks of size 2^( 5) =       0.000438167398
  error estimate for blocks of size 2^( 6) =       0.000445350056
  error estimate for blocks of size 2^( 7) =       0.000451280806

      target function =      -0.926711835531
              le_mean =     -16.898483493598
             les_mean =     285.849823331045
             stat err =       0.000440344920
             autocorr =       1.376551455660
   target nu stat err =       0.000440344920
   target dn stat err =       0.002726669534
      target stat err =       0.004374604494
              std dev =       0.530776594309
             le_variance =       0.281723793067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685530529
                                         uncertainty =       0.002077768219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685530529
                                         uncertainty =       0.002077768219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375315977
  error estimate for blocks of size 2^( 2) =       0.000392920491
  error estimate for blocks of size 2^( 3) =       0.000410856856
  error estimate for blocks of size 2^( 4) =       0.000426581434
  error estimate for blocks of size 2^( 5) =       0.000438167340
  error estimate for blocks of size 2^( 6) =       0.000445349880
  error estimate for blocks of size 2^( 7) =       0.000451280582

      target function =      -0.926711905292
              le_mean =     -16.898483504564
             les_mean =     285.849823650243
             stat err =       0.000440344809
             autocorr =       1.376548941100
   target nu stat err =       0.000440344809
   target dn stat err =       0.002727470281
      target stat err =       0.004375852094
              std dev =       0.530776945368
             le_variance =       0.281724165734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685341862
                                         uncertainty =       0.002077519028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685341862
                                         uncertainty =       0.002077519028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375315853
  error estimate for blocks of size 2^( 2) =       0.000392920403
  error estimate for blocks of size 2^( 3) =       0.000410856805
  error estimate for blocks of size 2^( 4) =       0.000426581427
  error estimate for blocks of size 2^( 5) =       0.000438167369
  error estimate for blocks of size 2^( 6) =       0.000445349968
  error estimate for blocks of size 2^( 7) =       0.000451280694

      target function =      -0.926712325907
              le_mean =     -16.898483499074
             les_mean =     285.849823202211
             stat err =       0.000440344865
             autocorr =       1.376550198373
   target nu stat err =       0.000440344865
   target dn stat err =       0.002727069742
      target stat err =       0.004375232273
              std dev =       0.530776769752
             le_variance =       0.281723979308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685176926
                                         uncertainty =       0.002077301051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281685176926
                                         uncertainty =       0.002077301051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375315745
  error estimate for blocks of size 2^( 2) =       0.000392920326
  error estimate for blocks of size 2^( 3) =       0.000410856761
  error estimate for blocks of size 2^( 4) =       0.000426581421
  error estimate for blocks of size 2^( 5) =       0.000438167395
  error estimate for blocks of size 2^( 6) =       0.000445350045
  error estimate for blocks of size 2^( 7) =       0.000451280792

      target function =      -0.926712048772
              le_mean =     -16.898483494281
             les_mean =     285.849823218758
             stat err =       0.000440344913
             autocorr =       1.376551298505
   target nu stat err =       0.000440344913
   target dn stat err =       0.002726719505
      target stat err =       0.004374684294
              std dev =       0.530776616226
             le_variance =       0.281723816332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926711835531        initial
     2.3283e+02     2.3283e+03             2.1085e-06        -0.926711905292
     9.3132e+02     9.3132e+03             5.2719e-07        -0.926712325907  <--
     3.7253e+03     3.7253e+04             1.3180e-07        -0.926712048772

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 2.3710e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.031201e-01 3 1  ON 0
ci_0002                 6.979576e-01 3 1  ON 1
ci_0003                -3.153838e-02 3 1  ON 2
ci_0004                -3.137251e-02 3 1  ON 3
ci_0005                -2.891816e-02 3 1  ON 4
ci_0006                -2.995435e-02 3 1  ON 5
ci_0007                -1.586922e-02 3 1  ON 6
ci_0008                -1.649976e-02 3 1  ON 7
ci_0009                -1.872272e-02 3 1  ON 8
ci_0010                -1.888004e-02 3 1  ON 9
ci_0011                -1.550620e-02 3 1  ON 10
ci_0012                -1.563510e-02 3 1  ON 11
ci_0013                 1.548996e-02 3 1  ON 12
ci_0014                 1.537511e-02 3 1  ON 13
ci_0015                 1.629422e-02 3 1  ON 14
ci_0016                 1.595260e-02 3 1  ON 15
ci_0017                 1.373681e-02 3 1  ON 16
ci_0018                 1.393339e-02 3 1  ON 17
ci_0019                 1.259662e-02 3 1  ON 18
ci_0020                 1.224402e-02 3 1  ON 19
ci_0021                 1.352827e-02 3 1  ON 20
ci_0022                 1.500144e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113284e-02 3 1  ON 23
ci_0025                -2.823119e-03 3 1  ON 24
ci_0026                -2.392804e-03 3 1  ON 25
ci_0027                -1.179153e-02 3 1  ON 26
ci_0028                -1.174931e-02 3 1  ON 27
ci_0029                -1.044358e-02 3 1  ON 28
ci_0030                -1.036586e-02 3 1  ON 29
ci_0031                 1.383431e-02 3 1  ON 30
ci_0032                 1.290462e-02 3 1  ON 31
ci_0033                 8.253500e-03 3 1  ON 32
ci_0034                 8.532636e-03 3 1  ON 33
ci_0035                 4.881086e-03 3 1  ON 34
ci_0036                 4.735783e-03 3 1  ON 35
ci_0037                -1.141422e-02 3 1  ON 36
ci_0038                -1.130903e-02 3 1  ON 37
ci_0039                -3.817641e-03 3 1  ON 38
ci_0040                -3.939112e-03 3 1  ON 39
ci_0041                 9.549873e-03 3 1  ON 40
ci_0042                 9.454489e-03 3 1  ON 41
ci_0043                -7.797932e-03 3 1  ON 42
ci_0044                -8.255997e-03 3 1  ON 43
ci_0045                 1.041897e-02 3 1  ON 44
ci_0046                 9.667674e-03 3 1  ON 45
ci_0047                -3.596682e-03 3 1  ON 46
ci_0048                -3.622708e-03 3 1  ON 47
ci_0049                -2.504423e-03 3 1  ON 48
ci_0050                -2.579609e-03 3 1  ON 49
ci_0051                -1.839117e-03 3 1  ON 50
ci_0052                -1.721261e-03 3 1  ON 51
ci_0053                -3.849896e-03 3 1  ON 52
ci_0054                -3.734483e-03 3 1  ON 53
ci_0055                 2.334052e-03 3 1  ON 54
ci_0056                 2.075099e-03 3 1  ON 55
ci_0057                 2.310664e-03 3 1  ON 56
ci_0058                 2.892711e-03 3 1  ON 57
ci_0059                -3.897825e-03 3 1  ON 58
ci_0060                -3.669105e-03 3 1  ON 59
ci_0061                -3.113286e-03 3 1  ON 60
ci_0062                -3.326615e-03 3 1  ON 61
ci_0063                -9.707051e-03 3 1  ON 62
ci_0064                -9.659985e-03 3 1  ON 63
ci_0065                -6.920149e-03 3 1  ON 64
ci_0066                -6.464894e-03 3 1  ON 65
ci_0067                -3.907064e-03 3 1  ON 66
ci_0068                -3.850585e-03 3 1  ON 67
ci_0069                 3.717772e-03 3 1  ON 68
ci_0070                 3.465722e-03 3 1  ON 69
ci_0071                 4.079810e-03 3 1  ON 70
ci_0072                 4.253216e-03 3 1  ON 71
ci_0073                 3.371948e-03 3 1  ON 72
ci_0074                 3.331445e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.187577
====================================================
  Execution time = 1.6666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5197e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9175e-01
  Total weights = 1.950703239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281901006177
                                         uncertainty =       0.002253006847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281901006177
                                         uncertainty =       0.002253006847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375671621
  error estimate for blocks of size 2^( 2) =       0.000393037594
  error estimate for blocks of size 2^( 3) =       0.000410753974
  error estimate for blocks of size 2^( 4) =       0.000426704445
  error estimate for blocks of size 2^( 5) =       0.000439125845
  error estimate for blocks of size 2^( 6) =       0.000446844686
  error estimate for blocks of size 2^( 7) =       0.000451737098

      target function =      -0.925648408780
              le_mean =     -16.898567000457
             les_mean =     285.853313884878
             stat err =       0.000441103018
             autocorr =       1.378679386858
   target nu stat err =       0.000441103018
   target dn stat err =       0.003315660680
      target stat err =       0.005283156144
              std dev =       0.531279901024
             le_variance =       0.282258333232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689856700046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925676713286       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925676947172       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925677014212       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925677075554       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925677102541       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925677110235       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925677113913       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925677115206       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925677116285       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925677117077       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925677118128       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925677119023       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925677119192       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925677119344       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925677119413       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925677119471       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925677119536       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925677119540       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 2.485062e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925676713286       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925676771772       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925676788535       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925676803872       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925676810619       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925676812541       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925676813461       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925676813785       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925676814054       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925676814252       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925676814516       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925676814738       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925676814783       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925676814818       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925676814836       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925676814850       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925676814867       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925676814864       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 6.213496e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925676713286       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925676727909       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925676732100       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925676735934       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925676737623       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925676738112       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925676738335       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925676738411       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925676738483       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925676738535       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925676738599       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925676738656       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925676738658       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925676738679       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925676738679       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925676738663       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925676738684       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925676738680       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 1.553427e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.770277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9229e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.031204e-01 3 1  ON 0
ci_0002                 6.979572e-01 3 1  ON 1
ci_0003                -3.153832e-02 3 1  ON 2
ci_0004                -3.137235e-02 3 1  ON 3
ci_0005                -2.891821e-02 3 1  ON 4
ci_0006                -2.995430e-02 3 1  ON 5
ci_0007                -1.586903e-02 3 1  ON 6
ci_0008                -1.649968e-02 3 1  ON 7
ci_0009                -1.872267e-02 3 1  ON 8
ci_0010                -1.887998e-02 3 1  ON 9
ci_0011                -1.550614e-02 3 1  ON 10
ci_0012                -1.563497e-02 3 1  ON 11
ci_0013                 1.548989e-02 3 1  ON 12
ci_0014                 1.537512e-02 3 1  ON 13
ci_0015                 1.629420e-02 3 1  ON 14
ci_0016                 1.595256e-02 3 1  ON 15
ci_0017                 1.373677e-02 3 1  ON 16
ci_0018                 1.393335e-02 3 1  ON 17
ci_0019                 1.259669e-02 3 1  ON 18
ci_0020                 1.224406e-02 3 1  ON 19
ci_0021                 1.352768e-02 3 1  ON 20
ci_0022                 1.500082e-02 3 1  ON 21
ci_0023                -1.182663e-02 3 1  ON 22
ci_0024                -1.113287e-02 3 1  ON 23
ci_0025                -2.823119e-03 3 1  ON 24
ci_0026                -2.392778e-03 3 1  ON 25
ci_0027                -1.179158e-02 3 1  ON 26
ci_0028                -1.174930e-02 3 1  ON 27
ci_0029                -1.044359e-02 3 1  ON 28
ci_0030                -1.036576e-02 3 1  ON 29
ci_0031                 1.383429e-02 3 1  ON 30
ci_0032                 1.290463e-02 3 1  ON 31
ci_0033                 8.253457e-03 3 1  ON 32
ci_0034                 8.532609e-03 3 1  ON 33
ci_0035                 4.881164e-03 3 1  ON 34
ci_0036                 4.735741e-03 3 1  ON 35
ci_0037                -1.141415e-02 3 1  ON 36
ci_0038                -1.130900e-02 3 1  ON 37
ci_0039                -3.817683e-03 3 1  ON 38
ci_0040                -3.939079e-03 3 1  ON 39
ci_0041                 9.549830e-03 3 1  ON 40
ci_0042                 9.454426e-03 3 1  ON 41
ci_0043                -7.798265e-03 3 1  ON 42
ci_0044                -8.256358e-03 3 1  ON 43
ci_0045                 1.041900e-02 3 1  ON 44
ci_0046                 9.667681e-03 3 1  ON 45
ci_0047                -3.596665e-03 3 1  ON 46
ci_0048                -3.622653e-03 3 1  ON 47
ci_0049                -2.504470e-03 3 1  ON 48
ci_0050                -2.579570e-03 3 1  ON 49
ci_0051                -1.839073e-03 3 1  ON 50
ci_0052                -1.721291e-03 3 1  ON 51
ci_0053                -3.849885e-03 3 1  ON 52
ci_0054                -3.734388e-03 3 1  ON 53
ci_0055                 2.334175e-03 3 1  ON 54
ci_0056                 2.075167e-03 3 1  ON 55
ci_0057                 2.310685e-03 3 1  ON 56
ci_0058                 2.892591e-03 3 1  ON 57
ci_0059                -3.897798e-03 3 1  ON 58
ci_0060                -3.669139e-03 3 1  ON 59
ci_0061                -3.113379e-03 3 1  ON 60
ci_0062                -3.326635e-03 3 1  ON 61
ci_0063                -9.707014e-03 3 1  ON 62
ci_0064                -9.660059e-03 3 1  ON 63
ci_0065                -6.920039e-03 3 1  ON 64
ci_0066                -6.464854e-03 3 1  ON 65
ci_0067                -3.907078e-03 3 1  ON 66
ci_0068                -3.850531e-03 3 1  ON 67
ci_0069                 3.717761e-03 3 1  ON 68
ci_0070                 3.465699e-03 3 1  ON 69
ci_0071                 4.079770e-03 3 1  ON 70
ci_0072                 4.253012e-03 3 1  ON 71
ci_0073                 3.371921e-03 3 1  ON 72
ci_0074                 3.331487e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9175
    reference variance = 0.307176
====================================================
  Execution time = 1.4378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9314e-01
  Total weights = 1.9509e+06
  Execution time = 1.8788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285586560
                                         uncertainty =       0.001789800531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285586560
                                         uncertainty =       0.001789800531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376980216
  error estimate for blocks of size 2^( 2) =       0.000394514015
  error estimate for blocks of size 2^( 3) =       0.000412984911
  error estimate for blocks of size 2^( 4) =       0.000429176015
  error estimate for blocks of size 2^( 5) =       0.000441973052
  error estimate for blocks of size 2^( 6) =       0.000450742846
  error estimate for blocks of size 2^( 7) =       0.000454816324

      target function =      -0.923471659980
              le_mean =     -16.897425007120
             les_mean =     285.816107372232
             stat err =       0.000444177059
             autocorr =       1.388273807807
   target nu stat err =       0.000444177059
   target dn stat err =       0.002193336624
      target stat err =       0.003517415148
              std dev =       0.533130534919
             le_variance =       0.284228167263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285030332
                                         uncertainty =       0.001789793544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285030332
                                         uncertainty =       0.001789793544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376979848
  error estimate for blocks of size 2^( 2) =       0.000394513591
  error estimate for blocks of size 2^( 3) =       0.000412984422
  error estimate for blocks of size 2^( 4) =       0.000429175452
  error estimate for blocks of size 2^( 5) =       0.000441972406
  error estimate for blocks of size 2^( 6) =       0.000450742157
  error estimate for blocks of size 2^( 7) =       0.000454815624

      target function =      -0.923472512776
              le_mean =     -16.897425015634
             les_mean =     285.816107116037
             stat err =       0.000444176410
             autocorr =       1.388272459772
   target nu stat err =       0.000444176410
   target dn stat err =       0.002193274933
      target stat err =       0.003517326918
              std dev =       0.533130014257
             le_variance =       0.284227612102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285308362
                                         uncertainty =       0.001789797037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285308362
                                         uncertainty =       0.001789797037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376980032
  error estimate for blocks of size 2^( 2) =       0.000394513803
  error estimate for blocks of size 2^( 3) =       0.000412984667
  error estimate for blocks of size 2^( 4) =       0.000429175733
  error estimate for blocks of size 2^( 5) =       0.000441972729
  error estimate for blocks of size 2^( 6) =       0.000450742502
  error estimate for blocks of size 2^( 7) =       0.000454815974

      target function =      -0.923472102342
              le_mean =     -16.897425011373
             les_mean =     285.816107233796
             stat err =       0.000444176735
             autocorr =       1.388273133689
   target nu stat err =       0.000444176735
   target dn stat err =       0.002193305597
      target stat err =       0.003517370874
              std dev =       0.533130274510
             le_variance =       0.284227889599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285551780
                                         uncertainty =       0.001789800094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284285551780
                                         uncertainty =       0.001789800094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376980193
  error estimate for blocks of size 2^( 2) =       0.000394513989
  error estimate for blocks of size 2^( 3) =       0.000412984881
  error estimate for blocks of size 2^( 4) =       0.000429175979
  error estimate for blocks of size 2^( 5) =       0.000441973012
  error estimate for blocks of size 2^( 6) =       0.000450742803
  error estimate for blocks of size 2^( 7) =       0.000454816281

      target function =      -0.923471716970
              le_mean =     -16.897425007651
             les_mean =     285.816107353827
             stat err =       0.000444177019
             autocorr =       1.388273723539
   target nu stat err =       0.000444177019
   target dn stat err =       0.002193332727
      target stat err =       0.003517409597
              std dev =       0.533130502363
             le_variance =       0.284228132550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923471659980        initial
     2.3283e+02     2.3283e+03             2.4851e-06        -0.923472512776  <--
     9.3132e+02     9.3132e+03             6.2135e-07        -0.923472102342
     3.7253e+03     3.7253e+04             1.5534e-07        -0.923471716970

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 2.3868e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.031216e-01 3 1  ON 0
ci_0002                 6.979562e-01 3 1  ON 1
ci_0003                -3.153817e-02 3 1  ON 2
ci_0004                -3.137185e-02 3 1  ON 3
ci_0005                -2.891838e-02 3 1  ON 4
ci_0006                -2.995415e-02 3 1  ON 5
ci_0007                -1.586847e-02 3 1  ON 6
ci_0008                -1.649943e-02 3 1  ON 7
ci_0009                -1.872252e-02 3 1  ON 8
ci_0010                -1.887978e-02 3 1  ON 9
ci_0011                -1.550597e-02 3 1  ON 10
ci_0012                -1.563456e-02 3 1  ON 11
ci_0013                 1.548970e-02 3 1  ON 12
ci_0014                 1.537514e-02 3 1  ON 13
ci_0015                 1.629411e-02 3 1  ON 14
ci_0016                 1.595241e-02 3 1  ON 15
ci_0017                 1.373664e-02 3 1  ON 16
ci_0018                 1.393323e-02 3 1  ON 17
ci_0019                 1.259691e-02 3 1  ON 18
ci_0020                 1.224415e-02 3 1  ON 19
ci_0021                 1.352592e-02 3 1  ON 20
ci_0022                 1.499895e-02 3 1  ON 21
ci_0023                -1.182678e-02 3 1  ON 22
ci_0024                -1.113297e-02 3 1  ON 23
ci_0025                -2.823121e-03 3 1  ON 24
ci_0026                -2.392702e-03 3 1  ON 25
ci_0027                -1.179170e-02 3 1  ON 26
ci_0028                -1.174926e-02 3 1  ON 27
ci_0029                -1.044361e-02 3 1  ON 28
ci_0030                -1.036549e-02 3 1  ON 29
ci_0031                 1.383425e-02 3 1  ON 30
ci_0032                 1.290467e-02 3 1  ON 31
ci_0033                 8.253330e-03 3 1  ON 32
ci_0034                 8.532527e-03 3 1  ON 33
ci_0035                 4.881399e-03 3 1  ON 34
ci_0036                 4.735613e-03 3 1  ON 35
ci_0037                -1.141395e-02 3 1  ON 36
ci_0038                -1.130891e-02 3 1  ON 37
ci_0039                -3.817810e-03 3 1  ON 38
ci_0040                -3.938981e-03 3 1  ON 39
ci_0041                 9.549703e-03 3 1  ON 40
ci_0042                 9.454236e-03 3 1  ON 41
ci_0043                -7.799265e-03 3 1  ON 42
ci_0044                -8.257439e-03 3 1  ON 43
ci_0045                 1.041909e-02 3 1  ON 44
ci_0046                 9.667701e-03 3 1  ON 45
ci_0047                -3.596615e-03 3 1  ON 46
ci_0048                -3.622489e-03 3 1  ON 47
ci_0049                -2.504611e-03 3 1  ON 48
ci_0050                -2.579455e-03 3 1  ON 49
ci_0051                -1.838943e-03 3 1  ON 50
ci_0052                -1.721379e-03 3 1  ON 51
ci_0053                -3.849853e-03 3 1  ON 52
ci_0054                -3.734104e-03 3 1  ON 53
ci_0055                 2.334543e-03 3 1  ON 54
ci_0056                 2.075372e-03 3 1  ON 55
ci_0057                 2.310748e-03 3 1  ON 56
ci_0058                 2.892230e-03 3 1  ON 57
ci_0059                -3.897717e-03 3 1  ON 58
ci_0060                -3.669243e-03 3 1  ON 59
ci_0061                -3.113657e-03 3 1  ON 60
ci_0062                -3.326693e-03 3 1  ON 61
ci_0063                -9.706902e-03 3 1  ON 62
ci_0064                -9.660280e-03 3 1  ON 63
ci_0065                -6.919708e-03 3 1  ON 64
ci_0066                -6.464735e-03 3 1  ON 65
ci_0067                -3.907122e-03 3 1  ON 66
ci_0068                -3.850367e-03 3 1  ON 67
ci_0069                 3.717729e-03 3 1  ON 68
ci_0070                 3.465631e-03 3 1  ON 69
ci_0071                 4.079653e-03 3 1  ON 70
ci_0072                 4.252399e-03 3 1  ON 71
ci_0073                 3.371839e-03 3 1  ON 72
ci_0074                 3.331611e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9324
    reference variance = 0.279495
====================================================
  Execution time = 1.4555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9184e-01
  Total weights = 1.950796861e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283596313602
                                         uncertainty =       0.001795871763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283596313602
                                         uncertainty =       0.001795871763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376504538
  error estimate for blocks of size 2^( 2) =       0.000394117600
  error estimate for blocks of size 2^( 3) =       0.000411873590
  error estimate for blocks of size 2^( 4) =       0.000428062050
  error estimate for blocks of size 2^( 5) =       0.000440782474
  error estimate for blocks of size 2^( 6) =       0.000450107037
  error estimate for blocks of size 2^( 7) =       0.000454904436

      target function =      -0.925520652760
              le_mean =     -16.898161409037
             les_mean =     285.839694736474
             stat err =       0.000443463999
             autocorr =       1.387318916234
   target nu stat err =       0.000443463999
   target dn stat err =       0.002207013676
      target stat err =       0.003558265291
              std dev =       0.532457824232
             le_variance =       0.283511334586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689816140904e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925532968773       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925533757845       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925533997028       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925534152885       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925534226606       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925534238029       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925534243725       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925534246499       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925534247524       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925534248880       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925534249122       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925534249753       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925534250422       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925534251144       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925534251182       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925534251566       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925534251525       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925534251473       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 7.234746e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925532968773       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925533166236       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925533226071       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925533265051       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925533283481       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925533286333       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925533287757       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925533288451       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925533288706       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925533289046       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925533289106       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925533289263       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925533289431       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925533289611       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925533289621       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925533289717       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925533289706       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925533289693       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 1.809691e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925532968773       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925533018151       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925533033112       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925533042858       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925533047465       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925533048178       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925533048534       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925533048706       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925533048770       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925533048859       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925533048875       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925533048912       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925533048952       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925533048995       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925533049000       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925533049022       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925533049020       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925533049016       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 4.524856e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.780583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7113e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.031222e-01 3 1  ON 0
ci_0002                 6.979556e-01 3 1  ON 1
ci_0003                -3.153798e-02 3 1  ON 2
ci_0004                -3.137152e-02 3 1  ON 3
ci_0005                -2.891893e-02 3 1  ON 4
ci_0006                -2.995452e-02 3 1  ON 5
ci_0007                -1.586801e-02 3 1  ON 6
ci_0008                -1.649858e-02 3 1  ON 7
ci_0009                -1.872240e-02 3 1  ON 8
ci_0010                -1.887961e-02 3 1  ON 9
ci_0011                -1.550571e-02 3 1  ON 10
ci_0012                -1.563431e-02 3 1  ON 11
ci_0013                 1.548952e-02 3 1  ON 12
ci_0014                 1.537521e-02 3 1  ON 13
ci_0015                 1.629378e-02 3 1  ON 14
ci_0016                 1.595210e-02 3 1  ON 15
ci_0017                 1.373670e-02 3 1  ON 16
ci_0018                 1.393333e-02 3 1  ON 17
ci_0019                 1.259688e-02 3 1  ON 18
ci_0020                 1.224418e-02 3 1  ON 19
ci_0021                 1.352411e-02 3 1  ON 20
ci_0022                 1.499729e-02 3 1  ON 21
ci_0023                -1.182666e-02 3 1  ON 22
ci_0024                -1.113315e-02 3 1  ON 23
ci_0025                -2.822792e-03 3 1  ON 24
ci_0026                -2.392796e-03 3 1  ON 25
ci_0027                -1.179178e-02 3 1  ON 26
ci_0028                -1.174909e-02 3 1  ON 27
ci_0029                -1.044329e-02 3 1  ON 28
ci_0030                -1.036574e-02 3 1  ON 29
ci_0031                 1.383426e-02 3 1  ON 30
ci_0032                 1.290452e-02 3 1  ON 31
ci_0033                 8.253382e-03 3 1  ON 32
ci_0034                 8.532652e-03 3 1  ON 33
ci_0035                 4.881662e-03 3 1  ON 34
ci_0036                 4.735968e-03 3 1  ON 35
ci_0037                -1.141394e-02 3 1  ON 36
ci_0038                -1.130890e-02 3 1  ON 37
ci_0039                -3.817989e-03 3 1  ON 38
ci_0040                -3.938916e-03 3 1  ON 39
ci_0041                 9.549882e-03 3 1  ON 40
ci_0042                 9.454218e-03 3 1  ON 41
ci_0043                -7.800706e-03 3 1  ON 42
ci_0044                -8.258842e-03 3 1  ON 43
ci_0045                 1.041908e-02 3 1  ON 44
ci_0046                 9.667706e-03 3 1  ON 45
ci_0047                -3.596607e-03 3 1  ON 46
ci_0048                -3.622420e-03 3 1  ON 47
ci_0049                -2.504721e-03 3 1  ON 48
ci_0050                -2.579551e-03 3 1  ON 49
ci_0051                -1.838872e-03 3 1  ON 50
ci_0052                -1.721296e-03 3 1  ON 51
ci_0053                -3.849772e-03 3 1  ON 52
ci_0054                -3.734092e-03 3 1  ON 53
ci_0055                 2.334624e-03 3 1  ON 54
ci_0056                 2.075356e-03 3 1  ON 55
ci_0057                 2.311286e-03 3 1  ON 56
ci_0058                 2.891811e-03 3 1  ON 57
ci_0059                -3.897538e-03 3 1  ON 58
ci_0060                -3.669735e-03 3 1  ON 59
ci_0061                -3.113828e-03 3 1  ON 60
ci_0062                -3.326718e-03 3 1  ON 61
ci_0063                -9.706939e-03 3 1  ON 62
ci_0064                -9.659995e-03 3 1  ON 63
ci_0065                -6.919544e-03 3 1  ON 64
ci_0066                -6.464745e-03 3 1  ON 65
ci_0067                -3.907136e-03 3 1  ON 66
ci_0068                -3.850259e-03 3 1  ON 67
ci_0069                 3.717646e-03 3 1  ON 68
ci_0070                 3.465441e-03 3 1  ON 69
ci_0071                 4.079559e-03 3 1  ON 70
ci_0072                 4.251961e-03 3 1  ON 71
ci_0073                 3.371886e-03 3 1  ON 72
ci_0074                 3.331947e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.855
    reference variance = 0.279395
====================================================
  Execution time = 1.4299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9413e-01
  Total weights = 1.9509e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281844783312
                                         uncertainty =       0.001688767299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281844783312
                                         uncertainty =       0.001688767299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375396285
  error estimate for blocks of size 2^( 2) =       0.000392650563
  error estimate for blocks of size 2^( 3) =       0.000410612441
  error estimate for blocks of size 2^( 4) =       0.000426450261
  error estimate for blocks of size 2^( 5) =       0.000438648098
  error estimate for blocks of size 2^( 6) =       0.000446155655
  error estimate for blocks of size 2^( 7) =       0.000449961906

      target function =      -0.921893021555
              le_mean =     -16.897919681133
             les_mean =     285.833820738609
             stat err =       0.000440303980
             autocorr =       1.375704890788
   target nu stat err =       0.000440303980
   target dn stat err =       0.003750759301
      target stat err =       0.005908144911
              std dev =       0.530890517702
             le_variance =       0.281844741786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281843025447
                                         uncertainty =       0.001688794672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281843025447
                                         uncertainty =       0.001688794672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375395117
  error estimate for blocks of size 2^( 2) =       0.000392649179
  error estimate for blocks of size 2^( 3) =       0.000410610793
  error estimate for blocks of size 2^( 4) =       0.000426448352
  error estimate for blocks of size 2^( 5) =       0.000438645893
  error estimate for blocks of size 2^( 6) =       0.000446153311
  error estimate for blocks of size 2^( 7) =       0.000449959365

      target function =      -0.921909337500
              le_mean =     -16.897919692835
             les_mean =     285.833810789037
             stat err =       0.000440301730
             autocorr =       1.375699392294
   target nu stat err =       0.000440301730
   target dn stat err =       0.003743104104
      target stat err =       0.005896484864
              std dev =       0.530888866098
             le_variance =       0.281842988147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281843903324
                                         uncertainty =       0.001688780981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281843903324
                                         uncertainty =       0.001688780981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375395701
  error estimate for blocks of size 2^( 2) =       0.000392649870
  error estimate for blocks of size 2^( 3) =       0.000410611616
  error estimate for blocks of size 2^( 4) =       0.000426449306
  error estimate for blocks of size 2^( 5) =       0.000438646994
  error estimate for blocks of size 2^( 6) =       0.000446154482
  error estimate for blocks of size 2^( 7) =       0.000449960635

      target function =      -0.921901254027
              le_mean =     -16.897919686920
             les_mean =     285.833815714077
             stat err =       0.000440302854
             autocorr =       1.375702140094
   target nu stat err =       0.000440302854
   target dn stat err =       0.003746922080
      target stat err =       0.005902300974
              std dev =       0.530889690908
             le_variance =       0.281843863912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281844673239
                                         uncertainty =       0.001688769008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281844673239
                                         uncertainty =       0.001688769008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375396212
  error estimate for blocks of size 2^( 2) =       0.000392650476
  error estimate for blocks of size 2^( 3) =       0.000410612338
  error estimate for blocks of size 2^( 4) =       0.000426450142
  error estimate for blocks of size 2^( 5) =       0.000438647960
  error estimate for blocks of size 2^( 6) =       0.000446155508
  error estimate for blocks of size 2^( 7) =       0.000449961747

      target function =      -0.921894058660
              le_mean =     -16.897919681849
             les_mean =     285.833820105154
             stat err =       0.000440303839
             autocorr =       1.375704546930
   target nu stat err =       0.000440303839
   target dn stat err =       0.003750278788
      target stat err =       0.005907413194
              std dev =       0.530890414282
             le_variance =       0.281844631977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921893021555        initial
     5.8208e+01     5.8208e+02             7.2347e-06        -0.921909337500  <--
     2.3283e+02     2.3283e+03             1.8097e-06        -0.921901254027
     9.3132e+02     9.3132e+03             4.5249e-07        -0.921894058660

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.3794e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.031242e-01 3 1  ON 0
ci_0002                 6.979539e-01 3 1  ON 1
ci_0003                -3.153741e-02 3 1  ON 2
ci_0004                -3.137055e-02 3 1  ON 3
ci_0005                -2.892060e-02 3 1  ON 4
ci_0006                -2.995562e-02 3 1  ON 5
ci_0007                -1.586662e-02 3 1  ON 6
ci_0008                -1.649604e-02 3 1  ON 7
ci_0009                -1.872205e-02 3 1  ON 8
ci_0010                -1.887910e-02 3 1  ON 9
ci_0011                -1.550495e-02 3 1  ON 10
ci_0012                -1.563355e-02 3 1  ON 11
ci_0013                 1.548898e-02 3 1  ON 12
ci_0014                 1.537542e-02 3 1  ON 13
ci_0015                 1.629279e-02 3 1  ON 14
ci_0016                 1.595116e-02 3 1  ON 15
ci_0017                 1.373685e-02 3 1  ON 16
ci_0018                 1.393364e-02 3 1  ON 17
ci_0019                 1.259677e-02 3 1  ON 18
ci_0020                 1.224424e-02 3 1  ON 19
ci_0021                 1.351868e-02 3 1  ON 20
ci_0022                 1.499229e-02 3 1  ON 21
ci_0023                -1.182628e-02 3 1  ON 22
ci_0024                -1.113371e-02 3 1  ON 23
ci_0025                -2.821806e-03 3 1  ON 24
ci_0026                -2.393075e-03 3 1  ON 25
ci_0027                -1.179202e-02 3 1  ON 26
ci_0028                -1.174857e-02 3 1  ON 27
ci_0029                -1.044235e-02 3 1  ON 28
ci_0030                -1.036650e-02 3 1  ON 29
ci_0031                 1.383429e-02 3 1  ON 30
ci_0032                 1.290406e-02 3 1  ON 31
ci_0033                 8.253538e-03 3 1  ON 32
ci_0034                 8.533027e-03 3 1  ON 33
ci_0035                 4.882450e-03 3 1  ON 34
ci_0036                 4.737029e-03 3 1  ON 35
ci_0037                -1.141392e-02 3 1  ON 36
ci_0038                -1.130887e-02 3 1  ON 37
ci_0039                -3.818526e-03 3 1  ON 38
ci_0040                -3.938722e-03 3 1  ON 39
ci_0041                 9.550417e-03 3 1  ON 40
ci_0042                 9.454164e-03 3 1  ON 41
ci_0043                -7.805027e-03 3 1  ON 42
ci_0044                -8.263046e-03 3 1  ON 43
ci_0045                 1.041907e-02 3 1  ON 44
ci_0046                 9.667719e-03 3 1  ON 45
ci_0047                -3.596582e-03 3 1  ON 46
ci_0048                -3.622213e-03 3 1  ON 47
ci_0049                -2.505050e-03 3 1  ON 48
ci_0050                -2.579839e-03 3 1  ON 49
ci_0051                -1.838660e-03 3 1  ON 50
ci_0052                -1.721047e-03 3 1  ON 51
ci_0053                -3.849532e-03 3 1  ON 52
ci_0054                -3.734057e-03 3 1  ON 53
ci_0055                 2.334865e-03 3 1  ON 54
ci_0056                 2.075310e-03 3 1  ON 55
ci_0057                 2.312900e-03 3 1  ON 56
ci_0058                 2.890555e-03 3 1  ON 57
ci_0059                -3.897002e-03 3 1  ON 58
ci_0060                -3.671212e-03 3 1  ON 59
ci_0061                -3.114340e-03 3 1  ON 60
ci_0062                -3.326791e-03 3 1  ON 61
ci_0063                -9.707052e-03 3 1  ON 62
ci_0064                -9.659143e-03 3 1  ON 63
ci_0065                -6.919052e-03 3 1  ON 64
ci_0066                -6.464775e-03 3 1  ON 65
ci_0067                -3.907177e-03 3 1  ON 66
ci_0068                -3.849935e-03 3 1  ON 67
ci_0069                 3.717396e-03 3 1  ON 68
ci_0070                 3.464872e-03 3 1  ON 69
ci_0071                 4.079280e-03 3 1  ON 70
ci_0072                 4.250650e-03 3 1  ON 71
ci_0073                 3.372026e-03 3 1  ON 72
ci_0074                 3.332953e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8378
    reference variance = 0.319273
====================================================
  Execution time = 1.4523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9693e-01
  Total weights = 1.951172018e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285653743331
                                         uncertainty =       0.003201537160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285653743331
                                         uncertainty =       0.003201537160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377959275
  error estimate for blocks of size 2^( 2) =       0.000394813742
  error estimate for blocks of size 2^( 3) =       0.000412410243
  error estimate for blocks of size 2^( 4) =       0.000427615747
  error estimate for blocks of size 2^( 5) =       0.000438635010
  error estimate for blocks of size 2^( 6) =       0.000445682114
  error estimate for blocks of size 2^( 7) =       0.000451492663

      target function =      -0.917534570263
              le_mean =     -16.898477757588
             les_mean =     285.855478064004
             stat err =       0.000440856384
             autocorr =       1.360517876621
   target nu stat err =       0.000440856384
   target dn stat err =       0.004104493213
      target stat err =       0.006403056982
              std dev =       0.534515132938
             le_variance =       0.285706427340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689847775759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917578036055       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917582342227       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917583200610       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917583761388       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917584017538       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917584036884       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917584037074       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917584054983       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917584114133       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917584158781       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917584182834       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917584207405       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917584212451       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917584216529       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917584217499       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917584218860       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917584218845       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917584219428       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+01 is 2.826815e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917578036055       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917579116929       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917579332206       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917579472649       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917579536695       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917579541507       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917579541543       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917579546031       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917579560862       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917579572013       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917579577998       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917579584097       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917579585341       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917579586348       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917579586586       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917579586924       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917579586920       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917579587064       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 7.083035e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917578036055       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917578306546       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917578360408       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917578395534       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917578411546       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917578412748       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917578412756       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917578413879       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917578417589       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917578420376       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917578421870       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917578423392       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917578423702       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917578423953       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917578424013       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917578424097       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917578424096       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917578424132       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 1.771761e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.790928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7075e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.031178e-01 3 1  ON 0
ci_0002                 6.979605e-01 3 1  ON 1
ci_0003                -3.153790e-02 3 1  ON 2
ci_0004                -3.136979e-02 3 1  ON 3
ci_0005                -2.892142e-02 3 1  ON 4
ci_0006                -2.995820e-02 3 1  ON 5
ci_0007                -1.586705e-02 3 1  ON 6
ci_0008                -1.649558e-02 3 1  ON 7
ci_0009                -1.872167e-02 3 1  ON 8
ci_0010                -1.887793e-02 3 1  ON 9
ci_0011                -1.550370e-02 3 1  ON 10
ci_0012                -1.563275e-02 3 1  ON 11
ci_0013                 1.548812e-02 3 1  ON 12
ci_0014                 1.537556e-02 3 1  ON 13
ci_0015                 1.629132e-02 3 1  ON 14
ci_0016                 1.595086e-02 3 1  ON 15
ci_0017                 1.373667e-02 3 1  ON 16
ci_0018                 1.393228e-02 3 1  ON 17
ci_0019                 1.259798e-02 3 1  ON 18
ci_0020                 1.224409e-02 3 1  ON 19
ci_0021                 1.351384e-02 3 1  ON 20
ci_0022                 1.498562e-02 3 1  ON 21
ci_0023                -1.182549e-02 3 1  ON 22
ci_0024                -1.113450e-02 3 1  ON 23
ci_0025                -2.821007e-03 3 1  ON 24
ci_0026                -2.391856e-03 3 1  ON 25
ci_0027                -1.179213e-02 3 1  ON 26
ci_0028                -1.174985e-02 3 1  ON 27
ci_0029                -1.044207e-02 3 1  ON 28
ci_0030                -1.036731e-02 3 1  ON 29
ci_0031                 1.383376e-02 3 1  ON 30
ci_0032                 1.290302e-02 3 1  ON 31
ci_0033                 8.253780e-03 3 1  ON 32
ci_0034                 8.534084e-03 3 1  ON 33
ci_0035                 4.886905e-03 3 1  ON 34
ci_0036                 4.738157e-03 3 1  ON 35
ci_0037                -1.141319e-02 3 1  ON 36
ci_0038                -1.131016e-02 3 1  ON 37
ci_0039                -3.818776e-03 3 1  ON 38
ci_0040                -3.938384e-03 3 1  ON 39
ci_0041                 9.549318e-03 3 1  ON 40
ci_0042                 9.453822e-03 3 1  ON 41
ci_0043                -7.807406e-03 3 1  ON 42
ci_0044                -8.270129e-03 3 1  ON 43
ci_0045                 1.041968e-02 3 1  ON 44
ci_0046                 9.668125e-03 3 1  ON 45
ci_0047                -3.597463e-03 3 1  ON 46
ci_0048                -3.621879e-03 3 1  ON 47
ci_0049                -2.504001e-03 3 1  ON 48
ci_0050                -2.579476e-03 3 1  ON 49
ci_0051                -1.839441e-03 3 1  ON 50
ci_0052                -1.722135e-03 3 1  ON 51
ci_0053                -3.848977e-03 3 1  ON 52
ci_0054                -3.732895e-03 3 1  ON 53
ci_0055                 2.333839e-03 3 1  ON 54
ci_0056                 2.077255e-03 3 1  ON 55
ci_0057                 2.312770e-03 3 1  ON 56
ci_0058                 2.891622e-03 3 1  ON 57
ci_0059                -3.898677e-03 3 1  ON 58
ci_0060                -3.669862e-03 3 1  ON 59
ci_0061                -3.115397e-03 3 1  ON 60
ci_0062                -3.327006e-03 3 1  ON 61
ci_0063                -9.705993e-03 3 1  ON 62
ci_0064                -9.659394e-03 3 1  ON 63
ci_0065                -6.918331e-03 3 1  ON 64
ci_0066                -6.463706e-03 3 1  ON 65
ci_0067                -3.905344e-03 3 1  ON 66
ci_0068                -3.849723e-03 3 1  ON 67
ci_0069                 3.717035e-03 3 1  ON 68
ci_0070                 3.464250e-03 3 1  ON 69
ci_0071                 4.079527e-03 3 1  ON 70
ci_0072                 4.251164e-03 3 1  ON 71
ci_0073                 3.371691e-03 3 1  ON 72
ci_0074                 3.332692e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8263
    reference variance = 0.273176
====================================================
  Execution time = 1.4227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8883e-01
  Total weights = 1.9509e+06
  Execution time = 1.8792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280518526469
                                         uncertainty =       0.001751748994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280518526469
                                         uncertainty =       0.001751748994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374500397
  error estimate for blocks of size 2^( 2) =       0.000391513336
  error estimate for blocks of size 2^( 3) =       0.000409307026
  error estimate for blocks of size 2^( 4) =       0.000424220806
  error estimate for blocks of size 2^( 5) =       0.000436270573
  error estimate for blocks of size 2^( 6) =       0.000442727322
  error estimate for blocks of size 2^( 7) =       0.000447037487

      target function =      -0.930287090114
              le_mean =     -16.898561804824
             les_mean =     285.850221770176
             stat err =       0.000437564047
             autocorr =       1.365144726083
   target nu stat err =       0.000437564047
   target dn stat err =       0.002207216928
      target stat err =       0.003595029623
              std dev =       0.529623540918
             le_variance =       0.280501095095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280512016341
                                         uncertainty =       0.001751616240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280512016341
                                         uncertainty =       0.001751616240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374496055
  error estimate for blocks of size 2^( 2) =       0.000391508171
  error estimate for blocks of size 2^( 3) =       0.000409301063
  error estimate for blocks of size 2^( 4) =       0.000424213701
  error estimate for blocks of size 2^( 5) =       0.000436262654
  error estimate for blocks of size 2^( 6) =       0.000442719248
  error estimate for blocks of size 2^( 7) =       0.000447028953

      target function =      -0.930280054784
              le_mean =     -16.898561884621
             les_mean =     285.850228884358
             stat err =       0.000437556139
             autocorr =       1.365127037654
   target nu stat err =       0.000437556139
   target dn stat err =       0.002207540877
      target stat err =       0.003595478846
              std dev =       0.529617400307
             le_variance =       0.280494590708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515256123
                                         uncertainty =       0.001751682279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515256123
                                         uncertainty =       0.001751682279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374498216
  error estimate for blocks of size 2^( 2) =       0.000391510743
  error estimate for blocks of size 2^( 3) =       0.000409304034
  error estimate for blocks of size 2^( 4) =       0.000424217242
  error estimate for blocks of size 2^( 5) =       0.000436266601
  error estimate for blocks of size 2^( 6) =       0.000442723265
  error estimate for blocks of size 2^( 7) =       0.000447033200

      target function =      -0.930295840485
              le_mean =     -16.898561843883
             les_mean =     285.850217598130
             stat err =       0.000437560077
             autocorr =       1.365135854044
   target nu stat err =       0.000437560077
   target dn stat err =       0.002207212255
      target stat err =       0.003595087342
              std dev =       0.529620456206
             le_variance =       0.280497827632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280518116528
                                         uncertainty =       0.001751740631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280518116528
                                         uncertainty =       0.001751740631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374500124
  error estimate for blocks of size 2^( 2) =       0.000391513011
  error estimate for blocks of size 2^( 3) =       0.000409306652
  error estimate for blocks of size 2^( 4) =       0.000424220360
  error estimate for blocks of size 2^( 5) =       0.000436270076
  error estimate for blocks of size 2^( 6) =       0.000442726814
  error estimate for blocks of size 2^( 7) =       0.000447036950

      target function =      -0.930288935744
              le_mean =     -16.898561809581
             les_mean =     285.850220772502
             stat err =       0.000437563550
             autocorr =       1.365143616500
   target nu stat err =       0.000437563550
   target dn stat err =       0.002207207766
      target stat err =       0.003595029156
              std dev =       0.529623154248
             le_variance =       0.280500685515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930287090114        initial
     1.4552e+01     1.4552e+02             2.8268e-05        -0.930280054784
     5.8208e+01     5.8208e+02             7.0830e-06        -0.930295840485  <--
     2.3283e+02     2.3283e+03             1.7718e-06        -0.930288935744

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.3717e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.031178e-01 3 1  ON 0
ci_0002                 6.979605e-01 3 1  ON 1
ci_0003                -3.153790e-02 3 1  ON 2
ci_0004                -3.136979e-02 3 1  ON 3
ci_0005                -2.892142e-02 3 1  ON 4
ci_0006                -2.995820e-02 3 1  ON 5
ci_0007                -1.586705e-02 3 1  ON 6
ci_0008                -1.649558e-02 3 1  ON 7
ci_0009                -1.872167e-02 3 1  ON 8
ci_0010                -1.887793e-02 3 1  ON 9
ci_0011                -1.550370e-02 3 1  ON 10
ci_0012                -1.563275e-02 3 1  ON 11
ci_0013                 1.548812e-02 3 1  ON 12
ci_0014                 1.537556e-02 3 1  ON 13
ci_0015                 1.629132e-02 3 1  ON 14
ci_0016                 1.595086e-02 3 1  ON 15
ci_0017                 1.373667e-02 3 1  ON 16
ci_0018                 1.393228e-02 3 1  ON 17
ci_0019                 1.259798e-02 3 1  ON 18
ci_0020                 1.224409e-02 3 1  ON 19
ci_0021                 1.351384e-02 3 1  ON 20
ci_0022                 1.498562e-02 3 1  ON 21
ci_0023                -1.182549e-02 3 1  ON 22
ci_0024                -1.113450e-02 3 1  ON 23
ci_0025                -2.821007e-03 3 1  ON 24
ci_0026                -2.391856e-03 3 1  ON 25
ci_0027                -1.179213e-02 3 1  ON 26
ci_0028                -1.174985e-02 3 1  ON 27
ci_0029                -1.044207e-02 3 1  ON 28
ci_0030                -1.036731e-02 3 1  ON 29
ci_0031                 1.383376e-02 3 1  ON 30
ci_0032                 1.290302e-02 3 1  ON 31
ci_0033                 8.253780e-03 3 1  ON 32
ci_0034                 8.534084e-03 3 1  ON 33
ci_0035                 4.886905e-03 3 1  ON 34
ci_0036                 4.738157e-03 3 1  ON 35
ci_0037                -1.141319e-02 3 1  ON 36
ci_0038                -1.131016e-02 3 1  ON 37
ci_0039                -3.818776e-03 3 1  ON 38
ci_0040                -3.938384e-03 3 1  ON 39
ci_0041                 9.549318e-03 3 1  ON 40
ci_0042                 9.453822e-03 3 1  ON 41
ci_0043                -7.807406e-03 3 1  ON 42
ci_0044                -8.270129e-03 3 1  ON 43
ci_0045                 1.041968e-02 3 1  ON 44
ci_0046                 9.668125e-03 3 1  ON 45
ci_0047                -3.597463e-03 3 1  ON 46
ci_0048                -3.621879e-03 3 1  ON 47
ci_0049                -2.504001e-03 3 1  ON 48
ci_0050                -2.579476e-03 3 1  ON 49
ci_0051                -1.839441e-03 3 1  ON 50
ci_0052                -1.722135e-03 3 1  ON 51
ci_0053                -3.848977e-03 3 1  ON 52
ci_0054                -3.732895e-03 3 1  ON 53
ci_0055                 2.333839e-03 3 1  ON 54
ci_0056                 2.077255e-03 3 1  ON 55
ci_0057                 2.312770e-03 3 1  ON 56
ci_0058                 2.891622e-03 3 1  ON 57
ci_0059                -3.898677e-03 3 1  ON 58
ci_0060                -3.669862e-03 3 1  ON 59
ci_0061                -3.115397e-03 3 1  ON 60
ci_0062                -3.327006e-03 3 1  ON 61
ci_0063                -9.705993e-03 3 1  ON 62
ci_0064                -9.659394e-03 3 1  ON 63
ci_0065                -6.918331e-03 3 1  ON 64
ci_0066                -6.463706e-03 3 1  ON 65
ci_0067                -3.905344e-03 3 1  ON 66
ci_0068                -3.849723e-03 3 1  ON 67
ci_0069                 3.717035e-03 3 1  ON 68
ci_0070                 3.464250e-03 3 1  ON 69
ci_0071                 4.079527e-03 3 1  ON 70
ci_0072                 4.251164e-03 3 1  ON 71
ci_0073                 3.371691e-03 3 1  ON 72
ci_0074                 3.332692e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.169962
====================================================
  Execution time = 1.6608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9601e-01
  Total weights = 1.951411858e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285552389908
                                         uncertainty =       0.002551885404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285552389908
                                         uncertainty =       0.002551885404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377825276
  error estimate for blocks of size 2^( 2) =       0.000395115589
  error estimate for blocks of size 2^( 3) =       0.000412811591
  error estimate for blocks of size 2^( 4) =       0.000427696087
  error estimate for blocks of size 2^( 5) =       0.000439412583
  error estimate for blocks of size 2^( 6) =       0.000447596488
  error estimate for blocks of size 2^( 7) =       0.000452624459

      target function =      -0.918960984885
              le_mean =     -16.898938123624
             les_mean =     285.870122274851
             stat err =       0.000441832405
             autocorr =       1.367518188871
   target nu stat err =       0.000441832405
   target dn stat err =       0.003701999580
      target stat err =       0.005807036444
              std dev =       0.534325630116
             le_variance =       0.285503878999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689893812362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918996645688       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919004610565       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919005415781       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919005881076       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919006064406       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919006158901       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919006210619       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919006223992       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919006257845       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919006300117       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919006312200       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919006315169       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919006313164       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919006310263       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919006309671       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919006310486       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919006311292       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919006311524       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919006311794       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+01 is 2.583959e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918996645688       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918998644757       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918998846692       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918998963243       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918999009091       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918999032708       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918999045626       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918999048992       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918999057470       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918999067998       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918999070990       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918999071704       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918999071196       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918999070472       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918999070326       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918999070528       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918999070728       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918999070786       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 6.479435e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918996645688       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918997145949       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918997196472       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918997225624       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918997237087       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918997242991       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918997246219       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918997247063       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918997249183       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918997251812       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918997252558       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918997252736       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918997252608       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918997252427       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918997252389       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918997252441       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918997252490       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918997252505       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 1.620710e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.801797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9180e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.031116e-01 3 1  ON 0
ci_0002                 6.979669e-01 3 1  ON 1
ci_0003                -3.153861e-02 3 1  ON 2
ci_0004                -3.136947e-02 3 1  ON 3
ci_0005                -2.891958e-02 3 1  ON 4
ci_0006                -2.996016e-02 3 1  ON 5
ci_0007                -1.586715e-02 3 1  ON 6
ci_0008                -1.649573e-02 3 1  ON 7
ci_0009                -1.872068e-02 3 1  ON 8
ci_0010                -1.887691e-02 3 1  ON 9
ci_0011                -1.550363e-02 3 1  ON 10
ci_0012                -1.563045e-02 3 1  ON 11
ci_0013                 1.548863e-02 3 1  ON 12
ci_0014                 1.537503e-02 3 1  ON 13
ci_0015                 1.629117e-02 3 1  ON 14
ci_0016                 1.595090e-02 3 1  ON 15
ci_0017                 1.373628e-02 3 1  ON 16
ci_0018                 1.393140e-02 3 1  ON 17
ci_0019                 1.260073e-02 3 1  ON 18
ci_0020                 1.224570e-02 3 1  ON 19
ci_0021                 1.351152e-02 3 1  ON 20
ci_0022                 1.497914e-02 3 1  ON 21
ci_0023                -1.182574e-02 3 1  ON 22
ci_0024                -1.113539e-02 3 1  ON 23
ci_0025                -2.818443e-03 3 1  ON 24
ci_0026                -2.389063e-03 3 1  ON 25
ci_0027                -1.179307e-02 3 1  ON 26
ci_0028                -1.174950e-02 3 1  ON 27
ci_0029                -1.044098e-02 3 1  ON 28
ci_0030                -1.036808e-02 3 1  ON 29
ci_0031                 1.383263e-02 3 1  ON 30
ci_0032                 1.290297e-02 3 1  ON 31
ci_0033                 8.251357e-03 3 1  ON 32
ci_0034                 8.535161e-03 3 1  ON 33
ci_0035                 4.889526e-03 3 1  ON 34
ci_0036                 4.738300e-03 3 1  ON 35
ci_0037                -1.141331e-02 3 1  ON 36
ci_0038                -1.130950e-02 3 1  ON 37
ci_0039                -3.818767e-03 3 1  ON 38
ci_0040                -3.937993e-03 3 1  ON 39
ci_0041                 9.548847e-03 3 1  ON 40
ci_0042                 9.453433e-03 3 1  ON 41
ci_0043                -7.810420e-03 3 1  ON 42
ci_0044                -8.273985e-03 3 1  ON 43
ci_0045                 1.042031e-02 3 1  ON 44
ci_0046                 9.667867e-03 3 1  ON 45
ci_0047                -3.597719e-03 3 1  ON 46
ci_0048                -3.621960e-03 3 1  ON 47
ci_0049                -2.501785e-03 3 1  ON 48
ci_0050                -2.582677e-03 3 1  ON 49
ci_0051                -1.839299e-03 3 1  ON 50
ci_0052                -1.722718e-03 3 1  ON 51
ci_0053                -3.848789e-03 3 1  ON 52
ci_0054                -3.731685e-03 3 1  ON 53
ci_0055                 2.335047e-03 3 1  ON 54
ci_0056                 2.077811e-03 3 1  ON 55
ci_0057                 2.318917e-03 3 1  ON 56
ci_0058                 2.891790e-03 3 1  ON 57
ci_0059                -3.899002e-03 3 1  ON 58
ci_0060                -3.669842e-03 3 1  ON 59
ci_0061                -3.118667e-03 3 1  ON 60
ci_0062                -3.327382e-03 3 1  ON 61
ci_0063                -9.706526e-03 3 1  ON 62
ci_0064                -9.659479e-03 3 1  ON 63
ci_0065                -6.916900e-03 3 1  ON 64
ci_0066                -6.464030e-03 3 1  ON 65
ci_0067                -3.904410e-03 3 1  ON 66
ci_0068                -3.849155e-03 3 1  ON 67
ci_0069                 3.717331e-03 3 1  ON 68
ci_0070                 3.463456e-03 3 1  ON 69
ci_0071                 4.079278e-03 3 1  ON 70
ci_0072                 4.248305e-03 3 1  ON 71
ci_0073                 3.372920e-03 3 1  ON 72
ci_0074                 3.332672e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.243963
====================================================
  Execution time = 1.4261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9260e-01
  Total weights = 1.9508e+06
  Execution time = 1.8771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281319023161
                                         uncertainty =       0.001661363802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281319023161
                                         uncertainty =       0.001661363802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375019194
  error estimate for blocks of size 2^( 2) =       0.000391881471
  error estimate for blocks of size 2^( 3) =       0.000409559966
  error estimate for blocks of size 2^( 4) =       0.000424884645
  error estimate for blocks of size 2^( 5) =       0.000436124613
  error estimate for blocks of size 2^( 6) =       0.000442898736
  error estimate for blocks of size 2^( 7) =       0.000446782829

      target function =      -0.924360944629
              le_mean =     -16.898268960580
             les_mean =     285.844065666009
             stat err =       0.000437672706
             autocorr =       1.362046501172
   target nu stat err =       0.000437672706
   target dn stat err =       0.002392439541
      target stat err =       0.003833663970
              std dev =       0.530357230800
             le_variance =       0.281278792262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281312128481
                                         uncertainty =       0.001660852173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281312128481
                                         uncertainty =       0.001660852173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375014607
  error estimate for blocks of size 2^( 2) =       0.000391875904
  error estimate for blocks of size 2^( 3) =       0.000409553211
  error estimate for blocks of size 2^( 4) =       0.000424876819
  error estimate for blocks of size 2^( 5) =       0.000436115657
  error estimate for blocks of size 2^( 6) =       0.000442889349
  error estimate for blocks of size 2^( 7) =       0.000446773502

      target function =      -0.924154750919
              le_mean =     -16.898269033349
             les_mean =     285.844199020452
             stat err =       0.000437663832
             autocorr =       1.362024588693
   target nu stat err =       0.000437663832
   target dn stat err =       0.002430622585
      target stat err =       0.003890855053
              std dev =       0.530350743697
             le_variance =       0.281271911340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281315551795
                                         uncertainty =       0.001661107172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281315551795
                                         uncertainty =       0.001661107172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375016885
  error estimate for blocks of size 2^( 2) =       0.000391878670
  error estimate for blocks of size 2^( 3) =       0.000409556568
  error estimate for blocks of size 2^( 4) =       0.000424880710
  error estimate for blocks of size 2^( 5) =       0.000436120111
  error estimate for blocks of size 2^( 6) =       0.000442894014
  error estimate for blocks of size 2^( 7) =       0.000446778138

      target function =      -0.924263800428
              le_mean =     -16.898268996427
             les_mean =     285.844128540993
             stat err =       0.000437668243
             autocorr =       1.362035502395
   target nu stat err =       0.000437668243
   target dn stat err =       0.002410250827
      target stat err =       0.003860336266
              std dev =       0.530353964639
             le_variance =       0.281275327808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281318587325
                                         uncertainty =       0.001661331671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281318587325
                                         uncertainty =       0.001661331671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375018904
  error estimate for blocks of size 2^( 2) =       0.000391881120
  error estimate for blocks of size 2^( 3) =       0.000409559540
  error estimate for blocks of size 2^( 4) =       0.000424884152
  error estimate for blocks of size 2^( 5) =       0.000436124049
  error estimate for blocks of size 2^( 6) =       0.000442898144
  error estimate for blocks of size 2^( 7) =       0.000446782240

      target function =      -0.924349405420
              le_mean =     -16.898268964979
             les_mean =     285.844073138861
             stat err =       0.000437672146
             autocorr =       1.362045124818
   target nu stat err =       0.000437672146
   target dn stat err =       0.002394536693
      target stat err =       0.003836803816
              std dev =       0.530356820727
             le_variance =       0.281278357292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924360944629        initial  <--
     1.4552e+01     1.4552e+02             2.5840e-05        -0.924154750919
     5.8208e+01     5.8208e+02             6.4794e-06        -0.924263800428
     2.3283e+02     2.3283e+03             1.6207e-06        -0.924349405420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7351
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.031178e-01 3 1  ON 0
ci_0002                 6.979605e-01 3 1  ON 1
ci_0003                -3.153790e-02 3 1  ON 2
ci_0004                -3.136979e-02 3 1  ON 3
ci_0005                -2.892142e-02 3 1  ON 4
ci_0006                -2.995820e-02 3 1  ON 5
ci_0007                -1.586705e-02 3 1  ON 6
ci_0008                -1.649558e-02 3 1  ON 7
ci_0009                -1.872167e-02 3 1  ON 8
ci_0010                -1.887793e-02 3 1  ON 9
ci_0011                -1.550370e-02 3 1  ON 10
ci_0012                -1.563275e-02 3 1  ON 11
ci_0013                 1.548812e-02 3 1  ON 12
ci_0014                 1.537556e-02 3 1  ON 13
ci_0015                 1.629132e-02 3 1  ON 14
ci_0016                 1.595086e-02 3 1  ON 15
ci_0017                 1.373667e-02 3 1  ON 16
ci_0018                 1.393228e-02 3 1  ON 17
ci_0019                 1.259798e-02 3 1  ON 18
ci_0020                 1.224409e-02 3 1  ON 19
ci_0021                 1.351384e-02 3 1  ON 20
ci_0022                 1.498562e-02 3 1  ON 21
ci_0023                -1.182549e-02 3 1  ON 22
ci_0024                -1.113450e-02 3 1  ON 23
ci_0025                -2.821007e-03 3 1  ON 24
ci_0026                -2.391856e-03 3 1  ON 25
ci_0027                -1.179213e-02 3 1  ON 26
ci_0028                -1.174985e-02 3 1  ON 27
ci_0029                -1.044207e-02 3 1  ON 28
ci_0030                -1.036731e-02 3 1  ON 29
ci_0031                 1.383376e-02 3 1  ON 30
ci_0032                 1.290302e-02 3 1  ON 31
ci_0033                 8.253780e-03 3 1  ON 32
ci_0034                 8.534084e-03 3 1  ON 33
ci_0035                 4.886905e-03 3 1  ON 34
ci_0036                 4.738157e-03 3 1  ON 35
ci_0037                -1.141319e-02 3 1  ON 36
ci_0038                -1.131016e-02 3 1  ON 37
ci_0039                -3.818776e-03 3 1  ON 38
ci_0040                -3.938384e-03 3 1  ON 39
ci_0041                 9.549318e-03 3 1  ON 40
ci_0042                 9.453822e-03 3 1  ON 41
ci_0043                -7.807406e-03 3 1  ON 42
ci_0044                -8.270129e-03 3 1  ON 43
ci_0045                 1.041968e-02 3 1  ON 44
ci_0046                 9.668125e-03 3 1  ON 45
ci_0047                -3.597463e-03 3 1  ON 46
ci_0048                -3.621879e-03 3 1  ON 47
ci_0049                -2.504001e-03 3 1  ON 48
ci_0050                -2.579476e-03 3 1  ON 49
ci_0051                -1.839441e-03 3 1  ON 50
ci_0052                -1.722135e-03 3 1  ON 51
ci_0053                -3.848977e-03 3 1  ON 52
ci_0054                -3.732895e-03 3 1  ON 53
ci_0055                 2.333839e-03 3 1  ON 54
ci_0056                 2.077255e-03 3 1  ON 55
ci_0057                 2.312770e-03 3 1  ON 56
ci_0058                 2.891622e-03 3 1  ON 57
ci_0059                -3.898677e-03 3 1  ON 58
ci_0060                -3.669862e-03 3 1  ON 59
ci_0061                -3.115397e-03 3 1  ON 60
ci_0062                -3.327006e-03 3 1  ON 61
ci_0063                -9.705993e-03 3 1  ON 62
ci_0064                -9.659394e-03 3 1  ON 63
ci_0065                -6.918331e-03 3 1  ON 64
ci_0066                -6.463706e-03 3 1  ON 65
ci_0067                -3.905344e-03 3 1  ON 66
ci_0068                -3.849723e-03 3 1  ON 67
ci_0069                 3.717035e-03 3 1  ON 68
ci_0070                 3.464250e-03 3 1  ON 69
ci_0071                 4.079527e-03 3 1  ON 70
ci_0072                 4.251164e-03 3 1  ON 71
ci_0073                 3.371691e-03 3 1  ON 72
ci_0074                 3.332692e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.283672
====================================================
  Execution time = 1.4844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8710e-01
  Total weights = 1.951110993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280008764501
                                         uncertainty =       0.001462000261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280008764501
                                         uncertainty =       0.001462000261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374167394
  error estimate for blocks of size 2^( 2) =       0.000391518017
  error estimate for blocks of size 2^( 3) =       0.000409012243
  error estimate for blocks of size 2^( 4) =       0.000424081479
  error estimate for blocks of size 2^( 5) =       0.000435568993
  error estimate for blocks of size 2^( 6) =       0.000443624801
  error estimate for blocks of size 2^( 7) =       0.000447197837

      target function =      -0.933056432236
              le_mean =     -16.898453150213
             les_mean =     285.844818224029
             stat err =       0.000437618278
             autocorr =       1.367914731699
   target nu stat err =       0.000437618278
   target dn stat err =       0.001669311927
      target stat err =       0.002778065989
              std dev =       0.529152603323
             le_variance =       0.280002477604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689845315021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933063293892       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933063521978       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933063622628       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933063677490       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933063711059       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933063716592       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933063717907       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933063718999       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933063719596       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933063719320       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933063719233       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933063719307       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933063719380       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933063719365       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933063719301       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933063719316       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933063719323       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933063719302       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 3.104883e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933063293892       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933063350936       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933063376105       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933063389822       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933063398215       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933063399598       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933063399927       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933063400200       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933063400348       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933063400280       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933063400258       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933063400277       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933063400295       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933063400290       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933063400276       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933063400280       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933063400280       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933063400276       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+02 is 7.763993e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933063293892       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933063308154       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933063314447       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933063317876       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933063319974       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933063320318       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933063320403       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933063320468       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933063320510       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933063320484       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933063320485       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933063320490       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933063320493       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933063320492       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933063320495       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933063320497       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933063320493       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933063320488       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+03 is 1.941110e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.811992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7402e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.031179e-01 3 1  ON 0
ci_0002                 6.979605e-01 3 1  ON 1
ci_0003                -3.153778e-02 3 1  ON 2
ci_0004                -3.136970e-02 3 1  ON 3
ci_0005                -2.892151e-02 3 1  ON 4
ci_0006                -2.995838e-02 3 1  ON 5
ci_0007                -1.586703e-02 3 1  ON 6
ci_0008                -1.649520e-02 3 1  ON 7
ci_0009                -1.872179e-02 3 1  ON 8
ci_0010                -1.887790e-02 3 1  ON 9
ci_0011                -1.550365e-02 3 1  ON 10
ci_0012                -1.563264e-02 3 1  ON 11
ci_0013                 1.548822e-02 3 1  ON 12
ci_0014                 1.537538e-02 3 1  ON 13
ci_0015                 1.629113e-02 3 1  ON 14
ci_0016                 1.595072e-02 3 1  ON 15
ci_0017                 1.373663e-02 3 1  ON 16
ci_0018                 1.393221e-02 3 1  ON 17
ci_0019                 1.259801e-02 3 1  ON 18
ci_0020                 1.224415e-02 3 1  ON 19
ci_0021                 1.351330e-02 3 1  ON 20
ci_0022                 1.498497e-02 3 1  ON 21
ci_0023                -1.182549e-02 3 1  ON 22
ci_0024                -1.113451e-02 3 1  ON 23
ci_0025                -2.820950e-03 3 1  ON 24
ci_0026                -2.391916e-03 3 1  ON 25
ci_0027                -1.179212e-02 3 1  ON 26
ci_0028                -1.174987e-02 3 1  ON 27
ci_0029                -1.044201e-02 3 1  ON 28
ci_0030                -1.036738e-02 3 1  ON 29
ci_0031                 1.383378e-02 3 1  ON 30
ci_0032                 1.290303e-02 3 1  ON 31
ci_0033                 8.253818e-03 3 1  ON 32
ci_0034                 8.534046e-03 3 1  ON 33
ci_0035                 4.886871e-03 3 1  ON 34
ci_0036                 4.738097e-03 3 1  ON 35
ci_0037                -1.141323e-02 3 1  ON 36
ci_0038                -1.131017e-02 3 1  ON 37
ci_0039                -3.818763e-03 3 1  ON 38
ci_0040                -3.938391e-03 3 1  ON 39
ci_0041                 9.549271e-03 3 1  ON 40
ci_0042                 9.453800e-03 3 1  ON 41
ci_0043                -7.808183e-03 3 1  ON 42
ci_0044                -8.270706e-03 3 1  ON 43
ci_0045                 1.041961e-02 3 1  ON 44
ci_0046                 9.668077e-03 3 1  ON 45
ci_0047                -3.597405e-03 3 1  ON 46
ci_0048                -3.621859e-03 3 1  ON 47
ci_0049                -2.504030e-03 3 1  ON 48
ci_0050                -2.579429e-03 3 1  ON 49
ci_0051                -1.839475e-03 3 1  ON 50
ci_0052                -1.722098e-03 3 1  ON 51
ci_0053                -3.848870e-03 3 1  ON 52
ci_0054                -3.732829e-03 3 1  ON 53
ci_0055                 2.333810e-03 3 1  ON 54
ci_0056                 2.077317e-03 3 1  ON 55
ci_0057                 2.312736e-03 3 1  ON 56
ci_0058                 2.891690e-03 3 1  ON 57
ci_0059                -3.898786e-03 3 1  ON 58
ci_0060                -3.669837e-03 3 1  ON 59
ci_0061                -3.115469e-03 3 1  ON 60
ci_0062                -3.326972e-03 3 1  ON 61
ci_0063                -9.706057e-03 3 1  ON 62
ci_0064                -9.659405e-03 3 1  ON 63
ci_0065                -6.918237e-03 3 1  ON 64
ci_0066                -6.463619e-03 3 1  ON 65
ci_0067                -3.905323e-03 3 1  ON 66
ci_0068                -3.849743e-03 3 1  ON 67
ci_0069                 3.716928e-03 3 1  ON 68
ci_0070                 3.464273e-03 3 1  ON 69
ci_0071                 4.079564e-03 3 1  ON 70
ci_0072                 4.250992e-03 3 1  ON 71
ci_0073                 3.371764e-03 3 1  ON 72
ci_0074                 3.332658e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.229858
====================================================
  Execution time = 1.4192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9192e-01
  Total weights = 1.9510e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282077430822
                                         uncertainty =       0.001919762787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282077430822
                                         uncertainty =       0.001919762787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375553380
  error estimate for blocks of size 2^( 2) =       0.000392780878
  error estimate for blocks of size 2^( 3) =       0.000410847082
  error estimate for blocks of size 2^( 4) =       0.000426572760
  error estimate for blocks of size 2^( 5) =       0.000438664321
  error estimate for blocks of size 2^( 6) =       0.000445268975
  error estimate for blocks of size 2^( 7) =       0.000450135552

      target function =      -0.925378780752
              le_mean =     -16.897974373370
             les_mean =     285.833461040258
             stat err =       0.000440160402
             autocorr =       1.373657903431
   target nu stat err =       0.000440160402
   target dn stat err =       0.002395348320
      target stat err =       0.003845185593
              std dev =       0.531112683328
             le_variance =       0.282080682392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282076727463
                                         uncertainty =       0.001919775882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282076727463
                                         uncertainty =       0.001919775882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375552910
  error estimate for blocks of size 2^( 2) =       0.000392780332
  error estimate for blocks of size 2^( 3) =       0.000410846428
  error estimate for blocks of size 2^( 4) =       0.000426571992
  error estimate for blocks of size 2^( 5) =       0.000438663457
  error estimate for blocks of size 2^( 6) =       0.000445268091
  error estimate for blocks of size 2^( 7) =       0.000450134600

      target function =      -0.925379617280
              le_mean =     -16.897974397756
             les_mean =     285.833461333280
             stat err =       0.000440159535
             autocorr =       1.373655929655
   target nu stat err =       0.000440159535
   target dn stat err =       0.002395347604
      target stat err =       0.003845191192
              std dev =       0.531112018825
             le_variance =       0.282079976540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282077078991
                                         uncertainty =       0.001919769336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282077078991
                                         uncertainty =       0.001919769336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375553145
  error estimate for blocks of size 2^( 2) =       0.000392780605
  error estimate for blocks of size 2^( 3) =       0.000410846755
  error estimate for blocks of size 2^( 4) =       0.000426572376
  error estimate for blocks of size 2^( 5) =       0.000438663889
  error estimate for blocks of size 2^( 6) =       0.000445268533
  error estimate for blocks of size 2^( 7) =       0.000450135076

      target function =      -0.925379212149
              le_mean =     -16.897974385557
             les_mean =     285.833461178217
             stat err =       0.000440159968
             autocorr =       1.373656916316
   target nu stat err =       0.000440159968
   target dn stat err =       0.002395347844
      target stat err =       0.003845188317
              std dev =       0.531112350934
             le_variance =       0.282080329315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282077386833
                                         uncertainty =       0.001919763606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282077386833
                                         uncertainty =       0.001919763606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375553351
  error estimate for blocks of size 2^( 2) =       0.000392780843
  error estimate for blocks of size 2^( 3) =       0.000410847041
  error estimate for blocks of size 2^( 4) =       0.000426572712
  error estimate for blocks of size 2^( 5) =       0.000438664267
  error estimate for blocks of size 2^( 6) =       0.000445268920
  error estimate for blocks of size 2^( 7) =       0.000450135492

      target function =      -0.925378835972
              le_mean =     -16.897974374892
             les_mean =     285.833461056647
             stat err =       0.000440160348
             autocorr =       1.373657780024
   target nu stat err =       0.000440160348
   target dn stat err =       0.002395348247
      target stat err =       0.003845185924
              std dev =       0.531112641770
             le_variance =       0.282080638248


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925378780752        initial
     1.4552e+02     1.4552e+03             3.1049e-06        -0.925379617280  <--
     5.8208e+02     5.8208e+03             7.7640e-07        -0.925379212149
     2.3283e+03     2.3283e+04             1.9411e-07        -0.925378835972

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.3753e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.031180e-01 3 1  ON 0
ci_0002                 6.979604e-01 3 1  ON 1
ci_0003                -3.153742e-02 3 1  ON 2
ci_0004                -3.136945e-02 3 1  ON 3
ci_0005                -2.892178e-02 3 1  ON 4
ci_0006                -2.995892e-02 3 1  ON 5
ci_0007                -1.586696e-02 3 1  ON 6
ci_0008                -1.649408e-02 3 1  ON 7
ci_0009                -1.872213e-02 3 1  ON 8
ci_0010                -1.887781e-02 3 1  ON 9
ci_0011                -1.550350e-02 3 1  ON 10
ci_0012                -1.563229e-02 3 1  ON 11
ci_0013                 1.548850e-02 3 1  ON 12
ci_0014                 1.537483e-02 3 1  ON 13
ci_0015                 1.629054e-02 3 1  ON 14
ci_0016                 1.595032e-02 3 1  ON 15
ci_0017                 1.373653e-02 3 1  ON 16
ci_0018                 1.393202e-02 3 1  ON 17
ci_0019                 1.259812e-02 3 1  ON 18
ci_0020                 1.224432e-02 3 1  ON 19
ci_0021                 1.351168e-02 3 1  ON 20
ci_0022                 1.498301e-02 3 1  ON 21
ci_0023                -1.182552e-02 3 1  ON 22
ci_0024                -1.113453e-02 3 1  ON 23
ci_0025                -2.820782e-03 3 1  ON 24
ci_0026                -2.392093e-03 3 1  ON 25
ci_0027                -1.179210e-02 3 1  ON 26
ci_0028                -1.174992e-02 3 1  ON 27
ci_0029                -1.044183e-02 3 1  ON 28
ci_0030                -1.036759e-02 3 1  ON 29
ci_0031                 1.383385e-02 3 1  ON 30
ci_0032                 1.290305e-02 3 1  ON 31
ci_0033                 8.253934e-03 3 1  ON 32
ci_0034                 8.533931e-03 3 1  ON 33
ci_0035                 4.886769e-03 3 1  ON 34
ci_0036                 4.737917e-03 3 1  ON 35
ci_0037                -1.141332e-02 3 1  ON 36
ci_0038                -1.131019e-02 3 1  ON 37
ci_0039                -3.818724e-03 3 1  ON 38
ci_0040                -3.938411e-03 3 1  ON 39
ci_0041                 9.549131e-03 3 1  ON 40
ci_0042                 9.453736e-03 3 1  ON 41
ci_0043                -7.810511e-03 3 1  ON 42
ci_0044                -8.272437e-03 3 1  ON 43
ci_0045                 1.041939e-02 3 1  ON 44
ci_0046                 9.667933e-03 3 1  ON 45
ci_0047                -3.597232e-03 3 1  ON 46
ci_0048                -3.621799e-03 3 1  ON 47
ci_0049                -2.504116e-03 3 1  ON 48
ci_0050                -2.579289e-03 3 1  ON 49
ci_0051                -1.839574e-03 3 1  ON 50
ci_0052                -1.721986e-03 3 1  ON 51
ci_0053                -3.848549e-03 3 1  ON 52
ci_0054                -3.732631e-03 3 1  ON 53
ci_0055                 2.333723e-03 3 1  ON 54
ci_0056                 2.077501e-03 3 1  ON 55
ci_0057                 2.312635e-03 3 1  ON 56
ci_0058                 2.891893e-03 3 1  ON 57
ci_0059                -3.899112e-03 3 1  ON 58
ci_0060                -3.669762e-03 3 1  ON 59
ci_0061                -3.115686e-03 3 1  ON 60
ci_0062                -3.326869e-03 3 1  ON 61
ci_0063                -9.706252e-03 3 1  ON 62
ci_0064                -9.659439e-03 3 1  ON 63
ci_0065                -6.917956e-03 3 1  ON 64
ci_0066                -6.463358e-03 3 1  ON 65
ci_0067                -3.905261e-03 3 1  ON 66
ci_0068                -3.849800e-03 3 1  ON 67
ci_0069                 3.716609e-03 3 1  ON 68
ci_0070                 3.464341e-03 3 1  ON 69
ci_0071                 4.079675e-03 3 1  ON 70
ci_0072                 4.250475e-03 3 1  ON 71
ci_0073                 3.371983e-03 3 1  ON 72
ci_0074                 3.332555e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9397
    reference variance = 0.21548
====================================================
  Execution time = 1.4466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9231e-01
  Total weights = 1.950743593e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282705656934
                                         uncertainty =       0.001706163367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282705656934
                                         uncertainty =       0.001706163367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375979853
  error estimate for blocks of size 2^( 2) =       0.000393124120
  error estimate for blocks of size 2^( 3) =       0.000410895870
  error estimate for blocks of size 2^( 4) =       0.000426398862
  error estimate for blocks of size 2^( 5) =       0.000439131637
  error estimate for blocks of size 2^( 6) =       0.000447640495
  error estimate for blocks of size 2^( 7) =       0.000450738101

      target function =      -0.924768297629
              le_mean =     -16.898173962479
             les_mean =     285.840597159655
             stat err =       0.000440977274
             autocorr =       1.375635162579
   target nu stat err =       0.000440977274
   target dn stat err =       0.002184035449
      target stat err =       0.003516476219
              std dev =       0.531715807710
             le_variance =       0.282721700169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689817396248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924780319376       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924781260042       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924781636852       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924781779325       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924781847188       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924781870722       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924781881939       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924781885435       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924781886634       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924781887352       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924781886587       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924781887241       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924781886809       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924781887023       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924781887408       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924781887268       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924781887113       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924781887097       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+01 is 9.981367e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924780319376       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924780554913       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924780649217       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924780684854       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924780701824       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924780707704       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924780710508       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924780711381       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924780711680       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924780711859       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924780711667       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924780711831       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924780711723       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924780711777       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924780711872       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924780711837       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924780711798       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924780711794       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 2.497656e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924780319376       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924780378283       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924780401866       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924780410776       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924780415019       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924780416488       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924780417189       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924780417408       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924780417482       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924780417527       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924780417479       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924780417520       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924780417493       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924780417506       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924780417530       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924780417521       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924780417512       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924780417512       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+02 is 6.245589e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.822271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7054e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.031191e-01 3 1  ON 0
ci_0002                 6.979595e-01 3 1  ON 1
ci_0003                -3.153704e-02 3 1  ON 2
ci_0004                -3.136847e-02 3 1  ON 3
ci_0005                -2.892242e-02 3 1  ON 4
ci_0006                -2.996014e-02 3 1  ON 5
ci_0007                -1.586666e-02 3 1  ON 6
ci_0008                -1.649322e-02 3 1  ON 7
ci_0009                -1.872215e-02 3 1  ON 8
ci_0010                -1.887725e-02 3 1  ON 9
ci_0011                -1.550310e-02 3 1  ON 10
ci_0012                -1.563195e-02 3 1  ON 11
ci_0013                 1.548872e-02 3 1  ON 12
ci_0014                 1.537461e-02 3 1  ON 13
ci_0015                 1.629023e-02 3 1  ON 14
ci_0016                 1.595065e-02 3 1  ON 15
ci_0017                 1.373656e-02 3 1  ON 16
ci_0018                 1.393130e-02 3 1  ON 17
ci_0019                 1.259819e-02 3 1  ON 18
ci_0020                 1.224458e-02 3 1  ON 19
ci_0021                 1.350965e-02 3 1  ON 20
ci_0022                 1.498097e-02 3 1  ON 21
ci_0023                -1.182551e-02 3 1  ON 22
ci_0024                -1.113470e-02 3 1  ON 23
ci_0025                -2.820180e-03 3 1  ON 24
ci_0026                -2.392101e-03 3 1  ON 25
ci_0027                -1.179278e-02 3 1  ON 26
ci_0028                -1.174984e-02 3 1  ON 27
ci_0029                -1.044202e-02 3 1  ON 28
ci_0030                -1.036780e-02 3 1  ON 29
ci_0031                 1.383365e-02 3 1  ON 30
ci_0032                 1.290296e-02 3 1  ON 31
ci_0033                 8.253683e-03 3 1  ON 32
ci_0034                 8.533171e-03 3 1  ON 33
ci_0035                 4.886943e-03 3 1  ON 34
ci_0036                 4.737332e-03 3 1  ON 35
ci_0037                -1.141385e-02 3 1  ON 36
ci_0038                -1.130985e-02 3 1  ON 37
ci_0039                -3.818634e-03 3 1  ON 38
ci_0040                -3.938233e-03 3 1  ON 39
ci_0041                 9.549037e-03 3 1  ON 40
ci_0042                 9.453695e-03 3 1  ON 41
ci_0043                -7.812331e-03 3 1  ON 42
ci_0044                -8.274935e-03 3 1  ON 43
ci_0045                 1.041929e-02 3 1  ON 44
ci_0046                 9.667626e-03 3 1  ON 45
ci_0047                -3.597028e-03 3 1  ON 46
ci_0048                -3.621457e-03 3 1  ON 47
ci_0049                -2.503968e-03 3 1  ON 48
ci_0050                -2.579285e-03 3 1  ON 49
ci_0051                -1.839574e-03 3 1  ON 50
ci_0052                -1.721992e-03 3 1  ON 51
ci_0053                -3.848485e-03 3 1  ON 52
ci_0054                -3.732936e-03 3 1  ON 53
ci_0055                 2.333860e-03 3 1  ON 54
ci_0056                 2.077516e-03 3 1  ON 55
ci_0057                 2.311754e-03 3 1  ON 56
ci_0058                 2.891728e-03 3 1  ON 57
ci_0059                -3.899005e-03 3 1  ON 58
ci_0060                -3.669330e-03 3 1  ON 59
ci_0061                -3.115924e-03 3 1  ON 60
ci_0062                -3.326806e-03 3 1  ON 61
ci_0063                -9.706326e-03 3 1  ON 62
ci_0064                -9.659320e-03 3 1  ON 63
ci_0065                -6.917578e-03 3 1  ON 64
ci_0066                -6.463178e-03 3 1  ON 65
ci_0067                -3.905153e-03 3 1  ON 66
ci_0068                -3.849483e-03 3 1  ON 67
ci_0069                 3.716835e-03 3 1  ON 68
ci_0070                 3.464196e-03 3 1  ON 69
ci_0071                 4.079358e-03 3 1  ON 70
ci_0072                 4.249992e-03 3 1  ON 71
ci_0073                 3.371270e-03 3 1  ON 72
ci_0074                 3.332679e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9249
    reference variance = 0.179763
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8798e-01
  Total weights = 1.9512e+06
  Execution time = 1.8856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280208091773
                                         uncertainty =       0.001565409174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280208091773
                                         uncertainty =       0.001565409174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374311480
  error estimate for blocks of size 2^( 2) =       0.000391713658
  error estimate for blocks of size 2^( 3) =       0.000409319636
  error estimate for blocks of size 2^( 4) =       0.000424705817
  error estimate for blocks of size 2^( 5) =       0.000436662224
  error estimate for blocks of size 2^( 6) =       0.000442092882
  error estimate for blocks of size 2^( 7) =       0.000445488991

      target function =      -0.931657128643
              le_mean =     -16.898845702802
             les_mean =     285.858963974794
             stat err =       0.000437237479
             autocorr =       1.364484067047
   target nu stat err =       0.000437237479
   target dn stat err =       0.001872471793
      target stat err =       0.003085762310
              std dev =       0.529356371315
             le_variance =       0.280218167852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280205086489
                                         uncertainty =       0.001565293593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280205086489
                                         uncertainty =       0.001565293593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374309474
  error estimate for blocks of size 2^( 2) =       0.000391711493
  error estimate for blocks of size 2^( 3) =       0.000409317222
  error estimate for blocks of size 2^( 4) =       0.000424703150
  error estimate for blocks of size 2^( 5) =       0.000436659286
  error estimate for blocks of size 2^( 6) =       0.000442089676
  error estimate for blocks of size 2^( 7) =       0.000445485906

      target function =      -0.931664553300
              le_mean =     -16.898845728246
             les_mean =     285.858960191896
             stat err =       0.000437234504
             autocorr =       1.364480129984
   target nu stat err =       0.000437234504
   target dn stat err =       0.001872223522
      target stat err =       0.003085423972
              std dev =       0.529353534131
             le_variance =       0.280215164097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280206586742
                                         uncertainty =       0.001565351303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280206586742
                                         uncertainty =       0.001565351303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374310475
  error estimate for blocks of size 2^( 2) =       0.000391712574
  error estimate for blocks of size 2^( 3) =       0.000409318427
  error estimate for blocks of size 2^( 4) =       0.000424704482
  error estimate for blocks of size 2^( 5) =       0.000436660753
  error estimate for blocks of size 2^( 6) =       0.000442091277
  error estimate for blocks of size 2^( 7) =       0.000445487446

      target function =      -0.931660881285
              le_mean =     -16.898845715386
             les_mean =     285.858962053470
             stat err =       0.000437235989
             autocorr =       1.364482097407
   target nu stat err =       0.000437235989
   target dn stat err =       0.001872347106
      target stat err =       0.003085592545
              std dev =       0.529354950471
             le_variance =       0.280216663588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280207903506
                                         uncertainty =       0.001565401936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280207903506
                                         uncertainty =       0.001565401936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374311354
  error estimate for blocks of size 2^( 2) =       0.000391713522
  error estimate for blocks of size 2^( 3) =       0.000409319485
  error estimate for blocks of size 2^( 4) =       0.000424705650
  error estimate for blocks of size 2^( 5) =       0.000436662040
  error estimate for blocks of size 2^( 6) =       0.000442092682
  error estimate for blocks of size 2^( 7) =       0.000445488798

      target function =      -0.931657601972
              le_mean =     -16.898845704359
             les_mean =     285.858963731417
             stat err =       0.000437237292
             autocorr =       1.364483820841
   target nu stat err =       0.000437237292
   target dn stat err =       0.001872456155
      target stat err =       0.003085741035
              std dev =       0.529356193580
             le_variance =       0.280217979681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931657128643        initial
     3.6380e+01     3.6380e+02             9.9814e-06        -0.931664553300  <--
     1.4552e+02     1.4552e+03             2.4977e-06        -0.931660881285
     5.8208e+02     5.8208e+03             6.2456e-07        -0.931657601972

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 2.3963e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.031222e-01 3 1  ON 0
ci_0002                 6.979567e-01 3 1  ON 1
ci_0003                -3.153588e-02 3 1  ON 2
ci_0004                -3.136554e-02 3 1  ON 3
ci_0005                -2.892432e-02 3 1  ON 4
ci_0006                -2.996379e-02 3 1  ON 5
ci_0007                -1.586576e-02 3 1  ON 6
ci_0008                -1.649064e-02 3 1  ON 7
ci_0009                -1.872222e-02 3 1  ON 8
ci_0010                -1.887558e-02 3 1  ON 9
ci_0011                -1.550193e-02 3 1  ON 10
ci_0012                -1.563093e-02 3 1  ON 11
ci_0013                 1.548937e-02 3 1  ON 12
ci_0014                 1.537395e-02 3 1  ON 13
ci_0015                 1.628930e-02 3 1  ON 14
ci_0016                 1.595163e-02 3 1  ON 15
ci_0017                 1.373665e-02 3 1  ON 16
ci_0018                 1.392914e-02 3 1  ON 17
ci_0019                 1.259841e-02 3 1  ON 18
ci_0020                 1.224534e-02 3 1  ON 19
ci_0021                 1.350356e-02 3 1  ON 20
ci_0022                 1.497485e-02 3 1  ON 21
ci_0023                -1.182546e-02 3 1  ON 22
ci_0024                -1.113522e-02 3 1  ON 23
ci_0025                -2.818378e-03 3 1  ON 24
ci_0026                -2.392123e-03 3 1  ON 25
ci_0027                -1.179481e-02 3 1  ON 26
ci_0028                -1.174960e-02 3 1  ON 27
ci_0029                -1.044257e-02 3 1  ON 28
ci_0030                -1.036841e-02 3 1  ON 29
ci_0031                 1.383307e-02 3 1  ON 30
ci_0032                 1.290272e-02 3 1  ON 31
ci_0033                 8.252929e-03 3 1  ON 32
ci_0034                 8.530895e-03 3 1  ON 33
ci_0035                 4.887464e-03 3 1  ON 34
ci_0036                 4.735579e-03 3 1  ON 35
ci_0037                -1.141541e-02 3 1  ON 36
ci_0038                -1.130882e-02 3 1  ON 37
ci_0039                -3.818362e-03 3 1  ON 38
ci_0040                -3.937700e-03 3 1  ON 39
ci_0041                 9.548756e-03 3 1  ON 40
ci_0042                 9.453572e-03 3 1  ON 41
ci_0043                -7.817784e-03 3 1  ON 42
ci_0044                -8.282419e-03 3 1  ON 43
ci_0045                 1.041899e-02 3 1  ON 44
ci_0046                 9.666706e-03 3 1  ON 45
ci_0047                -3.596421e-03 3 1  ON 46
ci_0048                -3.620432e-03 3 1  ON 47
ci_0049                -2.503525e-03 3 1  ON 48
ci_0050                -2.579272e-03 3 1  ON 49
ci_0051                -1.839573e-03 3 1  ON 50
ci_0052                -1.722011e-03 3 1  ON 51
ci_0053                -3.848293e-03 3 1  ON 52
ci_0054                -3.733851e-03 3 1  ON 53
ci_0055                 2.334271e-03 3 1  ON 54
ci_0056                 2.077561e-03 3 1  ON 55
ci_0057                 2.309117e-03 3 1  ON 56
ci_0058                 2.891232e-03 3 1  ON 57
ci_0059                -3.898687e-03 3 1  ON 58
ci_0060                -3.668038e-03 3 1  ON 59
ci_0061                -3.116636e-03 3 1  ON 60
ci_0062                -3.326616e-03 3 1  ON 61
ci_0063                -9.706549e-03 3 1  ON 62
ci_0064                -9.658962e-03 3 1  ON 63
ci_0065                -6.916447e-03 3 1  ON 64
ci_0066                -6.462639e-03 3 1  ON 65
ci_0067                -3.904830e-03 3 1  ON 66
ci_0068                -3.848531e-03 3 1  ON 67
ci_0069                 3.717511e-03 3 1  ON 68
ci_0070                 3.463762e-03 3 1  ON 69
ci_0071                 4.078411e-03 3 1  ON 70
ci_0072                 4.248545e-03 3 1  ON 71
ci_0073                 3.369137e-03 3 1  ON 72
ci_0074                 3.333051e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1023e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9651
    reference variance = 0.143047
====================================================
  Execution time = 1.4460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5208e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9096e-01
  Total weights = 1.950877655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281278716814
                                         uncertainty =       0.002126906763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281278716814
                                         uncertainty =       0.002126906763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374962514
  error estimate for blocks of size 2^( 2) =       0.000392545781
  error estimate for blocks of size 2^( 3) =       0.000410647900
  error estimate for blocks of size 2^( 4) =       0.000426631651
  error estimate for blocks of size 2^( 5) =       0.000439159312
  error estimate for blocks of size 2^( 6) =       0.000447477343
  error estimate for blocks of size 2^( 7) =       0.000452240178

      target function =      -0.926891539312
              le_mean =     -16.897826542939
             les_mean =     285.827502953883
             stat err =       0.000441377121
             autocorr =       1.385619321421
   target nu stat err =       0.000441377121
   target dn stat err =       0.002550649771
      target stat err =       0.004097726663
              std dev =       0.530277072831
             le_variance =       0.281193773970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689782654294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926908418899       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926917005371       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926919415836       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926920949465       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926921565555       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926921825325       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926921915211       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926921917809       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926921915160       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926921915062       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926921927132       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926921908978       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926921910199       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926921920135       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926921922417       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926921925028       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926921926743       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926921927163       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+00 is 6.822826e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926908418899       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926910579284       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926911184797       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926911569190       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926911723294       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926911788115       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926911810517       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926911811144       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926911810466       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926911810437       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926911813456       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926911808918       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926911809247       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926911811716       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926911812281       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926911812926       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926911813348       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926911813450       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+01 is 1.711546e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926908418899       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926908959863       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926909111423       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926909207583       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926909246114       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926909262311       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926909267907       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926909268063       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926909267892       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926909267885       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926909268640       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926909267505       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926909267589       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926909268206       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926909268346       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926909268507       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926909268612       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926909268637       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 4.282531e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.832581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7055e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.031276e-01 3 1  ON 0
ci_0002                 6.979522e-01 3 1  ON 1
ci_0003                -3.153297e-02 3 1  ON 2
ci_0004                -3.136243e-02 3 1  ON 3
ci_0005                -2.892541e-02 3 1  ON 4
ci_0006                -2.996672e-02 3 1  ON 5
ci_0007                -1.586461e-02 3 1  ON 6
ci_0008                -1.648994e-02 3 1  ON 7
ci_0009                -1.871971e-02 3 1  ON 8
ci_0010                -1.887381e-02 3 1  ON 9
ci_0011                -1.550014e-02 3 1  ON 10
ci_0012                -1.562881e-02 3 1  ON 11
ci_0013                 1.548609e-02 3 1  ON 12
ci_0014                 1.537101e-02 3 1  ON 13
ci_0015                 1.628852e-02 3 1  ON 14
ci_0016                 1.595121e-02 3 1  ON 15
ci_0017                 1.373707e-02 3 1  ON 16
ci_0018                 1.392599e-02 3 1  ON 17
ci_0019                 1.259836e-02 3 1  ON 18
ci_0020                 1.224716e-02 3 1  ON 19
ci_0021                 1.348644e-02 3 1  ON 20
ci_0022                 1.496430e-02 3 1  ON 21
ci_0023                -1.182658e-02 3 1  ON 22
ci_0024                -1.113561e-02 3 1  ON 23
ci_0025                -2.815853e-03 3 1  ON 24
ci_0026                -2.391799e-03 3 1  ON 25
ci_0027                -1.179611e-02 3 1  ON 26
ci_0028                -1.174982e-02 3 1  ON 27
ci_0029                -1.044164e-02 3 1  ON 28
ci_0030                -1.037098e-02 3 1  ON 29
ci_0031                 1.383090e-02 3 1  ON 30
ci_0032                 1.290234e-02 3 1  ON 31
ci_0033                 8.251860e-03 3 1  ON 32
ci_0034                 8.532097e-03 3 1  ON 33
ci_0035                 4.890651e-03 3 1  ON 34
ci_0036                 4.736897e-03 3 1  ON 35
ci_0037                -1.141498e-02 3 1  ON 36
ci_0038                -1.130815e-02 3 1  ON 37
ci_0039                -3.818004e-03 3 1  ON 38
ci_0040                -3.938756e-03 3 1  ON 39
ci_0041                 9.548252e-03 3 1  ON 40
ci_0042                 9.453919e-03 3 1  ON 41
ci_0043                -7.827571e-03 3 1  ON 42
ci_0044                -8.290841e-03 3 1  ON 43
ci_0045                 1.041663e-02 3 1  ON 44
ci_0046                 9.665578e-03 3 1  ON 45
ci_0047                -3.596294e-03 3 1  ON 46
ci_0048                -3.619553e-03 3 1  ON 47
ci_0049                -2.504793e-03 3 1  ON 48
ci_0050                -2.579189e-03 3 1  ON 49
ci_0051                -1.838836e-03 3 1  ON 50
ci_0052                -1.722090e-03 3 1  ON 51
ci_0053                -3.847531e-03 3 1  ON 52
ci_0054                -3.733274e-03 3 1  ON 53
ci_0055                 2.333248e-03 3 1  ON 54
ci_0056                 2.075891e-03 3 1  ON 55
ci_0057                 2.311800e-03 3 1  ON 56
ci_0058                 2.891758e-03 3 1  ON 57
ci_0059                -3.894549e-03 3 1  ON 58
ci_0060                -3.667997e-03 3 1  ON 59
ci_0061                -3.116952e-03 3 1  ON 60
ci_0062                -3.328939e-03 3 1  ON 61
ci_0063                -9.705283e-03 3 1  ON 62
ci_0064                -9.660250e-03 3 1  ON 63
ci_0065                -6.916355e-03 3 1  ON 64
ci_0066                -6.461510e-03 3 1  ON 65
ci_0067                -3.904878e-03 3 1  ON 66
ci_0068                -3.848384e-03 3 1  ON 67
ci_0069                 3.712382e-03 3 1  ON 68
ci_0070                 3.463962e-03 3 1  ON 69
ci_0071                 4.074546e-03 3 1  ON 70
ci_0072                 4.246228e-03 3 1  ON 71
ci_0073                 3.368948e-03 3 1  ON 72
ci_0074                 3.333367e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8674
    reference variance = 0.279723
====================================================
  Execution time = 1.4440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9491e-01
  Total weights = 1.9509e+06
  Execution time = 1.8857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284880867568
                                         uncertainty =       0.002204855543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284880867568
                                         uncertainty =       0.002204855543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377392946
  error estimate for blocks of size 2^( 2) =       0.000394174261
  error estimate for blocks of size 2^( 3) =       0.000412068790
  error estimate for blocks of size 2^( 4) =       0.000427815192
  error estimate for blocks of size 2^( 5) =       0.000438719762
  error estimate for blocks of size 2^( 6) =       0.000445404911
  error estimate for blocks of size 2^( 7) =       0.000449785628

      target function =      -0.920707176290
              le_mean =     -16.898183312368
             les_mean =     285.843498569321
             stat err =       0.000440431373
             autocorr =       1.361974384280
   target nu stat err =       0.000440431373
   target dn stat err =       0.003122612869
      target stat err =       0.004925851536
              std dev =       0.533714221973
             le_variance =       0.284850870737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284870286659
                                         uncertainty =       0.002205579887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284870286659
                                         uncertainty =       0.002205579887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377385947
  error estimate for blocks of size 2^( 2) =       0.000394166383
  error estimate for blocks of size 2^( 3) =       0.000412059064
  error estimate for blocks of size 2^( 4) =       0.000427803487
  error estimate for blocks of size 2^( 5) =       0.000438707128
  error estimate for blocks of size 2^( 6) =       0.000445389797
  error estimate for blocks of size 2^( 7) =       0.000449769812

      target function =      -0.920662540009
              le_mean =     -16.898182935286
             les_mean =     285.843514362024
             stat err =       0.000440417556
             autocorr =       1.361939443699
   target nu stat err =       0.000440417556
   target dn stat err =       0.003131246000
      target stat err =       0.004938678615
              std dev =       0.533704323848
             le_variance =       0.284840305294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284875516143
                                         uncertainty =       0.002205214614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284875516143
                                         uncertainty =       0.002205214614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377389406
  error estimate for blocks of size 2^( 2) =       0.000394170280
  error estimate for blocks of size 2^( 3) =       0.000412063882
  error estimate for blocks of size 2^( 4) =       0.000427809289
  error estimate for blocks of size 2^( 5) =       0.000438713393
  error estimate for blocks of size 2^( 6) =       0.000445397296
  error estimate for blocks of size 2^( 7) =       0.000449777658

      target function =      -0.920686462637
              le_mean =     -16.898183118717
             les_mean =     285.843505265642
             stat err =       0.000440424409
             autocorr =       1.361956861234
   target nu stat err =       0.000440424409
   target dn stat err =       0.003126733589
      target stat err =       0.004931980357
              std dev =       0.533709215888
             le_variance =       0.284845527124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284880193736
                                         uncertainty =       0.002204899916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284880193736
                                         uncertainty =       0.002204899916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377392500
  error estimate for blocks of size 2^( 2) =       0.000394173760
  error estimate for blocks of size 2^( 3) =       0.000412068173
  error estimate for blocks of size 2^( 4) =       0.000427814450
  error estimate for blocks of size 2^( 5) =       0.000438718962
  error estimate for blocks of size 2^( 6) =       0.000445403956
  error estimate for blocks of size 2^( 7) =       0.000449784627

      target function =      -0.920704758859
              le_mean =     -16.898183287658
             les_mean =     285.843499279357
             stat err =       0.000440430499
             autocorr =       1.361972193399
   target nu stat err =       0.000440430499
   target dn stat err =       0.003123106190
      target stat err =       0.004926585916
              std dev =       0.533713591626
             le_variance =       0.284850197886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920707176290        initial  <--
     9.0949e+00     9.0949e+01             6.8228e-05        -0.920662540009
     3.6380e+01     3.6380e+02             1.7115e-05        -0.920686462637
     1.4552e+02     1.4552e+03             4.2825e-06        -0.920704758859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9634
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.031222e-01 3 1  ON 0
ci_0002                 6.979567e-01 3 1  ON 1
ci_0003                -3.153588e-02 3 1  ON 2
ci_0004                -3.136554e-02 3 1  ON 3
ci_0005                -2.892432e-02 3 1  ON 4
ci_0006                -2.996379e-02 3 1  ON 5
ci_0007                -1.586576e-02 3 1  ON 6
ci_0008                -1.649064e-02 3 1  ON 7
ci_0009                -1.872222e-02 3 1  ON 8
ci_0010                -1.887558e-02 3 1  ON 9
ci_0011                -1.550193e-02 3 1  ON 10
ci_0012                -1.563093e-02 3 1  ON 11
ci_0013                 1.548937e-02 3 1  ON 12
ci_0014                 1.537395e-02 3 1  ON 13
ci_0015                 1.628930e-02 3 1  ON 14
ci_0016                 1.595163e-02 3 1  ON 15
ci_0017                 1.373665e-02 3 1  ON 16
ci_0018                 1.392914e-02 3 1  ON 17
ci_0019                 1.259841e-02 3 1  ON 18
ci_0020                 1.224534e-02 3 1  ON 19
ci_0021                 1.350356e-02 3 1  ON 20
ci_0022                 1.497485e-02 3 1  ON 21
ci_0023                -1.182546e-02 3 1  ON 22
ci_0024                -1.113522e-02 3 1  ON 23
ci_0025                -2.818378e-03 3 1  ON 24
ci_0026                -2.392123e-03 3 1  ON 25
ci_0027                -1.179481e-02 3 1  ON 26
ci_0028                -1.174960e-02 3 1  ON 27
ci_0029                -1.044257e-02 3 1  ON 28
ci_0030                -1.036841e-02 3 1  ON 29
ci_0031                 1.383307e-02 3 1  ON 30
ci_0032                 1.290272e-02 3 1  ON 31
ci_0033                 8.252929e-03 3 1  ON 32
ci_0034                 8.530895e-03 3 1  ON 33
ci_0035                 4.887464e-03 3 1  ON 34
ci_0036                 4.735579e-03 3 1  ON 35
ci_0037                -1.141541e-02 3 1  ON 36
ci_0038                -1.130882e-02 3 1  ON 37
ci_0039                -3.818362e-03 3 1  ON 38
ci_0040                -3.937700e-03 3 1  ON 39
ci_0041                 9.548756e-03 3 1  ON 40
ci_0042                 9.453572e-03 3 1  ON 41
ci_0043                -7.817784e-03 3 1  ON 42
ci_0044                -8.282419e-03 3 1  ON 43
ci_0045                 1.041899e-02 3 1  ON 44
ci_0046                 9.666706e-03 3 1  ON 45
ci_0047                -3.596421e-03 3 1  ON 46
ci_0048                -3.620432e-03 3 1  ON 47
ci_0049                -2.503525e-03 3 1  ON 48
ci_0050                -2.579272e-03 3 1  ON 49
ci_0051                -1.839573e-03 3 1  ON 50
ci_0052                -1.722011e-03 3 1  ON 51
ci_0053                -3.848293e-03 3 1  ON 52
ci_0054                -3.733851e-03 3 1  ON 53
ci_0055                 2.334271e-03 3 1  ON 54
ci_0056                 2.077561e-03 3 1  ON 55
ci_0057                 2.309117e-03 3 1  ON 56
ci_0058                 2.891232e-03 3 1  ON 57
ci_0059                -3.898687e-03 3 1  ON 58
ci_0060                -3.668038e-03 3 1  ON 59
ci_0061                -3.116636e-03 3 1  ON 60
ci_0062                -3.326616e-03 3 1  ON 61
ci_0063                -9.706549e-03 3 1  ON 62
ci_0064                -9.658962e-03 3 1  ON 63
ci_0065                -6.916447e-03 3 1  ON 64
ci_0066                -6.462639e-03 3 1  ON 65
ci_0067                -3.904830e-03 3 1  ON 66
ci_0068                -3.848531e-03 3 1  ON 67
ci_0069                 3.717511e-03 3 1  ON 68
ci_0070                 3.463762e-03 3 1  ON 69
ci_0071                 4.078411e-03 3 1  ON 70
ci_0072                 4.248545e-03 3 1  ON 71
ci_0073                 3.369137e-03 3 1  ON 72
ci_0074                 3.333051e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1025e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9328
    reference variance = 0.265752
====================================================
  Execution time = 1.6581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9040e-01
  Total weights = 1.951258732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280329733712
                                         uncertainty =       0.001446813048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280329733712
                                         uncertainty =       0.001446813048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374376523
  error estimate for blocks of size 2^( 2) =       0.000391891426
  error estimate for blocks of size 2^( 3) =       0.000409971381
  error estimate for blocks of size 2^( 4) =       0.000425020049
  error estimate for blocks of size 2^( 5) =       0.000436891864
  error estimate for blocks of size 2^( 6) =       0.000444848665
  error estimate for blocks of size 2^( 7) =       0.000449779685

      target function =      -0.927775669021
              le_mean =     -16.897703991480
             les_mean =     285.822803835204
             stat err =       0.000439135066
             autocorr =       1.375875139257
   target nu stat err =       0.000439135066
   target dn stat err =       0.002171001522
      target stat err =       0.003514991976
              std dev =       0.529448355809
             le_variance =       0.280315561469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689770399148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927787590049       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927788021263       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927788148498       residual = 8.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927788214795       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927788243350       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927788248103       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927788252395       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927788253716       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927788254938       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927788256700       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927788256605       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927788257547       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927788258275       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927788258477       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927788258267       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927788258376       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927788258384       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927788258416       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 5.130406e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927787590049       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927787697920       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927787729741       residual = 8.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927787746319       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927787753458       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927787754646       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927787755719       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927787756048       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927787756354       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927787756794       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927787756771       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927787757006       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927787757188       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927787757238       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927787757185       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927787757212       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927787757215       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927787757222       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+02 is 1.283043e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927787590049       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927787617021       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927787624977       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927787629123       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927787630906       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927787631203       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927787631470       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927787631554       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927787631631       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927787631736       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927787631737       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927787631794       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927787631837       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927787631851       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927787631835       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927787631848       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927787631846       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927787631847       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+03 is 3.207883e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.842804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9161e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.031228e-01 3 1  ON 0
ci_0002                 6.979561e-01 3 1  ON 1
ci_0003                -3.153561e-02 3 1  ON 2
ci_0004                -3.136551e-02 3 1  ON 3
ci_0005                -2.892456e-02 3 1  ON 4
ci_0006                -2.996398e-02 3 1  ON 5
ci_0007                -1.586582e-02 3 1  ON 6
ci_0008                -1.649023e-02 3 1  ON 7
ci_0009                -1.872223e-02 3 1  ON 8
ci_0010                -1.887559e-02 3 1  ON 9
ci_0011                -1.550180e-02 3 1  ON 10
ci_0012                -1.563073e-02 3 1  ON 11
ci_0013                 1.548954e-02 3 1  ON 12
ci_0014                 1.537396e-02 3 1  ON 13
ci_0015                 1.628923e-02 3 1  ON 14
ci_0016                 1.595132e-02 3 1  ON 15
ci_0017                 1.373669e-02 3 1  ON 16
ci_0018                 1.392889e-02 3 1  ON 17
ci_0019                 1.259846e-02 3 1  ON 18
ci_0020                 1.224533e-02 3 1  ON 19
ci_0021                 1.350227e-02 3 1  ON 20
ci_0022                 1.497419e-02 3 1  ON 21
ci_0023                -1.182543e-02 3 1  ON 22
ci_0024                -1.113526e-02 3 1  ON 23
ci_0025                -2.818319e-03 3 1  ON 24
ci_0026                -2.392116e-03 3 1  ON 25
ci_0027                -1.179481e-02 3 1  ON 26
ci_0028                -1.174957e-02 3 1  ON 27
ci_0029                -1.044262e-02 3 1  ON 28
ci_0030                -1.036851e-02 3 1  ON 29
ci_0031                 1.383312e-02 3 1  ON 30
ci_0032                 1.290279e-02 3 1  ON 31
ci_0033                 8.252803e-03 3 1  ON 32
ci_0034                 8.530826e-03 3 1  ON 33
ci_0035                 4.887681e-03 3 1  ON 34
ci_0036                 4.735926e-03 3 1  ON 35
ci_0037                -1.141532e-02 3 1  ON 36
ci_0038                -1.130892e-02 3 1  ON 37
ci_0039                -3.818451e-03 3 1  ON 38
ci_0040                -3.937724e-03 3 1  ON 39
ci_0041                 9.548751e-03 3 1  ON 40
ci_0042                 9.453469e-03 3 1  ON 41
ci_0043                -7.818391e-03 3 1  ON 42
ci_0044                -8.283311e-03 3 1  ON 43
ci_0045                 1.041896e-02 3 1  ON 44
ci_0046                 9.666887e-03 3 1  ON 45
ci_0047                -3.596469e-03 3 1  ON 46
ci_0048                -3.620310e-03 3 1  ON 47
ci_0049                -2.503620e-03 3 1  ON 48
ci_0050                -2.579327e-03 3 1  ON 49
ci_0051                -1.839545e-03 3 1  ON 50
ci_0052                -1.722001e-03 3 1  ON 51
ci_0053                -3.848292e-03 3 1  ON 52
ci_0054                -3.733800e-03 3 1  ON 53
ci_0055                 2.334185e-03 3 1  ON 54
ci_0056                 2.077564e-03 3 1  ON 55
ci_0057                 2.308990e-03 3 1  ON 56
ci_0058                 2.890871e-03 3 1  ON 57
ci_0059                -3.898613e-03 3 1  ON 58
ci_0060                -3.667878e-03 3 1  ON 59
ci_0061                -3.116713e-03 3 1  ON 60
ci_0062                -3.326763e-03 3 1  ON 61
ci_0063                -9.706461e-03 3 1  ON 62
ci_0064                -9.658941e-03 3 1  ON 63
ci_0065                -6.916378e-03 3 1  ON 64
ci_0066                -6.462528e-03 3 1  ON 65
ci_0067                -3.904806e-03 3 1  ON 66
ci_0068                -3.848357e-03 3 1  ON 67
ci_0069                 3.717505e-03 3 1  ON 68
ci_0070                 3.463634e-03 3 1  ON 69
ci_0071                 4.078139e-03 3 1  ON 70
ci_0072                 4.248410e-03 3 1  ON 71
ci_0073                 3.369272e-03 3 1  ON 72
ci_0074                 3.333040e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.249561
====================================================
  Execution time = 1.4204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9349e-01
  Total weights = 1.9508e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282747401862
                                         uncertainty =       0.001628782272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282747401862
                                         uncertainty =       0.001628782272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375962560
  error estimate for blocks of size 2^( 2) =       0.000393590793
  error estimate for blocks of size 2^( 3) =       0.000411614534
  error estimate for blocks of size 2^( 4) =       0.000428136980
  error estimate for blocks of size 2^( 5) =       0.000440362316
  error estimate for blocks of size 2^( 6) =       0.000448550251
  error estimate for blocks of size 2^( 7) =       0.000454565318

      target function =      -0.922899003011
              le_mean =     -16.897642476872
             les_mean =     285.823815838887
             stat err =       0.000442903716
             autocorr =       1.387808206238
   target nu stat err =       0.000442903716
   target dn stat err =       0.003076989221
      target stat err =       0.004874212651
              std dev =       0.531691351791
             le_variance =       0.282695693569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282746348852
                                         uncertainty =       0.001628754432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282746348852
                                         uncertainty =       0.001628754432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375961860
  error estimate for blocks of size 2^( 2) =       0.000393589960
  error estimate for blocks of size 2^( 3) =       0.000411613536
  error estimate for blocks of size 2^( 4) =       0.000428135821
  error estimate for blocks of size 2^( 5) =       0.000440361117
  error estimate for blocks of size 2^( 6) =       0.000448548994
  error estimate for blocks of size 2^( 7) =       0.000454563957

      target function =      -0.922901827158
              le_mean =     -16.897642491330
             les_mean =     285.823814517482
             stat err =       0.000442902472
             autocorr =       1.387805582799
   target nu stat err =       0.000442902472
   target dn stat err =       0.003077532124
      target stat err =       0.004875081568
              std dev =       0.531690361366
             le_variance =       0.282694640370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282746874958
                                         uncertainty =       0.001628768336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282746874958
                                         uncertainty =       0.001628768336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375962210
  error estimate for blocks of size 2^( 2) =       0.000393590376
  error estimate for blocks of size 2^( 3) =       0.000411614034
  error estimate for blocks of size 2^( 4) =       0.000428136400
  error estimate for blocks of size 2^( 5) =       0.000440361716
  error estimate for blocks of size 2^( 6) =       0.000448549622
  error estimate for blocks of size 2^( 7) =       0.000454564637

      target function =      -0.922900444634
              le_mean =     -16.897642484077
             les_mean =     285.823815158487
             stat err =       0.000442903094
             autocorr =       1.387806894188
   target nu stat err =       0.000442903094
   target dn stat err =       0.003077260309
      target stat err =       0.004874646854
              std dev =       0.531690856204
             le_variance =       0.282695166571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282747335974
                                         uncertainty =       0.001628780529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282747335974
                                         uncertainty =       0.001628780529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375962517
  error estimate for blocks of size 2^( 2) =       0.000393590741
  error estimate for blocks of size 2^( 3) =       0.000411614471
  error estimate for blocks of size 2^( 4) =       0.000428136907
  error estimate for blocks of size 2^( 5) =       0.000440362241
  error estimate for blocks of size 2^( 6) =       0.000448550172
  error estimate for blocks of size 2^( 7) =       0.000454565233

      target function =      -0.922899186475
              le_mean =     -16.897642477770
             les_mean =     285.823815751656
             stat err =       0.000442903638
             autocorr =       1.387808042228
   target nu stat err =       0.000442903638
   target dn stat err =       0.003077023056
      target stat err =       0.004874266882
              std dev =       0.531691289819
             le_variance =       0.282695627670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922899003011        initial
     9.0949e+01     9.0949e+02             5.1304e-06        -0.922901827158  <--
     3.6380e+02     3.6380e+03             1.2830e-06        -0.922900444634
     1.4552e+03     1.4552e+04             3.2079e-07        -0.922899186475

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.3728e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.031246e-01 3 1  ON 0
ci_0002                 6.979544e-01 3 1  ON 1
ci_0003                -3.153478e-02 3 1  ON 2
ci_0004                -3.136543e-02 3 1  ON 3
ci_0005                -2.892530e-02 3 1  ON 4
ci_0006                -2.996453e-02 3 1  ON 5
ci_0007                -1.586599e-02 3 1  ON 6
ci_0008                -1.648901e-02 3 1  ON 7
ci_0009                -1.872225e-02 3 1  ON 8
ci_0010                -1.887562e-02 3 1  ON 9
ci_0011                -1.550143e-02 3 1  ON 10
ci_0012                -1.563014e-02 3 1  ON 11
ci_0013                 1.549005e-02 3 1  ON 12
ci_0014                 1.537401e-02 3 1  ON 13
ci_0015                 1.628902e-02 3 1  ON 14
ci_0016                 1.595037e-02 3 1  ON 15
ci_0017                 1.373683e-02 3 1  ON 16
ci_0018                 1.392812e-02 3 1  ON 17
ci_0019                 1.259862e-02 3 1  ON 18
ci_0020                 1.224530e-02 3 1  ON 19
ci_0021                 1.349843e-02 3 1  ON 20
ci_0022                 1.497222e-02 3 1  ON 21
ci_0023                -1.182535e-02 3 1  ON 22
ci_0024                -1.113537e-02 3 1  ON 23
ci_0025                -2.818140e-03 3 1  ON 24
ci_0026                -2.392093e-03 3 1  ON 25
ci_0027                -1.179480e-02 3 1  ON 26
ci_0028                -1.174947e-02 3 1  ON 27
ci_0029                -1.044278e-02 3 1  ON 28
ci_0030                -1.036880e-02 3 1  ON 29
ci_0031                 1.383324e-02 3 1  ON 30
ci_0032                 1.290300e-02 3 1  ON 31
ci_0033                 8.252427e-03 3 1  ON 32
ci_0034                 8.530618e-03 3 1  ON 33
ci_0035                 4.888331e-03 3 1  ON 34
ci_0036                 4.736966e-03 3 1  ON 35
ci_0037                -1.141507e-02 3 1  ON 36
ci_0038                -1.130921e-02 3 1  ON 37
ci_0039                -3.818720e-03 3 1  ON 38
ci_0040                -3.937797e-03 3 1  ON 39
ci_0041                 9.548734e-03 3 1  ON 40
ci_0042                 9.453160e-03 3 1  ON 41
ci_0043                -7.820210e-03 3 1  ON 42
ci_0044                -8.285986e-03 3 1  ON 43
ci_0045                 1.041886e-02 3 1  ON 44
ci_0046                 9.667430e-03 3 1  ON 45
ci_0047                -3.596613e-03 3 1  ON 46
ci_0048                -3.619944e-03 3 1  ON 47
ci_0049                -2.503905e-03 3 1  ON 48
ci_0050                -2.579490e-03 3 1  ON 49
ci_0051                -1.839462e-03 3 1  ON 50
ci_0052                -1.721972e-03 3 1  ON 51
ci_0053                -3.848289e-03 3 1  ON 52
ci_0054                -3.733646e-03 3 1  ON 53
ci_0055                 2.333926e-03 3 1  ON 54
ci_0056                 2.077573e-03 3 1  ON 55
ci_0057                 2.308612e-03 3 1  ON 56
ci_0058                 2.889789e-03 3 1  ON 57
ci_0059                -3.898393e-03 3 1  ON 58
ci_0060                -3.667398e-03 3 1  ON 59
ci_0061                -3.116944e-03 3 1  ON 60
ci_0062                -3.327200e-03 3 1  ON 61
ci_0063                -9.706197e-03 3 1  ON 62
ci_0064                -9.658879e-03 3 1  ON 63
ci_0065                -6.916174e-03 3 1  ON 64
ci_0066                -6.462196e-03 3 1  ON 65
ci_0067                -3.904737e-03 3 1  ON 66
ci_0068                -3.847834e-03 3 1  ON 67
ci_0069                 3.717487e-03 3 1  ON 68
ci_0070                 3.463253e-03 3 1  ON 69
ci_0071                 4.077322e-03 3 1  ON 70
ci_0072                 4.248008e-03 3 1  ON 71
ci_0073                 3.369675e-03 3 1  ON 72
ci_0074                 3.333008e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.247804
====================================================
  Execution time = 1.4641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8698e-01
  Total weights = 1.951232839e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278961362942
                                         uncertainty =       0.001374125389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278961362942
                                         uncertainty =       0.001374125389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373431232
  error estimate for blocks of size 2^( 2) =       0.000390732442
  error estimate for blocks of size 2^( 3) =       0.000408174887
  error estimate for blocks of size 2^( 4) =       0.000423096703
  error estimate for blocks of size 2^( 5) =       0.000434886829
  error estimate for blocks of size 2^( 6) =       0.000441262883
  error estimate for blocks of size 2^( 7) =       0.000444655084

      target function =      -0.933234738839
              le_mean =     -16.897905463050
             les_mean =     285.826187413796
             stat err =       0.000435975375
             autocorr =       1.363021304317
   target nu stat err =       0.000435975375
   target dn stat err =       0.001841913323
      target stat err =       0.003042584123
              std dev =       0.528111513220
             le_variance =       0.278901770396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689790546305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933243293980       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933245793360       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933246561888       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933247068652       residual = 8.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933247256719       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933247307894       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933247318031       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933247325820       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933247325814       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933247327361       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933247334863       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933247340468       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933247339011       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933247338682       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933247337789       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933247337743       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933247337513       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933247337859       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.780991e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933243293980       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933243920453       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933244112981       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933244239792       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933244286807       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933244299589       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933244302118       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933244304064       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933244304061       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933244304449       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933244306325       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933244307722       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933244307354       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933244307271       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933244307049       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933244307038       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933244306981       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933244307067       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 4.458950e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933243293980       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933243450700       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933243498857       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933243530568       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933243542322       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933243545516       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933243546148       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933243546635       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933243546633       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933243546730       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933243547200       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933243547548       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933243547456       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933243547436       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933243547380       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933243547378       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933243547363       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933243547385       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+02 is 1.115143e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.853088 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7209e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.031230e-01 3 1  ON 0
ci_0002                 6.979563e-01 3 1  ON 1
ci_0003                -3.153388e-02 3 1  ON 2
ci_0004                -3.136445e-02 3 1  ON 3
ci_0005                -2.892547e-02 3 1  ON 4
ci_0006                -2.996601e-02 3 1  ON 5
ci_0007                -1.586564e-02 3 1  ON 6
ci_0008                -1.648781e-02 3 1  ON 7
ci_0009                -1.872230e-02 3 1  ON 8
ci_0010                -1.887550e-02 3 1  ON 9
ci_0011                -1.550135e-02 3 1  ON 10
ci_0012                -1.562901e-02 3 1  ON 11
ci_0013                 1.548945e-02 3 1  ON 12
ci_0014                 1.537358e-02 3 1  ON 13
ci_0015                 1.628916e-02 3 1  ON 14
ci_0016                 1.595012e-02 3 1  ON 15
ci_0017                 1.373647e-02 3 1  ON 16
ci_0018                 1.392722e-02 3 1  ON 17
ci_0019                 1.259809e-02 3 1  ON 18
ci_0020                 1.224547e-02 3 1  ON 19
ci_0021                 1.349423e-02 3 1  ON 20
ci_0022                 1.496776e-02 3 1  ON 21
ci_0023                -1.182528e-02 3 1  ON 22
ci_0024                -1.113541e-02 3 1  ON 23
ci_0025                -2.816468e-03 3 1  ON 24
ci_0026                -2.390901e-03 3 1  ON 25
ci_0027                -1.179507e-02 3 1  ON 26
ci_0028                -1.174917e-02 3 1  ON 27
ci_0029                -1.044318e-02 3 1  ON 28
ci_0030                -1.036863e-02 3 1  ON 29
ci_0031                 1.383316e-02 3 1  ON 30
ci_0032                 1.290349e-02 3 1  ON 31
ci_0033                 8.252600e-03 3 1  ON 32
ci_0034                 8.530127e-03 3 1  ON 33
ci_0035                 4.888540e-03 3 1  ON 34
ci_0036                 4.736310e-03 3 1  ON 35
ci_0037                -1.141479e-02 3 1  ON 36
ci_0038                -1.130892e-02 3 1  ON 37
ci_0039                -3.818965e-03 3 1  ON 38
ci_0040                -3.937348e-03 3 1  ON 39
ci_0041                 9.548250e-03 3 1  ON 40
ci_0042                 9.452797e-03 3 1  ON 41
ci_0043                -7.824641e-03 3 1  ON 42
ci_0044                -8.289318e-03 3 1  ON 43
ci_0045                 1.041871e-02 3 1  ON 44
ci_0046                 9.668363e-03 3 1  ON 45
ci_0047                -3.596445e-03 3 1  ON 46
ci_0048                -3.619945e-03 3 1  ON 47
ci_0049                -2.504047e-03 3 1  ON 48
ci_0050                -2.580781e-03 3 1  ON 49
ci_0051                -1.839991e-03 3 1  ON 50
ci_0052                -1.721992e-03 3 1  ON 51
ci_0053                -3.848113e-03 3 1  ON 52
ci_0054                -3.733588e-03 3 1  ON 53
ci_0055                 2.333006e-03 3 1  ON 54
ci_0056                 2.077546e-03 3 1  ON 55
ci_0057                 2.308718e-03 3 1  ON 56
ci_0058                 2.889544e-03 3 1  ON 57
ci_0059                -3.898243e-03 3 1  ON 58
ci_0060                -3.666666e-03 3 1  ON 59
ci_0061                -3.118019e-03 3 1  ON 60
ci_0062                -3.327844e-03 3 1  ON 61
ci_0063                -9.706269e-03 3 1  ON 62
ci_0064                -9.658701e-03 3 1  ON 63
ci_0065                -6.915754e-03 3 1  ON 64
ci_0066                -6.462099e-03 3 1  ON 65
ci_0067                -3.904048e-03 3 1  ON 66
ci_0068                -3.847027e-03 3 1  ON 67
ci_0069                 3.717442e-03 3 1  ON 68
ci_0070                 3.463385e-03 3 1  ON 69
ci_0071                 4.076439e-03 3 1  ON 70
ci_0072                 4.247370e-03 3 1  ON 71
ci_0073                 3.370156e-03 3 1  ON 72
ci_0074                 3.331593e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8654
    reference variance = 0.184967
====================================================
  Execution time = 1.4265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9665e-01
  Total weights = 1.9506e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283930451918
                                         uncertainty =       0.001607878429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283930451918
                                         uncertainty =       0.001607878429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376778997
  error estimate for blocks of size 2^( 2) =       0.000393934449
  error estimate for blocks of size 2^( 3) =       0.000411596931
  error estimate for blocks of size 2^( 4) =       0.000427412873
  error estimate for blocks of size 2^( 5) =       0.000438765726
  error estimate for blocks of size 2^( 6) =       0.000445792580
  error estimate for blocks of size 2^( 7) =       0.000447947053

      target function =      -0.917967624842
              le_mean =     -16.897933415251
             les_mean =     285.836808489304
             stat err =       0.000439979558
             autocorr =       1.363614547998
   target nu stat err =       0.000439979558
   target dn stat err =       0.003692901272
      target stat err =       0.005769503528
              std dev =       0.532845968044
             le_variance =       0.283924825660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283925522252
                                         uncertainty =       0.001607742629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283925522252
                                         uncertainty =       0.001607742629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376775732
  error estimate for blocks of size 2^( 2) =       0.000393930730
  error estimate for blocks of size 2^( 3) =       0.000411592551
  error estimate for blocks of size 2^( 4) =       0.000427407770
  error estimate for blocks of size 2^( 5) =       0.000438759896
  error estimate for blocks of size 2^( 6) =       0.000445786362
  error estimate for blocks of size 2^( 7) =       0.000447940660

      target function =      -0.918025640827
              le_mean =     -16.897933438401
             les_mean =     285.836772097526
             stat err =       0.000439973672
             autocorr =       1.363601701245
   target nu stat err =       0.000439973672
   target dn stat err =       0.003670991599
      target stat err =       0.005736557583
              std dev =       0.532841349734
             le_variance =       0.283919903987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283927979519
                                         uncertainty =       0.001607810357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283927979519
                                         uncertainty =       0.001607810357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376777360
  error estimate for blocks of size 2^( 2) =       0.000393932584
  error estimate for blocks of size 2^( 3) =       0.000411594735
  error estimate for blocks of size 2^( 4) =       0.000427410315
  error estimate for blocks of size 2^( 5) =       0.000438762804
  error estimate for blocks of size 2^( 6) =       0.000445789464
  error estimate for blocks of size 2^( 7) =       0.000447943849

      target function =      -0.917997148835
              le_mean =     -16.897933426376
             les_mean =     285.836789945658
             stat err =       0.000439976608
             autocorr =       1.363608117239
   target nu stat err =       0.000439976608
   target dn stat err =       0.003681874383
      target stat err =       0.005752926895
              std dev =       0.532843651801
             le_variance =       0.283922357265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283930142376
                                         uncertainty =       0.001607869911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283930142376
                                         uncertainty =       0.001607869911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376778792
  error estimate for blocks of size 2^( 2) =       0.000393934216
  error estimate for blocks of size 2^( 3) =       0.000411596656
  error estimate for blocks of size 2^( 4) =       0.000427412553
  error estimate for blocks of size 2^( 5) =       0.000438765360
  error estimate for blocks of size 2^( 6) =       0.000445792190
  error estimate for blocks of size 2^( 7) =       0.000447946652

      target function =      -0.917971361050
              le_mean =     -16.897933416589
             les_mean =     285.836806140087
             stat err =       0.000439979189
             autocorr =       1.363613744111
   target nu stat err =       0.000439979189
   target dn stat err =       0.003691516555
      target stat err =       0.005767422325
              std dev =       0.532845678053
             le_variance =       0.283924516619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917967624842        initial
     2.2737e+01     2.2737e+02             1.7810e-05        -0.918025640827  <--
     9.0949e+01     9.0949e+02             4.4589e-06        -0.917997148835
     3.6380e+02     3.6380e+03             1.1151e-06        -0.917971361050

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 2.3799e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.031182e-01 3 1  ON 0
ci_0002                 6.979619e-01 3 1  ON 1
ci_0003                -3.153117e-02 3 1  ON 2
ci_0004                -3.136151e-02 3 1  ON 3
ci_0005                -2.892596e-02 3 1  ON 4
ci_0006                -2.997044e-02 3 1  ON 5
ci_0007                -1.586460e-02 3 1  ON 6
ci_0008                -1.648421e-02 3 1  ON 7
ci_0009                -1.872245e-02 3 1  ON 8
ci_0010                -1.887514e-02 3 1  ON 9
ci_0011                -1.550111e-02 3 1  ON 10
ci_0012                -1.562563e-02 3 1  ON 11
ci_0013                 1.548765e-02 3 1  ON 12
ci_0014                 1.537231e-02 3 1  ON 13
ci_0015                 1.628959e-02 3 1  ON 14
ci_0016                 1.594936e-02 3 1  ON 15
ci_0017                 1.373542e-02 3 1  ON 16
ci_0018                 1.392452e-02 3 1  ON 17
ci_0019                 1.259651e-02 3 1  ON 18
ci_0020                 1.224596e-02 3 1  ON 19
ci_0021                 1.348165e-02 3 1  ON 20
ci_0022                 1.495441e-02 3 1  ON 21
ci_0023                -1.182507e-02 3 1  ON 22
ci_0024                -1.113553e-02 3 1  ON 23
ci_0025                -2.811470e-03 3 1  ON 24
ci_0026                -2.387338e-03 3 1  ON 25
ci_0027                -1.179590e-02 3 1  ON 26
ci_0028                -1.174826e-02 3 1  ON 27
ci_0029                -1.044437e-02 3 1  ON 28
ci_0030                -1.036815e-02 3 1  ON 29
ci_0031                 1.383293e-02 3 1  ON 30
ci_0032                 1.290493e-02 3 1  ON 31
ci_0033                 8.253120e-03 3 1  ON 32
ci_0034                 8.528656e-03 3 1  ON 33
ci_0035                 4.889163e-03 3 1  ON 34
ci_0036                 4.734350e-03 3 1  ON 35
ci_0037                -1.141394e-02 3 1  ON 36
ci_0038                -1.130807e-02 3 1  ON 37
ci_0039                -3.819699e-03 3 1  ON 38
ci_0040                -3.936005e-03 3 1  ON 39
ci_0041                 9.546801e-03 3 1  ON 40
ci_0042                 9.451711e-03 3 1  ON 41
ci_0043                -7.837908e-03 3 1  ON 42
ci_0044                -8.299295e-03 3 1  ON 43
ci_0045                 1.041827e-02 3 1  ON 44
ci_0046                 9.671154e-03 3 1  ON 45
ci_0047                -3.595941e-03 3 1  ON 46
ci_0048                -3.619948e-03 3 1  ON 47
ci_0049                -2.504471e-03 3 1  ON 48
ci_0050                -2.584641e-03 3 1  ON 49
ci_0051                -1.841571e-03 3 1  ON 50
ci_0052                -1.722054e-03 3 1  ON 51
ci_0053                -3.847588e-03 3 1  ON 52
ci_0054                -3.733417e-03 3 1  ON 53
ci_0055                 2.330257e-03 3 1  ON 54
ci_0056                 2.077467e-03 3 1  ON 55
ci_0057                 2.309036e-03 3 1  ON 56
ci_0058                 2.888813e-03 3 1  ON 57
ci_0059                -3.897794e-03 3 1  ON 58
ci_0060                -3.664480e-03 3 1  ON 59
ci_0061                -3.121234e-03 3 1  ON 60
ci_0062                -3.329768e-03 3 1  ON 61
ci_0063                -9.706482e-03 3 1  ON 62
ci_0064                -9.658168e-03 3 1  ON 63
ci_0065                -6.914498e-03 3 1  ON 64
ci_0066                -6.461806e-03 3 1  ON 65
ci_0067                -3.901987e-03 3 1  ON 66
ci_0068                -3.844615e-03 3 1  ON 67
ci_0069                 3.717308e-03 3 1  ON 68
ci_0070                 3.463779e-03 3 1  ON 69
ci_0071                 4.073800e-03 3 1  ON 70
ci_0072                 4.245464e-03 3 1  ON 71
ci_0073                 3.371594e-03 3 1  ON 72
ci_0074                 3.327362e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1015e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8601
    reference variance = 0.163833
====================================================
  Execution time = 1.4607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9629e-01
  Total weights = 1.950715663e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281690061200
                                         uncertainty =       0.002516026157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281690061200
                                         uncertainty =       0.002516026157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375286237
  error estimate for blocks of size 2^( 2) =       0.000392431431
  error estimate for blocks of size 2^( 3) =       0.000410239666
  error estimate for blocks of size 2^( 4) =       0.000425857552
  error estimate for blocks of size 2^( 5) =       0.000437110570
  error estimate for blocks of size 2^( 6) =       0.000443389790
  error estimate for blocks of size 2^( 7) =       0.000448136475

      target function =      -0.918493074148
              le_mean =     -16.898260774976
             les_mean =     285.847509239857
             stat err =       0.000438623597
             autocorr =       1.366025190336
   target nu stat err =       0.000438623597
   target dn stat err =       0.005254459864
      target stat err =       0.008189046855
              std dev =       0.530734886330
             le_variance =       0.281679519568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689826077498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918564407199       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918595318361       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918599821085       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918601649310       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918602580625       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918602922216       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918603072941       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918603161658       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918603192840       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918603263360       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918603283997       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918603315110       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918603316502       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918603317692       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918603310413       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918603300995       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918603300642       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918603301198       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918603301395       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 6.698902e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918564407199       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918572214661       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918573349728       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918573808702       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918574041739       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918574127024       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918574164645       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918574186729       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918574194489       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918574212163       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918574217225       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918574224923       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918574225211       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918574225407       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918574223611       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918574221292       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918574221212       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918574221351       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918574221399       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.684160e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918564407199       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918566364108       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918566648467       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918566763331       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918566821602       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918566842916       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918566852317       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918566857832       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918566859770       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918566864191       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918566865451       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918566867370       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918566867438       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918566867481       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918566867034       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918566866456       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918566866437       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918566866471       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918566866483       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 4.216339e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.864689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7179e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.031091e-01 3 1  ON 0
ci_0002                 6.979721e-01 3 1  ON 1
ci_0003                -3.152430e-02 3 1  ON 2
ci_0004                -3.135918e-02 3 1  ON 3
ci_0005                -2.892594e-02 3 1  ON 4
ci_0006                -2.997572e-02 3 1  ON 5
ci_0007                -1.585882e-02 3 1  ON 6
ci_0008                -1.647751e-02 3 1  ON 7
ci_0009                -1.871774e-02 3 1  ON 8
ci_0010                -1.887434e-02 3 1  ON 9
ci_0011                -1.550171e-02 3 1  ON 10
ci_0012                -1.562393e-02 3 1  ON 11
ci_0013                 1.548240e-02 3 1  ON 12
ci_0014                 1.537022e-02 3 1  ON 13
ci_0015                 1.628862e-02 3 1  ON 14
ci_0016                 1.594272e-02 3 1  ON 15
ci_0017                 1.372896e-02 3 1  ON 16
ci_0018                 1.392550e-02 3 1  ON 17
ci_0019                 1.259833e-02 3 1  ON 18
ci_0020                 1.224528e-02 3 1  ON 19
ci_0021                 1.347335e-02 3 1  ON 20
ci_0022                 1.493842e-02 3 1  ON 21
ci_0023                -1.182479e-02 3 1  ON 22
ci_0024                -1.113905e-02 3 1  ON 23
ci_0025                -2.811439e-03 3 1  ON 24
ci_0026                -2.389627e-03 3 1  ON 25
ci_0027                -1.180173e-02 3 1  ON 26
ci_0028                -1.175013e-02 3 1  ON 27
ci_0029                -1.044844e-02 3 1  ON 28
ci_0030                -1.036974e-02 3 1  ON 29
ci_0031                 1.383029e-02 3 1  ON 30
ci_0032                 1.290313e-02 3 1  ON 31
ci_0033                 8.257847e-03 3 1  ON 32
ci_0034                 8.537880e-03 3 1  ON 33
ci_0035                 4.888792e-03 3 1  ON 34
ci_0036                 4.748027e-03 3 1  ON 35
ci_0037                -1.141337e-02 3 1  ON 36
ci_0038                -1.130638e-02 3 1  ON 37
ci_0039                -3.821471e-03 3 1  ON 38
ci_0040                -3.936776e-03 3 1  ON 39
ci_0041                 9.546411e-03 3 1  ON 40
ci_0042                 9.452579e-03 3 1  ON 41
ci_0043                -7.854750e-03 3 1  ON 42
ci_0044                -8.315619e-03 3 1  ON 43
ci_0045                 1.041573e-02 3 1  ON 44
ci_0046                 9.669247e-03 3 1  ON 45
ci_0047                -3.597019e-03 3 1  ON 46
ci_0048                -3.618508e-03 3 1  ON 47
ci_0049                -2.510377e-03 3 1  ON 48
ci_0050                -2.584239e-03 3 1  ON 49
ci_0051                -1.841847e-03 3 1  ON 50
ci_0052                -1.718963e-03 3 1  ON 51
ci_0053                -3.847998e-03 3 1  ON 52
ci_0054                -3.727923e-03 3 1  ON 53
ci_0055                 2.342640e-03 3 1  ON 54
ci_0056                 2.077861e-03 3 1  ON 55
ci_0057                 2.310231e-03 3 1  ON 56
ci_0058                 2.889578e-03 3 1  ON 57
ci_0059                -3.900055e-03 3 1  ON 58
ci_0060                -3.664808e-03 3 1  ON 59
ci_0061                -3.121151e-03 3 1  ON 60
ci_0062                -3.332837e-03 3 1  ON 61
ci_0063                -9.708385e-03 3 1  ON 62
ci_0064                -9.659303e-03 3 1  ON 63
ci_0065                -6.911624e-03 3 1  ON 64
ci_0066                -6.461715e-03 3 1  ON 65
ci_0067                -3.901054e-03 3 1  ON 66
ci_0068                -3.843825e-03 3 1  ON 67
ci_0069                 3.711180e-03 3 1  ON 68
ci_0070                 3.459670e-03 3 1  ON 69
ci_0071                 4.073435e-03 3 1  ON 70
ci_0072                 4.232910e-03 3 1  ON 71
ci_0073                 3.360461e-03 3 1  ON 72
ci_0074                 3.328778e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8122
    reference variance = 0.175863
====================================================
  Execution time = 1.4282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8984e-01
  Total weights = 1.9509e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281329372250
                                         uncertainty =       0.001306802951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281329372250
                                         uncertainty =       0.001306802951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375056101
  error estimate for blocks of size 2^( 2) =       0.000392187026
  error estimate for blocks of size 2^( 3) =       0.000409700654
  error estimate for blocks of size 2^( 4) =       0.000425411807
  error estimate for blocks of size 2^( 5) =       0.000437596470
  error estimate for blocks of size 2^( 6) =       0.000445815916
  error estimate for blocks of size 2^( 7) =       0.000451698481

      target function =      -0.928677586789
              le_mean =     -16.897993270897
             les_mean =     285.832015617312
             stat err =       0.000440130668
             autocorr =       1.377116853244
   target nu stat err =       0.000440130668
   target dn stat err =       0.001924045061
      target stat err =       0.003142391669
              std dev =       0.530409424781
             le_variance =       0.281334157896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281309213352
                                         uncertainty =       0.001306654600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281309213352
                                         uncertainty =       0.001306654600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375042674
  error estimate for blocks of size 2^( 2) =       0.000392171953
  error estimate for blocks of size 2^( 3) =       0.000409682772
  error estimate for blocks of size 2^( 4) =       0.000425390692
  error estimate for blocks of size 2^( 5) =       0.000437572517
  error estimate for blocks of size 2^( 6) =       0.000445791358
  error estimate for blocks of size 2^( 7) =       0.000451675297

      target function =      -0.928675865318
              le_mean =     -16.897993082577
             les_mean =     285.832010337800
             stat err =       0.000440107466
             autocorr =       1.377070263047
   target nu stat err =       0.000440107466
   target dn stat err =       0.001923900838
      target stat err =       0.003142147708
              std dev =       0.530390435452
             le_variance =       0.281314014019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281319116015
                                         uncertainty =       0.001306724992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281319116015
                                         uncertainty =       0.001306724992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375049270
  error estimate for blocks of size 2^( 2) =       0.000392179365
  error estimate for blocks of size 2^( 3) =       0.000409691577
  error estimate for blocks of size 2^( 4) =       0.000425401101
  error estimate for blocks of size 2^( 5) =       0.000437584335
  error estimate for blocks of size 2^( 6) =       0.000445803474
  error estimate for blocks of size 2^( 7) =       0.000451686738

      target function =      -0.928685286286
              le_mean =     -16.897993161971
             les_mean =     285.832007080650
             stat err =       0.000440118912
             autocorr =       1.377093452386
   target nu stat err =       0.000440118912
   target dn stat err =       0.001923919906
      target stat err =       0.003142244133
              std dev =       0.530399763637
             le_variance =       0.281323909266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281328076113
                                         uncertainty =       0.001306792889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281328076113
                                         uncertainty =       0.001306792889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375055238
  error estimate for blocks of size 2^( 2) =       0.000392186058
  error estimate for blocks of size 2^( 3) =       0.000409699509
  error estimate for blocks of size 2^( 4) =       0.000425410458
  error estimate for blocks of size 2^( 5) =       0.000437594942
  error estimate for blocks of size 2^( 6) =       0.000445814349
  error estimate for blocks of size 2^( 7) =       0.000451697002

      target function =      -0.928679819817
              le_mean =     -16.897993255602
             les_mean =     285.832013692251
             stat err =       0.000440129188
             autocorr =       1.377113928353
   target nu stat err =       0.000440129188
   target dn stat err =       0.001924024628
      target stat err =       0.003142374193
              std dev =       0.530408203855
             le_variance =       0.281332862717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928677586789        initial
     5.6843e+00     5.6843e+01             6.6989e-05        -0.928675865318
     2.2737e+01     2.2737e+02             1.6842e-05        -0.928685286286  <--
     9.0949e+01     9.0949e+02             4.2163e-06        -0.928679819817

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 2.3699e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.031091e-01 3 1  ON 0
ci_0002                 6.979721e-01 3 1  ON 1
ci_0003                -3.152430e-02 3 1  ON 2
ci_0004                -3.135918e-02 3 1  ON 3
ci_0005                -2.892594e-02 3 1  ON 4
ci_0006                -2.997572e-02 3 1  ON 5
ci_0007                -1.585882e-02 3 1  ON 6
ci_0008                -1.647751e-02 3 1  ON 7
ci_0009                -1.871774e-02 3 1  ON 8
ci_0010                -1.887434e-02 3 1  ON 9
ci_0011                -1.550171e-02 3 1  ON 10
ci_0012                -1.562393e-02 3 1  ON 11
ci_0013                 1.548240e-02 3 1  ON 12
ci_0014                 1.537022e-02 3 1  ON 13
ci_0015                 1.628862e-02 3 1  ON 14
ci_0016                 1.594272e-02 3 1  ON 15
ci_0017                 1.372896e-02 3 1  ON 16
ci_0018                 1.392550e-02 3 1  ON 17
ci_0019                 1.259833e-02 3 1  ON 18
ci_0020                 1.224528e-02 3 1  ON 19
ci_0021                 1.347335e-02 3 1  ON 20
ci_0022                 1.493842e-02 3 1  ON 21
ci_0023                -1.182479e-02 3 1  ON 22
ci_0024                -1.113905e-02 3 1  ON 23
ci_0025                -2.811439e-03 3 1  ON 24
ci_0026                -2.389627e-03 3 1  ON 25
ci_0027                -1.180173e-02 3 1  ON 26
ci_0028                -1.175013e-02 3 1  ON 27
ci_0029                -1.044844e-02 3 1  ON 28
ci_0030                -1.036974e-02 3 1  ON 29
ci_0031                 1.383029e-02 3 1  ON 30
ci_0032                 1.290313e-02 3 1  ON 31
ci_0033                 8.257847e-03 3 1  ON 32
ci_0034                 8.537880e-03 3 1  ON 33
ci_0035                 4.888792e-03 3 1  ON 34
ci_0036                 4.748027e-03 3 1  ON 35
ci_0037                -1.141337e-02 3 1  ON 36
ci_0038                -1.130638e-02 3 1  ON 37
ci_0039                -3.821471e-03 3 1  ON 38
ci_0040                -3.936776e-03 3 1  ON 39
ci_0041                 9.546411e-03 3 1  ON 40
ci_0042                 9.452579e-03 3 1  ON 41
ci_0043                -7.854750e-03 3 1  ON 42
ci_0044                -8.315619e-03 3 1  ON 43
ci_0045                 1.041573e-02 3 1  ON 44
ci_0046                 9.669247e-03 3 1  ON 45
ci_0047                -3.597019e-03 3 1  ON 46
ci_0048                -3.618508e-03 3 1  ON 47
ci_0049                -2.510377e-03 3 1  ON 48
ci_0050                -2.584239e-03 3 1  ON 49
ci_0051                -1.841847e-03 3 1  ON 50
ci_0052                -1.718963e-03 3 1  ON 51
ci_0053                -3.847998e-03 3 1  ON 52
ci_0054                -3.727923e-03 3 1  ON 53
ci_0055                 2.342640e-03 3 1  ON 54
ci_0056                 2.077861e-03 3 1  ON 55
ci_0057                 2.310231e-03 3 1  ON 56
ci_0058                 2.889578e-03 3 1  ON 57
ci_0059                -3.900055e-03 3 1  ON 58
ci_0060                -3.664808e-03 3 1  ON 59
ci_0061                -3.121151e-03 3 1  ON 60
ci_0062                -3.332837e-03 3 1  ON 61
ci_0063                -9.708385e-03 3 1  ON 62
ci_0064                -9.659303e-03 3 1  ON 63
ci_0065                -6.911624e-03 3 1  ON 64
ci_0066                -6.461715e-03 3 1  ON 65
ci_0067                -3.901054e-03 3 1  ON 66
ci_0068                -3.843825e-03 3 1  ON 67
ci_0069                 3.711180e-03 3 1  ON 68
ci_0070                 3.459670e-03 3 1  ON 69
ci_0071                 4.073435e-03 3 1  ON 70
ci_0072                 4.232910e-03 3 1  ON 71
ci_0073                 3.360461e-03 3 1  ON 72
ci_0074                 3.328778e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.7939
    reference variance = 0.226372
====================================================
  Execution time = 1.4562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9130e-01
  Total weights = 1.951040651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281778782472
                                         uncertainty =       0.001766639213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281778782472
                                         uncertainty =       0.001766639213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375375310
  error estimate for blocks of size 2^( 2) =       0.000392861891
  error estimate for blocks of size 2^( 3) =       0.000411134834
  error estimate for blocks of size 2^( 4) =       0.000428942220
  error estimate for blocks of size 2^( 5) =       0.000441293212
  error estimate for blocks of size 2^( 6) =       0.000450019012
  error estimate for blocks of size 2^( 7) =       0.000455296183

      target function =      -0.926360110671
              le_mean =     -16.897512319494
             les_mean =     285.817217725774
             stat err =       0.000443887657
             autocorr =       1.398346271238
   target nu stat err =       0.000443887657
   target dn stat err =       0.002550734151
      target stat err =       0.004091661897
              std dev =       0.530860854981
             le_variance =       0.281813247351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689751231949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926376744376       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926386408509       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926389707191       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926391667918       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926392523054       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926392768366       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926392789250       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926392859376       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926392864168       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926392869997       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926392868244       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926392871895       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926392881070       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926392884206       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926392887858       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926392891753       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926392891450       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926392891241       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 8.777681e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926376744376       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926379185397       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926380016931       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926380508943       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926380722795       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926380784001       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926380789052       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926380806529       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926380807704       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926380809147       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926380808703       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926380809627       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926380811928       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926380812695       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926380813593       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926380814539       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926380814462       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926380814412       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 2.206557e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926376744376       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926377356213       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926377564530       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926377687648       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926377741114       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926377756408       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926377757660       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926377762025       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926377762318       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926377762677       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926377762566       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926377762798       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926377763374       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926377763564       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926377763788       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926377764023       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926377764003       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926377763991       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 5.524031e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.874998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9631e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.031054e-01 3 1  ON 0
ci_0002                 6.979772e-01 3 1  ON 1
ci_0003                -3.151819e-02 3 1  ON 2
ci_0004                -3.135626e-02 3 1  ON 3
ci_0005                -2.892972e-02 3 1  ON 4
ci_0006                -2.997832e-02 3 1  ON 5
ci_0007                -1.585041e-02 3 1  ON 6
ci_0008                -1.647094e-02 3 1  ON 7
ci_0009                -1.871770e-02 3 1  ON 8
ci_0010                -1.887133e-02 3 1  ON 9
ci_0011                -1.549915e-02 3 1  ON 10
ci_0012                -1.562206e-02 3 1  ON 11
ci_0013                 1.548029e-02 3 1  ON 12
ci_0014                 1.537081e-02 3 1  ON 13
ci_0015                 1.628270e-02 3 1  ON 14
ci_0016                 1.594283e-02 3 1  ON 15
ci_0017                 1.372736e-02 3 1  ON 16
ci_0018                 1.392431e-02 3 1  ON 17
ci_0019                 1.260030e-02 3 1  ON 18
ci_0020                 1.224719e-02 3 1  ON 19
ci_0021                 1.345129e-02 3 1  ON 20
ci_0022                 1.492112e-02 3 1  ON 21
ci_0023                -1.182596e-02 3 1  ON 22
ci_0024                -1.113882e-02 3 1  ON 23
ci_0025                -2.808957e-03 3 1  ON 24
ci_0026                -2.388470e-03 3 1  ON 25
ci_0027                -1.180326e-02 3 1  ON 26
ci_0028                -1.174799e-02 3 1  ON 27
ci_0029                -1.044951e-02 3 1  ON 28
ci_0030                -1.036803e-02 3 1  ON 29
ci_0031                 1.382788e-02 3 1  ON 30
ci_0032                 1.289960e-02 3 1  ON 31
ci_0033                 8.262308e-03 3 1  ON 32
ci_0034                 8.540571e-03 3 1  ON 33
ci_0035                 4.888913e-03 3 1  ON 34
ci_0036                 4.750237e-03 3 1  ON 35
ci_0037                -1.141287e-02 3 1  ON 36
ci_0038                -1.130578e-02 3 1  ON 37
ci_0039                -3.822229e-03 3 1  ON 38
ci_0040                -3.935935e-03 3 1  ON 39
ci_0041                 9.548200e-03 3 1  ON 40
ci_0042                 9.452377e-03 3 1  ON 41
ci_0043                -7.866135e-03 3 1  ON 42
ci_0044                -8.329916e-03 3 1  ON 43
ci_0045                 1.041922e-02 3 1  ON 44
ci_0046                 9.671167e-03 3 1  ON 45
ci_0047                -3.596987e-03 3 1  ON 46
ci_0048                -3.618433e-03 3 1  ON 47
ci_0049                -2.499532e-03 3 1  ON 48
ci_0050                -2.584679e-03 3 1  ON 49
ci_0051                -1.839610e-03 3 1  ON 50
ci_0052                -1.721525e-03 3 1  ON 51
ci_0053                -3.848677e-03 3 1  ON 52
ci_0054                -3.727865e-03 3 1  ON 53
ci_0055                 2.347454e-03 3 1  ON 54
ci_0056                 2.077821e-03 3 1  ON 55
ci_0057                 2.314105e-03 3 1  ON 56
ci_0058                 2.883878e-03 3 1  ON 57
ci_0059                -3.899952e-03 3 1  ON 58
ci_0060                -3.665250e-03 3 1  ON 59
ci_0061                -3.122459e-03 3 1  ON 60
ci_0062                -3.334489e-03 3 1  ON 61
ci_0063                -9.708334e-03 3 1  ON 62
ci_0064                -9.657165e-03 3 1  ON 63
ci_0065                -6.908323e-03 3 1  ON 64
ci_0066                -6.460971e-03 3 1  ON 65
ci_0067                -3.900928e-03 3 1  ON 66
ci_0068                -3.842145e-03 3 1  ON 67
ci_0069                 3.710507e-03 3 1  ON 68
ci_0070                 3.455427e-03 3 1  ON 69
ci_0071                 4.069403e-03 3 1  ON 70
ci_0072                 4.231115e-03 3 1  ON 71
ci_0073                 3.360471e-03 3 1  ON 72
ci_0074                 3.330707e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.211866
====================================================
  Execution time = 1.4270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9102e-01
  Total weights = 1.9509e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283229910820
                                         uncertainty =       0.002504803528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283229910820
                                         uncertainty =       0.002504803528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376346020
  error estimate for blocks of size 2^( 2) =       0.000393690185
  error estimate for blocks of size 2^( 3) =       0.000411944360
  error estimate for blocks of size 2^( 4) =       0.000427816826
  error estimate for blocks of size 2^( 5) =       0.000440351688
  error estimate for blocks of size 2^( 6) =       0.000449593214
  error estimate for blocks of size 2^( 7) =       0.000453959288

      target function =      -0.926791217756
              le_mean =     -16.897529762106
             les_mean =     285.817535089249
             stat err =       0.000442930254
             autocorr =       1.385147544075
   target nu stat err =       0.000442930254
   target dn stat err =       0.002415126233
      target stat err =       0.003885093585
              std dev =       0.532233645231
             le_variance =       0.283272653116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283213189604
                                         uncertainty =       0.002502201194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283213189604
                                         uncertainty =       0.002502201194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376335079
  error estimate for blocks of size 2^( 2) =       0.000393677748
  error estimate for blocks of size 2^( 3) =       0.000411930075
  error estimate for blocks of size 2^( 4) =       0.000427800200
  error estimate for blocks of size 2^( 5) =       0.000440332836
  error estimate for blocks of size 2^( 6) =       0.000449571325
  error estimate for blocks of size 2^( 7) =       0.000453937987

      target function =      -0.926576956183
              le_mean =     -16.897529678271
             les_mean =     285.817668048210
             stat err =       0.000442910587
             autocorr =       1.385105074469
   target nu stat err =       0.000442910587
   target dn stat err =       0.002417505117
      target stat err =       0.003887005197
              std dev =       0.532218172276
             le_variance =       0.283256182901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283221431985
                                         uncertainty =       0.002503485472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283221431985
                                         uncertainty =       0.002503485472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376340471
  error estimate for blocks of size 2^( 2) =       0.000393683883
  error estimate for blocks of size 2^( 3) =       0.000411937110
  error estimate for blocks of size 2^( 4) =       0.000427808402
  error estimate for blocks of size 2^( 5) =       0.000440342124
  error estimate for blocks of size 2^( 6) =       0.000449582135
  error estimate for blocks of size 2^( 7) =       0.000453948473

      target function =      -0.926783479520
              le_mean =     -16.897529722605
             les_mean =     285.817538672995
             stat err =       0.000442920284
             autocorr =       1.385126027010
   target nu stat err =       0.000442920284
   target dn stat err =       0.002413312100
      target stat err =       0.003882218003
              std dev =       0.532225798434
             le_variance =       0.283264300519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283228842702
                                         uncertainty =       0.002504637985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283228842702
                                         uncertainty =       0.002504637985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376345321
  error estimate for blocks of size 2^( 2) =       0.000393689392
  error estimate for blocks of size 2^( 3) =       0.000411943448
  error estimate for blocks of size 2^( 4) =       0.000427815767
  error estimate for blocks of size 2^( 5) =       0.000440350487
  error estimate for blocks of size 2^( 6) =       0.000449591822
  error estimate for blocks of size 2^( 7) =       0.000453957931

      target function =      -0.926793919729
              le_mean =     -16.897529755690
             les_mean =     285.817533162183
             stat err =       0.000442929002
             autocorr =       1.385144857060
   target nu stat err =       0.000442929002
   target dn stat err =       0.002414877390
      target stat err =       0.003884730121
              std dev =       0.532232656634
             le_variance =       0.283271600788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926791217756        initial
     5.6843e+00     5.6843e+01             8.7777e-05        -0.926576956183
     2.2737e+01     2.2737e+02             2.2066e-05        -0.926783479520
     9.0949e+01     9.0949e+02             5.5240e-06        -0.926793919729  <--

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.3810e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.031082e-01 3 1  ON 0
ci_0002                 6.979734e-01 3 1  ON 1
ci_0003                -3.152277e-02 3 1  ON 2
ci_0004                -3.135845e-02 3 1  ON 3
ci_0005                -2.892689e-02 3 1  ON 4
ci_0006                -2.997637e-02 3 1  ON 5
ci_0007                -1.585672e-02 3 1  ON 6
ci_0008                -1.647587e-02 3 1  ON 7
ci_0009                -1.871773e-02 3 1  ON 8
ci_0010                -1.887359e-02 3 1  ON 9
ci_0011                -1.550107e-02 3 1  ON 10
ci_0012                -1.562346e-02 3 1  ON 11
ci_0013                 1.548188e-02 3 1  ON 12
ci_0014                 1.537037e-02 3 1  ON 13
ci_0015                 1.628714e-02 3 1  ON 14
ci_0016                 1.594275e-02 3 1  ON 15
ci_0017                 1.372856e-02 3 1  ON 16
ci_0018                 1.392520e-02 3 1  ON 17
ci_0019                 1.259883e-02 3 1  ON 18
ci_0020                 1.224576e-02 3 1  ON 19
ci_0021                 1.346783e-02 3 1  ON 20
ci_0022                 1.493409e-02 3 1  ON 21
ci_0023                -1.182508e-02 3 1  ON 22
ci_0024                -1.113899e-02 3 1  ON 23
ci_0025                -2.810817e-03 3 1  ON 24
ci_0026                -2.389337e-03 3 1  ON 25
ci_0027                -1.180211e-02 3 1  ON 26
ci_0028                -1.174959e-02 3 1  ON 27
ci_0029                -1.044871e-02 3 1  ON 28
ci_0030                -1.036931e-02 3 1  ON 29
ci_0031                 1.382969e-02 3 1  ON 30
ci_0032                 1.290225e-02 3 1  ON 31
ci_0033                 8.258964e-03 3 1  ON 32
ci_0034                 8.538554e-03 3 1  ON 33
ci_0035                 4.888822e-03 3 1  ON 34
ci_0036                 4.748581e-03 3 1  ON 35
ci_0037                -1.141324e-02 3 1  ON 36
ci_0038                -1.130623e-02 3 1  ON 37
ci_0039                -3.821661e-03 3 1  ON 38
ci_0040                -3.936565e-03 3 1  ON 39
ci_0041                 9.546859e-03 3 1  ON 40
ci_0042                 9.452528e-03 3 1  ON 41
ci_0043                -7.857601e-03 3 1  ON 42
ci_0044                -8.319198e-03 3 1  ON 43
ci_0045                 1.041661e-02 3 1  ON 44
ci_0046                 9.669728e-03 3 1  ON 45
ci_0047                -3.597011e-03 3 1  ON 46
ci_0048                -3.618489e-03 3 1  ON 47
ci_0049                -2.507659e-03 3 1  ON 48
ci_0050                -2.584350e-03 3 1  ON 49
ci_0051                -1.841286e-03 3 1  ON 50
ci_0052                -1.719605e-03 3 1  ON 51
ci_0053                -3.848169e-03 3 1  ON 52
ci_0054                -3.727908e-03 3 1  ON 53
ci_0055                 2.343847e-03 3 1  ON 54
ci_0056                 2.077851e-03 3 1  ON 55
ci_0057                 2.311202e-03 3 1  ON 56
ci_0058                 2.888150e-03 3 1  ON 57
ci_0059                -3.900029e-03 3 1  ON 58
ci_0060                -3.664919e-03 3 1  ON 59
ci_0061                -3.121479e-03 3 1  ON 60
ci_0062                -3.333251e-03 3 1  ON 61
ci_0063                -9.708372e-03 3 1  ON 62
ci_0064                -9.658767e-03 3 1  ON 63
ci_0065                -6.910797e-03 3 1  ON 64
ci_0066                -6.461529e-03 3 1  ON 65
ci_0067                -3.901022e-03 3 1  ON 66
ci_0068                -3.843404e-03 3 1  ON 67
ci_0069                 3.711011e-03 3 1  ON 68
ci_0070                 3.458606e-03 3 1  ON 69
ci_0071                 4.072424e-03 3 1  ON 70
ci_0072                 4.232460e-03 3 1  ON 71
ci_0073                 3.360463e-03 3 1  ON 72
ci_0074                 3.329261e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8836
    reference variance = 0.166888
====================================================
  Execution time = 1.4522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9302e-01
  Total weights = 1.950928751e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281934923207
                                         uncertainty =       0.001768785630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281934923207
                                         uncertainty =       0.001768785630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375418510
  error estimate for blocks of size 2^( 2) =       0.000392523181
  error estimate for blocks of size 2^( 3) =       0.000409920795
  error estimate for blocks of size 2^( 4) =       0.000425447196
  error estimate for blocks of size 2^( 5) =       0.000437720514
  error estimate for blocks of size 2^( 6) =       0.000443780176
  error estimate for blocks of size 2^( 7) =       0.000446777675

      target function =      -0.923652064178
              le_mean =     -16.898443960928
             les_mean =     285.850432154858
             stat err =       0.000438431390
             autocorr =       1.363866678065
   target nu stat err =       0.000438431390
   target dn stat err =       0.002410928604
      target stat err =       0.003857857900
              std dev =       0.530921947742
             le_variance =       0.281878114594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689844396093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923666740321       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923668596939       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923669290674       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923669543039       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923669654382       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923669705432       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923669705498       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923669711700       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923669712671       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923669712407       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923669711296       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923669717580       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923669722348       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923669725017       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923669724504       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923669724319       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923669724118       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923669724012       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 2.046880e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923666740321       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923667205640       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923667379354       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923667442480       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923667470319       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923667483069       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923667483081       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923667484632       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923667484873       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923667484807       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923667484532       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923667486102       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923667487290       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923667487952       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923667487824       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923667487777       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923667487728       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923667487701       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 5.124309e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923666740321       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923666856724       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923666900170       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923666915953       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923666922914       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923666926100       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923666926103       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923666926490       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923666926550       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923666926534       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923666926466       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923666926859       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923666927155       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923666927320       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923666927288       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923666927276       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923666927263       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923666927257       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+02 is 1.281522e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.885329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7082e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.031107e-01 3 1  ON 0
ci_0002                 6.979711e-01 3 1  ON 1
ci_0003                -3.152184e-02 3 1  ON 2
ci_0004                -3.135793e-02 3 1  ON 3
ci_0005                -2.892724e-02 3 1  ON 4
ci_0006                -2.997681e-02 3 1  ON 5
ci_0007                -1.585624e-02 3 1  ON 6
ci_0008                -1.647498e-02 3 1  ON 7
ci_0009                -1.871742e-02 3 1  ON 8
ci_0010                -1.887273e-02 3 1  ON 9
ci_0011                -1.550055e-02 3 1  ON 10
ci_0012                -1.562244e-02 3 1  ON 11
ci_0013                 1.548146e-02 3 1  ON 12
ci_0014                 1.537085e-02 3 1  ON 13
ci_0015                 1.628627e-02 3 1  ON 14
ci_0016                 1.594301e-02 3 1  ON 15
ci_0017                 1.372816e-02 3 1  ON 16
ci_0018                 1.392501e-02 3 1  ON 17
ci_0019                 1.259852e-02 3 1  ON 18
ci_0020                 1.224622e-02 3 1  ON 19
ci_0021                 1.346271e-02 3 1  ON 20
ci_0022                 1.492983e-02 3 1  ON 21
ci_0023                -1.182535e-02 3 1  ON 22
ci_0024                -1.113939e-02 3 1  ON 23
ci_0025                -2.810545e-03 3 1  ON 24
ci_0026                -2.387205e-03 3 1  ON 25
ci_0027                -1.180211e-02 3 1  ON 26
ci_0028                -1.174889e-02 3 1  ON 27
ci_0029                -1.044831e-02 3 1  ON 28
ci_0030                -1.036935e-02 3 1  ON 29
ci_0031                 1.382941e-02 3 1  ON 30
ci_0032                 1.290197e-02 3 1  ON 31
ci_0033                 8.259385e-03 3 1  ON 32
ci_0034                 8.539505e-03 3 1  ON 33
ci_0035                 4.888102e-03 3 1  ON 34
ci_0036                 4.748552e-03 3 1  ON 35
ci_0037                -1.141406e-02 3 1  ON 36
ci_0038                -1.130612e-02 3 1  ON 37
ci_0039                -3.822064e-03 3 1  ON 38
ci_0040                -3.936242e-03 3 1  ON 39
ci_0041                 9.547030e-03 3 1  ON 40
ci_0042                 9.452575e-03 3 1  ON 41
ci_0043                -7.861262e-03 3 1  ON 42
ci_0044                -8.321582e-03 3 1  ON 43
ci_0045                 1.041650e-02 3 1  ON 44
ci_0046                 9.669696e-03 3 1  ON 45
ci_0047                -3.597073e-03 3 1  ON 46
ci_0048                -3.618234e-03 3 1  ON 47
ci_0049                -2.508222e-03 3 1  ON 48
ci_0050                -2.585179e-03 3 1  ON 49
ci_0051                -1.841414e-03 3 1  ON 50
ci_0052                -1.719406e-03 3 1  ON 51
ci_0053                -3.848135e-03 3 1  ON 52
ci_0054                -3.727489e-03 3 1  ON 53
ci_0055                 2.343392e-03 3 1  ON 54
ci_0056                 2.078002e-03 3 1  ON 55
ci_0057                 2.311254e-03 3 1  ON 56
ci_0058                 2.888398e-03 3 1  ON 57
ci_0059                -3.899551e-03 3 1  ON 58
ci_0060                -3.664649e-03 3 1  ON 59
ci_0061                -3.122303e-03 3 1  ON 60
ci_0062                -3.334131e-03 3 1  ON 61
ci_0063                -9.707947e-03 3 1  ON 62
ci_0064                -9.658946e-03 3 1  ON 63
ci_0065                -6.910671e-03 3 1  ON 64
ci_0066                -6.461484e-03 3 1  ON 65
ci_0067                -3.900613e-03 3 1  ON 66
ci_0068                -3.843428e-03 3 1  ON 67
ci_0069                 3.710987e-03 3 1  ON 68
ci_0070                 3.458087e-03 3 1  ON 69
ci_0071                 4.072100e-03 3 1  ON 70
ci_0072                 4.231725e-03 3 1  ON 71
ci_0073                 3.360121e-03 3 1  ON 72
ci_0074                 3.329764e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8353
    reference variance = 0.175022
====================================================
  Execution time = 1.4293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9762e-01
  Total weights = 1.9509e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285723837108
                                         uncertainty =       0.001794650677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285723837108
                                         uncertainty =       0.001794650677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377961855
  error estimate for blocks of size 2^( 2) =       0.000395078801
  error estimate for blocks of size 2^( 3) =       0.000412146942
  error estimate for blocks of size 2^( 4) =       0.000427116922
  error estimate for blocks of size 2^( 5) =       0.000438827245
  error estimate for blocks of size 2^( 6) =       0.000447103237
  error estimate for blocks of size 2^( 7) =       0.000451402292

      target function =      -0.916484488409
              le_mean =     -16.897661155748
             les_mean =     285.828570865302
             stat err =       0.000441112424
             autocorr =       1.362080063013
   target nu stat err =       0.000441112424
   target dn stat err =       0.003380001549
      target stat err =       0.005269806967
              std dev =       0.534518781254
             le_variance =       0.285710327513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285718919133
                                         uncertainty =       0.001794894291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285718919133
                                         uncertainty =       0.001794894291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377958607
  error estimate for blocks of size 2^( 2) =       0.000395075176
  error estimate for blocks of size 2^( 3) =       0.000412142781
  error estimate for blocks of size 2^( 4) =       0.000427112196
  error estimate for blocks of size 2^( 5) =       0.000438822098
  error estimate for blocks of size 2^( 6) =       0.000447098157
  error estimate for blocks of size 2^( 7) =       0.000451397232

      target function =      -0.916494873805
              le_mean =     -16.897661053054
             les_mean =     285.828560650175
             stat err =       0.000441107421
             autocorr =       1.362072575939
   target nu stat err =       0.000441107421
   target dn stat err =       0.003381436105
      target stat err =       0.005272115422
              std dev =       0.534514187841
             le_variance =       0.285705417004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285721370865
                                         uncertainty =       0.001794772446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285721370865
                                         uncertainty =       0.001794772446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377960226
  error estimate for blocks of size 2^( 2) =       0.000395076983
  error estimate for blocks of size 2^( 3) =       0.000412144856
  error estimate for blocks of size 2^( 4) =       0.000427114553
  error estimate for blocks of size 2^( 5) =       0.000438824666
  error estimate for blocks of size 2^( 6) =       0.000447100691
  error estimate for blocks of size 2^( 7) =       0.000451399757

      target function =      -0.916491552779
              le_mean =     -16.897661103732
             les_mean =     285.828564522594
             stat err =       0.000441109917
             autocorr =       1.362076319505
   target nu stat err =       0.000441109917
   target dn stat err =       0.003380706977
      target stat err =       0.005270964379
              std dev =       0.534516477763
             le_variance =       0.285707865000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285723528376
                                         uncertainty =       0.001794665877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285723528376
                                         uncertainty =       0.001794665877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377961651
  error estimate for blocks of size 2^( 2) =       0.000395078573
  error estimate for blocks of size 2^( 3) =       0.000412146681
  error estimate for blocks of size 2^( 4) =       0.000427116625
  error estimate for blocks of size 2^( 5) =       0.000438826922
  error estimate for blocks of size 2^( 6) =       0.000447102918
  error estimate for blocks of size 2^( 7) =       0.000451401975

      target function =      -0.916485632863
              le_mean =     -16.897661149177
             les_mean =     285.828569900783
             stat err =       0.000441112110
             autocorr =       1.362079595384
   target nu stat err =       0.000441112110
   target dn stat err =       0.003380087915
      target stat err =       0.005269951847
              std dev =       0.534518492895
             le_variance =       0.285710019247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916484488409        initial
     2.2737e+01     2.2737e+02             2.0469e-05        -0.916494873805  <--
     9.0949e+01     9.0949e+02             5.1243e-06        -0.916491552779
     3.6380e+02     3.6380e+03             1.2815e-06        -0.916485632863

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 2.3776e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.031183e-01 3 1  ON 0
ci_0002                 6.979642e-01 3 1  ON 1
ci_0003                -3.151906e-02 3 1  ON 2
ci_0004                -3.135636e-02 3 1  ON 3
ci_0005                -2.892829e-02 3 1  ON 4
ci_0006                -2.997811e-02 3 1  ON 5
ci_0007                -1.585480e-02 3 1  ON 6
ci_0008                -1.647233e-02 3 1  ON 7
ci_0009                -1.871649e-02 3 1  ON 8
ci_0010                -1.887018e-02 3 1  ON 9
ci_0011                -1.549900e-02 3 1  ON 10
ci_0012                -1.561939e-02 3 1  ON 11
ci_0013                 1.548023e-02 3 1  ON 12
ci_0014                 1.537229e-02 3 1  ON 13
ci_0015                 1.628369e-02 3 1  ON 14
ci_0016                 1.594380e-02 3 1  ON 15
ci_0017                 1.372698e-02 3 1  ON 16
ci_0018                 1.392444e-02 3 1  ON 17
ci_0019                 1.259760e-02 3 1  ON 18
ci_0020                 1.224761e-02 3 1  ON 19
ci_0021                 1.344736e-02 3 1  ON 20
ci_0022                 1.491707e-02 3 1  ON 21
ci_0023                -1.182615e-02 3 1  ON 22
ci_0024                -1.114057e-02 3 1  ON 23
ci_0025                -2.809732e-03 3 1  ON 24
ci_0026                -2.380831e-03 3 1  ON 25
ci_0027                -1.180210e-02 3 1  ON 26
ci_0028                -1.174677e-02 3 1  ON 27
ci_0029                -1.044711e-02 3 1  ON 28
ci_0030                -1.036947e-02 3 1  ON 29
ci_0031                 1.382859e-02 3 1  ON 30
ci_0032                 1.290113e-02 3 1  ON 31
ci_0033                 8.260647e-03 3 1  ON 32
ci_0034                 8.542354e-03 3 1  ON 33
ci_0035                 4.885947e-03 3 1  ON 34
ci_0036                 4.748461e-03 3 1  ON 35
ci_0037                -1.141651e-02 3 1  ON 36
ci_0038                -1.130579e-02 3 1  ON 37
ci_0039                -3.823268e-03 3 1  ON 38
ci_0040                -3.935277e-03 3 1  ON 39
ci_0041                 9.547541e-03 3 1  ON 40
ci_0042                 9.452713e-03 3 1  ON 41
ci_0043                -7.872225e-03 3 1  ON 42
ci_0044                -8.328717e-03 3 1  ON 43
ci_0045                 1.041619e-02 3 1  ON 44
ci_0046                 9.669600e-03 3 1  ON 45
ci_0047                -3.597259e-03 3 1  ON 46
ci_0048                -3.617471e-03 3 1  ON 47
ci_0049                -2.509906e-03 3 1  ON 48
ci_0050                -2.587659e-03 3 1  ON 49
ci_0051                -1.841798e-03 3 1  ON 50
ci_0052                -1.718813e-03 3 1  ON 51
ci_0053                -3.848034e-03 3 1  ON 52
ci_0054                -3.726235e-03 3 1  ON 53
ci_0055                 2.342031e-03 3 1  ON 54
ci_0056                 2.078455e-03 3 1  ON 55
ci_0057                 2.311409e-03 3 1  ON 56
ci_0058                 2.889141e-03 3 1  ON 57
ci_0059                -3.898119e-03 3 1  ON 58
ci_0060                -3.663841e-03 3 1  ON 59
ci_0061                -3.124769e-03 3 1  ON 60
ci_0062                -3.336762e-03 3 1  ON 61
ci_0063                -9.706674e-03 3 1  ON 62
ci_0064                -9.659480e-03 3 1  ON 63
ci_0065                -6.910293e-03 3 1  ON 64
ci_0066                -6.461348e-03 3 1  ON 65
ci_0067                -3.899389e-03 3 1  ON 66
ci_0068                -3.843502e-03 3 1  ON 67
ci_0069                 3.710914e-03 3 1  ON 68
ci_0070                 3.456535e-03 3 1  ON 69
ci_0071                 4.071131e-03 3 1  ON 70
ci_0072                 4.229528e-03 3 1  ON 71
ci_0073                 3.359096e-03 3 1  ON 72
ci_0074                 3.331268e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.246242
====================================================
  Execution time = 1.4536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6897e+01
  VMC Evar = 2.9141e-01
  Total weights = 1.950711579e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281628186817
                                         uncertainty =       0.001735388451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281628186817
                                         uncertainty =       0.001735388451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375620272
  error estimate for blocks of size 2^( 2) =       0.000392621559
  error estimate for blocks of size 2^( 3) =       0.000410740710
  error estimate for blocks of size 2^( 4) =       0.000425773401
  error estimate for blocks of size 2^( 5) =       0.000436198756
  error estimate for blocks of size 2^( 6) =       0.000443623253
  error estimate for blocks of size 2^( 7) =       0.000448169672

      target function =      -0.926178726061
              le_mean =     -16.897451634699
             les_mean =     285.815283575701
             stat err =       0.000438441270
             autocorr =       1.362463290293
   target nu stat err =       0.000438441270
   target dn stat err =       0.002301992547
      target stat err =       0.003703235406
              std dev =       0.531207282805
             le_variance =       0.282181177306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689745163470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926191947207       residual = 9.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926199801070       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926202154849       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926203428207       residual = 6.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926204019473       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926204219458       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926204277131       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926204268088       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926204255230       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926204255546       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926204256449       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926204259159       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926204258778       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926204256910       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926204256759       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926204255315       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926204256838       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926204257424       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 6.531059e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926191947207       residual = 9.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926193930423       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926194523143       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926194842862       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926194990611       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926195040382       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926195054708       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926195052414       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926195049192       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926195049274       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926195049502       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926195050177       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926195050075       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926195049606       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926195049572       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926195049219       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926195049597       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926195049738       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.642410e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926191947207       residual = 9.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926192444261       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926192592711       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926192672727       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926192709659       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926192722087       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926192725663       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926192725087       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926192724281       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926192724302       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926192724359       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926192724528       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926192724502       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926192724385       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926192724376       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926192724288       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926192724383       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926192724418       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 4.112099e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.895653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7098e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.031169e-01 3 1  ON 0
ci_0002                 6.979667e-01 3 1  ON 1
ci_0003                -3.151581e-02 3 1  ON 2
ci_0004                -3.135744e-02 3 1  ON 3
ci_0005                -2.893265e-02 3 1  ON 4
ci_0006                -2.997864e-02 3 1  ON 5
ci_0007                -1.584955e-02 3 1  ON 6
ci_0008                -1.646485e-02 3 1  ON 7
ci_0009                -1.871631e-02 3 1  ON 8
ci_0010                -1.886716e-02 3 1  ON 9
ci_0011                -1.549708e-02 3 1  ON 10
ci_0012                -1.561599e-02 3 1  ON 11
ci_0013                 1.548072e-02 3 1  ON 12
ci_0014                 1.537089e-02 3 1  ON 13
ci_0015                 1.627923e-02 3 1  ON 14
ci_0016                 1.594069e-02 3 1  ON 15
ci_0017                 1.372716e-02 3 1  ON 16
ci_0018                 1.392391e-02 3 1  ON 17
ci_0019                 1.259718e-02 3 1  ON 18
ci_0020                 1.224593e-02 3 1  ON 19
ci_0021                 1.343094e-02 3 1  ON 20
ci_0022                 1.490418e-02 3 1  ON 21
ci_0023                -1.182750e-02 3 1  ON 22
ci_0024                -1.114467e-02 3 1  ON 23
ci_0025                -2.809891e-03 3 1  ON 24
ci_0026                -2.378081e-03 3 1  ON 25
ci_0027                -1.180125e-02 3 1  ON 26
ci_0028                -1.174811e-02 3 1  ON 27
ci_0029                -1.044724e-02 3 1  ON 28
ci_0030                -1.037065e-02 3 1  ON 29
ci_0031                 1.382740e-02 3 1  ON 30
ci_0032                 1.289657e-02 3 1  ON 31
ci_0033                 8.260840e-03 3 1  ON 32
ci_0034                 8.539943e-03 3 1  ON 33
ci_0035                 4.882405e-03 3 1  ON 34
ci_0036                 4.750638e-03 3 1  ON 35
ci_0037                -1.141416e-02 3 1  ON 36
ci_0038                -1.130644e-02 3 1  ON 37
ci_0039                -3.824830e-03 3 1  ON 38
ci_0040                -3.934277e-03 3 1  ON 39
ci_0041                 9.548915e-03 3 1  ON 40
ci_0042                 9.452741e-03 3 1  ON 41
ci_0043                -7.888401e-03 3 1  ON 42
ci_0044                -8.342403e-03 3 1  ON 43
ci_0045                 1.041633e-02 3 1  ON 44
ci_0046                 9.669549e-03 3 1  ON 45
ci_0047                -3.598404e-03 3 1  ON 46
ci_0048                -3.617602e-03 3 1  ON 47
ci_0049                -2.515693e-03 3 1  ON 48
ci_0050                -2.592024e-03 3 1  ON 49
ci_0051                -1.841641e-03 3 1  ON 50
ci_0052                -1.719675e-03 3 1  ON 51
ci_0053                -3.843868e-03 3 1  ON 52
ci_0054                -3.725896e-03 3 1  ON 53
ci_0055                 2.340151e-03 3 1  ON 54
ci_0056                 2.077385e-03 3 1  ON 55
ci_0057                 2.312816e-03 3 1  ON 56
ci_0058                 2.887782e-03 3 1  ON 57
ci_0059                -3.896031e-03 3 1  ON 58
ci_0060                -3.668211e-03 3 1  ON 59
ci_0061                -3.126720e-03 3 1  ON 60
ci_0062                -3.341351e-03 3 1  ON 61
ci_0063                -9.709636e-03 3 1  ON 62
ci_0064                -9.660150e-03 3 1  ON 63
ci_0065                -6.907193e-03 3 1  ON 64
ci_0066                -6.459390e-03 3 1  ON 65
ci_0067                -3.897750e-03 3 1  ON 66
ci_0068                -3.840798e-03 3 1  ON 67
ci_0069                 3.709807e-03 3 1  ON 68
ci_0070                 3.454168e-03 3 1  ON 69
ci_0071                 4.071241e-03 3 1  ON 70
ci_0072                 4.225566e-03 3 1  ON 71
ci_0073                 3.360881e-03 3 1  ON 72
ci_0074                 3.328483e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8643
    reference variance = 0.219618
====================================================
  Execution time = 1.4375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9097e-01
  Total weights = 1.9508e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280575659816
                                         uncertainty =       0.001696376086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280575659816
                                         uncertainty =       0.001696376086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374517101
  error estimate for blocks of size 2^( 2) =       0.000391486999
  error estimate for blocks of size 2^( 3) =       0.000408653331
  error estimate for blocks of size 2^( 4) =       0.000423397153
  error estimate for blocks of size 2^( 5) =       0.000434496147
  error estimate for blocks of size 2^( 6) =       0.000443084379
  error estimate for blocks of size 2^( 7) =       0.000448398848

      target function =      -0.926873804734
              le_mean =     -16.898011338826
             les_mean =     285.833761697362
             stat err =       0.000437344132
             autocorr =       1.363651203145
   target nu stat err =       0.000437344132
   target dn stat err =       0.002481429884
      target stat err =       0.003990230485
              std dev =       0.529647164215
             le_variance =       0.280526118561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280561195499
                                         uncertainty =       0.001697982375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280561195499
                                         uncertainty =       0.001697982375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374507448
  error estimate for blocks of size 2^( 2) =       0.000391475439
  error estimate for blocks of size 2^( 3) =       0.000408639253
  error estimate for blocks of size 2^( 4) =       0.000423380966
  error estimate for blocks of size 2^( 5) =       0.000434478244
  error estimate for blocks of size 2^( 6) =       0.000443066543
  error estimate for blocks of size 2^( 7) =       0.000448381676

      target function =      -0.926869888124
              le_mean =     -16.898011382716
             les_mean =     285.833765652695
             stat err =       0.000437326858
             autocorr =       1.363613779777
   target nu stat err =       0.000437326858
   target dn stat err =       0.002482423319
      target stat err =       0.003991733960
              std dev =       0.529633511771
             le_variance =       0.280511656790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280568334861
                                         uncertainty =       0.001697182521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280568334861
                                         uncertainty =       0.001697182521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374512213
  error estimate for blocks of size 2^( 2) =       0.000391481151
  error estimate for blocks of size 2^( 3) =       0.000408646217
  error estimate for blocks of size 2^( 4) =       0.000423388978
  error estimate for blocks of size 2^( 5) =       0.000434487101
  error estimate for blocks of size 2^( 6) =       0.000443075365
  error estimate for blocks of size 2^( 7) =       0.000448390169

      target function =      -0.926896945309
              le_mean =     -16.898011354121
             les_mean =     285.833747563520
             stat err =       0.000437335403
             autocorr =       1.363632373292
   target nu stat err =       0.000437335403
   target dn stat err =       0.002481745404
      target stat err =       0.003990913295
              std dev =       0.529640250441
             le_variance =       0.280518794887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280574737387
                                         uncertainty =       0.001696476797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280574737387
                                         uncertainty =       0.001696476797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374516486
  error estimate for blocks of size 2^( 2) =       0.000391486263
  error estimate for blocks of size 2^( 3) =       0.000408652437
  error estimate for blocks of size 2^( 4) =       0.000423396126
  error estimate for blocks of size 2^( 5) =       0.000434495010
  error estimate for blocks of size 2^( 6) =       0.000443083247
  error estimate for blocks of size 2^( 7) =       0.000448397758

      target function =      -0.926877475866
              le_mean =     -16.898011339878
             les_mean =     285.833759408766
             stat err =       0.000437343035
             autocorr =       1.363648847253
   target nu stat err =       0.000437343035
   target dn stat err =       0.002481458360
      target stat err =       0.003990305395
              std dev =       0.529646293571
             le_variance =       0.280525196293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926873804734        initial
     5.6843e+00     5.6843e+01             6.5311e-05        -0.926869888124
     2.2737e+01     2.2737e+02             1.6424e-05        -0.926896945309  <--
     9.0949e+01     9.0949e+02             4.1121e-06        -0.926877475866

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 2.3906e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.031169e-01 3 1  ON 0
ci_0002                 6.979667e-01 3 1  ON 1
ci_0003                -3.151581e-02 3 1  ON 2
ci_0004                -3.135744e-02 3 1  ON 3
ci_0005                -2.893265e-02 3 1  ON 4
ci_0006                -2.997864e-02 3 1  ON 5
ci_0007                -1.584955e-02 3 1  ON 6
ci_0008                -1.646485e-02 3 1  ON 7
ci_0009                -1.871631e-02 3 1  ON 8
ci_0010                -1.886716e-02 3 1  ON 9
ci_0011                -1.549708e-02 3 1  ON 10
ci_0012                -1.561599e-02 3 1  ON 11
ci_0013                 1.548072e-02 3 1  ON 12
ci_0014                 1.537089e-02 3 1  ON 13
ci_0015                 1.627923e-02 3 1  ON 14
ci_0016                 1.594069e-02 3 1  ON 15
ci_0017                 1.372716e-02 3 1  ON 16
ci_0018                 1.392391e-02 3 1  ON 17
ci_0019                 1.259718e-02 3 1  ON 18
ci_0020                 1.224593e-02 3 1  ON 19
ci_0021                 1.343094e-02 3 1  ON 20
ci_0022                 1.490418e-02 3 1  ON 21
ci_0023                -1.182750e-02 3 1  ON 22
ci_0024                -1.114467e-02 3 1  ON 23
ci_0025                -2.809891e-03 3 1  ON 24
ci_0026                -2.378081e-03 3 1  ON 25
ci_0027                -1.180125e-02 3 1  ON 26
ci_0028                -1.174811e-02 3 1  ON 27
ci_0029                -1.044724e-02 3 1  ON 28
ci_0030                -1.037065e-02 3 1  ON 29
ci_0031                 1.382740e-02 3 1  ON 30
ci_0032                 1.289657e-02 3 1  ON 31
ci_0033                 8.260840e-03 3 1  ON 32
ci_0034                 8.539943e-03 3 1  ON 33
ci_0035                 4.882405e-03 3 1  ON 34
ci_0036                 4.750638e-03 3 1  ON 35
ci_0037                -1.141416e-02 3 1  ON 36
ci_0038                -1.130644e-02 3 1  ON 37
ci_0039                -3.824830e-03 3 1  ON 38
ci_0040                -3.934277e-03 3 1  ON 39
ci_0041                 9.548915e-03 3 1  ON 40
ci_0042                 9.452741e-03 3 1  ON 41
ci_0043                -7.888401e-03 3 1  ON 42
ci_0044                -8.342403e-03 3 1  ON 43
ci_0045                 1.041633e-02 3 1  ON 44
ci_0046                 9.669549e-03 3 1  ON 45
ci_0047                -3.598404e-03 3 1  ON 46
ci_0048                -3.617602e-03 3 1  ON 47
ci_0049                -2.515693e-03 3 1  ON 48
ci_0050                -2.592024e-03 3 1  ON 49
ci_0051                -1.841641e-03 3 1  ON 50
ci_0052                -1.719675e-03 3 1  ON 51
ci_0053                -3.843868e-03 3 1  ON 52
ci_0054                -3.725896e-03 3 1  ON 53
ci_0055                 2.340151e-03 3 1  ON 54
ci_0056                 2.077385e-03 3 1  ON 55
ci_0057                 2.312816e-03 3 1  ON 56
ci_0058                 2.887782e-03 3 1  ON 57
ci_0059                -3.896031e-03 3 1  ON 58
ci_0060                -3.668211e-03 3 1  ON 59
ci_0061                -3.126720e-03 3 1  ON 60
ci_0062                -3.341351e-03 3 1  ON 61
ci_0063                -9.709636e-03 3 1  ON 62
ci_0064                -9.660150e-03 3 1  ON 63
ci_0065                -6.907193e-03 3 1  ON 64
ci_0066                -6.459390e-03 3 1  ON 65
ci_0067                -3.897750e-03 3 1  ON 66
ci_0068                -3.840798e-03 3 1  ON 67
ci_0069                 3.709807e-03 3 1  ON 68
ci_0070                 3.454168e-03 3 1  ON 69
ci_0071                 4.071241e-03 3 1  ON 70
ci_0072                 4.225566e-03 3 1  ON 71
ci_0073                 3.360881e-03 3 1  ON 72
ci_0074                 3.328483e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.8885
    reference variance = 0.159112
====================================================
  Execution time = 1.4495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9658e-01
  Total weights = 1.951002713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284664365024
                                         uncertainty =       0.001647562338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284664365024
                                         uncertainty =       0.001647562338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377226982
  error estimate for blocks of size 2^( 2) =       0.000394521392
  error estimate for blocks of size 2^( 3) =       0.000412305964
  error estimate for blocks of size 2^( 4) =       0.000428008696
  error estimate for blocks of size 2^( 5) =       0.000439741876
  error estimate for blocks of size 2^( 6) =       0.000445675323
  error estimate for blocks of size 2^( 7) =       0.000449432110

      target function =      -0.918083005241
              le_mean =     -16.898292918337
             les_mean =     285.848888325799
             stat err =       0.000440714501
             autocorr =       1.364926240321
   target nu stat err =       0.000440714501
   target dn stat err =       0.003262203031
      target stat err =       0.005113270163
              std dev =       0.533479514224
             le_variance =       0.284600392097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689829291834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918110117400       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918128413959       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918130769388       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918132444475       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918133428822       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918133558643       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918133634554       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918133645016       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918133655263       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918133745332       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918133807985       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918133820532       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918133848202       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918133853413       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918133853222       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918133855568       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918133855227       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918133855810       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 8.054781e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918110117400       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918114738294       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918115331995       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918115752911       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918115999036       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918116031229       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918116050185       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918116052797       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918116055400       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918116077972       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918116093522       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918116096548       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918116103304       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918116104554       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918116104507       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918116105080       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918116104994       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918116105138       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 2.024894e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918110117400       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918111275583       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918111424314       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918111529678       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918111591210       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918111599242       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918111603980       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918111604632       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918111605286       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918111610932       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918111614812       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918111615562       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918111617241       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918111617550       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918111617538       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918111617681       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918111617659       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918111617695       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 5.069285e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.905913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7067e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.031038e-01 3 1  ON 0
ci_0002                 6.979813e-01 3 1  ON 1
ci_0003                -3.151101e-02 3 1  ON 2
ci_0004                -3.135658e-02 3 1  ON 3
ci_0005                -2.893739e-02 3 1  ON 4
ci_0006                -2.998205e-02 3 1  ON 5
ci_0007                -1.584361e-02 3 1  ON 6
ci_0008                -1.646053e-02 3 1  ON 7
ci_0009                -1.871401e-02 3 1  ON 8
ci_0010                -1.886446e-02 3 1  ON 9
ci_0011                -1.549554e-02 3 1  ON 10
ci_0012                -1.561146e-02 3 1  ON 11
ci_0013                 1.547772e-02 3 1  ON 12
ci_0014                 1.537044e-02 3 1  ON 13
ci_0015                 1.627837e-02 3 1  ON 14
ci_0016                 1.594095e-02 3 1  ON 15
ci_0017                 1.372618e-02 3 1  ON 16
ci_0018                 1.392380e-02 3 1  ON 17
ci_0019                 1.259706e-02 3 1  ON 18
ci_0020                 1.224934e-02 3 1  ON 19
ci_0021                 1.341069e-02 3 1  ON 20
ci_0022                 1.488890e-02 3 1  ON 21
ci_0023                -1.182389e-02 3 1  ON 22
ci_0024                -1.114544e-02 3 1  ON 23
ci_0025                -2.808056e-03 3 1  ON 24
ci_0026                -2.380052e-03 3 1  ON 25
ci_0027                -1.180201e-02 3 1  ON 26
ci_0028                -1.174741e-02 3 1  ON 27
ci_0029                -1.044782e-02 3 1  ON 28
ci_0030                -1.037217e-02 3 1  ON 29
ci_0031                 1.382646e-02 3 1  ON 30
ci_0032                 1.289484e-02 3 1  ON 31
ci_0033                 8.260709e-03 3 1  ON 32
ci_0034                 8.532909e-03 3 1  ON 33
ci_0035                 4.870302e-03 3 1  ON 34
ci_0036                 4.756171e-03 3 1  ON 35
ci_0037                -1.141354e-02 3 1  ON 36
ci_0038                -1.130345e-02 3 1  ON 37
ci_0039                -3.825399e-03 3 1  ON 38
ci_0040                -3.934127e-03 3 1  ON 39
ci_0041                 9.548031e-03 3 1  ON 40
ci_0042                 9.450624e-03 3 1  ON 41
ci_0043                -7.894520e-03 3 1  ON 42
ci_0044                -8.357529e-03 3 1  ON 43
ci_0045                 1.041432e-02 3 1  ON 44
ci_0046                 9.671116e-03 3 1  ON 45
ci_0047                -3.599652e-03 3 1  ON 46
ci_0048                -3.615962e-03 3 1  ON 47
ci_0049                -2.524425e-03 3 1  ON 48
ci_0050                -2.593278e-03 3 1  ON 49
ci_0051                -1.841671e-03 3 1  ON 50
ci_0052                -1.717633e-03 3 1  ON 51
ci_0053                -3.846217e-03 3 1  ON 52
ci_0054                -3.725395e-03 3 1  ON 53
ci_0055                 2.341655e-03 3 1  ON 54
ci_0056                 2.067946e-03 3 1  ON 55
ci_0057                 2.309877e-03 3 1  ON 56
ci_0058                 2.884661e-03 3 1  ON 57
ci_0059                -3.890646e-03 3 1  ON 58
ci_0060                -3.665933e-03 3 1  ON 59
ci_0061                -3.125792e-03 3 1  ON 60
ci_0062                -3.342118e-03 3 1  ON 61
ci_0063                -9.708004e-03 3 1  ON 62
ci_0064                -9.655670e-03 3 1  ON 63
ci_0065                -6.909800e-03 3 1  ON 64
ci_0066                -6.458555e-03 3 1  ON 65
ci_0067                -3.899627e-03 3 1  ON 66
ci_0068                -3.837546e-03 3 1  ON 67
ci_0069                 3.708028e-03 3 1  ON 68
ci_0070                 3.455142e-03 3 1  ON 69
ci_0071                 4.066152e-03 3 1  ON 70
ci_0072                 4.216836e-03 3 1  ON 71
ci_0073                 3.358083e-03 3 1  ON 72
ci_0074                 3.330326e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.8684
    reference variance = 0.221516
====================================================
  Execution time = 1.4383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9370e-01
  Total weights = 1.9512e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281783300580
                                         uncertainty =       0.001959206302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281783300580
                                         uncertainty =       0.001959206302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375352112
  error estimate for blocks of size 2^( 2) =       0.000392263081
  error estimate for blocks of size 2^( 3) =       0.000409380562
  error estimate for blocks of size 2^( 4) =       0.000424363273
  error estimate for blocks of size 2^( 5) =       0.000434863209
  error estimate for blocks of size 2^( 6) =       0.000441165925
  error estimate for blocks of size 2^( 7) =       0.000444656319

      target function =      -0.914640226504
              le_mean =     -16.898725723532
             les_mean =     285.865687679202
             stat err =       0.000436262181
             autocorr =       1.350881967420
   target nu stat err =       0.000436262181
   target dn stat err =       0.006525573975
      target stat err =       0.010079376523
              std dev =       0.530828048108
             le_variance =       0.281778416658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281770291649
                                         uncertainty =       0.001961827003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281770291649
                                         uncertainty =       0.001961827003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375343421
  error estimate for blocks of size 2^( 2) =       0.000392253045
  error estimate for blocks of size 2^( 3) =       0.000409369296
  error estimate for blocks of size 2^( 4) =       0.000424349991
  error estimate for blocks of size 2^( 5) =       0.000434847593
  error estimate for blocks of size 2^( 6) =       0.000441147812
  error estimate for blocks of size 2^( 7) =       0.000444641378

      target function =      -0.922101318055
              le_mean =     -16.898725831905
             les_mean =     285.860933059651
             stat err =       0.000436246694
             autocorr =       1.350848611605
   target nu stat err =       0.000436246694
   target dn stat err =       0.003854101819
      target stat err =       0.006079273059
              std dev =       0.530815756485
             le_variance =       0.281765367332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281776675534
                                         uncertainty =       0.001960522540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281776675534
                                         uncertainty =       0.001960522540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375347686
  error estimate for blocks of size 2^( 2) =       0.000392257974
  error estimate for blocks of size 2^( 3) =       0.000409374840
  error estimate for blocks of size 2^( 4) =       0.000424356506
  error estimate for blocks of size 2^( 5) =       0.000434855271
  error estimate for blocks of size 2^( 6) =       0.000441156676
  error estimate for blocks of size 2^( 7) =       0.000444648645

      target function =      -0.922799937121
              le_mean =     -16.898725792511
             les_mean =     285.860486345865
             stat err =       0.000436254274
             autocorr =       1.350864858201
   target nu stat err =       0.000436254274
   target dn stat err =       0.003812084895
      target stat err =       0.006023029858
              std dev =       0.530821788703
             le_variance =       0.281771771362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281782465857
                                         uncertainty =       0.001959370500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281782465857
                                         uncertainty =       0.001959370500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375351555
  error estimate for blocks of size 2^( 2) =       0.000392262462
  error estimate for blocks of size 2^( 3) =       0.000409379818
  error estimate for blocks of size 2^( 4) =       0.000424362428
  error estimate for blocks of size 2^( 5) =       0.000434862115
  error estimate for blocks of size 2^( 6) =       0.000441164443
  error estimate for blocks of size 2^( 7) =       0.000444655087

      target function =      -0.882500752183
              le_mean =     -16.898725793025
             les_mean =     285.886273565213
             stat err =       0.000436261018
             autocorr =       1.350878777289
   target nu stat err =       0.000436261018
   target dn stat err =       0.026169249903
      target stat err =       0.037600229442
              std dev =       0.530827259527
             le_variance =       0.281777579456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914640226504        initial
     5.6843e+00     5.6843e+01             8.0548e-05        -0.922101318055
     2.2737e+01     2.2737e+02             2.0249e-05        -0.922799937121  <--
     9.0949e+01     9.0949e+02             5.0693e-06        -0.882500752183

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 2.3927e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.031038e-01 3 1  ON 0
ci_0002                 6.979813e-01 3 1  ON 1
ci_0003                -3.151101e-02 3 1  ON 2
ci_0004                -3.135658e-02 3 1  ON 3
ci_0005                -2.893739e-02 3 1  ON 4
ci_0006                -2.998205e-02 3 1  ON 5
ci_0007                -1.584361e-02 3 1  ON 6
ci_0008                -1.646053e-02 3 1  ON 7
ci_0009                -1.871401e-02 3 1  ON 8
ci_0010                -1.886446e-02 3 1  ON 9
ci_0011                -1.549554e-02 3 1  ON 10
ci_0012                -1.561146e-02 3 1  ON 11
ci_0013                 1.547772e-02 3 1  ON 12
ci_0014                 1.537044e-02 3 1  ON 13
ci_0015                 1.627837e-02 3 1  ON 14
ci_0016                 1.594095e-02 3 1  ON 15
ci_0017                 1.372618e-02 3 1  ON 16
ci_0018                 1.392380e-02 3 1  ON 17
ci_0019                 1.259706e-02 3 1  ON 18
ci_0020                 1.224934e-02 3 1  ON 19
ci_0021                 1.341069e-02 3 1  ON 20
ci_0022                 1.488890e-02 3 1  ON 21
ci_0023                -1.182389e-02 3 1  ON 22
ci_0024                -1.114544e-02 3 1  ON 23
ci_0025                -2.808056e-03 3 1  ON 24
ci_0026                -2.380052e-03 3 1  ON 25
ci_0027                -1.180201e-02 3 1  ON 26
ci_0028                -1.174741e-02 3 1  ON 27
ci_0029                -1.044782e-02 3 1  ON 28
ci_0030                -1.037217e-02 3 1  ON 29
ci_0031                 1.382646e-02 3 1  ON 30
ci_0032                 1.289484e-02 3 1  ON 31
ci_0033                 8.260709e-03 3 1  ON 32
ci_0034                 8.532909e-03 3 1  ON 33
ci_0035                 4.870302e-03 3 1  ON 34
ci_0036                 4.756171e-03 3 1  ON 35
ci_0037                -1.141354e-02 3 1  ON 36
ci_0038                -1.130345e-02 3 1  ON 37
ci_0039                -3.825399e-03 3 1  ON 38
ci_0040                -3.934127e-03 3 1  ON 39
ci_0041                 9.548031e-03 3 1  ON 40
ci_0042                 9.450624e-03 3 1  ON 41
ci_0043                -7.894520e-03 3 1  ON 42
ci_0044                -8.357529e-03 3 1  ON 43
ci_0045                 1.041432e-02 3 1  ON 44
ci_0046                 9.671116e-03 3 1  ON 45
ci_0047                -3.599652e-03 3 1  ON 46
ci_0048                -3.615962e-03 3 1  ON 47
ci_0049                -2.524425e-03 3 1  ON 48
ci_0050                -2.593278e-03 3 1  ON 49
ci_0051                -1.841671e-03 3 1  ON 50
ci_0052                -1.717633e-03 3 1  ON 51
ci_0053                -3.846217e-03 3 1  ON 52
ci_0054                -3.725395e-03 3 1  ON 53
ci_0055                 2.341655e-03 3 1  ON 54
ci_0056                 2.067946e-03 3 1  ON 55
ci_0057                 2.309877e-03 3 1  ON 56
ci_0058                 2.884661e-03 3 1  ON 57
ci_0059                -3.890646e-03 3 1  ON 58
ci_0060                -3.665933e-03 3 1  ON 59
ci_0061                -3.125792e-03 3 1  ON 60
ci_0062                -3.342118e-03 3 1  ON 61
ci_0063                -9.708004e-03 3 1  ON 62
ci_0064                -9.655670e-03 3 1  ON 63
ci_0065                -6.909800e-03 3 1  ON 64
ci_0066                -6.458555e-03 3 1  ON 65
ci_0067                -3.899627e-03 3 1  ON 66
ci_0068                -3.837546e-03 3 1  ON 67
ci_0069                 3.708028e-03 3 1  ON 68
ci_0070                 3.455142e-03 3 1  ON 69
ci_0071                 4.066152e-03 3 1  ON 70
ci_0072                 4.216836e-03 3 1  ON 71
ci_0073                 3.358083e-03 3 1  ON 72
ci_0074                 3.330326e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1001e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.247953
====================================================
  Execution time = 1.4620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9269e-01
  Total weights = 1.950764493e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283459874250
                                         uncertainty =       0.001610972368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283459874250
                                         uncertainty =       0.001610972368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376532942
  error estimate for blocks of size 2^( 2) =       0.000393340554
  error estimate for blocks of size 2^( 3) =       0.000410506642
  error estimate for blocks of size 2^( 4) =       0.000425507931
  error estimate for blocks of size 2^( 5) =       0.000437515740
  error estimate for blocks of size 2^( 6) =       0.000445145192
  error estimate for blocks of size 2^( 7) =       0.000449129773

      target function =      -0.924182162818
              le_mean =     -16.898411139935
             les_mean =     285.848984588253
             stat err =       0.000439324659
             autocorr =       1.361335609768
   target nu stat err =       0.000439324659
   target dn stat err =       0.002491075855
      target stat err =       0.003985934081
              std dev =       0.532497993520
             le_variance =       0.283554113102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689841113993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924197975607       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924210911066       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924213691009       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924215596894       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924216657793       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924217120015       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924217165415       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924217238077       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924217268993       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924217275060       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924217285427       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924217305263       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924217307684       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924217319114       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924217320467       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924217322054       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924217320268       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924217321679       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 7.952611e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924197975607       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924201242374       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924201942895       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924202421255       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924202686912       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924202802329       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924202813495       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924202831637       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924202839326       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924202840795       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924202843370       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924202848318       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924202848876       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924202851675       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924202851999       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924202852392       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924202851952       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924202852295       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.998997e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924197975607       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924198794381       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924198969861       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924199089569       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924199156010       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924199184855       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924199187635       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924199192168       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924199194088       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924199194453       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924199195095       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924199196331       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924199196468       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924199197164       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924199197244       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924199197342       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924199197233       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924199197318       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 5.004318e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.916241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7206e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.031145e-01 3 1  ON 0
ci_0002                 6.979721e-01 3 1  ON 1
ci_0003                -3.150900e-02 3 1  ON 2
ci_0004                -3.135357e-02 3 1  ON 3
ci_0005                -2.893802e-02 3 1  ON 4
ci_0006                -2.998335e-02 3 1  ON 5
ci_0007                -1.583796e-02 3 1  ON 6
ci_0008                -1.645275e-02 3 1  ON 7
ci_0009                -1.871418e-02 3 1  ON 8
ci_0010                -1.886152e-02 3 1  ON 9
ci_0011                -1.549270e-02 3 1  ON 10
ci_0012                -1.560539e-02 3 1  ON 11
ci_0013                 1.547634e-02 3 1  ON 12
ci_0014                 1.537259e-02 3 1  ON 13
ci_0015                 1.627486e-02 3 1  ON 14
ci_0016                 1.593592e-02 3 1  ON 15
ci_0017                 1.372424e-02 3 1  ON 16
ci_0018                 1.392502e-02 3 1  ON 17
ci_0019                 1.259934e-02 3 1  ON 18
ci_0020                 1.225133e-02 3 1  ON 19
ci_0021                 1.339070e-02 3 1  ON 20
ci_0022                 1.486892e-02 3 1  ON 21
ci_0023                -1.182555e-02 3 1  ON 22
ci_0024                -1.114608e-02 3 1  ON 23
ci_0025                -2.806539e-03 3 1  ON 24
ci_0026                -2.380460e-03 3 1  ON 25
ci_0027                -1.180051e-02 3 1  ON 26
ci_0028                -1.174738e-02 3 1  ON 27
ci_0029                -1.044622e-02 3 1  ON 28
ci_0030                -1.037577e-02 3 1  ON 29
ci_0031                 1.382489e-02 3 1  ON 30
ci_0032                 1.289438e-02 3 1  ON 31
ci_0033                 8.258570e-03 3 1  ON 32
ci_0034                 8.535551e-03 3 1  ON 33
ci_0035                 4.870425e-03 3 1  ON 34
ci_0036                 4.761825e-03 3 1  ON 35
ci_0037                -1.141293e-02 3 1  ON 36
ci_0038                -1.130101e-02 3 1  ON 37
ci_0039                -3.825018e-03 3 1  ON 38
ci_0040                -3.933610e-03 3 1  ON 39
ci_0041                 9.545038e-03 3 1  ON 40
ci_0042                 9.450058e-03 3 1  ON 41
ci_0043                -7.903919e-03 3 1  ON 42
ci_0044                -8.370816e-03 3 1  ON 43
ci_0045                 1.041768e-02 3 1  ON 44
ci_0046                 9.672261e-03 3 1  ON 45
ci_0047                -3.598285e-03 3 1  ON 46
ci_0048                -3.613828e-03 3 1  ON 47
ci_0049                -2.521626e-03 3 1  ON 48
ci_0050                -2.596047e-03 3 1  ON 49
ci_0051                -1.842715e-03 3 1  ON 50
ci_0052                -1.719803e-03 3 1  ON 51
ci_0053                -3.846120e-03 3 1  ON 52
ci_0054                -3.722553e-03 3 1  ON 53
ci_0055                 2.339876e-03 3 1  ON 54
ci_0056                 2.065284e-03 3 1  ON 55
ci_0057                 2.306832e-03 3 1  ON 56
ci_0058                 2.882067e-03 3 1  ON 57
ci_0059                -3.886378e-03 3 1  ON 58
ci_0060                -3.671483e-03 3 1  ON 59
ci_0061                -3.128739e-03 3 1  ON 60
ci_0062                -3.339557e-03 3 1  ON 61
ci_0063                -9.707563e-03 3 1  ON 62
ci_0064                -9.653450e-03 3 1  ON 63
ci_0065                -6.906789e-03 3 1  ON 64
ci_0066                -6.459687e-03 3 1  ON 65
ci_0067                -3.896852e-03 3 1  ON 66
ci_0068                -3.831192e-03 3 1  ON 67
ci_0069                 3.708372e-03 3 1  ON 68
ci_0070                 3.453125e-03 3 1  ON 69
ci_0071                 4.066685e-03 3 1  ON 70
ci_0072                 4.206933e-03 3 1  ON 71
ci_0073                 3.357232e-03 3 1  ON 72
ci_0074                 3.329692e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8838
    reference variance = 0.211912
====================================================
  Execution time = 1.6336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9215e-01
  Total weights = 1.9513e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493497558
                                         uncertainty =       0.001993955417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283493497558
                                         uncertainty =       0.001993955417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376473082
  error estimate for blocks of size 2^( 2) =       0.000393536490
  error estimate for blocks of size 2^( 3) =       0.000410947867
  error estimate for blocks of size 2^( 4) =       0.000426638873
  error estimate for blocks of size 2^( 5) =       0.000438087549
  error estimate for blocks of size 2^( 6) =       0.000446498152
  error estimate for blocks of size 2^( 7) =       0.000450254534

      target function =      -0.924997069181
              le_mean =     -16.898103931256
             les_mean =     285.838084083530
             stat err =       0.000440369777
             autocorr =       1.368255338411
   target nu stat err =       0.000440369777
   target dn stat err =       0.002253511597
      target stat err =       0.003624400215
              std dev =       0.532413338590
             le_variance =       0.283463963108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283468161409
                                         uncertainty =       0.001992508366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283468161409
                                         uncertainty =       0.001992508366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376456290
  error estimate for blocks of size 2^( 2) =       0.000393518157
  error estimate for blocks of size 2^( 3) =       0.000410927786
  error estimate for blocks of size 2^( 4) =       0.000426616083
  error estimate for blocks of size 2^( 5) =       0.000438063480
  error estimate for blocks of size 2^( 6) =       0.000446471839
  error estimate for blocks of size 2^( 7) =       0.000450227163

      target function =      -0.925094702983
              le_mean =     -16.898104136153
             les_mean =     285.838029004878
             stat err =       0.000440344641
             autocorr =       1.368221200038
   target nu stat err =       0.000440344641
   target dn stat err =       0.002248946733
      target stat err =       0.003618111961
              std dev =       0.532389591190
             le_variance =       0.283438676808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283480677049
                                         uncertainty =       0.001993224575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283480677049
                                         uncertainty =       0.001993224575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376464585
  error estimate for blocks of size 2^( 2) =       0.000393527217
  error estimate for blocks of size 2^( 3) =       0.000410937714
  error estimate for blocks of size 2^( 4) =       0.000426627354
  error estimate for blocks of size 2^( 5) =       0.000438075388
  error estimate for blocks of size 2^( 6) =       0.000446484861
  error estimate for blocks of size 2^( 7) =       0.000450240712

      target function =      -0.925057237976
              le_mean =     -16.898104026327
             les_mean =     285.838049081910
             stat err =       0.000440357079
             autocorr =       1.368238192802
   target nu stat err =       0.000440357079
   target dn stat err =       0.002250955971
      target stat err =       0.003620922605
              std dev =       0.532401321968
             le_variance =       0.283451167633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283491885324
                                         uncertainty =       0.001993863710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283491885324
                                         uncertainty =       0.001993863710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376472014
  error estimate for blocks of size 2^( 2) =       0.000393535324
  error estimate for blocks of size 2^( 3) =       0.000410946591
  error estimate for blocks of size 2^( 4) =       0.000426637425
  error estimate for blocks of size 2^( 5) =       0.000438086021
  error estimate for blocks of size 2^( 6) =       0.000446496482
  error estimate for blocks of size 2^( 7) =       0.000450252798

      target function =      -0.925006161163
              le_mean =     -16.898103942330
             les_mean =     285.838078682749
             stat err =       0.000440368182
             autocorr =       1.368253191801
   target nu stat err =       0.000440368182
   target dn stat err =       0.002253144706
      target stat err =       0.003623904558
              std dev =       0.532411827447
             le_variance =       0.283462354006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924997069181        initial
     5.6843e+00     5.6843e+01             7.9526e-05        -0.925094702983  <--
     2.2737e+01     2.2737e+02             1.9990e-05        -0.925057237976
     9.0949e+01     9.0949e+02             5.0043e-06        -0.925006161163

*****************************************************************************
Applying the update for shift_i =   5.6843e+00     and shift_s =   5.6843e+01
*****************************************************************************

  Execution time = 2.5855e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.031465e-01 3 1  ON 0
ci_0002                 6.979447e-01 3 1  ON 1
ci_0003                -3.150306e-02 3 1  ON 2
ci_0004                -3.134461e-02 3 1  ON 3
ci_0005                -2.893988e-02 3 1  ON 4
ci_0006                -2.998719e-02 3 1  ON 5
ci_0007                -1.582111e-02 3 1  ON 6
ci_0008                -1.642955e-02 3 1  ON 7
ci_0009                -1.871471e-02 3 1  ON 8
ci_0010                -1.885281e-02 3 1  ON 9
ci_0011                -1.548428e-02 3 1  ON 10
ci_0012                -1.558735e-02 3 1  ON 11
ci_0013                 1.547225e-02 3 1  ON 12
ci_0014                 1.537896e-02 3 1  ON 13
ci_0015                 1.626444e-02 3 1  ON 14
ci_0016                 1.592097e-02 3 1  ON 15
ci_0017                 1.371847e-02 3 1  ON 16
ci_0018                 1.392866e-02 3 1  ON 17
ci_0019                 1.260610e-02 3 1  ON 18
ci_0020                 1.225725e-02 3 1  ON 19
ci_0021                 1.333116e-02 3 1  ON 20
ci_0022                 1.480941e-02 3 1  ON 21
ci_0023                -1.183047e-02 3 1  ON 22
ci_0024                -1.114799e-02 3 1  ON 23
ci_0025                -2.802054e-03 3 1  ON 24
ci_0026                -2.381664e-03 3 1  ON 25
ci_0027                -1.179605e-02 3 1  ON 26
ci_0028                -1.174729e-02 3 1  ON 27
ci_0029                -1.044149e-02 3 1  ON 28
ci_0030                -1.038644e-02 3 1  ON 29
ci_0031                 1.382021e-02 3 1  ON 30
ci_0032                 1.289298e-02 3 1  ON 31
ci_0033                 8.252215e-03 3 1  ON 32
ci_0034                 8.543412e-03 3 1  ON 33
ci_0035                 4.870783e-03 3 1  ON 34
ci_0036                 4.778542e-03 3 1  ON 35
ci_0037                -1.141115e-02 3 1  ON 36
ci_0038                -1.129377e-02 3 1  ON 37
ci_0039                -3.823892e-03 3 1  ON 38
ci_0040                -3.932079e-03 3 1  ON 39
ci_0041                 9.536153e-03 3 1  ON 40
ci_0042                 9.448369e-03 3 1  ON 41
ci_0043                -7.931881e-03 3 1  ON 42
ci_0044                -8.410345e-03 3 1  ON 43
ci_0045                 1.042766e-02 3 1  ON 44
ci_0046                 9.675655e-03 3 1  ON 45
ci_0047                -3.594236e-03 3 1  ON 46
ci_0048                -3.607507e-03 3 1  ON 47
ci_0049                -2.513339e-03 3 1  ON 48
ci_0050                -2.604243e-03 3 1  ON 49
ci_0051                -1.845804e-03 3 1  ON 50
ci_0052                -1.726218e-03 3 1  ON 51
ci_0053                -3.845834e-03 3 1  ON 52
ci_0054                -3.714143e-03 3 1  ON 53
ci_0055                 2.334611e-03 3 1  ON 54
ci_0056                 2.057402e-03 3 1  ON 55
ci_0057                 2.297818e-03 3 1  ON 56
ci_0058                 2.874387e-03 3 1  ON 57
ci_0059                -3.873750e-03 3 1  ON 58
ci_0060                -3.687905e-03 3 1  ON 59
ci_0061                -3.137483e-03 3 1  ON 60
ci_0062                -3.331958e-03 3 1  ON 61
ci_0063                -9.706253e-03 3 1  ON 62
ci_0064                -9.646855e-03 3 1  ON 63
ci_0065                -6.897861e-03 3 1  ON 64
ci_0066                -6.463043e-03 3 1  ON 65
ci_0067                -3.888642e-03 3 1  ON 66
ci_0068                -3.812390e-03 3 1  ON 67
ci_0069                 3.709389e-03 3 1  ON 68
ci_0070                 3.447155e-03 3 1  ON 69
ci_0071                 4.068264e-03 3 1  ON 70
ci_0072                 4.177626e-03 3 1  ON 71
ci_0073                 3.354716e-03 3 1  ON 72
ci_0074                 3.327813e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.256263
====================================================
  Execution time = 1.4576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5211e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9218e-01
  Total weights = 1.951093429e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283113221971
                                         uncertainty =       0.001624887801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283113221971
                                         uncertainty =       0.001624887801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376264812
  error estimate for blocks of size 2^( 2) =       0.000393564828
  error estimate for blocks of size 2^( 3) =       0.000411374069
  error estimate for blocks of size 2^( 4) =       0.000427279220
  error estimate for blocks of size 2^( 5) =       0.000439346418
  error estimate for blocks of size 2^( 6) =       0.000445659889
  error estimate for blocks of size 2^( 7) =       0.000450804578

      target function =      -0.924976295900
              le_mean =     -16.897963243955
             les_mean =     285.833341322670
             stat err =       0.000440772526
             autocorr =       1.372277125058
   target nu stat err =       0.000440772526
   target dn stat err =       0.002298801678
      target stat err =       0.003693182305
              std dev =       0.532118799469
             le_variance =       0.283150416748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689796324395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924989588728       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925027999308       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925037196423       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925043445143       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925045744676       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925046829581       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925046992443       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925047131141       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925047112182       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925047099303       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925047104320       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925047114546       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925047106758       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925047101522       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925047107380       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925047111281       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925047116091       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925047117150       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 2.992109e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924989588728       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924999579510       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925001950761       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925003539892       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925004117287       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925004386754       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925004425502       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925004459562       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925004454612       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925004451305       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925004452497       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925004454970       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925004453049       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925004451842       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925004453306       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925004454244       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925004455372       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925004455568       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 7.641909e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924989588728       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924992111919       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924992709398       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924993108371       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924993252850       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924993320086       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924993329644       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924993338118       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924993336868       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924993336036       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924993336330       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924993336943       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924993336464       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924993336169       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924993336535       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924993336767       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924993337044       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924993337089       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.920858e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.926729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7171e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.031460e-01 3 1  ON 0
ci_0002                 6.979494e-01 3 1  ON 1
ci_0003                -3.149549e-02 3 1  ON 2
ci_0004                -3.134164e-02 3 1  ON 3
ci_0005                -2.897176e-02 3 1  ON 4
ci_0006                -3.000963e-02 3 1  ON 5
ci_0007                -1.579787e-02 3 1  ON 6
ci_0008                -1.640538e-02 3 1  ON 7
ci_0009                -1.871528e-02 3 1  ON 8
ci_0010                -1.885544e-02 3 1  ON 9
ci_0011                -1.546839e-02 3 1  ON 10
ci_0012                -1.558548e-02 3 1  ON 11
ci_0013                 1.546024e-02 3 1  ON 12
ci_0014                 1.537426e-02 3 1  ON 13
ci_0015                 1.624049e-02 3 1  ON 14
ci_0016                 1.590916e-02 3 1  ON 15
ci_0017                 1.371644e-02 3 1  ON 16
ci_0018                 1.391112e-02 3 1  ON 17
ci_0019                 1.260722e-02 3 1  ON 18
ci_0020                 1.227308e-02 3 1  ON 19
ci_0021                 1.325474e-02 3 1  ON 20
ci_0022                 1.474852e-02 3 1  ON 21
ci_0023                -1.182242e-02 3 1  ON 22
ci_0024                -1.114631e-02 3 1  ON 23
ci_0025                -2.784450e-03 3 1  ON 24
ci_0026                -2.385298e-03 3 1  ON 25
ci_0027                -1.178225e-02 3 1  ON 26
ci_0028                -1.174223e-02 3 1  ON 27
ci_0029                -1.045883e-02 3 1  ON 28
ci_0030                -1.039298e-02 3 1  ON 29
ci_0031                 1.382412e-02 3 1  ON 30
ci_0032                 1.288487e-02 3 1  ON 31
ci_0033                 8.239613e-03 3 1  ON 32
ci_0034                 8.542912e-03 3 1  ON 33
ci_0035                 4.856436e-03 3 1  ON 34
ci_0036                 4.772987e-03 3 1  ON 35
ci_0037                -1.141082e-02 3 1  ON 36
ci_0038                -1.129709e-02 3 1  ON 37
ci_0039                -3.825693e-03 3 1  ON 38
ci_0040                -3.926111e-03 3 1  ON 39
ci_0041                 9.537043e-03 3 1  ON 40
ci_0042                 9.443572e-03 3 1  ON 41
ci_0043                -7.953989e-03 3 1  ON 42
ci_0044                -8.447446e-03 3 1  ON 43
ci_0045                 1.042312e-02 3 1  ON 44
ci_0046                 9.679614e-03 3 1  ON 45
ci_0047                -3.587114e-03 3 1  ON 46
ci_0048                -3.607571e-03 3 1  ON 47
ci_0049                -2.516788e-03 3 1  ON 48
ci_0050                -2.623682e-03 3 1  ON 49
ci_0051                -1.833465e-03 3 1  ON 50
ci_0052                -1.735306e-03 3 1  ON 51
ci_0053                -3.841592e-03 3 1  ON 52
ci_0054                -3.704220e-03 3 1  ON 53
ci_0055                 2.329419e-03 3 1  ON 54
ci_0056                 2.059988e-03 3 1  ON 55
ci_0057                 2.310854e-03 3 1  ON 56
ci_0058                 2.877543e-03 3 1  ON 57
ci_0059                -3.874413e-03 3 1  ON 58
ci_0060                -3.698394e-03 3 1  ON 59
ci_0061                -3.150517e-03 3 1  ON 60
ci_0062                -3.342642e-03 3 1  ON 61
ci_0063                -9.701716e-03 3 1  ON 62
ci_0064                -9.638143e-03 3 1  ON 63
ci_0065                -6.890279e-03 3 1  ON 64
ci_0066                -6.459869e-03 3 1  ON 65
ci_0067                -3.886627e-03 3 1  ON 66
ci_0068                -3.810956e-03 3 1  ON 67
ci_0069                 3.698964e-03 3 1  ON 68
ci_0070                 3.431316e-03 3 1  ON 69
ci_0071                 4.046472e-03 3 1  ON 70
ci_0072                 4.147328e-03 3 1  ON 71
ci_0073                 3.345708e-03 3 1  ON 72
ci_0074                 3.324539e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9325
    reference variance = 0.24384
====================================================
  Execution time = 1.4256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9164e-01
  Total weights = 1.9505e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283021061581
                                         uncertainty =       0.001593921653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283021061581
                                         uncertainty =       0.001593921653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376210144
  error estimate for blocks of size 2^( 2) =       0.000393415331
  error estimate for blocks of size 2^( 3) =       0.000411159112
  error estimate for blocks of size 2^( 4) =       0.000427198516
  error estimate for blocks of size 2^( 5) =       0.000439338001
  error estimate for blocks of size 2^( 6) =       0.000447479633
  error estimate for blocks of size 2^( 7) =       0.000452101961

      target function =      -0.925763631666
              le_mean =     -16.897596307747
             les_mean =     285.820438518945
             stat err =       0.000441529528
             autocorr =       1.377394997170
   target nu stat err =       0.000441529528
   target dn stat err =       0.002162128293
      target stat err =       0.003486640550
              std dev =       0.532041488647
             le_variance =       0.283068145642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282932771044
                                         uncertainty =       0.001587880185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282932771044
                                         uncertainty =       0.001587880185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376151133
  error estimate for blocks of size 2^( 2) =       0.000393351931
  error estimate for blocks of size 2^( 3) =       0.000411090460
  error estimate for blocks of size 2^( 4) =       0.000427123150
  error estimate for blocks of size 2^( 5) =       0.000439254702
  error estimate for blocks of size 2^( 6) =       0.000447393096
  error estimate for blocks of size 2^( 7) =       0.000452012996

      target function =      -0.925936233843
              le_mean =     -16.897599124797
             les_mean =     285.820424226803
             stat err =       0.000441445986
             autocorr =       1.377305858475
   target nu stat err =       0.000441445986
   target dn stat err =       0.002152543351
      target stat err =       0.003473153918
              std dev =       0.531958034266
             le_variance =       0.282979350220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282975033935
                                         uncertainty =       0.001590799524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282975033935
                                         uncertainty =       0.001590799524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376179384
  error estimate for blocks of size 2^( 2) =       0.000393382317
  error estimate for blocks of size 2^( 3) =       0.000411123409
  error estimate for blocks of size 2^( 4) =       0.000427159382
  error estimate for blocks of size 2^( 5) =       0.000439294795
  error estimate for blocks of size 2^( 6) =       0.000447434735
  error estimate for blocks of size 2^( 7) =       0.000452055778

      target function =      -0.925879355746
              le_mean =     -16.897597651825
             les_mean =     285.820410512023
             stat err =       0.000441486173
             autocorr =       1.377349737136
   target nu stat err =       0.000441486173
   target dn stat err =       0.002156848040
      target stat err =       0.003479363084
              std dev =       0.531997986398
             le_variance =       0.283021857531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283015188440
                                         uncertainty =       0.001593525586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283015188440
                                         uncertainty =       0.001593525586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376206220
  error estimate for blocks of size 2^( 2) =       0.000393411122
  error estimate for blocks of size 2^( 3) =       0.000411154564
  error estimate for blocks of size 2^( 4) =       0.000427193538
  error estimate for blocks of size 2^( 5) =       0.000439332510
  error estimate for blocks of size 2^( 6) =       0.000447473928
  error estimate for blocks of size 2^( 7) =       0.000452096092

      target function =      -0.925782327583
              le_mean =     -16.897596464635
             les_mean =     285.820431954986
             stat err =       0.000441524017
             autocorr =       1.377389352994
   target nu stat err =       0.000441524017
   target dn stat err =       0.002161430397
      target stat err =       0.003485703826
              std dev =       0.532035938341
             le_variance =       0.283062239686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925763631666        initial
     1.4211e+00     1.4211e+01             2.9921e-04        -0.925936233843  <--
     5.6843e+00     5.6843e+01             7.6419e-05        -0.925879355746
     2.2737e+01     2.2737e+02             1.9209e-05        -0.925782327583

*****************************************************************************
Applying the update for shift_i =   1.4211e+00     and shift_s =   1.4211e+01
*****************************************************************************

  Execution time = 2.3836e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.031440e-01 3 1  ON 0
ci_0002                 6.979634e-01 3 1  ON 1
ci_0003                -3.147366e-02 3 1  ON 2
ci_0004                -3.133307e-02 3 1  ON 3
ci_0005                -2.906386e-02 3 1  ON 4
ci_0006                -3.007445e-02 3 1  ON 5
ci_0007                -1.572999e-02 3 1  ON 6
ci_0008                -1.633470e-02 3 1  ON 7
ci_0009                -1.871695e-02 3 1  ON 8
ci_0010                -1.886301e-02 3 1  ON 9
ci_0011                -1.542255e-02 3 1  ON 10
ci_0012                -1.557995e-02 3 1  ON 11
ci_0013                 1.542578e-02 3 1  ON 12
ci_0014                 1.536080e-02 3 1  ON 13
ci_0015                 1.617159e-02 3 1  ON 14
ci_0016                 1.587524e-02 3 1  ON 15
ci_0017                 1.371060e-02 3 1  ON 16
ci_0018                 1.386076e-02 3 1  ON 17
ci_0019                 1.261050e-02 3 1  ON 18
ci_0020                 1.231861e-02 3 1  ON 19
ci_0021                 1.303195e-02 3 1  ON 20
ci_0022                 1.457118e-02 3 1  ON 21
ci_0023                -1.179937e-02 3 1  ON 22
ci_0024                -1.114153e-02 3 1  ON 23
ci_0025                -2.734428e-03 3 1  ON 24
ci_0026                -2.395662e-03 3 1  ON 25
ci_0027                -1.174267e-02 3 1  ON 26
ci_0028                -1.172773e-02 3 1  ON 27
ci_0029                -1.050888e-02 3 1  ON 28
ci_0030                -1.041186e-02 3 1  ON 29
ci_0031                 1.383545e-02 3 1  ON 30
ci_0032                 1.286111e-02 3 1  ON 31
ci_0033                 8.203038e-03 3 1  ON 32
ci_0034                 8.541485e-03 3 1  ON 33
ci_0035                 4.815478e-03 3 1  ON 34
ci_0036                 4.757068e-03 3 1  ON 35
ci_0037                -1.140985e-02 3 1  ON 36
ci_0038                -1.130663e-02 3 1  ON 37
ci_0039                -3.830831e-03 3 1  ON 38
ci_0040                -3.909103e-03 3 1  ON 39
ci_0041                 9.539571e-03 3 1  ON 40
ci_0042                 9.429703e-03 3 1  ON 41
ci_0043                -8.017732e-03 3 1  ON 42
ci_0044                -8.555072e-03 3 1  ON 43
ci_0045                 1.040993e-02 3 1  ON 44
ci_0046                 9.691034e-03 3 1  ON 45
ci_0047                -3.566809e-03 3 1  ON 46
ci_0048                -3.607763e-03 3 1  ON 47
ci_0049                -2.526593e-03 3 1  ON 48
ci_0050                -2.678924e-03 3 1  ON 49
ci_0051                -1.798427e-03 3 1  ON 50
ci_0052                -1.761082e-03 3 1  ON 51
ci_0053                -3.829514e-03 3 1  ON 52
ci_0054                -3.675994e-03 3 1  ON 53
ci_0055                 2.314674e-03 3 1  ON 54
ci_0056                 2.067350e-03 3 1  ON 55
ci_0057                 2.347938e-03 3 1  ON 56
ci_0058                 2.886491e-03 3 1  ON 57
ci_0059                -3.876302e-03 3 1  ON 58
ci_0060                -3.728231e-03 3 1  ON 59
ci_0061                -3.187910e-03 3 1  ON 60
ci_0062                -3.373291e-03 3 1  ON 61
ci_0063                -9.688629e-03 3 1  ON 62
ci_0064                -9.613121e-03 3 1  ON 63
ci_0065                -6.868505e-03 3 1  ON 64
ci_0066                -6.450767e-03 3 1  ON 65
ci_0067                -3.880906e-03 3 1  ON 66
ci_0068                -3.806857e-03 3 1  ON 67
ci_0069                 3.669291e-03 3 1  ON 68
ci_0070                 3.386297e-03 3 1  ON 69
ci_0071                 3.984495e-03 3 1  ON 70
ci_0072                 4.061154e-03 3 1  ON 71
ci_0073                 3.320087e-03 3 1  ON 72
ci_0074                 3.315222e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.413348
====================================================
  Execution time = 1.4658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9539e-01
  Total weights = 1.951076509e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283629588769
                                         uncertainty =       0.001773712744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283629588769
                                         uncertainty =       0.001773712744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376588209
  error estimate for blocks of size 2^( 2) =       0.000393550552
  error estimate for blocks of size 2^( 3) =       0.000411036042
  error estimate for blocks of size 2^( 4) =       0.000426819915
  error estimate for blocks of size 2^( 5) =       0.000439285426
  error estimate for blocks of size 2^( 6) =       0.000447709536
  error estimate for blocks of size 2^( 7) =       0.000450963788

      target function =      -0.919950109062
              le_mean =     -16.898850546958
             les_mean =     285.866539432942
             stat err =       0.000441194666
             autocorr =       1.372546514077
   target nu stat err =       0.000441194666
   target dn stat err =       0.002574701546
      target stat err =       0.004082016102
              std dev =       0.532576152153
             le_variance =       0.283637357842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689885054696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919966880970       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920184027340       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920243595619       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920276885326       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920291864023       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920295946777       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920299759989       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920300631721       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920301315376       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920301541390       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920301532772       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920302067490       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920302642314       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920302980943       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920302987669       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920303011996       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920302998976       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920303020665       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920303042007       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920303052960       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 1.179313e-03

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919966880970       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920029845342       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920046684044       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920055607276       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920059496775       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920060491642       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920061413335       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920061622961       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920061793841       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920061845244       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920061826240       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920061925312       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920062045634       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920062153369       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920062154706       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920062157444       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920062154916       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920062159584       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920062163432       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 3.210627e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919966880970       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919983277145       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919987628443       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919989898048       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919990878219       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919991124150       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919991351653       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919991403356       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919991445979       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919991458430       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919991452836       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919991476057       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919991507403       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919991532219       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919991532225       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919991532776       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919991532194       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919991533310       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919991534180       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 8.209498e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.938913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7256e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.033380e-01 3 1  ON 0
ci_0002                 6.977863e-01 3 1  ON 1
ci_0003                -3.141000e-02 3 1  ON 2
ci_0004                -3.126372e-02 3 1  ON 3
ci_0005                -2.918625e-02 3 1  ON 4
ci_0006                -3.004602e-02 3 1  ON 5
ci_0007                -1.565908e-02 3 1  ON 6
ci_0008                -1.624576e-02 3 1  ON 7
ci_0009                -1.875640e-02 3 1  ON 8
ci_0010                -1.882385e-02 3 1  ON 9
ci_0011                -1.539077e-02 3 1  ON 10
ci_0012                -1.552994e-02 3 1  ON 11
ci_0013                 1.536341e-02 3 1  ON 12
ci_0014                 1.533429e-02 3 1  ON 13
ci_0015                 1.611894e-02 3 1  ON 14
ci_0016                 1.584859e-02 3 1  ON 15
ci_0017                 1.369188e-02 3 1  ON 16
ci_0018                 1.387780e-02 3 1  ON 17
ci_0019                 1.262498e-02 3 1  ON 18
ci_0020                 1.237723e-02 3 1  ON 19
ci_0021                 1.275012e-02 3 1  ON 20
ci_0022                 1.425012e-02 3 1  ON 21
ci_0023                -1.179359e-02 3 1  ON 22
ci_0024                -1.119237e-02 3 1  ON 23
ci_0025                -2.631513e-03 3 1  ON 24
ci_0026                -2.342497e-03 3 1  ON 25
ci_0027                -1.175481e-02 3 1  ON 26
ci_0028                -1.170457e-02 3 1  ON 27
ci_0029                -1.054113e-02 3 1  ON 28
ci_0030                -1.043660e-02 3 1  ON 29
ci_0031                 1.379902e-02 3 1  ON 30
ci_0032                 1.282414e-02 3 1  ON 31
ci_0033                 8.233205e-03 3 1  ON 32
ci_0034                 8.498625e-03 3 1  ON 33
ci_0035                 4.894311e-03 3 1  ON 34
ci_0036                 4.768558e-03 3 1  ON 35
ci_0037                -1.140201e-02 3 1  ON 36
ci_0038                -1.136565e-02 3 1  ON 37
ci_0039                -3.823711e-03 3 1  ON 38
ci_0040                -3.925968e-03 3 1  ON 39
ci_0041                 9.536487e-03 3 1  ON 40
ci_0042                 9.392377e-03 3 1  ON 41
ci_0043                -8.257398e-03 3 1  ON 42
ci_0044                -8.759016e-03 3 1  ON 43
ci_0045                 1.038506e-02 3 1  ON 44
ci_0046                 9.686859e-03 3 1  ON 45
ci_0047                -3.574754e-03 3 1  ON 46
ci_0048                -3.593517e-03 3 1  ON 47
ci_0049                -2.457168e-03 3 1  ON 48
ci_0050                -2.672690e-03 3 1  ON 49
ci_0051                -1.782046e-03 3 1  ON 50
ci_0052                -1.807540e-03 3 1  ON 51
ci_0053                -3.849925e-03 3 1  ON 52
ci_0054                -3.626552e-03 3 1  ON 53
ci_0055                 2.307291e-03 3 1  ON 54
ci_0056                 2.141880e-03 3 1  ON 55
ci_0057                 2.451929e-03 3 1  ON 56
ci_0058                 2.817062e-03 3 1  ON 57
ci_0059                -3.816420e-03 3 1  ON 58
ci_0060                -3.631053e-03 3 1  ON 59
ci_0061                -3.234411e-03 3 1  ON 60
ci_0062                -3.436637e-03 3 1  ON 61
ci_0063                -9.681854e-03 3 1  ON 62
ci_0064                -9.618311e-03 3 1  ON 63
ci_0065                -6.840179e-03 3 1  ON 64
ci_0066                -6.485048e-03 3 1  ON 65
ci_0067                -3.892440e-03 3 1  ON 66
ci_0068                -3.783348e-03 3 1  ON 67
ci_0069                 3.650815e-03 3 1  ON 68
ci_0070                 3.306745e-03 3 1  ON 69
ci_0071                 3.978641e-03 3 1  ON 70
ci_0072                 3.954093e-03 3 1  ON 71
ci_0073                 3.334303e-03 3 1  ON 72
ci_0074                 3.386477e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.9493
    reference variance = 0.438209
====================================================
  Execution time = 1.4170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9178e-01
  Total weights = 1.9509e+06
  Execution time = 1.8900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282319658339
                                         uncertainty =       0.001803960148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282319658339
                                         uncertainty =       0.001803960148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375698710
  error estimate for blocks of size 2^( 2) =       0.000393139278
  error estimate for blocks of size 2^( 3) =       0.000410254439
  error estimate for blocks of size 2^( 4) =       0.000425240113
  error estimate for blocks of size 2^( 5) =       0.000437674866
  error estimate for blocks of size 2^( 6) =       0.000444724951
  error estimate for blocks of size 2^( 7) =       0.000450134341

      target function =      -0.925104188021
              le_mean =     -16.897941626224
             les_mean =     285.832528659410
             stat err =       0.000439443568
             autocorr =       1.368128270757
   target nu stat err =       0.000439443568
   target dn stat err =       0.002365585904
      target stat err =       0.003796552042
              std dev =       0.531318210540
             le_variance =       0.282299040851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281978629427
                                         uncertainty =       0.001775073128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281978629427
                                         uncertainty =       0.001775073128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375471005
  error estimate for blocks of size 2^( 2) =       0.000392888953
  error estimate for blocks of size 2^( 3) =       0.000409967556
  error estimate for blocks of size 2^( 4) =       0.000424907396
  error estimate for blocks of size 2^( 5) =       0.000437299650
  error estimate for blocks of size 2^( 6) =       0.000444345942
  error estimate for blocks of size 2^( 7) =       0.000449766330

      target function =      -0.925883112362
              le_mean =     -16.897951969391
             les_mean =     285.832383748731
             stat err =       0.000439079830
             autocorr =       1.367521500598
   target nu stat err =       0.000439079830
   target dn stat err =       0.002354771503
      target stat err =       0.003786062777
              std dev =       0.530996187829
             le_variance =       0.281956951488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282115874414
                                         uncertainty =       0.001787246366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282115874414
                                         uncertainty =       0.001787246366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375562709
  error estimate for blocks of size 2^( 2) =       0.000392990990
  error estimate for blocks of size 2^( 3) =       0.000410085590
  error estimate for blocks of size 2^( 4) =       0.000425045862
  error estimate for blocks of size 2^( 5) =       0.000437456857
  error estimate for blocks of size 2^( 6) =       0.000444505272
  error estimate for blocks of size 2^( 7) =       0.000449921606

      target function =      -0.925593198927
              le_mean =     -16.897945473920
             les_mean =     285.832348206141
             stat err =       0.000439232399
             autocorr =       1.367803806525
   target nu stat err =       0.000439232399
   target dn stat err =       0.002351373040
      target stat err =       0.003778496708
              std dev =       0.531125877111
             le_variance =       0.282094697337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282291355482
                                         uncertainty =       0.001801739789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282291355482
                                         uncertainty =       0.001801739789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375679829
  error estimate for blocks of size 2^( 2) =       0.000393118819
  error estimate for blocks of size 2^( 3) =       0.000410231198
  error estimate for blocks of size 2^( 4) =       0.000425213615
  error estimate for blocks of size 2^( 5) =       0.000437645394
  error estimate for blocks of size 2^( 6) =       0.000444695213
  error estimate for blocks of size 2^( 7) =       0.000450105484

      target function =      -0.925268587139
              le_mean =     -16.897941797022
             les_mean =     285.832430021576
             stat err =       0.000439414927
             autocorr =       1.368087441794
   target nu stat err =       0.000439414927
   target dn stat err =       0.002358778076
      target stat err =       0.003787360938
              std dev =       0.531291508879
             le_variance =       0.282270667407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925104188021        initial
     3.5527e-01     3.5527e+00             1.1793e-03        -0.925883112362  <--
     1.4211e+00     1.4211e+01             3.2106e-04        -0.925593198927
     5.6843e+00     5.6843e+01             8.2095e-05        -0.925268587139

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 2.3720e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.039174e-01 3 1  ON 0
ci_0002                 6.972517e-01 3 1  ON 1
ci_0003                -3.124834e-02 3 1  ON 2
ci_0004                -3.107894e-02 3 1  ON 3
ci_0005                -2.950523e-02 3 1  ON 4
ci_0006                -2.996116e-02 3 1  ON 5
ci_0007                -1.546589e-02 3 1  ON 6
ci_0008                -1.600253e-02 3 1  ON 7
ci_0009                -1.885916e-02 3 1  ON 8
ci_0010                -1.872089e-02 3 1  ON 9
ci_0011                -1.531003e-02 3 1  ON 10
ci_0012                -1.539986e-02 3 1  ON 11
ci_0013                 1.520558e-02 3 1  ON 12
ci_0014                 1.526617e-02 3 1  ON 13
ci_0015                 1.598590e-02 3 1  ON 14
ci_0016                 1.577921e-02 3 1  ON 15
ci_0017                 1.364536e-02 3 1  ON 16
ci_0018                 1.391760e-02 3 1  ON 17
ci_0019                 1.266350e-02 3 1  ON 18
ci_0020                 1.252552e-02 3 1  ON 19
ci_0021                 1.199520e-02 3 1  ON 20
ci_0022                 1.339187e-02 3 1  ON 21
ci_0023                -1.178081e-02 3 1  ON 22
ci_0024                -1.132008e-02 3 1  ON 23
ci_0025                -2.378593e-03 3 1  ON 24
ci_0026                -2.211690e-03 3 1  ON 25
ci_0027                -1.178842e-02 3 1  ON 26
ci_0028                -1.164484e-02 3 1  ON 27
ci_0029                -1.062670e-02 3 1  ON 28
ci_0030                -1.050057e-02 3 1  ON 29
ci_0031                 1.370023e-02 3 1  ON 30
ci_0032                 1.272325e-02 3 1  ON 31
ci_0033                 8.317975e-03 3 1  ON 32
ci_0034                 8.386122e-03 3 1  ON 33
ci_0035                 5.087402e-03 3 1  ON 34
ci_0036                 4.794453e-03 3 1  ON 35
ci_0037                -1.138190e-02 3 1  ON 36
ci_0038                -1.151589e-02 3 1  ON 37
ci_0039                -3.806774e-03 3 1  ON 38
ci_0040                -3.967294e-03 3 1  ON 39
ci_0041                 9.529204e-03 3 1  ON 40
ci_0042                 9.294550e-03 3 1  ON 41
ci_0043                -8.896486e-03 3 1  ON 42
ci_0044                -9.299731e-03 3 1  ON 43
ci_0045                 1.032041e-02 3 1  ON 44
ci_0046                 9.674076e-03 3 1  ON 45
ci_0047                -3.594996e-03 3 1  ON 46
ci_0048                -3.557659e-03 3 1  ON 47
ci_0049                -2.286691e-03 3 1  ON 48
ci_0050                -2.657225e-03 3 1  ON 49
ci_0051                -1.742195e-03 3 1  ON 50
ci_0052                -1.920157e-03 3 1  ON 51
ci_0053                -3.900196e-03 3 1  ON 52
ci_0054                -3.504673e-03 3 1  ON 53
ci_0055                 2.289514e-03 3 1  ON 54
ci_0056                 2.323448e-03 3 1  ON 55
ci_0057                 2.705684e-03 3 1  ON 56
ci_0058                 2.645252e-03 3 1  ON 57
ci_0059                -3.669616e-03 3 1  ON 58
ci_0060                -3.395078e-03 3 1  ON 59
ci_0061                -3.353033e-03 3 1  ON 60
ci_0062                -3.596400e-03 3 1  ON 61
ci_0063                -9.665099e-03 3 1  ON 62
ci_0064                -9.628206e-03 3 1  ON 63
ci_0065                -6.769013e-03 3 1  ON 64
ci_0066                -6.571635e-03 3 1  ON 65
ci_0067                -3.921199e-03 3 1  ON 66
ci_0068                -3.725121e-03 3 1  ON 67
ci_0069                 3.606494e-03 3 1  ON 68
ci_0070                 3.110634e-03 3 1  ON 69
ci_0071                 3.965805e-03 3 1  ON 70
ci_0072                 3.690527e-03 3 1  ON 71
ci_0073                 3.369212e-03 3 1  ON 72
ci_0074                 3.557765e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9094
    reference variance = 0.174663
====================================================
  Execution time = 1.4485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9194e-01
  Total weights = 1.951427932e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282528796342
                                         uncertainty =       0.001826124139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282528796342
                                         uncertainty =       0.001826124139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375821746
  error estimate for blocks of size 2^( 2) =       0.000393172410
  error estimate for blocks of size 2^( 3) =       0.000411664337
  error estimate for blocks of size 2^( 4) =       0.000427371056
  error estimate for blocks of size 2^( 5) =       0.000439867656
  error estimate for blocks of size 2^( 6) =       0.000450098616
  error estimate for blocks of size 2^( 7) =       0.000455334315

      target function =      -0.925355373139
              le_mean =     -16.898100653951
             les_mean =     285.837747416740
             stat err =       0.000443167910
             autocorr =       1.390505786770
   target nu stat err =       0.000443167910
   target dn stat err =       0.002012247543
      target stat err =       0.003257416277
              std dev =       0.531492209842
             le_variance =       0.282483969122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689810065395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925365378692       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925579988972       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925631889618       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925673971056       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925703963687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925712361171       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925715682433       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925715937741       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925716268333       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925716372048       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925716493211       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925716670390       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925716729960       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925717281363       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925717243652       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925716957930       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925716903870       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925716795914       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925716733664       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925716712074       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925716704614       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 2.201286e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925365378692       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925447670339       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925466296258       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925480077001       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925488775798       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925490892550       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925491742149       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925491768949       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925491839830       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925491845970       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925491885225       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925491938970       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925491941219       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925492041899       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925491998560       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925491933248       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925491926586       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925491912946       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925491906579       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 7.336464e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925365378692       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925389119036       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925394337227       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925398048913       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925400271123       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925400781450       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925400988306       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925400990912       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925401007160       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925401006826       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925401017709       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925401031631       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925401030007       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925401050226       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925401037971       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925401023974       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925401023046       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925401020573       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 2.000913e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.951140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7058e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.037715e-01 3 1  ON 0
ci_0002                 6.974374e-01 3 1  ON 1
ci_0003                -3.115430e-02 3 1  ON 2
ci_0004                -3.098200e-02 3 1  ON 3
ci_0005                -2.939337e-02 3 1  ON 4
ci_0006                -3.019358e-02 3 1  ON 5
ci_0007                -1.547923e-02 3 1  ON 6
ci_0008                -1.573185e-02 3 1  ON 7
ci_0009                -1.868317e-02 3 1  ON 8
ci_0010                -1.864865e-02 3 1  ON 9
ci_0011                -1.533271e-02 3 1  ON 10
ci_0012                -1.527464e-02 3 1  ON 11
ci_0013                 1.521158e-02 3 1  ON 12
ci_0014                 1.519205e-02 3 1  ON 13
ci_0015                 1.585399e-02 3 1  ON 14
ci_0016                 1.563200e-02 3 1  ON 15
ci_0017                 1.357021e-02 3 1  ON 16
ci_0018                 1.394201e-02 3 1  ON 17
ci_0019                 1.276258e-02 3 1  ON 18
ci_0020                 1.259335e-02 3 1  ON 19
ci_0021                 1.144393e-02 3 1  ON 20
ci_0022                 1.281812e-02 3 1  ON 21
ci_0023                -1.179882e-02 3 1  ON 22
ci_0024                -1.134806e-02 3 1  ON 23
ci_0025                -2.385355e-03 3 1  ON 24
ci_0026                -2.198575e-03 3 1  ON 25
ci_0027                -1.184405e-02 3 1  ON 26
ci_0028                -1.156185e-02 3 1  ON 27
ci_0029                -1.063260e-02 3 1  ON 28
ci_0030                -1.044069e-02 3 1  ON 29
ci_0031                 1.366153e-02 3 1  ON 30
ci_0032                 1.255401e-02 3 1  ON 31
ci_0033                 8.070932e-03 3 1  ON 32
ci_0034                 8.328655e-03 3 1  ON 33
ci_0035                 5.088576e-03 3 1  ON 34
ci_0036                 4.842224e-03 3 1  ON 35
ci_0037                -1.135557e-02 3 1  ON 36
ci_0038                -1.149401e-02 3 1  ON 37
ci_0039                -3.798365e-03 3 1  ON 38
ci_0040                -3.926966e-03 3 1  ON 39
ci_0041                 9.450517e-03 3 1  ON 40
ci_0042                 9.248044e-03 3 1  ON 41
ci_0043                -9.630132e-03 3 1  ON 42
ci_0044                -1.001372e-02 3 1  ON 43
ci_0045                 1.028233e-02 3 1  ON 44
ci_0046                 9.880543e-03 3 1  ON 45
ci_0047                -3.551029e-03 3 1  ON 46
ci_0048                -3.585854e-03 3 1  ON 47
ci_0049                -2.503645e-03 3 1  ON 48
ci_0050                -2.814760e-03 3 1  ON 49
ci_0051                -1.753272e-03 3 1  ON 50
ci_0052                -1.960133e-03 3 1  ON 51
ci_0053                -3.742945e-03 3 1  ON 52
ci_0054                -3.389680e-03 3 1  ON 53
ci_0055                 2.203000e-03 3 1  ON 54
ci_0056                 2.376242e-03 3 1  ON 55
ci_0057                 2.885666e-03 3 1  ON 56
ci_0058                 2.348925e-03 3 1  ON 57
ci_0059                -3.692828e-03 3 1  ON 58
ci_0060                -3.367954e-03 3 1  ON 59
ci_0061                -3.428333e-03 3 1  ON 60
ci_0062                -3.598278e-03 3 1  ON 61
ci_0063                -9.554495e-03 3 1  ON 62
ci_0064                -9.636016e-03 3 1  ON 63
ci_0065                -6.662269e-03 3 1  ON 64
ci_0066                -6.553972e-03 3 1  ON 65
ci_0067                -3.990667e-03 3 1  ON 66
ci_0068                -3.640037e-03 3 1  ON 67
ci_0069                 3.474161e-03 3 1  ON 68
ci_0070                 3.293278e-03 3 1  ON 69
ci_0071                 3.688355e-03 3 1  ON 70
ci_0072                 3.618427e-03 3 1  ON 71
ci_0073                 3.394857e-03 3 1  ON 72
ci_0074                 3.537869e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.8952
    reference variance = 0.280616
====================================================
  Execution time = 1.6409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9178e-01
  Total weights = 1.9508e+06
  Execution time = 1.9164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282954626943
                                         uncertainty =       0.001905996207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282954626943
                                         uncertainty =       0.001905996207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376072862
  error estimate for blocks of size 2^( 2) =       0.000393109670
  error estimate for blocks of size 2^( 3) =       0.000410286577
  error estimate for blocks of size 2^( 4) =       0.000425739668
  error estimate for blocks of size 2^( 5) =       0.000436995123
  error estimate for blocks of size 2^( 6) =       0.000443254804
  error estimate for blocks of size 2^( 7) =       0.000447755788

      target function =      -0.923711214204
              le_mean =     -16.898200121122
             les_mean =     285.842152572281
             stat err =       0.000438436346
             autocorr =       1.359155382061
   target nu stat err =       0.000438436346
   target dn stat err =       0.002383961115
      target stat err =       0.003815093023
              std dev =       0.531847341407
             le_variance =       0.282861594561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282970221135
                                         uncertainty =       0.001905810924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282970221135
                                         uncertainty =       0.001905810924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376082865
  error estimate for blocks of size 2^( 2) =       0.000393060060
  error estimate for blocks of size 2^( 3) =       0.000410170514
  error estimate for blocks of size 2^( 4) =       0.000425511981
  error estimate for blocks of size 2^( 5) =       0.000436775266
  error estimate for blocks of size 2^( 6) =       0.000443043578
  error estimate for blocks of size 2^( 7) =       0.000447577612

      target function =      -0.875313006553
              le_mean =     -16.898228182883
             les_mean =     285.874400704409
             stat err =       0.000438227109
             autocorr =       1.357786187336
   target nu stat err =       0.000438227109
   target dn stat err =       0.027844504895
      target stat err =       0.039329539858
              std dev =       0.531861488115
             le_variance =       0.282876642540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282718374125
                                         uncertainty =       0.001910457078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282718374125
                                         uncertainty =       0.001910457078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375915908
  error estimate for blocks of size 2^( 2) =       0.000392927513
  error estimate for blocks of size 2^( 3) =       0.000410063885
  error estimate for blocks of size 2^( 4) =       0.000425462924
  error estimate for blocks of size 2^( 5) =       0.000436721706
  error estimate for blocks of size 2^( 6) =       0.000442979707
  error estimate for blocks of size 2^( 7) =       0.000447485947

      target function =      -0.924769501413
              le_mean =     -16.898203972803
             les_mean =     285.841609888766
             stat err =       0.000438162571
             autocorr =       1.358592282428
   target nu stat err =       0.000438162571
   target dn stat err =       0.002302015401
      target stat err =       0.003697253384
              std dev =       0.531625375293
             le_variance =       0.282625539655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282912194085
                                         uncertainty =       0.001906478138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282912194085
                                         uncertainty =       0.001906478138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376044677
  error estimate for blocks of size 2^( 2) =       0.000393078165
  error estimate for blocks of size 2^( 3) =       0.000410249779
  error estimate for blocks of size 2^( 4) =       0.000425695673
  error estimate for blocks of size 2^( 5) =       0.000436951617
  error estimate for blocks of size 2^( 6) =       0.000443213237
  error estimate for blocks of size 2^( 7) =       0.000447717017

      target function =      -0.918142555389
              le_mean =     -16.898198426060
             les_mean =     285.845640913013
             stat err =       0.000438394386
             autocorr =       1.359098947792
   target nu stat err =       0.000438394386
   target dn stat err =       0.004463650271
      target stat err =       0.006961279779
              std dev =       0.531807482584
             le_variance =       0.282819198532


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923711214204        initial
     8.8818e-02     8.8818e-01             2.2013e-03        -0.875313006553
     3.5527e-01     3.5527e+00             7.3365e-04        -0.924769501413  <--
     1.4211e+00     1.4211e+01             2.0009e-04        -0.918142555389

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 2.5952e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.037715e-01 3 1  ON 0
ci_0002                 6.974374e-01 3 1  ON 1
ci_0003                -3.115430e-02 3 1  ON 2
ci_0004                -3.098200e-02 3 1  ON 3
ci_0005                -2.939337e-02 3 1  ON 4
ci_0006                -3.019358e-02 3 1  ON 5
ci_0007                -1.547923e-02 3 1  ON 6
ci_0008                -1.573185e-02 3 1  ON 7
ci_0009                -1.868317e-02 3 1  ON 8
ci_0010                -1.864865e-02 3 1  ON 9
ci_0011                -1.533271e-02 3 1  ON 10
ci_0012                -1.527464e-02 3 1  ON 11
ci_0013                 1.521158e-02 3 1  ON 12
ci_0014                 1.519205e-02 3 1  ON 13
ci_0015                 1.585399e-02 3 1  ON 14
ci_0016                 1.563200e-02 3 1  ON 15
ci_0017                 1.357021e-02 3 1  ON 16
ci_0018                 1.394201e-02 3 1  ON 17
ci_0019                 1.276258e-02 3 1  ON 18
ci_0020                 1.259335e-02 3 1  ON 19
ci_0021                 1.144393e-02 3 1  ON 20
ci_0022                 1.281812e-02 3 1  ON 21
ci_0023                -1.179882e-02 3 1  ON 22
ci_0024                -1.134806e-02 3 1  ON 23
ci_0025                -2.385355e-03 3 1  ON 24
ci_0026                -2.198575e-03 3 1  ON 25
ci_0027                -1.184405e-02 3 1  ON 26
ci_0028                -1.156185e-02 3 1  ON 27
ci_0029                -1.063260e-02 3 1  ON 28
ci_0030                -1.044069e-02 3 1  ON 29
ci_0031                 1.366153e-02 3 1  ON 30
ci_0032                 1.255401e-02 3 1  ON 31
ci_0033                 8.070932e-03 3 1  ON 32
ci_0034                 8.328655e-03 3 1  ON 33
ci_0035                 5.088576e-03 3 1  ON 34
ci_0036                 4.842224e-03 3 1  ON 35
ci_0037                -1.135557e-02 3 1  ON 36
ci_0038                -1.149401e-02 3 1  ON 37
ci_0039                -3.798365e-03 3 1  ON 38
ci_0040                -3.926966e-03 3 1  ON 39
ci_0041                 9.450517e-03 3 1  ON 40
ci_0042                 9.248044e-03 3 1  ON 41
ci_0043                -9.630132e-03 3 1  ON 42
ci_0044                -1.001372e-02 3 1  ON 43
ci_0045                 1.028233e-02 3 1  ON 44
ci_0046                 9.880543e-03 3 1  ON 45
ci_0047                -3.551029e-03 3 1  ON 46
ci_0048                -3.585854e-03 3 1  ON 47
ci_0049                -2.503645e-03 3 1  ON 48
ci_0050                -2.814760e-03 3 1  ON 49
ci_0051                -1.753272e-03 3 1  ON 50
ci_0052                -1.960133e-03 3 1  ON 51
ci_0053                -3.742945e-03 3 1  ON 52
ci_0054                -3.389680e-03 3 1  ON 53
ci_0055                 2.203000e-03 3 1  ON 54
ci_0056                 2.376242e-03 3 1  ON 55
ci_0057                 2.885666e-03 3 1  ON 56
ci_0058                 2.348925e-03 3 1  ON 57
ci_0059                -3.692828e-03 3 1  ON 58
ci_0060                -3.367954e-03 3 1  ON 59
ci_0061                -3.428333e-03 3 1  ON 60
ci_0062                -3.598278e-03 3 1  ON 61
ci_0063                -9.554495e-03 3 1  ON 62
ci_0064                -9.636016e-03 3 1  ON 63
ci_0065                -6.662269e-03 3 1  ON 64
ci_0066                -6.553972e-03 3 1  ON 65
ci_0067                -3.990667e-03 3 1  ON 66
ci_0068                -3.640037e-03 3 1  ON 67
ci_0069                 3.474161e-03 3 1  ON 68
ci_0070                 3.293278e-03 3 1  ON 69
ci_0071                 3.688355e-03 3 1  ON 70
ci_0072                 3.618427e-03 3 1  ON 71
ci_0073                 3.394857e-03 3 1  ON 72
ci_0074                 3.537869e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.223396
====================================================
  Execution time = 1.4516e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9019e-01
  Total weights = 1.950914763e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280628070277
                                         uncertainty =       0.001568810418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280628070277
                                         uncertainty =       0.001568810418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374583324
  error estimate for blocks of size 2^( 2) =       0.000392040579
  error estimate for blocks of size 2^( 3) =       0.000409595585
  error estimate for blocks of size 2^( 4) =       0.000425994809
  error estimate for blocks of size 2^( 5) =       0.000438855839
  error estimate for blocks of size 2^( 6) =       0.000445889669
  error estimate for blocks of size 2^( 7) =       0.000447047714

      target function =      -0.928138764659
              le_mean =     -16.898929216400
             les_mean =     285.863995056135
             stat err =       0.000439447008
             autocorr =       1.376309615500
   target nu stat err =       0.000439447008
   target dn stat err =       0.002120712776
      target stat err =       0.003447811754
              std dev =       0.529740817680
             le_variance =       0.280625333917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689892921640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928150106216       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928465310470       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928522480500       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928583528979       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928602659449       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928610970540       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928612612994       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928613535437       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928613667282       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928614896956       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928616564705       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928617656981       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928618836558       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928617633176       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928617461583       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928617233198       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928617298698       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928617229808       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928617318749       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928617336338       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928617299727       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 3.370332e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928150106216       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928272295669       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928292723934       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928312561877       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928317982968       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928320039459       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928320387847       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928320635067       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928320644180       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928320967318       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928321431403       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928321632611       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928321709001       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928321414484       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928321374377       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928321353110       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928321355572       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928321356054       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928321358846       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 1.111192e-03

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928150106216       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928185528067       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928191236495       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928196562722       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928197932794       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928198423262       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928198501256       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928198563448       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928198563213       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928198643800       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928198760762       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928198796662       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928198798068       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928198733452       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928198724653       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928198721991       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928198722158       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928198722576       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 3.019751e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.963414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7112e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.042344e-01 3 1  ON 0
ci_0002                 6.969848e-01 3 1  ON 1
ci_0003                -3.113088e-02 3 1  ON 2
ci_0004                -3.095481e-02 3 1  ON 3
ci_0005                -2.973514e-02 3 1  ON 4
ci_0006                -3.042662e-02 3 1  ON 5
ci_0007                -1.524887e-02 3 1  ON 6
ci_0008                -1.561387e-02 3 1  ON 7
ci_0009                -1.863853e-02 3 1  ON 8
ci_0010                -1.845572e-02 3 1  ON 9
ci_0011                -1.519760e-02 3 1  ON 10
ci_0012                -1.530488e-02 3 1  ON 11
ci_0013                 1.529418e-02 3 1  ON 12
ci_0014                 1.517407e-02 3 1  ON 13
ci_0015                 1.593392e-02 3 1  ON 14
ci_0016                 1.562163e-02 3 1  ON 15
ci_0017                 1.346194e-02 3 1  ON 16
ci_0018                 1.373857e-02 3 1  ON 17
ci_0019                 1.279474e-02 3 1  ON 18
ci_0020                 1.265594e-02 3 1  ON 19
ci_0021                 1.033274e-02 3 1  ON 20
ci_0022                 1.227250e-02 3 1  ON 21
ci_0023                -1.182686e-02 3 1  ON 22
ci_0024                -1.145961e-02 3 1  ON 23
ci_0025                -2.161181e-03 3 1  ON 24
ci_0026                -2.443977e-03 3 1  ON 25
ci_0027                -1.186216e-02 3 1  ON 26
ci_0028                -1.157700e-02 3 1  ON 27
ci_0029                -1.057483e-02 3 1  ON 28
ci_0030                -1.042623e-02 3 1  ON 29
ci_0031                 1.357869e-02 3 1  ON 30
ci_0032                 1.251778e-02 3 1  ON 31
ci_0033                 8.308278e-03 3 1  ON 32
ci_0034                 8.287796e-03 3 1  ON 33
ci_0035                 4.894705e-03 3 1  ON 34
ci_0036                 4.685384e-03 3 1  ON 35
ci_0037                -1.134138e-02 3 1  ON 36
ci_0038                -1.146856e-02 3 1  ON 37
ci_0039                -3.862493e-03 3 1  ON 38
ci_0040                -3.963224e-03 3 1  ON 39
ci_0041                 9.332747e-03 3 1  ON 40
ci_0042                 9.220041e-03 3 1  ON 41
ci_0043                -1.015753e-02 3 1  ON 42
ci_0044                -1.051930e-02 3 1  ON 43
ci_0045                 1.031478e-02 3 1  ON 44
ci_0046                 9.941618e-03 3 1  ON 45
ci_0047                -3.577656e-03 3 1  ON 46
ci_0048                -3.552246e-03 3 1  ON 47
ci_0049                -2.071682e-03 3 1  ON 48
ci_0050                -2.841813e-03 3 1  ON 49
ci_0051                -1.722566e-03 3 1  ON 50
ci_0052                -1.910712e-03 3 1  ON 51
ci_0053                -3.689874e-03 3 1  ON 52
ci_0054                -3.531405e-03 3 1  ON 53
ci_0055                 2.413295e-03 3 1  ON 54
ci_0056                 2.034387e-03 3 1  ON 55
ci_0057                 2.849048e-03 3 1  ON 56
ci_0058                 2.381398e-03 3 1  ON 57
ci_0059                -3.619377e-03 3 1  ON 58
ci_0060                -3.446419e-03 3 1  ON 59
ci_0061                -3.403153e-03 3 1  ON 60
ci_0062                -3.486757e-03 3 1  ON 61
ci_0063                -9.476751e-03 3 1  ON 62
ci_0064                -9.618773e-03 3 1  ON 63
ci_0065                -6.636689e-03 3 1  ON 64
ci_0066                -6.593109e-03 3 1  ON 65
ci_0067                -4.060491e-03 3 1  ON 66
ci_0068                -3.598341e-03 3 1  ON 67
ci_0069                 3.419127e-03 3 1  ON 68
ci_0070                 3.376127e-03 3 1  ON 69
ci_0071                 3.779288e-03 3 1  ON 70
ci_0072                 3.453711e-03 3 1  ON 71
ci_0073                 3.528794e-03 3 1  ON 72
ci_0074                 3.454610e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.92
    reference variance = 0.150425
====================================================
  Execution time = 1.4106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9766e-01
  Total weights = 1.9511e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286825708947
                                         uncertainty =       0.002833357717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286825708947
                                         uncertainty =       0.002833357717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378677150
  error estimate for blocks of size 2^( 2) =       0.000394903308
  error estimate for blocks of size 2^( 3) =       0.000411876407
  error estimate for blocks of size 2^( 4) =       0.000427057779
  error estimate for blocks of size 2^( 5) =       0.000437929020
  error estimate for blocks of size 2^( 6) =       0.000446339701
  error estimate for blocks of size 2^( 7) =       0.000448603454

      target function =      -0.914620292161
              le_mean =     -16.898758489738
             les_mean =     285.866858262151
             stat err =       0.000439982488
             autocorr =       1.349996313565
   target nu stat err =       0.000439982488
   target dn stat err =       0.003608390669
      target stat err =       0.005607474361
              std dev =       0.535530361922
             le_variance =       0.286792768540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286610808205
                                         uncertainty =       0.002888994963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286610808205
                                         uncertainty =       0.002888994963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378534405
  error estimate for blocks of size 2^( 2) =       0.000394721263
  error estimate for blocks of size 2^( 3) =       0.000411627298
  error estimate for blocks of size 2^( 4) =       0.000426768981
  error estimate for blocks of size 2^( 5) =       0.000437576614
  error estimate for blocks of size 2^( 6) =       0.000445956467
  error estimate for blocks of size 2^( 7) =       0.000448130762

      target function =      -0.915647965804
              le_mean =     -16.898773212618
             les_mean =     285.866688958536
             stat err =       0.000439608206
             autocorr =       1.348717103933
   target nu stat err =       0.000439608206
   target dn stat err =       0.003641686403
      target stat err =       0.005671005379
              std dev =       0.535328488745
             le_variance =       0.286576590863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286642605561
                                         uncertainty =       0.002876795558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286642605561
                                         uncertainty =       0.002876795558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378555711
  error estimate for blocks of size 2^( 2) =       0.000394756948
  error estimate for blocks of size 2^( 3) =       0.000411684310
  error estimate for blocks of size 2^( 4) =       0.000426841294
  error estimate for blocks of size 2^( 5) =       0.000437667755
  error estimate for blocks of size 2^( 6) =       0.000446058876
  error estimate for blocks of size 2^( 7) =       0.000448258946

      target function =      -0.915038907693
              le_mean =     -16.898759650114
             les_mean =     285.866625320870
             stat err =       0.000439706718
             autocorr =       1.349169754281
   target nu stat err =       0.000439706718
   target dn stat err =       0.003651746111
      target stat err =       0.005678786377
              std dev =       0.535358620508
             le_variance =       0.286608852553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286786771889
                                         uncertainty =       0.002839009780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286786771889
                                         uncertainty =       0.002839009780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378651378
  error estimate for blocks of size 2^( 2) =       0.000394874550
  error estimate for blocks of size 2^( 3) =       0.000411841373
  error estimate for blocks of size 2^( 4) =       0.000427019782
  error estimate for blocks of size 2^( 5) =       0.000437884125
  error estimate for blocks of size 2^( 6) =       0.000446292137
  error estimate for blocks of size 2^( 7) =       0.000448546114

      target function =      -0.914944081274
              le_mean =     -16.898756356771
             les_mean =     285.866576377667
             stat err =       0.000439935540
             autocorr =       1.349891960392
   target nu stat err =       0.000439935540
   target dn stat err =       0.003581657491
      target stat err =       0.005570530629
              std dev =       0.535493914427
             le_variance =       0.286753732388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914620292161        initial
     8.8818e-02     8.8818e-01             3.3703e-03        -0.915647965804  <--
     3.5527e-01     3.5527e+00             1.1112e-03        -0.915038907693
     1.4211e+00     1.4211e+01             3.0198e-04        -0.914944081274

*****************************************************************************
Applying the update for shift_i =   8.8818e-02     and shift_s =   8.8818e-01
*****************************************************************************

  Execution time = 2.3640e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.056354e-01 3 1  ON 0
ci_0002                 6.956039e-01 3 1  ON 1
ci_0003                -3.110694e-02 3 1  ON 2
ci_0004                -3.087679e-02 3 1  ON 3
ci_0005                -3.036486e-02 3 1  ON 4
ci_0006                -3.082247e-02 3 1  ON 5
ci_0007                -1.475512e-02 3 1  ON 6
ci_0008                -1.536420e-02 3 1  ON 7
ci_0009                -1.857791e-02 3 1  ON 8
ci_0010                -1.810750e-02 3 1  ON 9
ci_0011                -1.495968e-02 3 1  ON 10
ci_0012                -1.533829e-02 3 1  ON 11
ci_0013                 1.545821e-02 3 1  ON 12
ci_0014                 1.512899e-02 3 1  ON 13
ci_0015                 1.608700e-02 3 1  ON 14
ci_0016                 1.559327e-02 3 1  ON 15
ci_0017                 1.328594e-02 3 1  ON 16
ci_0018                 1.337297e-02 3 1  ON 17
ci_0019                 1.286036e-02 3 1  ON 18
ci_0020                 1.274791e-02 3 1  ON 19
ci_0021                 8.073596e-03 3 1  ON 20
ci_0022                 1.118663e-02 3 1  ON 21
ci_0023                -1.188720e-02 3 1  ON 22
ci_0024                -1.164385e-02 3 1  ON 23
ci_0025                -1.817377e-03 3 1  ON 24
ci_0026                -2.825257e-03 3 1  ON 25
ci_0027                -1.189987e-02 3 1  ON 26
ci_0028                -1.159397e-02 3 1  ON 27
ci_0029                -1.048457e-02 3 1  ON 28
ci_0030                -1.039586e-02 3 1  ON 29
ci_0031                 1.341273e-02 3 1  ON 30
ci_0032                 1.243087e-02 3 1  ON 31
ci_0033                 8.786276e-03 3 1  ON 32
ci_0034                 8.206490e-03 3 1  ON 33
ci_0035                 4.576227e-03 3 1  ON 34
ci_0036                 4.429841e-03 3 1  ON 35
ci_0037                -1.132322e-02 3 1  ON 36
ci_0038                -1.141379e-02 3 1  ON 37
ci_0039                -3.972073e-03 3 1  ON 38
ci_0040                -4.018442e-03 3 1  ON 39
ci_0041                 9.124890e-03 3 1  ON 40
ci_0042                 9.160338e-03 3 1  ON 41
ci_0043                -1.117705e-02 3 1  ON 42
ci_0044                -1.151315e-02 3 1  ON 43
ci_0045                 1.038227e-02 3 1  ON 44
ci_0046                 1.004823e-02 3 1  ON 45
ci_0047                -3.624017e-03 3 1  ON 46
ci_0048                -3.494654e-03 3 1  ON 47
ci_0049                -1.386478e-03 3 1  ON 48
ci_0050                -2.878022e-03 3 1  ON 49
ci_0051                -1.673798e-03 3 1  ON 50
ci_0052                -1.829108e-03 3 1  ON 51
ci_0053                -3.606434e-03 3 1  ON 52
ci_0054                -3.753714e-03 3 1  ON 53
ci_0055                 2.732275e-03 3 1  ON 54
ci_0056                 1.494170e-03 3 1  ON 55
ci_0057                 2.790527e-03 3 1  ON 56
ci_0058                 2.424122e-03 3 1  ON 57
ci_0059                -3.503527e-03 3 1  ON 58
ci_0060                -3.567202e-03 3 1  ON 59
ci_0061                -3.360244e-03 3 1  ON 60
ci_0062                -3.291413e-03 3 1  ON 61
ci_0063                -9.343303e-03 3 1  ON 62
ci_0064                -9.575125e-03 3 1  ON 63
ci_0065                -6.601363e-03 3 1  ON 64
ci_0066                -6.655879e-03 3 1  ON 65
ci_0067                -4.174009e-03 3 1  ON 66
ci_0068                -3.528283e-03 3 1  ON 67
ci_0069                 3.333671e-03 3 1  ON 68
ci_0070                 3.501520e-03 3 1  ON 69
ci_0071                 3.929373e-03 3 1  ON 70
ci_0072                 3.191262e-03 3 1  ON 71
ci_0073                 3.741451e-03 3 1  ON 72
ci_0074                 3.320464e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9694
    reference variance = 0.276261
====================================================
  Execution time = 1.4513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9376e-01
  Total weights = 1.951254542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282958001553
                                         uncertainty =       0.002077791876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282958001553
                                         uncertainty =       0.002077791876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376093881
  error estimate for blocks of size 2^( 2) =       0.000393023078
  error estimate for blocks of size 2^( 3) =       0.000410166774
  error estimate for blocks of size 2^( 4) =       0.000424780844
  error estimate for blocks of size 2^( 5) =       0.000435129246
  error estimate for blocks of size 2^( 6) =       0.000440841605
  error estimate for blocks of size 2^( 7) =       0.000445624610

      target function =      -0.922500868949
              le_mean =     -16.898621637675
             les_mean =     285.857168673583
             stat err =       0.000436594076
             autocorr =       1.347606639205
   target nu stat err =       0.000436594076
   target dn stat err =       0.002757545293
      target stat err =       0.004383199701
              std dev =       0.531877067722
             le_variance =       0.282893215169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689862163767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-02, overlap shift 2.2204e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922520312427       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923251198113       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923379020968       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923435337651       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923494589153       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923522116141       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923536804711       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923542476856       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923548698269       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923554255027       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923558271482       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923562323516       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923565285895       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923569304333       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923573191705       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923573879877       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923571939051       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923571825663       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923570696059       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923570170930       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923569813311       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923569903726       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923569856055       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923569796179       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923569729515       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e-02 is 9.955095e-03

solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922520312427       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922959608718       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923032674412       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923061637106       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923089480363       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923100506973       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923105511080       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923107587248       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923110168274       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923112211069       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923113078394       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923113554106       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923113388618       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923113333489       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923113481673       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923113111796       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923112721459       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923112676790       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923112567027       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923112528973       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923112505189       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 2.514292e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922520312427       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922689510165       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922716354712       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922726006407       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922734608025       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922737578468       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922738782744       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922739327617       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922740076234       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922740556078       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922740589517       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922740521733       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922740361407       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922740301947       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922740299438       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922740218128       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922740167875       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922740165299       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922740154701       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 7.958352e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.980141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7089e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.081497e-01 3 1  ON 0
ci_0002                 6.931003e-01 3 1  ON 1
ci_0003                -3.135691e-02 3 1  ON 2
ci_0004                -3.050912e-02 3 1  ON 3
ci_0005                -3.075235e-02 3 1  ON 4
ci_0006                -3.059246e-02 3 1  ON 5
ci_0007                -1.417536e-02 3 1  ON 6
ci_0008                -1.403943e-02 3 1  ON 7
ci_0009                -1.889464e-02 3 1  ON 8
ci_0010                -1.815265e-02 3 1  ON 9
ci_0011                -1.490829e-02 3 1  ON 10
ci_0012                -1.485406e-02 3 1  ON 11
ci_0013                 1.554109e-02 3 1  ON 12
ci_0014                 1.477460e-02 3 1  ON 13
ci_0015                 1.598823e-02 3 1  ON 14
ci_0016                 1.557887e-02 3 1  ON 15
ci_0017                 1.351822e-02 3 1  ON 16
ci_0018                 1.312257e-02 3 1  ON 17
ci_0019                 1.306503e-02 3 1  ON 18
ci_0020                 1.248910e-02 3 1  ON 19
ci_0021                 8.123544e-03 3 1  ON 20
ci_0022                 8.759192e-03 3 1  ON 21
ci_0023                -1.191343e-02 3 1  ON 22
ci_0024                -1.134864e-02 3 1  ON 23
ci_0025                -2.146155e-03 3 1  ON 24
ci_0026                -2.876406e-03 3 1  ON 25
ci_0027                -1.195926e-02 3 1  ON 26
ci_0028                -1.156740e-02 3 1  ON 27
ci_0029                -1.032166e-02 3 1  ON 28
ci_0030                -1.054448e-02 3 1  ON 29
ci_0031                 1.349574e-02 3 1  ON 30
ci_0032                 1.201579e-02 3 1  ON 31
ci_0033                 7.837954e-03 3 1  ON 32
ci_0034                 8.599569e-03 3 1  ON 33
ci_0035                 4.946525e-03 3 1  ON 34
ci_0036                 5.014272e-03 3 1  ON 35
ci_0037                -1.135843e-02 3 1  ON 36
ci_0038                -1.168415e-02 3 1  ON 37
ci_0039                -4.077608e-03 3 1  ON 38
ci_0040                -4.193298e-03 3 1  ON 39
ci_0041                 9.071084e-03 3 1  ON 40
ci_0042                 8.754566e-03 3 1  ON 41
ci_0043                -1.202532e-02 3 1  ON 42
ci_0044                -1.258078e-02 3 1  ON 43
ci_0045                 1.090219e-02 3 1  ON 44
ci_0046                 1.020407e-02 3 1  ON 45
ci_0047                -3.726101e-03 3 1  ON 46
ci_0048                -3.479943e-03 3 1  ON 47
ci_0049                -2.705388e-03 3 1  ON 48
ci_0050                -2.808107e-03 3 1  ON 49
ci_0051                -1.801303e-03 3 1  ON 50
ci_0052                -2.134886e-03 3 1  ON 51
ci_0053                -3.902198e-03 3 1  ON 52
ci_0054                -3.681241e-03 3 1  ON 53
ci_0055                 2.837781e-03 3 1  ON 54
ci_0056                 2.109979e-03 3 1  ON 55
ci_0057                 2.310089e-03 3 1  ON 56
ci_0058                 3.320129e-03 3 1  ON 57
ci_0059                -3.493930e-03 3 1  ON 58
ci_0060                -3.202093e-03 3 1  ON 59
ci_0061                -4.001759e-03 3 1  ON 60
ci_0062                -3.979860e-03 3 1  ON 61
ci_0063                -9.905081e-03 3 1  ON 62
ci_0064                -9.636298e-03 3 1  ON 63
ci_0065                -6.336219e-03 3 1  ON 64
ci_0066                -6.117742e-03 3 1  ON 65
ci_0067                -3.599223e-03 3 1  ON 66
ci_0068                -3.404903e-03 3 1  ON 67
ci_0069                 3.921406e-03 3 1  ON 68
ci_0070                 3.498094e-03 3 1  ON 69
ci_0071                 2.809426e-03 3 1  ON 70
ci_0072                 4.115201e-03 3 1  ON 71
ci_0073                 3.847116e-03 3 1  ON 72
ci_0074                 3.606964e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9521
    reference variance = 0.334011
====================================================
  Execution time = 1.4112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9090e-01
  Total weights = 1.9512e+06
  Execution time = 1.8838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282412230141
                                         uncertainty =       0.001569101094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282412230141
                                         uncertainty =       0.001569101094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375739052
  error estimate for blocks of size 2^( 2) =       0.000392529688
  error estimate for blocks of size 2^( 3) =       0.000409835920
  error estimate for blocks of size 2^( 4) =       0.000425121656
  error estimate for blocks of size 2^( 5) =       0.000436945330
  error estimate for blocks of size 2^( 6) =       0.000445855954
  error estimate for blocks of size 2^( 7) =       0.000452268507

      target function =      -0.906716433731
              le_mean =     -16.898907609046
             les_mean =     285.876951658392
             stat err =       0.000440047862
             autocorr =       1.371598999702
   target nu stat err =       0.000440047862
   target dn stat err =       0.009198206143
      target stat err =       0.013950910269
              std dev =       0.531375263049
             le_variance =       0.282359670181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286149471231
                                         uncertainty =       0.003112070114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286149471231
                                         uncertainty =       0.003112070114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378225634
  error estimate for blocks of size 2^( 2) =       0.000394817866
  error estimate for blocks of size 2^( 3) =       0.000411934454
  error estimate for blocks of size 2^( 4) =       0.000427026343
  error estimate for blocks of size 2^( 5) =       0.000438860917
  error estimate for blocks of size 2^( 6) =       0.000447873457
  error estimate for blocks of size 2^( 7) =       0.000454276719

      target function =      -0.646549185297
              le_mean =     -16.898855824500
             les_mean =     286.072806398457
             stat err =       0.000442009359
             autocorr =       1.365717933284
   target nu stat err =       0.000442009359
   target dn stat err =       0.186241183549
      target stat err =       0.151215129413
              std dev =       0.534891820796
             le_variance =       0.286109259954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282853753213
                                         uncertainty =       0.001872286488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282853753213
                                         uncertainty =       0.001872286488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376041758
  error estimate for blocks of size 2^( 2) =       0.000392724698
  error estimate for blocks of size 2^( 3) =       0.000409945119
  error estimate for blocks of size 2^( 4) =       0.000425106248
  error estimate for blocks of size 2^( 5) =       0.000436850837
  error estimate for blocks of size 2^( 6) =       0.000445858489
  error estimate for blocks of size 2^( 7) =       0.000452353819

      target function =      -0.923626544713
              le_mean =     -16.898901923792
             les_mean =     285.865927668785
             stat err =       0.000440042348
             autocorr =       1.369357356162
   target nu stat err =       0.000440042348
   target dn stat err =       0.002454736096
      target stat err =       0.003928984654
              std dev =       0.531803353807
             le_variance =       0.282814807120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282205493525
                                         uncertainty =       0.001576874817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282205493525
                                         uncertainty =       0.001576874817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375602753
  error estimate for blocks of size 2^( 2) =       0.000392376372
  error estimate for blocks of size 2^( 3) =       0.000409674540
  error estimate for blocks of size 2^( 4) =       0.000424942644
  error estimate for blocks of size 2^( 5) =       0.000436767634
  error estimate for blocks of size 2^( 6) =       0.000445706669
  error estimate for blocks of size 2^( 7) =       0.000452138169

      target function =      -0.918317508017
              le_mean =     -16.898882686501
             les_mean =     285.868665989466
             stat err =       0.000439888779
             autocorr =       1.371602393392
   target nu stat err =       0.000439888779
   target dn stat err =       0.003454429204
      target stat err =       0.005416802201
              std dev =       0.531182507325
             le_variance =       0.282154856088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906716433731        initial
     2.2204e-02     2.2204e-01             9.9551e-03        -0.646549185297
     8.8818e-02     8.8818e-01             2.5143e-03        -0.923626544713  <--
     3.5527e-01     3.5527e+00             7.9584e-04        -0.918317508017

*****************************************************************************
Applying the update for shift_i =   8.8818e-02     and shift_s =   8.8818e-01
*****************************************************************************

  Execution time = 2.3633e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.081497e-01 3 1  ON 0
ci_0002                 6.931003e-01 3 1  ON 1
ci_0003                -3.135691e-02 3 1  ON 2
ci_0004                -3.050912e-02 3 1  ON 3
ci_0005                -3.075235e-02 3 1  ON 4
ci_0006                -3.059246e-02 3 1  ON 5
ci_0007                -1.417536e-02 3 1  ON 6
ci_0008                -1.403943e-02 3 1  ON 7
ci_0009                -1.889464e-02 3 1  ON 8
ci_0010                -1.815265e-02 3 1  ON 9
ci_0011                -1.490829e-02 3 1  ON 10
ci_0012                -1.485406e-02 3 1  ON 11
ci_0013                 1.554109e-02 3 1  ON 12
ci_0014                 1.477460e-02 3 1  ON 13
ci_0015                 1.598823e-02 3 1  ON 14
ci_0016                 1.557887e-02 3 1  ON 15
ci_0017                 1.351822e-02 3 1  ON 16
ci_0018                 1.312257e-02 3 1  ON 17
ci_0019                 1.306503e-02 3 1  ON 18
ci_0020                 1.248910e-02 3 1  ON 19
ci_0021                 8.123544e-03 3 1  ON 20
ci_0022                 8.759192e-03 3 1  ON 21
ci_0023                -1.191343e-02 3 1  ON 22
ci_0024                -1.134864e-02 3 1  ON 23
ci_0025                -2.146155e-03 3 1  ON 24
ci_0026                -2.876406e-03 3 1  ON 25
ci_0027                -1.195926e-02 3 1  ON 26
ci_0028                -1.156740e-02 3 1  ON 27
ci_0029                -1.032166e-02 3 1  ON 28
ci_0030                -1.054448e-02 3 1  ON 29
ci_0031                 1.349574e-02 3 1  ON 30
ci_0032                 1.201579e-02 3 1  ON 31
ci_0033                 7.837954e-03 3 1  ON 32
ci_0034                 8.599569e-03 3 1  ON 33
ci_0035                 4.946525e-03 3 1  ON 34
ci_0036                 5.014272e-03 3 1  ON 35
ci_0037                -1.135843e-02 3 1  ON 36
ci_0038                -1.168415e-02 3 1  ON 37
ci_0039                -4.077608e-03 3 1  ON 38
ci_0040                -4.193298e-03 3 1  ON 39
ci_0041                 9.071084e-03 3 1  ON 40
ci_0042                 8.754566e-03 3 1  ON 41
ci_0043                -1.202532e-02 3 1  ON 42
ci_0044                -1.258078e-02 3 1  ON 43
ci_0045                 1.090219e-02 3 1  ON 44
ci_0046                 1.020407e-02 3 1  ON 45
ci_0047                -3.726101e-03 3 1  ON 46
ci_0048                -3.479943e-03 3 1  ON 47
ci_0049                -2.705388e-03 3 1  ON 48
ci_0050                -2.808107e-03 3 1  ON 49
ci_0051                -1.801303e-03 3 1  ON 50
ci_0052                -2.134886e-03 3 1  ON 51
ci_0053                -3.902198e-03 3 1  ON 52
ci_0054                -3.681241e-03 3 1  ON 53
ci_0055                 2.837781e-03 3 1  ON 54
ci_0056                 2.109979e-03 3 1  ON 55
ci_0057                 2.310089e-03 3 1  ON 56
ci_0058                 3.320129e-03 3 1  ON 57
ci_0059                -3.493930e-03 3 1  ON 58
ci_0060                -3.202093e-03 3 1  ON 59
ci_0061                -4.001759e-03 3 1  ON 60
ci_0062                -3.979860e-03 3 1  ON 61
ci_0063                -9.905081e-03 3 1  ON 62
ci_0064                -9.636298e-03 3 1  ON 63
ci_0065                -6.336219e-03 3 1  ON 64
ci_0066                -6.117742e-03 3 1  ON 65
ci_0067                -3.599223e-03 3 1  ON 66
ci_0068                -3.404903e-03 3 1  ON 67
ci_0069                 3.921406e-03 3 1  ON 68
ci_0070                 3.498094e-03 3 1  ON 69
ci_0071                 2.809426e-03 3 1  ON 70
ci_0072                 4.115201e-03 3 1  ON 71
ci_0073                 3.847116e-03 3 1  ON 72
ci_0074                 3.606964e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9514
    reference variance = 0.262129
====================================================
  Execution time = 1.4635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5200e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8859e-01
  Total weights = 1.951065075e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279878542684
                                         uncertainty =       0.001856172870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279878542684
                                         uncertainty =       0.001856172870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374137967
  error estimate for blocks of size 2^( 2) =       0.000391173260
  error estimate for blocks of size 2^( 3) =       0.000408388376
  error estimate for blocks of size 2^( 4) =       0.000423400570
  error estimate for blocks of size 2^( 5) =       0.000435025016
  error estimate for blocks of size 2^( 6) =       0.000440913228
  error estimate for blocks of size 2^( 7) =       0.000443872883

      target function =      -0.930664072875
              le_mean =     -16.898517344603
             les_mean =     285.848480670039
             stat err =       0.000435802925
             autocorr =       1.356802755709
   target nu stat err =       0.000435802925
   target dn stat err =       0.002376481165
      target stat err =       0.003861332443
              std dev =       0.529110986883
             le_variance =       0.279958436440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689851734460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-02, overlap shift 2.2204e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930678822077       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930850810671       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930895747362       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930919691405       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930936626105       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930952833268       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930958347770       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930961457484       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930964666450       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930967153581       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930971180022       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930975623838       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930977693102       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930982155570       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930983864119       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930987124241       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930989518763       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930990238358       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930990053081       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930990323094       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930989914778       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930989914878       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930990060322       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e-02 is 8.107380e-03

solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930678822077       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930782103434       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930807216014       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930818749241       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930826524452       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930833348274       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930835189163       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930836421139       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837723223       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930838631081       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930839881942       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930840953855       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930840853070       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930841336335       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930841345311       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930841766171       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930841853719       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930841847787       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930841797721       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930841817478       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930841782839       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 2.061152e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930678822077       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930718575110       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930727609254       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930731222219       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930733591686       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930735522855       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930735953123       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930736307397       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930736670367       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930736891838       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930737146957       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930737301231       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930737206856       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930737272228       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930737266217       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930737331202       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930737328144       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930737321662       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 5.336686e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.994403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7223e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.061933e-01 3 1  ON 0
ci_0002                 6.951614e-01 3 1  ON 1
ci_0003                -3.120509e-02 3 1  ON 2
ci_0004                -3.030101e-02 3 1  ON 3
ci_0005                -3.000331e-02 3 1  ON 4
ci_0006                -3.083595e-02 3 1  ON 5
ci_0007                -1.360946e-02 3 1  ON 6
ci_0008                -1.314896e-02 3 1  ON 7
ci_0009                -1.900304e-02 3 1  ON 8
ci_0010                -1.805775e-02 3 1  ON 9
ci_0011                -1.469247e-02 3 1  ON 10
ci_0012                -1.454068e-02 3 1  ON 11
ci_0013                 1.491799e-02 3 1  ON 12
ci_0014                 1.477688e-02 3 1  ON 13
ci_0015                 1.575102e-02 3 1  ON 14
ci_0016                 1.530624e-02 3 1  ON 15
ci_0017                 1.330558e-02 3 1  ON 16
ci_0018                 1.338303e-02 3 1  ON 17
ci_0019                 1.285607e-02 3 1  ON 18
ci_0020                 1.272947e-02 3 1  ON 19
ci_0021                 7.878427e-03 3 1  ON 20
ci_0022                 8.295959e-03 3 1  ON 21
ci_0023                -1.175662e-02 3 1  ON 22
ci_0024                -1.154986e-02 3 1  ON 23
ci_0025                -2.179050e-03 3 1  ON 24
ci_0026                -2.634700e-03 3 1  ON 25
ci_0027                -1.198145e-02 3 1  ON 26
ci_0028                -1.151991e-02 3 1  ON 27
ci_0029                -1.072870e-02 3 1  ON 28
ci_0030                -1.042416e-02 3 1  ON 29
ci_0031                 1.390480e-02 3 1  ON 30
ci_0032                 1.260090e-02 3 1  ON 31
ci_0033                 8.236738e-03 3 1  ON 32
ci_0034                 8.648851e-03 3 1  ON 33
ci_0035                 5.036214e-03 3 1  ON 34
ci_0036                 5.224342e-03 3 1  ON 35
ci_0037                -1.121692e-02 3 1  ON 36
ci_0038                -1.149231e-02 3 1  ON 37
ci_0039                -3.972051e-03 3 1  ON 38
ci_0040                -3.926419e-03 3 1  ON 39
ci_0041                 8.717474e-03 3 1  ON 40
ci_0042                 8.659827e-03 3 1  ON 41
ci_0043                -1.317549e-02 3 1  ON 42
ci_0044                -1.421536e-02 3 1  ON 43
ci_0045                 1.035867e-02 3 1  ON 44
ci_0046                 1.018095e-02 3 1  ON 45
ci_0047                -3.549592e-03 3 1  ON 46
ci_0048                -3.225115e-03 3 1  ON 47
ci_0049                -2.381821e-03 3 1  ON 48
ci_0050                -2.844358e-03 3 1  ON 49
ci_0051                -1.663383e-03 3 1  ON 50
ci_0052                -1.975172e-03 3 1  ON 51
ci_0053                -4.324223e-03 3 1  ON 52
ci_0054                -3.645322e-03 3 1  ON 53
ci_0055                 3.100789e-03 3 1  ON 54
ci_0056                 2.293366e-03 3 1  ON 55
ci_0057                 2.082404e-03 3 1  ON 56
ci_0058                 3.063530e-03 3 1  ON 57
ci_0059                -3.278674e-03 3 1  ON 58
ci_0060                -3.292166e-03 3 1  ON 59
ci_0061                -3.757685e-03 3 1  ON 60
ci_0062                -4.054380e-03 3 1  ON 61
ci_0063                -1.001316e-02 3 1  ON 62
ci_0064                -9.416239e-03 3 1  ON 63
ci_0065                -6.435058e-03 3 1  ON 64
ci_0066                -6.243687e-03 3 1  ON 65
ci_0067                -3.700802e-03 3 1  ON 66
ci_0068                -3.616076e-03 3 1  ON 67
ci_0069                 3.658748e-03 3 1  ON 68
ci_0070                 3.495651e-03 3 1  ON 69
ci_0071                 3.042817e-03 3 1  ON 70
ci_0072                 4.019613e-03 3 1  ON 71
ci_0073                 3.443009e-03 3 1  ON 72
ci_0074                 3.425548e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9416
    reference variance = 0.164073
====================================================
  Execution time = 1.4290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9904e-01
  Total weights = 1.9507e+06
  Execution time = 1.8852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286346183494
                                         uncertainty =       0.002429423537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286346183494
                                         uncertainty =       0.002429423537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378393710
  error estimate for blocks of size 2^( 2) =       0.000395909575
  error estimate for blocks of size 2^( 3) =       0.000413561674
  error estimate for blocks of size 2^( 4) =       0.000429616525
  error estimate for blocks of size 2^( 5) =       0.000441883282
  error estimate for blocks of size 2^( 6) =       0.000449366023
  error estimate for blocks of size 2^( 7) =       0.000453045418

      target function =      -0.910070892137
              le_mean =     -16.898618420808
             les_mean =     285.865074769632
             stat err =       0.000443477812
             autocorr =       1.373586377612
   target nu stat err =       0.000443477812
   target dn stat err =       0.004934417400
      target stat err =       0.007560361839
              std dev =       0.535129516600
             le_variance =       0.286363599536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285768258963
                                         uncertainty =       0.002063511970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285768258963
                                         uncertainty =       0.002063511970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378013787
  error estimate for blocks of size 2^( 2) =       0.000395551931
  error estimate for blocks of size 2^( 3) =       0.000413211157
  error estimate for blocks of size 2^( 4) =       0.000429243301
  error estimate for blocks of size 2^( 5) =       0.000441504361
  error estimate for blocks of size 2^( 6) =       0.000448980679
  error estimate for blocks of size 2^( 7) =       0.000452718880

      target function =      -0.858435458576
              le_mean =     -16.898594785258
             les_mean =     285.898744224065
             stat err =       0.000443111805
             autocorr =       1.374077921888
   target nu stat err =       0.000443111805
   target dn stat err =       0.030567190981
      target stat err =       0.041567013050
              std dev =       0.534592224063
             le_variance =       0.285788846029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286987531375
                                         uncertainty =       0.002350461594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286987531375
                                         uncertainty =       0.002350461594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378819911
  error estimate for blocks of size 2^( 2) =       0.000396371177
  error estimate for blocks of size 2^( 3) =       0.000413984741
  error estimate for blocks of size 2^( 4) =       0.000429918035
  error estimate for blocks of size 2^( 5) =       0.000442097968
  error estimate for blocks of size 2^( 6) =       0.000449521815
  error estimate for blocks of size 2^( 7) =       0.000453154323

      target function =      -0.352171730488
              le_mean =     -16.898575156919
             les_mean =     286.487942992088
             stat err =       0.000443673035
             autocorr =       1.371704213425
   target nu stat err =       0.000443673035
   target dn stat err =       0.626794775087
      target stat err =       0.180750167531
              std dev =       0.535732256518
             le_variance =       0.287009050673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286129266642
                                         uncertainty =       0.002350890547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286129266642
                                         uncertainty =       0.002350890547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378250853
  error estimate for blocks of size 2^( 2) =       0.000395774012
  error estimate for blocks of size 2^( 3) =       0.000413430552
  error estimate for blocks of size 2^( 4) =       0.000429482144
  error estimate for blocks of size 2^( 5) =       0.000441749739
  error estimate for blocks of size 2^( 6) =       0.000449228621
  error estimate for blocks of size 2^( 7) =       0.000452913291

      target function =      -0.912770561710
              le_mean =     -16.898605982960
             les_mean =     285.862894346655
             stat err =       0.000443343449
             autocorr =       1.373791291713
   target nu stat err =       0.000443343449
   target dn stat err =       0.004599692253
      target stat err =       0.007094062431
              std dev =       0.534927486105
             le_variance =       0.286147415391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910070892137        initial
     2.2204e-02     2.2204e-01             8.1074e-03        -0.858435458576
     8.8818e-02     8.8818e-01             2.0612e-03        -0.352171730488
     3.5527e-01     3.5527e+00             5.3367e-04        -0.912770561710  <--

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 2.3968e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.076637e-01 3 1  ON 0
ci_0002                 6.936192e-01 3 1  ON 1
ci_0003                -3.131255e-02 3 1  ON 2
ci_0004                -3.042560e-02 3 1  ON 3
ci_0005                -3.050897e-02 3 1  ON 4
ci_0006                -3.067333e-02 3 1  ON 5
ci_0007                -1.399323e-02 3 1  ON 6
ci_0008                -1.375345e-02 3 1  ON 7
ci_0009                -1.893999e-02 3 1  ON 8
ci_0010                -1.811209e-02 3 1  ON 9
ci_0011                -1.483378e-02 3 1  ON 10
ci_0012                -1.473675e-02 3 1  ON 11
ci_0013                 1.532042e-02 3 1  ON 12
ci_0014                 1.476994e-02 3 1  ON 13
ci_0015                 1.590839e-02 3 1  ON 14
ci_0016                 1.547486e-02 3 1  ON 15
ci_0017                 1.344448e-02 3 1  ON 16
ci_0018                 1.321313e-02 3 1  ON 17
ci_0019                 1.299345e-02 3 1  ON 18
ci_0020                 1.257303e-02 3 1  ON 19
ci_0021                 8.038690e-03 3 1  ON 20
ci_0022                 8.595613e-03 3 1  ON 21
ci_0023                -1.185908e-02 3 1  ON 22
ci_0024                -1.141829e-02 3 1  ON 23
ci_0025                -2.160116e-03 3 1  ON 24
ci_0026                -2.780486e-03 3 1  ON 25
ci_0027                -1.196894e-02 3 1  ON 26
ci_0028                -1.154539e-02 3 1  ON 27
ci_0029                -1.046987e-02 3 1  ON 28
ci_0030                -1.049613e-02 3 1  ON 29
ci_0031                 1.363929e-02 3 1  ON 30
ci_0032                 1.221180e-02 3 1  ON 31
ci_0033                 7.974489e-03 3 1  ON 32
ci_0034                 8.614085e-03 3 1  ON 33
ci_0035                 4.981724e-03 3 1  ON 34
ci_0036                 5.093008e-03 3 1  ON 35
ci_0037                -1.131250e-02 3 1  ON 36
ci_0038                -1.161359e-02 3 1  ON 37
ci_0039                -4.038654e-03 3 1  ON 38
ci_0040                -4.090331e-03 3 1  ON 39
ci_0041                 8.949338e-03 3 1  ON 40
ci_0042                 8.719761e-03 3 1  ON 41
ci_0043                -1.240170e-02 3 1  ON 42
ci_0044                -1.311444e-02 3 1  ON 43
ci_0045                 1.071662e-02 3 1  ON 44
ci_0046                 1.019318e-02 3 1  ON 45
ci_0047                -3.660538e-03 3 1  ON 46
ci_0048                -3.382310e-03 3 1  ON 47
ci_0049                -2.580375e-03 3 1  ON 48
ci_0050                -2.821314e-03 3 1  ON 49
ci_0051                -1.748256e-03 3 1  ON 50
ci_0052                -2.071926e-03 3 1  ON 51
ci_0053                -4.065720e-03 3 1  ON 52
ci_0054                -3.665578e-03 3 1  ON 53
ci_0055                 2.939558e-03 3 1  ON 54
ci_0056                 2.180899e-03 3 1  ON 55
ci_0057                 2.224758e-03 3 1  ON 56
ci_0058                 3.221662e-03 3 1  ON 57
ci_0059                -3.411847e-03 3 1  ON 58
ci_0060                -3.235801e-03 3 1  ON 59
ci_0061                -3.913300e-03 3 1  ON 60
ci_0062                -4.006437e-03 3 1  ON 61
ci_0063                -9.949751e-03 3 1  ON 62
ci_0064                -9.552175e-03 3 1  ON 63
ci_0065                -6.375139e-03 3 1  ON 64
ci_0066                -6.162471e-03 3 1  ON 65
ci_0067                -3.640028e-03 3 1  ON 66
ci_0068                -3.485459e-03 3 1  ON 67
ci_0069                 3.821568e-03 3 1  ON 68
ci_0070                 3.495787e-03 3 1  ON 69
ci_0071                 2.899923e-03 3 1  ON 70
ci_0072                 4.075580e-03 3 1  ON 71
ci_0073                 3.691269e-03 3 1  ON 72
ci_0074                 3.535580e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.241217
====================================================
  Execution time = 1.4502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9194e-01
  Total weights = 1.950608827e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280978552891
                                         uncertainty =       0.001569037926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280978552891
                                         uncertainty =       0.001569037926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374819653
  error estimate for blocks of size 2^( 2) =       0.000391566582
  error estimate for blocks of size 2^( 3) =       0.000408621835
  error estimate for blocks of size 2^( 4) =       0.000423166354
  error estimate for blocks of size 2^( 5) =       0.000435127762
  error estimate for blocks of size 2^( 6) =       0.000441046075
  error estimate for blocks of size 2^( 7) =       0.000445502874

      target function =      -0.925356374542
              le_mean =     -16.898728638935
             les_mean =     285.858971812774
             stat err =       0.000436210766
             autocorr =       1.354403455710
   target nu stat err =       0.000436210766
   target dn stat err =       0.002372297324
      target stat err =       0.003813384551
              std dev =       0.530075036079
             le_variance =       0.280979543874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689872863893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925370740956       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925594956586       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925629672704       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925639205629       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925649030043       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925652231793       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925652421935       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925653367586       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925653595668       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925653323929       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925653345597       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925653296090       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925653332296       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925653353986       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925653344761       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925653411849       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925653435878       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925653427639       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925653412457       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925653386025       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925653362756       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 1.518339e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925370740956       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925456948013       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925469482879       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925472429624       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925475512507       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925476362788       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925476304949       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925476549282       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925476587502       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925476510062       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925476515008       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925476505190       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925476515992       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925476521153       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925476520434       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925476536208       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925476537051       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925476532746       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 4.956217e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925370740956       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925395640591       residual = 9.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925399160676       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925399931271       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925400746637       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925400953972       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925400928652       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925400988554       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925400995946       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925400976525       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925400977746       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925400975717       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925400978486       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925400979684       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925400979666       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925400983192       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925400982985       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 1.341785e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.005890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7089e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.076451e-01 3 1  ON 0
ci_0002                 6.936568e-01 3 1  ON 1
ci_0003                -3.118088e-02 3 1  ON 2
ci_0004                -3.042873e-02 3 1  ON 3
ci_0005                -3.074189e-02 3 1  ON 4
ci_0006                -3.066179e-02 3 1  ON 5
ci_0007                -1.394662e-02 3 1  ON 6
ci_0008                -1.345095e-02 3 1  ON 7
ci_0009                -1.874205e-02 3 1  ON 8
ci_0010                -1.831240e-02 3 1  ON 9
ci_0011                -1.469788e-02 3 1  ON 10
ci_0012                -1.465516e-02 3 1  ON 11
ci_0013                 1.540485e-02 3 1  ON 12
ci_0014                 1.484253e-02 3 1  ON 13
ci_0015                 1.582040e-02 3 1  ON 14
ci_0016                 1.555972e-02 3 1  ON 15
ci_0017                 1.344263e-02 3 1  ON 16
ci_0018                 1.314185e-02 3 1  ON 17
ci_0019                 1.297160e-02 3 1  ON 18
ci_0020                 1.257138e-02 3 1  ON 19
ci_0021                 7.543068e-03 3 1  ON 20
ci_0022                 8.336659e-03 3 1  ON 21
ci_0023                -1.190815e-02 3 1  ON 22
ci_0024                -1.134025e-02 3 1  ON 23
ci_0025                -2.290461e-03 3 1  ON 24
ci_0026                -2.847834e-03 3 1  ON 25
ci_0027                -1.198934e-02 3 1  ON 26
ci_0028                -1.158051e-02 3 1  ON 27
ci_0029                -1.060572e-02 3 1  ON 28
ci_0030                -1.065952e-02 3 1  ON 29
ci_0031                 1.359106e-02 3 1  ON 30
ci_0032                 1.223853e-02 3 1  ON 31
ci_0033                 7.971162e-03 3 1  ON 32
ci_0034                 8.685680e-03 3 1  ON 33
ci_0035                 5.005266e-03 3 1  ON 34
ci_0036                 4.984309e-03 3 1  ON 35
ci_0037                -1.116492e-02 3 1  ON 36
ci_0038                -1.132598e-02 3 1  ON 37
ci_0039                -4.082889e-03 3 1  ON 38
ci_0040                -4.023737e-03 3 1  ON 39
ci_0041                 8.969713e-03 3 1  ON 40
ci_0042                 8.831107e-03 3 1  ON 41
ci_0043                -1.234358e-02 3 1  ON 42
ci_0044                -1.334007e-02 3 1  ON 43
ci_0045                 1.066801e-02 3 1  ON 44
ci_0046                 1.020358e-02 3 1  ON 45
ci_0047                -3.566455e-03 3 1  ON 46
ci_0048                -3.471028e-03 3 1  ON 47
ci_0049                -2.505682e-03 3 1  ON 48
ci_0050                -2.639660e-03 3 1  ON 49
ci_0051                -1.735802e-03 3 1  ON 50
ci_0052                -2.136910e-03 3 1  ON 51
ci_0053                -3.932347e-03 3 1  ON 52
ci_0054                -3.446263e-03 3 1  ON 53
ci_0055                 2.782703e-03 3 1  ON 54
ci_0056                 2.293641e-03 3 1  ON 55
ci_0057                 2.007578e-03 3 1  ON 56
ci_0058                 3.293613e-03 3 1  ON 57
ci_0059                -3.234401e-03 3 1  ON 58
ci_0060                -3.155099e-03 3 1  ON 59
ci_0061                -3.947394e-03 3 1  ON 60
ci_0062                -4.065635e-03 3 1  ON 61
ci_0063                -1.000252e-02 3 1  ON 62
ci_0064                -9.427865e-03 3 1  ON 63
ci_0065                -6.441078e-03 3 1  ON 64
ci_0066                -6.126212e-03 3 1  ON 65
ci_0067                -3.698735e-03 3 1  ON 66
ci_0068                -3.344068e-03 3 1  ON 67
ci_0069                 3.739105e-03 3 1  ON 68
ci_0070                 3.536335e-03 3 1  ON 69
ci_0071                 2.988417e-03 3 1  ON 70
ci_0072                 3.811105e-03 3 1  ON 71
ci_0073                 3.758409e-03 3 1  ON 72
ci_0074                 3.678575e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.8721
    reference variance = 0.20295
====================================================
  Execution time = 1.6267e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9136e-01
  Total weights = 1.9511e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281470574985
                                         uncertainty =       0.001567017440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281470574985
                                         uncertainty =       0.001567017440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375141890
  error estimate for blocks of size 2^( 2) =       0.000392083136
  error estimate for blocks of size 2^( 3) =       0.000409424242
  error estimate for blocks of size 2^( 4) =       0.000424508857
  error estimate for blocks of size 2^( 5) =       0.000435323193
  error estimate for blocks of size 2^( 6) =       0.000443574159
  error estimate for blocks of size 2^( 7) =       0.000449297280

      target function =      -0.923367582481
              le_mean =     -16.898910562344
             les_mean =     285.866378008558
             stat err =       0.000438175873
             autocorr =       1.364287175079
   target nu stat err =       0.000438175873
   target dn stat err =       0.003131518160
      target stat err =       0.004973924653
              std dev =       0.530530748343
             le_variance =       0.281462874938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281390138866
                                         uncertainty =       0.001580815716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281390138866
                                         uncertainty =       0.001580815716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375089783
  error estimate for blocks of size 2^( 2) =       0.000392035443
  error estimate for blocks of size 2^( 3) =       0.000409370083
  error estimate for blocks of size 2^( 4) =       0.000424456143
  error estimate for blocks of size 2^( 5) =       0.000435275681
  error estimate for blocks of size 2^( 6) =       0.000443531383
  error estimate for blocks of size 2^( 7) =       0.000449202596

      target function =      -0.919018490485
              le_mean =     -16.898922978950
             les_mean =     285.869574513515
             stat err =       0.000438116451
             autocorr =       1.364296146962
   target nu stat err =       0.000438116451
   target dn stat err =       0.003635172478
      target stat err =       0.005703682011
              std dev =       0.530457057975
             le_variance =       0.281384690356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281394959770
                                         uncertainty =       0.001575808877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281394959770
                                         uncertainty =       0.001575808877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375092467
  error estimate for blocks of size 2^( 2) =       0.000392036514
  error estimate for blocks of size 2^( 3) =       0.000409374150
  error estimate for blocks of size 2^( 4) =       0.000424458452
  error estimate for blocks of size 2^( 5) =       0.000435278304
  error estimate for blocks of size 2^( 6) =       0.000443528202
  error estimate for blocks of size 2^( 7) =       0.000449209534

      target function =      -0.904499077246
              le_mean =     -16.898914653378
             les_mean =     285.878499652484
             stat err =       0.000438118623
             autocorr =       1.364290146743
   target nu stat err =       0.000438118623
   target dn stat err =       0.013401812376
      target stat err =       0.020217883089
              std dev =       0.530460854620
             le_variance =       0.281388718284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450743471
                                         uncertainty =       0.001567979986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281450743471
                                         uncertainty =       0.001567979986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375128799
  error estimate for blocks of size 2^( 2) =       0.000392070239
  error estimate for blocks of size 2^( 3) =       0.000409411165
  error estimate for blocks of size 2^( 4) =       0.000424495658
  error estimate for blocks of size 2^( 5) =       0.000435310415
  error estimate for blocks of size 2^( 6) =       0.000443560746
  error estimate for blocks of size 2^( 7) =       0.000449274187

      target function =      -0.925934151023
              le_mean =     -16.898910647843
             les_mean =     285.864756789399
             stat err =       0.000438160251
             autocorr =       1.364285113866
   target nu stat err =       0.000438160252
   target dn stat err =       0.002531141941
      target stat err =       0.004066283367
              std dev =       0.530512235605
             le_variance =       0.281443232126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923367582481        initial
     8.8818e-02     8.8818e-01             1.5183e-03        -0.919018490485
     3.5527e-01     3.5527e+00             4.9562e-04        -0.904499077246
     1.4211e+00     1.4211e+01             1.3418e-04        -0.925934151023  <--

*****************************************************************************
Applying the update for shift_i =   1.4211e+00     and shift_s =   1.4211e+01
*****************************************************************************

  Execution time = 2.5865e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.076604e-01 3 1  ON 0
ci_0002                 6.936276e-01 3 1  ON 1
ci_0003                -3.127606e-02 3 1  ON 2
ci_0004                -3.042650e-02 3 1  ON 3
ci_0005                -3.057334e-02 3 1  ON 4
ci_0006                -3.067074e-02 3 1  ON 5
ci_0007                -1.398084e-02 3 1  ON 6
ci_0008                -1.367142e-02 3 1  ON 7
ci_0009                -1.888408e-02 3 1  ON 8
ci_0010                -1.816871e-02 3 1  ON 9
ci_0011                -1.479599e-02 3 1  ON 10
ci_0012                -1.471389e-02 3 1  ON 11
ci_0013                 1.534416e-02 3 1  ON 12
ci_0014                 1.479048e-02 3 1  ON 13
ci_0015                 1.588375e-02 3 1  ON 14
ci_0016                 1.549887e-02 3 1  ON 15
ci_0017                 1.344398e-02 3 1  ON 16
ci_0018                 1.319302e-02 3 1  ON 17
ci_0019                 1.298708e-02 3 1  ON 18
ci_0020                 1.257245e-02 3 1  ON 19
ci_0021                 7.904511e-03 3 1  ON 20
ci_0022                 8.525032e-03 3 1  ON 21
ci_0023                -1.187294e-02 3 1  ON 22
ci_0024                -1.139616e-02 3 1  ON 23
ci_0025                -2.197769e-03 3 1  ON 24
ci_0026                -2.799908e-03 3 1  ON 25
ci_0027                -1.197456e-02 3 1  ON 26
ci_0028                -1.155539e-02 3 1  ON 27
ci_0029                -1.050781e-02 3 1  ON 28
ci_0030                -1.054209e-02 3 1  ON 29
ci_0031                 1.362643e-02 3 1  ON 30
ci_0032                 1.221961e-02 3 1  ON 31
ci_0033                 7.973553e-03 3 1  ON 32
ci_0034                 8.633427e-03 3 1  ON 33
ci_0035                 4.988693e-03 3 1  ON 34
ci_0036                 5.061844e-03 3 1  ON 35
ci_0037                -1.127134e-02 3 1  ON 36
ci_0038                -1.153351e-02 3 1  ON 37
ci_0039                -4.051413e-03 3 1  ON 38
ci_0040                -4.071124e-03 3 1  ON 39
ci_0041                 8.955209e-03 3 1  ON 40
ci_0042                 8.750892e-03 3 1  ON 41
ci_0043                -1.238711e-02 3 1  ON 42
ci_0044                -1.317589e-02 3 1  ON 43
ci_0045                 1.070330e-02 3 1  ON 44
ci_0046                 1.019615e-02 3 1  ON 45
ci_0047                -3.633458e-03 3 1  ON 46
ci_0048                -3.407780e-03 3 1  ON 47
ci_0049                -2.558861e-03 3 1  ON 48
ci_0050                -2.768617e-03 3 1  ON 49
ci_0051                -1.744633e-03 3 1  ON 50
ci_0052                -2.090921e-03 3 1  ON 51
ci_0053                -4.027241e-03 3 1  ON 52
ci_0054                -3.602248e-03 3 1  ON 53
ci_0055                 2.894114e-03 3 1  ON 54
ci_0056                 2.213491e-03 3 1  ON 55
ci_0057                 2.161968e-03 3 1  ON 56
ci_0058                 3.242495e-03 3 1  ON 57
ci_0059                -3.360387e-03 3 1  ON 58
ci_0060                -3.212384e-03 3 1  ON 59
ci_0061                -3.922896e-03 3 1  ON 60
ci_0062                -4.023190e-03 3 1  ON 61
ci_0063                -9.964746e-03 3 1  ON 62
ci_0064                -9.516975e-03 3 1  ON 63
ci_0065                -6.393860e-03 3 1  ON 64
ci_0066                -6.152284e-03 3 1  ON 65
ci_0067                -3.657068e-03 3 1  ON 66
ci_0068                -3.444564e-03 3 1  ON 67
ci_0069                 3.797653e-03 3 1  ON 68
ci_0070                 3.507553e-03 3 1  ON 69
ci_0071                 2.925449e-03 3 1  ON 70
ci_0072                 3.999218e-03 3 1  ON 71
ci_0073                 3.710617e-03 3 1  ON 72
ci_0074                 3.577039e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9087
    reference variance = 0.252664
====================================================
  Execution time = 1.4450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9776e-01
  Total weights = 1.951269725e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283669042663
                                         uncertainty =       0.002158845641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283669042663
                                         uncertainty =       0.002158845641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376583967
  error estimate for blocks of size 2^( 2) =       0.000393421905
  error estimate for blocks of size 2^( 3) =       0.000410625321
  error estimate for blocks of size 2^( 4) =       0.000424962016
  error estimate for blocks of size 2^( 5) =       0.000435949735
  error estimate for blocks of size 2^( 6) =       0.000444507350
  error estimate for blocks of size 2^( 7) =       0.000445387423

      target function =      -0.916206531789
              le_mean =     -16.898155792651
             les_mean =     285.845432495280
             stat err =       0.000437701631
             autocorr =       1.350929474124
   target nu stat err =       0.000437701631
   target dn stat err =       0.005603183398
      target stat err =       0.008683248339
              std dev =       0.532570154090
             le_variance =       0.283630969028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689815579265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916286982781       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916772489275       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916796267673       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916806238959       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916809972306       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916815145584       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916816350432       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916818017709       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916819650780       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916821139557       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916821608960       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916821443410       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916821595433       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916821645559       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916821707235       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916821717262       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916821693482       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916821686083       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 1.254113e-03

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916286982781       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916427528067       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916434261211       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916436943524       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916437928863       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916439255768       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916439535850       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916439965688       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916440372087       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916440663450       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916440733598       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916440683313       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916440714597       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916440721321       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916440732978       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916440733672       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916440728715       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916440727163       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 3.144861e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916286982781       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916323562562       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916325303367       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916325986299       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916326235852       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916326569043       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916326637377       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916326745587       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916326846349       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916326913410       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916326928081       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916326915248       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916326922744       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916326924102       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916326926795       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916326926870       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916326925700       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 8.104032e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.016072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7043e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.079749e-01 3 1  ON 0
ci_0002                 6.933179e-01 3 1  ON 1
ci_0003                -3.125598e-02 3 1  ON 2
ci_0004                -3.038132e-02 3 1  ON 3
ci_0005                -3.059006e-02 3 1  ON 4
ci_0006                -3.068858e-02 3 1  ON 5
ci_0007                -1.391126e-02 3 1  ON 6
ci_0008                -1.364454e-02 3 1  ON 7
ci_0009                -1.888482e-02 3 1  ON 8
ci_0010                -1.816690e-02 3 1  ON 9
ci_0011                -1.478778e-02 3 1  ON 10
ci_0012                -1.471206e-02 3 1  ON 11
ci_0013                 1.534129e-02 3 1  ON 12
ci_0014                 1.478325e-02 3 1  ON 13
ci_0015                 1.592868e-02 3 1  ON 14
ci_0016                 1.551122e-02 3 1  ON 15
ci_0017                 1.342622e-02 3 1  ON 16
ci_0018                 1.318017e-02 3 1  ON 17
ci_0019                 1.301510e-02 3 1  ON 18
ci_0020                 1.260288e-02 3 1  ON 19
ci_0021                 7.756384e-03 3 1  ON 20
ci_0022                 8.399468e-03 3 1  ON 21
ci_0023                -1.187299e-02 3 1  ON 22
ci_0024                -1.139106e-02 3 1  ON 23
ci_0025                -2.063801e-03 3 1  ON 24
ci_0026                -2.820208e-03 3 1  ON 25
ci_0027                -1.200946e-02 3 1  ON 26
ci_0028                -1.159155e-02 3 1  ON 27
ci_0029                -1.050761e-02 3 1  ON 28
ci_0030                -1.045295e-02 3 1  ON 29
ci_0031                 1.359557e-02 3 1  ON 30
ci_0032                 1.227614e-02 3 1  ON 31
ci_0033                 8.005837e-03 3 1  ON 32
ci_0034                 8.551549e-03 3 1  ON 33
ci_0035                 4.997546e-03 3 1  ON 34
ci_0036                 5.093092e-03 3 1  ON 35
ci_0037                -1.126306e-02 3 1  ON 36
ci_0038                -1.153303e-02 3 1  ON 37
ci_0039                -4.043980e-03 3 1  ON 38
ci_0040                -4.046661e-03 3 1  ON 39
ci_0041                 8.958707e-03 3 1  ON 40
ci_0042                 8.732890e-03 3 1  ON 41
ci_0043                -1.247857e-02 3 1  ON 42
ci_0044                -1.311666e-02 3 1  ON 43
ci_0045                 1.067607e-02 3 1  ON 44
ci_0046                 1.018260e-02 3 1  ON 45
ci_0047                -3.632671e-03 3 1  ON 46
ci_0048                -3.407744e-03 3 1  ON 47
ci_0049                -2.514918e-03 3 1  ON 48
ci_0050                -2.782854e-03 3 1  ON 49
ci_0051                -1.746886e-03 3 1  ON 50
ci_0052                -2.097454e-03 3 1  ON 51
ci_0053                -3.984586e-03 3 1  ON 52
ci_0054                -3.311226e-03 3 1  ON 53
ci_0055                 2.857168e-03 3 1  ON 54
ci_0056                 2.247177e-03 3 1  ON 55
ci_0057                 2.215584e-03 3 1  ON 56
ci_0058                 3.175203e-03 3 1  ON 57
ci_0059                -3.368682e-03 3 1  ON 58
ci_0060                -3.192144e-03 3 1  ON 59
ci_0061                -3.956908e-03 3 1  ON 60
ci_0062                -4.023635e-03 3 1  ON 61
ci_0063                -9.967408e-03 3 1  ON 62
ci_0064                -9.493177e-03 3 1  ON 63
ci_0065                -6.363414e-03 3 1  ON 64
ci_0066                -6.204393e-03 3 1  ON 65
ci_0067                -3.647857e-03 3 1  ON 66
ci_0068                -3.407645e-03 3 1  ON 67
ci_0069                 3.772060e-03 3 1  ON 68
ci_0070                 3.408446e-03 3 1  ON 69
ci_0071                 2.918487e-03 3 1  ON 70
ci_0072                 3.687912e-03 3 1  ON 71
ci_0073                 3.668207e-03 3 1  ON 72
ci_0074                 3.598796e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.8732
    reference variance = 0.311144
====================================================
  Execution time = 1.4277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9084e-01
  Total weights = 1.9508e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281906870739
                                         uncertainty =       0.001988391202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281906870739
                                         uncertainty =       0.001988391202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375428174
  error estimate for blocks of size 2^( 2) =       0.000392635295
  error estimate for blocks of size 2^( 3) =       0.000409779586
  error estimate for blocks of size 2^( 4) =       0.000425149721
  error estimate for blocks of size 2^( 5) =       0.000436894170
  error estimate for blocks of size 2^( 6) =       0.000444076512
  error estimate for blocks of size 2^( 7) =       0.000450620569

      target function =      -0.926057154372
              le_mean =     -16.897986463378
             les_mean =     285.833437442771
             stat err =       0.000439185243
             autocorr =       1.368490398794
   target nu stat err =       0.000439185243
   target dn stat err =       0.002597125677
      target stat err =       0.004163070859
              std dev =       0.530935615756
             le_variance =       0.281892628078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281900518646
                                         uncertainty =       0.001995144592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281900518646
                                         uncertainty =       0.001995144592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375423497
  error estimate for blocks of size 2^( 2) =       0.000392630777
  error estimate for blocks of size 2^( 3) =       0.000409763304
  error estimate for blocks of size 2^( 4) =       0.000425122035
  error estimate for blocks of size 2^( 5) =       0.000436863460
  error estimate for blocks of size 2^( 6) =       0.000444044307
  error estimate for blocks of size 2^( 7) =       0.000450559642

      target function =      -0.927127487451
              le_mean =     -16.897989980019
             les_mean =     285.832879507173
             stat err =       0.000439147361
             autocorr =       1.368288422037
   target nu stat err =       0.000439147361
   target dn stat err =       0.002459034378
      target stat err =       0.003958029243
              std dev =       0.530929001506
             le_variance =       0.281885604640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281887750002
                                         uncertainty =       0.001992073869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281887750002
                                         uncertainty =       0.001992073869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375415172
  error estimate for blocks of size 2^( 2) =       0.000392622493
  error estimate for blocks of size 2^( 3) =       0.000409760175
  error estimate for blocks of size 2^( 4) =       0.000425123456
  error estimate for blocks of size 2^( 5) =       0.000436866450
  error estimate for blocks of size 2^( 6) =       0.000444048868
  error estimate for blocks of size 2^( 7) =       0.000450577246

      target function =      -0.927347491824
              le_mean =     -16.897986412487
             les_mean =     285.832619818274
             stat err =       0.000439154005
             autocorr =       1.368390517517
   target nu stat err =       0.000439154005
   target dn stat err =       0.002449434612
      target stat err =       0.003944945065
              std dev =       0.530917227131
             le_variance =       0.281873102065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281901743002
                                         uncertainty =       0.001988848933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281901743002
                                         uncertainty =       0.001988848933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375424722
  error estimate for blocks of size 2^( 2) =       0.000392631872
  error estimate for blocks of size 2^( 3) =       0.000409775350
  error estimate for blocks of size 2^( 4) =       0.000425144616
  error estimate for blocks of size 2^( 5) =       0.000436888920
  error estimate for blocks of size 2^( 6) =       0.000444071493
  error estimate for blocks of size 2^( 7) =       0.000450613656

      target function =      -0.926494100593
              le_mean =     -16.897986230200
             les_mean =     285.833153135943
             stat err =       0.000439179671
             autocorr =       1.368480841034
   target nu stat err =       0.000439179671
   target dn stat err =       0.002534132754
      target stat err =       0.004069158832
              std dev =       0.530930734105
             le_variance =       0.281887444417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926057154372        initial
     3.5527e-01     3.5527e+00             1.2541e-03        -0.927127487451
     1.4211e+00     1.4211e+01             3.1449e-04        -0.927347491824  <--
     5.6843e+00     5.6843e+01             8.1040e-05        -0.926494100593

*****************************************************************************
Applying the update for shift_i =   1.4211e+00     and shift_s =   1.4211e+01
*****************************************************************************

  Execution time = 2.3858e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.079749e-01 3 1  ON 0
ci_0002                 6.933179e-01 3 1  ON 1
ci_0003                -3.125598e-02 3 1  ON 2
ci_0004                -3.038132e-02 3 1  ON 3
ci_0005                -3.059006e-02 3 1  ON 4
ci_0006                -3.068858e-02 3 1  ON 5
ci_0007                -1.391126e-02 3 1  ON 6
ci_0008                -1.364454e-02 3 1  ON 7
ci_0009                -1.888482e-02 3 1  ON 8
ci_0010                -1.816690e-02 3 1  ON 9
ci_0011                -1.478778e-02 3 1  ON 10
ci_0012                -1.471206e-02 3 1  ON 11
ci_0013                 1.534129e-02 3 1  ON 12
ci_0014                 1.478325e-02 3 1  ON 13
ci_0015                 1.592868e-02 3 1  ON 14
ci_0016                 1.551122e-02 3 1  ON 15
ci_0017                 1.342622e-02 3 1  ON 16
ci_0018                 1.318017e-02 3 1  ON 17
ci_0019                 1.301510e-02 3 1  ON 18
ci_0020                 1.260288e-02 3 1  ON 19
ci_0021                 7.756384e-03 3 1  ON 20
ci_0022                 8.399468e-03 3 1  ON 21
ci_0023                -1.187299e-02 3 1  ON 22
ci_0024                -1.139106e-02 3 1  ON 23
ci_0025                -2.063801e-03 3 1  ON 24
ci_0026                -2.820208e-03 3 1  ON 25
ci_0027                -1.200946e-02 3 1  ON 26
ci_0028                -1.159155e-02 3 1  ON 27
ci_0029                -1.050761e-02 3 1  ON 28
ci_0030                -1.045295e-02 3 1  ON 29
ci_0031                 1.359557e-02 3 1  ON 30
ci_0032                 1.227614e-02 3 1  ON 31
ci_0033                 8.005837e-03 3 1  ON 32
ci_0034                 8.551549e-03 3 1  ON 33
ci_0035                 4.997546e-03 3 1  ON 34
ci_0036                 5.093092e-03 3 1  ON 35
ci_0037                -1.126306e-02 3 1  ON 36
ci_0038                -1.153303e-02 3 1  ON 37
ci_0039                -4.043980e-03 3 1  ON 38
ci_0040                -4.046661e-03 3 1  ON 39
ci_0041                 8.958707e-03 3 1  ON 40
ci_0042                 8.732890e-03 3 1  ON 41
ci_0043                -1.247857e-02 3 1  ON 42
ci_0044                -1.311666e-02 3 1  ON 43
ci_0045                 1.067607e-02 3 1  ON 44
ci_0046                 1.018260e-02 3 1  ON 45
ci_0047                -3.632671e-03 3 1  ON 46
ci_0048                -3.407744e-03 3 1  ON 47
ci_0049                -2.514918e-03 3 1  ON 48
ci_0050                -2.782854e-03 3 1  ON 49
ci_0051                -1.746886e-03 3 1  ON 50
ci_0052                -2.097454e-03 3 1  ON 51
ci_0053                -3.984586e-03 3 1  ON 52
ci_0054                -3.311226e-03 3 1  ON 53
ci_0055                 2.857168e-03 3 1  ON 54
ci_0056                 2.247177e-03 3 1  ON 55
ci_0057                 2.215584e-03 3 1  ON 56
ci_0058                 3.175203e-03 3 1  ON 57
ci_0059                -3.368682e-03 3 1  ON 58
ci_0060                -3.192144e-03 3 1  ON 59
ci_0061                -3.956908e-03 3 1  ON 60
ci_0062                -4.023635e-03 3 1  ON 61
ci_0063                -9.967408e-03 3 1  ON 62
ci_0064                -9.493177e-03 3 1  ON 63
ci_0065                -6.363414e-03 3 1  ON 64
ci_0066                -6.204393e-03 3 1  ON 65
ci_0067                -3.647857e-03 3 1  ON 66
ci_0068                -3.407645e-03 3 1  ON 67
ci_0069                 3.772060e-03 3 1  ON 68
ci_0070                 3.408446e-03 3 1  ON 69
ci_0071                 2.918487e-03 3 1  ON 70
ci_0072                 3.687912e-03 3 1  ON 71
ci_0073                 3.668207e-03 3 1  ON 72
ci_0074                 3.598796e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8887
    reference variance = 0.158992
====================================================
  Execution time = 1.4545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9450e-01
  Total weights = 1.950653729e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282874145034
                                         uncertainty =       0.001912810390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282874145034
                                         uncertainty =       0.001912810390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376065325
  error estimate for blocks of size 2^( 2) =       0.000392938529
  error estimate for blocks of size 2^( 3) =       0.000410413188
  error estimate for blocks of size 2^( 4) =       0.000426069837
  error estimate for blocks of size 2^( 5) =       0.000438938828
  error estimate for blocks of size 2^( 6) =       0.000447746432
  error estimate for blocks of size 2^( 7) =       0.000454122216

      target function =      -0.921338781982
              le_mean =     -16.899202700627
             les_mean =     285.877551571679
             stat err =       0.000441719328
             autocorr =       1.379641413978
   target nu stat err =       0.000441719328
   target dn stat err =       0.002619674888
      target stat err =       0.004166150369
              std dev =       0.531836683345
             le_variance =       0.282850257752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689920270063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921356283832       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921474883135       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921498691720       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921504591297       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921506589835       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921507604713       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921508653405       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921509090661       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921509187286       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921509594722       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921509500961       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921509775704       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921509657964       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921509581827       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921509482790       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921509474024       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921509466125       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921509475432       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 4.111589e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921356283832       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921390779733       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921397559697       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921399161394       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921399674885       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921399939060       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921400203463       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921400307924       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921400334118       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921400436467       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921400405274       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921400466727       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921400432741       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921400413729       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921400393865       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921400393536       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921400392318       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921400394179       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 1.143838e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921356283832       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921365275155       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921367031067       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921367439971       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921367568904       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921367635551       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921367701607       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921367727294       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921367734001       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921367759525       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921367751157       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921367765963       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921367757220       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921367752556       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921367747935       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921367747956       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921367747693       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 2.979422e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.026150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7131e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.079140e-01 3 1  ON 0
ci_0002                 6.933872e-01 3 1  ON 1
ci_0003                -3.119142e-02 3 1  ON 2
ci_0004                -3.033141e-02 3 1  ON 3
ci_0005                -3.054721e-02 3 1  ON 4
ci_0006                -3.075563e-02 3 1  ON 5
ci_0007                -1.389738e-02 3 1  ON 6
ci_0008                -1.363658e-02 3 1  ON 7
ci_0009                -1.886906e-02 3 1  ON 8
ci_0010                -1.815336e-02 3 1  ON 9
ci_0011                -1.476487e-02 3 1  ON 10
ci_0012                -1.471278e-02 3 1  ON 11
ci_0013                 1.531573e-02 3 1  ON 12
ci_0014                 1.481821e-02 3 1  ON 13
ci_0015                 1.591309e-02 3 1  ON 14
ci_0016                 1.556023e-02 3 1  ON 15
ci_0017                 1.344793e-02 3 1  ON 16
ci_0018                 1.315110e-02 3 1  ON 17
ci_0019                 1.299846e-02 3 1  ON 18
ci_0020                 1.259396e-02 3 1  ON 19
ci_0021                 7.745457e-03 3 1  ON 20
ci_0022                 8.392219e-03 3 1  ON 21
ci_0023                -1.188906e-02 3 1  ON 22
ci_0024                -1.135899e-02 3 1  ON 23
ci_0025                -1.981196e-03 3 1  ON 24
ci_0026                -2.758317e-03 3 1  ON 25
ci_0027                -1.198310e-02 3 1  ON 26
ci_0028                -1.159996e-02 3 1  ON 27
ci_0029                -1.051123e-02 3 1  ON 28
ci_0030                -1.046810e-02 3 1  ON 29
ci_0031                 1.351778e-02 3 1  ON 30
ci_0032                 1.226601e-02 3 1  ON 31
ci_0033                 7.984322e-03 3 1  ON 32
ci_0034                 8.449627e-03 3 1  ON 33
ci_0035                 4.989361e-03 3 1  ON 34
ci_0036                 5.207476e-03 3 1  ON 35
ci_0037                -1.125682e-02 3 1  ON 36
ci_0038                -1.153985e-02 3 1  ON 37
ci_0039                -4.036542e-03 3 1  ON 38
ci_0040                -4.016959e-03 3 1  ON 39
ci_0041                 8.935982e-03 3 1  ON 40
ci_0042                 8.758288e-03 3 1  ON 41
ci_0043                -1.259008e-02 3 1  ON 42
ci_0044                -1.317822e-02 3 1  ON 43
ci_0045                 1.064879e-02 3 1  ON 44
ci_0046                 1.017159e-02 3 1  ON 45
ci_0047                -3.625053e-03 3 1  ON 46
ci_0048                -3.433230e-03 3 1  ON 47
ci_0049                -2.542480e-03 3 1  ON 48
ci_0050                -2.746633e-03 3 1  ON 49
ci_0051                -1.778598e-03 3 1  ON 50
ci_0052                -2.007779e-03 3 1  ON 51
ci_0053                -3.975641e-03 3 1  ON 52
ci_0054                -3.318628e-03 3 1  ON 53
ci_0055                 2.773339e-03 3 1  ON 54
ci_0056                 2.262102e-03 3 1  ON 55
ci_0057                 2.295720e-03 3 1  ON 56
ci_0058                 3.188435e-03 3 1  ON 57
ci_0059                -3.376173e-03 3 1  ON 58
ci_0060                -3.204133e-03 3 1  ON 59
ci_0061                -3.951506e-03 3 1  ON 60
ci_0062                -4.036312e-03 3 1  ON 61
ci_0063                -9.955674e-03 3 1  ON 62
ci_0064                -9.491109e-03 3 1  ON 63
ci_0065                -6.340366e-03 3 1  ON 64
ci_0066                -6.191640e-03 3 1  ON 65
ci_0067                -3.660226e-03 3 1  ON 66
ci_0068                -3.451654e-03 3 1  ON 67
ci_0069                 3.761977e-03 3 1  ON 68
ci_0070                 3.433944e-03 3 1  ON 69
ci_0071                 2.892569e-03 3 1  ON 70
ci_0072                 3.678487e-03 3 1  ON 71
ci_0073                 3.636260e-03 3 1  ON 72
ci_0074                 3.574492e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.309549
====================================================
  Execution time = 1.4268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9552e-01
  Total weights = 1.9512e+06
  Execution time = 1.8901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683464316
                                         uncertainty =       0.003217172413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683464316
                                         uncertainty =       0.003217172413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377990678
  error estimate for blocks of size 2^( 2) =       0.000394966056
  error estimate for blocks of size 2^( 3) =       0.000412650612
  error estimate for blocks of size 2^( 4) =       0.000428019616
  error estimate for blocks of size 2^( 5) =       0.000439357480
  error estimate for blocks of size 2^( 6) =       0.000447989280
  error estimate for blocks of size 2^( 7) =       0.000450905806

      target function =      -0.916651066600
              le_mean =     -16.898639754508
             les_mean =     285.861527325706
             stat err =       0.000441568046
             autocorr =       1.364687129846
   target nu stat err =       0.000441568046
   target dn stat err =       0.003816687020
      target stat err =       0.005950869910
              std dev =       0.534559543835
             le_variance =       0.285753905906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285616263629
                                         uncertainty =       0.003214823075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285616263629
                                         uncertainty =       0.003214823075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377946451
  error estimate for blocks of size 2^( 2) =       0.000394926580
  error estimate for blocks of size 2^( 3) =       0.000412614005
  error estimate for blocks of size 2^( 4) =       0.000427977949
  error estimate for blocks of size 2^( 5) =       0.000439308821
  error estimate for blocks of size 2^( 6) =       0.000447940126
  error estimate for blocks of size 2^( 7) =       0.000450839185

      target function =      -0.916993412758
              le_mean =     -16.898641814840
             les_mean =     285.861376057324
             stat err =       0.000441516520
             autocorr =       1.364688000185
   target nu stat err =       0.000441516520
   target dn stat err =       0.003790752607
      target stat err =       0.005915459037
              std dev =       0.534496997142
             le_variance =       0.285687039953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285638171403
                                         uncertainty =       0.003215551905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285638171403
                                         uncertainty =       0.003215551905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377960842
  error estimate for blocks of size 2^( 2) =       0.000394939112
  error estimate for blocks of size 2^( 3) =       0.000412625282
  error estimate for blocks of size 2^( 4) =       0.000427991486
  error estimate for blocks of size 2^( 5) =       0.000439326490
  error estimate for blocks of size 2^( 6) =       0.000447958418
  error estimate for blocks of size 2^( 7) =       0.000450866644

      target function =      -0.918036022061
              le_mean =     -16.898640356916
             les_mean =     285.860654145025
             stat err =       0.000441535760
             autocorr =       1.364703007998
   target nu stat err =       0.000441535760
   target dn stat err =       0.003778410799
      target stat err =       0.005909802258
              std dev =       0.534517349101
             le_variance =       0.285708796490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285676360911
                                         uncertainty =       0.003216943193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285676360911
                                         uncertainty =       0.003216943193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377985996
  error estimate for blocks of size 2^( 2) =       0.000394961774
  error estimate for blocks of size 2^( 3) =       0.000412646518
  error estimate for blocks of size 2^( 4) =       0.000428015172
  error estimate for blocks of size 2^( 5) =       0.000439353151
  error estimate for blocks of size 2^( 6) =       0.000447985359
  error estimate for blocks of size 2^( 7) =       0.000450901120

      target function =      -0.919201850629
              le_mean =     -16.898639766167
             les_mean =     285.859885969970
             stat err =       0.000441563700
             autocorr =       1.364694081603
   target nu stat err =       0.000441563700
   target dn stat err =       0.003595858321
      target stat err =       0.005643097569
              std dev =       0.534552922176
             le_variance =       0.285746826607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916651066600        initial
     3.5527e-01     3.5527e+00             4.1116e-04        -0.916993412758
     1.4211e+00     1.4211e+01             1.1438e-04        -0.918036022061
     5.6843e+00     5.6843e+01             2.9794e-05        -0.919201850629  <--

*****************************************************************************
Applying the update for shift_i =   5.6843e+00     and shift_s =   5.6843e+01
*****************************************************************************

  Execution time = 2.3811e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.079598e-01 3 1  ON 0
ci_0002                 6.933352e-01 3 1  ON 1
ci_0003                -3.123939e-02 3 1  ON 2
ci_0004                -3.036848e-02 3 1  ON 3
ci_0005                -3.057914e-02 3 1  ON 4
ci_0006                -3.070577e-02 3 1  ON 5
ci_0007                -1.390772e-02 3 1  ON 6
ci_0008                -1.364255e-02 3 1  ON 7
ci_0009                -1.888077e-02 3 1  ON 8
ci_0010                -1.816340e-02 3 1  ON 9
ci_0011                -1.478188e-02 3 1  ON 10
ci_0012                -1.471224e-02 3 1  ON 11
ci_0013                 1.533469e-02 3 1  ON 12
ci_0014                 1.479227e-02 3 1  ON 13
ci_0015                 1.592466e-02 3 1  ON 14
ci_0016                 1.552385e-02 3 1  ON 15
ci_0017                 1.343185e-02 3 1  ON 16
ci_0018                 1.317266e-02 3 1  ON 17
ci_0019                 1.301081e-02 3 1  ON 18
ci_0020                 1.260058e-02 3 1  ON 19
ci_0021                 7.753642e-03 3 1  ON 20
ci_0022                 8.397654e-03 3 1  ON 21
ci_0023                -1.187715e-02 3 1  ON 22
ci_0024                -1.138277e-02 3 1  ON 23
ci_0025                -2.042330e-03 3 1  ON 24
ci_0026                -2.804088e-03 3 1  ON 25
ci_0027                -1.200263e-02 3 1  ON 26
ci_0028                -1.159374e-02 3 1  ON 27
ci_0029                -1.050852e-02 3 1  ON 28
ci_0030                -1.045686e-02 3 1  ON 29
ci_0031                 1.357567e-02 3 1  ON 30
ci_0032                 1.227345e-02 3 1  ON 31
ci_0033                 8.000296e-03 3 1  ON 32
ci_0034                 8.525450e-03 3 1  ON 33
ci_0035                 4.995422e-03 3 1  ON 34
ci_0036                 5.122887e-03 3 1  ON 35
ci_0037                -1.126146e-02 3 1  ON 36
ci_0038                -1.153479e-02 3 1  ON 37
ci_0039                -4.042057e-03 3 1  ON 38
ci_0040                -4.038969e-03 3 1  ON 39
ci_0041                 8.952866e-03 3 1  ON 40
ci_0042                 8.739430e-03 3 1  ON 41
ci_0043                -1.250705e-02 3 1  ON 42
ci_0044                -1.313240e-02 3 1  ON 43
ci_0045                 1.066905e-02 3 1  ON 44
ci_0046                 1.017977e-02 3 1  ON 45
ci_0047                -3.630695e-03 3 1  ON 46
ci_0048                -3.414360e-03 3 1  ON 47
ci_0049                -2.522081e-03 3 1  ON 48
ci_0050                -2.773436e-03 3 1  ON 49
ci_0051                -1.755154e-03 3 1  ON 50
ci_0052                -2.074066e-03 3 1  ON 51
ci_0053                -3.982260e-03 3 1  ON 52
ci_0054                -3.313162e-03 3 1  ON 53
ci_0055                 2.835330e-03 3 1  ON 54
ci_0056                 2.251058e-03 3 1  ON 55
ci_0057                 2.236446e-03 3 1  ON 56
ci_0058                 3.178637e-03 3 1  ON 57
ci_0059                -3.370648e-03 3 1  ON 58
ci_0060                -3.195272e-03 3 1  ON 59
ci_0061                -3.955521e-03 3 1  ON 60
ci_0062                -4.026907e-03 3 1  ON 61
ci_0063                -9.964398e-03 3 1  ON 62
ci_0064                -9.492639e-03 3 1  ON 63
ci_0065                -6.357473e-03 3 1  ON 64
ci_0066                -6.201086e-03 3 1  ON 65
ci_0067                -3.651069e-03 3 1  ON 66
ci_0068                -3.419109e-03 3 1  ON 67
ci_0069                 3.769417e-03 3 1  ON 68
ci_0070                 3.415091e-03 3 1  ON 69
ci_0071                 2.911746e-03 3 1  ON 70
ci_0072                 3.685497e-03 3 1  ON 71
ci_0073                 3.659908e-03 3 1  ON 72
ci_0074                 3.592472e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0949e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9609
    reference variance = 0.324751
====================================================
  Execution time = 1.4569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9357e-01
  Total weights = 1.950557249e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283937591919
                                         uncertainty =       0.002016367307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283937591919
                                         uncertainty =       0.002016367307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376748356
  error estimate for blocks of size 2^( 2) =       0.000393722898
  error estimate for blocks of size 2^( 3) =       0.000411402416
  error estimate for blocks of size 2^( 4) =       0.000426927476
  error estimate for blocks of size 2^( 5) =       0.000437643709
  error estimate for blocks of size 2^( 6) =       0.000445152640
  error estimate for blocks of size 2^( 7) =       0.000448925047

      target function =      -0.922790298676
              le_mean =     -16.898011839190
             les_mean =     285.836372374859
             stat err =       0.000439662218
             autocorr =       1.361869710946
   target nu stat err =       0.000439662218
   target dn stat err =       0.002787935728
      target stat err =       0.004428779032
              std dev =       0.532802634776
             le_variance =       0.283878647624


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689801183919e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922810368019       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922859052612       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922863805904       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922865061339       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922866734543       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922867150417       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922867350948       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922867425197       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922867563523       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922867845158       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922867862244       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922867870531       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922867843364       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922867853021       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922867870053       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922867865275       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922867864199       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 1.825751e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922810368019       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922823036207       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922824267143       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922824587876       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922825012941       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922825116766       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922825166313       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922825184709       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922825219588       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922825289201       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922825291604       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922825292803       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922825286041       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922825288312       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922825292226       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922825291040       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922825290800       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 4.573584e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922810368019       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922813567731       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922813878247       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922813958867       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922814065557       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922814091498       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922814103845       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922814108433       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922814117171       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922814134515       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922814134996       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922814135244       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922814133558       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922814134117       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922814135074       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922814134778       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922814134720       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.143991e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.035494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7166e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.080055e-01 3 1  ON 0
ci_0002                 6.932925e-01 3 1  ON 1
ci_0003                -3.122789e-02 3 1  ON 2
ci_0004                -3.036547e-02 3 1  ON 3
ci_0005                -3.056717e-02 3 1  ON 4
ci_0006                -3.070266e-02 3 1  ON 5
ci_0007                -1.387435e-02 3 1  ON 6
ci_0008                -1.363779e-02 3 1  ON 7
ci_0009                -1.887718e-02 3 1  ON 8
ci_0010                -1.815847e-02 3 1  ON 9
ci_0011                -1.477734e-02 3 1  ON 10
ci_0012                -1.471391e-02 3 1  ON 11
ci_0013                 1.533736e-02 3 1  ON 12
ci_0014                 1.479298e-02 3 1  ON 13
ci_0015                 1.591516e-02 3 1  ON 14
ci_0016                 1.551548e-02 3 1  ON 15
ci_0017                 1.342141e-02 3 1  ON 16
ci_0018                 1.316499e-02 3 1  ON 17
ci_0019                 1.301140e-02 3 1  ON 18
ci_0020                 1.259526e-02 3 1  ON 19
ci_0021                 7.730788e-03 3 1  ON 20
ci_0022                 8.397886e-03 3 1  ON 21
ci_0023                -1.188060e-02 3 1  ON 22
ci_0024                -1.137342e-02 3 1  ON 23
ci_0025                -2.061705e-03 3 1  ON 24
ci_0026                -2.804617e-03 3 1  ON 25
ci_0027                -1.201191e-02 3 1  ON 26
ci_0028                -1.158878e-02 3 1  ON 27
ci_0029                -1.051709e-02 3 1  ON 28
ci_0030                -1.045597e-02 3 1  ON 29
ci_0031                 1.357492e-02 3 1  ON 30
ci_0032                 1.226106e-02 3 1  ON 31
ci_0033                 7.991678e-03 3 1  ON 32
ci_0034                 8.512441e-03 3 1  ON 33
ci_0035                 4.973217e-03 3 1  ON 34
ci_0036                 5.081015e-03 3 1  ON 35
ci_0037                -1.126832e-02 3 1  ON 36
ci_0038                -1.152872e-02 3 1  ON 37
ci_0039                -4.035064e-03 3 1  ON 38
ci_0040                -4.036491e-03 3 1  ON 39
ci_0041                 8.949357e-03 3 1  ON 40
ci_0042                 8.734458e-03 3 1  ON 41
ci_0043                -1.252040e-02 3 1  ON 42
ci_0044                -1.315785e-02 3 1  ON 43
ci_0045                 1.067380e-02 3 1  ON 44
ci_0046                 1.019029e-02 3 1  ON 45
ci_0047                -3.626292e-03 3 1  ON 46
ci_0048                -3.413007e-03 3 1  ON 47
ci_0049                -2.497230e-03 3 1  ON 48
ci_0050                -2.779763e-03 3 1  ON 49
ci_0051                -1.751751e-03 3 1  ON 50
ci_0052                -2.084137e-03 3 1  ON 51
ci_0053                -3.966589e-03 3 1  ON 52
ci_0054                -3.313179e-03 3 1  ON 53
ci_0055                 2.819888e-03 3 1  ON 54
ci_0056                 2.271072e-03 3 1  ON 55
ci_0057                 2.229298e-03 3 1  ON 56
ci_0058                 3.156314e-03 3 1  ON 57
ci_0059                -3.387663e-03 3 1  ON 58
ci_0060                -3.210445e-03 3 1  ON 59
ci_0061                -3.947033e-03 3 1  ON 60
ci_0062                -4.024647e-03 3 1  ON 61
ci_0063                -9.962638e-03 3 1  ON 62
ci_0064                -9.486404e-03 3 1  ON 63
ci_0065                -6.354300e-03 3 1  ON 64
ci_0066                -6.194101e-03 3 1  ON 65
ci_0067                -3.652404e-03 3 1  ON 66
ci_0068                -3.426728e-03 3 1  ON 67
ci_0069                 3.762794e-03 3 1  ON 68
ci_0070                 3.397659e-03 3 1  ON 69
ci_0071                 2.920207e-03 3 1  ON 70
ci_0072                 3.658753e-03 3 1  ON 71
ci_0073                 3.667211e-03 3 1  ON 72
ci_0074                 3.586423e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.177891
====================================================
  Execution time = 1.4299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9413e-01
  Total weights = 1.9512e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282316852825
                                         uncertainty =       0.001855794545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282316852825
                                         uncertainty =       0.001855794545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375720724
  error estimate for blocks of size 2^( 2) =       0.000392773852
  error estimate for blocks of size 2^( 3) =       0.000410552158
  error estimate for blocks of size 2^( 4) =       0.000425285649
  error estimate for blocks of size 2^( 5) =       0.000437965625
  error estimate for blocks of size 2^( 6) =       0.000445634995
  error estimate for blocks of size 2^( 7) =       0.000449480984

      target function =      -0.921916499072
              le_mean =     -16.899027168614
             les_mean =     285.871244669290
             stat err =       0.000439591813
             autocorr =       1.368891068607
   target nu stat err =       0.000439591813
   target dn stat err =       0.003135653109
      target stat err =       0.004966306449
              std dev =       0.531349343610
             le_variance =       0.282332124955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282313923470
                                         uncertainty =       0.001858431573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282313923470
                                         uncertainty =       0.001858431573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375718916
  error estimate for blocks of size 2^( 2) =       0.000392774810
  error estimate for blocks of size 2^( 3) =       0.000410554661
  error estimate for blocks of size 2^( 4) =       0.000425291193
  error estimate for blocks of size 2^( 5) =       0.000437971662
  error estimate for blocks of size 2^( 6) =       0.000445639279
  error estimate for blocks of size 2^( 7) =       0.000449481418

      target function =      -0.908401973711
              le_mean =     -16.899028738294
             les_mean =     285.879935494410
             stat err =       0.000439595888
             autocorr =       1.368929627162
   target nu stat err =       0.000439595888
   target dn stat err =       0.009100910045
      target stat err =       0.013858042315
              std dev =       0.531346786015
             le_variance =       0.282329407009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282314615290
                                         uncertainty =       0.001857130947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282314615290
                                         uncertainty =       0.001857130947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375719308
  error estimate for blocks of size 2^( 2) =       0.000392773996
  error estimate for blocks of size 2^( 3) =       0.000410553424
  error estimate for blocks of size 2^( 4) =       0.000425288863
  error estimate for blocks of size 2^( 5) =       0.000437969083
  error estimate for blocks of size 2^( 6) =       0.000445637510
  error estimate for blocks of size 2^( 7) =       0.000449481045

      target function =      -0.921882880806
              le_mean =     -16.899027751937
             les_mean =     285.871285775011
             stat err =       0.000439594125
             autocorr =       1.368915787646
   target nu stat err =       0.000439594125
   target dn stat err =       0.003143427476
      target stat err =       0.004977989315
              std dev =       0.531347341068
             le_variance =       0.282329996860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282316486258
                                         uncertainty =       0.001855958630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282316486258
                                         uncertainty =       0.001855958630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375720489
  error estimate for blocks of size 2^( 2) =       0.000392773815
  error estimate for blocks of size 2^( 3) =       0.000410552262
  error estimate for blocks of size 2^( 4) =       0.000425286002
  error estimate for blocks of size 2^( 5) =       0.000437966010
  error estimate for blocks of size 2^( 6) =       0.000445635261
  error estimate for blocks of size 2^( 7) =       0.000449480942

      target function =      -0.921920193096
              le_mean =     -16.899027232569
             les_mean =     285.871244463383
             stat err =       0.000439592054
             autocorr =       1.368894277705
   target nu stat err =       0.000439592054
   target dn stat err =       0.003136437267
      target stat err =       0.004967560422
              std dev =       0.531349011726
             le_variance =       0.282331772262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921916499072        initial
     1.4211e+00     1.4211e+01             1.8258e-04        -0.908401973711
     5.6843e+00     5.6843e+01             4.5736e-05        -0.921882880806
     2.2737e+01     2.2737e+02             1.1440e-05        -0.921920193096  <--

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 2.6874e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.079712e-01 3 1  ON 0
ci_0002                 6.933245e-01 3 1  ON 1
ci_0003                -3.123649e-02 3 1  ON 2
ci_0004                -3.036773e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070499e-02 3 1  ON 5
ci_0007                -1.389933e-02 3 1  ON 6
ci_0008                -1.364136e-02 3 1  ON 7
ci_0009                -1.887986e-02 3 1  ON 8
ci_0010                -1.816216e-02 3 1  ON 9
ci_0011                -1.478074e-02 3 1  ON 10
ci_0012                -1.471266e-02 3 1  ON 11
ci_0013                 1.533536e-02 3 1  ON 12
ci_0014                 1.479245e-02 3 1  ON 13
ci_0015                 1.592227e-02 3 1  ON 14
ci_0016                 1.552174e-02 3 1  ON 15
ci_0017                 1.342921e-02 3 1  ON 16
ci_0018                 1.317073e-02 3 1  ON 17
ci_0019                 1.301096e-02 3 1  ON 18
ci_0020                 1.259924e-02 3 1  ON 19
ci_0021                 7.747898e-03 3 1  ON 20
ci_0022                 8.397707e-03 3 1  ON 21
ci_0023                -1.187802e-02 3 1  ON 22
ci_0024                -1.138042e-02 3 1  ON 23
ci_0025                -2.047224e-03 3 1  ON 24
ci_0026                -2.804224e-03 3 1  ON 25
ci_0027                -1.200497e-02 3 1  ON 26
ci_0028                -1.159249e-02 3 1  ON 27
ci_0029                -1.051068e-02 3 1  ON 28
ci_0030                -1.045664e-02 3 1  ON 29
ci_0031                 1.357548e-02 3 1  ON 30
ci_0032                 1.227034e-02 3 1  ON 31
ci_0033                 7.998126e-03 3 1  ON 32
ci_0034                 8.522177e-03 3 1  ON 33
ci_0035                 4.989814e-03 3 1  ON 34
ci_0036                 5.112310e-03 3 1  ON 35
ci_0037                -1.126319e-02 3 1  ON 36
ci_0038                -1.153326e-02 3 1  ON 37
ci_0039                -4.040291e-03 3 1  ON 38
ci_0040                -4.038344e-03 3 1  ON 39
ci_0041                 8.951980e-03 3 1  ON 40
ci_0042                 8.738177e-03 3 1  ON 41
ci_0043                -1.251041e-02 3 1  ON 42
ci_0044                -1.313880e-02 3 1  ON 43
ci_0045                 1.067024e-02 3 1  ON 44
ci_0046                 1.018242e-02 3 1  ON 45
ci_0047                -3.629583e-03 3 1  ON 46
ci_0048                -3.414019e-03 3 1  ON 47
ci_0049                -2.515804e-03 3 1  ON 48
ci_0050                -2.775033e-03 3 1  ON 49
ci_0051                -1.754294e-03 3 1  ON 50
ci_0052                -2.076612e-03 3 1  ON 51
ci_0053                -3.978301e-03 3 1  ON 52
ci_0054                -3.313167e-03 3 1  ON 53
ci_0055                 2.831429e-03 3 1  ON 54
ci_0056                 2.256114e-03 3 1  ON 55
ci_0057                 2.234642e-03 3 1  ON 56
ci_0058                 3.173001e-03 3 1  ON 57
ci_0059                -3.374945e-03 3 1  ON 58
ci_0060                -3.199105e-03 3 1  ON 59
ci_0061                -3.953381e-03 3 1  ON 60
ci_0062                -4.026337e-03 3 1  ON 61
ci_0063                -9.963953e-03 3 1  ON 62
ci_0064                -9.491067e-03 3 1  ON 63
ci_0065                -6.356672e-03 3 1  ON 64
ci_0066                -6.199326e-03 3 1  ON 65
ci_0067                -3.651405e-03 3 1  ON 66
ci_0068                -3.421035e-03 3 1  ON 67
ci_0069                 3.767744e-03 3 1  ON 68
ci_0070                 3.410688e-03 3 1  ON 69
ci_0071                 2.913883e-03 3 1  ON 70
ci_0072                 3.678743e-03 3 1  ON 71
ci_0073                 3.661752e-03 3 1  ON 72
ci_0074                 3.590945e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4046e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.390096
====================================================
  Execution time = 1.4517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5207e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9249e-01
  Total weights = 1.950763432e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281701023774
                                         uncertainty =       0.001586228919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281701023774
                                         uncertainty =       0.001586228919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375366105
  error estimate for blocks of size 2^( 2) =       0.000392491328
  error estimate for blocks of size 2^( 3) =       0.000408990720
  error estimate for blocks of size 2^( 4) =       0.000424703991
  error estimate for blocks of size 2^( 5) =       0.000435490435
  error estimate for blocks of size 2^( 6) =       0.000442356615
  error estimate for blocks of size 2^( 7) =       0.000444790541

      target function =      -0.924493512594
              le_mean =     -16.898164596104
             les_mean =     285.840453754345
             stat err =       0.000436835395
             autocorr =       1.354333225267
   target nu stat err =       0.000436835395
   target dn stat err =       0.002372819241
      target stat err =       0.003803474558
              std dev =       0.530847836831
             le_variance =       0.281799425868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689816459610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924507951495       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924514192684       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924515071666       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924515378842       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924515534777       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924515637017       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924515661985       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924515672543       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924515670076       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924515675738       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924515676583       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924515680961       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924515680715       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924515682951       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924515682557       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924515681480       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924515680882       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 3.363948e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924507951495       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924509527652       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924509749189       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924509826294       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924509865333       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924509890904       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924509897098       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924509899720       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924509899094       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924509900506       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924509900717       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924509901808       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924509901744       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924509902299       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924509902193       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924509901925       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924509901777       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 8.455436e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924507951495       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924508346538       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924508402035       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924508421331       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924508431094       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924508437487       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924508439033       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924508439687       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924508439530       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924508439883       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924508439936       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924508440208       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924508440192       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924508440331       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924508440304       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924508440236       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924508440200       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+01 is 2.116727e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.044779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7102e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.079703e-01 3 1  ON 0
ci_0002                 6.933259e-01 3 1  ON 1
ci_0003                -3.123325e-02 3 1  ON 2
ci_0004                -3.036690e-02 3 1  ON 3
ci_0005                -3.057738e-02 3 1  ON 4
ci_0006                -3.070951e-02 3 1  ON 5
ci_0007                -1.389719e-02 3 1  ON 6
ci_0008                -1.364003e-02 3 1  ON 7
ci_0009                -1.887805e-02 3 1  ON 8
ci_0010                -1.815734e-02 3 1  ON 9
ci_0011                -1.478171e-02 3 1  ON 10
ci_0012                -1.470968e-02 3 1  ON 11
ci_0013                 1.533436e-02 3 1  ON 12
ci_0014                 1.479363e-02 3 1  ON 13
ci_0015                 1.592127e-02 3 1  ON 14
ci_0016                 1.552195e-02 3 1  ON 15
ci_0017                 1.342917e-02 3 1  ON 16
ci_0018                 1.317032e-02 3 1  ON 17
ci_0019                 1.301174e-02 3 1  ON 18
ci_0020                 1.260226e-02 3 1  ON 19
ci_0021                 7.741776e-03 3 1  ON 20
ci_0022                 8.389252e-03 3 1  ON 21
ci_0023                -1.187655e-02 3 1  ON 22
ci_0024                -1.137903e-02 3 1  ON 23
ci_0025                -2.051072e-03 3 1  ON 24
ci_0026                -2.804770e-03 3 1  ON 25
ci_0027                -1.200465e-02 3 1  ON 26
ci_0028                -1.159227e-02 3 1  ON 27
ci_0029                -1.051111e-02 3 1  ON 28
ci_0030                -1.045364e-02 3 1  ON 29
ci_0031                 1.357218e-02 3 1  ON 30
ci_0032                 1.226752e-02 3 1  ON 31
ci_0033                 7.999856e-03 3 1  ON 32
ci_0034                 8.520195e-03 3 1  ON 33
ci_0035                 4.990601e-03 3 1  ON 34
ci_0036                 5.111599e-03 3 1  ON 35
ci_0037                -1.126250e-02 3 1  ON 36
ci_0038                -1.153099e-02 3 1  ON 37
ci_0039                -4.038387e-03 3 1  ON 38
ci_0040                -4.038661e-03 3 1  ON 39
ci_0041                 8.953335e-03 3 1  ON 40
ci_0042                 8.739600e-03 3 1  ON 41
ci_0043                -1.251559e-02 3 1  ON 42
ci_0044                -1.314135e-02 3 1  ON 43
ci_0045                 1.066924e-02 3 1  ON 44
ci_0046                 1.018310e-02 3 1  ON 45
ci_0047                -3.629189e-03 3 1  ON 46
ci_0048                -3.413203e-03 3 1  ON 47
ci_0049                -2.520658e-03 3 1  ON 48
ci_0050                -2.775093e-03 3 1  ON 49
ci_0051                -1.753472e-03 3 1  ON 50
ci_0052                -2.077045e-03 3 1  ON 51
ci_0053                -3.974383e-03 3 1  ON 52
ci_0054                -3.316824e-03 3 1  ON 53
ci_0055                 2.826079e-03 3 1  ON 54
ci_0056                 2.256474e-03 3 1  ON 55
ci_0057                 2.237308e-03 3 1  ON 56
ci_0058                 3.166793e-03 3 1  ON 57
ci_0059                -3.375195e-03 3 1  ON 58
ci_0060                -3.199901e-03 3 1  ON 59
ci_0061                -3.953192e-03 3 1  ON 60
ci_0062                -4.027296e-03 3 1  ON 61
ci_0063                -9.963651e-03 3 1  ON 62
ci_0064                -9.490624e-03 3 1  ON 63
ci_0065                -6.358612e-03 3 1  ON 64
ci_0066                -6.201825e-03 3 1  ON 65
ci_0067                -3.649383e-03 3 1  ON 66
ci_0068                -3.422816e-03 3 1  ON 67
ci_0069                 3.766938e-03 3 1  ON 68
ci_0070                 3.407127e-03 3 1  ON 69
ci_0071                 2.912555e-03 3 1  ON 70
ci_0072                 3.679208e-03 3 1  ON 71
ci_0073                 3.662171e-03 3 1  ON 72
ci_0074                 3.591444e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.303459
====================================================
  Execution time = 1.4258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9836e-01
  Total weights = 1.9509e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285724308802
                                         uncertainty =       0.001772908888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285724308802
                                         uncertainty =       0.001772908888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377969273
  error estimate for blocks of size 2^( 2) =       0.000394787495
  error estimate for blocks of size 2^( 3) =       0.000411986061
  error estimate for blocks of size 2^( 4) =       0.000426470903
  error estimate for blocks of size 2^( 5) =       0.000437523187
  error estimate for blocks of size 2^( 6) =       0.000444976251
  error estimate for blocks of size 2^( 7) =       0.000449375570

      target function =      -0.915332117590
              le_mean =     -16.899075883867
             les_mean =     285.877125878783
             stat err =       0.000439586478
             autocorr =       1.352619545624
   target nu stat err =       0.000439586478
   target dn stat err =       0.003192478469
      target stat err =       0.004983585749
              std dev =       0.534529271679
             le_variance =       0.285721542282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285719153053
                                         uncertainty =       0.001772765078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285719153053
                                         uncertainty =       0.001772765078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377965849
  error estimate for blocks of size 2^( 2) =       0.000394784378
  error estimate for blocks of size 2^( 3) =       0.000411983121
  error estimate for blocks of size 2^( 4) =       0.000426467569
  error estimate for blocks of size 2^( 5) =       0.000437519518
  error estimate for blocks of size 2^( 6) =       0.000444972436
  error estimate for blocks of size 2^( 7) =       0.000449372679

      target function =      -0.914450919815
              le_mean =     -16.899076151382
             les_mean =     285.877705813309
             stat err =       0.000439583051
             autocorr =       1.352622963121
   target nu stat err =       0.000439583051
   target dn stat err =       0.003241415672
      target stat err =       0.005048676461
              std dev =       0.534524429094
             le_variance =       0.285716365298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285721696539
                                         uncertainty =       0.001772836330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285721696539
                                         uncertainty =       0.001772836330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377967538
  error estimate for blocks of size 2^( 2) =       0.000394785915
  error estimate for blocks of size 2^( 3) =       0.000411984572
  error estimate for blocks of size 2^( 4) =       0.000426469215
  error estimate for blocks of size 2^( 5) =       0.000437521322
  error estimate for blocks of size 2^( 6) =       0.000444974298
  error estimate for blocks of size 2^( 7) =       0.000449374080

      target function =      -0.915315010577
              le_mean =     -16.899076021476
             les_mean =     285.877141609041
             stat err =       0.000439584729
             autocorr =       1.352621201697
   target nu stat err =       0.000439584729
   target dn stat err =       0.003192687768
      target stat err =       0.004983721854
              std dev =       0.534526818122
             le_variance =       0.285718919292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285723979314
                                         uncertainty =       0.001772899747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285723979314
                                         uncertainty =       0.001772899747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377969054
  error estimate for blocks of size 2^( 2) =       0.000394787296
  error estimate for blocks of size 2^( 3) =       0.000411985873
  error estimate for blocks of size 2^( 4) =       0.000426470690
  error estimate for blocks of size 2^( 5) =       0.000437522952
  error estimate for blocks of size 2^( 6) =       0.000444976005
  error estimate for blocks of size 2^( 7) =       0.000449375382

      target function =      -0.915330907190
              le_mean =     -16.899075900812
             les_mean =     285.877127235231
             stat err =       0.000439586257
             autocorr =       1.352619754961
   target nu stat err =       0.000439586257
   target dn stat err =       0.003192503195
      target stat err =       0.004983610561
              std dev =       0.534528962218
             le_variance =       0.285721211450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915332117590        initial  <--
     5.6843e+00     5.6843e+01             3.3639e-05        -0.914450919815
     2.2737e+01     2.2737e+02             8.4554e-06        -0.915315010577
     9.0949e+01     9.0949e+02             2.1167e-06        -0.915330907190

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7494
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.079712e-01 3 1  ON 0
ci_0002                 6.933245e-01 3 1  ON 1
ci_0003                -3.123649e-02 3 1  ON 2
ci_0004                -3.036773e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070499e-02 3 1  ON 5
ci_0007                -1.389933e-02 3 1  ON 6
ci_0008                -1.364136e-02 3 1  ON 7
ci_0009                -1.887986e-02 3 1  ON 8
ci_0010                -1.816216e-02 3 1  ON 9
ci_0011                -1.478074e-02 3 1  ON 10
ci_0012                -1.471266e-02 3 1  ON 11
ci_0013                 1.533536e-02 3 1  ON 12
ci_0014                 1.479245e-02 3 1  ON 13
ci_0015                 1.592227e-02 3 1  ON 14
ci_0016                 1.552174e-02 3 1  ON 15
ci_0017                 1.342921e-02 3 1  ON 16
ci_0018                 1.317073e-02 3 1  ON 17
ci_0019                 1.301096e-02 3 1  ON 18
ci_0020                 1.259924e-02 3 1  ON 19
ci_0021                 7.747898e-03 3 1  ON 20
ci_0022                 8.397707e-03 3 1  ON 21
ci_0023                -1.187802e-02 3 1  ON 22
ci_0024                -1.138042e-02 3 1  ON 23
ci_0025                -2.047224e-03 3 1  ON 24
ci_0026                -2.804224e-03 3 1  ON 25
ci_0027                -1.200497e-02 3 1  ON 26
ci_0028                -1.159249e-02 3 1  ON 27
ci_0029                -1.051068e-02 3 1  ON 28
ci_0030                -1.045664e-02 3 1  ON 29
ci_0031                 1.357548e-02 3 1  ON 30
ci_0032                 1.227034e-02 3 1  ON 31
ci_0033                 7.998126e-03 3 1  ON 32
ci_0034                 8.522177e-03 3 1  ON 33
ci_0035                 4.989814e-03 3 1  ON 34
ci_0036                 5.112310e-03 3 1  ON 35
ci_0037                -1.126319e-02 3 1  ON 36
ci_0038                -1.153326e-02 3 1  ON 37
ci_0039                -4.040291e-03 3 1  ON 38
ci_0040                -4.038344e-03 3 1  ON 39
ci_0041                 8.951980e-03 3 1  ON 40
ci_0042                 8.738177e-03 3 1  ON 41
ci_0043                -1.251041e-02 3 1  ON 42
ci_0044                -1.313880e-02 3 1  ON 43
ci_0045                 1.067024e-02 3 1  ON 44
ci_0046                 1.018242e-02 3 1  ON 45
ci_0047                -3.629583e-03 3 1  ON 46
ci_0048                -3.414019e-03 3 1  ON 47
ci_0049                -2.515804e-03 3 1  ON 48
ci_0050                -2.775033e-03 3 1  ON 49
ci_0051                -1.754294e-03 3 1  ON 50
ci_0052                -2.076612e-03 3 1  ON 51
ci_0053                -3.978301e-03 3 1  ON 52
ci_0054                -3.313167e-03 3 1  ON 53
ci_0055                 2.831429e-03 3 1  ON 54
ci_0056                 2.256114e-03 3 1  ON 55
ci_0057                 2.234642e-03 3 1  ON 56
ci_0058                 3.173001e-03 3 1  ON 57
ci_0059                -3.374945e-03 3 1  ON 58
ci_0060                -3.199105e-03 3 1  ON 59
ci_0061                -3.953381e-03 3 1  ON 60
ci_0062                -4.026337e-03 3 1  ON 61
ci_0063                -9.963953e-03 3 1  ON 62
ci_0064                -9.491067e-03 3 1  ON 63
ci_0065                -6.356672e-03 3 1  ON 64
ci_0066                -6.199326e-03 3 1  ON 65
ci_0067                -3.651405e-03 3 1  ON 66
ci_0068                -3.421035e-03 3 1  ON 67
ci_0069                 3.767744e-03 3 1  ON 68
ci_0070                 3.410688e-03 3 1  ON 69
ci_0071                 2.913883e-03 3 1  ON 70
ci_0072                 3.678743e-03 3 1  ON 71
ci_0073                 3.661752e-03 3 1  ON 72
ci_0074                 3.590945e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.9926
    reference variance = 0.274958
====================================================
  Execution time = 1.4596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9184e-01
  Total weights = 1.951073321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282558633976
                                         uncertainty =       0.001634170260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282558633976
                                         uncertainty =       0.001634170260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375853768
  error estimate for blocks of size 2^( 2) =       0.000393046767
  error estimate for blocks of size 2^( 3) =       0.000410691240
  error estimate for blocks of size 2^( 4) =       0.000426042051
  error estimate for blocks of size 2^( 5) =       0.000437863366
  error estimate for blocks of size 2^( 6) =       0.000444188419
  error estimate for blocks of size 2^( 7) =       0.000447132970

      target function =      -0.925513806144
              le_mean =     -16.898215745994
             les_mean =     285.841535990837
             stat err =       0.000438806702
             autocorr =       1.363040264728
   target nu stat err =       0.000438806702
   target dn stat err =       0.002201105781
      target stat err =       0.003547794081
              std dev =       0.531537496867
             le_variance =       0.282532110576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689821574599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925525893533       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925526343621       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925526430753       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925526455601       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925526470718       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925526478463       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925526477542       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925526478381       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925526478834       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925526478724       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925526478263       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925526478317       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+01 is 3.637765e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925525893533       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925526006168       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925526027967       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925526034181       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925526037961       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925526039897       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925526039666       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925526039875       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925526039989       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925526039961       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925526039846       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925526039859       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+02 is 9.099310e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925525893533       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925525921699       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925525927149       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925525928703       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925525929649       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925525930135       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925525930076       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925525930127       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925525930156       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925525930148       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925525930120       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925525930124       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+02 is 2.275134e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.049588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7192e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.079713e-01 3 1  ON 0
ci_0002                 6.933246e-01 3 1  ON 1
ci_0003                -3.123628e-02 3 1  ON 2
ci_0004                -3.036749e-02 3 1  ON 3
ci_0005                -3.057610e-02 3 1  ON 4
ci_0006                -3.070495e-02 3 1  ON 5
ci_0007                -1.389915e-02 3 1  ON 6
ci_0008                -1.364135e-02 3 1  ON 7
ci_0009                -1.887982e-02 3 1  ON 8
ci_0010                -1.816218e-02 3 1  ON 9
ci_0011                -1.478073e-02 3 1  ON 10
ci_0012                -1.471270e-02 3 1  ON 11
ci_0013                 1.533545e-02 3 1  ON 12
ci_0014                 1.479238e-02 3 1  ON 13
ci_0015                 1.592207e-02 3 1  ON 14
ci_0016                 1.552113e-02 3 1  ON 15
ci_0017                 1.342916e-02 3 1  ON 16
ci_0018                 1.317045e-02 3 1  ON 17
ci_0019                 1.301097e-02 3 1  ON 18
ci_0020                 1.259927e-02 3 1  ON 19
ci_0021                 7.747429e-03 3 1  ON 20
ci_0022                 8.396797e-03 3 1  ON 21
ci_0023                -1.187802e-02 3 1  ON 22
ci_0024                -1.138016e-02 3 1  ON 23
ci_0025                -2.046986e-03 3 1  ON 24
ci_0026                -2.804098e-03 3 1  ON 25
ci_0027                -1.200483e-02 3 1  ON 26
ci_0028                -1.159238e-02 3 1  ON 27
ci_0029                -1.051091e-02 3 1  ON 28
ci_0030                -1.045688e-02 3 1  ON 29
ci_0031                 1.357529e-02 3 1  ON 30
ci_0032                 1.227036e-02 3 1  ON 31
ci_0033                 7.998042e-03 3 1  ON 32
ci_0034                 8.521926e-03 3 1  ON 33
ci_0035                 4.989756e-03 3 1  ON 34
ci_0036                 5.112135e-03 3 1  ON 35
ci_0037                -1.126318e-02 3 1  ON 36
ci_0038                -1.153308e-02 3 1  ON 37
ci_0039                -4.040329e-03 3 1  ON 38
ci_0040                -4.038313e-03 3 1  ON 39
ci_0041                 8.951968e-03 3 1  ON 40
ci_0042                 8.738476e-03 3 1  ON 41
ci_0043                -1.251095e-02 3 1  ON 42
ci_0044                -1.313908e-02 3 1  ON 43
ci_0045                 1.067025e-02 3 1  ON 44
ci_0046                 1.018239e-02 3 1  ON 45
ci_0047                -3.629430e-03 3 1  ON 46
ci_0048                -3.414016e-03 3 1  ON 47
ci_0049                -2.516114e-03 3 1  ON 48
ci_0050                -2.774947e-03 3 1  ON 49
ci_0051                -1.754329e-03 3 1  ON 50
ci_0052                -2.076585e-03 3 1  ON 51
ci_0053                -3.978289e-03 3 1  ON 52
ci_0054                -3.312980e-03 3 1  ON 53
ci_0055                 2.831039e-03 3 1  ON 54
ci_0056                 2.255808e-03 3 1  ON 55
ci_0057                 2.234756e-03 3 1  ON 56
ci_0058                 3.172979e-03 3 1  ON 57
ci_0059                -3.374932e-03 3 1  ON 58
ci_0060                -3.199208e-03 3 1  ON 59
ci_0061                -3.953651e-03 3 1  ON 60
ci_0062                -4.025883e-03 3 1  ON 61
ci_0063                -9.963733e-03 3 1  ON 62
ci_0064                -9.491050e-03 3 1  ON 63
ci_0065                -6.356461e-03 3 1  ON 64
ci_0066                -6.199309e-03 3 1  ON 65
ci_0067                -3.651363e-03 3 1  ON 66
ci_0068                -3.421134e-03 3 1  ON 67
ci_0069                 3.767598e-03 3 1  ON 68
ci_0070                 3.410543e-03 3 1  ON 69
ci_0071                 2.914270e-03 3 1  ON 70
ci_0072                 3.678343e-03 3 1  ON 71
ci_0073                 3.661650e-03 3 1  ON 72
ci_0074                 3.590591e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8463
    reference variance = 0.19026
====================================================
  Execution time = 1.4129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9158e-01
  Total weights = 1.9508e+06
  Execution time = 1.8846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281121675818
                                         uncertainty =       0.001763419075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281121675818
                                         uncertainty =       0.001763419075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374950198
  error estimate for blocks of size 2^( 2) =       0.000391759776
  error estimate for blocks of size 2^( 3) =       0.000409152409
  error estimate for blocks of size 2^( 4) =       0.000424896168
  error estimate for blocks of size 2^( 5) =       0.000437330704
  error estimate for blocks of size 2^( 6) =       0.000445950120
  error estimate for blocks of size 2^( 7) =       0.000451500436

      target function =      -0.925898924029
              le_mean =     -16.898180915018
             les_mean =     285.840100589457
             stat err =       0.000439919357
             autocorr =       1.376572122214
   target nu stat err =       0.000439919357
   target dn stat err =       0.003591721613
      target stat err =       0.005713238334
              std dev =       0.530259654833
             le_variance =       0.281175301543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281120825889
                                         uncertainty =       0.001763400680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281120825889
                                         uncertainty =       0.001763400680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374949631
  error estimate for blocks of size 2^( 2) =       0.000391759276
  error estimate for blocks of size 2^( 3) =       0.000409151930
  error estimate for blocks of size 2^( 4) =       0.000424895691
  error estimate for blocks of size 2^( 5) =       0.000437330231
  error estimate for blocks of size 2^( 6) =       0.000445949688
  error estimate for blocks of size 2^( 7) =       0.000451500064

      target function =      -0.925910858913
              le_mean =     -16.898180913699
             les_mean =     285.840092980073
             stat err =       0.000439918918
             autocorr =       1.376573539642
   target nu stat err =       0.000439918918
   target dn stat err =       0.003591391033
      target stat err =       0.005712867397
              std dev =       0.530258853053
             le_variance =       0.281174451241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281121250348
                                         uncertainty =       0.001763409874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281121250348
                                         uncertainty =       0.001763409874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374949914
  error estimate for blocks of size 2^( 2) =       0.000391759526
  error estimate for blocks of size 2^( 3) =       0.000409152170
  error estimate for blocks of size 2^( 4) =       0.000424895929
  error estimate for blocks of size 2^( 5) =       0.000437330467
  error estimate for blocks of size 2^( 6) =       0.000445949904
  error estimate for blocks of size 2^( 7) =       0.000451500250

      target function =      -0.925904940214
              le_mean =     -16.898180914335
             les_mean =     285.840096753053
             stat err =       0.000439919138
             autocorr =       1.376572831809
   target nu stat err =       0.000439919138
   target dn stat err =       0.003591555216
      target stat err =       0.005713051735
              std dev =       0.530259253466
             le_variance =       0.281174875886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281121622605
                                         uncertainty =       0.001763417924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281121622605
                                         uncertainty =       0.001763417924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374950162
  error estimate for blocks of size 2^( 2) =       0.000391759745
  error estimate for blocks of size 2^( 3) =       0.000409152379
  error estimate for blocks of size 2^( 4) =       0.000424896138
  error estimate for blocks of size 2^( 5) =       0.000437330674
  error estimate for blocks of size 2^( 6) =       0.000445950093
  error estimate for blocks of size 2^( 7) =       0.000451500413

      target function =      -0.925899681040
              le_mean =     -16.898180914930
             les_mean =     285.840100106650
             stat err =       0.000439919330
             autocorr =       1.376572210941
   target nu stat err =       0.000439919330
   target dn stat err =       0.003591700701
      target stat err =       0.005713214895
              std dev =       0.530259604634
             le_variance =       0.281175248307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925898924029        initial
     5.6843e+01     5.6843e+02             3.6378e-06        -0.925910858913  <--
     2.2737e+02     2.2737e+03             9.0993e-07        -0.925904940214
     9.0949e+02     9.0949e+03             2.2751e-07        -0.925899681040

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 2.3643e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.079714e-01 3 1  ON 0
ci_0002                 6.933247e-01 3 1  ON 1
ci_0003                -3.123564e-02 3 1  ON 2
ci_0004                -3.036678e-02 3 1  ON 3
ci_0005                -3.057599e-02 3 1  ON 4
ci_0006                -3.070481e-02 3 1  ON 5
ci_0007                -1.389863e-02 3 1  ON 6
ci_0008                -1.364132e-02 3 1  ON 7
ci_0009                -1.887967e-02 3 1  ON 8
ci_0010                -1.816223e-02 3 1  ON 9
ci_0011                -1.478072e-02 3 1  ON 10
ci_0012                -1.471282e-02 3 1  ON 11
ci_0013                 1.533572e-02 3 1  ON 12
ci_0014                 1.479216e-02 3 1  ON 13
ci_0015                 1.592148e-02 3 1  ON 14
ci_0016                 1.551930e-02 3 1  ON 15
ci_0017                 1.342899e-02 3 1  ON 16
ci_0018                 1.316960e-02 3 1  ON 17
ci_0019                 1.301101e-02 3 1  ON 18
ci_0020                 1.259935e-02 3 1  ON 19
ci_0021                 7.746024e-03 3 1  ON 20
ci_0022                 8.394069e-03 3 1  ON 21
ci_0023                -1.187802e-02 3 1  ON 22
ci_0024                -1.137940e-02 3 1  ON 23
ci_0025                -2.046273e-03 3 1  ON 24
ci_0026                -2.803724e-03 3 1  ON 25
ci_0027                -1.200440e-02 3 1  ON 26
ci_0028                -1.159206e-02 3 1  ON 27
ci_0029                -1.051159e-02 3 1  ON 28
ci_0030                -1.045758e-02 3 1  ON 29
ci_0031                 1.357472e-02 3 1  ON 30
ci_0032                 1.227042e-02 3 1  ON 31
ci_0033                 7.997790e-03 3 1  ON 32
ci_0034                 8.521171e-03 3 1  ON 33
ci_0035                 4.989582e-03 3 1  ON 34
ci_0036                 5.111609e-03 3 1  ON 35
ci_0037                -1.126318e-02 3 1  ON 36
ci_0038                -1.153255e-02 3 1  ON 37
ci_0039                -4.040443e-03 3 1  ON 38
ci_0040                -4.038223e-03 3 1  ON 39
ci_0041                 8.951930e-03 3 1  ON 40
ci_0042                 8.739373e-03 3 1  ON 41
ci_0043                -1.251257e-02 3 1  ON 42
ci_0044                -1.313995e-02 3 1  ON 43
ci_0045                 1.067028e-02 3 1  ON 44
ci_0046                 1.018231e-02 3 1  ON 45
ci_0047                -3.628969e-03 3 1  ON 46
ci_0048                -3.414006e-03 3 1  ON 47
ci_0049                -2.517042e-03 3 1  ON 48
ci_0050                -2.774691e-03 3 1  ON 49
ci_0051                -1.754433e-03 3 1  ON 50
ci_0052                -2.076506e-03 3 1  ON 51
ci_0053                -3.978252e-03 3 1  ON 52
ci_0054                -3.312421e-03 3 1  ON 53
ci_0055                 2.829867e-03 3 1  ON 54
ci_0056                 2.254892e-03 3 1  ON 55
ci_0057                 2.235099e-03 3 1  ON 56
ci_0058                 3.172916e-03 3 1  ON 57
ci_0059                -3.374893e-03 3 1  ON 58
ci_0060                -3.199517e-03 3 1  ON 59
ci_0061                -3.954460e-03 3 1  ON 60
ci_0062                -4.024521e-03 3 1  ON 61
ci_0063                -9.963073e-03 3 1  ON 62
ci_0064                -9.490998e-03 3 1  ON 63
ci_0065                -6.355830e-03 3 1  ON 64
ci_0066                -6.199257e-03 3 1  ON 65
ci_0067                -3.651236e-03 3 1  ON 66
ci_0068                -3.421431e-03 3 1  ON 67
ci_0069                 3.767162e-03 3 1  ON 68
ci_0070                 3.410108e-03 3 1  ON 69
ci_0071                 2.915432e-03 3 1  ON 70
ci_0072                 3.677144e-03 3 1  ON 71
ci_0073                 3.661345e-03 3 1  ON 72
ci_0074                 3.589531e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.939
    reference variance = 0.553885
====================================================
  Execution time = 1.4478e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9612e-01
  Total weights = 1.951035162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284430228954
                                         uncertainty =       0.002088197869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284430228954
                                         uncertainty =       0.002088197869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377065175
  error estimate for blocks of size 2^( 2) =       0.000394038122
  error estimate for blocks of size 2^( 3) =       0.000411549374
  error estimate for blocks of size 2^( 4) =       0.000427119484
  error estimate for blocks of size 2^( 5) =       0.000438650728
  error estimate for blocks of size 2^( 6) =       0.000446493213
  error estimate for blocks of size 2^( 7) =       0.000452282133

      target function =      -0.918794498359
              le_mean =     -16.898396199285
             les_mean =     285.851918889330
             stat err =       0.000441136390
             autocorr =       1.368714669897
   target nu stat err =       0.000441136390
   target dn stat err =       0.003380937123
      target stat err =       0.005304751247
              std dev =       0.533250684098
             le_variance =       0.284356292091


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689839619929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918823798164       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918829962809       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918830657309       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918830866593       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918830967496       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918831038084       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918831066329       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918831102917       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918831145316       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918831191310       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918831214218       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918831221582       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918831220584       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918831222923       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918831222933       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918831223926       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+01 is 2.502503e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918823798164       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918825345641       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918825519863       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918825572271       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918825597503       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918825615179       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918825622235       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918825631388       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918825641996       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918825653474       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918825659151       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918825660963       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918825660713       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918825661295       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918825661297       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918825661543       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+01 is 6.256895e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918823798164       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918824185430       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918824229023       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918824242131       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918824248439       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918824252860       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918824254623       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918824256912       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918824259564       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918824262433       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918824263849       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918824264300       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918824264237       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918824264382       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918824264384       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918824264445       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+02 is 1.564264e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.057809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7064e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.079656e-01 3 1  ON 0
ci_0002                 6.933309e-01 3 1  ON 1
ci_0003                -3.123493e-02 3 1  ON 2
ci_0004                -3.036430e-02 3 1  ON 3
ci_0005                -3.057543e-02 3 1  ON 4
ci_0006                -3.070591e-02 3 1  ON 5
ci_0007                -1.389833e-02 3 1  ON 6
ci_0008                -1.364003e-02 3 1  ON 7
ci_0009                -1.887852e-02 3 1  ON 8
ci_0010                -1.816274e-02 3 1  ON 9
ci_0011                -1.478061e-02 3 1  ON 10
ci_0012                -1.471226e-02 3 1  ON 11
ci_0013                 1.533581e-02 3 1  ON 12
ci_0014                 1.479109e-02 3 1  ON 13
ci_0015                 1.591995e-02 3 1  ON 14
ci_0016                 1.551901e-02 3 1  ON 15
ci_0017                 1.342953e-02 3 1  ON 16
ci_0018                 1.316901e-02 3 1  ON 17
ci_0019                 1.301163e-02 3 1  ON 18
ci_0020                 1.259932e-02 3 1  ON 19
ci_0021                 7.743081e-03 3 1  ON 20
ci_0022                 8.391684e-03 3 1  ON 21
ci_0023                -1.187783e-02 3 1  ON 22
ci_0024                -1.137896e-02 3 1  ON 23
ci_0025                -2.045360e-03 3 1  ON 24
ci_0026                -2.803101e-03 3 1  ON 25
ci_0027                -1.200351e-02 3 1  ON 26
ci_0028                -1.159336e-02 3 1  ON 27
ci_0029                -1.051232e-02 3 1  ON 28
ci_0030                -1.045860e-02 3 1  ON 29
ci_0031                 1.357252e-02 3 1  ON 30
ci_0032                 1.227019e-02 3 1  ON 31
ci_0033                 7.996863e-03 3 1  ON 32
ci_0034                 8.520041e-03 3 1  ON 33
ci_0035                 4.988692e-03 3 1  ON 34
ci_0036                 5.113741e-03 3 1  ON 35
ci_0037                -1.125914e-02 3 1  ON 36
ci_0038                -1.153175e-02 3 1  ON 37
ci_0039                -4.040473e-03 3 1  ON 38
ci_0040                -4.038304e-03 3 1  ON 39
ci_0041                 8.952850e-03 3 1  ON 40
ci_0042                 8.739099e-03 3 1  ON 41
ci_0043                -1.251403e-02 3 1  ON 42
ci_0044                -1.314259e-02 3 1  ON 43
ci_0045                 1.067046e-02 3 1  ON 44
ci_0046                 1.018249e-02 3 1  ON 45
ci_0047                -3.628963e-03 3 1  ON 46
ci_0048                -3.413685e-03 3 1  ON 47
ci_0049                -2.513937e-03 3 1  ON 48
ci_0050                -2.776315e-03 3 1  ON 49
ci_0051                -1.754039e-03 3 1  ON 50
ci_0052                -2.075712e-03 3 1  ON 51
ci_0053                -3.976642e-03 3 1  ON 52
ci_0054                -3.312462e-03 3 1  ON 53
ci_0055                 2.825562e-03 3 1  ON 54
ci_0056                 2.252812e-03 3 1  ON 55
ci_0057                 2.237844e-03 3 1  ON 56
ci_0058                 3.175421e-03 3 1  ON 57
ci_0059                -3.375765e-03 3 1  ON 58
ci_0060                -3.199949e-03 3 1  ON 59
ci_0061                -3.953930e-03 3 1  ON 60
ci_0062                -4.024113e-03 3 1  ON 61
ci_0063                -9.962786e-03 3 1  ON 62
ci_0064                -9.491629e-03 3 1  ON 63
ci_0065                -6.354944e-03 3 1  ON 64
ci_0066                -6.199781e-03 3 1  ON 65
ci_0067                -3.652068e-03 3 1  ON 66
ci_0068                -3.421763e-03 3 1  ON 67
ci_0069                 3.766316e-03 3 1  ON 68
ci_0070                 3.408598e-03 3 1  ON 69
ci_0071                 2.914511e-03 3 1  ON 70
ci_0072                 3.677890e-03 3 1  ON 71
ci_0073                 3.658326e-03 3 1  ON 72
ci_0074                 3.589258e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.181388
====================================================
  Execution time = 1.4127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9340e-01
  Total weights = 1.9511e+06
  Execution time = 1.8764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282967651356
                                         uncertainty =       0.001796603835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282967651356
                                         uncertainty =       0.001796603835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376117102
  error estimate for blocks of size 2^( 2) =       0.000393352315
  error estimate for blocks of size 2^( 3) =       0.000411231483
  error estimate for blocks of size 2^( 4) =       0.000427560336
  error estimate for blocks of size 2^( 5) =       0.000440117300
  error estimate for blocks of size 2^( 6) =       0.000449573652
  error estimate for blocks of size 2^( 7) =       0.000453691923

      target function =      -0.923065226920
              le_mean =     -16.898180567974
             les_mean =     285.841897758049
             stat err =       0.000442735803
             autocorr =       1.385616749677
   target nu stat err =       0.000442735803
   target dn stat err =       0.003029708001
      target stat err =       0.004807521342
              std dev =       0.531909906921
             le_variance =       0.282928149081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282968907962
                                         uncertainty =       0.001797992672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282968907962
                                         uncertainty =       0.001797992672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376117928
  error estimate for blocks of size 2^( 2) =       0.000393353295
  error estimate for blocks of size 2^( 3) =       0.000411232270
  error estimate for blocks of size 2^( 4) =       0.000427560869
  error estimate for blocks of size 2^( 5) =       0.000440117583
  error estimate for blocks of size 2^( 6) =       0.000449573381
  error estimate for blocks of size 2^( 7) =       0.000453691655

      target function =      -0.923051018666
              le_mean =     -16.898180748736
             les_mean =     285.841912863067
             stat err =       0.000442735872
             autocorr =       1.385611100370
   target nu stat err =       0.000442735872
   target dn stat err =       0.003036588470
      target stat err =       0.004818028258
              std dev =       0.531911074418
             le_variance =       0.282929391089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282968267546
                                         uncertainty =       0.001797298226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282968267546
                                         uncertainty =       0.001797298226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376117507
  error estimate for blocks of size 2^( 2) =       0.000393352798
  error estimate for blocks of size 2^( 3) =       0.000411231869
  error estimate for blocks of size 2^( 4) =       0.000427560596
  error estimate for blocks of size 2^( 5) =       0.000440117435
  error estimate for blocks of size 2^( 6) =       0.000449573508
  error estimate for blocks of size 2^( 7) =       0.000453691781

      target function =      -0.923059309183
              le_mean =     -16.898180657669
             les_mean =     285.841904530416
             stat err =       0.000442735830
             autocorr =       1.385613937148
   target nu stat err =       0.000442735830
   target dn stat err =       0.003033140670
      target stat err =       0.004812775309
              std dev =       0.531910479261
             le_variance =       0.282928757947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282967726966
                                         uncertainty =       0.001796690470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282967726966
                                         uncertainty =       0.001796690470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376117152
  error estimate for blocks of size 2^( 2) =       0.000393352375
  error estimate for blocks of size 2^( 3) =       0.000411231530
  error estimate for blocks of size 2^( 4) =       0.000427560368
  error estimate for blocks of size 2^( 5) =       0.000440117316
  error estimate for blocks of size 2^( 6) =       0.000449573633
  error estimate for blocks of size 2^( 7) =       0.000453691905

      target function =      -0.923065073423
              le_mean =     -16.898180579120
             les_mean =     285.841898228356
             stat err =       0.000442735805
             autocorr =       1.385616399219
   target nu stat err =       0.000442735805
   target dn stat err =       0.003030135309
      target stat err =       0.004808181370
              std dev =       0.531909977135
             le_variance =       0.282928223775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923065226920        initial  <--
     1.4211e+01     1.4211e+02             2.5025e-05        -0.923051018666
     5.6843e+01     5.6843e+02             6.2569e-06        -0.923059309183
     2.2737e+02     2.2737e+03             1.5643e-06        -0.923065073423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6223
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.079714e-01 3 1  ON 0
ci_0002                 6.933247e-01 3 1  ON 1
ci_0003                -3.123564e-02 3 1  ON 2
ci_0004                -3.036678e-02 3 1  ON 3
ci_0005                -3.057599e-02 3 1  ON 4
ci_0006                -3.070481e-02 3 1  ON 5
ci_0007                -1.389863e-02 3 1  ON 6
ci_0008                -1.364132e-02 3 1  ON 7
ci_0009                -1.887967e-02 3 1  ON 8
ci_0010                -1.816223e-02 3 1  ON 9
ci_0011                -1.478072e-02 3 1  ON 10
ci_0012                -1.471282e-02 3 1  ON 11
ci_0013                 1.533572e-02 3 1  ON 12
ci_0014                 1.479216e-02 3 1  ON 13
ci_0015                 1.592148e-02 3 1  ON 14
ci_0016                 1.551930e-02 3 1  ON 15
ci_0017                 1.342899e-02 3 1  ON 16
ci_0018                 1.316960e-02 3 1  ON 17
ci_0019                 1.301101e-02 3 1  ON 18
ci_0020                 1.259935e-02 3 1  ON 19
ci_0021                 7.746024e-03 3 1  ON 20
ci_0022                 8.394069e-03 3 1  ON 21
ci_0023                -1.187802e-02 3 1  ON 22
ci_0024                -1.137940e-02 3 1  ON 23
ci_0025                -2.046273e-03 3 1  ON 24
ci_0026                -2.803724e-03 3 1  ON 25
ci_0027                -1.200440e-02 3 1  ON 26
ci_0028                -1.159206e-02 3 1  ON 27
ci_0029                -1.051159e-02 3 1  ON 28
ci_0030                -1.045758e-02 3 1  ON 29
ci_0031                 1.357472e-02 3 1  ON 30
ci_0032                 1.227042e-02 3 1  ON 31
ci_0033                 7.997790e-03 3 1  ON 32
ci_0034                 8.521171e-03 3 1  ON 33
ci_0035                 4.989582e-03 3 1  ON 34
ci_0036                 5.111609e-03 3 1  ON 35
ci_0037                -1.126318e-02 3 1  ON 36
ci_0038                -1.153255e-02 3 1  ON 37
ci_0039                -4.040443e-03 3 1  ON 38
ci_0040                -4.038223e-03 3 1  ON 39
ci_0041                 8.951930e-03 3 1  ON 40
ci_0042                 8.739373e-03 3 1  ON 41
ci_0043                -1.251257e-02 3 1  ON 42
ci_0044                -1.313995e-02 3 1  ON 43
ci_0045                 1.067028e-02 3 1  ON 44
ci_0046                 1.018231e-02 3 1  ON 45
ci_0047                -3.628969e-03 3 1  ON 46
ci_0048                -3.414006e-03 3 1  ON 47
ci_0049                -2.517042e-03 3 1  ON 48
ci_0050                -2.774691e-03 3 1  ON 49
ci_0051                -1.754433e-03 3 1  ON 50
ci_0052                -2.076506e-03 3 1  ON 51
ci_0053                -3.978252e-03 3 1  ON 52
ci_0054                -3.312421e-03 3 1  ON 53
ci_0055                 2.829867e-03 3 1  ON 54
ci_0056                 2.254892e-03 3 1  ON 55
ci_0057                 2.235099e-03 3 1  ON 56
ci_0058                 3.172916e-03 3 1  ON 57
ci_0059                -3.374893e-03 3 1  ON 58
ci_0060                -3.199517e-03 3 1  ON 59
ci_0061                -3.954460e-03 3 1  ON 60
ci_0062                -4.024521e-03 3 1  ON 61
ci_0063                -9.963073e-03 3 1  ON 62
ci_0064                -9.490998e-03 3 1  ON 63
ci_0065                -6.355830e-03 3 1  ON 64
ci_0066                -6.199257e-03 3 1  ON 65
ci_0067                -3.651236e-03 3 1  ON 66
ci_0068                -3.421431e-03 3 1  ON 67
ci_0069                 3.767162e-03 3 1  ON 68
ci_0070                 3.410108e-03 3 1  ON 69
ci_0071                 2.915432e-03 3 1  ON 70
ci_0072                 3.677144e-03 3 1  ON 71
ci_0073                 3.661345e-03 3 1  ON 72
ci_0074                 3.589531e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9104
    reference variance = 0.513398
====================================================
  Execution time = 1.4510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9132e-01
  Total weights = 1.950988469e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281062901740
                                         uncertainty =       0.001867100022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281062901740
                                         uncertainty =       0.001867100022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374882300
  error estimate for blocks of size 2^( 2) =       0.000391606180
  error estimate for blocks of size 2^( 3) =       0.000408367512
  error estimate for blocks of size 2^( 4) =       0.000423472622
  error estimate for blocks of size 2^( 5) =       0.000435500860
  error estimate for blocks of size 2^( 6) =       0.000443161714
  error estimate for blocks of size 2^( 7) =       0.000448828727

      target function =      -0.926342502919
              le_mean =     -16.898991636854
             les_mean =     285.867238805309
             stat err =       0.000437740981
             autocorr =       1.363466719943
   target nu stat err =       0.000437740981
   target dn stat err =       0.002196666711
      target stat err =       0.003551846881
              std dev =       0.530163632580
             le_variance =       0.281073477310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689899163685e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926354740399       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926355049599       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926355092703       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926355109682       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926355114703       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926355116824       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926355117495       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926355118525       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926355119730       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926355121682       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926355121100       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926355120826       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926355120828       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926355121093       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926355121292       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926355121277       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926355121324       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+02 is 1.917468e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926354740399       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926354817731       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926354828510       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926354832756       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926354834010       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926354834542       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926354834709       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926354834966       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926354835269       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926354835755       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926354835610       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926354835541       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926354835542       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926354835609       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926354835658       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926354835654       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926354835666       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+02 is 4.794611e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926354740399       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926354759734       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926354762429       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926354763490       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926354763804       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926354763936       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926354763979       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926354764040       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926354764122       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926354764237       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926354764202       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926354764182       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926354764184       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926354764199       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926354764211       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926354764216       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926354764216       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+03 is 1.198712e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.067033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7161e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.079710e-01 3 1  ON 0
ci_0002                 6.933250e-01 3 1  ON 1
ci_0003                -3.123550e-02 3 1  ON 2
ci_0004                -3.036677e-02 3 1  ON 3
ci_0005                -3.057584e-02 3 1  ON 4
ci_0006                -3.070487e-02 3 1  ON 5
ci_0007                -1.389844e-02 3 1  ON 6
ci_0008                -1.364124e-02 3 1  ON 7
ci_0009                -1.887970e-02 3 1  ON 8
ci_0010                -1.816231e-02 3 1  ON 9
ci_0011                -1.478070e-02 3 1  ON 10
ci_0012                -1.471290e-02 3 1  ON 11
ci_0013                 1.533554e-02 3 1  ON 12
ci_0014                 1.479218e-02 3 1  ON 13
ci_0015                 1.592156e-02 3 1  ON 14
ci_0016                 1.551931e-02 3 1  ON 15
ci_0017                 1.342903e-02 3 1  ON 16
ci_0018                 1.316953e-02 3 1  ON 17
ci_0019                 1.301109e-02 3 1  ON 18
ci_0020                 1.259937e-02 3 1  ON 19
ci_0021                 7.745545e-03 3 1  ON 20
ci_0022                 8.394018e-03 3 1  ON 21
ci_0023                -1.187802e-02 3 1  ON 22
ci_0024                -1.137935e-02 3 1  ON 23
ci_0025                -2.046375e-03 3 1  ON 24
ci_0026                -2.803579e-03 3 1  ON 25
ci_0027                -1.200445e-02 3 1  ON 26
ci_0028                -1.159203e-02 3 1  ON 27
ci_0029                -1.051163e-02 3 1  ON 28
ci_0030                -1.045768e-02 3 1  ON 29
ci_0031                 1.357462e-02 3 1  ON 30
ci_0032                 1.227045e-02 3 1  ON 31
ci_0033                 7.997860e-03 3 1  ON 32
ci_0034                 8.521286e-03 3 1  ON 33
ci_0035                 4.989782e-03 3 1  ON 34
ci_0036                 5.111620e-03 3 1  ON 35
ci_0037                -1.126321e-02 3 1  ON 36
ci_0038                -1.153247e-02 3 1  ON 37
ci_0039                -4.040419e-03 3 1  ON 38
ci_0040                -4.038122e-03 3 1  ON 39
ci_0041                 8.951981e-03 3 1  ON 40
ci_0042                 8.739313e-03 3 1  ON 41
ci_0043                -1.251240e-02 3 1  ON 42
ci_0044                -1.314030e-02 3 1  ON 43
ci_0045                 1.067033e-02 3 1  ON 44
ci_0046                 1.018243e-02 3 1  ON 45
ci_0047                -3.628930e-03 3 1  ON 46
ci_0048                -3.414000e-03 3 1  ON 47
ci_0049                -2.517142e-03 3 1  ON 48
ci_0050                -2.774700e-03 3 1  ON 49
ci_0051                -1.754351e-03 3 1  ON 50
ci_0052                -2.076485e-03 3 1  ON 51
ci_0053                -3.978159e-03 3 1  ON 52
ci_0054                -3.312427e-03 3 1  ON 53
ci_0055                 2.829685e-03 3 1  ON 54
ci_0056                 2.254858e-03 3 1  ON 55
ci_0057                 2.235028e-03 3 1  ON 56
ci_0058                 3.172838e-03 3 1  ON 57
ci_0059                -3.374801e-03 3 1  ON 58
ci_0060                -3.199553e-03 3 1  ON 59
ci_0061                -3.954451e-03 3 1  ON 60
ci_0062                -4.024449e-03 3 1  ON 61
ci_0063                -9.962976e-03 3 1  ON 62
ci_0064                -9.491028e-03 3 1  ON 63
ci_0065                -6.355968e-03 3 1  ON 64
ci_0066                -6.199314e-03 3 1  ON 65
ci_0067                -3.651143e-03 3 1  ON 66
ci_0068                -3.421445e-03 3 1  ON 67
ci_0069                 3.766949e-03 3 1  ON 68
ci_0070                 3.410077e-03 3 1  ON 69
ci_0071                 2.915348e-03 3 1  ON 70
ci_0072                 3.677136e-03 3 1  ON 71
ci_0073                 3.661536e-03 3 1  ON 72
ci_0074                 3.589586e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9662
    reference variance = 0.206786
====================================================
  Execution time = 1.4228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9429e-01
  Total weights = 1.9510e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283807031462
                                         uncertainty =       0.001973722787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283807031462
                                         uncertainty =       0.001973722787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376821298
  error estimate for blocks of size 2^( 2) =       0.000393891999
  error estimate for blocks of size 2^( 3) =       0.000412002047
  error estimate for blocks of size 2^( 4) =       0.000427741619
  error estimate for blocks of size 2^( 5) =       0.000438844547
  error estimate for blocks of size 2^( 6) =       0.000445931044
  error estimate for blocks of size 2^( 7) =       0.000448784986

      target function =      -0.921669472993
              le_mean =     -16.898538423621
             les_mean =     285.854888259797
             stat err =       0.000440325549
             autocorr =       1.365453417284
   target nu stat err =       0.000440325549
   target dn stat err =       0.002649326633
      target stat err =       0.004209191090
              std dev =       0.532905789698
             le_variance =       0.283988580694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806592137
                                         uncertainty =       0.001973647748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806592137
                                         uncertainty =       0.001973647748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376821003
  error estimate for blocks of size 2^( 2) =       0.000393891712
  error estimate for blocks of size 2^( 3) =       0.000412001754
  error estimate for blocks of size 2^( 4) =       0.000427741320
  error estimate for blocks of size 2^( 5) =       0.000438844243
  error estimate for blocks of size 2^( 6) =       0.000445930734
  error estimate for blocks of size 2^( 7) =       0.000448784743

      target function =      -0.921671947382
              le_mean =     -16.898538430284
             les_mean =     285.854886903911
             stat err =       0.000440325260
             autocorr =       1.365453759546
   target nu stat err =       0.000440325260
   target dn stat err =       0.002649161292
      target stat err =       0.004208958871
              std dev =       0.532905373309
             le_variance =       0.283988136902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806811672
                                         uncertainty =       0.001973685250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283806811672
                                         uncertainty =       0.001973685250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376821150
  error estimate for blocks of size 2^( 2) =       0.000393891855
  error estimate for blocks of size 2^( 3) =       0.000412001901
  error estimate for blocks of size 2^( 4) =       0.000427741469
  error estimate for blocks of size 2^( 5) =       0.000438844395
  error estimate for blocks of size 2^( 6) =       0.000445930889
  error estimate for blocks of size 2^( 7) =       0.000448784864

      target function =      -0.921670714022
              le_mean =     -16.898538426946
             les_mean =     285.854887579201
             stat err =       0.000440325404
             autocorr =       1.365453588541
   target nu stat err =       0.000440325404
   target dn stat err =       0.002649243849
      target stat err =       0.004209074841
              std dev =       0.532905581383
             le_variance =       0.283988358669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283807003981
                                         uncertainty =       0.001973718094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283807003981
                                         uncertainty =       0.001973718094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376821279
  error estimate for blocks of size 2^( 2) =       0.000393891981
  error estimate for blocks of size 2^( 3) =       0.000412002029
  error estimate for blocks of size 2^( 4) =       0.000427741600
  error estimate for blocks of size 2^( 5) =       0.000438844528
  error estimate for blocks of size 2^( 6) =       0.000445931025
  error estimate for blocks of size 2^( 7) =       0.000448784971

      target function =      -0.921669628519
              le_mean =     -16.898538424036
             les_mean =     285.854888174446
             stat err =       0.000440325531
             autocorr =       1.365453438682
   target nu stat err =       0.000440325531
   target dn stat err =       0.002649316275
      target stat err =       0.004209176547
              std dev =       0.532905763651
             le_variance =       0.283988552933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921669472993        initial
     1.4211e+02     1.4211e+03             1.9175e-06        -0.921671947382  <--
     5.6843e+02     5.6843e+03             4.7946e-07        -0.921670714022
     2.2737e+03     2.2737e+04             1.1987e-07        -0.921669628519

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 2.7881e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.079700e-01 3 1  ON 0
ci_0002                 6.933261e-01 3 1  ON 1
ci_0003                -3.123509e-02 3 1  ON 2
ci_0004                -3.036673e-02 3 1  ON 3
ci_0005                -3.057537e-02 3 1  ON 4
ci_0006                -3.070507e-02 3 1  ON 5
ci_0007                -1.389788e-02 3 1  ON 6
ci_0008                -1.364097e-02 3 1  ON 7
ci_0009                -1.887978e-02 3 1  ON 8
ci_0010                -1.816255e-02 3 1  ON 9
ci_0011                -1.478064e-02 3 1  ON 10
ci_0012                -1.471312e-02 3 1  ON 11
ci_0013                 1.533500e-02 3 1  ON 12
ci_0014                 1.479226e-02 3 1  ON 13
ci_0015                 1.592183e-02 3 1  ON 14
ci_0016                 1.551934e-02 3 1  ON 15
ci_0017                 1.342915e-02 3 1  ON 16
ci_0018                 1.316931e-02 3 1  ON 17
ci_0019                 1.301133e-02 3 1  ON 18
ci_0020                 1.259942e-02 3 1  ON 19
ci_0021                 7.744106e-03 3 1  ON 20
ci_0022                 8.393864e-03 3 1  ON 21
ci_0023                -1.187800e-02 3 1  ON 22
ci_0024                -1.137920e-02 3 1  ON 23
ci_0025                -2.046680e-03 3 1  ON 24
ci_0026                -2.803146e-03 3 1  ON 25
ci_0027                -1.200457e-02 3 1  ON 26
ci_0028                -1.159192e-02 3 1  ON 27
ci_0029                -1.051176e-02 3 1  ON 28
ci_0030                -1.045795e-02 3 1  ON 29
ci_0031                 1.357431e-02 3 1  ON 30
ci_0032                 1.227053e-02 3 1  ON 31
ci_0033                 7.998069e-03 3 1  ON 32
ci_0034                 8.521630e-03 3 1  ON 33
ci_0035                 4.990380e-03 3 1  ON 34
ci_0036                 5.111652e-03 3 1  ON 35
ci_0037                -1.126329e-02 3 1  ON 36
ci_0038                -1.153224e-02 3 1  ON 37
ci_0039                -4.040347e-03 3 1  ON 38
ci_0040                -4.037820e-03 3 1  ON 39
ci_0041                 8.952135e-03 3 1  ON 40
ci_0042                 8.739134e-03 3 1  ON 41
ci_0043                -1.251188e-02 3 1  ON 42
ci_0044                -1.314137e-02 3 1  ON 43
ci_0045                 1.067047e-02 3 1  ON 44
ci_0046                 1.018277e-02 3 1  ON 45
ci_0047                -3.628814e-03 3 1  ON 46
ci_0048                -3.413980e-03 3 1  ON 47
ci_0049                -2.517442e-03 3 1  ON 48
ci_0050                -2.774727e-03 3 1  ON 49
ci_0051                -1.754104e-03 3 1  ON 50
ci_0052                -2.076422e-03 3 1  ON 51
ci_0053                -3.977879e-03 3 1  ON 52
ci_0054                -3.312446e-03 3 1  ON 53
ci_0055                 2.829139e-03 3 1  ON 54
ci_0056                 2.254757e-03 3 1  ON 55
ci_0057                 2.234818e-03 3 1  ON 56
ci_0058                 3.172605e-03 3 1  ON 57
ci_0059                -3.374523e-03 3 1  ON 58
ci_0060                -3.199659e-03 3 1  ON 59
ci_0061                -3.954426e-03 3 1  ON 60
ci_0062                -4.024234e-03 3 1  ON 61
ci_0063                -9.962684e-03 3 1  ON 62
ci_0064                -9.491118e-03 3 1  ON 63
ci_0065                -6.356383e-03 3 1  ON 64
ci_0066                -6.199488e-03 3 1  ON 65
ci_0067                -3.650864e-03 3 1  ON 66
ci_0068                -3.421486e-03 3 1  ON 67
ci_0069                 3.766307e-03 3 1  ON 68
ci_0070                 3.409986e-03 3 1  ON 69
ci_0071                 2.915097e-03 3 1  ON 70
ci_0072                 3.677111e-03 3 1  ON 71
ci_0073                 3.662112e-03 3 1  ON 72
ci_0074                 3.589750e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5048e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9167
    reference variance = 0.277633
====================================================
  Execution time = 1.4508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8848e-01
  Total weights = 1.950770394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280113076598
                                         uncertainty =       0.001413953754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280113076598
                                         uncertainty =       0.001413953754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374224316
  error estimate for blocks of size 2^( 2) =       0.000391083046
  error estimate for blocks of size 2^( 3) =       0.000408457488
  error estimate for blocks of size 2^( 4) =       0.000423913253
  error estimate for blocks of size 2^( 5) =       0.000434227662
  error estimate for blocks of size 2^( 6) =       0.000441874374
  error estimate for blocks of size 2^( 7) =       0.000448324608

      target function =      -0.930842575256
              le_mean =     -16.898232185601
             les_mean =     285.838730920372
             stat err =       0.000437084974
             autocorr =       1.364167649825
   target nu stat err =       0.000437084974
   target dn stat err =       0.001947988615
      target stat err =       0.003193877494
              std dev =       0.529233103567
             le_variance =       0.280087677911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689823218560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930852132442       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930852866866       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930853038246       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930853146649       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930853214032       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930853238466       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930853246636       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930853253136       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930853251795       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930853259509       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930853264732       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930853266194       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930853268434       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930853268495       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930853268724       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930853268496       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930853268309       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+01 is 9.279554e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930852132442       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930852316359       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930852359260       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930852386383       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930852403237       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930852409344       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930852411388       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930852413011       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930852412675       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930852414602       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930852415905       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930852416270       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930852416828       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930852416842       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930852416899       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930852416843       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930852416795       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+02 is 2.319967e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930852132442       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930852178441       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930852189170       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930852195952       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930852200166       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930852201693       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930852202204       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930852202609       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930852202525       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930852203007       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930852203331       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930852203424       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930852203562       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930852203566       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930852203580       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930852203565       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930852203554       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+02 is 5.799968e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.076178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7074e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.079723e-01 3 1  ON 0
ci_0002                 6.933238e-01 3 1  ON 1
ci_0003                -3.123501e-02 3 1  ON 2
ci_0004                -3.036658e-02 3 1  ON 3
ci_0005                -3.057568e-02 3 1  ON 4
ci_0006                -3.070529e-02 3 1  ON 5
ci_0007                -1.389756e-02 3 1  ON 6
ci_0008                -1.364011e-02 3 1  ON 7
ci_0009                -1.887963e-02 3 1  ON 8
ci_0010                -1.816248e-02 3 1  ON 9
ci_0011                -1.478041e-02 3 1  ON 10
ci_0012                -1.471248e-02 3 1  ON 11
ci_0013                 1.533537e-02 3 1  ON 12
ci_0014                 1.479231e-02 3 1  ON 13
ci_0015                 1.592161e-02 3 1  ON 14
ci_0016                 1.551936e-02 3 1  ON 15
ci_0017                 1.342917e-02 3 1  ON 16
ci_0018                 1.316952e-02 3 1  ON 17
ci_0019                 1.301154e-02 3 1  ON 18
ci_0020                 1.259968e-02 3 1  ON 19
ci_0021                 7.742874e-03 3 1  ON 20
ci_0022                 8.393720e-03 3 1  ON 21
ci_0023                -1.187807e-02 3 1  ON 22
ci_0024                -1.137901e-02 3 1  ON 23
ci_0025                -2.046509e-03 3 1  ON 24
ci_0026                -2.802577e-03 3 1  ON 25
ci_0027                -1.200489e-02 3 1  ON 26
ci_0028                -1.159222e-02 3 1  ON 27
ci_0029                -1.051215e-02 3 1  ON 28
ci_0030                -1.045813e-02 3 1  ON 29
ci_0031                 1.357367e-02 3 1  ON 30
ci_0032                 1.227080e-02 3 1  ON 31
ci_0033                 7.997171e-03 3 1  ON 32
ci_0034                 8.520124e-03 3 1  ON 33
ci_0035                 4.989932e-03 3 1  ON 34
ci_0036                 5.111205e-03 3 1  ON 35
ci_0037                -1.126295e-02 3 1  ON 36
ci_0038                -1.153228e-02 3 1  ON 37
ci_0039                -4.040312e-03 3 1  ON 38
ci_0040                -4.037696e-03 3 1  ON 39
ci_0041                 8.952130e-03 3 1  ON 40
ci_0042                 8.739119e-03 3 1  ON 41
ci_0043                -1.251344e-02 3 1  ON 42
ci_0044                -1.314167e-02 3 1  ON 43
ci_0045                 1.067015e-02 3 1  ON 44
ci_0046                 1.018294e-02 3 1  ON 45
ci_0047                -3.628822e-03 3 1  ON 46
ci_0048                -3.414031e-03 3 1  ON 47
ci_0049                -2.517123e-03 3 1  ON 48
ci_0050                -2.774948e-03 3 1  ON 49
ci_0051                -1.754423e-03 3 1  ON 50
ci_0052                -2.075932e-03 3 1  ON 51
ci_0053                -3.977515e-03 3 1  ON 52
ci_0054                -3.312297e-03 3 1  ON 53
ci_0055                 2.828951e-03 3 1  ON 54
ci_0056                 2.255126e-03 3 1  ON 55
ci_0057                 2.235141e-03 3 1  ON 56
ci_0058                 3.172784e-03 3 1  ON 57
ci_0059                -3.374399e-03 3 1  ON 58
ci_0060                -3.200044e-03 3 1  ON 59
ci_0061                -3.954499e-03 3 1  ON 60
ci_0062                -4.023838e-03 3 1  ON 61
ci_0063                -9.962142e-03 3 1  ON 62
ci_0064                -9.491206e-03 3 1  ON 63
ci_0065                -6.356290e-03 3 1  ON 64
ci_0066                -6.199485e-03 3 1  ON 65
ci_0067                -3.650970e-03 3 1  ON 66
ci_0068                -3.421826e-03 3 1  ON 67
ci_0069                 3.766369e-03 3 1  ON 68
ci_0070                 3.410173e-03 3 1  ON 69
ci_0071                 2.915854e-03 3 1  ON 70
ci_0072                 3.676795e-03 3 1  ON 71
ci_0073                 3.662082e-03 3 1  ON 72
ci_0074                 3.589926e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.162731
====================================================
  Execution time = 1.4177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.0705e-01
  Total weights = 1.9509e+06
  Execution time = 1.8888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292664977988
                                         uncertainty =       0.010895048220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292664977988
                                         uncertainty =       0.010895048220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382481589
  error estimate for blocks of size 2^( 2) =       0.000399204719
  error estimate for blocks of size 2^( 3) =       0.000416211283
  error estimate for blocks of size 2^( 4) =       0.000431262823
  error estimate for blocks of size 2^( 5) =       0.000443319575
  error estimate for blocks of size 2^( 6) =       0.000452258235
  error estimate for blocks of size 2^( 7) =       0.000457013131

      target function =      -0.901459518077
              le_mean =     -16.898224546621
             les_mean =     285.857044386024
             stat err =       0.000445963441
             autocorr =       1.359494472669
   target nu stat err =       0.000445963441
   target dn stat err =       0.016883840342
      target stat err =       0.025269300484
              std dev =       0.540910650476
             le_variance =       0.292584331799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292661857499
                                         uncertainty =       0.010892539437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292661857499
                                         uncertainty =       0.010892539437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382479556
  error estimate for blocks of size 2^( 2) =       0.000399202714
  error estimate for blocks of size 2^( 3) =       0.000416209332
  error estimate for blocks of size 2^( 4) =       0.000431260832
  error estimate for blocks of size 2^( 5) =       0.000443317591
  error estimate for blocks of size 2^( 6) =       0.000452256269
  error estimate for blocks of size 2^( 7) =       0.000457011312

      target function =      -0.901467779789
              le_mean =     -16.898224572490
             les_mean =     285.857039945282
             stat err =       0.000445961501
             autocorr =       1.359497098715
   target nu stat err =       0.000445961501
   target dn stat err =       0.016879960495
      target stat err =       0.025263953934
              std dev =       0.540907774858
             le_variance =       0.292581220901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292663414353
                                         uncertainty =       0.010893791421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292663414353
                                         uncertainty =       0.010893791421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382480570
  error estimate for blocks of size 2^( 2) =       0.000399203714
  error estimate for blocks of size 2^( 3) =       0.000416210306
  error estimate for blocks of size 2^( 4) =       0.000431261825
  error estimate for blocks of size 2^( 5) =       0.000443318581
  error estimate for blocks of size 2^( 6) =       0.000452257250
  error estimate for blocks of size 2^( 7) =       0.000457012220

      target function =      -0.901463856886
              le_mean =     -16.898224559513
             les_mean =     285.857042025186
             stat err =       0.000445962469
             autocorr =       1.359495788911
   target nu stat err =       0.000445962469
   target dn stat err =       0.016881896671
      target stat err =       0.025266633280
              std dev =       0.540909209543
             le_variance =       0.292582772968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292664782369
                                         uncertainty =       0.010894891035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292664782369
                                         uncertainty =       0.010894891035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382481461
  error estimate for blocks of size 2^( 2) =       0.000399204594
  error estimate for blocks of size 2^( 3) =       0.000416211161
  error estimate for blocks of size 2^( 4) =       0.000431262698
  error estimate for blocks of size 2^( 5) =       0.000443319451
  error estimate for blocks of size 2^( 6) =       0.000452258112
  error estimate for blocks of size 2^( 7) =       0.000457013017

      target function =      -0.901460091546
              le_mean =     -16.898224548226
             les_mean =     285.857044069886
             stat err =       0.000445963320
             autocorr =       1.359494637319
   target nu stat err =       0.000445963320
   target dn stat err =       0.016883597247
      target stat err =       0.025268968627
              std dev =       0.540910470208
             le_variance =       0.292584136781


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901459518077        initial
     3.5527e+01     3.5527e+02             9.2796e-06        -0.901467779789  <--
     1.4211e+02     1.4211e+03             2.3200e-06        -0.901463856886
     5.6843e+02     5.6843e+03             5.8000e-07        -0.901460091546

*****************************************************************************
Applying the update for shift_i =   3.5527e+01     and shift_s =   3.5527e+02
*****************************************************************************

  Execution time = 2.3714e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.079792e-01 3 1  ON 0
ci_0002                 6.933169e-01 3 1  ON 1
ci_0003                -3.123475e-02 3 1  ON 2
ci_0004                -3.036613e-02 3 1  ON 3
ci_0005                -3.057661e-02 3 1  ON 4
ci_0006                -3.070593e-02 3 1  ON 5
ci_0007                -1.389659e-02 3 1  ON 6
ci_0008                -1.363751e-02 3 1  ON 7
ci_0009                -1.887915e-02 3 1  ON 8
ci_0010                -1.816225e-02 3 1  ON 9
ci_0011                -1.477974e-02 3 1  ON 10
ci_0012                -1.471056e-02 3 1  ON 11
ci_0013                 1.533648e-02 3 1  ON 12
ci_0014                 1.479247e-02 3 1  ON 13
ci_0015                 1.592096e-02 3 1  ON 14
ci_0016                 1.551941e-02 3 1  ON 15
ci_0017                 1.342924e-02 3 1  ON 16
ci_0018                 1.317014e-02 3 1  ON 17
ci_0019                 1.301216e-02 3 1  ON 18
ci_0020                 1.260045e-02 3 1  ON 19
ci_0021                 7.739181e-03 3 1  ON 20
ci_0022                 8.393289e-03 3 1  ON 21
ci_0023                -1.187825e-02 3 1  ON 22
ci_0024                -1.137845e-02 3 1  ON 23
ci_0025                -2.045996e-03 3 1  ON 24
ci_0026                -2.800872e-03 3 1  ON 25
ci_0027                -1.200587e-02 3 1  ON 26
ci_0028                -1.159312e-02 3 1  ON 27
ci_0029                -1.051333e-02 3 1  ON 28
ci_0030                -1.045869e-02 3 1  ON 29
ci_0031                 1.357176e-02 3 1  ON 30
ci_0032                 1.227162e-02 3 1  ON 31
ci_0033                 7.994481e-03 3 1  ON 32
ci_0034                 8.515612e-03 3 1  ON 33
ci_0035                 4.988589e-03 3 1  ON 34
ci_0036                 5.109867e-03 3 1  ON 35
ci_0037                -1.126191e-02 3 1  ON 36
ci_0038                -1.153242e-02 3 1  ON 37
ci_0039                -4.040206e-03 3 1  ON 38
ci_0040                -4.037324e-03 3 1  ON 39
ci_0041                 8.952113e-03 3 1  ON 40
ci_0042                 8.739073e-03 3 1  ON 41
ci_0043                -1.251812e-02 3 1  ON 42
ci_0044                -1.314257e-02 3 1  ON 43
ci_0045                 1.066919e-02 3 1  ON 44
ci_0046                 1.018345e-02 3 1  ON 45
ci_0047                -3.628846e-03 3 1  ON 46
ci_0048                -3.414186e-03 3 1  ON 47
ci_0049                -2.516168e-03 3 1  ON 48
ci_0050                -2.775608e-03 3 1  ON 49
ci_0051                -1.755377e-03 3 1  ON 50
ci_0052                -2.074462e-03 3 1  ON 51
ci_0053                -3.976425e-03 3 1  ON 52
ci_0054                -3.311852e-03 3 1  ON 53
ci_0055                 2.828388e-03 3 1  ON 54
ci_0056                 2.256231e-03 3 1  ON 55
ci_0057                 2.236110e-03 3 1  ON 56
ci_0058                 3.173321e-03 3 1  ON 57
ci_0059                -3.374029e-03 3 1  ON 58
ci_0060                -3.201197e-03 3 1  ON 59
ci_0061                -3.954718e-03 3 1  ON 60
ci_0062                -4.022654e-03 3 1  ON 61
ci_0063                -9.960520e-03 3 1  ON 62
ci_0064                -9.491471e-03 3 1  ON 63
ci_0065                -6.356010e-03 3 1  ON 64
ci_0066                -6.199476e-03 3 1  ON 65
ci_0067                -3.651288e-03 3 1  ON 66
ci_0068                -3.422846e-03 3 1  ON 67
ci_0069                 3.766551e-03 3 1  ON 68
ci_0070                 3.410734e-03 3 1  ON 69
ci_0071                 2.918118e-03 3 1  ON 70
ci_0072                 3.675848e-03 3 1  ON 71
ci_0073                 3.661995e-03 3 1  ON 72
ci_0074                 3.590451e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9068
    reference variance = 0.369861
====================================================
  Execution time = 1.4657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9143e-01
  Total weights = 1.950841327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281259840939
                                         uncertainty =       0.001960443497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281259840939
                                         uncertainty =       0.001960443497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375000575
  error estimate for blocks of size 2^( 2) =       0.000392561520
  error estimate for blocks of size 2^( 3) =       0.000410314136
  error estimate for blocks of size 2^( 4) =       0.000425992859
  error estimate for blocks of size 2^( 5) =       0.000438039525
  error estimate for blocks of size 2^( 6) =       0.000444387736
  error estimate for blocks of size 2^( 7) =       0.000446209128

      target function =      -0.926161595830
              le_mean =     -16.898795831795
             les_mean =     285.860730497193
             stat err =       0.000438657312
             autocorr =       1.368317491460
   target nu stat err =       0.000438657312
   target dn stat err =       0.002665865123
      target stat err =       0.004276905995
              std dev =       0.530330899138
             le_variance =       0.281250862580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689879583179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926179807333       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926183830904       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926184372706       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926184576225       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926184699949       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926184796098       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926184791764       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926184796663       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926184812058       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926184806397       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926184811554       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926184818922       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926184814872       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926184810953       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926184808538       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926184808503       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926184807915       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+00 is 1.855708e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926179807333       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926180819967       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926180956117       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926181007143       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926181038142       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926181062207       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926181061089       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926181062311       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926181066161       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926181064736       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926181066027       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926181067853       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926181066831       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926181065856       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926181065261       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926181065253       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926181065108       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+01 is 4.655694e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926179807333       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926180060917       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926180094998       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926180107764       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926180115518       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926180121536       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926180121254       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926180121560       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926180122522       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926180122165       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926180122488       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926180122943       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926180122687       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926180122444       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926180122296       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926180122294       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926180122257       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+02 is 1.164955e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.085363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7226e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.079820e-01 3 1  ON 0
ci_0002                 6.933142e-01 3 1  ON 1
ci_0003                -3.123292e-02 3 1  ON 2
ci_0004                -3.036327e-02 3 1  ON 3
ci_0005                -3.057356e-02 3 1  ON 4
ci_0006                -3.070887e-02 3 1  ON 5
ci_0007                -1.389410e-02 3 1  ON 6
ci_0008                -1.363689e-02 3 1  ON 7
ci_0009                -1.887885e-02 3 1  ON 8
ci_0010                -1.816182e-02 3 1  ON 9
ci_0011                -1.478083e-02 3 1  ON 10
ci_0012                -1.471072e-02 3 1  ON 11
ci_0013                 1.533807e-02 3 1  ON 12
ci_0014                 1.479262e-02 3 1  ON 13
ci_0015                 1.592099e-02 3 1  ON 14
ci_0016                 1.551809e-02 3 1  ON 15
ci_0017                 1.342857e-02 3 1  ON 16
ci_0018                 1.316973e-02 3 1  ON 17
ci_0019                 1.301352e-02 3 1  ON 18
ci_0020                 1.260160e-02 3 1  ON 19
ci_0021                 7.736539e-03 3 1  ON 20
ci_0022                 8.390547e-03 3 1  ON 21
ci_0023                -1.188107e-02 3 1  ON 22
ci_0024                -1.137794e-02 3 1  ON 23
ci_0025                -2.046966e-03 3 1  ON 24
ci_0026                -2.797721e-03 3 1  ON 25
ci_0027                -1.200767e-02 3 1  ON 26
ci_0028                -1.159518e-02 3 1  ON 27
ci_0029                -1.051379e-02 3 1  ON 28
ci_0030                -1.045699e-02 3 1  ON 29
ci_0031                 1.357033e-02 3 1  ON 30
ci_0032                 1.227132e-02 3 1  ON 31
ci_0033                 7.994904e-03 3 1  ON 32
ci_0034                 8.516330e-03 3 1  ON 33
ci_0035                 4.990679e-03 3 1  ON 34
ci_0036                 5.110449e-03 3 1  ON 35
ci_0037                -1.126225e-02 3 1  ON 36
ci_0038                -1.153173e-02 3 1  ON 37
ci_0039                -4.039434e-03 3 1  ON 38
ci_0040                -4.036630e-03 3 1  ON 39
ci_0041                 8.952741e-03 3 1  ON 40
ci_0042                 8.739329e-03 3 1  ON 41
ci_0043                -1.252278e-02 3 1  ON 42
ci_0044                -1.314393e-02 3 1  ON 43
ci_0045                 1.066999e-02 3 1  ON 44
ci_0046                 1.018391e-02 3 1  ON 45
ci_0047                -3.628636e-03 3 1  ON 46
ci_0048                -3.413996e-03 3 1  ON 47
ci_0049                -2.517771e-03 3 1  ON 48
ci_0050                -2.775922e-03 3 1  ON 49
ci_0051                -1.752767e-03 3 1  ON 50
ci_0052                -2.074001e-03 3 1  ON 51
ci_0053                -3.975252e-03 3 1  ON 52
ci_0054                -3.313938e-03 3 1  ON 53
ci_0055                 2.826299e-03 3 1  ON 54
ci_0056                 2.258125e-03 3 1  ON 55
ci_0057                 2.233513e-03 3 1  ON 56
ci_0058                 3.173058e-03 3 1  ON 57
ci_0059                -3.375031e-03 3 1  ON 58
ci_0060                -3.201483e-03 3 1  ON 59
ci_0061                -3.954159e-03 3 1  ON 60
ci_0062                -4.022673e-03 3 1  ON 61
ci_0063                -9.959385e-03 3 1  ON 62
ci_0064                -9.491805e-03 3 1  ON 63
ci_0065                -6.355632e-03 3 1  ON 64
ci_0066                -6.199067e-03 3 1  ON 65
ci_0067                -3.651148e-03 3 1  ON 66
ci_0068                -3.422470e-03 3 1  ON 67
ci_0069                 3.764473e-03 3 1  ON 68
ci_0070                 3.411691e-03 3 1  ON 69
ci_0071                 2.916950e-03 3 1  ON 70
ci_0072                 3.672505e-03 3 1  ON 71
ci_0073                 3.662138e-03 3 1  ON 72
ci_0074                 3.591963e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.392841
====================================================
  Execution time = 1.4241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9013e-01
  Total weights = 1.9509e+06
  Execution time = 1.8818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279618117317
                                         uncertainty =       0.001663070670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279618117317
                                         uncertainty =       0.001663070670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373986171
  error estimate for blocks of size 2^( 2) =       0.000391034902
  error estimate for blocks of size 2^( 3) =       0.000408318628
  error estimate for blocks of size 2^( 4) =       0.000423372423
  error estimate for blocks of size 2^( 5) =       0.000435117172
  error estimate for blocks of size 2^( 6) =       0.000443009472
  error estimate for blocks of size 2^( 7) =       0.000444235351

      target function =      -0.928224568522
              le_mean =     -16.899456057614
             les_mean =     285.881748266870
             stat err =       0.000436433604
             autocorr =       1.361837470942
   target nu stat err =       0.000436433604
   target dn stat err =       0.002527410504
      target stat err =       0.004083825562
              std dev =       0.528896314826
             le_variance =       0.279731311836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279616640442
                                         uncertainty =       0.001663130652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279616640442
                                         uncertainty =       0.001663130652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373985161
  error estimate for blocks of size 2^( 2) =       0.000391033574
  error estimate for blocks of size 2^( 3) =       0.000408317016
  error estimate for blocks of size 2^( 4) =       0.000423370419
  error estimate for blocks of size 2^( 5) =       0.000435115010
  error estimate for blocks of size 2^( 6) =       0.000443006536
  error estimate for blocks of size 2^( 7) =       0.000444231367

      target function =      -0.928206981173
              le_mean =     -16.899455994438
             les_mean =     285.881757207522
             stat err =       0.000436430833
             autocorr =       1.361827529337
   target nu stat err =       0.000436430833
   target dn stat err =       0.002526892613
      target stat err =       0.004082863228
              std dev =       0.528894886509
             le_variance =       0.279729800976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279617366568
                                         uncertainty =       0.001663100734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279617366568
                                         uncertainty =       0.001663100734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373985657
  error estimate for blocks of size 2^( 2) =       0.000391034228
  error estimate for blocks of size 2^( 3) =       0.000408317812
  error estimate for blocks of size 2^( 4) =       0.000423371409
  error estimate for blocks of size 2^( 5) =       0.000435116080
  error estimate for blocks of size 2^( 6) =       0.000443007991
  error estimate for blocks of size 2^( 7) =       0.000444233344

      target function =      -0.928218642032
              le_mean =     -16.899456024651
             les_mean =     285.881750886008
             stat err =       0.000436432206
             autocorr =       1.361832480892
   target nu stat err =       0.000436432206
   target dn stat err =       0.002527108828
      target stat err =       0.004083302440
              std dev =       0.528895588969
             le_variance =       0.279730544031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279618022349
                                         uncertainty =       0.001663074424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279618022349
                                         uncertainty =       0.001663074424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373986106
  error estimate for blocks of size 2^( 2) =       0.000391034817
  error estimate for blocks of size 2^( 3) =       0.000408318525
  error estimate for blocks of size 2^( 4) =       0.000423372295
  error estimate for blocks of size 2^( 5) =       0.000435117035
  error estimate for blocks of size 2^( 6) =       0.000443009286
  error estimate for blocks of size 2^( 7) =       0.000444235099

      target function =      -0.928224071746
              le_mean =     -16.899456053357
             les_mean =     285.881748436038
             stat err =       0.000436433429
             autocorr =       1.361836847016
   target nu stat err =       0.000436433429
   target dn stat err =       0.002527369201
      target stat err =       0.004083756668
              std dev =       0.528896223029
             le_variance =       0.279731214735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928224568522        initial  <--
     8.8818e+00     8.8818e+01             1.8557e-05        -0.928206981173
     3.5527e+01     3.5527e+02             4.6557e-06        -0.928218642032
     1.4211e+02     1.4211e+03             1.1650e-06        -0.928224071746

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7476
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.079792e-01 3 1  ON 0
ci_0002                 6.933169e-01 3 1  ON 1
ci_0003                -3.123475e-02 3 1  ON 2
ci_0004                -3.036613e-02 3 1  ON 3
ci_0005                -3.057661e-02 3 1  ON 4
ci_0006                -3.070593e-02 3 1  ON 5
ci_0007                -1.389659e-02 3 1  ON 6
ci_0008                -1.363751e-02 3 1  ON 7
ci_0009                -1.887915e-02 3 1  ON 8
ci_0010                -1.816225e-02 3 1  ON 9
ci_0011                -1.477974e-02 3 1  ON 10
ci_0012                -1.471056e-02 3 1  ON 11
ci_0013                 1.533648e-02 3 1  ON 12
ci_0014                 1.479247e-02 3 1  ON 13
ci_0015                 1.592096e-02 3 1  ON 14
ci_0016                 1.551941e-02 3 1  ON 15
ci_0017                 1.342924e-02 3 1  ON 16
ci_0018                 1.317014e-02 3 1  ON 17
ci_0019                 1.301216e-02 3 1  ON 18
ci_0020                 1.260045e-02 3 1  ON 19
ci_0021                 7.739181e-03 3 1  ON 20
ci_0022                 8.393289e-03 3 1  ON 21
ci_0023                -1.187825e-02 3 1  ON 22
ci_0024                -1.137845e-02 3 1  ON 23
ci_0025                -2.045996e-03 3 1  ON 24
ci_0026                -2.800872e-03 3 1  ON 25
ci_0027                -1.200587e-02 3 1  ON 26
ci_0028                -1.159312e-02 3 1  ON 27
ci_0029                -1.051333e-02 3 1  ON 28
ci_0030                -1.045869e-02 3 1  ON 29
ci_0031                 1.357176e-02 3 1  ON 30
ci_0032                 1.227162e-02 3 1  ON 31
ci_0033                 7.994481e-03 3 1  ON 32
ci_0034                 8.515612e-03 3 1  ON 33
ci_0035                 4.988589e-03 3 1  ON 34
ci_0036                 5.109867e-03 3 1  ON 35
ci_0037                -1.126191e-02 3 1  ON 36
ci_0038                -1.153242e-02 3 1  ON 37
ci_0039                -4.040206e-03 3 1  ON 38
ci_0040                -4.037324e-03 3 1  ON 39
ci_0041                 8.952113e-03 3 1  ON 40
ci_0042                 8.739073e-03 3 1  ON 41
ci_0043                -1.251812e-02 3 1  ON 42
ci_0044                -1.314257e-02 3 1  ON 43
ci_0045                 1.066919e-02 3 1  ON 44
ci_0046                 1.018345e-02 3 1  ON 45
ci_0047                -3.628846e-03 3 1  ON 46
ci_0048                -3.414186e-03 3 1  ON 47
ci_0049                -2.516168e-03 3 1  ON 48
ci_0050                -2.775608e-03 3 1  ON 49
ci_0051                -1.755377e-03 3 1  ON 50
ci_0052                -2.074462e-03 3 1  ON 51
ci_0053                -3.976425e-03 3 1  ON 52
ci_0054                -3.311852e-03 3 1  ON 53
ci_0055                 2.828388e-03 3 1  ON 54
ci_0056                 2.256231e-03 3 1  ON 55
ci_0057                 2.236110e-03 3 1  ON 56
ci_0058                 3.173321e-03 3 1  ON 57
ci_0059                -3.374029e-03 3 1  ON 58
ci_0060                -3.201197e-03 3 1  ON 59
ci_0061                -3.954718e-03 3 1  ON 60
ci_0062                -4.022654e-03 3 1  ON 61
ci_0063                -9.960520e-03 3 1  ON 62
ci_0064                -9.491471e-03 3 1  ON 63
ci_0065                -6.356010e-03 3 1  ON 64
ci_0066                -6.199476e-03 3 1  ON 65
ci_0067                -3.651288e-03 3 1  ON 66
ci_0068                -3.422846e-03 3 1  ON 67
ci_0069                 3.766551e-03 3 1  ON 68
ci_0070                 3.410734e-03 3 1  ON 69
ci_0071                 2.918118e-03 3 1  ON 70
ci_0072                 3.675848e-03 3 1  ON 71
ci_0073                 3.661995e-03 3 1  ON 72
ci_0074                 3.590451e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.225821
====================================================
  Execution time = 1.4593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8864e-01
  Total weights = 1.951045966e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279767985277
                                         uncertainty =       0.001505312492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279767985277
                                         uncertainty =       0.001505312492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374039571
  error estimate for blocks of size 2^( 2) =       0.000391103478
  error estimate for blocks of size 2^( 3) =       0.000408779760
  error estimate for blocks of size 2^( 4) =       0.000423513730
  error estimate for blocks of size 2^( 5) =       0.000434245154
  error estimate for blocks of size 2^( 6) =       0.000441620913
  error estimate for blocks of size 2^( 7) =       0.000445698533

      target function =      -0.930592569737
              le_mean =     -16.898329846756
             les_mean =     285.842188026191
             stat err =       0.000436269582
             autocorr =       1.360425512191
   target nu stat err =       0.000436269582
   target dn stat err =       0.002187994107
      target stat err =       0.003565386995
              std dev =       0.528971834378
             le_variance =       0.279811201565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689832984676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930604709385       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930605134984       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930605186652       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930605207118       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930605234555       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930605245230       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930605252378       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930605254854       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930605257839       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930605258020       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930605261762       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930605263606       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930605263642       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930605264244       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930605264409       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930605264351       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930605264237       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+01 is 3.239798e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930604709385       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930604815856       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930604828780       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930604833899       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930604840760       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930604843429       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930604845216       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930604845834       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930604846581       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930604846626       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930604847561       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930604848021       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930604848031       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930604848181       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930604848221       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930604848208       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930604848179       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+02 is 8.099487e-07

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930604709385       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930604736007       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930604739239       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930604740518       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930604742234       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930604742902       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930604743348       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930604743503       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930604743687       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930604743699       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930604743931       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930604744047       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930604744053       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930604744090       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930604744103       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930604744094       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930604744088       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+03 is 2.024871e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.094566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7163e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.079800e-01 3 1  ON 0
ci_0002                 6.933161e-01 3 1  ON 1
ci_0003                -3.123468e-02 3 1  ON 2
ci_0004                -3.036602e-02 3 1  ON 3
ci_0005                -3.057646e-02 3 1  ON 4
ci_0006                -3.070542e-02 3 1  ON 5
ci_0007                -1.389635e-02 3 1  ON 6
ci_0008                -1.363756e-02 3 1  ON 7
ci_0009                -1.887925e-02 3 1  ON 8
ci_0010                -1.816224e-02 3 1  ON 9
ci_0011                -1.477983e-02 3 1  ON 10
ci_0012                -1.471053e-02 3 1  ON 11
ci_0013                 1.533646e-02 3 1  ON 12
ci_0014                 1.479235e-02 3 1  ON 13
ci_0015                 1.592100e-02 3 1  ON 14
ci_0016                 1.551944e-02 3 1  ON 15
ci_0017                 1.342924e-02 3 1  ON 16
ci_0018                 1.317009e-02 3 1  ON 17
ci_0019                 1.301218e-02 3 1  ON 18
ci_0020                 1.260068e-02 3 1  ON 19
ci_0021                 7.738877e-03 3 1  ON 20
ci_0022                 8.392629e-03 3 1  ON 21
ci_0023                -1.187837e-02 3 1  ON 22
ci_0024                -1.137841e-02 3 1  ON 23
ci_0025                -2.046316e-03 3 1  ON 24
ci_0026                -2.800718e-03 3 1  ON 25
ci_0027                -1.200586e-02 3 1  ON 26
ci_0028                -1.159310e-02 3 1  ON 27
ci_0029                -1.051353e-02 3 1  ON 28
ci_0030                -1.045888e-02 3 1  ON 29
ci_0031                 1.357176e-02 3 1  ON 30
ci_0032                 1.227159e-02 3 1  ON 31
ci_0033                 7.994471e-03 3 1  ON 32
ci_0034                 8.515457e-03 3 1  ON 33
ci_0035                 4.988627e-03 3 1  ON 34
ci_0036                 5.109631e-03 3 1  ON 35
ci_0037                -1.126196e-02 3 1  ON 36
ci_0038                -1.153222e-02 3 1  ON 37
ci_0039                -4.040204e-03 3 1  ON 38
ci_0040                -4.037255e-03 3 1  ON 39
ci_0041                 8.952066e-03 3 1  ON 40
ci_0042                 8.739014e-03 3 1  ON 41
ci_0043                -1.251855e-02 3 1  ON 42
ci_0044                -1.314248e-02 3 1  ON 43
ci_0045                 1.066919e-02 3 1  ON 44
ci_0046                 1.018349e-02 3 1  ON 45
ci_0047                -3.628743e-03 3 1  ON 46
ci_0048                -3.414260e-03 3 1  ON 47
ci_0049                -2.516618e-03 3 1  ON 48
ci_0050                -2.775601e-03 3 1  ON 49
ci_0051                -1.755485e-03 3 1  ON 50
ci_0052                -2.074522e-03 3 1  ON 51
ci_0053                -3.976359e-03 3 1  ON 52
ci_0054                -3.311991e-03 3 1  ON 53
ci_0055                 2.827900e-03 3 1  ON 54
ci_0056                 2.256263e-03 3 1  ON 55
ci_0057                 2.236202e-03 3 1  ON 56
ci_0058                 3.173058e-03 3 1  ON 57
ci_0059                -3.374141e-03 3 1  ON 58
ci_0060                -3.201441e-03 3 1  ON 59
ci_0061                -3.954838e-03 3 1  ON 60
ci_0062                -4.022635e-03 3 1  ON 61
ci_0063                -9.960482e-03 3 1  ON 62
ci_0064                -9.491600e-03 3 1  ON 63
ci_0065                -6.356101e-03 3 1  ON 64
ci_0066                -6.199515e-03 3 1  ON 65
ci_0067                -3.651265e-03 3 1  ON 66
ci_0068                -3.423007e-03 3 1  ON 67
ci_0069                 3.766312e-03 3 1  ON 68
ci_0070                 3.410539e-03 3 1  ON 69
ci_0071                 2.918212e-03 3 1  ON 70
ci_0072                 3.675736e-03 3 1  ON 71
ci_0073                 3.661962e-03 3 1  ON 72
ci_0074                 3.590364e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8539
    reference variance = 0.214257
====================================================
  Execution time = 1.4173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9429e-01
  Total weights = 1.9509e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238684837
                                         uncertainty =       0.003569568793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238684837
                                         uncertainty =       0.003569568793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377601479
  error estimate for blocks of size 2^( 2) =       0.000394468600
  error estimate for blocks of size 2^( 3) =       0.000411610974
  error estimate for blocks of size 2^( 4) =       0.000426783031
  error estimate for blocks of size 2^( 5) =       0.000439202980
  error estimate for blocks of size 2^( 6) =       0.000445900917
  error estimate for blocks of size 2^( 7) =       0.000451349596

      target function =      -0.921635585475
              le_mean =     -16.898769352808
             les_mean =     285.862700523354
             stat err =       0.000440809131
             autocorr =       1.362805228676
   target nu stat err =       0.000440809131
   target dn stat err =       0.003936790950
      target stat err =       0.006202999861
              std dev =       0.534009132462
             le_variance =       0.285165753553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238462404
                                         uncertainty =       0.003569514582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238462404
                                         uncertainty =       0.003569514582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377601332
  error estimate for blocks of size 2^( 2) =       0.000394468409
  error estimate for blocks of size 2^( 3) =       0.000411610721
  error estimate for blocks of size 2^( 4) =       0.000426782760
  error estimate for blocks of size 2^( 5) =       0.000439202692
  error estimate for blocks of size 2^( 6) =       0.000445900641
  error estimate for blocks of size 2^( 7) =       0.000451349325

      target function =      -0.921639091640
              le_mean =     -16.898769333944
             les_mean =     285.862697644324
             stat err =       0.000440808855
             autocorr =       1.362804577019
   target nu stat err =       0.000440808855
   target dn stat err =       0.003936771509
      target stat err =       0.006203016254
              std dev =       0.534008925308
             le_variance =       0.285165532309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238573411
                                         uncertainty =       0.003569541676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238573411
                                         uncertainty =       0.003569541676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377601405
  error estimate for blocks of size 2^( 2) =       0.000394468504
  error estimate for blocks of size 2^( 3) =       0.000411610848
  error estimate for blocks of size 2^( 4) =       0.000426782895
  error estimate for blocks of size 2^( 5) =       0.000439202836
  error estimate for blocks of size 2^( 6) =       0.000445900779
  error estimate for blocks of size 2^( 7) =       0.000451349461

      target function =      -0.921637508636
              le_mean =     -16.898769343366
             les_mean =     285.862698974767
             stat err =       0.000440808993
             autocorr =       1.362804903017
   target nu stat err =       0.000440808993
   target dn stat err =       0.003936779680
      target stat err =       0.006203007925
              std dev =       0.534009028689
             le_variance =       0.285165642721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238670890
                                         uncertainty =       0.003569565403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285238670890
                                         uncertainty =       0.003569565403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377601470
  error estimate for blocks of size 2^( 2) =       0.000394468588
  error estimate for blocks of size 2^( 3) =       0.000411610958
  error estimate for blocks of size 2^( 4) =       0.000426783014
  error estimate for blocks of size 2^( 5) =       0.000439202962
  error estimate for blocks of size 2^( 6) =       0.000445900900
  error estimate for blocks of size 2^( 7) =       0.000451349579

      target function =      -0.921635845681
              le_mean =     -16.898769351627
             les_mean =     285.862700317093
             stat err =       0.000440809114
             autocorr =       1.362805187984
   target nu stat err =       0.000440809114
   target dn stat err =       0.003936789354
      target stat err =       0.006203000843
              std dev =       0.534009119473
             le_variance =       0.285165739680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921635585475        initial
     8.8818e+01     8.8818e+02             3.2398e-06        -0.921639091640  <--
     3.5527e+02     3.5527e+03             8.0995e-07        -0.921637508636
     1.4211e+03     1.4211e+04             2.0249e-07        -0.921635845681

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 2.7348e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.079825e-01 3 1  ON 0
ci_0002                 6.933137e-01 3 1  ON 1
ci_0003                -3.123447e-02 3 1  ON 2
ci_0004                -3.036571e-02 3 1  ON 3
ci_0005                -3.057601e-02 3 1  ON 4
ci_0006                -3.070389e-02 3 1  ON 5
ci_0007                -1.389562e-02 3 1  ON 6
ci_0008                -1.363770e-02 3 1  ON 7
ci_0009                -1.887956e-02 3 1  ON 8
ci_0010                -1.816221e-02 3 1  ON 9
ci_0011                -1.478008e-02 3 1  ON 10
ci_0012                -1.471047e-02 3 1  ON 11
ci_0013                 1.533641e-02 3 1  ON 12
ci_0014                 1.479201e-02 3 1  ON 13
ci_0015                 1.592113e-02 3 1  ON 14
ci_0016                 1.551954e-02 3 1  ON 15
ci_0017                 1.342926e-02 3 1  ON 16
ci_0018                 1.316993e-02 3 1  ON 17
ci_0019                 1.301225e-02 3 1  ON 18
ci_0020                 1.260139e-02 3 1  ON 19
ci_0021                 7.737966e-03 3 1  ON 20
ci_0022                 8.390650e-03 3 1  ON 21
ci_0023                -1.187874e-02 3 1  ON 22
ci_0024                -1.137830e-02 3 1  ON 23
ci_0025                -2.047273e-03 3 1  ON 24
ci_0026                -2.800256e-03 3 1  ON 25
ci_0027                -1.200585e-02 3 1  ON 26
ci_0028                -1.159303e-02 3 1  ON 27
ci_0029                -1.051412e-02 3 1  ON 28
ci_0030                -1.045945e-02 3 1  ON 29
ci_0031                 1.357177e-02 3 1  ON 30
ci_0032                 1.227151e-02 3 1  ON 31
ci_0033                 7.994442e-03 3 1  ON 32
ci_0034                 8.514990e-03 3 1  ON 33
ci_0035                 4.988740e-03 3 1  ON 34
ci_0036                 5.108924e-03 3 1  ON 35
ci_0037                -1.126213e-02 3 1  ON 36
ci_0038                -1.153162e-02 3 1  ON 37
ci_0039                -4.040197e-03 3 1  ON 38
ci_0040                -4.037047e-03 3 1  ON 39
ci_0041                 8.951926e-03 3 1  ON 40
ci_0042                 8.738836e-03 3 1  ON 41
ci_0043                -1.251984e-02 3 1  ON 42
ci_0044                -1.314222e-02 3 1  ON 43
ci_0045                 1.066919e-02 3 1  ON 44
ci_0046                 1.018358e-02 3 1  ON 45
ci_0047                -3.628437e-03 3 1  ON 46
ci_0048                -3.414481e-03 3 1  ON 47
ci_0049                -2.517966e-03 3 1  ON 48
ci_0050                -2.775578e-03 3 1  ON 49
ci_0051                -1.755809e-03 3 1  ON 50
ci_0052                -2.074700e-03 3 1  ON 51
ci_0053                -3.976163e-03 3 1  ON 52
ci_0054                -3.312406e-03 3 1  ON 53
ci_0055                 2.826437e-03 3 1  ON 54
ci_0056                 2.256359e-03 3 1  ON 55
ci_0057                 2.236479e-03 3 1  ON 56
ci_0058                 3.172271e-03 3 1  ON 57
ci_0059                -3.374474e-03 3 1  ON 58
ci_0060                -3.202175e-03 3 1  ON 59
ci_0061                -3.955196e-03 3 1  ON 60
ci_0062                -4.022579e-03 3 1  ON 61
ci_0063                -9.960368e-03 3 1  ON 62
ci_0064                -9.491986e-03 3 1  ON 63
ci_0065                -6.356375e-03 3 1  ON 64
ci_0066                -6.199632e-03 3 1  ON 65
ci_0067                -3.651194e-03 3 1  ON 66
ci_0068                -3.423491e-03 3 1  ON 67
ci_0069                 3.765594e-03 3 1  ON 68
ci_0070                 3.409956e-03 3 1  ON 69
ci_0071                 2.918492e-03 3 1  ON 70
ci_0072                 3.675398e-03 3 1  ON 71
ci_0073                 3.661864e-03 3 1  ON 72
ci_0074                 3.590103e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4518e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9617
    reference variance = 0.361837
====================================================
  Execution time = 1.4621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9292e-01
  Total weights = 1.950883424e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282786564059
                                         uncertainty =       0.001796751291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282786564059
                                         uncertainty =       0.001796751291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375978306
  error estimate for blocks of size 2^( 2) =       0.000393262356
  error estimate for blocks of size 2^( 3) =       0.000411510578
  error estimate for blocks of size 2^( 4) =       0.000426531310
  error estimate for blocks of size 2^( 5) =       0.000438106344
  error estimate for blocks of size 2^( 6) =       0.000446506394
  error estimate for blocks of size 2^( 7) =       0.000450751752

      target function =      -0.923826395129
              le_mean =     -16.899323162494
             les_mean =     285.880041007147
             stat err =       0.000440473950
             autocorr =       1.372508000960
   target nu stat err =       0.000440473950
   target dn stat err =       0.002182010168
      target stat err =       0.003513617544
              std dev =       0.531713619062
             le_variance =       0.282719372696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689932316249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923838312123       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923839386634       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923839692377       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923839813363       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923839871200       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923839880833       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923839882446       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923839882212       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923839881609       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923839882821       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923839881743       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923839880773       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923839880594       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923839880802       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923839881134       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923839881232       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923839881493       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+01 is 1.244257e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923838312123       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923838581458       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923838658053       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923838688333       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923838702792       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923838705195       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923838705595       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923838705536       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923838705385       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923838705688       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923838705418       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923838705176       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923838705132       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923838705184       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923838705267       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923838705292       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923838705357       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+01 is 3.114801e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923838312123       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923838379501       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923838398660       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923838406232       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923838409847       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923838410447       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923838410547       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923838410533       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923838410495       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923838410570       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923838410503       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923838410443       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923838410432       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923838410444       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923838410466       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923838410471       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923838410488       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+02 is 7.789604e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.103800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7197e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.079821e-01 3 1  ON 0
ci_0002                 6.933143e-01 3 1  ON 1
ci_0003                -3.123351e-02 3 1  ON 2
ci_0004                -3.036539e-02 3 1  ON 3
ci_0005                -3.057533e-02 3 1  ON 4
ci_0006                -3.070457e-02 3 1  ON 5
ci_0007                -1.389467e-02 3 1  ON 6
ci_0008                -1.363654e-02 3 1  ON 7
ci_0009                -1.887946e-02 3 1  ON 8
ci_0010                -1.816226e-02 3 1  ON 9
ci_0011                -1.477974e-02 3 1  ON 10
ci_0012                -1.471039e-02 3 1  ON 11
ci_0013                 1.533611e-02 3 1  ON 12
ci_0014                 1.479250e-02 3 1  ON 13
ci_0015                 1.592012e-02 3 1  ON 14
ci_0016                 1.551907e-02 3 1  ON 15
ci_0017                 1.342921e-02 3 1  ON 16
ci_0018                 1.316930e-02 3 1  ON 17
ci_0019                 1.301231e-02 3 1  ON 18
ci_0020                 1.260102e-02 3 1  ON 19
ci_0021                 7.734852e-03 3 1  ON 20
ci_0022                 8.389894e-03 3 1  ON 21
ci_0023                -1.187902e-02 3 1  ON 22
ci_0024                -1.137855e-02 3 1  ON 23
ci_0025                -2.047232e-03 3 1  ON 24
ci_0026                -2.800426e-03 3 1  ON 25
ci_0027                -1.200579e-02 3 1  ON 26
ci_0028                -1.159331e-02 3 1  ON 27
ci_0029                -1.051420e-02 3 1  ON 28
ci_0030                -1.045943e-02 3 1  ON 29
ci_0031                 1.357149e-02 3 1  ON 30
ci_0032                 1.227218e-02 3 1  ON 31
ci_0033                 7.994941e-03 3 1  ON 32
ci_0034                 8.513970e-03 3 1  ON 33
ci_0035                 4.989329e-03 3 1  ON 34
ci_0036                 5.108557e-03 3 1  ON 35
ci_0037                -1.126276e-02 3 1  ON 36
ci_0038                -1.153168e-02 3 1  ON 37
ci_0039                -4.040333e-03 3 1  ON 38
ci_0040                -4.036958e-03 3 1  ON 39
ci_0041                 8.952093e-03 3 1  ON 40
ci_0042                 8.739064e-03 3 1  ON 41
ci_0043                -1.252049e-02 3 1  ON 42
ci_0044                -1.314388e-02 3 1  ON 43
ci_0045                 1.066908e-02 3 1  ON 44
ci_0046                 1.018414e-02 3 1  ON 45
ci_0047                -3.627754e-03 3 1  ON 46
ci_0048                -3.414173e-03 3 1  ON 47
ci_0049                -2.519572e-03 3 1  ON 48
ci_0050                -2.775344e-03 3 1  ON 49
ci_0051                -1.755517e-03 3 1  ON 50
ci_0052                -2.074289e-03 3 1  ON 51
ci_0053                -3.976486e-03 3 1  ON 52
ci_0054                -3.312415e-03 3 1  ON 53
ci_0055                 2.826324e-03 3 1  ON 54
ci_0056                 2.255966e-03 3 1  ON 55
ci_0057                 2.237146e-03 3 1  ON 56
ci_0058                 3.171702e-03 3 1  ON 57
ci_0059                -3.374069e-03 3 1  ON 58
ci_0060                -3.202689e-03 3 1  ON 59
ci_0061                -3.955540e-03 3 1  ON 60
ci_0062                -4.022126e-03 3 1  ON 61
ci_0063                -9.959904e-03 3 1  ON 62
ci_0064                -9.492219e-03 3 1  ON 63
ci_0065                -6.356188e-03 3 1  ON 64
ci_0066                -6.198725e-03 3 1  ON 65
ci_0067                -3.651466e-03 3 1  ON 66
ci_0068                -3.424016e-03 3 1  ON 67
ci_0069                 3.765124e-03 3 1  ON 68
ci_0070                 3.409638e-03 3 1  ON 69
ci_0071                 2.918304e-03 3 1  ON 70
ci_0072                 3.675580e-03 3 1  ON 71
ci_0073                 3.661484e-03 3 1  ON 72
ci_0074                 3.589326e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.224582
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9113e-01
  Total weights = 1.9508e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280981419131
                                         uncertainty =       0.001521625084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280981419131
                                         uncertainty =       0.001521625084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374792180
  error estimate for blocks of size 2^( 2) =       0.000391873930
  error estimate for blocks of size 2^( 3) =       0.000409610551
  error estimate for blocks of size 2^( 4) =       0.000425004867
  error estimate for blocks of size 2^( 5) =       0.000438366771
  error estimate for blocks of size 2^( 6) =       0.000444394061
  error estimate for blocks of size 2^( 7) =       0.000449199607

      target function =      -0.926636571974
              le_mean =     -16.898319914521
             les_mean =     285.844344714923
             stat err =       0.000439241326
             autocorr =       1.373489510185
   target nu stat err =       0.000439241326
   target dn stat err =       0.002306103058
      target stat err =       0.003719381903
              std dev =       0.530036184138
             le_variance =       0.280938356496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280979891024
                                         uncertainty =       0.001521531883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280979891024
                                         uncertainty =       0.001521531883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374791166
  error estimate for blocks of size 2^( 2) =       0.000391872918
  error estimate for blocks of size 2^( 3) =       0.000409609525
  error estimate for blocks of size 2^( 4) =       0.000425003858
  error estimate for blocks of size 2^( 5) =       0.000438365722
  error estimate for blocks of size 2^( 6) =       0.000444392846
  error estimate for blocks of size 2^( 7) =       0.000449198346

      target function =      -0.926631609529
              le_mean =     -16.898319927023
             les_mean =     285.844348275035
             stat err =       0.000439240193
             autocorr =       1.373489858012
   target nu stat err =       0.000439240193
   target dn stat err =       0.002306592278
      target stat err =       0.003720099638
              std dev =       0.530034749581
             le_variance =       0.280936835763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280980651863
                                         uncertainty =       0.001521578237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280980651863
                                         uncertainty =       0.001521578237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374791671
  error estimate for blocks of size 2^( 2) =       0.000391873422
  error estimate for blocks of size 2^( 3) =       0.000409610036
  error estimate for blocks of size 2^( 4) =       0.000425004361
  error estimate for blocks of size 2^( 5) =       0.000438366244
  error estimate for blocks of size 2^( 6) =       0.000444393452
  error estimate for blocks of size 2^( 7) =       0.000449198974

      target function =      -0.926634226212
              le_mean =     -16.898319920643
             les_mean =     285.844346404861
             stat err =       0.000439240758
             autocorr =       1.373489686951
   target nu stat err =       0.000439240758
   target dn stat err =       0.002306346153
      target stat err =       0.003719739491
              std dev =       0.530035463838
             le_variance =       0.280937592925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280981322957
                                         uncertainty =       0.001521619204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280981322957
                                         uncertainty =       0.001521619204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374792116
  error estimate for blocks of size 2^( 2) =       0.000391873867
  error estimate for blocks of size 2^( 3) =       0.000409610486
  error estimate for blocks of size 2^( 4) =       0.000425004804
  error estimate for blocks of size 2^( 5) =       0.000438366705
  error estimate for blocks of size 2^( 6) =       0.000444393985
  error estimate for blocks of size 2^( 7) =       0.000449199528

      target function =      -0.926636292898
              le_mean =     -16.898319915272
             les_mean =     285.844344916721
             stat err =       0.000439241255
             autocorr =       1.373489532512
   target nu stat err =       0.000439241255
   target dn stat err =       0.002306133230
      target stat err =       0.003719426380
              std dev =       0.530036093851
             le_variance =       0.280938260785


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926636571974        initial  <--
     2.2204e+01     2.2204e+02             1.2443e-05        -0.926631609529
     8.8818e+01     8.8818e+02             3.1148e-06        -0.926634226212
     3.5527e+02     3.5527e+03             7.7896e-07        -0.926636292898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8071
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.079825e-01 3 1  ON 0
ci_0002                 6.933137e-01 3 1  ON 1
ci_0003                -3.123447e-02 3 1  ON 2
ci_0004                -3.036571e-02 3 1  ON 3
ci_0005                -3.057601e-02 3 1  ON 4
ci_0006                -3.070389e-02 3 1  ON 5
ci_0007                -1.389562e-02 3 1  ON 6
ci_0008                -1.363770e-02 3 1  ON 7
ci_0009                -1.887956e-02 3 1  ON 8
ci_0010                -1.816221e-02 3 1  ON 9
ci_0011                -1.478008e-02 3 1  ON 10
ci_0012                -1.471047e-02 3 1  ON 11
ci_0013                 1.533641e-02 3 1  ON 12
ci_0014                 1.479201e-02 3 1  ON 13
ci_0015                 1.592113e-02 3 1  ON 14
ci_0016                 1.551954e-02 3 1  ON 15
ci_0017                 1.342926e-02 3 1  ON 16
ci_0018                 1.316993e-02 3 1  ON 17
ci_0019                 1.301225e-02 3 1  ON 18
ci_0020                 1.260139e-02 3 1  ON 19
ci_0021                 7.737966e-03 3 1  ON 20
ci_0022                 8.390650e-03 3 1  ON 21
ci_0023                -1.187874e-02 3 1  ON 22
ci_0024                -1.137830e-02 3 1  ON 23
ci_0025                -2.047273e-03 3 1  ON 24
ci_0026                -2.800256e-03 3 1  ON 25
ci_0027                -1.200585e-02 3 1  ON 26
ci_0028                -1.159303e-02 3 1  ON 27
ci_0029                -1.051412e-02 3 1  ON 28
ci_0030                -1.045945e-02 3 1  ON 29
ci_0031                 1.357177e-02 3 1  ON 30
ci_0032                 1.227151e-02 3 1  ON 31
ci_0033                 7.994442e-03 3 1  ON 32
ci_0034                 8.514990e-03 3 1  ON 33
ci_0035                 4.988740e-03 3 1  ON 34
ci_0036                 5.108924e-03 3 1  ON 35
ci_0037                -1.126213e-02 3 1  ON 36
ci_0038                -1.153162e-02 3 1  ON 37
ci_0039                -4.040197e-03 3 1  ON 38
ci_0040                -4.037047e-03 3 1  ON 39
ci_0041                 8.951926e-03 3 1  ON 40
ci_0042                 8.738836e-03 3 1  ON 41
ci_0043                -1.251984e-02 3 1  ON 42
ci_0044                -1.314222e-02 3 1  ON 43
ci_0045                 1.066919e-02 3 1  ON 44
ci_0046                 1.018358e-02 3 1  ON 45
ci_0047                -3.628437e-03 3 1  ON 46
ci_0048                -3.414481e-03 3 1  ON 47
ci_0049                -2.517966e-03 3 1  ON 48
ci_0050                -2.775578e-03 3 1  ON 49
ci_0051                -1.755809e-03 3 1  ON 50
ci_0052                -2.074700e-03 3 1  ON 51
ci_0053                -3.976163e-03 3 1  ON 52
ci_0054                -3.312406e-03 3 1  ON 53
ci_0055                 2.826437e-03 3 1  ON 54
ci_0056                 2.256359e-03 3 1  ON 55
ci_0057                 2.236479e-03 3 1  ON 56
ci_0058                 3.172271e-03 3 1  ON 57
ci_0059                -3.374474e-03 3 1  ON 58
ci_0060                -3.202175e-03 3 1  ON 59
ci_0061                -3.955196e-03 3 1  ON 60
ci_0062                -4.022579e-03 3 1  ON 61
ci_0063                -9.960368e-03 3 1  ON 62
ci_0064                -9.491986e-03 3 1  ON 63
ci_0065                -6.356375e-03 3 1  ON 64
ci_0066                -6.199632e-03 3 1  ON 65
ci_0067                -3.651194e-03 3 1  ON 66
ci_0068                -3.423491e-03 3 1  ON 67
ci_0069                 3.765594e-03 3 1  ON 68
ci_0070                 3.409956e-03 3 1  ON 69
ci_0071                 2.918492e-03 3 1  ON 70
ci_0072                 3.675398e-03 3 1  ON 71
ci_0073                 3.661864e-03 3 1  ON 72
ci_0074                 3.590103e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.9468
    reference variance = 0.265576
====================================================
  Execution time = 1.4521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9211e-01
  Total weights = 1.950812361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281747381441
                                         uncertainty =       0.001390515752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281747381441
                                         uncertainty =       0.001390515752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375399896
  error estimate for blocks of size 2^( 2) =       0.000392497727
  error estimate for blocks of size 2^( 3) =       0.000410251608
  error estimate for blocks of size 2^( 4) =       0.000426338139
  error estimate for blocks of size 2^( 5) =       0.000438121217
  error estimate for blocks of size 2^( 6) =       0.000445101811
  error estimate for blocks of size 2^( 7) =       0.000448452703

      target function =      -0.925094126426
              le_mean =     -16.898704991708
             les_mean =     285.858340368426
             stat err =       0.000439503468
             autocorr =       1.370680755567
   target nu stat err =       0.000439503468
   target dn stat err =       0.002178389083
      target stat err =       0.003513111045
              std dev =       0.530895624572
             le_variance =       0.281850164190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689870499171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925106100777       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925106317412       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925106345766       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925106355556       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925106361473       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925106362581       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925106363283       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925106363852       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925106364032       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925106363987       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925106364027       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925106363911       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925106363895       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925106363935       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925106363916       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925106363880       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925106363880       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+02 is 1.001021e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925106100777       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925106154950       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925106162040       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925106164488       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925106165968       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925106166244       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925106166420       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925106166562       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925106166607       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925106166596       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925106166604       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925106166576       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925106166573       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925106166582       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925106166578       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925106166569       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925106166567       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+02 is 2.503227e-07

solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925106100777       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925106114321       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925106116094       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925106116705       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925106117076       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925106117145       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925106117194       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925106117230       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925106117233       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925106117231       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925106117240       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925106117230       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925106117226       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925106117232       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925106117224       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925106117225       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925106117219       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+03 is 6.258487e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.112930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7108e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.079826e-01 3 1  ON 0
ci_0002                 6.933136e-01 3 1  ON 1
ci_0003                -3.123442e-02 3 1  ON 2
ci_0004                -3.036567e-02 3 1  ON 3
ci_0005                -3.057604e-02 3 1  ON 4
ci_0006                -3.070380e-02 3 1  ON 5
ci_0007                -1.389543e-02 3 1  ON 6
ci_0008                -1.363769e-02 3 1  ON 7
ci_0009                -1.887946e-02 3 1  ON 8
ci_0010                -1.816216e-02 3 1  ON 9
ci_0011                -1.478005e-02 3 1  ON 10
ci_0012                -1.471042e-02 3 1  ON 11
ci_0013                 1.533639e-02 3 1  ON 12
ci_0014                 1.479202e-02 3 1  ON 13
ci_0015                 1.592113e-02 3 1  ON 14
ci_0016                 1.551952e-02 3 1  ON 15
ci_0017                 1.342932e-02 3 1  ON 16
ci_0018                 1.316997e-02 3 1  ON 17
ci_0019                 1.301229e-02 3 1  ON 18
ci_0020                 1.260140e-02 3 1  ON 19
ci_0021                 7.737784e-03 3 1  ON 20
ci_0022                 8.390556e-03 3 1  ON 21
ci_0023                -1.187876e-02 3 1  ON 22
ci_0024                -1.137833e-02 3 1  ON 23
ci_0025                -2.047290e-03 3 1  ON 24
ci_0026                -2.800228e-03 3 1  ON 25
ci_0027                -1.200584e-02 3 1  ON 26
ci_0028                -1.159297e-02 3 1  ON 27
ci_0029                -1.051409e-02 3 1  ON 28
ci_0030                -1.045952e-02 3 1  ON 29
ci_0031                 1.357172e-02 3 1  ON 30
ci_0032                 1.227150e-02 3 1  ON 31
ci_0033                 7.994415e-03 3 1  ON 32
ci_0034                 8.514890e-03 3 1  ON 33
ci_0035                 4.988845e-03 3 1  ON 34
ci_0036                 5.108987e-03 3 1  ON 35
ci_0037                -1.126213e-02 3 1  ON 36
ci_0038                -1.153165e-02 3 1  ON 37
ci_0039                -4.040209e-03 3 1  ON 38
ci_0040                -4.037030e-03 3 1  ON 39
ci_0041                 8.951884e-03 3 1  ON 40
ci_0042                 8.738894e-03 3 1  ON 41
ci_0043                -1.251991e-02 3 1  ON 42
ci_0044                -1.314239e-02 3 1  ON 43
ci_0045                 1.066916e-02 3 1  ON 44
ci_0046                 1.018358e-02 3 1  ON 45
ci_0047                -3.628445e-03 3 1  ON 46
ci_0048                -3.414469e-03 3 1  ON 47
ci_0049                -2.517970e-03 3 1  ON 48
ci_0050                -2.775547e-03 3 1  ON 49
ci_0051                -1.755781e-03 3 1  ON 50
ci_0052                -2.074675e-03 3 1  ON 51
ci_0053                -3.976129e-03 3 1  ON 52
ci_0054                -3.312338e-03 3 1  ON 53
ci_0055                 2.826186e-03 3 1  ON 54
ci_0056                 2.256176e-03 3 1  ON 55
ci_0057                 2.236413e-03 3 1  ON 56
ci_0058                 3.172158e-03 3 1  ON 57
ci_0059                -3.374485e-03 3 1  ON 58
ci_0060                -3.202205e-03 3 1  ON 59
ci_0061                -3.955212e-03 3 1  ON 60
ci_0062                -4.022551e-03 3 1  ON 61
ci_0063                -9.960405e-03 3 1  ON 62
ci_0064                -9.491906e-03 3 1  ON 63
ci_0065                -6.356374e-03 3 1  ON 64
ci_0066                -6.199566e-03 3 1  ON 65
ci_0067                -3.651222e-03 3 1  ON 66
ci_0068                -3.423509e-03 3 1  ON 67
ci_0069                 3.765510e-03 3 1  ON 68
ci_0070                 3.409868e-03 3 1  ON 69
ci_0071                 2.918380e-03 3 1  ON 70
ci_0072                 3.675403e-03 3 1  ON 71
ci_0073                 3.661805e-03 3 1  ON 72
ci_0074                 3.590046e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.400243
====================================================
  Execution time = 1.4527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9301e-01
  Total weights = 1.9508e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955504496
                                         uncertainty =       0.001748208067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955504496
                                         uncertainty =       0.001748208067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374828404
  error estimate for blocks of size 2^( 2) =       0.000391577233
  error estimate for blocks of size 2^( 3) =       0.000409337777
  error estimate for blocks of size 2^( 4) =       0.000424511055
  error estimate for blocks of size 2^( 5) =       0.000435213624
  error estimate for blocks of size 2^( 6) =       0.000443730482
  error estimate for blocks of size 2^( 7) =       0.000446328790

      target function =      -0.923638921838
              le_mean =     -16.897937774087
             les_mean =     285.833315645001
             stat err =       0.000437445988
             autocorr =       1.362021266877
   target nu stat err =       0.000437445988
   target dn stat err =       0.003863028121
      target stat err =       0.006104718892
              std dev =       0.530087411995
             le_variance =       0.280992664356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955316158
                                         uncertainty =       0.001748249573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955316158
                                         uncertainty =       0.001748249573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374828276
  error estimate for blocks of size 2^( 2) =       0.000391577123
  error estimate for blocks of size 2^( 3) =       0.000409337688
  error estimate for blocks of size 2^( 4) =       0.000424510973
  error estimate for blocks of size 2^( 5) =       0.000435213549
  error estimate for blocks of size 2^( 6) =       0.000443730431
  error estimate for blocks of size 2^( 7) =       0.000446328705

      target function =      -0.923642844499
              le_mean =     -16.897937788680
             les_mean =     285.833313643717
             stat err =       0.000437445915
             autocorr =       1.362021738088
   target nu stat err =       0.000437445915
   target dn stat err =       0.003862533983
      target stat err =       0.006104001119
              std dev =       0.530087231405
             le_variance =       0.280992472899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955410274
                                         uncertainty =       0.001748228820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955410274
                                         uncertainty =       0.001748228820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374828340
  error estimate for blocks of size 2^( 2) =       0.000391577178
  error estimate for blocks of size 2^( 3) =       0.000409337732
  error estimate for blocks of size 2^( 4) =       0.000424511014
  error estimate for blocks of size 2^( 5) =       0.000435213586
  error estimate for blocks of size 2^( 6) =       0.000443730457
  error estimate for blocks of size 2^( 7) =       0.000446328747

      target function =      -0.923641008504
              le_mean =     -16.897937781384
             les_mean =     285.833314564472
             stat err =       0.000437445951
             autocorr =       1.362021502594
   target nu stat err =       0.000437445951
   target dn stat err =       0.003862780821
      target stat err =       0.006104361291
              std dev =       0.530087321650
             le_variance =       0.280992568574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955492715
                                         uncertainty =       0.001748210660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280955492715
                                         uncertainty =       0.001748210660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374828396
  error estimate for blocks of size 2^( 2) =       0.000391577226
  error estimate for blocks of size 2^( 3) =       0.000409337771
  error estimate for blocks of size 2^( 4) =       0.000424511050
  error estimate for blocks of size 2^( 5) =       0.000435213619
  error estimate for blocks of size 2^( 6) =       0.000443730479
  error estimate for blocks of size 2^( 7) =       0.000446328784

      target function =      -0.923639199131
              le_mean =     -16.897937774999
             les_mean =     285.833315499440
             stat err =       0.000437445983
             autocorr =       1.362021296353
   target nu stat err =       0.000437445983
   target dn stat err =       0.003862997182
      target stat err =       0.006104674367
              std dev =       0.530087400698
             le_variance =       0.280992652379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923638921838        initial
     2.2204e+02     2.2204e+03             1.0010e-06        -0.923642844499  <--
     8.8818e+02     8.8818e+03             2.5032e-07        -0.923641008504
     3.5527e+03     3.5527e+04             6.2585e-08        -0.923639199131

*****************************************************************************
Applying the update for shift_i =   2.2204e+02     and shift_s =   2.2204e+03
*****************************************************************************

  Execution time = 2.4057e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.079828e-01 3 1  ON 0
ci_0002                 6.933134e-01 3 1  ON 1
ci_0003                -3.123425e-02 3 1  ON 2
ci_0004                -3.036555e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070355e-02 3 1  ON 5
ci_0007                -1.389487e-02 3 1  ON 6
ci_0008                -1.363765e-02 3 1  ON 7
ci_0009                -1.887917e-02 3 1  ON 8
ci_0010                -1.816202e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471026e-02 3 1  ON 11
ci_0013                 1.533634e-02 3 1  ON 12
ci_0014                 1.479203e-02 3 1  ON 13
ci_0015                 1.592112e-02 3 1  ON 14
ci_0016                 1.551946e-02 3 1  ON 15
ci_0017                 1.342951e-02 3 1  ON 16
ci_0018                 1.317009e-02 3 1  ON 17
ci_0019                 1.301241e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.737237e-03 3 1  ON 20
ci_0022                 8.390277e-03 3 1  ON 21
ci_0023                -1.187881e-02 3 1  ON 22
ci_0024                -1.137843e-02 3 1  ON 23
ci_0025                -2.047338e-03 3 1  ON 24
ci_0026                -2.800142e-03 3 1  ON 25
ci_0027                -1.200581e-02 3 1  ON 26
ci_0028                -1.159281e-02 3 1  ON 27
ci_0029                -1.051401e-02 3 1  ON 28
ci_0030                -1.045971e-02 3 1  ON 29
ci_0031                 1.357157e-02 3 1  ON 30
ci_0032                 1.227146e-02 3 1  ON 31
ci_0033                 7.994334e-03 3 1  ON 32
ci_0034                 8.514591e-03 3 1  ON 33
ci_0035                 4.989157e-03 3 1  ON 34
ci_0036                 5.109177e-03 3 1  ON 35
ci_0037                -1.126214e-02 3 1  ON 36
ci_0038                -1.153172e-02 3 1  ON 37
ci_0039                -4.040247e-03 3 1  ON 38
ci_0040                -4.036978e-03 3 1  ON 39
ci_0041                 8.951758e-03 3 1  ON 40
ci_0042                 8.739067e-03 3 1  ON 41
ci_0043                -1.252012e-02 3 1  ON 42
ci_0044                -1.314287e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018359e-02 3 1  ON 45
ci_0047                -3.628471e-03 3 1  ON 46
ci_0048                -3.414432e-03 3 1  ON 47
ci_0049                -2.517980e-03 3 1  ON 48
ci_0050                -2.775452e-03 3 1  ON 49
ci_0051                -1.755698e-03 3 1  ON 50
ci_0052                -2.074599e-03 3 1  ON 51
ci_0053                -3.976028e-03 3 1  ON 52
ci_0054                -3.312136e-03 3 1  ON 53
ci_0055                 2.825436e-03 3 1  ON 54
ci_0056                 2.255624e-03 3 1  ON 55
ci_0057                 2.236214e-03 3 1  ON 56
ci_0058                 3.171817e-03 3 1  ON 57
ci_0059                -3.374517e-03 3 1  ON 58
ci_0060                -3.202294e-03 3 1  ON 59
ci_0061                -3.955260e-03 3 1  ON 60
ci_0062                -4.022468e-03 3 1  ON 61
ci_0063                -9.960514e-03 3 1  ON 62
ci_0064                -9.491667e-03 3 1  ON 63
ci_0065                -6.356370e-03 3 1  ON 64
ci_0066                -6.199370e-03 3 1  ON 65
ci_0067                -3.651306e-03 3 1  ON 66
ci_0068                -3.423562e-03 3 1  ON 67
ci_0069                 3.765259e-03 3 1  ON 68
ci_0070                 3.409604e-03 3 1  ON 69
ci_0071                 2.918041e-03 3 1  ON 70
ci_0072                 3.675417e-03 3 1  ON 71
ci_0073                 3.661629e-03 3 1  ON 72
ci_0074                 3.589872e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1171e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8059
    reference variance = 0.490734
====================================================
  Execution time = 1.4605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 3.0039e-01
  Total weights = 1.950799316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286904703111
                                         uncertainty =       0.004159369178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286904703111
                                         uncertainty =       0.004159369178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378715659
  error estimate for blocks of size 2^( 2) =       0.000395575155
  error estimate for blocks of size 2^( 3) =       0.000412704719
  error estimate for blocks of size 2^( 4) =       0.000428119168
  error estimate for blocks of size 2^( 5) =       0.000440024165
  error estimate for blocks of size 2^( 6) =       0.000445832629
  error estimate for blocks of size 2^( 7) =       0.000450971418

      target function =      -0.912139570185
              le_mean =     -16.898500165316
             les_mean =     285.859699994009
             stat err =       0.000441236845
             autocorr =       1.357428662510
   target nu stat err =       0.000441236845
   target dn stat err =       0.006270995827
      target stat err =       0.009632084012
              std dev =       0.535584821730
             le_variance =       0.286851101268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689850016532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912240491353       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912242336609       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912242514482       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912242608227       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912242688579       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912242784770       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912242838963       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912242873183       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912242914208       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912242941349       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912242952636       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912242958319       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912242958970       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912242959461       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912242959303       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912242959113       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912242959017       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+01 is 1.819046e-05

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912240491353       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912240953148       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912240997656       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912241021107       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912241041204       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912241065257       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912241078802       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912241087354       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912241097602       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912241104376       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912241107192       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912241108610       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912241108772       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912241108894       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912241108854       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912241108808       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912241108783       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+02 is 4.547688e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912240491353       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912240606832       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912240617962       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912240623825       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912240628850       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912240634864       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912240638250       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912240640387       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912240642950       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912240644642       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912240645347       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912240645699       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912240645740       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912240645772       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912240645757       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912240645750       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912240645743       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+02 is 1.136927e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.122187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7170e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.079785e-01 3 1  ON 0
ci_0002                 6.933180e-01 3 1  ON 1
ci_0003                -3.123386e-02 3 1  ON 2
ci_0004                -3.036572e-02 3 1  ON 3
ci_0005                -3.057606e-02 3 1  ON 4
ci_0006                -3.070407e-02 3 1  ON 5
ci_0007                -1.389456e-02 3 1  ON 6
ci_0008                -1.363714e-02 3 1  ON 7
ci_0009                -1.887871e-02 3 1  ON 8
ci_0010                -1.816223e-02 3 1  ON 9
ci_0011                -1.478025e-02 3 1  ON 10
ci_0012                -1.471005e-02 3 1  ON 11
ci_0013                 1.533648e-02 3 1  ON 12
ci_0014                 1.479200e-02 3 1  ON 13
ci_0015                 1.592075e-02 3 1  ON 14
ci_0016                 1.551950e-02 3 1  ON 15
ci_0017                 1.342907e-02 3 1  ON 16
ci_0018                 1.316984e-02 3 1  ON 17
ci_0019                 1.301240e-02 3 1  ON 18
ci_0020                 1.260134e-02 3 1  ON 19
ci_0021                 7.736524e-03 3 1  ON 20
ci_0022                 8.390009e-03 3 1  ON 21
ci_0023                -1.187878e-02 3 1  ON 22
ci_0024                -1.137873e-02 3 1  ON 23
ci_0025                -2.046209e-03 3 1  ON 24
ci_0026                -2.799843e-03 3 1  ON 25
ci_0027                -1.200556e-02 3 1  ON 26
ci_0028                -1.159295e-02 3 1  ON 27
ci_0029                -1.051437e-02 3 1  ON 28
ci_0030                -1.045978e-02 3 1  ON 29
ci_0031                 1.357159e-02 3 1  ON 30
ci_0032                 1.227117e-02 3 1  ON 31
ci_0033                 7.994684e-03 3 1  ON 32
ci_0034                 8.514241e-03 3 1  ON 33
ci_0035                 4.989412e-03 3 1  ON 34
ci_0036                 5.109181e-03 3 1  ON 35
ci_0037                -1.126198e-02 3 1  ON 36
ci_0038                -1.153115e-02 3 1  ON 37
ci_0039                -4.039996e-03 3 1  ON 38
ci_0040                -4.037004e-03 3 1  ON 39
ci_0041                 8.951812e-03 3 1  ON 40
ci_0042                 8.739143e-03 3 1  ON 41
ci_0043                -1.251963e-02 3 1  ON 42
ci_0044                -1.314313e-02 3 1  ON 43
ci_0045                 1.066893e-02 3 1  ON 44
ci_0046                 1.018376e-02 3 1  ON 45
ci_0047                -3.628523e-03 3 1  ON 46
ci_0048                -3.414328e-03 3 1  ON 47
ci_0049                -2.518364e-03 3 1  ON 48
ci_0050                -2.775067e-03 3 1  ON 49
ci_0051                -1.755650e-03 3 1  ON 50
ci_0052                -2.074295e-03 3 1  ON 51
ci_0053                -3.975384e-03 3 1  ON 52
ci_0054                -3.312138e-03 3 1  ON 53
ci_0055                 2.825698e-03 3 1  ON 54
ci_0056                 2.255355e-03 3 1  ON 55
ci_0057                 2.236008e-03 3 1  ON 56
ci_0058                 3.171635e-03 3 1  ON 57
ci_0059                -3.375434e-03 3 1  ON 58
ci_0060                -3.202262e-03 3 1  ON 59
ci_0061                -3.954938e-03 3 1  ON 60
ci_0062                -4.022233e-03 3 1  ON 61
ci_0063                -9.960449e-03 3 1  ON 62
ci_0064                -9.491525e-03 3 1  ON 63
ci_0065                -6.356247e-03 3 1  ON 64
ci_0066                -6.199281e-03 3 1  ON 65
ci_0067                -3.651318e-03 3 1  ON 66
ci_0068                -3.423818e-03 3 1  ON 67
ci_0069                 3.764815e-03 3 1  ON 68
ci_0070                 3.409780e-03 3 1  ON 69
ci_0071                 2.917138e-03 3 1  ON 70
ci_0072                 3.674955e-03 3 1  ON 71
ci_0073                 3.661096e-03 3 1  ON 72
ci_0074                 3.589542e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8344
    reference variance = 0.300741
====================================================
  Execution time = 1.4293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9529e-01
  Total weights = 1.9511e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823709083
                                         uncertainty =       0.001950505812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823709083
                                         uncertainty =       0.001950505812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376007291
  error estimate for blocks of size 2^( 2) =       0.000393248201
  error estimate for blocks of size 2^( 3) =       0.000410563220
  error estimate for blocks of size 2^( 4) =       0.000425967517
  error estimate for blocks of size 2^( 5) =       0.000437590735
  error estimate for blocks of size 2^( 6) =       0.000446397190
  error estimate for blocks of size 2^( 7) =       0.000451122990

      target function =      -0.920127506257
              le_mean =     -16.898172417512
             les_mean =     285.843501922712
             stat err =       0.000440269608
             autocorr =       1.371023448406
   target nu stat err =       0.000440269608
   target dn stat err =       0.003110502589
      target stat err =       0.004900944515
              std dev =       0.531754609799
             le_variance =       0.282762965043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823163906
                                         uncertainty =       0.001950535426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823163906
                                         uncertainty =       0.001950535426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376006930
  error estimate for blocks of size 2^( 2) =       0.000393247931
  error estimate for blocks of size 2^( 3) =       0.000410563016
  error estimate for blocks of size 2^( 4) =       0.000425967300
  error estimate for blocks of size 2^( 5) =       0.000437590692
  error estimate for blocks of size 2^( 6) =       0.000446397224
  error estimate for blocks of size 2^( 7) =       0.000451123027

      target function =      -0.919985746605
              le_mean =     -16.898172492324
             les_mean =     285.843595318504
             stat err =       0.000440269561
             autocorr =       1.371025782397
   target nu stat err =       0.000440269561
   target dn stat err =       0.003127600226
      target stat err =       0.004925764042
              std dev =       0.531754100276
             le_variance =       0.282762423161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823435560
                                         uncertainty =       0.001950520616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823435560
                                         uncertainty =       0.001950520616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376007110
  error estimate for blocks of size 2^( 2) =       0.000393248065
  error estimate for blocks of size 2^( 3) =       0.000410563117
  error estimate for blocks of size 2^( 4) =       0.000425967408
  error estimate for blocks of size 2^( 5) =       0.000437590713
  error estimate for blocks of size 2^( 6) =       0.000446397205
  error estimate for blocks of size 2^( 7) =       0.000451123007

      target function =      -0.920061032874
              le_mean =     -16.898172454735
             les_mean =     285.843545789709
             stat err =       0.000440269583
             autocorr =       1.371024613497
   target nu stat err =       0.000440269583
   target dn stat err =       0.003118217488
      target stat err =       0.004912118881
              std dev =       0.531754354161
             le_variance =       0.282762693169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823674794
                                         uncertainty =       0.001950507661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282823674794
                                         uncertainty =       0.001950507661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376007268
  error estimate for blocks of size 2^( 2) =       0.000393248184
  error estimate for blocks of size 2^( 3) =       0.000410563207
  error estimate for blocks of size 2^( 4) =       0.000425967504
  error estimate for blocks of size 2^( 5) =       0.000437590732
  error estimate for blocks of size 2^( 6) =       0.000446397192
  error estimate for blocks of size 2^( 7) =       0.000451122992

      target function =      -0.920119635790
              le_mean =     -16.898172422144
             les_mean =     285.843507124138
             stat err =       0.000440269605
             autocorr =       1.371023593831
   target nu stat err =       0.000440269605
   target dn stat err =       0.003111388220
      target stat err =       0.004902224893
              std dev =       0.531754577751
             le_variance =       0.282762930959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920127506257        initial  <--
     5.5511e+01     5.5511e+02             1.8190e-05        -0.919985746605
     2.2204e+02     2.2204e+03             4.5477e-06        -0.920061032874
     8.8818e+02     8.8818e+03             1.1369e-06        -0.920119635790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8122
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.079828e-01 3 1  ON 0
ci_0002                 6.933134e-01 3 1  ON 1
ci_0003                -3.123425e-02 3 1  ON 2
ci_0004                -3.036555e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070355e-02 3 1  ON 5
ci_0007                -1.389487e-02 3 1  ON 6
ci_0008                -1.363765e-02 3 1  ON 7
ci_0009                -1.887917e-02 3 1  ON 8
ci_0010                -1.816202e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471026e-02 3 1  ON 11
ci_0013                 1.533634e-02 3 1  ON 12
ci_0014                 1.479203e-02 3 1  ON 13
ci_0015                 1.592112e-02 3 1  ON 14
ci_0016                 1.551946e-02 3 1  ON 15
ci_0017                 1.342951e-02 3 1  ON 16
ci_0018                 1.317009e-02 3 1  ON 17
ci_0019                 1.301241e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.737237e-03 3 1  ON 20
ci_0022                 8.390277e-03 3 1  ON 21
ci_0023                -1.187881e-02 3 1  ON 22
ci_0024                -1.137843e-02 3 1  ON 23
ci_0025                -2.047338e-03 3 1  ON 24
ci_0026                -2.800142e-03 3 1  ON 25
ci_0027                -1.200581e-02 3 1  ON 26
ci_0028                -1.159281e-02 3 1  ON 27
ci_0029                -1.051401e-02 3 1  ON 28
ci_0030                -1.045971e-02 3 1  ON 29
ci_0031                 1.357157e-02 3 1  ON 30
ci_0032                 1.227146e-02 3 1  ON 31
ci_0033                 7.994334e-03 3 1  ON 32
ci_0034                 8.514591e-03 3 1  ON 33
ci_0035                 4.989157e-03 3 1  ON 34
ci_0036                 5.109177e-03 3 1  ON 35
ci_0037                -1.126214e-02 3 1  ON 36
ci_0038                -1.153172e-02 3 1  ON 37
ci_0039                -4.040247e-03 3 1  ON 38
ci_0040                -4.036978e-03 3 1  ON 39
ci_0041                 8.951758e-03 3 1  ON 40
ci_0042                 8.739067e-03 3 1  ON 41
ci_0043                -1.252012e-02 3 1  ON 42
ci_0044                -1.314287e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018359e-02 3 1  ON 45
ci_0047                -3.628471e-03 3 1  ON 46
ci_0048                -3.414432e-03 3 1  ON 47
ci_0049                -2.517980e-03 3 1  ON 48
ci_0050                -2.775452e-03 3 1  ON 49
ci_0051                -1.755698e-03 3 1  ON 50
ci_0052                -2.074599e-03 3 1  ON 51
ci_0053                -3.976028e-03 3 1  ON 52
ci_0054                -3.312136e-03 3 1  ON 53
ci_0055                 2.825436e-03 3 1  ON 54
ci_0056                 2.255624e-03 3 1  ON 55
ci_0057                 2.236214e-03 3 1  ON 56
ci_0058                 3.171817e-03 3 1  ON 57
ci_0059                -3.374517e-03 3 1  ON 58
ci_0060                -3.202294e-03 3 1  ON 59
ci_0061                -3.955260e-03 3 1  ON 60
ci_0062                -4.022468e-03 3 1  ON 61
ci_0063                -9.960514e-03 3 1  ON 62
ci_0064                -9.491667e-03 3 1  ON 63
ci_0065                -6.356370e-03 3 1  ON 64
ci_0066                -6.199370e-03 3 1  ON 65
ci_0067                -3.651306e-03 3 1  ON 66
ci_0068                -3.423562e-03 3 1  ON 67
ci_0069                 3.765259e-03 3 1  ON 68
ci_0070                 3.409604e-03 3 1  ON 69
ci_0071                 2.918041e-03 3 1  ON 70
ci_0072                 3.675417e-03 3 1  ON 71
ci_0073                 3.661629e-03 3 1  ON 72
ci_0074                 3.589872e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.9586
    reference variance = 0.293385
====================================================
  Execution time = 1.4762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5211e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8818e-01
  Total weights = 1.950789951e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280165723380
                                         uncertainty =       0.001490141265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280165723380
                                         uncertainty =       0.001490141265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374378148
  error estimate for blocks of size 2^( 2) =       0.000391618151
  error estimate for blocks of size 2^( 3) =       0.000409095269
  error estimate for blocks of size 2^( 4) =       0.000424619054
  error estimate for blocks of size 2^( 5) =       0.000437233216
  error estimate for blocks of size 2^( 6) =       0.000445761273
  error estimate for blocks of size 2^( 7) =       0.000450356470

      target function =      -0.931336289878
              le_mean =     -16.898781755826
             les_mean =     285.857001583033
             stat err =       0.000439492503
             autocorr =       1.378103890872
   target nu stat err =       0.000439492503
   target dn stat err =       0.002048637927
      target stat err =       0.003357836866
              std dev =       0.529450654729
             le_variance =       0.280317995792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689878175583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931346984257       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931347039314       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931347050611       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931347055543       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931347058344       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931347058959       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931347059172       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931347059354       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931347059435       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931347059833       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931347060141       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931347060188       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931347060143       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931347060143       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931347060115       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931347060105       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931347060099       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+02 is 4.400642e-07

solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931346984257       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931346998023       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931347000847       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931347002080       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931347002780       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931347002935       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931347002991       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931347003030       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931347003055       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931347003154       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931347003226       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931347003246       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931347003227       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931347003234       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931347003228       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931347003220       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931347003217       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+03 is 1.100160e-07

solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931346984257       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931346987699       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931346988405       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931346988713       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931346988887       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931346988946       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931346988932       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931346988939       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931346988955       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931346988977       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931346988990       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931346988985       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931346989017       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931346988992       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931346989003       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931346989003       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931346988988       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+03 is 2.750399e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.131386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7324e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.079829e-01 3 1  ON 0
ci_0002                 6.933133e-01 3 1  ON 1
ci_0003                -3.123424e-02 3 1  ON 2
ci_0004                -3.036551e-02 3 1  ON 3
ci_0005                -3.057616e-02 3 1  ON 4
ci_0006                -3.070356e-02 3 1  ON 5
ci_0007                -1.389484e-02 3 1  ON 6
ci_0008                -1.363766e-02 3 1  ON 7
ci_0009                -1.887916e-02 3 1  ON 8
ci_0010                -1.816200e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471023e-02 3 1  ON 11
ci_0013                 1.533635e-02 3 1  ON 12
ci_0014                 1.479205e-02 3 1  ON 13
ci_0015                 1.592111e-02 3 1  ON 14
ci_0016                 1.551945e-02 3 1  ON 15
ci_0017                 1.342950e-02 3 1  ON 16
ci_0018                 1.317010e-02 3 1  ON 17
ci_0019                 1.301239e-02 3 1  ON 18
ci_0020                 1.260145e-02 3 1  ON 19
ci_0021                 7.737189e-03 3 1  ON 20
ci_0022                 8.390182e-03 3 1  ON 21
ci_0023                -1.187882e-02 3 1  ON 22
ci_0024                -1.137843e-02 3 1  ON 23
ci_0025                -2.047329e-03 3 1  ON 24
ci_0026                -2.800087e-03 3 1  ON 25
ci_0027                -1.200581e-02 3 1  ON 26
ci_0028                -1.159284e-02 3 1  ON 27
ci_0029                -1.051402e-02 3 1  ON 28
ci_0030                -1.045969e-02 3 1  ON 29
ci_0031                 1.357153e-02 3 1  ON 30
ci_0032                 1.227147e-02 3 1  ON 31
ci_0033                 7.994340e-03 3 1  ON 32
ci_0034                 8.514582e-03 3 1  ON 33
ci_0035                 4.989173e-03 3 1  ON 34
ci_0036                 5.109160e-03 3 1  ON 35
ci_0037                -1.126217e-02 3 1  ON 36
ci_0038                -1.153171e-02 3 1  ON 37
ci_0039                -4.040256e-03 3 1  ON 38
ci_0040                -4.036973e-03 3 1  ON 39
ci_0041                 8.951730e-03 3 1  ON 40
ci_0042                 8.739092e-03 3 1  ON 41
ci_0043                -1.252019e-02 3 1  ON 42
ci_0044                -1.314294e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018357e-02 3 1  ON 45
ci_0047                -3.628472e-03 3 1  ON 46
ci_0048                -3.414437e-03 3 1  ON 47
ci_0049                -2.518009e-03 3 1  ON 48
ci_0050                -2.775438e-03 3 1  ON 49
ci_0051                -1.755697e-03 3 1  ON 50
ci_0052                -2.074575e-03 3 1  ON 51
ci_0053                -3.976002e-03 3 1  ON 52
ci_0054                -3.312169e-03 3 1  ON 53
ci_0055                 2.825387e-03 3 1  ON 54
ci_0056                 2.255649e-03 3 1  ON 55
ci_0057                 2.236237e-03 3 1  ON 56
ci_0058                 3.171820e-03 3 1  ON 57
ci_0059                -3.374518e-03 3 1  ON 58
ci_0060                -3.202321e-03 3 1  ON 59
ci_0061                -3.955243e-03 3 1  ON 60
ci_0062                -4.022437e-03 3 1  ON 61
ci_0063                -9.960500e-03 3 1  ON 62
ci_0064                -9.491651e-03 3 1  ON 63
ci_0065                -6.356378e-03 3 1  ON 64
ci_0066                -6.199355e-03 3 1  ON 65
ci_0067                -3.651288e-03 3 1  ON 66
ci_0068                -3.423596e-03 3 1  ON 67
ci_0069                 3.765239e-03 3 1  ON 68
ci_0070                 3.409588e-03 3 1  ON 69
ci_0071                 2.918048e-03 3 1  ON 70
ci_0072                 3.675437e-03 3 1  ON 71
ci_0073                 3.661624e-03 3 1  ON 72
ci_0074                 3.589852e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.251226
====================================================
  Execution time = 1.4249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9359e-01
  Total weights = 1.9508e+06
  Execution time = 1.9019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324764684
                                         uncertainty =       0.001913827230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324764684
                                         uncertainty =       0.001913827230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376362602
  error estimate for blocks of size 2^( 2) =       0.000393085467
  error estimate for blocks of size 2^( 3) =       0.000410583947
  error estimate for blocks of size 2^( 4) =       0.000425726361
  error estimate for blocks of size 2^( 5) =       0.000436907318
  error estimate for blocks of size 2^( 6) =       0.000442916879
  error estimate for blocks of size 2^( 7) =       0.000449310747

      target function =      -0.922752938063
              le_mean =     -16.898222219128
             les_mean =     285.843506031160
             stat err =       0.000438715326
             autocorr =       1.358791080484
   target nu stat err =       0.000438715326
   target dn stat err =       0.002915592528
      target stat err =       0.004627106115
              std dev =       0.532257096705
             le_variance =       0.283297616993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324716239
                                         uncertainty =       0.001913838473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324716239
                                         uncertainty =       0.001913838473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376362570
  error estimate for blocks of size 2^( 2) =       0.000393085435
  error estimate for blocks of size 2^( 3) =       0.000410583911
  error estimate for blocks of size 2^( 4) =       0.000425726322
  error estimate for blocks of size 2^( 5) =       0.000436907279
  error estimate for blocks of size 2^( 6) =       0.000442916840
  error estimate for blocks of size 2^( 7) =       0.000449310699

      target function =      -0.922752729029
              le_mean =     -16.898222219402
             les_mean =     285.843506173689
             stat err =       0.000438715285
             autocorr =       1.358791055003
   target nu stat err =       0.000438715285
   target dn stat err =       0.002915611260
      target stat err =       0.004627132995
              std dev =       0.532257051564
             le_variance =       0.283297568940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324740457
                                         uncertainty =       0.001913832852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324740457
                                         uncertainty =       0.001913832852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376362586
  error estimate for blocks of size 2^( 2) =       0.000393085451
  error estimate for blocks of size 2^( 3) =       0.000410583929
  error estimate for blocks of size 2^( 4) =       0.000425726342
  error estimate for blocks of size 2^( 5) =       0.000436907299
  error estimate for blocks of size 2^( 6) =       0.000442916859
  error estimate for blocks of size 2^( 7) =       0.000449310723

      target function =      -0.922752833640
              le_mean =     -16.898222219265
             les_mean =     285.843506102354
             stat err =       0.000438715306
             autocorr =       1.358791067739
   target nu stat err =       0.000438715306
   target dn stat err =       0.002915601894
      target stat err =       0.004627119555
              std dev =       0.532257074130
             le_variance =       0.283297592962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324761655
                                         uncertainty =       0.001913827933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283324761655
                                         uncertainty =       0.001913827933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376362600
  error estimate for blocks of size 2^( 2) =       0.000393085465
  error estimate for blocks of size 2^( 3) =       0.000410583945
  error estimate for blocks of size 2^( 4) =       0.000425726359
  error estimate for blocks of size 2^( 5) =       0.000436907316
  error estimate for blocks of size 2^( 6) =       0.000442916876
  error estimate for blocks of size 2^( 7) =       0.000449310744

      target function =      -0.922752925021
              le_mean =     -16.898222219145
             les_mean =     285.843506040051
             stat err =       0.000438715324
             autocorr =       1.358791078884
   target nu stat err =       0.000438715324
   target dn stat err =       0.002915593699
      target stat err =       0.004627107795
              std dev =       0.532257093883
             le_variance =       0.283297613988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922752938063        initial  <--
     5.5511e+02     5.5511e+03             4.4006e-07        -0.922752729029
     2.2204e+03     2.2204e+04             1.1002e-07        -0.922752833640
     8.8818e+03     8.8818e+04             2.7504e-08        -0.922752925021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8140
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.079828e-01 3 1  ON 0
ci_0002                 6.933134e-01 3 1  ON 1
ci_0003                -3.123425e-02 3 1  ON 2
ci_0004                -3.036555e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070355e-02 3 1  ON 5
ci_0007                -1.389487e-02 3 1  ON 6
ci_0008                -1.363765e-02 3 1  ON 7
ci_0009                -1.887917e-02 3 1  ON 8
ci_0010                -1.816202e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471026e-02 3 1  ON 11
ci_0013                 1.533634e-02 3 1  ON 12
ci_0014                 1.479203e-02 3 1  ON 13
ci_0015                 1.592112e-02 3 1  ON 14
ci_0016                 1.551946e-02 3 1  ON 15
ci_0017                 1.342951e-02 3 1  ON 16
ci_0018                 1.317009e-02 3 1  ON 17
ci_0019                 1.301241e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.737237e-03 3 1  ON 20
ci_0022                 8.390277e-03 3 1  ON 21
ci_0023                -1.187881e-02 3 1  ON 22
ci_0024                -1.137843e-02 3 1  ON 23
ci_0025                -2.047338e-03 3 1  ON 24
ci_0026                -2.800142e-03 3 1  ON 25
ci_0027                -1.200581e-02 3 1  ON 26
ci_0028                -1.159281e-02 3 1  ON 27
ci_0029                -1.051401e-02 3 1  ON 28
ci_0030                -1.045971e-02 3 1  ON 29
ci_0031                 1.357157e-02 3 1  ON 30
ci_0032                 1.227146e-02 3 1  ON 31
ci_0033                 7.994334e-03 3 1  ON 32
ci_0034                 8.514591e-03 3 1  ON 33
ci_0035                 4.989157e-03 3 1  ON 34
ci_0036                 5.109177e-03 3 1  ON 35
ci_0037                -1.126214e-02 3 1  ON 36
ci_0038                -1.153172e-02 3 1  ON 37
ci_0039                -4.040247e-03 3 1  ON 38
ci_0040                -4.036978e-03 3 1  ON 39
ci_0041                 8.951758e-03 3 1  ON 40
ci_0042                 8.739067e-03 3 1  ON 41
ci_0043                -1.252012e-02 3 1  ON 42
ci_0044                -1.314287e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018359e-02 3 1  ON 45
ci_0047                -3.628471e-03 3 1  ON 46
ci_0048                -3.414432e-03 3 1  ON 47
ci_0049                -2.517980e-03 3 1  ON 48
ci_0050                -2.775452e-03 3 1  ON 49
ci_0051                -1.755698e-03 3 1  ON 50
ci_0052                -2.074599e-03 3 1  ON 51
ci_0053                -3.976028e-03 3 1  ON 52
ci_0054                -3.312136e-03 3 1  ON 53
ci_0055                 2.825436e-03 3 1  ON 54
ci_0056                 2.255624e-03 3 1  ON 55
ci_0057                 2.236214e-03 3 1  ON 56
ci_0058                 3.171817e-03 3 1  ON 57
ci_0059                -3.374517e-03 3 1  ON 58
ci_0060                -3.202294e-03 3 1  ON 59
ci_0061                -3.955260e-03 3 1  ON 60
ci_0062                -4.022468e-03 3 1  ON 61
ci_0063                -9.960514e-03 3 1  ON 62
ci_0064                -9.491667e-03 3 1  ON 63
ci_0065                -6.356370e-03 3 1  ON 64
ci_0066                -6.199370e-03 3 1  ON 65
ci_0067                -3.651306e-03 3 1  ON 66
ci_0068                -3.423562e-03 3 1  ON 67
ci_0069                 3.765259e-03 3 1  ON 68
ci_0070                 3.409604e-03 3 1  ON 69
ci_0071                 2.918041e-03 3 1  ON 70
ci_0072                 3.675417e-03 3 1  ON 71
ci_0073                 3.661629e-03 3 1  ON 72
ci_0074                 3.589872e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1144e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8383
    reference variance = 0.758456
====================================================
  Execution time = 1.6842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9690e-01
  Total weights = 1.950702281e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286199822331
                                         uncertainty =       0.004688559410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286199822331
                                         uncertainty =       0.004688559410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378288519
  error estimate for blocks of size 2^( 2) =       0.000395546541
  error estimate for blocks of size 2^( 3) =       0.000412900838
  error estimate for blocks of size 2^( 4) =       0.000428191585
  error estimate for blocks of size 2^( 5) =       0.000439323352
  error estimate for blocks of size 2^( 6) =       0.000446478453
  error estimate for blocks of size 2^( 7) =       0.000449720345

      target function =      -0.917468017579
              le_mean =     -16.897802901504
             les_mean =     285.832640447658
             stat err =       0.000440928434
             autocorr =       1.358594619227
   target nu stat err =       0.000440928434
   target dn stat err =       0.007847775297
      target stat err =       0.012167023803
              std dev =       0.534980753611
             le_variance =       0.286204406734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689780290150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917626977325       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917626987560       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917626989064       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917626989738       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917626990195       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917626990459       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917626990583       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917626990677       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917626990850       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917626990911       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917626990937       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917626990983       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917626990983       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917626991023       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917626991021       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917626991031       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917626990999       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917626991016       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+03 is 1.003913e-07

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917626977325       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917626979884       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917626980259       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917626980429       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917626980540       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917626980609       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917626980640       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917626980662       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917626980752       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917626980670       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917626980730       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917626980695       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917626980715       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917626980718       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917626980716       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917626980722       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917626980743       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917626980784       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+04 is 2.509784e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917626977325       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917626977964       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917626978058       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917626978097       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917626978128       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917626978146       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917626978062       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917626978159       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917626978170       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917626977987       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917626978175       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917626978360       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917626978220       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917626978120       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917626978105       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917626977933       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917626978360       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917626977978       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 6.274459e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.141643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9437e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.079829e-01 3 1  ON 0
ci_0002                 6.933134e-01 3 1  ON 1
ci_0003                -3.123425e-02 3 1  ON 2
ci_0004                -3.036555e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070354e-02 3 1  ON 5
ci_0007                -1.389487e-02 3 1  ON 6
ci_0008                -1.363765e-02 3 1  ON 7
ci_0009                -1.887916e-02 3 1  ON 8
ci_0010                -1.816202e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471027e-02 3 1  ON 11
ci_0013                 1.533634e-02 3 1  ON 12
ci_0014                 1.479203e-02 3 1  ON 13
ci_0015                 1.592112e-02 3 1  ON 14
ci_0016                 1.551946e-02 3 1  ON 15
ci_0017                 1.342951e-02 3 1  ON 16
ci_0018                 1.317009e-02 3 1  ON 17
ci_0019                 1.301242e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.737231e-03 3 1  ON 20
ci_0022                 8.390284e-03 3 1  ON 21
ci_0023                -1.187881e-02 3 1  ON 22
ci_0024                -1.137843e-02 3 1  ON 23
ci_0025                -2.047341e-03 3 1  ON 24
ci_0026                -2.800141e-03 3 1  ON 25
ci_0027                -1.200581e-02 3 1  ON 26
ci_0028                -1.159280e-02 3 1  ON 27
ci_0029                -1.051401e-02 3 1  ON 28
ci_0030                -1.045971e-02 3 1  ON 29
ci_0031                 1.357157e-02 3 1  ON 30
ci_0032                 1.227146e-02 3 1  ON 31
ci_0033                 7.994327e-03 3 1  ON 32
ci_0034                 8.514596e-03 3 1  ON 33
ci_0035                 4.989149e-03 3 1  ON 34
ci_0036                 5.109170e-03 3 1  ON 35
ci_0037                -1.126214e-02 3 1  ON 36
ci_0038                -1.153171e-02 3 1  ON 37
ci_0039                -4.040245e-03 3 1  ON 38
ci_0040                -4.036977e-03 3 1  ON 39
ci_0041                 8.951759e-03 3 1  ON 40
ci_0042                 8.739070e-03 3 1  ON 41
ci_0043                -1.252012e-02 3 1  ON 42
ci_0044                -1.314287e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018358e-02 3 1  ON 45
ci_0047                -3.628470e-03 3 1  ON 46
ci_0048                -3.414433e-03 3 1  ON 47
ci_0049                -2.517981e-03 3 1  ON 48
ci_0050                -2.775456e-03 3 1  ON 49
ci_0051                -1.755699e-03 3 1  ON 50
ci_0052                -2.074598e-03 3 1  ON 51
ci_0053                -3.976027e-03 3 1  ON 52
ci_0054                -3.312133e-03 3 1  ON 53
ci_0055                 2.825437e-03 3 1  ON 54
ci_0056                 2.255625e-03 3 1  ON 55
ci_0057                 2.236216e-03 3 1  ON 56
ci_0058                 3.171812e-03 3 1  ON 57
ci_0059                -3.374516e-03 3 1  ON 58
ci_0060                -3.202297e-03 3 1  ON 59
ci_0061                -3.955261e-03 3 1  ON 60
ci_0062                -4.022467e-03 3 1  ON 61
ci_0063                -9.960515e-03 3 1  ON 62
ci_0064                -9.491666e-03 3 1  ON 63
ci_0065                -6.356367e-03 3 1  ON 64
ci_0066                -6.199371e-03 3 1  ON 65
ci_0067                -3.651309e-03 3 1  ON 66
ci_0068                -3.423563e-03 3 1  ON 67
ci_0069                 3.765257e-03 3 1  ON 68
ci_0070                 3.409600e-03 3 1  ON 69
ci_0071                 2.918042e-03 3 1  ON 70
ci_0072                 3.675411e-03 3 1  ON 71
ci_0073                 3.661629e-03 3 1  ON 72
ci_0074                 3.589871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.9005
    reference variance = 0.312637
====================================================
  Execution time = 1.4403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9434e-01
  Total weights = 1.9509e+06
  Execution time = 1.8912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622849208
                                         uncertainty =       0.001945766256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622849208
                                         uncertainty =       0.001945766256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376528869
  error estimate for blocks of size 2^( 2) =       0.000393764093
  error estimate for blocks of size 2^( 3) =       0.000410974998
  error estimate for blocks of size 2^( 4) =       0.000426467722
  error estimate for blocks of size 2^( 5) =       0.000438830339
  error estimate for blocks of size 2^( 6) =       0.000447491615
  error estimate for blocks of size 2^( 7) =       0.000450843233

      target function =      -0.921595555111
              le_mean =     -16.898659217001
             les_mean =     285.859018520047
             stat err =       0.000440908227
             autocorr =       1.371196971967
   target nu stat err =       0.000440908227
   target dn stat err =       0.002617445490
      target stat err =       0.004160587490
              std dev =       0.532492233703
             le_variance =       0.283547978954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622847695
                                         uncertainty =       0.001945766208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622847695
                                         uncertainty =       0.001945766208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376528868
  error estimate for blocks of size 2^( 2) =       0.000393764092
  error estimate for blocks of size 2^( 3) =       0.000410974998
  error estimate for blocks of size 2^( 4) =       0.000426467721
  error estimate for blocks of size 2^( 5) =       0.000438830338
  error estimate for blocks of size 2^( 6) =       0.000447491616
  error estimate for blocks of size 2^( 7) =       0.000450843231

      target function =      -0.921595581229
              le_mean =     -16.898659217073
             les_mean =     285.859018505750
             stat err =       0.000440908227
             autocorr =       1.371196974632
   target nu stat err =       0.000440908227
   target dn stat err =       0.002617446016
      target stat err =       0.004160588532
              std dev =       0.532492232289
             le_variance =       0.283547977448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622848451
                                         uncertainty =       0.001945766232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622848451
                                         uncertainty =       0.001945766232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376528869
  error estimate for blocks of size 2^( 2) =       0.000393764092
  error estimate for blocks of size 2^( 3) =       0.000410974998
  error estimate for blocks of size 2^( 4) =       0.000426467722
  error estimate for blocks of size 2^( 5) =       0.000438830339
  error estimate for blocks of size 2^( 6) =       0.000447491616
  error estimate for blocks of size 2^( 7) =       0.000450843232

      target function =      -0.921595568232
              le_mean =     -16.898659217037
             les_mean =     285.859018512859
             stat err =       0.000440908227
             autocorr =       1.371196973300
   target nu stat err =       0.000440908227
   target dn stat err =       0.002617445753
      target stat err =       0.004160588011
              std dev =       0.532492232996
             le_variance =       0.283547978201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622849113
                                         uncertainty =       0.001945766253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283622849113
                                         uncertainty =       0.001945766253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376528869
  error estimate for blocks of size 2^( 2) =       0.000393764093
  error estimate for blocks of size 2^( 3) =       0.000410974998
  error estimate for blocks of size 2^( 4) =       0.000426467722
  error estimate for blocks of size 2^( 5) =       0.000438830339
  error estimate for blocks of size 2^( 6) =       0.000447491616
  error estimate for blocks of size 2^( 7) =       0.000450843233

      target function =      -0.921595556758
              le_mean =     -16.898659217006
             les_mean =     285.859018519144
             stat err =       0.000440908227
             autocorr =       1.371196972141
   target nu stat err =       0.000440908227
   target dn stat err =       0.002617445523
      target stat err =       0.004160587555
              std dev =       0.532492233615
             le_variance =       0.283547978860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921595555111        initial
     5.5511e+03     5.5511e+04             1.0039e-07        -0.921595581229  <--
     2.2204e+04     2.2204e+05             2.5098e-08        -0.921595568232
     8.8818e+04     8.8818e+05             6.2745e-09        -0.921595556758

*****************************************************************************
Applying the update for shift_i =   5.5511e+03     and shift_s =   5.5511e+04
*****************************************************************************

  Execution time = 2.3955e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.079829e-01 3 1  ON 0
ci_0002                 6.933133e-01 3 1  ON 1
ci_0003                -3.123425e-02 3 1  ON 2
ci_0004                -3.036555e-02 3 1  ON 3
ci_0005                -3.057613e-02 3 1  ON 4
ci_0006                -3.070353e-02 3 1  ON 5
ci_0007                -1.389489e-02 3 1  ON 6
ci_0008                -1.363768e-02 3 1  ON 7
ci_0009                -1.887915e-02 3 1  ON 8
ci_0010                -1.816201e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471027e-02 3 1  ON 11
ci_0013                 1.533634e-02 3 1  ON 12
ci_0014                 1.479202e-02 3 1  ON 13
ci_0015                 1.592112e-02 3 1  ON 14
ci_0016                 1.551946e-02 3 1  ON 15
ci_0017                 1.342950e-02 3 1  ON 16
ci_0018                 1.317010e-02 3 1  ON 17
ci_0019                 1.301243e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.737211e-03 3 1  ON 20
ci_0022                 8.390304e-03 3 1  ON 21
ci_0023                -1.187883e-02 3 1  ON 22
ci_0024                -1.137842e-02 3 1  ON 23
ci_0025                -2.047349e-03 3 1  ON 24
ci_0026                -2.800138e-03 3 1  ON 25
ci_0027                -1.200581e-02 3 1  ON 26
ci_0028                -1.159278e-02 3 1  ON 27
ci_0029                -1.051403e-02 3 1  ON 28
ci_0030                -1.045973e-02 3 1  ON 29
ci_0031                 1.357157e-02 3 1  ON 30
ci_0032                 1.227146e-02 3 1  ON 31
ci_0033                 7.994309e-03 3 1  ON 32
ci_0034                 8.514609e-03 3 1  ON 33
ci_0035                 4.989125e-03 3 1  ON 34
ci_0036                 5.109152e-03 3 1  ON 35
ci_0037                -1.126214e-02 3 1  ON 36
ci_0038                -1.153171e-02 3 1  ON 37
ci_0039                -4.040239e-03 3 1  ON 38
ci_0040                -4.036971e-03 3 1  ON 39
ci_0041                 8.951761e-03 3 1  ON 40
ci_0042                 8.739077e-03 3 1  ON 41
ci_0043                -1.252014e-02 3 1  ON 42
ci_0044                -1.314287e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018355e-02 3 1  ON 45
ci_0047                -3.628468e-03 3 1  ON 46
ci_0048                -3.414437e-03 3 1  ON 47
ci_0049                -2.517983e-03 3 1  ON 48
ci_0050                -2.775467e-03 3 1  ON 49
ci_0051                -1.755700e-03 3 1  ON 50
ci_0052                -2.074596e-03 3 1  ON 51
ci_0053                -3.976023e-03 3 1  ON 52
ci_0054                -3.312126e-03 3 1  ON 53
ci_0055                 2.825439e-03 3 1  ON 54
ci_0056                 2.255628e-03 3 1  ON 55
ci_0057                 2.236223e-03 3 1  ON 56
ci_0058                 3.171798e-03 3 1  ON 57
ci_0059                -3.374514e-03 3 1  ON 58
ci_0060                -3.202305e-03 3 1  ON 59
ci_0061                -3.955264e-03 3 1  ON 60
ci_0062                -4.022464e-03 3 1  ON 61
ci_0063                -9.960518e-03 3 1  ON 62
ci_0064                -9.491663e-03 3 1  ON 63
ci_0065                -6.356357e-03 3 1  ON 64
ci_0066                -6.199374e-03 3 1  ON 65
ci_0067                -3.651320e-03 3 1  ON 66
ci_0068                -3.423566e-03 3 1  ON 67
ci_0069                 3.765252e-03 3 1  ON 68
ci_0070                 3.409589e-03 3 1  ON 69
ci_0071                 2.918047e-03 3 1  ON 70
ci_0072                 3.675391e-03 3 1  ON 71
ci_0073                 3.661632e-03 3 1  ON 72
ci_0074                 3.589868e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9137
    reference variance = 0.410198
====================================================
  Execution time = 1.4618e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9604e-01
  Total weights = 1.950823245e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285231844438
                                         uncertainty =       0.001905082201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285231844438
                                         uncertainty =       0.001905082201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377711814
  error estimate for blocks of size 2^( 2) =       0.000394862081
  error estimate for blocks of size 2^( 3) =       0.000412161435
  error estimate for blocks of size 2^( 4) =       0.000427479910
  error estimate for blocks of size 2^( 5) =       0.000437741397
  error estimate for blocks of size 2^( 6) =       0.000443824773
  error estimate for blocks of size 2^( 7) =       0.000446145299

      target function =      -0.918946522214
              le_mean =     -16.898612533461
             les_mean =     285.859141474065
             stat err =       0.000438797845
             autocorr =       1.349608586451
   target nu stat err =       0.000438797845
   target dn stat err =       0.002467529738
      target stat err =       0.003907038038
              std dev =       0.534165170690
             le_variance =       0.285332429578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689861253346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918961361290       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918961395865       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918961400962       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918961403602       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918961404272       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918961404698       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918961404775       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918961404769       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918961404799       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918961404827       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918961404847       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918961404862       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918961404851       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918961404871       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918961404867       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918961404858       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918961404860       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+03 is 1.824863e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918961361290       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918961369934       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918961371209       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918961371870       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918961372031       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918961372145       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918961372162       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918961372155       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918961372172       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918961372183       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918961372180       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918961372176       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918961372176       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918961372184       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918961372197       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918961372167       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918961372186       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+03 is 4.562259e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918961361290       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918961363451       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918961363770       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918961363935       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918961363960       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918961363998       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918961364006       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918961364003       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918961364059       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918961363997       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918961364021       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918961363963       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918961363984       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918961363986       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918961364009       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918961364020       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918961364011       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+04 is 1.140571e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.150822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7210e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.079829e-01 3 1  ON 0
ci_0002                 6.933133e-01 3 1  ON 1
ci_0003                -3.123424e-02 3 1  ON 2
ci_0004                -3.036556e-02 3 1  ON 3
ci_0005                -3.057612e-02 3 1  ON 4
ci_0006                -3.070352e-02 3 1  ON 5
ci_0007                -1.389488e-02 3 1  ON 6
ci_0008                -1.363770e-02 3 1  ON 7
ci_0009                -1.887915e-02 3 1  ON 8
ci_0010                -1.816201e-02 3 1  ON 9
ci_0011                -1.477995e-02 3 1  ON 10
ci_0012                -1.471027e-02 3 1  ON 11
ci_0013                 1.533635e-02 3 1  ON 12
ci_0014                 1.479201e-02 3 1  ON 13
ci_0015                 1.592111e-02 3 1  ON 14
ci_0016                 1.551945e-02 3 1  ON 15
ci_0017                 1.342949e-02 3 1  ON 16
ci_0018                 1.317009e-02 3 1  ON 17
ci_0019                 1.301243e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.737200e-03 3 1  ON 20
ci_0022                 8.390269e-03 3 1  ON 21
ci_0023                -1.187884e-02 3 1  ON 22
ci_0024                -1.137843e-02 3 1  ON 23
ci_0025                -2.047322e-03 3 1  ON 24
ci_0026                -2.800114e-03 3 1  ON 25
ci_0027                -1.200580e-02 3 1  ON 26
ci_0028                -1.159276e-02 3 1  ON 27
ci_0029                -1.051403e-02 3 1  ON 28
ci_0030                -1.045972e-02 3 1  ON 29
ci_0031                 1.357159e-02 3 1  ON 30
ci_0032                 1.227146e-02 3 1  ON 31
ci_0033                 7.994306e-03 3 1  ON 32
ci_0034                 8.514598e-03 3 1  ON 33
ci_0035                 4.989129e-03 3 1  ON 34
ci_0036                 5.109156e-03 3 1  ON 35
ci_0037                -1.126214e-02 3 1  ON 36
ci_0038                -1.153170e-02 3 1  ON 37
ci_0039                -4.040235e-03 3 1  ON 38
ci_0040                -4.036966e-03 3 1  ON 39
ci_0041                 8.951763e-03 3 1  ON 40
ci_0042                 8.739078e-03 3 1  ON 41
ci_0043                -1.252018e-02 3 1  ON 42
ci_0044                -1.314291e-02 3 1  ON 43
ci_0045                 1.066908e-02 3 1  ON 44
ci_0046                 1.018354e-02 3 1  ON 45
ci_0047                -3.628464e-03 3 1  ON 46
ci_0048                -3.414432e-03 3 1  ON 47
ci_0049                -2.517970e-03 3 1  ON 48
ci_0050                -2.775470e-03 3 1  ON 49
ci_0051                -1.755701e-03 3 1  ON 50
ci_0052                -2.074596e-03 3 1  ON 51
ci_0053                -3.976015e-03 3 1  ON 52
ci_0054                -3.312119e-03 3 1  ON 53
ci_0055                 2.825443e-03 3 1  ON 54
ci_0056                 2.255618e-03 3 1  ON 55
ci_0057                 2.236216e-03 3 1  ON 56
ci_0058                 3.171790e-03 3 1  ON 57
ci_0059                -3.374519e-03 3 1  ON 58
ci_0060                -3.202300e-03 3 1  ON 59
ci_0061                -3.955269e-03 3 1  ON 60
ci_0062                -4.022454e-03 3 1  ON 61
ci_0063                -9.960522e-03 3 1  ON 62
ci_0064                -9.491670e-03 3 1  ON 63
ci_0065                -6.356359e-03 3 1  ON 64
ci_0066                -6.199371e-03 3 1  ON 65
ci_0067                -3.651300e-03 3 1  ON 66
ci_0068                -3.423570e-03 3 1  ON 67
ci_0069                 3.765242e-03 3 1  ON 68
ci_0070                 3.409584e-03 3 1  ON 69
ci_0071                 2.918058e-03 3 1  ON 70
ci_0072                 3.675381e-03 3 1  ON 71
ci_0073                 3.661612e-03 3 1  ON 72
ci_0074                 3.589862e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.8844
    reference variance = 0.199635
====================================================
  Execution time = 1.4329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8975e-01
  Total weights = 1.9511e+06
  Execution time = 1.8793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257215344
                                         uncertainty =       0.001704430244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257215344
                                         uncertainty =       0.001704430244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993961
  error estimate for blocks of size 2^( 2) =       0.000391825887
  error estimate for blocks of size 2^( 3) =       0.000409621486
  error estimate for blocks of size 2^( 4) =       0.000425176476
  error estimate for blocks of size 2^( 5) =       0.000436499631
  error estimate for blocks of size 2^( 6) =       0.000443718481
  error estimate for blocks of size 2^( 7) =       0.000447411510

      target function =      -0.928832215099
              le_mean =     -16.898840037500
             les_mean =     285.860544708076
             stat err =       0.000438201525
             autocorr =       1.365523634848
   target nu stat err =       0.000438201525
   target dn stat err =       0.001945154550
      target stat err =       0.003180107645
              std dev =       0.530321545249
             le_variance =       0.281240941355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257181206
                                         uncertainty =       0.001704430778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257181206
                                         uncertainty =       0.001704430778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993938
  error estimate for blocks of size 2^( 2) =       0.000391825865
  error estimate for blocks of size 2^( 3) =       0.000409621465
  error estimate for blocks of size 2^( 4) =       0.000425176455
  error estimate for blocks of size 2^( 5) =       0.000436499608
  error estimate for blocks of size 2^( 6) =       0.000443718456
  error estimate for blocks of size 2^( 7) =       0.000447411481

      target function =      -0.928832305031
              le_mean =     -16.898840037744
             les_mean =     285.860544659727
             stat err =       0.000438201500
             autocorr =       1.365523643884
   target nu stat err =       0.000438201500
   target dn stat err =       0.001945152732
      target stat err =       0.003180105427
              std dev =       0.530321513150
             le_variance =       0.281240907310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257198274
                                         uncertainty =       0.001704430511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257198274
                                         uncertainty =       0.001704430511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993950
  error estimate for blocks of size 2^( 2) =       0.000391825876
  error estimate for blocks of size 2^( 3) =       0.000409621476
  error estimate for blocks of size 2^( 4) =       0.000425176466
  error estimate for blocks of size 2^( 5) =       0.000436499619
  error estimate for blocks of size 2^( 6) =       0.000443718469
  error estimate for blocks of size 2^( 7) =       0.000447411495

      target function =      -0.928832260115
              le_mean =     -16.898840037622
             les_mean =     285.860544683868
             stat err =       0.000438201512
             autocorr =       1.365523639375
   target nu stat err =       0.000438201512
   target dn stat err =       0.001945153640
      target stat err =       0.003180106536
              std dev =       0.530321529198
             le_variance =       0.281240924331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257213210
                                         uncertainty =       0.001704430278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281257213210
                                         uncertainty =       0.001704430278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993959
  error estimate for blocks of size 2^( 2) =       0.000391825885
  error estimate for blocks of size 2^( 3) =       0.000409621485
  error estimate for blocks of size 2^( 4) =       0.000425176475
  error estimate for blocks of size 2^( 5) =       0.000436499630
  error estimate for blocks of size 2^( 6) =       0.000443718480
  error estimate for blocks of size 2^( 7) =       0.000447411508

      target function =      -0.928832220732
              le_mean =     -16.898840037516
             les_mean =     285.860544705047
             stat err =       0.000438201523
             autocorr =       1.365523635413
   target nu stat err =       0.000438201523
   target dn stat err =       0.001945154436
      target stat err =       0.003180107506
              std dev =       0.530321543242
             le_variance =       0.281240939227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928832215099        initial
     1.3878e+03     1.3878e+04             1.8249e-07        -0.928832305031  <--
     5.5511e+03     5.5511e+04             4.5623e-08        -0.928832260115
     2.2204e+04     2.2204e+05             1.1406e-08        -0.928832220732

*****************************************************************************
Applying the update for shift_i =   1.3878e+03     and shift_s =   1.3878e+04
*****************************************************************************

  Execution time = 2.3824e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.079829e-01 3 1  ON 0
ci_0002                 6.933134e-01 3 1  ON 1
ci_0003                -3.123422e-02 3 1  ON 2
ci_0004                -3.036559e-02 3 1  ON 3
ci_0005                -3.057612e-02 3 1  ON 4
ci_0006                -3.070350e-02 3 1  ON 5
ci_0007                -1.389485e-02 3 1  ON 6
ci_0008                -1.363775e-02 3 1  ON 7
ci_0009                -1.887914e-02 3 1  ON 8
ci_0010                -1.816201e-02 3 1  ON 9
ci_0011                -1.477994e-02 3 1  ON 10
ci_0012                -1.471025e-02 3 1  ON 11
ci_0013                 1.533637e-02 3 1  ON 12
ci_0014                 1.479198e-02 3 1  ON 13
ci_0015                 1.592108e-02 3 1  ON 14
ci_0016                 1.551942e-02 3 1  ON 15
ci_0017                 1.342945e-02 3 1  ON 16
ci_0018                 1.317007e-02 3 1  ON 17
ci_0019                 1.301243e-02 3 1  ON 18
ci_0020                 1.260145e-02 3 1  ON 19
ci_0021                 7.737170e-03 3 1  ON 20
ci_0022                 8.390161e-03 3 1  ON 21
ci_0023                -1.187889e-02 3 1  ON 22
ci_0024                -1.137845e-02 3 1  ON 23
ci_0025                -2.047241e-03 3 1  ON 24
ci_0026                -2.800043e-03 3 1  ON 25
ci_0027                -1.200579e-02 3 1  ON 26
ci_0028                -1.159269e-02 3 1  ON 27
ci_0029                -1.051405e-02 3 1  ON 28
ci_0030                -1.045970e-02 3 1  ON 29
ci_0031                 1.357163e-02 3 1  ON 30
ci_0032                 1.227144e-02 3 1  ON 31
ci_0033                 7.994296e-03 3 1  ON 32
ci_0034                 8.514566e-03 3 1  ON 33
ci_0035                 4.989142e-03 3 1  ON 34
ci_0036                 5.109168e-03 3 1  ON 35
ci_0037                -1.126215e-02 3 1  ON 36
ci_0038                -1.153169e-02 3 1  ON 37
ci_0039                -4.040223e-03 3 1  ON 38
ci_0040                -4.036949e-03 3 1  ON 39
ci_0041                 8.951770e-03 3 1  ON 40
ci_0042                 8.739079e-03 3 1  ON 41
ci_0043                -1.252032e-02 3 1  ON 42
ci_0044                -1.314302e-02 3 1  ON 43
ci_0045                 1.066905e-02 3 1  ON 44
ci_0046                 1.018350e-02 3 1  ON 45
ci_0047                -3.628450e-03 3 1  ON 46
ci_0048                -3.414419e-03 3 1  ON 47
ci_0049                -2.517930e-03 3 1  ON 48
ci_0050                -2.775479e-03 3 1  ON 49
ci_0051                -1.755705e-03 3 1  ON 50
ci_0052                -2.074596e-03 3 1  ON 51
ci_0053                -3.975992e-03 3 1  ON 52
ci_0054                -3.312098e-03 3 1  ON 53
ci_0055                 2.825456e-03 3 1  ON 54
ci_0056                 2.255588e-03 3 1  ON 55
ci_0057                 2.236195e-03 3 1  ON 56
ci_0058                 3.171767e-03 3 1  ON 57
ci_0059                -3.374534e-03 3 1  ON 58
ci_0060                -3.202285e-03 3 1  ON 59
ci_0061                -3.955283e-03 3 1  ON 60
ci_0062                -4.022425e-03 3 1  ON 61
ci_0063                -9.960531e-03 3 1  ON 62
ci_0064                -9.491690e-03 3 1  ON 63
ci_0065                -6.356367e-03 3 1  ON 64
ci_0066                -6.199363e-03 3 1  ON 65
ci_0067                -3.651238e-03 3 1  ON 66
ci_0068                -3.423581e-03 3 1  ON 67
ci_0069                 3.765211e-03 3 1  ON 68
ci_0070                 3.409567e-03 3 1  ON 69
ci_0071                 2.918091e-03 3 1  ON 70
ci_0072                 3.675353e-03 3 1  ON 71
ci_0073                 3.661553e-03 3 1  ON 72
ci_0074                 3.589845e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.8621
    reference variance = 0.212501
====================================================
  Execution time = 1.4819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9209e-01
  Total weights = 1.950977682e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283448140243
                                         uncertainty =       0.002114415958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283448140243
                                         uncertainty =       0.002114415958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376445054
  error estimate for blocks of size 2^( 2) =       0.000393603032
  error estimate for blocks of size 2^( 3) =       0.000410925590
  error estimate for blocks of size 2^( 4) =       0.000426471064
  error estimate for blocks of size 2^( 5) =       0.000437065928
  error estimate for blocks of size 2^( 6) =       0.000444026154
  error estimate for blocks of size 2^( 7) =       0.000449793903

      target function =      -0.925130438640
              le_mean =     -16.898798480739
             les_mean =     285.861476113994
             stat err =       0.000439339262
             autocorr =       1.362061889881
   target nu stat err =       0.000439339262
   target dn stat err =       0.002350601928
      target stat err =       0.003779567640
              std dev =       0.532373701110
             le_variance =       0.283421757634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689879848074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925144618735       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925144747234       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925144764751       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925144770130       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925144773515       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925144774417       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925144774174       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925144774093       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925144774233       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925144774174       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925144774215       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925144774194       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925144774130       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925144774154       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925144774150       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925144774197       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925144774191       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+02 is 5.381409e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925144618735       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925144650865       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925144655245       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925144656590       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925144657436       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925144657663       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925144657601       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925144657580       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925144657611       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925144657601       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925144657611       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925144657606       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925144657590       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925144657596       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925144657595       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925144657608       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925144657605       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+03 is 1.345469e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925144618735       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925144626768       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925144627863       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925144628199       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925144628417       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925144628473       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925144628439       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925144628446       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925144628453       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925144628440       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925144628458       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925144628458       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925144628449       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925144628450       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925144628450       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925144628453       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925144628455       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+03 is 3.363747e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.160066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7414e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.079828e-01 3 1  ON 0
ci_0002                 6.933135e-01 3 1  ON 1
ci_0003                -3.123421e-02 3 1  ON 2
ci_0004                -3.036556e-02 3 1  ON 3
ci_0005                -3.057605e-02 3 1  ON 4
ci_0006                -3.070344e-02 3 1  ON 5
ci_0007                -1.389481e-02 3 1  ON 6
ci_0008                -1.363766e-02 3 1  ON 7
ci_0009                -1.887914e-02 3 1  ON 8
ci_0010                -1.816199e-02 3 1  ON 9
ci_0011                -1.477991e-02 3 1  ON 10
ci_0012                -1.471025e-02 3 1  ON 11
ci_0013                 1.533636e-02 3 1  ON 12
ci_0014                 1.479197e-02 3 1  ON 13
ci_0015                 1.592107e-02 3 1  ON 14
ci_0016                 1.551939e-02 3 1  ON 15
ci_0017                 1.342945e-02 3 1  ON 16
ci_0018                 1.317004e-02 3 1  ON 17
ci_0019                 1.301245e-02 3 1  ON 18
ci_0020                 1.260145e-02 3 1  ON 19
ci_0021                 7.737035e-03 3 1  ON 20
ci_0022                 8.390100e-03 3 1  ON 21
ci_0023                -1.187892e-02 3 1  ON 22
ci_0024                -1.137850e-02 3 1  ON 23
ci_0025                -2.047127e-03 3 1  ON 24
ci_0026                -2.799972e-03 3 1  ON 25
ci_0027                -1.200580e-02 3 1  ON 26
ci_0028                -1.159269e-02 3 1  ON 27
ci_0029                -1.051402e-02 3 1  ON 28
ci_0030                -1.045973e-02 3 1  ON 29
ci_0031                 1.357164e-02 3 1  ON 30
ci_0032                 1.227145e-02 3 1  ON 31
ci_0033                 7.994185e-03 3 1  ON 32
ci_0034                 8.514529e-03 3 1  ON 33
ci_0035                 4.989171e-03 3 1  ON 34
ci_0036                 5.109210e-03 3 1  ON 35
ci_0037                -1.126216e-02 3 1  ON 36
ci_0038                -1.153169e-02 3 1  ON 37
ci_0039                -4.040216e-03 3 1  ON 38
ci_0040                -4.036930e-03 3 1  ON 39
ci_0041                 8.951790e-03 3 1  ON 40
ci_0042                 8.739068e-03 3 1  ON 41
ci_0043                -1.252035e-02 3 1  ON 42
ci_0044                -1.314309e-02 3 1  ON 43
ci_0045                 1.066901e-02 3 1  ON 44
ci_0046                 1.018345e-02 3 1  ON 45
ci_0047                -3.628434e-03 3 1  ON 46
ci_0048                -3.414419e-03 3 1  ON 47
ci_0049                -2.517978e-03 3 1  ON 48
ci_0050                -2.775468e-03 3 1  ON 49
ci_0051                -1.755733e-03 3 1  ON 50
ci_0052                -2.074597e-03 3 1  ON 51
ci_0053                -3.975946e-03 3 1  ON 52
ci_0054                -3.312135e-03 3 1  ON 53
ci_0055                 2.825463e-03 3 1  ON 54
ci_0056                 2.255721e-03 3 1  ON 55
ci_0057                 2.236167e-03 3 1  ON 56
ci_0058                 3.171744e-03 3 1  ON 57
ci_0059                -3.374535e-03 3 1  ON 58
ci_0060                -3.202309e-03 3 1  ON 59
ci_0061                -3.955276e-03 3 1  ON 60
ci_0062                -4.022426e-03 3 1  ON 61
ci_0063                -9.960515e-03 3 1  ON 62
ci_0064                -9.491678e-03 3 1  ON 63
ci_0065                -6.356340e-03 3 1  ON 64
ci_0066                -6.199359e-03 3 1  ON 65
ci_0067                -3.651245e-03 3 1  ON 66
ci_0068                -3.423601e-03 3 1  ON 67
ci_0069                 3.765158e-03 3 1  ON 68
ci_0070                 3.409572e-03 3 1  ON 69
ci_0071                 2.918086e-03 3 1  ON 70
ci_0072                 3.675349e-03 3 1  ON 71
ci_0073                 3.661555e-03 3 1  ON 72
ci_0074                 3.589748e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9341
    reference variance = 0.23034
====================================================
  Execution time = 1.4248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.8960e-01
  Total weights = 1.9511e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452335943
                                         uncertainty =       0.001854783700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452335943
                                         uncertainty =       0.001854783700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374491148
  error estimate for blocks of size 2^( 2) =       0.000391159376
  error estimate for blocks of size 2^( 3) =       0.000409067027
  error estimate for blocks of size 2^( 4) =       0.000423710624
  error estimate for blocks of size 2^( 5) =       0.000435342674
  error estimate for blocks of size 2^( 6) =       0.000443214696
  error estimate for blocks of size 2^( 7) =       0.000449205869

      target function =      -0.929079331894
              le_mean =     -16.899319946333
             les_mean =     285.876610920497
             stat err =       0.000437868466
             autocorr =       1.367112408836
   target nu stat err =       0.000437868466
   target dn stat err =       0.002303285464
      target stat err =       0.003740647748
              std dev =       0.529610460687
             le_variance =       0.280487240069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452258278
                                         uncertainty =       0.001854775366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452258278
                                         uncertainty =       0.001854775366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374491096
  error estimate for blocks of size 2^( 2) =       0.000391159323
  error estimate for blocks of size 2^( 3) =       0.000409066970
  error estimate for blocks of size 2^( 4) =       0.000423710567
  error estimate for blocks of size 2^( 5) =       0.000435342618
  error estimate for blocks of size 2^( 6) =       0.000443214632
  error estimate for blocks of size 2^( 7) =       0.000449205813

      target function =      -0.929079682213
              le_mean =     -16.899319945050
             les_mean =     285.876610657045
             stat err =       0.000437868407
             autocorr =       1.367112423852
   target nu stat err =       0.000437868407
   target dn stat err =       0.002303273309
      target stat err =       0.003740631536
              std dev =       0.529610387208
             le_variance =       0.280487162238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452297098
                                         uncertainty =       0.001854779532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452297098
                                         uncertainty =       0.001854779532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374491122
  error estimate for blocks of size 2^( 2) =       0.000391159349
  error estimate for blocks of size 2^( 3) =       0.000409066999
  error estimate for blocks of size 2^( 4) =       0.000423710595
  error estimate for blocks of size 2^( 5) =       0.000435342646
  error estimate for blocks of size 2^( 6) =       0.000443214664
  error estimate for blocks of size 2^( 7) =       0.000449205841

      target function =      -0.929079507820
              le_mean =     -16.899319945690
             les_mean =     285.876610788253
             stat err =       0.000437868436
             autocorr =       1.367112416355
   target nu stat err =       0.000437868436
   target dn stat err =       0.002303279369
      target stat err =       0.003740639621
              std dev =       0.529610423935
             le_variance =       0.280487201141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452331087
                                         uncertainty =       0.001854783179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280452331087
                                         uncertainty =       0.001854783179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374491145
  error estimate for blocks of size 2^( 2) =       0.000391159373
  error estimate for blocks of size 2^( 3) =       0.000409067024
  error estimate for blocks of size 2^( 4) =       0.000423710620
  error estimate for blocks of size 2^( 5) =       0.000435342671
  error estimate for blocks of size 2^( 6) =       0.000443214692
  error estimate for blocks of size 2^( 7) =       0.000449205866

      target function =      -0.929079353965
              le_mean =     -16.899319946252
             les_mean =     285.876610903913
             stat err =       0.000437868462
             autocorr =       1.367112409777
   target nu stat err =       0.000437868462
   target dn stat err =       0.002303284700
      target stat err =       0.003740646730
              std dev =       0.529610456092
             le_variance =       0.280487235202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929079331894        initial
     3.4694e+02     3.4694e+03             5.3814e-07        -0.929079682213  <--
     1.3878e+03     1.3878e+04             1.3455e-07        -0.929079507820
     5.5511e+03     5.5511e+04             3.3637e-08        -0.929079353965

*****************************************************************************
Applying the update for shift_i =   3.4694e+02     and shift_s =   3.4694e+03
*****************************************************************************

  Execution time = 2.3774e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.079825e-01 3 1  ON 0
ci_0002                 6.933139e-01 3 1  ON 1
ci_0003                -3.123419e-02 3 1  ON 2
ci_0004                -3.036547e-02 3 1  ON 3
ci_0005                -3.057583e-02 3 1  ON 4
ci_0006                -3.070326e-02 3 1  ON 5
ci_0007                -1.389470e-02 3 1  ON 6
ci_0008                -1.363738e-02 3 1  ON 7
ci_0009                -1.887915e-02 3 1  ON 8
ci_0010                -1.816191e-02 3 1  ON 9
ci_0011                -1.477981e-02 3 1  ON 10
ci_0012                -1.471024e-02 3 1  ON 11
ci_0013                 1.533631e-02 3 1  ON 12
ci_0014                 1.479193e-02 3 1  ON 13
ci_0015                 1.592104e-02 3 1  ON 14
ci_0016                 1.551929e-02 3 1  ON 15
ci_0017                 1.342944e-02 3 1  ON 16
ci_0018                 1.316998e-02 3 1  ON 17
ci_0019                 1.301252e-02 3 1  ON 18
ci_0020                 1.260142e-02 3 1  ON 19
ci_0021                 7.736631e-03 3 1  ON 20
ci_0022                 8.389916e-03 3 1  ON 21
ci_0023                -1.187902e-02 3 1  ON 22
ci_0024                -1.137863e-02 3 1  ON 23
ci_0025                -2.046786e-03 3 1  ON 24
ci_0026                -2.799761e-03 3 1  ON 25
ci_0027                -1.200585e-02 3 1  ON 26
ci_0028                -1.159270e-02 3 1  ON 27
ci_0029                -1.051395e-02 3 1  ON 28
ci_0030                -1.045979e-02 3 1  ON 29
ci_0031                 1.357166e-02 3 1  ON 30
ci_0032                 1.227147e-02 3 1  ON 31
ci_0033                 7.993853e-03 3 1  ON 32
ci_0034                 8.514420e-03 3 1  ON 33
ci_0035                 4.989258e-03 3 1  ON 34
ci_0036                 5.109336e-03 3 1  ON 35
ci_0037                -1.126219e-02 3 1  ON 36
ci_0038                -1.153167e-02 3 1  ON 37
ci_0039                -4.040195e-03 3 1  ON 38
ci_0040                -4.036873e-03 3 1  ON 39
ci_0041                 8.951853e-03 3 1  ON 40
ci_0042                 8.739033e-03 3 1  ON 41
ci_0043                -1.252044e-02 3 1  ON 42
ci_0044                -1.314327e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018331e-02 3 1  ON 45
ci_0047                -3.628386e-03 3 1  ON 46
ci_0048                -3.414418e-03 3 1  ON 47
ci_0049                -2.518122e-03 3 1  ON 48
ci_0050                -2.775435e-03 3 1  ON 49
ci_0051                -1.755815e-03 3 1  ON 50
ci_0052                -2.074597e-03 3 1  ON 51
ci_0053                -3.975806e-03 3 1  ON 52
ci_0054                -3.312243e-03 3 1  ON 53
ci_0055                 2.825485e-03 3 1  ON 54
ci_0056                 2.256117e-03 3 1  ON 55
ci_0057                 2.236081e-03 3 1  ON 56
ci_0058                 3.171677e-03 3 1  ON 57
ci_0059                -3.374538e-03 3 1  ON 58
ci_0060                -3.202378e-03 3 1  ON 59
ci_0061                -3.955254e-03 3 1  ON 60
ci_0062                -4.022430e-03 3 1  ON 61
ci_0063                -9.960467e-03 3 1  ON 62
ci_0064                -9.491643e-03 3 1  ON 63
ci_0065                -6.356257e-03 3 1  ON 64
ci_0066                -6.199346e-03 3 1  ON 65
ci_0067                -3.651263e-03 3 1  ON 66
ci_0068                -3.423660e-03 3 1  ON 67
ci_0069                 3.765001e-03 3 1  ON 68
ci_0070                 3.409589e-03 3 1  ON 69
ci_0071                 2.918069e-03 3 1  ON 70
ci_0072                 3.675337e-03 3 1  ON 71
ci_0073                 3.661563e-03 3 1  ON 72
ci_0074                 3.589457e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8391
    reference variance = 0.237376
====================================================
  Execution time = 1.6802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9843e-01
  Total weights = 1.950770177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285485116544
                                         uncertainty =       0.001915784059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285485116544
                                         uncertainty =       0.001915784059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377804342
  error estimate for blocks of size 2^( 2) =       0.000394771112
  error estimate for blocks of size 2^( 3) =       0.000412046949
  error estimate for blocks of size 2^( 4) =       0.000427293804
  error estimate for blocks of size 2^( 5) =       0.000438870029
  error estimate for blocks of size 2^( 6) =       0.000445488921
  error estimate for blocks of size 2^( 7) =       0.000448923552

      target function =      -0.915239477754
              le_mean =     -16.898549901619
             les_mean =     285.859417819156
             stat err =       0.000440144076
             autocorr =       1.357237442629
   target nu stat err =       0.000440144076
   target dn stat err =       0.002628572958
      target stat err =       0.004120136579
              std dev =       0.534296024731
             le_variance =       0.285472242043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689854990162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915256674523       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915257108865       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915257170252       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915257190502       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915257218421       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915257223206       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915257231732       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915257237736       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915257242928       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915257249010       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915257251216       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915257251704       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915257252061       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915257252461       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915257252624       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915257252632       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915257252658       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+01 is 4.913024e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915256674523       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915256783181       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915256798537       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915256803600       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915256810582       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915256811777       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915256813909       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915256815410       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915256816709       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915256818228       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915256818778       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915256818901       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915256818989       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915256819089       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915256819130       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915256819132       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915256819139       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+02 is 1.228274e-06

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915256674523       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915256701692       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915256705532       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915256706798       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915256708544       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915256708841       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915256709373       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915256709748       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915256710074       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915256710454       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915256710594       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915256710624       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915256710644       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915256710671       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915256710682       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915256710683       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915256710683       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+03 is 3.070695e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.169257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9389e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.079813e-01 3 1  ON 0
ci_0002                 6.933151e-01 3 1  ON 1
ci_0003                -3.123403e-02 3 1  ON 2
ci_0004                -3.036529e-02 3 1  ON 3
ci_0005                -3.057548e-02 3 1  ON 4
ci_0006                -3.070353e-02 3 1  ON 5
ci_0007                -1.389452e-02 3 1  ON 6
ci_0008                -1.363717e-02 3 1  ON 7
ci_0009                -1.887907e-02 3 1  ON 8
ci_0010                -1.816191e-02 3 1  ON 9
ci_0011                -1.477980e-02 3 1  ON 10
ci_0012                -1.471019e-02 3 1  ON 11
ci_0013                 1.533617e-02 3 1  ON 12
ci_0014                 1.479195e-02 3 1  ON 13
ci_0015                 1.592080e-02 3 1  ON 14
ci_0016                 1.551932e-02 3 1  ON 15
ci_0017                 1.342938e-02 3 1  ON 16
ci_0018                 1.317004e-02 3 1  ON 17
ci_0019                 1.301264e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.735883e-03 3 1  ON 20
ci_0022                 8.389465e-03 3 1  ON 21
ci_0023                -1.187906e-02 3 1  ON 22
ci_0024                -1.137866e-02 3 1  ON 23
ci_0025                -2.046751e-03 3 1  ON 24
ci_0026                -2.799565e-03 3 1  ON 25
ci_0027                -1.200573e-02 3 1  ON 26
ci_0028                -1.159267e-02 3 1  ON 27
ci_0029                -1.051414e-02 3 1  ON 28
ci_0030                -1.045984e-02 3 1  ON 29
ci_0031                 1.357165e-02 3 1  ON 30
ci_0032                 1.227147e-02 3 1  ON 31
ci_0033                 7.993970e-03 3 1  ON 32
ci_0034                 8.514307e-03 3 1  ON 33
ci_0035                 4.989330e-03 3 1  ON 34
ci_0036                 5.109227e-03 3 1  ON 35
ci_0037                -1.126230e-02 3 1  ON 36
ci_0038                -1.153162e-02 3 1  ON 37
ci_0039                -4.040209e-03 3 1  ON 38
ci_0040                -4.036781e-03 3 1  ON 39
ci_0041                 8.952005e-03 3 1  ON 40
ci_0042                 8.738849e-03 3 1  ON 41
ci_0043                -1.252082e-02 3 1  ON 42
ci_0044                -1.314347e-02 3 1  ON 43
ci_0045                 1.066886e-02 3 1  ON 44
ci_0046                 1.018340e-02 3 1  ON 45
ci_0047                -3.628423e-03 3 1  ON 46
ci_0048                -3.414488e-03 3 1  ON 47
ci_0049                -2.518146e-03 3 1  ON 48
ci_0050                -2.775505e-03 3 1  ON 49
ci_0051                -1.755736e-03 3 1  ON 50
ci_0052                -2.074717e-03 3 1  ON 51
ci_0053                -3.975700e-03 3 1  ON 52
ci_0054                -3.312263e-03 3 1  ON 53
ci_0055                 2.824837e-03 3 1  ON 54
ci_0056                 2.256047e-03 3 1  ON 55
ci_0057                 2.236214e-03 3 1  ON 56
ci_0058                 3.171493e-03 3 1  ON 57
ci_0059                -3.374710e-03 3 1  ON 58
ci_0060                -3.202490e-03 3 1  ON 59
ci_0061                -3.955241e-03 3 1  ON 60
ci_0062                -4.022378e-03 3 1  ON 61
ci_0063                -9.960328e-03 3 1  ON 62
ci_0064                -9.491688e-03 3 1  ON 63
ci_0065                -6.356143e-03 3 1  ON 64
ci_0066                -6.199328e-03 3 1  ON 65
ci_0067                -3.651257e-03 3 1  ON 66
ci_0068                -3.423479e-03 3 1  ON 67
ci_0069                 3.764867e-03 3 1  ON 68
ci_0070                 3.409556e-03 3 1  ON 69
ci_0071                 2.918136e-03 3 1  ON 70
ci_0072                 3.675242e-03 3 1  ON 71
ci_0073                 3.661330e-03 3 1  ON 72
ci_0074                 3.589498e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.9616
    reference variance = 0.15423
====================================================
  Execution time = 1.4372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9239e-01
  Total weights = 1.9510e+06
  Execution time = 1.8774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282704236942
                                         uncertainty =       0.001763878618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282704236942
                                         uncertainty =       0.001763878618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375929786
  error estimate for blocks of size 2^( 2) =       0.000392412613
  error estimate for blocks of size 2^( 3) =       0.000409252528
  error estimate for blocks of size 2^( 4) =       0.000423908178
  error estimate for blocks of size 2^( 5) =       0.000434305305
  error estimate for blocks of size 2^( 6) =       0.000442734665
  error estimate for blocks of size 2^( 7) =       0.000446756618

      target function =      -0.924656053366
              le_mean =     -16.898668937218
             les_mean =     285.857397335334
             stat err =       0.000436926192
             autocorr =       1.350836180296
   target nu stat err =       0.000436926192
   target dn stat err =       0.002490777616
      target stat err =       0.003990620665
              std dev =       0.531645001665
             le_variance =       0.282646407795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282703733887
                                         uncertainty =       0.001763852370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282703733887
                                         uncertainty =       0.001763852370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375929451
  error estimate for blocks of size 2^( 2) =       0.000392412282
  error estimate for blocks of size 2^( 3) =       0.000409252228
  error estimate for blocks of size 2^( 4) =       0.000423907883
  error estimate for blocks of size 2^( 5) =       0.000434305022
  error estimate for blocks of size 2^( 6) =       0.000442734396
  error estimate for blocks of size 2^( 7) =       0.000446756339

      target function =      -0.924655394603
              le_mean =     -16.898668929619
             les_mean =     285.857397493644
             stat err =       0.000436925910
             autocorr =       1.350836844860
   target nu stat err =       0.000436925910
   target dn stat err =       0.002491193053
      target stat err =       0.003991257429
              std dev =       0.531644528057
             le_variance =       0.282645904212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282703985143
                                         uncertainty =       0.001763865485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282703985143
                                         uncertainty =       0.001763865485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375929618
  error estimate for blocks of size 2^( 2) =       0.000392412447
  error estimate for blocks of size 2^( 3) =       0.000409252378
  error estimate for blocks of size 2^( 4) =       0.000423908030
  error estimate for blocks of size 2^( 5) =       0.000434305163
  error estimate for blocks of size 2^( 6) =       0.000442734531
  error estimate for blocks of size 2^( 7) =       0.000446756478

      target function =      -0.924655778310
              le_mean =     -16.898668933400
             les_mean =     285.857397379357
             stat err =       0.000436926051
             autocorr =       1.350836513100
   target nu stat err =       0.000436926051
   target dn stat err =       0.002490984861
      target stat err =       0.003990938776
              std dev =       0.531644764605
             le_variance =       0.282646155732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282704205449
                                         uncertainty =       0.001763876976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282704205449
                                         uncertainty =       0.001763876976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375929765
  error estimate for blocks of size 2^( 2) =       0.000392412592
  error estimate for blocks of size 2^( 3) =       0.000409252509
  error estimate for blocks of size 2^( 4) =       0.000423908159
  error estimate for blocks of size 2^( 5) =       0.000434305288
  error estimate for blocks of size 2^( 6) =       0.000442734648
  error estimate for blocks of size 2^( 7) =       0.000446756601

      target function =      -0.924656024721
              le_mean =     -16.898668936739
             les_mean =     285.857397337128
             stat err =       0.000436926174
             autocorr =       1.350836221927
   target nu stat err =       0.000436926174
   target dn stat err =       0.002490803462
      target stat err =       0.003990660385
              std dev =       0.531644972015
             le_variance =       0.282646376268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924656053366        initial  <--
     8.6736e+01     8.6736e+02             4.9130e-06        -0.924655394603
     3.4694e+02     3.4694e+03             1.2283e-06        -0.924655778310
     1.3878e+03     1.3878e+04             3.0707e-07        -0.924656024721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8532
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.079825e-01 3 1  ON 0
ci_0002                 6.933139e-01 3 1  ON 1
ci_0003                -3.123419e-02 3 1  ON 2
ci_0004                -3.036547e-02 3 1  ON 3
ci_0005                -3.057583e-02 3 1  ON 4
ci_0006                -3.070326e-02 3 1  ON 5
ci_0007                -1.389470e-02 3 1  ON 6
ci_0008                -1.363738e-02 3 1  ON 7
ci_0009                -1.887915e-02 3 1  ON 8
ci_0010                -1.816191e-02 3 1  ON 9
ci_0011                -1.477981e-02 3 1  ON 10
ci_0012                -1.471024e-02 3 1  ON 11
ci_0013                 1.533631e-02 3 1  ON 12
ci_0014                 1.479193e-02 3 1  ON 13
ci_0015                 1.592104e-02 3 1  ON 14
ci_0016                 1.551929e-02 3 1  ON 15
ci_0017                 1.342944e-02 3 1  ON 16
ci_0018                 1.316998e-02 3 1  ON 17
ci_0019                 1.301252e-02 3 1  ON 18
ci_0020                 1.260142e-02 3 1  ON 19
ci_0021                 7.736631e-03 3 1  ON 20
ci_0022                 8.389916e-03 3 1  ON 21
ci_0023                -1.187902e-02 3 1  ON 22
ci_0024                -1.137863e-02 3 1  ON 23
ci_0025                -2.046786e-03 3 1  ON 24
ci_0026                -2.799761e-03 3 1  ON 25
ci_0027                -1.200585e-02 3 1  ON 26
ci_0028                -1.159270e-02 3 1  ON 27
ci_0029                -1.051395e-02 3 1  ON 28
ci_0030                -1.045979e-02 3 1  ON 29
ci_0031                 1.357166e-02 3 1  ON 30
ci_0032                 1.227147e-02 3 1  ON 31
ci_0033                 7.993853e-03 3 1  ON 32
ci_0034                 8.514420e-03 3 1  ON 33
ci_0035                 4.989258e-03 3 1  ON 34
ci_0036                 5.109336e-03 3 1  ON 35
ci_0037                -1.126219e-02 3 1  ON 36
ci_0038                -1.153167e-02 3 1  ON 37
ci_0039                -4.040195e-03 3 1  ON 38
ci_0040                -4.036873e-03 3 1  ON 39
ci_0041                 8.951853e-03 3 1  ON 40
ci_0042                 8.739033e-03 3 1  ON 41
ci_0043                -1.252044e-02 3 1  ON 42
ci_0044                -1.314327e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018331e-02 3 1  ON 45
ci_0047                -3.628386e-03 3 1  ON 46
ci_0048                -3.414418e-03 3 1  ON 47
ci_0049                -2.518122e-03 3 1  ON 48
ci_0050                -2.775435e-03 3 1  ON 49
ci_0051                -1.755815e-03 3 1  ON 50
ci_0052                -2.074597e-03 3 1  ON 51
ci_0053                -3.975806e-03 3 1  ON 52
ci_0054                -3.312243e-03 3 1  ON 53
ci_0055                 2.825485e-03 3 1  ON 54
ci_0056                 2.256117e-03 3 1  ON 55
ci_0057                 2.236081e-03 3 1  ON 56
ci_0058                 3.171677e-03 3 1  ON 57
ci_0059                -3.374538e-03 3 1  ON 58
ci_0060                -3.202378e-03 3 1  ON 59
ci_0061                -3.955254e-03 3 1  ON 60
ci_0062                -4.022430e-03 3 1  ON 61
ci_0063                -9.960467e-03 3 1  ON 62
ci_0064                -9.491643e-03 3 1  ON 63
ci_0065                -6.356257e-03 3 1  ON 64
ci_0066                -6.199346e-03 3 1  ON 65
ci_0067                -3.651263e-03 3 1  ON 66
ci_0068                -3.423660e-03 3 1  ON 67
ci_0069                 3.765001e-03 3 1  ON 68
ci_0070                 3.409589e-03 3 1  ON 69
ci_0071                 2.918069e-03 3 1  ON 70
ci_0072                 3.675337e-03 3 1  ON 71
ci_0073                 3.661563e-03 3 1  ON 72
ci_0074                 3.589457e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8786
    reference variance = 0.239365
====================================================
  Execution time = 1.4786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9372e-01
  Total weights = 1.951290032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282970830931
                                         uncertainty =       0.001678939116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282970830931
                                         uncertainty =       0.001678939116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376118470
  error estimate for blocks of size 2^( 2) =       0.000393281009
  error estimate for blocks of size 2^( 3) =       0.000410979578
  error estimate for blocks of size 2^( 4) =       0.000426519219
  error estimate for blocks of size 2^( 5) =       0.000438071830
  error estimate for blocks of size 2^( 6) =       0.000443431162
  error estimate for blocks of size 2^( 7) =       0.000448366117

      target function =      -0.922566212757
              le_mean =     -16.898515756555
             les_mean =     285.853550078474
             stat err =       0.000439097082
             autocorr =       1.362924446014
   target nu stat err =       0.000439097082
   target dn stat err =       0.002556088645
      target stat err =       0.004073027568
              std dev =       0.531911840654
             le_variance =       0.282930206228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689851575656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922582727818       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922582780999       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922582791864       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922582795506       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922582797929       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922582798906       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922582799111       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922582799460       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922582799639       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922582799992       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922582800007       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922582800197       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922582800203       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922582800214       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922582800214       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922582800196       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922582800196       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+02 is 2.599542e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922582727818       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922582741114       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922582743830       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922582744741       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922582745343       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922582745593       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922582745635       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922582745733       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922582745780       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922582745870       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922582745861       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922582745900       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922582745921       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922582745924       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922582745914       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922582745911       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922582745918       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+03 is 6.498860e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922582727818       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922582731142       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922582731821       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922582732049       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922582732223       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922582732241       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922582732261       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922582732303       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922582732286       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922582732322       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922582732336       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922582732352       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922582732372       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922582732349       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922582732321       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922582732356       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922582732334       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3878e+04 is 1.624715e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.178368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7392e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.079825e-01 3 1  ON 0
ci_0002                 6.933138e-01 3 1  ON 1
ci_0003                -3.123416e-02 3 1  ON 2
ci_0004                -3.036545e-02 3 1  ON 3
ci_0005                -3.057584e-02 3 1  ON 4
ci_0006                -3.070327e-02 3 1  ON 5
ci_0007                -1.389468e-02 3 1  ON 6
ci_0008                -1.363740e-02 3 1  ON 7
ci_0009                -1.887914e-02 3 1  ON 8
ci_0010                -1.816190e-02 3 1  ON 9
ci_0011                -1.477980e-02 3 1  ON 10
ci_0012                -1.471023e-02 3 1  ON 11
ci_0013                 1.533631e-02 3 1  ON 12
ci_0014                 1.479195e-02 3 1  ON 13
ci_0015                 1.592105e-02 3 1  ON 14
ci_0016                 1.551927e-02 3 1  ON 15
ci_0017                 1.342945e-02 3 1  ON 16
ci_0018                 1.316999e-02 3 1  ON 17
ci_0019                 1.301252e-02 3 1  ON 18
ci_0020                 1.260143e-02 3 1  ON 19
ci_0021                 7.736588e-03 3 1  ON 20
ci_0022                 8.389904e-03 3 1  ON 21
ci_0023                -1.187902e-02 3 1  ON 22
ci_0024                -1.137862e-02 3 1  ON 23
ci_0025                -2.046760e-03 3 1  ON 24
ci_0026                -2.799751e-03 3 1  ON 25
ci_0027                -1.200586e-02 3 1  ON 26
ci_0028                -1.159269e-02 3 1  ON 27
ci_0029                -1.051394e-02 3 1  ON 28
ci_0030                -1.045980e-02 3 1  ON 29
ci_0031                 1.357164e-02 3 1  ON 30
ci_0032                 1.227145e-02 3 1  ON 31
ci_0033                 7.993875e-03 3 1  ON 32
ci_0034                 8.514398e-03 3 1  ON 33
ci_0035                 4.989293e-03 3 1  ON 34
ci_0036                 5.109326e-03 3 1  ON 35
ci_0037                -1.126218e-02 3 1  ON 36
ci_0038                -1.153166e-02 3 1  ON 37
ci_0039                -4.040189e-03 3 1  ON 38
ci_0040                -4.036860e-03 3 1  ON 39
ci_0041                 8.951875e-03 3 1  ON 40
ci_0042                 8.739046e-03 3 1  ON 41
ci_0043                -1.252049e-02 3 1  ON 42
ci_0044                -1.314329e-02 3 1  ON 43
ci_0045                 1.066887e-02 3 1  ON 44
ci_0046                 1.018328e-02 3 1  ON 45
ci_0047                -3.628388e-03 3 1  ON 46
ci_0048                -3.414431e-03 3 1  ON 47
ci_0049                -2.518100e-03 3 1  ON 48
ci_0050                -2.775455e-03 3 1  ON 49
ci_0051                -1.755831e-03 3 1  ON 50
ci_0052                -2.074583e-03 3 1  ON 51
ci_0053                -3.975803e-03 3 1  ON 52
ci_0054                -3.312241e-03 3 1  ON 53
ci_0055                 2.825467e-03 3 1  ON 54
ci_0056                 2.256115e-03 3 1  ON 55
ci_0057                 2.236132e-03 3 1  ON 56
ci_0058                 3.171694e-03 3 1  ON 57
ci_0059                -3.374560e-03 3 1  ON 58
ci_0060                -3.202385e-03 3 1  ON 59
ci_0061                -3.955237e-03 3 1  ON 60
ci_0062                -4.022458e-03 3 1  ON 61
ci_0063                -9.960449e-03 3 1  ON 62
ci_0064                -9.491632e-03 3 1  ON 63
ci_0065                -6.356256e-03 3 1  ON 64
ci_0066                -6.199349e-03 3 1  ON 65
ci_0067                -3.651263e-03 3 1  ON 66
ci_0068                -3.423643e-03 3 1  ON 67
ci_0069                 3.764985e-03 3 1  ON 68
ci_0070                 3.409566e-03 3 1  ON 69
ci_0071                 2.918077e-03 3 1  ON 70
ci_0072                 3.675297e-03 3 1  ON 71
ci_0073                 3.661557e-03 3 1  ON 72
ci_0074                 3.589430e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8367
    reference variance = 0.200533
====================================================
  Execution time = 1.4404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9521e-01
  Total weights = 1.9512e+06
  Execution time = 1.8762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284112008616
                                         uncertainty =       0.001858242085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284112008616
                                         uncertainty =       0.001858242085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376871467
  error estimate for blocks of size 2^( 2) =       0.000393783875
  error estimate for blocks of size 2^( 3) =       0.000410824727
  error estimate for blocks of size 2^( 4) =       0.000425980650
  error estimate for blocks of size 2^( 5) =       0.000437277428
  error estimate for blocks of size 2^( 6) =       0.000443356327
  error estimate for blocks of size 2^( 7) =       0.000447912883

      target function =      -0.920220440077
              le_mean =     -16.898297111620
             les_mean =     285.847656289624
             stat err =       0.000438631822
             autocorr =       1.354608372730
   target nu stat err =       0.000438631822
   target dn stat err =       0.003117839469
      target stat err =       0.004913927991
              std dev =       0.532976739447
             le_variance =       0.284064204792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284111960082
                                         uncertainty =       0.001858232979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284111960082
                                         uncertainty =       0.001858232979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376871435
  error estimate for blocks of size 2^( 2) =       0.000393783844
  error estimate for blocks of size 2^( 3) =       0.000410824695
  error estimate for blocks of size 2^( 4) =       0.000425980613
  error estimate for blocks of size 2^( 5) =       0.000437277390
  error estimate for blocks of size 2^( 6) =       0.000443356285
  error estimate for blocks of size 2^( 7) =       0.000447912845

      target function =      -0.920220667104
              le_mean =     -16.898297113967
             les_mean =     285.847656223063
             stat err =       0.000438631783
             autocorr =       1.354608366599
   target nu stat err =       0.000438631783
   target dn stat err =       0.003117854580
      target stat err =       0.004913953673
              std dev =       0.532976693980
             le_variance =       0.284064156326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284111984346
                                         uncertainty =       0.001858237532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284111984346
                                         uncertainty =       0.001858237532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376871451
  error estimate for blocks of size 2^( 2) =       0.000393783860
  error estimate for blocks of size 2^( 3) =       0.000410824711
  error estimate for blocks of size 2^( 4) =       0.000425980631
  error estimate for blocks of size 2^( 5) =       0.000437277409
  error estimate for blocks of size 2^( 6) =       0.000443356306
  error estimate for blocks of size 2^( 7) =       0.000447912864

      target function =      -0.920220554298
              le_mean =     -16.898297112794
             les_mean =     285.847656255886
             stat err =       0.000438631803
             autocorr =       1.354608369666
   target nu stat err =       0.000438631803
   target dn stat err =       0.003117847022
      target stat err =       0.004913940836
              std dev =       0.532976716711
             le_variance =       0.284064180556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284112005582
                                         uncertainty =       0.001858241516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284112005582
                                         uncertainty =       0.001858241516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376871465
  error estimate for blocks of size 2^( 2) =       0.000393783873
  error estimate for blocks of size 2^( 3) =       0.000410824725
  error estimate for blocks of size 2^( 4) =       0.000425980647
  error estimate for blocks of size 2^( 5) =       0.000437277425
  error estimate for blocks of size 2^( 6) =       0.000443356324
  error estimate for blocks of size 2^( 7) =       0.000447912881

      target function =      -0.920220454429
              le_mean =     -16.898297111767
             les_mean =     285.847656285359
             stat err =       0.000438631819
             autocorr =       1.354608372360
   target nu stat err =       0.000438631819
   target dn stat err =       0.003117840413
      target stat err =       0.004913929597
              std dev =       0.532976736605
             le_variance =       0.284064201762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920220440077        initial
     8.6736e+02     8.6736e+03             2.5995e-07        -0.920220667104  <--
     3.4694e+03     3.4694e+04             6.4989e-08        -0.920220554298
     1.3878e+04     1.3878e+05             1.6247e-08        -0.920220454429

*****************************************************************************
Applying the update for shift_i =   8.6736e+02     and shift_s =   8.6736e+03
*****************************************************************************

  Execution time = 2.3888e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.079827e-01 3 1  ON 0
ci_0002                 6.933136e-01 3 1  ON 1
ci_0003                -3.123407e-02 3 1  ON 2
ci_0004                -3.036537e-02 3 1  ON 3
ci_0005                -3.057586e-02 3 1  ON 4
ci_0006                -3.070329e-02 3 1  ON 5
ci_0007                -1.389461e-02 3 1  ON 6
ci_0008                -1.363746e-02 3 1  ON 7
ci_0009                -1.887914e-02 3 1  ON 8
ci_0010                -1.816188e-02 3 1  ON 9
ci_0011                -1.477977e-02 3 1  ON 10
ci_0012                -1.471019e-02 3 1  ON 11
ci_0013                 1.533628e-02 3 1  ON 12
ci_0014                 1.479198e-02 3 1  ON 13
ci_0015                 1.592108e-02 3 1  ON 14
ci_0016                 1.551921e-02 3 1  ON 15
ci_0017                 1.342945e-02 3 1  ON 16
ci_0018                 1.317000e-02 3 1  ON 17
ci_0019                 1.301252e-02 3 1  ON 18
ci_0020                 1.260143e-02 3 1  ON 19
ci_0021                 7.736457e-03 3 1  ON 20
ci_0022                 8.389867e-03 3 1  ON 21
ci_0023                -1.187904e-02 3 1  ON 22
ci_0024                -1.137859e-02 3 1  ON 23
ci_0025                -2.046681e-03 3 1  ON 24
ci_0026                -2.799720e-03 3 1  ON 25
ci_0027                -1.200588e-02 3 1  ON 26
ci_0028                -1.159265e-02 3 1  ON 27
ci_0029                -1.051392e-02 3 1  ON 28
ci_0030                -1.045984e-02 3 1  ON 29
ci_0031                 1.357161e-02 3 1  ON 30
ci_0032                 1.227140e-02 3 1  ON 31
ci_0033                 7.993938e-03 3 1  ON 32
ci_0034                 8.514333e-03 3 1  ON 33
ci_0035                 4.989398e-03 3 1  ON 34
ci_0036                 5.109298e-03 3 1  ON 35
ci_0037                -1.126217e-02 3 1  ON 36
ci_0038                -1.153164e-02 3 1  ON 37
ci_0039                -4.040173e-03 3 1  ON 38
ci_0040                -4.036822e-03 3 1  ON 39
ci_0041                 8.951939e-03 3 1  ON 40
ci_0042                 8.739084e-03 3 1  ON 41
ci_0043                -1.252064e-02 3 1  ON 42
ci_0044                -1.314333e-02 3 1  ON 43
ci_0045                 1.066881e-02 3 1  ON 44
ci_0046                 1.018320e-02 3 1  ON 45
ci_0047                -3.628393e-03 3 1  ON 46
ci_0048                -3.414470e-03 3 1  ON 47
ci_0049                -2.518034e-03 3 1  ON 48
ci_0050                -2.775513e-03 3 1  ON 49
ci_0051                -1.755880e-03 3 1  ON 50
ci_0052                -2.074538e-03 3 1  ON 51
ci_0053                -3.975794e-03 3 1  ON 52
ci_0054                -3.312234e-03 3 1  ON 53
ci_0055                 2.825413e-03 3 1  ON 54
ci_0056                 2.256107e-03 3 1  ON 55
ci_0057                 2.236285e-03 3 1  ON 56
ci_0058                 3.171743e-03 3 1  ON 57
ci_0059                -3.374625e-03 3 1  ON 58
ci_0060                -3.202405e-03 3 1  ON 59
ci_0061                -3.955188e-03 3 1  ON 60
ci_0062                -4.022543e-03 3 1  ON 61
ci_0063                -9.960394e-03 3 1  ON 62
ci_0064                -9.491598e-03 3 1  ON 63
ci_0065                -6.356252e-03 3 1  ON 64
ci_0066                -6.199358e-03 3 1  ON 65
ci_0067                -3.651264e-03 3 1  ON 66
ci_0068                -3.423593e-03 3 1  ON 67
ci_0069                 3.764937e-03 3 1  ON 68
ci_0070                 3.409498e-03 3 1  ON 69
ci_0071                 2.918102e-03 3 1  ON 70
ci_0072                 3.675180e-03 3 1  ON 71
ci_0073                 3.661538e-03 3 1  ON 72
ci_0074                 3.589349e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.8384
    reference variance = 0.152321
====================================================
  Execution time = 1.4810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9418e-01
  Total weights = 1.951083302e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357556487
                                         uncertainty =       0.001988602615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357556487
                                         uncertainty =       0.001988602615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377678813
  error estimate for blocks of size 2^( 2) =       0.000394394138
  error estimate for blocks of size 2^( 3) =       0.000411778664
  error estimate for blocks of size 2^( 4) =       0.000426874793
  error estimate for blocks of size 2^( 5) =       0.000438644492
  error estimate for blocks of size 2^( 6) =       0.000445406777
  error estimate for blocks of size 2^( 7) =       0.000449382813

      target function =      -0.921837194448
              le_mean =     -16.898715140444
             les_mean =     285.860756804136
             stat err =       0.000440077219
             autocorr =       1.357727233279
   target nu stat err =       0.000440077219
   target dn stat err =       0.002303709215
      target stat err =       0.003681030536
              std dev =       0.534118499690
             le_variance =       0.285282571711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689871514044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921850524135       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921850627008       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921850645575       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921850650641       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921850654664       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921850656142       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921850656550       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921850656440       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921850656502       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921850658014       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921850658162       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921850658153       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921850658788       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921850658790       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921850658781       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921850658764       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921850658802       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921850658799       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+02 is 1.284783e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921850524135       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921850549860       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921850554503       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921850555770       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921850556776       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921850557146       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921850557247       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921850557219       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921850557234       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921850557611       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921850557649       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921850557645       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921850557807       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921850557808       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921850557803       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921850557800       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921850557809       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921850557808       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+02 is 3.212391e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921850524135       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921850530567       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921850531727       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921850532044       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921850532293       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921850532385       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921850532414       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921850532405       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921850532413       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921850532507       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921850532512       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921850532510       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921850532551       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921850532557       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921850532554       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921850532545       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921850532553       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.921850532557       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.4694e+03 is 8.031248e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.188587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7375e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.079830e-01 3 1  ON 0
ci_0002                 6.933134e-01 3 1  ON 1
ci_0003                -3.123403e-02 3 1  ON 2
ci_0004                -3.036535e-02 3 1  ON 3
ci_0005                -3.057583e-02 3 1  ON 4
ci_0006                -3.070321e-02 3 1  ON 5
ci_0007                -1.389466e-02 3 1  ON 6
ci_0008                -1.363733e-02 3 1  ON 7
ci_0009                -1.887913e-02 3 1  ON 8
ci_0010                -1.816185e-02 3 1  ON 9
ci_0011                -1.477979e-02 3 1  ON 10
ci_0012                -1.471018e-02 3 1  ON 11
ci_0013                 1.533630e-02 3 1  ON 12
ci_0014                 1.479193e-02 3 1  ON 13
ci_0015                 1.592105e-02 3 1  ON 14
ci_0016                 1.551920e-02 3 1  ON 15
ci_0017                 1.342945e-02 3 1  ON 16
ci_0018                 1.316993e-02 3 1  ON 17
ci_0019                 1.301252e-02 3 1  ON 18
ci_0020                 1.260144e-02 3 1  ON 19
ci_0021                 7.736136e-03 3 1  ON 20
ci_0022                 8.389891e-03 3 1  ON 21
ci_0023                -1.187909e-02 3 1  ON 22
ci_0024                -1.137853e-02 3 1  ON 23
ci_0025                -2.046619e-03 3 1  ON 24
ci_0026                -2.799715e-03 3 1  ON 25
ci_0027                -1.200587e-02 3 1  ON 26
ci_0028                -1.159267e-02 3 1  ON 27
ci_0029                -1.051393e-02 3 1  ON 28
ci_0030                -1.045990e-02 3 1  ON 29
ci_0031                 1.357159e-02 3 1  ON 30
ci_0032                 1.227135e-02 3 1  ON 31
ci_0033                 7.993959e-03 3 1  ON 32
ci_0034                 8.514407e-03 3 1  ON 33
ci_0035                 4.989310e-03 3 1  ON 34
ci_0036                 5.109250e-03 3 1  ON 35
ci_0037                -1.126221e-02 3 1  ON 36
ci_0038                -1.153172e-02 3 1  ON 37
ci_0039                -4.040186e-03 3 1  ON 38
ci_0040                -4.036788e-03 3 1  ON 39
ci_0041                 8.951947e-03 3 1  ON 40
ci_0042                 8.739091e-03 3 1  ON 41
ci_0043                -1.252066e-02 3 1  ON 42
ci_0044                -1.314342e-02 3 1  ON 43
ci_0045                 1.066874e-02 3 1  ON 44
ci_0046                 1.018323e-02 3 1  ON 45
ci_0047                -3.628407e-03 3 1  ON 46
ci_0048                -3.414460e-03 3 1  ON 47
ci_0049                -2.517912e-03 3 1  ON 48
ci_0050                -2.775484e-03 3 1  ON 49
ci_0051                -1.755913e-03 3 1  ON 50
ci_0052                -2.074474e-03 3 1  ON 51
ci_0053                -3.975718e-03 3 1  ON 52
ci_0054                -3.312270e-03 3 1  ON 53
ci_0055                 2.825384e-03 3 1  ON 54
ci_0056                 2.256102e-03 3 1  ON 55
ci_0057                 2.236296e-03 3 1  ON 56
ci_0058                 3.171649e-03 3 1  ON 57
ci_0059                -3.374627e-03 3 1  ON 58
ci_0060                -3.202381e-03 3 1  ON 59
ci_0061                -3.955235e-03 3 1  ON 60
ci_0062                -4.022501e-03 3 1  ON 61
ci_0063                -9.960388e-03 3 1  ON 62
ci_0064                -9.491530e-03 3 1  ON 63
ci_0065                -6.356238e-03 3 1  ON 64
ci_0066                -6.199373e-03 3 1  ON 65
ci_0067                -3.651222e-03 3 1  ON 66
ci_0068                -3.423533e-03 3 1  ON 67
ci_0069                 3.764896e-03 3 1  ON 68
ci_0070                 3.409387e-03 3 1  ON 69
ci_0071                 2.918090e-03 3 1  ON 70
ci_0072                 3.675185e-03 3 1  ON 71
ci_0073                 3.661531e-03 3 1  ON 72
ci_0074                 3.589315e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.263946
====================================================
  Execution time = 1.4397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9238e-01
  Total weights = 1.9509e+06
  Execution time = 1.8816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395388604
                                         uncertainty =       0.001888428256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395388604
                                         uncertainty =       0.001888428256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375795142
  error estimate for blocks of size 2^( 2) =       0.000393149654
  error estimate for blocks of size 2^( 3) =       0.000410776450
  error estimate for blocks of size 2^( 4) =       0.000427028454
  error estimate for blocks of size 2^( 5) =       0.000440891272
  error estimate for blocks of size 2^( 6) =       0.000450233312
  error estimate for blocks of size 2^( 7) =       0.000457136359

      target function =      -0.924661815151
              le_mean =     -16.898304547159
             les_mean =     285.845073189456
             stat err =       0.000443822349
             autocorr =       1.394813086330
   target nu stat err =       0.000443822349
   target dn stat err =       0.002857183712
      target stat err =       0.004557489480
              std dev =       0.531454586161
             le_variance =       0.282443977152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395253528
                                         uncertainty =       0.001888418728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395253528
                                         uncertainty =       0.001888418728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375795052
  error estimate for blocks of size 2^( 2) =       0.000393149589
  error estimate for blocks of size 2^( 3) =       0.000410776409
  error estimate for blocks of size 2^( 4) =       0.000427028431
  error estimate for blocks of size 2^( 5) =       0.000440891263
  error estimate for blocks of size 2^( 6) =       0.000450233314
  error estimate for blocks of size 2^( 7) =       0.000457136343

      target function =      -0.924662720009
              le_mean =     -16.898304550294
             les_mean =     285.845072726506
             stat err =       0.000443822338
             autocorr =       1.394813680557
   target nu stat err =       0.000443822338
   target dn stat err =       0.002856528431
      target stat err =       0.004556481702
              std dev =       0.531454459115
             le_variance =       0.282443842113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395321044
                                         uncertainty =       0.001888423491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395321044
                                         uncertainty =       0.001888423491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375795097
  error estimate for blocks of size 2^( 2) =       0.000393149621
  error estimate for blocks of size 2^( 3) =       0.000410776430
  error estimate for blocks of size 2^( 4) =       0.000427028442
  error estimate for blocks of size 2^( 5) =       0.000440891267
  error estimate for blocks of size 2^( 6) =       0.000450233313
  error estimate for blocks of size 2^( 7) =       0.000457136351

      target function =      -0.924662292637
              le_mean =     -16.898304548725
             les_mean =     285.845072941998
             stat err =       0.000443822344
             autocorr =       1.394813383514
   target nu stat err =       0.000443822344
   target dn stat err =       0.002856855785
      target stat err =       0.004556985390
              std dev =       0.531454522617
             le_variance =       0.282443909610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395380157
                                         uncertainty =       0.001888427661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282395380157
                                         uncertainty =       0.001888427661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375795136
  error estimate for blocks of size 2^( 2) =       0.000393149650
  error estimate for blocks of size 2^( 3) =       0.000410776448
  error estimate for blocks of size 2^( 4) =       0.000427028452
  error estimate for blocks of size 2^( 5) =       0.000440891271
  error estimate for blocks of size 2^( 6) =       0.000450233312
  error estimate for blocks of size 2^( 7) =       0.000457136358

      target function =      -0.924661877439
              le_mean =     -16.898304547355
             les_mean =     285.845073156863
             stat err =       0.000443822349
             autocorr =       1.394813123477
   target nu stat err =       0.000443822349
   target dn stat err =       0.002857142699
      target stat err =       0.004557426459
              std dev =       0.531454578216
             le_variance =       0.282443968707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924661815151        initial
     2.1684e+02     2.1684e+03             1.2848e-06        -0.924662720009  <--
     8.6736e+02     8.6736e+03             3.2124e-07        -0.924662292637
     3.4694e+03     3.4694e+04             8.0312e-08        -0.924661877439

*****************************************************************************
Applying the update for shift_i =   2.1684e+02     and shift_s =   2.1684e+03
*****************************************************************************

  Execution time = 2.3902e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.079838e-01 3 1  ON 0
ci_0002                 6.933126e-01 3 1  ON 1
ci_0003                -3.123388e-02 3 1  ON 2
ci_0004                -3.036528e-02 3 1  ON 3
ci_0005                -3.057573e-02 3 1  ON 4
ci_0006                -3.070298e-02 3 1  ON 5
ci_0007                -1.389480e-02 3 1  ON 6
ci_0008                -1.363693e-02 3 1  ON 7
ci_0009                -1.887910e-02 3 1  ON 8
ci_0010                -1.816176e-02 3 1  ON 9
ci_0011                -1.477985e-02 3 1  ON 10
ci_0012                -1.471013e-02 3 1  ON 11
ci_0013                 1.533635e-02 3 1  ON 12
ci_0014                 1.479177e-02 3 1  ON 13
ci_0015                 1.592097e-02 3 1  ON 14
ci_0016                 1.551917e-02 3 1  ON 15
ci_0017                 1.342945e-02 3 1  ON 16
ci_0018                 1.316972e-02 3 1  ON 17
ci_0019                 1.301252e-02 3 1  ON 18
ci_0020                 1.260149e-02 3 1  ON 19
ci_0021                 7.735173e-03 3 1  ON 20
ci_0022                 8.389963e-03 3 1  ON 21
ci_0023                -1.187923e-02 3 1  ON 22
ci_0024                -1.137835e-02 3 1  ON 23
ci_0025                -2.046432e-03 3 1  ON 24
ci_0026                -2.799702e-03 3 1  ON 25
ci_0027                -1.200584e-02 3 1  ON 26
ci_0028                -1.159270e-02 3 1  ON 27
ci_0029                -1.051396e-02 3 1  ON 28
ci_0030                -1.046009e-02 3 1  ON 29
ci_0031                 1.357153e-02 3 1  ON 30
ci_0032                 1.227120e-02 3 1  ON 31
ci_0033                 7.994021e-03 3 1  ON 32
ci_0034                 8.514627e-03 3 1  ON 33
ci_0035                 4.989048e-03 3 1  ON 34
ci_0036                 5.109106e-03 3 1  ON 35
ci_0037                -1.126231e-02 3 1  ON 36
ci_0038                -1.153195e-02 3 1  ON 37
ci_0039                -4.040225e-03 3 1  ON 38
ci_0040                -4.036685e-03 3 1  ON 39
ci_0041                 8.951970e-03 3 1  ON 40
ci_0042                 8.739111e-03 3 1  ON 41
ci_0043                -1.252072e-02 3 1  ON 42
ci_0044                -1.314368e-02 3 1  ON 43
ci_0045                 1.066856e-02 3 1  ON 44
ci_0046                 1.018330e-02 3 1  ON 45
ci_0047                -3.628449e-03 3 1  ON 46
ci_0048                -3.414428e-03 3 1  ON 47
ci_0049                -2.517546e-03 3 1  ON 48
ci_0050                -2.775400e-03 3 1  ON 49
ci_0051                -1.756010e-03 3 1  ON 50
ci_0052                -2.074283e-03 3 1  ON 51
ci_0053                -3.975488e-03 3 1  ON 52
ci_0054                -3.312380e-03 3 1  ON 53
ci_0055                 2.825297e-03 3 1  ON 54
ci_0056                 2.256088e-03 3 1  ON 55
ci_0057                 2.236327e-03 3 1  ON 56
ci_0058                 3.171367e-03 3 1  ON 57
ci_0059                -3.374634e-03 3 1  ON 58
ci_0060                -3.202311e-03 3 1  ON 59
ci_0061                -3.955377e-03 3 1  ON 60
ci_0062                -4.022377e-03 3 1  ON 61
ci_0063                -9.960370e-03 3 1  ON 62
ci_0064                -9.491325e-03 3 1  ON 63
ci_0065                -6.356198e-03 3 1  ON 64
ci_0066                -6.199418e-03 3 1  ON 65
ci_0067                -3.651096e-03 3 1  ON 66
ci_0068                -3.423353e-03 3 1  ON 67
ci_0069                 3.764774e-03 3 1  ON 68
ci_0070                 3.409054e-03 3 1  ON 69
ci_0071                 2.918052e-03 3 1  ON 70
ci_0072                 3.675198e-03 3 1  ON 71
ci_0073                 3.661510e-03 3 1  ON 72
ci_0074                 3.589214e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1283e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.9277
    reference variance = 0.118172
====================================================
  Execution time = 1.4643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9133e-01
  Total weights = 1.950795344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281355161419
                                         uncertainty =       0.002129486477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281355161419
                                         uncertainty =       0.002129486477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375009433
  error estimate for blocks of size 2^( 2) =       0.000391911012
  error estimate for blocks of size 2^( 3) =       0.000409476516
  error estimate for blocks of size 2^( 4) =       0.000424165352
  error estimate for blocks of size 2^( 5) =       0.000435362820
  error estimate for blocks of size 2^( 6) =       0.000441733098
  error estimate for blocks of size 2^( 7) =       0.000445985178

      target function =      -0.926309914785
              le_mean =     -16.897741600450
             les_mean =     285.825001458941
             stat err =       0.000436811612
             autocorr =       1.356762921545
   target nu stat err =       0.000436811612
   target dn stat err =       0.002390599449
      target stat err =       0.003842680224
              std dev =       0.530343425853
             le_variance =       0.281264149345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689774160045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926324586828       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926325130804       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926325217691       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926325248013       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926325296440       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926325321710       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926325330013       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926325337557       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926325348325       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926325361059       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926325360873       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926325363631       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926325364374       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926325364870       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926325364754       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926325364798       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926325364901       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+01 is 9.127019e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926324586828       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926324722969       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926324744710       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926324752293       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926324764406       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926324770724       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926324772799       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926324774686       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926324777377       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926324780557       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926324780508       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926324781197       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926324781381       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926324781505       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926324781477       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926324781488       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926324781513       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+02 is 2.281825e-06

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926324586828       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926324620872       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926324626308       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926324628204       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926324631232       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926324632814       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926324633331       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926324633803       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926324634475       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926324635269       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926324635261       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926324635428       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926324635479       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926324635509       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926324635499       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926324635502       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926324635508       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+02 is 5.704606e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.197824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7230e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.079816e-01 3 1  ON 0
ci_0002                 6.933149e-01 3 1  ON 1
ci_0003                -3.123336e-02 3 1  ON 2
ci_0004                -3.036520e-02 3 1  ON 3
ci_0005                -3.057618e-02 3 1  ON 4
ci_0006                -3.070315e-02 3 1  ON 5
ci_0007                -1.389453e-02 3 1  ON 6
ci_0008                -1.363621e-02 3 1  ON 7
ci_0009                -1.887899e-02 3 1  ON 8
ci_0010                -1.816179e-02 3 1  ON 9
ci_0011                -1.477997e-02 3 1  ON 10
ci_0012                -1.471014e-02 3 1  ON 11
ci_0013                 1.533625e-02 3 1  ON 12
ci_0014                 1.479168e-02 3 1  ON 13
ci_0015                 1.592092e-02 3 1  ON 14
ci_0016                 1.551920e-02 3 1  ON 15
ci_0017                 1.342948e-02 3 1  ON 16
ci_0018                 1.316973e-02 3 1  ON 17
ci_0019                 1.301231e-02 3 1  ON 18
ci_0020                 1.260177e-02 3 1  ON 19
ci_0021                 7.734390e-03 3 1  ON 20
ci_0022                 8.389590e-03 3 1  ON 21
ci_0023                -1.187913e-02 3 1  ON 22
ci_0024                -1.137863e-02 3 1  ON 23
ci_0025                -2.046281e-03 3 1  ON 24
ci_0026                -2.800002e-03 3 1  ON 25
ci_0027                -1.200601e-02 3 1  ON 26
ci_0028                -1.159253e-02 3 1  ON 27
ci_0029                -1.051406e-02 3 1  ON 28
ci_0030                -1.046012e-02 3 1  ON 29
ci_0031                 1.357134e-02 3 1  ON 30
ci_0032                 1.227105e-02 3 1  ON 31
ci_0033                 7.993884e-03 3 1  ON 32
ci_0034                 8.514389e-03 3 1  ON 33
ci_0035                 4.988799e-03 3 1  ON 34
ci_0036                 5.108622e-03 3 1  ON 35
ci_0037                -1.126208e-02 3 1  ON 36
ci_0038                -1.153190e-02 3 1  ON 37
ci_0039                -4.039925e-03 3 1  ON 38
ci_0040                -4.036545e-03 3 1  ON 39
ci_0041                 8.952129e-03 3 1  ON 40
ci_0042                 8.739054e-03 3 1  ON 41
ci_0043                -1.252052e-02 3 1  ON 42
ci_0044                -1.314444e-02 3 1  ON 43
ci_0045                 1.066830e-02 3 1  ON 44
ci_0046                 1.018331e-02 3 1  ON 45
ci_0047                -3.628279e-03 3 1  ON 46
ci_0048                -3.414417e-03 3 1  ON 47
ci_0049                -2.517550e-03 3 1  ON 48
ci_0050                -2.775103e-03 3 1  ON 49
ci_0051                -1.756203e-03 3 1  ON 50
ci_0052                -2.074250e-03 3 1  ON 51
ci_0053                -3.975272e-03 3 1  ON 52
ci_0054                -3.312390e-03 3 1  ON 53
ci_0055                 2.825283e-03 3 1  ON 54
ci_0056                 2.255748e-03 3 1  ON 55
ci_0057                 2.236505e-03 3 1  ON 56
ci_0058                 3.171104e-03 3 1  ON 57
ci_0059                -3.374609e-03 3 1  ON 58
ci_0060                -3.202336e-03 3 1  ON 59
ci_0061                -3.955628e-03 3 1  ON 60
ci_0062                -4.022189e-03 3 1  ON 61
ci_0063                -9.960370e-03 3 1  ON 62
ci_0064                -9.491284e-03 3 1  ON 63
ci_0065                -6.356081e-03 3 1  ON 64
ci_0066                -6.199312e-03 3 1  ON 65
ci_0067                -3.651273e-03 3 1  ON 66
ci_0068                -3.423529e-03 3 1  ON 67
ci_0069                 3.765087e-03 3 1  ON 68
ci_0070                 3.408704e-03 3 1  ON 69
ci_0071                 2.918196e-03 3 1  ON 70
ci_0072                 3.674809e-03 3 1  ON 71
ci_0073                 3.661261e-03 3 1  ON 72
ci_0074                 3.589042e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.224117
====================================================
  Execution time = 1.4412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9235e-01
  Total weights = 1.9512e+06
  Execution time = 1.8820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427421027
                                         uncertainty =       0.001437677070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427421027
                                         uncertainty =       0.001437677070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375129760
  error estimate for blocks of size 2^( 2) =       0.000391882053
  error estimate for blocks of size 2^( 3) =       0.000409823405
  error estimate for blocks of size 2^( 4) =       0.000425005629
  error estimate for blocks of size 2^( 5) =       0.000436436534
  error estimate for blocks of size 2^( 6) =       0.000444207146
  error estimate for blocks of size 2^( 7) =       0.000447659374

      target function =      -0.924716680978
              le_mean =     -16.898557608671
             les_mean =     285.853597657309
             stat err =       0.000438327171
             autocorr =       1.365317783010
   target nu stat err =       0.000438327171
   target dn stat err =       0.002239745178
      target stat err =       0.003603356684
              std dev =       0.530513594097
             le_variance =       0.281444673521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427378976
                                         uncertainty =       0.001437703785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427378976
                                         uncertainty =       0.001437703785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375129731
  error estimate for blocks of size 2^( 2) =       0.000391882065
  error estimate for blocks of size 2^( 3) =       0.000409823469
  error estimate for blocks of size 2^( 4) =       0.000425005671
  error estimate for blocks of size 2^( 5) =       0.000436436625
  error estimate for blocks of size 2^( 6) =       0.000444207305
  error estimate for blocks of size 2^( 7) =       0.000447659658

      target function =      -0.924715467549
              le_mean =     -16.898557610083
             les_mean =     285.853598471322
             stat err =       0.000438327315
             autocorr =       1.365318890939
   target nu stat err =       0.000438327315
   target dn stat err =       0.002240356299
      target stat err =       0.003604288560
              std dev =       0.530513552882
             le_variance =       0.281444629791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427399710
                                         uncertainty =       0.001437690431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427399710
                                         uncertainty =       0.001437690431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375129745
  error estimate for blocks of size 2^( 2) =       0.000391882059
  error estimate for blocks of size 2^( 3) =       0.000409823437
  error estimate for blocks of size 2^( 4) =       0.000425005650
  error estimate for blocks of size 2^( 5) =       0.000436436580
  error estimate for blocks of size 2^( 6) =       0.000444207225
  error estimate for blocks of size 2^( 7) =       0.000447659516

      target function =      -0.924716922009
              le_mean =     -16.898557609363
             les_mean =     285.853597525234
             stat err =       0.000438327243
             autocorr =       1.365318337316
   target nu stat err =       0.000438327243
   target dn stat err =       0.002240047962
      target stat err =       0.003603824813
              std dev =       0.530513573214
             le_variance =       0.281444651364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427418323
                                         uncertainty =       0.001437678738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281427418323
                                         uncertainty =       0.001437678738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375129758
  error estimate for blocks of size 2^( 2) =       0.000391882053
  error estimate for blocks of size 2^( 3) =       0.000409823409
  error estimate for blocks of size 2^( 4) =       0.000425005632
  error estimate for blocks of size 2^( 5) =       0.000436436540
  error estimate for blocks of size 2^( 6) =       0.000444207156
  error estimate for blocks of size 2^( 7) =       0.000447659392

      target function =      -0.924716796199
              le_mean =     -16.898557608757
             les_mean =     285.853597586706
             stat err =       0.000438327180
             autocorr =       1.365317852333
   target nu stat err =       0.000438327180
   target dn stat err =       0.002239782718
      target stat err =       0.003603415375
              std dev =       0.530513591448
             le_variance =       0.281444670711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924716680978        initial
     5.4210e+01     5.4210e+02             9.1270e-06        -0.924715467549
     2.1684e+02     2.1684e+03             2.2818e-06        -0.924716922009  <--
     8.6736e+02     8.6736e+03             5.7046e-07        -0.924716796199

*****************************************************************************
Applying the update for shift_i =   2.1684e+02     and shift_s =   2.1684e+03
*****************************************************************************

  Execution time = 2.3917e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.079816e-01 3 1  ON 0
ci_0002                 6.933149e-01 3 1  ON 1
ci_0003                -3.123336e-02 3 1  ON 2
ci_0004                -3.036520e-02 3 1  ON 3
ci_0005                -3.057618e-02 3 1  ON 4
ci_0006                -3.070315e-02 3 1  ON 5
ci_0007                -1.389453e-02 3 1  ON 6
ci_0008                -1.363621e-02 3 1  ON 7
ci_0009                -1.887899e-02 3 1  ON 8
ci_0010                -1.816179e-02 3 1  ON 9
ci_0011                -1.477997e-02 3 1  ON 10
ci_0012                -1.471014e-02 3 1  ON 11
ci_0013                 1.533625e-02 3 1  ON 12
ci_0014                 1.479168e-02 3 1  ON 13
ci_0015                 1.592092e-02 3 1  ON 14
ci_0016                 1.551920e-02 3 1  ON 15
ci_0017                 1.342948e-02 3 1  ON 16
ci_0018                 1.316973e-02 3 1  ON 17
ci_0019                 1.301231e-02 3 1  ON 18
ci_0020                 1.260177e-02 3 1  ON 19
ci_0021                 7.734390e-03 3 1  ON 20
ci_0022                 8.389590e-03 3 1  ON 21
ci_0023                -1.187913e-02 3 1  ON 22
ci_0024                -1.137863e-02 3 1  ON 23
ci_0025                -2.046281e-03 3 1  ON 24
ci_0026                -2.800002e-03 3 1  ON 25
ci_0027                -1.200601e-02 3 1  ON 26
ci_0028                -1.159253e-02 3 1  ON 27
ci_0029                -1.051406e-02 3 1  ON 28
ci_0030                -1.046012e-02 3 1  ON 29
ci_0031                 1.357134e-02 3 1  ON 30
ci_0032                 1.227105e-02 3 1  ON 31
ci_0033                 7.993884e-03 3 1  ON 32
ci_0034                 8.514389e-03 3 1  ON 33
ci_0035                 4.988799e-03 3 1  ON 34
ci_0036                 5.108622e-03 3 1  ON 35
ci_0037                -1.126208e-02 3 1  ON 36
ci_0038                -1.153190e-02 3 1  ON 37
ci_0039                -4.039925e-03 3 1  ON 38
ci_0040                -4.036545e-03 3 1  ON 39
ci_0041                 8.952129e-03 3 1  ON 40
ci_0042                 8.739054e-03 3 1  ON 41
ci_0043                -1.252052e-02 3 1  ON 42
ci_0044                -1.314444e-02 3 1  ON 43
ci_0045                 1.066830e-02 3 1  ON 44
ci_0046                 1.018331e-02 3 1  ON 45
ci_0047                -3.628279e-03 3 1  ON 46
ci_0048                -3.414417e-03 3 1  ON 47
ci_0049                -2.517550e-03 3 1  ON 48
ci_0050                -2.775103e-03 3 1  ON 49
ci_0051                -1.756203e-03 3 1  ON 50
ci_0052                -2.074250e-03 3 1  ON 51
ci_0053                -3.975272e-03 3 1  ON 52
ci_0054                -3.312390e-03 3 1  ON 53
ci_0055                 2.825283e-03 3 1  ON 54
ci_0056                 2.255748e-03 3 1  ON 55
ci_0057                 2.236505e-03 3 1  ON 56
ci_0058                 3.171104e-03 3 1  ON 57
ci_0059                -3.374609e-03 3 1  ON 58
ci_0060                -3.202336e-03 3 1  ON 59
ci_0061                -3.955628e-03 3 1  ON 60
ci_0062                -4.022189e-03 3 1  ON 61
ci_0063                -9.960370e-03 3 1  ON 62
ci_0064                -9.491284e-03 3 1  ON 63
ci_0065                -6.356081e-03 3 1  ON 64
ci_0066                -6.199312e-03 3 1  ON 65
ci_0067                -3.651273e-03 3 1  ON 66
ci_0068                -3.423529e-03 3 1  ON 67
ci_0069                 3.765087e-03 3 1  ON 68
ci_0070                 3.408704e-03 3 1  ON 69
ci_0071                 2.918196e-03 3 1  ON 70
ci_0072                 3.674809e-03 3 1  ON 71
ci_0073                 3.661261e-03 3 1  ON 72
ci_0074                 3.589042e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.216338
====================================================
  Execution time = 1.6655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9055e-01
  Total weights = 1.950859799e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280308297501
                                         uncertainty =       0.001449443589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280308297501
                                         uncertainty =       0.001449443589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374357901
  error estimate for blocks of size 2^( 2) =       0.000391297856
  error estimate for blocks of size 2^( 3) =       0.000408090367
  error estimate for blocks of size 2^( 4) =       0.000423686471
  error estimate for blocks of size 2^( 5) =       0.000436140548
  error estimate for blocks of size 2^( 6) =       0.000444277204
  error estimate for blocks of size 2^( 7) =       0.000448625111

      target function =      -0.927555427657
              le_mean =     -16.897974384330
             les_mean =     285.832085012378
             stat err =       0.000438182334
             autocorr =       1.370047802791
   target nu stat err =       0.000438182334
   target dn stat err =       0.002023896408
      target stat err =       0.003287737737
              std dev =       0.529422020913
             le_variance =       0.280287676228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689797438433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927565563717       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927566238591       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927566323370       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927566369207       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927566401896       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927566410239       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927566411513       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927566411034       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927566410398       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927566410529       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927566410553       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927566410554       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927566410564       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927566410605       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+01 is 3.869815e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927565563717       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927565732623       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927565753835       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927565765301       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927565773476       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927565775560       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927565775879       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927565775758       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927565775599       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927565775632       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927565775638       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927565775639       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927565775642       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927565775652       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+02 is 9.680063e-07

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927565563717       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927565605955       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927565611259       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927565614126       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927565616170       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927565616691       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927565616771       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927565616740       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927565616701       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927565616712       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927565616712       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927565616710       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927565616712       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927565616713       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.6736e+02 is 2.420361e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.204192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9549e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.079816e-01 3 1  ON 0
ci_0002                 6.933149e-01 3 1  ON 1
ci_0003                -3.123283e-02 3 1  ON 2
ci_0004                -3.036526e-02 3 1  ON 3
ci_0005                -3.057635e-02 3 1  ON 4
ci_0006                -3.070290e-02 3 1  ON 5
ci_0007                -1.389414e-02 3 1  ON 6
ci_0008                -1.363580e-02 3 1  ON 7
ci_0009                -1.887898e-02 3 1  ON 8
ci_0010                -1.816184e-02 3 1  ON 9
ci_0011                -1.477987e-02 3 1  ON 10
ci_0012                -1.471015e-02 3 1  ON 11
ci_0013                 1.533651e-02 3 1  ON 12
ci_0014                 1.479159e-02 3 1  ON 13
ci_0015                 1.592069e-02 3 1  ON 14
ci_0016                 1.551911e-02 3 1  ON 15
ci_0017                 1.342909e-02 3 1  ON 16
ci_0018                 1.316973e-02 3 1  ON 17
ci_0019                 1.301236e-02 3 1  ON 18
ci_0020                 1.260173e-02 3 1  ON 19
ci_0021                 7.733898e-03 3 1  ON 20
ci_0022                 8.389399e-03 3 1  ON 21
ci_0023                -1.187885e-02 3 1  ON 22
ci_0024                -1.137870e-02 3 1  ON 23
ci_0025                -2.046348e-03 3 1  ON 24
ci_0026                -2.799219e-03 3 1  ON 25
ci_0027                -1.200576e-02 3 1  ON 26
ci_0028                -1.159274e-02 3 1  ON 27
ci_0029                -1.051401e-02 3 1  ON 28
ci_0030                -1.046023e-02 3 1  ON 29
ci_0031                 1.357102e-02 3 1  ON 30
ci_0032                 1.227076e-02 3 1  ON 31
ci_0033                 7.993523e-03 3 1  ON 32
ci_0034                 8.514331e-03 3 1  ON 33
ci_0035                 4.988906e-03 3 1  ON 34
ci_0036                 5.108320e-03 3 1  ON 35
ci_0037                -1.126182e-02 3 1  ON 36
ci_0038                -1.153173e-02 3 1  ON 37
ci_0039                -4.039858e-03 3 1  ON 38
ci_0040                -4.036472e-03 3 1  ON 39
ci_0041                 8.952303e-03 3 1  ON 40
ci_0042                 8.739082e-03 3 1  ON 41
ci_0043                -1.252085e-02 3 1  ON 42
ci_0044                -1.314541e-02 3 1  ON 43
ci_0045                 1.066850e-02 3 1  ON 44
ci_0046                 1.018337e-02 3 1  ON 45
ci_0047                -3.628248e-03 3 1  ON 46
ci_0048                -3.414433e-03 3 1  ON 47
ci_0049                -2.517431e-03 3 1  ON 48
ci_0050                -2.774904e-03 3 1  ON 49
ci_0051                -1.756360e-03 3 1  ON 50
ci_0052                -2.074316e-03 3 1  ON 51
ci_0053                -3.975198e-03 3 1  ON 52
ci_0054                -3.312122e-03 3 1  ON 53
ci_0055                 2.824850e-03 3 1  ON 54
ci_0056                 2.255768e-03 3 1  ON 55
ci_0057                 2.236871e-03 3 1  ON 56
ci_0058                 3.171116e-03 3 1  ON 57
ci_0059                -3.374900e-03 3 1  ON 58
ci_0060                -3.202351e-03 3 1  ON 59
ci_0061                -3.955702e-03 3 1  ON 60
ci_0062                -4.022115e-03 3 1  ON 61
ci_0063                -9.960284e-03 3 1  ON 62
ci_0064                -9.491276e-03 3 1  ON 63
ci_0065                -6.356092e-03 3 1  ON 64
ci_0066                -6.199284e-03 3 1  ON 65
ci_0067                -3.651026e-03 3 1  ON 66
ci_0068                -3.423718e-03 3 1  ON 67
ci_0069                 3.764797e-03 3 1  ON 68
ci_0070                 3.408944e-03 3 1  ON 69
ci_0071                 2.918076e-03 3 1  ON 70
ci_0072                 3.674382e-03 3 1  ON 71
ci_0073                 3.661318e-03 3 1  ON 72
ci_0074                 3.588853e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.8271
    reference variance = 0.260014
====================================================
  Execution time = 1.4326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9400e-01
  Total weights = 1.9507e+06
  Execution time = 1.8897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281959992242
                                         uncertainty =       0.001805873648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281959992242
                                         uncertainty =       0.001805873648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375429661
  error estimate for blocks of size 2^( 2) =       0.000392214463
  error estimate for blocks of size 2^( 3) =       0.000409347170
  error estimate for blocks of size 2^( 4) =       0.000425055579
  error estimate for blocks of size 2^( 5) =       0.000436376878
  error estimate for blocks of size 2^( 6) =       0.000444477369
  error estimate for blocks of size 2^( 7) =       0.000449717568

      target function =      -0.922101347661
              le_mean =     -16.898472429552
             les_mean =     285.852367217978
             stat err =       0.000438906849
             autocorr =       1.366745183205
   target nu stat err =       0.000438906849
   target dn stat err =       0.003957994065
      target stat err =       0.006238384618
              std dev =       0.530937718550
             le_variance =       0.281894860979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281958938745
                                         uncertainty =       0.001805736778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281958938745
                                         uncertainty =       0.001805736778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375428959
  error estimate for blocks of size 2^( 2) =       0.000392213790
  error estimate for blocks of size 2^( 3) =       0.000409346515
  error estimate for blocks of size 2^( 4) =       0.000425054948
  error estimate for blocks of size 2^( 5) =       0.000436376205
  error estimate for blocks of size 2^( 6) =       0.000444476701
  error estimate for blocks of size 2^( 7) =       0.000449716925

      target function =      -0.922105372509
              le_mean =     -16.898472445073
             les_mean =     285.852365174479
             stat err =       0.000438906195
             autocorr =       1.366746221180
   target nu stat err =       0.000438906195
   target dn stat err =       0.003957684051
      target stat err =       0.006237957027
              std dev =       0.530936726087
             le_variance =       0.281893807108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281959464751
                                         uncertainty =       0.001805805132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281959464751
                                         uncertainty =       0.001805805132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375429310
  error estimate for blocks of size 2^( 2) =       0.000392214126
  error estimate for blocks of size 2^( 3) =       0.000409346842
  error estimate for blocks of size 2^( 4) =       0.000425055263
  error estimate for blocks of size 2^( 5) =       0.000436376541
  error estimate for blocks of size 2^( 6) =       0.000444477034
  error estimate for blocks of size 2^( 7) =       0.000449717246

      target function =      -0.922103385669
              le_mean =     -16.898472437290
             les_mean =     285.852366179140
             stat err =       0.000438906521
             autocorr =       1.366745702932
   target nu stat err =       0.000438906521
   target dn stat err =       0.003957838585
      target stat err =       0.006238170433
              std dev =       0.530937221619
             le_variance =       0.281894333300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281959926259
                                         uncertainty =       0.001805865080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281959926259
                                         uncertainty =       0.001805865080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375429617
  error estimate for blocks of size 2^( 2) =       0.000392214421
  error estimate for blocks of size 2^( 3) =       0.000409347128
  error estimate for blocks of size 2^( 4) =       0.000425055540
  error estimate for blocks of size 2^( 5) =       0.000436376836
  error estimate for blocks of size 2^( 6) =       0.000444477327
  error estimate for blocks of size 2^( 7) =       0.000449717528

      target function =      -0.922101605154
              le_mean =     -16.898472430516
             les_mean =     285.852367086266
             stat err =       0.000438906808
             autocorr =       1.366745248209
   target nu stat err =       0.000438906808
   target dn stat err =       0.003957974593
      target stat err =       0.006238357824
              std dev =       0.530937656390
             le_variance =       0.281894794973


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922101347661        initial
     5.4210e+01     5.4210e+02             3.8698e-06        -0.922105372509  <--
     2.1684e+02     2.1684e+03             9.6801e-07        -0.922103385669
     8.6736e+02     8.6736e+03             2.4204e-07        -0.922101605154

*****************************************************************************
Applying the update for shift_i =   5.4210e+01     and shift_s =   5.4210e+02
*****************************************************************************

  Execution time = 2.4001e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.079817e-01 3 1  ON 0
ci_0002                 6.933151e-01 3 1  ON 1
ci_0003                -3.123125e-02 3 1  ON 2
ci_0004                -3.036543e-02 3 1  ON 3
ci_0005                -3.057688e-02 3 1  ON 4
ci_0006                -3.070213e-02 3 1  ON 5
ci_0007                -1.389298e-02 3 1  ON 6
ci_0008                -1.363455e-02 3 1  ON 7
ci_0009                -1.887895e-02 3 1  ON 8
ci_0010                -1.816199e-02 3 1  ON 9
ci_0011                -1.477956e-02 3 1  ON 10
ci_0012                -1.471017e-02 3 1  ON 11
ci_0013                 1.533730e-02 3 1  ON 12
ci_0014                 1.479133e-02 3 1  ON 13
ci_0015                 1.592002e-02 3 1  ON 14
ci_0016                 1.551884e-02 3 1  ON 15
ci_0017                 1.342795e-02 3 1  ON 16
ci_0018                 1.316974e-02 3 1  ON 17
ci_0019                 1.301251e-02 3 1  ON 18
ci_0020                 1.260161e-02 3 1  ON 19
ci_0021                 7.732423e-03 3 1  ON 20
ci_0022                 8.388827e-03 3 1  ON 21
ci_0023                -1.187801e-02 3 1  ON 22
ci_0024                -1.137891e-02 3 1  ON 23
ci_0025                -2.046548e-03 3 1  ON 24
ci_0026                -2.796874e-03 3 1  ON 25
ci_0027                -1.200501e-02 3 1  ON 26
ci_0028                -1.159339e-02 3 1  ON 27
ci_0029                -1.051386e-02 3 1  ON 28
ci_0030                -1.046054e-02 3 1  ON 29
ci_0031                 1.357005e-02 3 1  ON 30
ci_0032                 1.226986e-02 3 1  ON 31
ci_0033                 7.992441e-03 3 1  ON 32
ci_0034                 8.514159e-03 3 1  ON 33
ci_0035                 4.989228e-03 3 1  ON 34
ci_0036                 5.107415e-03 3 1  ON 35
ci_0037                -1.126103e-02 3 1  ON 36
ci_0038                -1.153123e-02 3 1  ON 37
ci_0039                -4.039659e-03 3 1  ON 38
ci_0040                -4.036253e-03 3 1  ON 39
ci_0041                 8.952826e-03 3 1  ON 40
ci_0042                 8.739168e-03 3 1  ON 41
ci_0043                -1.252184e-02 3 1  ON 42
ci_0044                -1.314831e-02 3 1  ON 43
ci_0045                 1.066909e-02 3 1  ON 44
ci_0046                 1.018354e-02 3 1  ON 45
ci_0047                -3.628155e-03 3 1  ON 46
ci_0048                -3.414480e-03 3 1  ON 47
ci_0049                -2.517074e-03 3 1  ON 48
ci_0050                -2.774308e-03 3 1  ON 49
ci_0051                -1.756828e-03 3 1  ON 50
ci_0052                -2.074516e-03 3 1  ON 51
ci_0053                -3.974977e-03 3 1  ON 52
ci_0054                -3.311318e-03 3 1  ON 53
ci_0055                 2.823555e-03 3 1  ON 54
ci_0056                 2.255826e-03 3 1  ON 55
ci_0057                 2.237968e-03 3 1  ON 56
ci_0058                 3.171149e-03 3 1  ON 57
ci_0059                -3.375770e-03 3 1  ON 58
ci_0060                -3.202396e-03 3 1  ON 59
ci_0061                -3.955923e-03 3 1  ON 60
ci_0062                -4.021896e-03 3 1  ON 61
ci_0063                -9.960029e-03 3 1  ON 62
ci_0064                -9.491251e-03 3 1  ON 63
ci_0065                -6.356123e-03 3 1  ON 64
ci_0066                -6.199200e-03 3 1  ON 65
ci_0067                -3.650285e-03 3 1  ON 66
ci_0068                -3.424285e-03 3 1  ON 67
ci_0069                 3.763930e-03 3 1  ON 68
ci_0070                 3.409661e-03 3 1  ON 69
ci_0071                 2.917717e-03 3 1  ON 70
ci_0072                 3.673100e-03 3 1  ON 71
ci_0073                 3.661491e-03 3 1  ON 72
ci_0074                 3.588289e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.8912
    reference variance = 0.192238
====================================================
  Execution time = 1.4573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8883e-01
  Total weights = 1.951011351e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280489276642
                                         uncertainty =       0.001384880212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280489276642
                                         uncertainty =       0.001384880212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374561380
  error estimate for blocks of size 2^( 2) =       0.000391841017
  error estimate for blocks of size 2^( 3) =       0.000409395674
  error estimate for blocks of size 2^( 4) =       0.000425133010
  error estimate for blocks of size 2^( 5) =       0.000438070297
  error estimate for blocks of size 2^( 6) =       0.000445702263
  error estimate for blocks of size 2^( 7) =       0.000452738561

      target function =      -0.930280171670
              le_mean =     -16.897953731653
             les_mean =     285.829669960400
             stat err =       0.000440411033
             autocorr =       1.382516705477
   target nu stat err =       0.000440411033
   target dn stat err =       0.001926639190
      target stat err =       0.003156829926
              std dev =       0.529709783322
             le_variance =       0.280592454547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689795373165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+01, overlap shift 1.3553e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930289459189       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930292307630       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930292760312       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930292910693       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930293027743       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930293029179       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930293046023       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930293048425       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930293049008       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930293047225       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930293047967       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930293042328       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930293043245       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930293046452       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930293046197       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930293046614       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930293047030       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+01 is 1.262300e-05

solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930289459189       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930290174515       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930290288096       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930290325786       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930290355086       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930290355430       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930290359640       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930290360235       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930290360379       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930290359931       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930290360117       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930290358710       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930290358942       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930290359742       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930290359678       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930290359782       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930290359885       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+01 is 3.163256e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930289459189       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930289638223       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930289666644       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930289676073       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930289683400       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930289683485       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930289684537       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930289684686       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930289684722       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930289684610       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930289684656       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930289684304       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930289684362       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930289684562       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930289684547       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930289684573       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930289684598       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1684e+02 is 7.912846e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.213421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7191e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.079806e-01 3 1  ON 0
ci_0002                 6.933163e-01 3 1  ON 1
ci_0003                -3.123009e-02 3 1  ON 2
ci_0004                -3.036505e-02 3 1  ON 3
ci_0005                -3.057653e-02 3 1  ON 4
ci_0006                -3.070218e-02 3 1  ON 5
ci_0007                -1.389299e-02 3 1  ON 6
ci_0008                -1.363339e-02 3 1  ON 7
ci_0009                -1.887829e-02 3 1  ON 8
ci_0010                -1.816194e-02 3 1  ON 9
ci_0011                -1.478040e-02 3 1  ON 10
ci_0012                -1.470966e-02 3 1  ON 11
ci_0013                 1.533690e-02 3 1  ON 12
ci_0014                 1.479139e-02 3 1  ON 13
ci_0015                 1.591963e-02 3 1  ON 14
ci_0016                 1.551987e-02 3 1  ON 15
ci_0017                 1.342806e-02 3 1  ON 16
ci_0018                 1.316952e-02 3 1  ON 17
ci_0019                 1.301309e-02 3 1  ON 18
ci_0020                 1.260079e-02 3 1  ON 19
ci_0021                 7.731177e-03 3 1  ON 20
ci_0022                 8.385749e-03 3 1  ON 21
ci_0023                -1.187770e-02 3 1  ON 22
ci_0024                -1.137889e-02 3 1  ON 23
ci_0025                -2.045745e-03 3 1  ON 24
ci_0026                -2.795223e-03 3 1  ON 25
ci_0027                -1.200480e-02 3 1  ON 26
ci_0028                -1.159373e-02 3 1  ON 27
ci_0029                -1.051430e-02 3 1  ON 28
ci_0030                -1.046172e-02 3 1  ON 29
ci_0031                 1.356945e-02 3 1  ON 30
ci_0032                 1.227052e-02 3 1  ON 31
ci_0033                 7.992844e-03 3 1  ON 32
ci_0034                 8.512326e-03 3 1  ON 33
ci_0035                 4.988131e-03 3 1  ON 34
ci_0036                 5.106264e-03 3 1  ON 35
ci_0037                -1.126037e-02 3 1  ON 36
ci_0038                -1.153186e-02 3 1  ON 37
ci_0039                -4.039295e-03 3 1  ON 38
ci_0040                -4.035562e-03 3 1  ON 39
ci_0041                 8.952687e-03 3 1  ON 40
ci_0042                 8.739668e-03 3 1  ON 41
ci_0043                -1.252351e-02 3 1  ON 42
ci_0044                -1.315147e-02 3 1  ON 43
ci_0045                 1.066907e-02 3 1  ON 44
ci_0046                 1.018353e-02 3 1  ON 45
ci_0047                -3.628001e-03 3 1  ON 46
ci_0048                -3.414252e-03 3 1  ON 47
ci_0049                -2.517704e-03 3 1  ON 48
ci_0050                -2.773551e-03 3 1  ON 49
ci_0051                -1.756963e-03 3 1  ON 50
ci_0052                -2.072496e-03 3 1  ON 51
ci_0053                -3.973503e-03 3 1  ON 52
ci_0054                -3.312068e-03 3 1  ON 53
ci_0055                 2.824622e-03 3 1  ON 54
ci_0056                 2.255886e-03 3 1  ON 55
ci_0057                 2.239454e-03 3 1  ON 56
ci_0058                 3.169232e-03 3 1  ON 57
ci_0059                -3.375637e-03 3 1  ON 58
ci_0060                -3.201056e-03 3 1  ON 59
ci_0061                -3.955403e-03 3 1  ON 60
ci_0062                -4.022308e-03 3 1  ON 61
ci_0063                -9.959266e-03 3 1  ON 62
ci_0064                -9.491110e-03 3 1  ON 63
ci_0065                -6.356424e-03 3 1  ON 64
ci_0066                -6.199509e-03 3 1  ON 65
ci_0067                -3.650870e-03 3 1  ON 66
ci_0068                -3.424730e-03 3 1  ON 67
ci_0069                 3.761662e-03 3 1  ON 68
ci_0070                 3.410277e-03 3 1  ON 69
ci_0071                 2.917618e-03 3 1  ON 70
ci_0072                 3.673362e-03 3 1  ON 71
ci_0073                 3.661417e-03 3 1  ON 72
ci_0074                 3.589369e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9358
    reference variance = 0.214234
====================================================
  Execution time = 1.4251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9297e-01
  Total weights = 1.9506e+06
  Execution time = 1.8819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281960632031
                                         uncertainty =       0.001922320235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281960632031
                                         uncertainty =       0.001922320235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375468537
  error estimate for blocks of size 2^( 2) =       0.000392528686
  error estimate for blocks of size 2^( 3) =       0.000410254612
  error estimate for blocks of size 2^( 4) =       0.000425814431
  error estimate for blocks of size 2^( 5) =       0.000438173288
  error estimate for blocks of size 2^( 6) =       0.000447809309
  error estimate for blocks of size 2^( 7) =       0.000453609012

      target function =      -0.923691877175
              le_mean =     -16.897701406309
             les_mean =     285.825296336255
             stat err =       0.000441351510
             autocorr =       1.381726643187
   target nu stat err =       0.000441351510
   target dn stat err =       0.003534368540
      target stat err =       0.005592435852
              std dev =       0.530992697582
             le_variance =       0.281953244885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281955052108
                                         uncertainty =       0.001922026013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281955052108
                                         uncertainty =       0.001922026013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375464824
  error estimate for blocks of size 2^( 2) =       0.000392525175
  error estimate for blocks of size 2^( 3) =       0.000410251214
  error estimate for blocks of size 2^( 4) =       0.000425810866
  error estimate for blocks of size 2^( 5) =       0.000438169962
  error estimate for blocks of size 2^( 6) =       0.000447805823
  error estimate for blocks of size 2^( 7) =       0.000453604792

      target function =      -0.923749650420
              le_mean =     -16.897701299187
             les_mean =     285.825256083551
             stat err =       0.000441347861
             autocorr =       1.381731121591
   target nu stat err =       0.000441347861
   target dn stat err =       0.003516687231
      target stat err =       0.005565648011
              std dev =       0.530987446801
             le_variance =       0.281947668660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281957827302
                                         uncertainty =       0.001922171762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281957827302
                                         uncertainty =       0.001922171762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375466671
  error estimate for blocks of size 2^( 2) =       0.000392526921
  error estimate for blocks of size 2^( 3) =       0.000410252904
  error estimate for blocks of size 2^( 4) =       0.000425812640
  error estimate for blocks of size 2^( 5) =       0.000438171617
  error estimate for blocks of size 2^( 6) =       0.000447807558
  error estimate for blocks of size 2^( 7) =       0.000453606893

      target function =      -0.923721439422
              le_mean =     -16.897701352115
             les_mean =     285.825275757831
             stat err =       0.000441349677
             autocorr =       1.381728902798
   target nu stat err =       0.000441349677
   target dn stat err =       0.003525474317
      target stat err =       0.005578967311
              std dev =       0.530990058302
             le_variance =       0.281950442016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281960280165
                                         uncertainty =       0.001922301535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281960280165
                                         uncertainty =       0.001922301535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375468303
  error estimate for blocks of size 2^( 2) =       0.000392528464
  error estimate for blocks of size 2^( 3) =       0.000410254398
  error estimate for blocks of size 2^( 4) =       0.000425814207
  error estimate for blocks of size 2^( 5) =       0.000438173079
  error estimate for blocks of size 2^( 6) =       0.000447809089
  error estimate for blocks of size 2^( 7) =       0.000453608746

      target function =      -0.923695649004
              le_mean =     -16.897701399475
             les_mean =     285.825293713107
             stat err =       0.000441351280
             autocorr =       1.381726927322
   target nu stat err =       0.000441351280
   target dn stat err =       0.003533251266
      target stat err =       0.005590744723
              std dev =       0.530992366474
             le_variance =       0.281952893254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923691877175        initial
     1.3553e+01     1.3553e+02             1.2623e-05        -0.923749650420  <--
     5.4210e+01     5.4210e+02             3.1633e-06        -0.923721439422
     2.1684e+02     2.1684e+03             7.9128e-07        -0.923695649004

*****************************************************************************
Applying the update for shift_i =   1.3553e+01     and shift_s =   1.3553e+02
*****************************************************************************

  Execution time = 2.3781e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.079775e-01 3 1  ON 0
ci_0002                 6.933198e-01 3 1  ON 1
ci_0003                -3.122663e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057548e-02 3 1  ON 4
ci_0006                -3.070231e-02 3 1  ON 5
ci_0007                -1.389302e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887631e-02 3 1  ON 8
ci_0010                -1.816177e-02 3 1  ON 9
ci_0011                -1.478291e-02 3 1  ON 10
ci_0012                -1.470813e-02 3 1  ON 11
ci_0013                 1.533568e-02 3 1  ON 12
ci_0014                 1.479156e-02 3 1  ON 13
ci_0015                 1.591849e-02 3 1  ON 14
ci_0016                 1.552294e-02 3 1  ON 15
ci_0017                 1.342841e-02 3 1  ON 16
ci_0018                 1.316889e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259834e-02 3 1  ON 19
ci_0021                 7.727452e-03 3 1  ON 20
ci_0022                 8.376547e-03 3 1  ON 21
ci_0023                -1.187675e-02 3 1  ON 22
ci_0024                -1.137881e-02 3 1  ON 23
ci_0025                -2.043351e-03 3 1  ON 24
ci_0026                -2.790300e-03 3 1  ON 25
ci_0027                -1.200418e-02 3 1  ON 26
ci_0028                -1.159475e-02 3 1  ON 27
ci_0029                -1.051562e-02 3 1  ON 28
ci_0030                -1.046522e-02 3 1  ON 29
ci_0031                 1.356768e-02 3 1  ON 30
ci_0032                 1.227247e-02 3 1  ON 31
ci_0033                 7.994048e-03 3 1  ON 32
ci_0034                 8.506845e-03 3 1  ON 33
ci_0035                 4.984860e-03 3 1  ON 34
ci_0036                 5.102828e-03 3 1  ON 35
ci_0037                -1.125841e-02 3 1  ON 36
ci_0038                -1.153375e-02 3 1  ON 37
ci_0039                -4.038210e-03 3 1  ON 38
ci_0040                -4.033503e-03 3 1  ON 39
ci_0041                 8.952270e-03 3 1  ON 40
ci_0042                 8.741161e-03 3 1  ON 41
ci_0043                -1.252850e-02 3 1  ON 42
ci_0044                -1.316093e-02 3 1  ON 43
ci_0045                 1.066904e-02 3 1  ON 44
ci_0046                 1.018350e-02 3 1  ON 45
ci_0047                -3.627542e-03 3 1  ON 46
ci_0048                -3.413573e-03 3 1  ON 47
ci_0049                -2.519585e-03 3 1  ON 48
ci_0050                -2.771294e-03 3 1  ON 49
ci_0051                -1.757367e-03 3 1  ON 50
ci_0052                -2.066475e-03 3 1  ON 51
ci_0053                -3.969105e-03 3 1  ON 52
ci_0054                -3.314302e-03 3 1  ON 53
ci_0055                 2.827804e-03 3 1  ON 54
ci_0056                 2.256064e-03 3 1  ON 55
ci_0057                 2.243886e-03 3 1  ON 56
ci_0058                 3.163514e-03 3 1  ON 57
ci_0059                -3.375242e-03 3 1  ON 58
ci_0060                -3.197060e-03 3 1  ON 59
ci_0061                -3.953849e-03 3 1  ON 60
ci_0062                -4.023539e-03 3 1  ON 61
ci_0063                -9.956988e-03 3 1  ON 62
ci_0064                -9.490688e-03 3 1  ON 63
ci_0065                -6.357324e-03 3 1  ON 64
ci_0066                -6.200429e-03 3 1  ON 65
ci_0067                -3.652613e-03 3 1  ON 66
ci_0068                -3.426057e-03 3 1  ON 67
ci_0069                 3.754897e-03 3 1  ON 68
ci_0070                 3.412115e-03 3 1  ON 69
ci_0071                 2.917322e-03 3 1  ON 70
ci_0072                 3.674143e-03 3 1  ON 71
ci_0073                 3.661194e-03 3 1  ON 72
ci_0074                 3.592591e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9302
    reference variance = 0.44788
====================================================
  Execution time = 1.4715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9023e-01
  Total weights = 1.950829508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279400040124
                                         uncertainty =       0.001715676460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279400040124
                                         uncertainty =       0.001715676460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373807014
  error estimate for blocks of size 2^( 2) =       0.000390607726
  error estimate for blocks of size 2^( 3) =       0.000407690722
  error estimate for blocks of size 2^( 4) =       0.000423133965
  error estimate for blocks of size 2^( 5) =       0.000433614583
  error estimate for blocks of size 2^( 6) =       0.000439942087
  error estimate for blocks of size 2^( 7) =       0.000441490342

      target function =      -0.928061401605
              le_mean =     -16.898473218869
             les_mean =     285.848624337718
             stat err =       0.000434545244
             autocorr =       1.351372602442
   target nu stat err =       0.000434545244
   target dn stat err =       0.002591297401
      target stat err =       0.004174060813
              std dev =       0.528642949401
             le_variance =       0.279463367952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689847321887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+00, overlap shift 3.3881e+01 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928078989155       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928084072946       residual = 7.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928085383167       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928085753291       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928085989581       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928086071651       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928086110465       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928086115870       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928086121532       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928086127120       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928086132543       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928086134786       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928086135592       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928086140840       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928086141248       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928086141102       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928086140021       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+00 is 6.058692e-05

solving harmonic davidson linear method for identity shift 1.3553e+01, overlap shift 1.3553e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928078989155       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928080281343       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928080612770       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928080705778       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928080765049       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928080785469       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928080795111       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928080796432       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928080797847       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928080799252       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928080800616       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928080801173       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928080801375       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928080802652       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928080802733       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928080802696       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928080802436       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+01 is 1.527403e-05

solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928078989155       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928079313558       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928079396660       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928079419941       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928079434771       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928079439869       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928079442276       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928079442604       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928079442958       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928079443310       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928079443651       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928079443790       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928079443841       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928079444158       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928079444177       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928079444167       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928079444103       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+01 is 3.826548e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.222601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7346e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.079825e-01 3 1  ON 0
ci_0002                 6.933158e-01 3 1  ON 1
ci_0003                -3.121974e-02 3 1  ON 2
ci_0004                -3.035711e-02 3 1  ON 3
ci_0005                -3.057089e-02 3 1  ON 4
ci_0006                -3.070832e-02 3 1  ON 5
ci_0007                -1.389215e-02 3 1  ON 6
ci_0008                -1.362367e-02 3 1  ON 7
ci_0009                -1.887603e-02 3 1  ON 8
ci_0010                -1.815494e-02 3 1  ON 9
ci_0011                -1.478146e-02 3 1  ON 10
ci_0012                -1.470552e-02 3 1  ON 11
ci_0013                 1.533932e-02 3 1  ON 12
ci_0014                 1.479378e-02 3 1  ON 13
ci_0015                 1.591378e-02 3 1  ON 14
ci_0016                 1.552120e-02 3 1  ON 15
ci_0017                 1.342348e-02 3 1  ON 16
ci_0018                 1.316373e-02 3 1  ON 17
ci_0019                 1.301487e-02 3 1  ON 18
ci_0020                 1.259872e-02 3 1  ON 19
ci_0021                 7.712178e-03 3 1  ON 20
ci_0022                 8.369552e-03 3 1  ON 21
ci_0023                -1.188040e-02 3 1  ON 22
ci_0024                -1.138159e-02 3 1  ON 23
ci_0025                -2.047288e-03 3 1  ON 24
ci_0026                -2.789334e-03 3 1  ON 25
ci_0027                -1.200332e-02 3 1  ON 26
ci_0028                -1.159639e-02 3 1  ON 27
ci_0029                -1.052012e-02 3 1  ON 28
ci_0030                -1.046700e-02 3 1  ON 29
ci_0031                 1.356730e-02 3 1  ON 30
ci_0032                 1.227252e-02 3 1  ON 31
ci_0033                 7.996682e-03 3 1  ON 32
ci_0034                 8.500468e-03 3 1  ON 33
ci_0035                 4.988913e-03 3 1  ON 34
ci_0036                 5.105720e-03 3 1  ON 35
ci_0037                -1.125930e-02 3 1  ON 36
ci_0038                -1.153387e-02 3 1  ON 37
ci_0039                -4.038806e-03 3 1  ON 38
ci_0040                -4.031624e-03 3 1  ON 39
ci_0041                 8.950838e-03 3 1  ON 40
ci_0042                 8.745408e-03 3 1  ON 41
ci_0043                -1.252923e-02 3 1  ON 42
ci_0044                -1.317029e-02 3 1  ON 43
ci_0045                 1.066631e-02 3 1  ON 44
ci_0046                 1.018177e-02 3 1  ON 45
ci_0047                -3.629057e-03 3 1  ON 46
ci_0048                -3.413821e-03 3 1  ON 47
ci_0049                -2.520570e-03 3 1  ON 48
ci_0050                -2.773505e-03 3 1  ON 49
ci_0051                -1.756711e-03 3 1  ON 50
ci_0052                -2.064867e-03 3 1  ON 51
ci_0053                -3.965519e-03 3 1  ON 52
ci_0054                -3.318554e-03 3 1  ON 53
ci_0055                 2.826171e-03 3 1  ON 54
ci_0056                 2.259475e-03 3 1  ON 55
ci_0057                 2.243680e-03 3 1  ON 56
ci_0058                 3.160059e-03 3 1  ON 57
ci_0059                -3.376350e-03 3 1  ON 58
ci_0060                -3.198281e-03 3 1  ON 59
ci_0061                -3.951260e-03 3 1  ON 60
ci_0062                -4.024536e-03 3 1  ON 61
ci_0063                -9.952406e-03 3 1  ON 62
ci_0064                -9.490068e-03 3 1  ON 63
ci_0065                -6.361014e-03 3 1  ON 64
ci_0066                -6.200187e-03 3 1  ON 65
ci_0067                -3.653747e-03 3 1  ON 66
ci_0068                -3.426189e-03 3 1  ON 67
ci_0069                 3.751083e-03 3 1  ON 68
ci_0070                 3.412761e-03 3 1  ON 69
ci_0071                 2.914200e-03 3 1  ON 70
ci_0072                 3.675628e-03 3 1  ON 71
ci_0073                 3.664957e-03 3 1  ON 72
ci_0074                 3.592526e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.8539
    reference variance = 0.171173
====================================================
  Execution time = 1.4483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9637e-01
  Total weights = 1.9507e+06
  Execution time = 1.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286208780772
                                         uncertainty =       0.002545008028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286208780772
                                         uncertainty =       0.002545008028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378275040
  error estimate for blocks of size 2^( 2) =       0.000395041302
  error estimate for blocks of size 2^( 3) =       0.000412203829
  error estimate for blocks of size 2^( 4) =       0.000427319633
  error estimate for blocks of size 2^( 5) =       0.000438595377
  error estimate for blocks of size 2^( 6) =       0.000446352723
  error estimate for blocks of size 2^( 7) =       0.000448903108

      target function =      -0.918447359622
              le_mean =     -16.898472410667
             les_mean =     285.854718932934
             stat err =       0.000440292710
             autocorr =       1.354776389237
   target nu stat err =       0.000440292710
   target dn stat err =       0.003289776416
      target stat err =       0.005161233006
              std dev =       0.534961691449
             le_variance =       0.286184011318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286206462715
                                         uncertainty =       0.002547439242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286206462715
                                         uncertainty =       0.002547439242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378273496
  error estimate for blocks of size 2^( 2) =       0.000395039401
  error estimate for blocks of size 2^( 3) =       0.000412202002
  error estimate for blocks of size 2^( 4) =       0.000427317458
  error estimate for blocks of size 2^( 5) =       0.000438592754
  error estimate for blocks of size 2^( 6) =       0.000446350282
  error estimate for blocks of size 2^( 7) =       0.000448900244

      target function =      -0.907422662844
              le_mean =     -16.898473081956
             les_mean =     285.861861685707
             stat err =       0.000440290184
             autocorr =       1.354771901933
   target nu stat err =       0.000440290184
   target dn stat err =       0.007180871850
      target stat err =       0.010908145744
              std dev =       0.534959508430
             le_variance =       0.286181675660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286207563815
                                         uncertainty =       0.002546240176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286207563815
                                         uncertainty =       0.002546240176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378274230
  error estimate for blocks of size 2^( 2) =       0.000395040323
  error estimate for blocks of size 2^( 3) =       0.000412202787
  error estimate for blocks of size 2^( 4) =       0.000427318505
  error estimate for blocks of size 2^( 5) =       0.000438594173
  error estimate for blocks of size 2^( 6) =       0.000446351589
  error estimate for blocks of size 2^( 7) =       0.000448901576

      target function =      -0.918345938956
              le_mean =     -16.898472795825
             les_mean =     285.854797251100
             stat err =       0.000440291461
             autocorr =       1.354774500525
   target nu stat err =       0.000440291461
   target dn stat err =       0.003293141343
      target stat err =       0.005165276967
              std dev =       0.534960545839
             le_variance =       0.286182785604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286208623508
                                         uncertainty =       0.002545162449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286208623508
                                         uncertainty =       0.002545162449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378274935
  error estimate for blocks of size 2^( 2) =       0.000395041177
  error estimate for blocks of size 2^( 3) =       0.000412203696
  error estimate for blocks of size 2^( 4) =       0.000427319489
  error estimate for blocks of size 2^( 5) =       0.000438595223
  error estimate for blocks of size 2^( 6) =       0.000446352577
  error estimate for blocks of size 2^( 7) =       0.000448902913

      target function =      -0.918442689889
              le_mean =     -16.898472457789
             les_mean =     285.854723529404
             stat err =       0.000440292550
             autocorr =       1.354776154606
   target nu stat err =       0.000440292550
   target dn stat err =       0.003290143959
      target stat err =       0.005161746144
              std dev =       0.534961543440
             le_variance =       0.286183852960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918447359622        initial  <--
     3.3881e+00     3.3881e+01             6.0587e-05        -0.907422662844
     1.3553e+01     1.3553e+02             1.5274e-05        -0.918345938956
     5.4210e+01     5.4210e+02             3.8265e-06        -0.918442689889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0116
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.079775e-01 3 1  ON 0
ci_0002                 6.933198e-01 3 1  ON 1
ci_0003                -3.122663e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057548e-02 3 1  ON 4
ci_0006                -3.070231e-02 3 1  ON 5
ci_0007                -1.389302e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887631e-02 3 1  ON 8
ci_0010                -1.816177e-02 3 1  ON 9
ci_0011                -1.478291e-02 3 1  ON 10
ci_0012                -1.470813e-02 3 1  ON 11
ci_0013                 1.533568e-02 3 1  ON 12
ci_0014                 1.479156e-02 3 1  ON 13
ci_0015                 1.591849e-02 3 1  ON 14
ci_0016                 1.552294e-02 3 1  ON 15
ci_0017                 1.342841e-02 3 1  ON 16
ci_0018                 1.316889e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259834e-02 3 1  ON 19
ci_0021                 7.727452e-03 3 1  ON 20
ci_0022                 8.376547e-03 3 1  ON 21
ci_0023                -1.187675e-02 3 1  ON 22
ci_0024                -1.137881e-02 3 1  ON 23
ci_0025                -2.043351e-03 3 1  ON 24
ci_0026                -2.790300e-03 3 1  ON 25
ci_0027                -1.200418e-02 3 1  ON 26
ci_0028                -1.159475e-02 3 1  ON 27
ci_0029                -1.051562e-02 3 1  ON 28
ci_0030                -1.046522e-02 3 1  ON 29
ci_0031                 1.356768e-02 3 1  ON 30
ci_0032                 1.227247e-02 3 1  ON 31
ci_0033                 7.994048e-03 3 1  ON 32
ci_0034                 8.506845e-03 3 1  ON 33
ci_0035                 4.984860e-03 3 1  ON 34
ci_0036                 5.102828e-03 3 1  ON 35
ci_0037                -1.125841e-02 3 1  ON 36
ci_0038                -1.153375e-02 3 1  ON 37
ci_0039                -4.038210e-03 3 1  ON 38
ci_0040                -4.033503e-03 3 1  ON 39
ci_0041                 8.952270e-03 3 1  ON 40
ci_0042                 8.741161e-03 3 1  ON 41
ci_0043                -1.252850e-02 3 1  ON 42
ci_0044                -1.316093e-02 3 1  ON 43
ci_0045                 1.066904e-02 3 1  ON 44
ci_0046                 1.018350e-02 3 1  ON 45
ci_0047                -3.627542e-03 3 1  ON 46
ci_0048                -3.413573e-03 3 1  ON 47
ci_0049                -2.519585e-03 3 1  ON 48
ci_0050                -2.771294e-03 3 1  ON 49
ci_0051                -1.757367e-03 3 1  ON 50
ci_0052                -2.066475e-03 3 1  ON 51
ci_0053                -3.969105e-03 3 1  ON 52
ci_0054                -3.314302e-03 3 1  ON 53
ci_0055                 2.827804e-03 3 1  ON 54
ci_0056                 2.256064e-03 3 1  ON 55
ci_0057                 2.243886e-03 3 1  ON 56
ci_0058                 3.163514e-03 3 1  ON 57
ci_0059                -3.375242e-03 3 1  ON 58
ci_0060                -3.197060e-03 3 1  ON 59
ci_0061                -3.953849e-03 3 1  ON 60
ci_0062                -4.023539e-03 3 1  ON 61
ci_0063                -9.956988e-03 3 1  ON 62
ci_0064                -9.490688e-03 3 1  ON 63
ci_0065                -6.357324e-03 3 1  ON 64
ci_0066                -6.200429e-03 3 1  ON 65
ci_0067                -3.652613e-03 3 1  ON 66
ci_0068                -3.426057e-03 3 1  ON 67
ci_0069                 3.754897e-03 3 1  ON 68
ci_0070                 3.412115e-03 3 1  ON 69
ci_0071                 2.917322e-03 3 1  ON 70
ci_0072                 3.674143e-03 3 1  ON 71
ci_0073                 3.661194e-03 3 1  ON 72
ci_0074                 3.592591e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.856
    reference variance = 0.509576
====================================================
  Execution time = 1.6455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9342e-01
  Total weights = 1.950957492e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284494348790
                                         uncertainty =       0.002650487292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284494348790
                                         uncertainty =       0.002650487292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377157427
  error estimate for blocks of size 2^( 2) =       0.000394088031
  error estimate for blocks of size 2^( 3) =       0.000411937218
  error estimate for blocks of size 2^( 4) =       0.000426795327
  error estimate for blocks of size 2^( 5) =       0.000437854956
  error estimate for blocks of size 2^( 6) =       0.000447171575
  error estimate for blocks of size 2^( 7) =       0.000448803998

      target function =      -0.923011038969
              le_mean =     -16.898871192560
             les_mean =     285.865270649115
             stat err =       0.000440156464
             autocorr =       1.361974068241
   target nu stat err =       0.000440156464
   target dn stat err =       0.003458256939
      target stat err =       0.005477690396
              std dev =       0.533381148923
             le_variance =       0.284495450027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689887119256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923042397164       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923045748740       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923046122622       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923046208070       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923046256791       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923046283748       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923046286358       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923046290049       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923046294733       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923046293949       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923046295569       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923046295063       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923046295512       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923046297644       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923046298347       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923046298518       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923046298580       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+01 is 9.492449e-06

solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923042397164       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923043236521       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923043330123       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923043351499       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923043363682       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923043370420       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923043371070       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923043371993       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923043373164       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923043372967       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923043373372       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923043373245       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923043373358       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923043373889       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923043374065       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923043374107       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923043374122       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+02 is 2.375169e-06

solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923042397164       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923042607095       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923042630504       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923042635849       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923042638894       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923042640579       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923042640741       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923042640972       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923042641264       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923042641216       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923042641317       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923042641285       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923042641313       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923042641446       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923042641490       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923042641500       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923042641504       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+02 is 5.939210e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.231816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9196e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.079763e-01 3 1  ON 0
ci_0002                 6.933213e-01 3 1  ON 1
ci_0003                -3.122604e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057412e-02 3 1  ON 4
ci_0006                -3.070186e-02 3 1  ON 5
ci_0007                -1.389271e-02 3 1  ON 6
ci_0008                -1.362968e-02 3 1  ON 7
ci_0009                -1.887597e-02 3 1  ON 8
ci_0010                -1.816162e-02 3 1  ON 9
ci_0011                -1.478193e-02 3 1  ON 10
ci_0012                -1.470819e-02 3 1  ON 11
ci_0013                 1.533499e-02 3 1  ON 12
ci_0014                 1.479152e-02 3 1  ON 13
ci_0015                 1.591833e-02 3 1  ON 14
ci_0016                 1.552321e-02 3 1  ON 15
ci_0017                 1.342805e-02 3 1  ON 16
ci_0018                 1.316920e-02 3 1  ON 17
ci_0019                 1.301550e-02 3 1  ON 18
ci_0020                 1.259848e-02 3 1  ON 19
ci_0021                 7.725077e-03 3 1  ON 20
ci_0022                 8.376179e-03 3 1  ON 21
ci_0023                -1.187778e-02 3 1  ON 22
ci_0024                -1.137953e-02 3 1  ON 23
ci_0025                -2.043142e-03 3 1  ON 24
ci_0026                -2.789313e-03 3 1  ON 25
ci_0027                -1.200425e-02 3 1  ON 26
ci_0028                -1.159520e-02 3 1  ON 27
ci_0029                -1.051569e-02 3 1  ON 28
ci_0030                -1.046501e-02 3 1  ON 29
ci_0031                 1.356705e-02 3 1  ON 30
ci_0032                 1.227254e-02 3 1  ON 31
ci_0033                 7.994108e-03 3 1  ON 32
ci_0034                 8.506340e-03 3 1  ON 33
ci_0035                 4.984952e-03 3 1  ON 34
ci_0036                 5.101671e-03 3 1  ON 35
ci_0037                -1.125836e-02 3 1  ON 36
ci_0038                -1.153314e-02 3 1  ON 37
ci_0039                -4.038169e-03 3 1  ON 38
ci_0040                -4.033426e-03 3 1  ON 39
ci_0041                 8.952619e-03 3 1  ON 40
ci_0042                 8.741744e-03 3 1  ON 41
ci_0043                -1.252838e-02 3 1  ON 42
ci_0044                -1.316158e-02 3 1  ON 43
ci_0045                 1.066825e-02 3 1  ON 44
ci_0046                 1.018360e-02 3 1  ON 45
ci_0047                -3.627697e-03 3 1  ON 46
ci_0048                -3.413862e-03 3 1  ON 47
ci_0049                -2.519969e-03 3 1  ON 48
ci_0050                -2.771902e-03 3 1  ON 49
ci_0051                -1.757193e-03 3 1  ON 50
ci_0052                -2.066203e-03 3 1  ON 51
ci_0053                -3.968472e-03 3 1  ON 52
ci_0054                -3.313579e-03 3 1  ON 53
ci_0055                 2.828559e-03 3 1  ON 54
ci_0056                 2.256871e-03 3 1  ON 55
ci_0057                 2.244292e-03 3 1  ON 56
ci_0058                 3.163387e-03 3 1  ON 57
ci_0059                -3.373656e-03 3 1  ON 58
ci_0060                -3.197025e-03 3 1  ON 59
ci_0061                -3.954110e-03 3 1  ON 60
ci_0062                -4.023695e-03 3 1  ON 61
ci_0063                -9.956425e-03 3 1  ON 62
ci_0064                -9.490616e-03 3 1  ON 63
ci_0065                -6.357392e-03 3 1  ON 64
ci_0066                -6.200370e-03 3 1  ON 65
ci_0067                -3.653465e-03 3 1  ON 66
ci_0068                -3.425880e-03 3 1  ON 67
ci_0069                 3.754727e-03 3 1  ON 68
ci_0070                 3.411620e-03 3 1  ON 69
ci_0071                 2.917835e-03 3 1  ON 70
ci_0072                 3.673520e-03 3 1  ON 71
ci_0073                 3.659562e-03 3 1  ON 72
ci_0074                 3.592381e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.195268
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9206e-01
  Total weights = 1.9511e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281047355488
                                         uncertainty =       0.001682189846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281047355488
                                         uncertainty =       0.001682189846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374809140
  error estimate for blocks of size 2^( 2) =       0.000391975623
  error estimate for blocks of size 2^( 3) =       0.000409406593
  error estimate for blocks of size 2^( 4) =       0.000424507510
  error estimate for blocks of size 2^( 5) =       0.000436297333
  error estimate for blocks of size 2^( 6) =       0.000442511833
  error estimate for blocks of size 2^( 7) =       0.000447099697

      target function =      -0.925174265457
              le_mean =     -16.899275790849
             les_mean =     285.877580369405
             stat err =       0.000437604093
             autocorr =       1.363146098385
   target nu stat err =       0.000437604093
   target dn stat err =       0.002632743372
      target stat err =       0.004219951665
              std dev =       0.530060169345
             le_variance =       0.280963783126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281046870421
                                         uncertainty =       0.001682248767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281046870421
                                         uncertainty =       0.001682248767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374808820
  error estimate for blocks of size 2^( 2) =       0.000391975420
  error estimate for blocks of size 2^( 3) =       0.000409406427
  error estimate for blocks of size 2^( 4) =       0.000424507216
  error estimate for blocks of size 2^( 5) =       0.000436297187
  error estimate for blocks of size 2^( 6) =       0.000442511848
  error estimate for blocks of size 2^( 7) =       0.000447099447

      target function =      -0.925162181484
              le_mean =     -16.899275833496
             les_mean =     285.877589466511
             stat err =       0.000437603924
             autocorr =       1.363147376654
   target nu stat err =       0.000437603924
   target dn stat err =       0.002633250020
      target stat err =       0.004220630145
              std dev =       0.530059716128
             le_variance =       0.280963302662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281047111034
                                         uncertainty =       0.001682219327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281047111034
                                         uncertainty =       0.001682219327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374808979
  error estimate for blocks of size 2^( 2) =       0.000391975520
  error estimate for blocks of size 2^( 3) =       0.000409406509
  error estimate for blocks of size 2^( 4) =       0.000424507361
  error estimate for blocks of size 2^( 5) =       0.000436297259
  error estimate for blocks of size 2^( 6) =       0.000442511839
  error estimate for blocks of size 2^( 7) =       0.000447099571

      target function =      -0.925169481188
              le_mean =     -16.899275812007
             les_mean =     285.877584115095
             stat err =       0.000437604008
             autocorr =       1.363146739559
   target nu stat err =       0.000437604008
   target dn stat err =       0.002632993944
      target stat err =       0.004220297930
              std dev =       0.530059940929
             le_variance =       0.280963540977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281047324742
                                         uncertainty =       0.001682193531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281047324742
                                         uncertainty =       0.001682193531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374809120
  error estimate for blocks of size 2^( 2) =       0.000391975610
  error estimate for blocks of size 2^( 3) =       0.000409406583
  error estimate for blocks of size 2^( 4) =       0.000424507491
  error estimate for blocks of size 2^( 5) =       0.000436297324
  error estimate for blocks of size 2^( 6) =       0.000442511833
  error estimate for blocks of size 2^( 7) =       0.000447099681

      target function =      -0.925173752255
              le_mean =     -16.899275793472
             les_mean =     285.877580783097
             stat err =       0.000437604082
             autocorr =       1.363146178688
   target nu stat err =       0.000437604082
   target dn stat err =       0.002632774502
      target stat err =       0.004219995412
              std dev =       0.530060140614
             le_variance =       0.280963752668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925174265457        initial  <--
     3.3881e+01     3.3881e+02             9.4924e-06        -0.925162181484
     1.3553e+02     1.3553e+03             2.3752e-06        -0.925169481188
     5.4210e+02     5.4210e+03             5.9392e-07        -0.925173752255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8825
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.079775e-01 3 1  ON 0
ci_0002                 6.933198e-01 3 1  ON 1
ci_0003                -3.122663e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057548e-02 3 1  ON 4
ci_0006                -3.070231e-02 3 1  ON 5
ci_0007                -1.389302e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887631e-02 3 1  ON 8
ci_0010                -1.816177e-02 3 1  ON 9
ci_0011                -1.478291e-02 3 1  ON 10
ci_0012                -1.470813e-02 3 1  ON 11
ci_0013                 1.533568e-02 3 1  ON 12
ci_0014                 1.479156e-02 3 1  ON 13
ci_0015                 1.591849e-02 3 1  ON 14
ci_0016                 1.552294e-02 3 1  ON 15
ci_0017                 1.342841e-02 3 1  ON 16
ci_0018                 1.316889e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259834e-02 3 1  ON 19
ci_0021                 7.727452e-03 3 1  ON 20
ci_0022                 8.376547e-03 3 1  ON 21
ci_0023                -1.187675e-02 3 1  ON 22
ci_0024                -1.137881e-02 3 1  ON 23
ci_0025                -2.043351e-03 3 1  ON 24
ci_0026                -2.790300e-03 3 1  ON 25
ci_0027                -1.200418e-02 3 1  ON 26
ci_0028                -1.159475e-02 3 1  ON 27
ci_0029                -1.051562e-02 3 1  ON 28
ci_0030                -1.046522e-02 3 1  ON 29
ci_0031                 1.356768e-02 3 1  ON 30
ci_0032                 1.227247e-02 3 1  ON 31
ci_0033                 7.994048e-03 3 1  ON 32
ci_0034                 8.506845e-03 3 1  ON 33
ci_0035                 4.984860e-03 3 1  ON 34
ci_0036                 5.102828e-03 3 1  ON 35
ci_0037                -1.125841e-02 3 1  ON 36
ci_0038                -1.153375e-02 3 1  ON 37
ci_0039                -4.038210e-03 3 1  ON 38
ci_0040                -4.033503e-03 3 1  ON 39
ci_0041                 8.952270e-03 3 1  ON 40
ci_0042                 8.741161e-03 3 1  ON 41
ci_0043                -1.252850e-02 3 1  ON 42
ci_0044                -1.316093e-02 3 1  ON 43
ci_0045                 1.066904e-02 3 1  ON 44
ci_0046                 1.018350e-02 3 1  ON 45
ci_0047                -3.627542e-03 3 1  ON 46
ci_0048                -3.413573e-03 3 1  ON 47
ci_0049                -2.519585e-03 3 1  ON 48
ci_0050                -2.771294e-03 3 1  ON 49
ci_0051                -1.757367e-03 3 1  ON 50
ci_0052                -2.066475e-03 3 1  ON 51
ci_0053                -3.969105e-03 3 1  ON 52
ci_0054                -3.314302e-03 3 1  ON 53
ci_0055                 2.827804e-03 3 1  ON 54
ci_0056                 2.256064e-03 3 1  ON 55
ci_0057                 2.243886e-03 3 1  ON 56
ci_0058                 3.163514e-03 3 1  ON 57
ci_0059                -3.375242e-03 3 1  ON 58
ci_0060                -3.197060e-03 3 1  ON 59
ci_0061                -3.953849e-03 3 1  ON 60
ci_0062                -4.023539e-03 3 1  ON 61
ci_0063                -9.956988e-03 3 1  ON 62
ci_0064                -9.490688e-03 3 1  ON 63
ci_0065                -6.357324e-03 3 1  ON 64
ci_0066                -6.200429e-03 3 1  ON 65
ci_0067                -3.652613e-03 3 1  ON 66
ci_0068                -3.426057e-03 3 1  ON 67
ci_0069                 3.754897e-03 3 1  ON 68
ci_0070                 3.412115e-03 3 1  ON 69
ci_0071                 2.917322e-03 3 1  ON 70
ci_0072                 3.674143e-03 3 1  ON 71
ci_0073                 3.661194e-03 3 1  ON 72
ci_0074                 3.592591e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.9025
    reference variance = 0.183461
====================================================
  Execution time = 1.4977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9270e-01
  Total weights = 1.951157380e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282188431019
                                         uncertainty =       0.002001921205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282188431019
                                         uncertainty =       0.002001921205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375624560
  error estimate for blocks of size 2^( 2) =       0.000392792303
  error estimate for blocks of size 2^( 3) =       0.000410171015
  error estimate for blocks of size 2^( 4) =       0.000425217954
  error estimate for blocks of size 2^( 5) =       0.000436630453
  error estimate for blocks of size 2^( 6) =       0.000443856663
  error estimate for blocks of size 2^( 7) =       0.000446577697

      target function =      -0.924155074148
              le_mean =     -16.899105255418
             les_mean =     285.872462569103
             stat err =       0.000438070692
             autocorr =       1.360130052494
   target nu stat err =       0.000438070692
   target dn stat err =       0.002656119897
      target stat err =       0.004245832548
              std dev =       0.531213346744
             le_variance =       0.282187619759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689910525542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+02, overlap shift 3.3881e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924173237393       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924173428005       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924173447168       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924173453437       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924173456188       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924173457388       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924173457562       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924173457506       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924173457265       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924173457352       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924173457090       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924173457175       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924173457333       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924173457279       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924173457307       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924173457308       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924173457321       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+02 is 6.759722e-07

solving harmonic davidson linear method for identity shift 1.3553e+03, overlap shift 1.3553e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924173237393       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924173285054       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924173289846       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924173291411       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924173292103       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924173292401       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924173292445       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924173292433       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924173292370       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924173292393       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924173292325       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924173292349       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924173292387       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924173292374       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924173292380       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924173292381       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924173292383       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+03 is 1.690228e-07

solving harmonic davidson linear method for identity shift 5.4210e+03, overlap shift 5.4210e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924173237393       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924173249309       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924173250506       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924173250898       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924173251061       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924173251152       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924173251155       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924173251156       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924173251141       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924173251143       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924173251124       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924173251125       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924173251141       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924173251117       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924173251140       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924173251141       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924173251137       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.4210e+03 is 4.225757e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.241045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7596e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.079776e-01 3 1  ON 0
ci_0002                 6.933197e-01 3 1  ON 1
ci_0003                -3.122658e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057552e-02 3 1  ON 4
ci_0006                -3.070232e-02 3 1  ON 5
ci_0007                -1.389302e-02 3 1  ON 6
ci_0008                -1.362992e-02 3 1  ON 7
ci_0009                -1.887628e-02 3 1  ON 8
ci_0010                -1.816176e-02 3 1  ON 9
ci_0011                -1.478287e-02 3 1  ON 10
ci_0012                -1.470811e-02 3 1  ON 11
ci_0013                 1.533566e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591850e-02 3 1  ON 14
ci_0016                 1.552295e-02 3 1  ON 15
ci_0017                 1.342845e-02 3 1  ON 16
ci_0018                 1.316889e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259836e-02 3 1  ON 19
ci_0021                 7.727380e-03 3 1  ON 20
ci_0022                 8.376452e-03 3 1  ON 21
ci_0023                -1.187676e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043386e-03 3 1  ON 24
ci_0026                -2.790213e-03 3 1  ON 25
ci_0027                -1.200423e-02 3 1  ON 26
ci_0028                -1.159472e-02 3 1  ON 27
ci_0029                -1.051563e-02 3 1  ON 28
ci_0030                -1.046523e-02 3 1  ON 29
ci_0031                 1.356765e-02 3 1  ON 30
ci_0032                 1.227244e-02 3 1  ON 31
ci_0033                 7.994037e-03 3 1  ON 32
ci_0034                 8.506807e-03 3 1  ON 33
ci_0035                 4.984912e-03 3 1  ON 34
ci_0036                 5.102751e-03 3 1  ON 35
ci_0037                -1.125842e-02 3 1  ON 36
ci_0038                -1.153369e-02 3 1  ON 37
ci_0039                -4.038194e-03 3 1  ON 38
ci_0040                -4.033491e-03 3 1  ON 39
ci_0041                 8.952300e-03 3 1  ON 40
ci_0042                 8.741137e-03 3 1  ON 41
ci_0043                -1.252856e-02 3 1  ON 42
ci_0044                -1.316101e-02 3 1  ON 43
ci_0045                 1.066900e-02 3 1  ON 44
ci_0046                 1.018353e-02 3 1  ON 45
ci_0047                -3.627552e-03 3 1  ON 46
ci_0048                -3.413558e-03 3 1  ON 47
ci_0049                -2.519573e-03 3 1  ON 48
ci_0050                -2.771125e-03 3 1  ON 49
ci_0051                -1.757428e-03 3 1  ON 50
ci_0052                -2.066475e-03 3 1  ON 51
ci_0053                -3.969054e-03 3 1  ON 52
ci_0054                -3.314316e-03 3 1  ON 53
ci_0055                 2.827820e-03 3 1  ON 54
ci_0056                 2.256133e-03 3 1  ON 55
ci_0057                 2.243841e-03 3 1  ON 56
ci_0058                 3.163506e-03 3 1  ON 57
ci_0059                -3.375226e-03 3 1  ON 58
ci_0060                -3.197024e-03 3 1  ON 59
ci_0061                -3.953798e-03 3 1  ON 60
ci_0062                -4.023496e-03 3 1  ON 61
ci_0063                -9.956977e-03 3 1  ON 62
ci_0064                -9.490713e-03 3 1  ON 63
ci_0065                -6.357357e-03 3 1  ON 64
ci_0066                -6.200376e-03 3 1  ON 65
ci_0067                -3.652610e-03 3 1  ON 66
ci_0068                -3.426134e-03 3 1  ON 67
ci_0069                 3.754811e-03 3 1  ON 68
ci_0070                 3.412124e-03 3 1  ON 69
ci_0071                 2.917443e-03 3 1  ON 70
ci_0072                 3.674108e-03 3 1  ON 71
ci_0073                 3.661224e-03 3 1  ON 72
ci_0074                 3.592597e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8855
    reference variance = 0.247367
====================================================
  Execution time = 1.4232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8984e-01
  Total weights = 1.9507e+06
  Execution time = 1.8790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836647806
                                         uncertainty =       0.001511447447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836647806
                                         uncertainty =       0.001511447447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374046967
  error estimate for blocks of size 2^( 2) =       0.000391099903
  error estimate for blocks of size 2^( 3) =       0.000407918144
  error estimate for blocks of size 2^( 4) =       0.000423002221
  error estimate for blocks of size 2^( 5) =       0.000433636158
  error estimate for blocks of size 2^( 6) =       0.000439293021
  error estimate for blocks of size 2^( 7) =       0.000445262080

      target function =      -0.928689365147
              le_mean =     -16.898482097363
             les_mean =     285.848532715325
             stat err =       0.000435298370
             autocorr =       1.354321603419
   target nu stat err =       0.000435298370
   target dn stat err =       0.002088225300
      target stat err =       0.003397094238
              std dev =       0.528982294344
             le_variance =       0.279822267729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836597829
                                         uncertainty =       0.001511445402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836597829
                                         uncertainty =       0.001511445402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374046934
  error estimate for blocks of size 2^( 2) =       0.000391099871
  error estimate for blocks of size 2^( 3) =       0.000407918119
  error estimate for blocks of size 2^( 4) =       0.000423002201
  error estimate for blocks of size 2^( 5) =       0.000433636135
  error estimate for blocks of size 2^( 6) =       0.000439293002
  error estimate for blocks of size 2^( 7) =       0.000445262056

      target function =      -0.928689453896
              le_mean =     -16.898482108398
             les_mean =     285.848533031990
             stat err =       0.000435298349
             autocorr =       1.354321711938
   target nu stat err =       0.000435298349
   target dn stat err =       0.002088291273
      target stat err =       0.003397197111
              std dev =       0.528982246839
             le_variance =       0.279822217471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836622803
                                         uncertainty =       0.001511446425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836622803
                                         uncertainty =       0.001511446425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374046951
  error estimate for blocks of size 2^( 2) =       0.000391099887
  error estimate for blocks of size 2^( 3) =       0.000407918131
  error estimate for blocks of size 2^( 4) =       0.000423002211
  error estimate for blocks of size 2^( 5) =       0.000433636146
  error estimate for blocks of size 2^( 6) =       0.000439293012
  error estimate for blocks of size 2^( 7) =       0.000445262068

      target function =      -0.928689410297
              le_mean =     -16.898482102880
             les_mean =     285.848532873156
             stat err =       0.000435298359
             autocorr =       1.354321657711
   target nu stat err =       0.000435298359
   target dn stat err =       0.002088258268
      target stat err =       0.003397145652
              std dev =       0.528982270577
             le_variance =       0.279822242585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836644680
                                         uncertainty =       0.001511447319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279836644680
                                         uncertainty =       0.001511447319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374046965
  error estimate for blocks of size 2^( 2) =       0.000391099901
  error estimate for blocks of size 2^( 3) =       0.000407918142
  error estimate for blocks of size 2^( 4) =       0.000423002220
  error estimate for blocks of size 2^( 5) =       0.000433636157
  error estimate for blocks of size 2^( 6) =       0.000439293020
  error estimate for blocks of size 2^( 7) =       0.000445262079

      target function =      -0.928689370875
              le_mean =     -16.898482098053
             les_mean =     285.848532734998
             stat err =       0.000435298369
             autocorr =       1.354321610203
   target nu stat err =       0.000435298369
   target dn stat err =       0.002088229419
      target stat err =       0.003397100662
              std dev =       0.528982291372
             le_variance =       0.279822264585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928689365147        initial
     3.3881e+02     3.3881e+03             6.7597e-07        -0.928689453896  <--
     1.3553e+03     1.3553e+04             1.6902e-07        -0.928689410297
     5.4210e+03     5.4210e+04             4.2258e-08        -0.928689370875

*****************************************************************************
Applying the update for shift_i =   3.3881e+02     and shift_s =   3.3881e+03
*****************************************************************************

  Execution time = 2.3761e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122641e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057564e-02 3 1  ON 4
ci_0006                -3.070234e-02 3 1  ON 5
ci_0007                -1.389304e-02 3 1  ON 6
ci_0008                -1.362994e-02 3 1  ON 7
ci_0009                -1.887622e-02 3 1  ON 8
ci_0010                -1.816172e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470805e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591854e-02 3 1  ON 14
ci_0016                 1.552298e-02 3 1  ON 15
ci_0017                 1.342856e-02 3 1  ON 16
ci_0018                 1.316888e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259841e-02 3 1  ON 19
ci_0021                 7.727162e-03 3 1  ON 20
ci_0022                 8.376168e-03 3 1  ON 21
ci_0023                -1.187678e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043493e-03 3 1  ON 24
ci_0026                -2.789952e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051566e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356758e-02 3 1  ON 30
ci_0032                 1.227236e-02 3 1  ON 31
ci_0033                 7.994003e-03 3 1  ON 32
ci_0034                 8.506692e-03 3 1  ON 33
ci_0035                 4.985067e-03 3 1  ON 34
ci_0036                 5.102519e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153351e-02 3 1  ON 37
ci_0039                -4.038146e-03 3 1  ON 38
ci_0040                -4.033455e-03 3 1  ON 39
ci_0041                 8.952388e-03 3 1  ON 40
ci_0042                 8.741066e-03 3 1  ON 41
ci_0043                -1.252876e-02 3 1  ON 42
ci_0044                -1.316123e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018363e-02 3 1  ON 45
ci_0047                -3.627581e-03 3 1  ON 46
ci_0048                -3.413512e-03 3 1  ON 47
ci_0049                -2.519537e-03 3 1  ON 48
ci_0050                -2.770618e-03 3 1  ON 49
ci_0051                -1.757611e-03 3 1  ON 50
ci_0052                -2.066477e-03 3 1  ON 51
ci_0053                -3.968900e-03 3 1  ON 52
ci_0054                -3.314359e-03 3 1  ON 53
ci_0055                 2.827868e-03 3 1  ON 54
ci_0056                 2.256340e-03 3 1  ON 55
ci_0057                 2.243705e-03 3 1  ON 56
ci_0058                 3.163480e-03 3 1  ON 57
ci_0059                -3.375181e-03 3 1  ON 58
ci_0060                -3.196913e-03 3 1  ON 59
ci_0061                -3.953643e-03 3 1  ON 60
ci_0062                -4.023369e-03 3 1  ON 61
ci_0063                -9.956943e-03 3 1  ON 62
ci_0064                -9.490788e-03 3 1  ON 63
ci_0065                -6.357456e-03 3 1  ON 64
ci_0066                -6.200217e-03 3 1  ON 65
ci_0067                -3.652598e-03 3 1  ON 66
ci_0068                -3.426367e-03 3 1  ON 67
ci_0069                 3.754551e-03 3 1  ON 68
ci_0070                 3.412153e-03 3 1  ON 69
ci_0071                 2.917806e-03 3 1  ON 70
ci_0072                 3.674004e-03 3 1  ON 71
ci_0073                 3.661315e-03 3 1  ON 72
ci_0074                 3.592613e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.233668
====================================================
  Execution time = 1.4847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9304e-01
  Total weights = 1.951098358e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282689961808
                                         uncertainty =       0.001704141432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282689961808
                                         uncertainty =       0.001704141432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375951859
  error estimate for blocks of size 2^( 2) =       0.000392722175
  error estimate for blocks of size 2^( 3) =       0.000409159486
  error estimate for blocks of size 2^( 4) =       0.000424308770
  error estimate for blocks of size 2^( 5) =       0.000434275029
  error estimate for blocks of size 2^( 6) =       0.000441458490
  error estimate for blocks of size 2^( 7) =       0.000444911231

      target function =      -0.923628753941
              le_mean =     -16.899099756642
             les_mean =     285.872613528488
             stat err =       0.000436238380
             autocorr =       1.346428420611
   target nu stat err =       0.000436238380
   target dn stat err =       0.002401029506
      target stat err =       0.003846340726
              std dev =       0.531676217900
             le_variance =       0.282679600680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689909975664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923643489509       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923644023600       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923644121017       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923644167614       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923644198701       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923644203451       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923644204529       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923644205045       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923644207479       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923644211202       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923644212867       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923644212980       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923644213549       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923644214350       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923644214462       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923644214500       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923644214597       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923644214613       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+01 is 4.337213e-06

solving harmonic davidson linear method for identity shift 3.3881e+02, overlap shift 3.3881e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923643489509       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923643623124       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923643647493       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923643659145       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923643666917       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923643668105       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923643668374       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923643668503       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923643669112       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923643670042       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923643670459       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923643670487       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923643670629       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923643670829       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923643670856       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923643670866       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923643670891       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923643670894       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+02 is 1.084718e-06

solving harmonic davidson linear method for identity shift 1.3553e+03, overlap shift 1.3553e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923643489509       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923643522918       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923643529012       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923643531925       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923643533868       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923643534165       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923643534232       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923643534264       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923643534416       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923643534651       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923643534753       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923643534757       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923643534795       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923643534845       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923643534851       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923643534857       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923643534861       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923643534863       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+03 is 2.712054e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.251281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7448e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.079769e-01 3 1  ON 0
ci_0002                 6.933205e-01 3 1  ON 1
ci_0003                -3.122651e-02 3 1  ON 2
ci_0004                -3.036405e-02 3 1  ON 3
ci_0005                -3.057581e-02 3 1  ON 4
ci_0006                -3.070238e-02 3 1  ON 5
ci_0007                -1.389299e-02 3 1  ON 6
ci_0008                -1.363010e-02 3 1  ON 7
ci_0009                -1.887613e-02 3 1  ON 8
ci_0010                -1.816179e-02 3 1  ON 9
ci_0011                -1.478263e-02 3 1  ON 10
ci_0012                -1.470795e-02 3 1  ON 11
ci_0013                 1.533545e-02 3 1  ON 12
ci_0014                 1.479162e-02 3 1  ON 13
ci_0015                 1.591848e-02 3 1  ON 14
ci_0016                 1.552288e-02 3 1  ON 15
ci_0017                 1.342843e-02 3 1  ON 16
ci_0018                 1.316905e-02 3 1  ON 17
ci_0019                 1.301470e-02 3 1  ON 18
ci_0020                 1.259845e-02 3 1  ON 19
ci_0021                 7.726077e-03 3 1  ON 20
ci_0022                 8.375789e-03 3 1  ON 21
ci_0023                -1.187688e-02 3 1  ON 22
ci_0024                -1.137871e-02 3 1  ON 23
ci_0025                -2.043540e-03 3 1  ON 24
ci_0026                -2.789901e-03 3 1  ON 25
ci_0027                -1.200427e-02 3 1  ON 26
ci_0028                -1.159453e-02 3 1  ON 27
ci_0029                -1.051565e-02 3 1  ON 28
ci_0030                -1.046508e-02 3 1  ON 29
ci_0031                 1.356735e-02 3 1  ON 30
ci_0032                 1.227242e-02 3 1  ON 31
ci_0033                 7.994307e-03 3 1  ON 32
ci_0034                 8.507010e-03 3 1  ON 33
ci_0035                 4.984678e-03 3 1  ON 34
ci_0036                 5.102280e-03 3 1  ON 35
ci_0037                -1.125834e-02 3 1  ON 36
ci_0038                -1.153345e-02 3 1  ON 37
ci_0039                -4.038058e-03 3 1  ON 38
ci_0040                -4.033345e-03 3 1  ON 39
ci_0041                 8.952263e-03 3 1  ON 40
ci_0042                 8.741059e-03 3 1  ON 41
ci_0043                -1.252920e-02 3 1  ON 42
ci_0044                -1.316153e-02 3 1  ON 43
ci_0045                 1.066860e-02 3 1  ON 44
ci_0046                 1.018358e-02 3 1  ON 45
ci_0047                -3.627645e-03 3 1  ON 46
ci_0048                -3.413483e-03 3 1  ON 47
ci_0049                -2.519192e-03 3 1  ON 48
ci_0050                -2.770473e-03 3 1  ON 49
ci_0051                -1.757490e-03 3 1  ON 50
ci_0052                -2.066544e-03 3 1  ON 51
ci_0053                -3.968487e-03 3 1  ON 52
ci_0054                -3.314558e-03 3 1  ON 53
ci_0055                 2.827662e-03 3 1  ON 54
ci_0056                 2.256502e-03 3 1  ON 55
ci_0057                 2.243573e-03 3 1  ON 56
ci_0058                 3.163186e-03 3 1  ON 57
ci_0059                -3.375197e-03 3 1  ON 58
ci_0060                -3.196893e-03 3 1  ON 59
ci_0061                -3.953601e-03 3 1  ON 60
ci_0062                -4.023489e-03 3 1  ON 61
ci_0063                -9.956796e-03 3 1  ON 62
ci_0064                -9.490811e-03 3 1  ON 63
ci_0065                -6.357443e-03 3 1  ON 64
ci_0066                -6.200058e-03 3 1  ON 65
ci_0067                -3.652639e-03 3 1  ON 66
ci_0068                -3.426303e-03 3 1  ON 67
ci_0069                 3.754490e-03 3 1  ON 68
ci_0070                 3.412128e-03 3 1  ON 69
ci_0071                 2.918165e-03 3 1  ON 70
ci_0072                 3.674104e-03 3 1  ON 71
ci_0073                 3.660988e-03 3 1  ON 72
ci_0074                 3.592627e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9048
    reference variance = 0.226354
====================================================
  Execution time = 1.4213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9214e-01
  Total weights = 1.9508e+06
  Execution time = 1.8774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203621572
                                         uncertainty =       0.001806195253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203621572
                                         uncertainty =       0.001806195253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376269336
  error estimate for blocks of size 2^( 2) =       0.000393301720
  error estimate for blocks of size 2^( 3) =       0.000410884908
  error estimate for blocks of size 2^( 4) =       0.000425673528
  error estimate for blocks of size 2^( 5) =       0.000436977913
  error estimate for blocks of size 2^( 6) =       0.000443228715
  error estimate for blocks of size 2^( 7) =       0.000446923133

      target function =      -0.925044210318
              le_mean =     -16.898843108032
             les_mean =     285.863039484479
             stat err =       0.000438200822
             autocorr =       1.356278015399
   target nu stat err =       0.000438200822
   target dn stat err =       0.002351229569
      target stat err =       0.003779772679
              std dev =       0.532125198230
             le_variance =       0.283157226591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203123686
                                         uncertainty =       0.001806183666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203123686
                                         uncertainty =       0.001806183666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376269006
  error estimate for blocks of size 2^( 2) =       0.000393301458
  error estimate for blocks of size 2^( 3) =       0.000410884683
  error estimate for blocks of size 2^( 4) =       0.000425673365
  error estimate for blocks of size 2^( 5) =       0.000436977727
  error estimate for blocks of size 2^( 6) =       0.000443228508
  error estimate for blocks of size 2^( 7) =       0.000446923001

      target function =      -0.925036691798
              le_mean =     -16.898843092370
             les_mean =     285.863043726276
             stat err =       0.000438200650
             autocorr =       1.356279330107
   target nu stat err =       0.000438200650
   target dn stat err =       0.002351213280
      target stat err =       0.003779687104
              std dev =       0.532124731548
             le_variance =       0.283156729925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203372323
                                         uncertainty =       0.001806189444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203372323
                                         uncertainty =       0.001806189444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376269171
  error estimate for blocks of size 2^( 2) =       0.000393301589
  error estimate for blocks of size 2^( 3) =       0.000410884795
  error estimate for blocks of size 2^( 4) =       0.000425673446
  error estimate for blocks of size 2^( 5) =       0.000436977820
  error estimate for blocks of size 2^( 6) =       0.000443228612
  error estimate for blocks of size 2^( 7) =       0.000446923067

      target function =      -0.925040587245
              le_mean =     -16.898843100173
             les_mean =     285.863041518028
             stat err =       0.000438200736
             autocorr =       1.356278673535
   target nu stat err =       0.000438200736
   target dn stat err =       0.002351219692
      target stat err =       0.003779728305
              std dev =       0.532124964602
             le_variance =       0.283156977952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203590391
                                         uncertainty =       0.001806194525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283203590391
                                         uncertainty =       0.001806194525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376269315
  error estimate for blocks of size 2^( 2) =       0.000393301704
  error estimate for blocks of size 2^( 3) =       0.000410884894
  error estimate for blocks of size 2^( 4) =       0.000425673517
  error estimate for blocks of size 2^( 5) =       0.000436977902
  error estimate for blocks of size 2^( 6) =       0.000443228702
  error estimate for blocks of size 2^( 7) =       0.000446923125

      target function =      -0.925043771871
              le_mean =     -16.898843107047
             les_mean =     285.863039729426
             stat err =       0.000438200812
             autocorr =       1.356278097710
   target nu stat err =       0.000438200812
   target dn stat err =       0.002351228156
      target stat err =       0.003779766973
              std dev =       0.532125169003
             le_variance =       0.283157195486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925044210318        initial  <--
     8.4703e+01     8.4703e+02             4.3372e-06        -0.925036691798
     3.3881e+02     3.3881e+03             1.0847e-06        -0.925040587245
     1.3553e+03     1.3553e+04             2.7121e-07        -0.925043771871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7218
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122641e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057564e-02 3 1  ON 4
ci_0006                -3.070234e-02 3 1  ON 5
ci_0007                -1.389304e-02 3 1  ON 6
ci_0008                -1.362994e-02 3 1  ON 7
ci_0009                -1.887622e-02 3 1  ON 8
ci_0010                -1.816172e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470805e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591854e-02 3 1  ON 14
ci_0016                 1.552298e-02 3 1  ON 15
ci_0017                 1.342856e-02 3 1  ON 16
ci_0018                 1.316888e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259841e-02 3 1  ON 19
ci_0021                 7.727162e-03 3 1  ON 20
ci_0022                 8.376168e-03 3 1  ON 21
ci_0023                -1.187678e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043493e-03 3 1  ON 24
ci_0026                -2.789952e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051566e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356758e-02 3 1  ON 30
ci_0032                 1.227236e-02 3 1  ON 31
ci_0033                 7.994003e-03 3 1  ON 32
ci_0034                 8.506692e-03 3 1  ON 33
ci_0035                 4.985067e-03 3 1  ON 34
ci_0036                 5.102519e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153351e-02 3 1  ON 37
ci_0039                -4.038146e-03 3 1  ON 38
ci_0040                -4.033455e-03 3 1  ON 39
ci_0041                 8.952388e-03 3 1  ON 40
ci_0042                 8.741066e-03 3 1  ON 41
ci_0043                -1.252876e-02 3 1  ON 42
ci_0044                -1.316123e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018363e-02 3 1  ON 45
ci_0047                -3.627581e-03 3 1  ON 46
ci_0048                -3.413512e-03 3 1  ON 47
ci_0049                -2.519537e-03 3 1  ON 48
ci_0050                -2.770618e-03 3 1  ON 49
ci_0051                -1.757611e-03 3 1  ON 50
ci_0052                -2.066477e-03 3 1  ON 51
ci_0053                -3.968900e-03 3 1  ON 52
ci_0054                -3.314359e-03 3 1  ON 53
ci_0055                 2.827868e-03 3 1  ON 54
ci_0056                 2.256340e-03 3 1  ON 55
ci_0057                 2.243705e-03 3 1  ON 56
ci_0058                 3.163480e-03 3 1  ON 57
ci_0059                -3.375181e-03 3 1  ON 58
ci_0060                -3.196913e-03 3 1  ON 59
ci_0061                -3.953643e-03 3 1  ON 60
ci_0062                -4.023369e-03 3 1  ON 61
ci_0063                -9.956943e-03 3 1  ON 62
ci_0064                -9.490788e-03 3 1  ON 63
ci_0065                -6.357456e-03 3 1  ON 64
ci_0066                -6.200217e-03 3 1  ON 65
ci_0067                -3.652598e-03 3 1  ON 66
ci_0068                -3.426367e-03 3 1  ON 67
ci_0069                 3.754551e-03 3 1  ON 68
ci_0070                 3.412153e-03 3 1  ON 69
ci_0071                 2.917806e-03 3 1  ON 70
ci_0072                 3.674004e-03 3 1  ON 71
ci_0073                 3.661315e-03 3 1  ON 72
ci_0074                 3.592613e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.263368
====================================================
  Execution time = 1.4732e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9159e-01
  Total weights = 1.951550876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281431936260
                                         uncertainty =       0.001457185036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281431936260
                                         uncertainty =       0.001457185036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375098391
  error estimate for blocks of size 2^( 2) =       0.000392107852
  error estimate for blocks of size 2^( 3) =       0.000408844398
  error estimate for blocks of size 2^( 4) =       0.000423345818
  error estimate for blocks of size 2^( 5) =       0.000435628686
  error estimate for blocks of size 2^( 6) =       0.000441034797
  error estimate for blocks of size 2^( 7) =       0.000444368690

      target function =      -0.925920687787
              le_mean =     -16.898843653167
             les_mean =     285.862505083752
             stat err =       0.000436094498
             autocorr =       1.351670425726
   target nu stat err =       0.000436094498
   target dn stat err =       0.001958077979
      target stat err =       0.003179764410
              std dev =       0.530469231899
             le_variance =       0.281397605991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689884365317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925930219936       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925930288058       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925930295347       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925930297963       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925930299891       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925930299857       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925930300189       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925930299987       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925930300052       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925930300201       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925930300353       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925930300577       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925930300649       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925930300705       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925930300714       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925930300728       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925930300726       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+02 is 2.649376e-07

solving harmonic davidson linear method for identity shift 3.3881e+03, overlap shift 3.3881e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925930219936       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925930236968       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925930238790       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925930239442       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925930239923       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925930239919       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925930239997       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925930239947       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925930239967       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925930240000       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925930240044       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925930240091       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925930240112       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925930240114       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925930240124       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925930240150       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925930240135       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+03 is 6.623907e-08

solving harmonic davidson linear method for identity shift 1.3553e+04, overlap shift 1.3553e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925930219936       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925930224194       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925930224650       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925930224805       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925930224934       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925930224911       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925930224941       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925930224932       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925930224948       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925930224956       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925930224973       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925930224957       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925930225005       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925930224938       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925930225002       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925930224987       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925930224987       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+04 is 1.656006e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.260615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7324e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933195e-01 3 1  ON 1
ci_0003                -3.122638e-02 3 1  ON 2
ci_0004                -3.036395e-02 3 1  ON 3
ci_0005                -3.057564e-02 3 1  ON 4
ci_0006                -3.070235e-02 3 1  ON 5
ci_0007                -1.389303e-02 3 1  ON 6
ci_0008                -1.362993e-02 3 1  ON 7
ci_0009                -1.887622e-02 3 1  ON 8
ci_0010                -1.816171e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470804e-02 3 1  ON 11
ci_0013                 1.533559e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591855e-02 3 1  ON 14
ci_0016                 1.552297e-02 3 1  ON 15
ci_0017                 1.342856e-02 3 1  ON 16
ci_0018                 1.316888e-02 3 1  ON 17
ci_0019                 1.301482e-02 3 1  ON 18
ci_0020                 1.259841e-02 3 1  ON 19
ci_0021                 7.727129e-03 3 1  ON 20
ci_0022                 8.376143e-03 3 1  ON 21
ci_0023                -1.187679e-02 3 1  ON 22
ci_0024                -1.137884e-02 3 1  ON 23
ci_0025                -2.043478e-03 3 1  ON 24
ci_0026                -2.789911e-03 3 1  ON 25
ci_0027                -1.200437e-02 3 1  ON 26
ci_0028                -1.159461e-02 3 1  ON 27
ci_0029                -1.051564e-02 3 1  ON 28
ci_0030                -1.046527e-02 3 1  ON 29
ci_0031                 1.356757e-02 3 1  ON 30
ci_0032                 1.227235e-02 3 1  ON 31
ci_0033                 7.993978e-03 3 1  ON 32
ci_0034                 8.506714e-03 3 1  ON 33
ci_0035                 4.985030e-03 3 1  ON 34
ci_0036                 5.102524e-03 3 1  ON 35
ci_0037                -1.125844e-02 3 1  ON 36
ci_0038                -1.153349e-02 3 1  ON 37
ci_0039                -4.038157e-03 3 1  ON 38
ci_0040                -4.033457e-03 3 1  ON 39
ci_0041                 8.952371e-03 3 1  ON 40
ci_0042                 8.741048e-03 3 1  ON 41
ci_0043                -1.252880e-02 3 1  ON 42
ci_0044                -1.316128e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018365e-02 3 1  ON 45
ci_0047                -3.627577e-03 3 1  ON 46
ci_0048                -3.413515e-03 3 1  ON 47
ci_0049                -2.519530e-03 3 1  ON 48
ci_0050                -2.770654e-03 3 1  ON 49
ci_0051                -1.757600e-03 3 1  ON 50
ci_0052                -2.066467e-03 3 1  ON 51
ci_0053                -3.968885e-03 3 1  ON 52
ci_0054                -3.314379e-03 3 1  ON 53
ci_0055                 2.827802e-03 3 1  ON 54
ci_0056                 2.256314e-03 3 1  ON 55
ci_0057                 2.243678e-03 3 1  ON 56
ci_0058                 3.163454e-03 3 1  ON 57
ci_0059                -3.375195e-03 3 1  ON 58
ci_0060                -3.196907e-03 3 1  ON 59
ci_0061                -3.953619e-03 3 1  ON 60
ci_0062                -4.023350e-03 3 1  ON 61
ci_0063                -9.956948e-03 3 1  ON 62
ci_0064                -9.490782e-03 3 1  ON 63
ci_0065                -6.357454e-03 3 1  ON 64
ci_0066                -6.200223e-03 3 1  ON 65
ci_0067                -3.652581e-03 3 1  ON 66
ci_0068                -3.426374e-03 3 1  ON 67
ci_0069                 3.754538e-03 3 1  ON 68
ci_0070                 3.412139e-03 3 1  ON 69
ci_0071                 2.917821e-03 3 1  ON 70
ci_0072                 3.674022e-03 3 1  ON 71
ci_0073                 3.661305e-03 3 1  ON 72
ci_0074                 3.592612e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.9854
    reference variance = 0.203451
====================================================
  Execution time = 1.4289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9192e-01
  Total weights = 1.9509e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393380466
                                         uncertainty =       0.001816665856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393380466
                                         uncertainty =       0.001816665856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375084959
  error estimate for blocks of size 2^( 2) =       0.000392093881
  error estimate for blocks of size 2^( 3) =       0.000409253088
  error estimate for blocks of size 2^( 4) =       0.000425429811
  error estimate for blocks of size 2^( 5) =       0.000436658647
  error estimate for blocks of size 2^( 6) =       0.000444470056
  error estimate for blocks of size 2^( 7) =       0.000449293879

      target function =      -0.925376548763
              le_mean =     -16.898349581131
             les_mean =     285.846138281779
             stat err =       0.000438963098
             autocorr =       1.369609393656
   target nu stat err =       0.000438963098
   target dn stat err =       0.003179533267
      target stat err =       0.005065209333
              std dev =       0.530450236287
             le_variance =       0.281377453177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393297483
                                         uncertainty =       0.001816649151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393297483
                                         uncertainty =       0.001816649151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375084904
  error estimate for blocks of size 2^( 2) =       0.000392093834
  error estimate for blocks of size 2^( 3) =       0.000409253045
  error estimate for blocks of size 2^( 4) =       0.000425429771
  error estimate for blocks of size 2^( 5) =       0.000436658604
  error estimate for blocks of size 2^( 6) =       0.000444470006
  error estimate for blocks of size 2^( 7) =       0.000449293825

      target function =      -0.925375540574
              le_mean =     -16.898349580910
             les_mean =     285.846138913557
             stat err =       0.000438963052
             autocorr =       1.369609506056
   target nu stat err =       0.000438963052
   target dn stat err =       0.003179594348
      target stat err =       0.005065293595
              std dev =       0.530450158396
             le_variance =       0.281377370543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393338970
                                         uncertainty =       0.001816657503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393338970
                                         uncertainty =       0.001816657503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375084932
  error estimate for blocks of size 2^( 2) =       0.000392093857
  error estimate for blocks of size 2^( 3) =       0.000409253066
  error estimate for blocks of size 2^( 4) =       0.000425429791
  error estimate for blocks of size 2^( 5) =       0.000436658626
  error estimate for blocks of size 2^( 6) =       0.000444470031
  error estimate for blocks of size 2^( 7) =       0.000449293852

      target function =      -0.925376045164
              le_mean =     -16.898349581020
             les_mean =     285.846138597349
             stat err =       0.000438963075
             autocorr =       1.369609449866
   target nu stat err =       0.000438963075
   target dn stat err =       0.003179563741
      target stat err =       0.005065251366
              std dev =       0.530450197338
             le_variance =       0.281377411856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393375279
                                         uncertainty =       0.001816664812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281393375279
                                         uncertainty =       0.001816664812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375084956
  error estimate for blocks of size 2^( 2) =       0.000392093878
  error estimate for blocks of size 2^( 3) =       0.000409253085
  error estimate for blocks of size 2^( 4) =       0.000425429808
  error estimate for blocks of size 2^( 5) =       0.000436658644
  error estimate for blocks of size 2^( 6) =       0.000444470053
  error estimate for blocks of size 2^( 7) =       0.000449293876

      target function =      -0.925376485872
              le_mean =     -16.898349581117
             les_mean =     285.846138321188
             stat err =       0.000438963095
             autocorr =       1.369609400689
   target nu stat err =       0.000438963095
   target dn stat err =       0.003179537068
      target stat err =       0.005065214576
              std dev =       0.530450231418
             le_variance =       0.281377448012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925376548763        initial  <--
     8.4703e+02     8.4703e+03             2.6494e-07        -0.925375540574
     3.3881e+03     3.3881e+04             6.6239e-08        -0.925376045164
     1.3553e+04     1.3553e+05             1.6560e-08        -0.925376485872

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8483
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122641e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057564e-02 3 1  ON 4
ci_0006                -3.070234e-02 3 1  ON 5
ci_0007                -1.389304e-02 3 1  ON 6
ci_0008                -1.362994e-02 3 1  ON 7
ci_0009                -1.887622e-02 3 1  ON 8
ci_0010                -1.816172e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470805e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591854e-02 3 1  ON 14
ci_0016                 1.552298e-02 3 1  ON 15
ci_0017                 1.342856e-02 3 1  ON 16
ci_0018                 1.316888e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259841e-02 3 1  ON 19
ci_0021                 7.727162e-03 3 1  ON 20
ci_0022                 8.376168e-03 3 1  ON 21
ci_0023                -1.187678e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043493e-03 3 1  ON 24
ci_0026                -2.789952e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051566e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356758e-02 3 1  ON 30
ci_0032                 1.227236e-02 3 1  ON 31
ci_0033                 7.994003e-03 3 1  ON 32
ci_0034                 8.506692e-03 3 1  ON 33
ci_0035                 4.985067e-03 3 1  ON 34
ci_0036                 5.102519e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153351e-02 3 1  ON 37
ci_0039                -4.038146e-03 3 1  ON 38
ci_0040                -4.033455e-03 3 1  ON 39
ci_0041                 8.952388e-03 3 1  ON 40
ci_0042                 8.741066e-03 3 1  ON 41
ci_0043                -1.252876e-02 3 1  ON 42
ci_0044                -1.316123e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018363e-02 3 1  ON 45
ci_0047                -3.627581e-03 3 1  ON 46
ci_0048                -3.413512e-03 3 1  ON 47
ci_0049                -2.519537e-03 3 1  ON 48
ci_0050                -2.770618e-03 3 1  ON 49
ci_0051                -1.757611e-03 3 1  ON 50
ci_0052                -2.066477e-03 3 1  ON 51
ci_0053                -3.968900e-03 3 1  ON 52
ci_0054                -3.314359e-03 3 1  ON 53
ci_0055                 2.827868e-03 3 1  ON 54
ci_0056                 2.256340e-03 3 1  ON 55
ci_0057                 2.243705e-03 3 1  ON 56
ci_0058                 3.163480e-03 3 1  ON 57
ci_0059                -3.375181e-03 3 1  ON 58
ci_0060                -3.196913e-03 3 1  ON 59
ci_0061                -3.953643e-03 3 1  ON 60
ci_0062                -4.023369e-03 3 1  ON 61
ci_0063                -9.956943e-03 3 1  ON 62
ci_0064                -9.490788e-03 3 1  ON 63
ci_0065                -6.357456e-03 3 1  ON 64
ci_0066                -6.200217e-03 3 1  ON 65
ci_0067                -3.652598e-03 3 1  ON 66
ci_0068                -3.426367e-03 3 1  ON 67
ci_0069                 3.754551e-03 3 1  ON 68
ci_0070                 3.412153e-03 3 1  ON 69
ci_0071                 2.917806e-03 3 1  ON 70
ci_0072                 3.674004e-03 3 1  ON 71
ci_0073                 3.661315e-03 3 1  ON 72
ci_0074                 3.592613e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.179605
====================================================
  Execution time = 1.4642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9107e-01
  Total weights = 1.950890166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280029603775
                                         uncertainty =       0.001454847728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280029603775
                                         uncertainty =       0.001454847728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374142780
  error estimate for blocks of size 2^( 2) =       0.000391074063
  error estimate for blocks of size 2^( 3) =       0.000408342965
  error estimate for blocks of size 2^( 4) =       0.000422979371
  error estimate for blocks of size 2^( 5) =       0.000433780899
  error estimate for blocks of size 2^( 6) =       0.000440621392
  error estimate for blocks of size 2^( 7) =       0.000445236756

      target function =      -0.926731873028
              le_mean =     -16.898888768816
             les_mean =     285.863510577754
             stat err =       0.000435654605
             autocorr =       1.355844485714
   target nu stat err =       0.000435654605
   target dn stat err =       0.002765613835
      target stat err =       0.004437410087
              std dev =       0.529117793893
             le_variance =       0.279965639814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689888876882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926751385307       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926751401852       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926751402793       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926751403325       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926751403585       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926751403706       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926751403774       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926751403763       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926751403850       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926751403860       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926751403893       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926751403876       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926751403922       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926751403907       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926751403900       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926751403922       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926751403923       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926751403876       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+03 is 4.956115e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926751385307       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926751389443       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926751389679       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926751389812       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926751389877       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926751389907       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926751389921       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926751389921       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926751389939       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926751389946       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926751389954       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926751390044       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926751389810       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926751389959       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926751389959       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926751389959       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926751389960       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926751389959       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+04 is 1.239038e-08

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926751385307       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926751386341       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926751386400       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926751386433       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926751386449       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926751386457       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926751386460       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926751386461       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926751386465       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926751386483       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926751386603       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926751386732       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926751386616       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926751386817       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926751386759       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926751386523       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926751386348       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926751386365       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3553e+05 is 3.097600e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.270809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0461e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933195e-01 3 1  ON 1
ci_0003                -3.122640e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057563e-02 3 1  ON 4
ci_0006                -3.070235e-02 3 1  ON 5
ci_0007                -1.389304e-02 3 1  ON 6
ci_0008                -1.362994e-02 3 1  ON 7
ci_0009                -1.887622e-02 3 1  ON 8
ci_0010                -1.816172e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470805e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591854e-02 3 1  ON 14
ci_0016                 1.552298e-02 3 1  ON 15
ci_0017                 1.342856e-02 3 1  ON 16
ci_0018                 1.316888e-02 3 1  ON 17
ci_0019                 1.301481e-02 3 1  ON 18
ci_0020                 1.259841e-02 3 1  ON 19
ci_0021                 7.727163e-03 3 1  ON 20
ci_0022                 8.376162e-03 3 1  ON 21
ci_0023                -1.187678e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043491e-03 3 1  ON 24
ci_0026                -2.789947e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051566e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356758e-02 3 1  ON 30
ci_0032                 1.227235e-02 3 1  ON 31
ci_0033                 7.994000e-03 3 1  ON 32
ci_0034                 8.506688e-03 3 1  ON 33
ci_0035                 4.985061e-03 3 1  ON 34
ci_0036                 5.102517e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153351e-02 3 1  ON 37
ci_0039                -4.038145e-03 3 1  ON 38
ci_0040                -4.033454e-03 3 1  ON 39
ci_0041                 8.952390e-03 3 1  ON 40
ci_0042                 8.741065e-03 3 1  ON 41
ci_0043                -1.252876e-02 3 1  ON 42
ci_0044                -1.316123e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018363e-02 3 1  ON 45
ci_0047                -3.627581e-03 3 1  ON 46
ci_0048                -3.413511e-03 3 1  ON 47
ci_0049                -2.519550e-03 3 1  ON 48
ci_0050                -2.770614e-03 3 1  ON 49
ci_0051                -1.757611e-03 3 1  ON 50
ci_0052                -2.066476e-03 3 1  ON 51
ci_0053                -3.968899e-03 3 1  ON 52
ci_0054                -3.314361e-03 3 1  ON 53
ci_0055                 2.827868e-03 3 1  ON 54
ci_0056                 2.256335e-03 3 1  ON 55
ci_0057                 2.243706e-03 3 1  ON 56
ci_0058                 3.163478e-03 3 1  ON 57
ci_0059                -3.375181e-03 3 1  ON 58
ci_0060                -3.196915e-03 3 1  ON 59
ci_0061                -3.953643e-03 3 1  ON 60
ci_0062                -4.023368e-03 3 1  ON 61
ci_0063                -9.956942e-03 3 1  ON 62
ci_0064                -9.490787e-03 3 1  ON 63
ci_0065                -6.357456e-03 3 1  ON 64
ci_0066                -6.200217e-03 3 1  ON 65
ci_0067                -3.652597e-03 3 1  ON 66
ci_0068                -3.426370e-03 3 1  ON 67
ci_0069                 3.754550e-03 3 1  ON 68
ci_0070                 3.412152e-03 3 1  ON 69
ci_0071                 2.917809e-03 3 1  ON 70
ci_0072                 3.674004e-03 3 1  ON 71
ci_0073                 3.661314e-03 3 1  ON 72
ci_0074                 3.592614e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.938
    reference variance = 0.289373
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9112e-01
  Total weights = 1.9509e+06
  Execution time = 1.9033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211701223
                                         uncertainty =       0.001812007578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211701223
                                         uncertainty =       0.001812007578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993068
  error estimate for blocks of size 2^( 2) =       0.000391965255
  error estimate for blocks of size 2^( 3) =       0.000409652756
  error estimate for blocks of size 2^( 4) =       0.000424691813
  error estimate for blocks of size 2^( 5) =       0.000434943096
  error estimate for blocks of size 2^( 6) =       0.000442187636
  error estimate for blocks of size 2^( 7) =       0.000445334053

      target function =      -0.926651908611
              le_mean =     -16.898498191169
             les_mean =     285.850360864933
             stat err =       0.000436789149
             autocorr =       1.356741791946
   target nu stat err =       0.000436789149
   target dn stat err =       0.002385338354
      target stat err =       0.003842655281
              std dev =       0.530320282800
             le_variance =       0.281239602349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211685330
                                         uncertainty =       0.001812006117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211685330
                                         uncertainty =       0.001812006117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993058
  error estimate for blocks of size 2^( 2) =       0.000391965245
  error estimate for blocks of size 2^( 3) =       0.000409652746
  error estimate for blocks of size 2^( 4) =       0.000424691804
  error estimate for blocks of size 2^( 5) =       0.000434943086
  error estimate for blocks of size 2^( 6) =       0.000442187625
  error estimate for blocks of size 2^( 7) =       0.000445334045

      target function =      -0.926652056495
              le_mean =     -16.898498190744
             les_mean =     285.850360757096
             stat err =       0.000436789140
             autocorr =       1.356741809570
   target nu stat err =       0.000436789140
   target dn stat err =       0.002385325985
      target stat err =       0.003842637301
              std dev =       0.530320267883
             le_variance =       0.281239586528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211693276
                                         uncertainty =       0.001812006847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211693276
                                         uncertainty =       0.001812006847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993063
  error estimate for blocks of size 2^( 2) =       0.000391965250
  error estimate for blocks of size 2^( 3) =       0.000409652751
  error estimate for blocks of size 2^( 4) =       0.000424691808
  error estimate for blocks of size 2^( 5) =       0.000434943091
  error estimate for blocks of size 2^( 6) =       0.000442187630
  error estimate for blocks of size 2^( 7) =       0.000445334049

      target function =      -0.926651982641
              le_mean =     -16.898498190956
             les_mean =     285.850360810958
             stat err =       0.000436789145
             autocorr =       1.356741800769
   target nu stat err =       0.000436789145
   target dn stat err =       0.002385332169
      target stat err =       0.003842646291
              std dev =       0.530320275341
             le_variance =       0.281239594438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211700230
                                         uncertainty =       0.001812007487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281211700230
                                         uncertainty =       0.001812007487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993068
  error estimate for blocks of size 2^( 2) =       0.000391965254
  error estimate for blocks of size 2^( 3) =       0.000409652755
  error estimate for blocks of size 2^( 4) =       0.000424691813
  error estimate for blocks of size 2^( 5) =       0.000434943095
  error estimate for blocks of size 2^( 6) =       0.000442187635
  error estimate for blocks of size 2^( 7) =       0.000445334052

      target function =      -0.926651917874
              le_mean =     -16.898498191142
             les_mean =     285.850360858180
             stat err =       0.000436789149
             autocorr =       1.356741793048
   target nu stat err =       0.000436789149
   target dn stat err =       0.002385337581
      target stat err =       0.003842654158
              std dev =       0.530320281868
             le_variance =       0.281239601360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926651908611        initial
     8.4703e+03     8.4703e+04             4.9561e-08        -0.926652056495  <--
     3.3881e+04     3.3881e+05             1.2390e-08        -0.926651982641
     1.3553e+05     1.3553e+06             3.0976e-09        -0.926651917874

*****************************************************************************
Applying the update for shift_i =   8.4703e+03     and shift_s =   8.4703e+04
*****************************************************************************

  Execution time = 2.3808e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933195e-01 3 1  ON 1
ci_0003                -3.122639e-02 3 1  ON 2
ci_0004                -3.036394e-02 3 1  ON 3
ci_0005                -3.057563e-02 3 1  ON 4
ci_0006                -3.070235e-02 3 1  ON 5
ci_0007                -1.389304e-02 3 1  ON 6
ci_0008                -1.362994e-02 3 1  ON 7
ci_0009                -1.887622e-02 3 1  ON 8
ci_0010                -1.816173e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470804e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591854e-02 3 1  ON 14
ci_0016                 1.552299e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301482e-02 3 1  ON 18
ci_0020                 1.259841e-02 3 1  ON 19
ci_0021                 7.727167e-03 3 1  ON 20
ci_0022                 8.376145e-03 3 1  ON 21
ci_0023                -1.187678e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043485e-03 3 1  ON 24
ci_0026                -2.789933e-03 3 1  ON 25
ci_0027                -1.200437e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051567e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356760e-02 3 1  ON 30
ci_0032                 1.227235e-02 3 1  ON 31
ci_0033                 7.993990e-03 3 1  ON 32
ci_0034                 8.506678e-03 3 1  ON 33
ci_0035                 4.985041e-03 3 1  ON 34
ci_0036                 5.102509e-03 3 1  ON 35
ci_0037                -1.125846e-02 3 1  ON 36
ci_0038                -1.153351e-02 3 1  ON 37
ci_0039                -4.038141e-03 3 1  ON 38
ci_0040                -4.033451e-03 3 1  ON 39
ci_0041                 8.952396e-03 3 1  ON 40
ci_0042                 8.741061e-03 3 1  ON 41
ci_0043                -1.252878e-02 3 1  ON 42
ci_0044                -1.316124e-02 3 1  ON 43
ci_0045                 1.066891e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627581e-03 3 1  ON 46
ci_0048                -3.413509e-03 3 1  ON 47
ci_0049                -2.519587e-03 3 1  ON 48
ci_0050                -2.770603e-03 3 1  ON 49
ci_0051                -1.757612e-03 3 1  ON 50
ci_0052                -2.066473e-03 3 1  ON 51
ci_0053                -3.968894e-03 3 1  ON 52
ci_0054                -3.314368e-03 3 1  ON 53
ci_0055                 2.827867e-03 3 1  ON 54
ci_0056                 2.256322e-03 3 1  ON 55
ci_0057                 2.243709e-03 3 1  ON 56
ci_0058                 3.163471e-03 3 1  ON 57
ci_0059                -3.375182e-03 3 1  ON 58
ci_0060                -3.196921e-03 3 1  ON 59
ci_0061                -3.953643e-03 3 1  ON 60
ci_0062                -4.023363e-03 3 1  ON 61
ci_0063                -9.956938e-03 3 1  ON 62
ci_0064                -9.490782e-03 3 1  ON 63
ci_0065                -6.357458e-03 3 1  ON 64
ci_0066                -6.200217e-03 3 1  ON 65
ci_0067                -3.652594e-03 3 1  ON 66
ci_0068                -3.426376e-03 3 1  ON 67
ci_0069                 3.754548e-03 3 1  ON 68
ci_0070                 3.412152e-03 3 1  ON 69
ci_0071                 2.917818e-03 3 1  ON 70
ci_0072                 3.674005e-03 3 1  ON 71
ci_0073                 3.661310e-03 3 1  ON 72
ci_0074                 3.592615e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9563
    reference variance = 0.524809
====================================================
  Execution time = 1.4632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.8822e-01
  Total weights = 1.950763269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279136526475
                                         uncertainty =       0.001524784527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279136526475
                                         uncertainty =       0.001524784527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373621879
  error estimate for blocks of size 2^( 2) =       0.000390702001
  error estimate for blocks of size 2^( 3) =       0.000407933953
  error estimate for blocks of size 2^( 4) =       0.000423548386
  error estimate for blocks of size 2^( 5) =       0.000434516781
  error estimate for blocks of size 2^( 6) =       0.000440578458
  error estimate for blocks of size 2^( 7) =       0.000444751995

      target function =      -0.931251223373
              le_mean =     -16.897669930793
             les_mean =     285.819464592713
             stat err =       0.000435848905
             autocorr =       1.360840790476
   target nu stat err =       0.000435848905
   target dn stat err =       0.001984201194
      target stat err =       0.003248951568
              std dev =       0.528381127910
             le_variance =       0.279186616331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689766993079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931261257114       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931261270178       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931261272966       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931261273666       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931261274322       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931261274429       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931261274438       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931261274495       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931261274517       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931261274739       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931261274783       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931261274790       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931261274816       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931261274831       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931261274844       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931261274845       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931261274853       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+03 is 1.083474e-07

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931261257114       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931261260380       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931261261077       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931261261252       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931261261416       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931261261442       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931261261446       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931261261459       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931261261459       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931261261525       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931261261517       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931261261514       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931261261535       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931261261544       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931261261548       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931261261557       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931261261537       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+03 is 2.708684e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931261257114       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931261257931       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931261258105       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931261258148       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931261258190       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931261258196       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931261258197       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931261258200       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931261258202       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931261258216       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931261258219       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931261258219       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931261258220       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931261258216       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931261258193       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931261258220       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931261258222       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.3881e+04 is 6.771710e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.279984 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7223e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.079779e-01 3 1  ON 0
ci_0002                 6.933195e-01 3 1  ON 1
ci_0003                -3.122638e-02 3 1  ON 2
ci_0004                -3.036393e-02 3 1  ON 3
ci_0005                -3.057564e-02 3 1  ON 4
ci_0006                -3.070236e-02 3 1  ON 5
ci_0007                -1.389305e-02 3 1  ON 6
ci_0008                -1.362994e-02 3 1  ON 7
ci_0009                -1.887623e-02 3 1  ON 8
ci_0010                -1.816173e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470804e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479156e-02 3 1  ON 13
ci_0015                 1.591853e-02 3 1  ON 14
ci_0016                 1.552299e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301482e-02 3 1  ON 18
ci_0020                 1.259842e-02 3 1  ON 19
ci_0021                 7.727157e-03 3 1  ON 20
ci_0022                 8.376130e-03 3 1  ON 21
ci_0023                -1.187678e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043494e-03 3 1  ON 24
ci_0026                -2.789933e-03 3 1  ON 25
ci_0027                -1.200437e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051567e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356759e-02 3 1  ON 30
ci_0032                 1.227234e-02 3 1  ON 31
ci_0033                 7.993977e-03 3 1  ON 32
ci_0034                 8.506660e-03 3 1  ON 33
ci_0035                 4.985040e-03 3 1  ON 34
ci_0036                 5.102508e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153350e-02 3 1  ON 37
ci_0039                -4.038138e-03 3 1  ON 38
ci_0040                -4.033450e-03 3 1  ON 39
ci_0041                 8.952403e-03 3 1  ON 40
ci_0042                 8.741062e-03 3 1  ON 41
ci_0043                -1.252879e-02 3 1  ON 42
ci_0044                -1.316126e-02 3 1  ON 43
ci_0045                 1.066891e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627581e-03 3 1  ON 46
ci_0048                -3.413508e-03 3 1  ON 47
ci_0049                -2.519588e-03 3 1  ON 48
ci_0050                -2.770594e-03 3 1  ON 49
ci_0051                -1.757614e-03 3 1  ON 50
ci_0052                -2.066473e-03 3 1  ON 51
ci_0053                -3.968895e-03 3 1  ON 52
ci_0054                -3.314369e-03 3 1  ON 53
ci_0055                 2.827867e-03 3 1  ON 54
ci_0056                 2.256324e-03 3 1  ON 55
ci_0057                 2.243717e-03 3 1  ON 56
ci_0058                 3.163455e-03 3 1  ON 57
ci_0059                -3.375179e-03 3 1  ON 58
ci_0060                -3.196928e-03 3 1  ON 59
ci_0061                -3.953645e-03 3 1  ON 60
ci_0062                -4.023353e-03 3 1  ON 61
ci_0063                -9.956936e-03 3 1  ON 62
ci_0064                -9.490782e-03 3 1  ON 63
ci_0065                -6.357467e-03 3 1  ON 64
ci_0066                -6.200217e-03 3 1  ON 65
ci_0067                -3.652593e-03 3 1  ON 66
ci_0068                -3.426378e-03 3 1  ON 67
ci_0069                 3.754549e-03 3 1  ON 68
ci_0070                 3.412145e-03 3 1  ON 69
ci_0071                 2.917827e-03 3 1  ON 70
ci_0072                 3.674000e-03 3 1  ON 71
ci_0073                 3.661309e-03 3 1  ON 72
ci_0074                 3.592620e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.213677
====================================================
  Execution time = 1.4287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9504e-01
  Total weights = 1.9509e+06
  Execution time = 1.8888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847671722
                                         uncertainty =       0.002739618215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847671722
                                         uncertainty =       0.002739618215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377362247
  error estimate for blocks of size 2^( 2) =       0.000394132248
  error estimate for blocks of size 2^( 3) =       0.000411095444
  error estimate for blocks of size 2^( 4) =       0.000426319701
  error estimate for blocks of size 2^( 5) =       0.000437363020
  error estimate for blocks of size 2^( 6) =       0.000443881698
  error estimate for blocks of size 2^( 7) =       0.000448933004

      target function =      -0.920483257067
              le_mean =     -16.898770103713
             les_mean =     285.863470929683
             stat err =       0.000439124356
             autocorr =       1.354123118995
   target nu stat err =       0.000439124356
   target dn stat err =       0.003379470909
      target stat err =       0.005324997944
              std dev =       0.533670807508
             le_variance =       0.284804530787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847660707
                                         uncertainty =       0.002739616213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847660707
                                         uncertainty =       0.002739616213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377362240
  error estimate for blocks of size 2^( 2) =       0.000394132240
  error estimate for blocks of size 2^( 3) =       0.000411095436
  error estimate for blocks of size 2^( 4) =       0.000426319692
  error estimate for blocks of size 2^( 5) =       0.000437363012
  error estimate for blocks of size 2^( 6) =       0.000443881688
  error estimate for blocks of size 2^( 7) =       0.000448932994

      target function =      -0.920483257729
              le_mean =     -16.898770104873
             les_mean =     285.863470968474
             stat err =       0.000439124346
             autocorr =       1.354123114380
   target nu stat err =       0.000439124346
   target dn stat err =       0.003379470343
      target stat err =       0.005324997085
              std dev =       0.533670797062
             le_variance =       0.284804519636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847666214
                                         uncertainty =       0.002739617214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847666214
                                         uncertainty =       0.002739617214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377362243
  error estimate for blocks of size 2^( 2) =       0.000394132244
  error estimate for blocks of size 2^( 3) =       0.000411095440
  error estimate for blocks of size 2^( 4) =       0.000426319697
  error estimate for blocks of size 2^( 5) =       0.000437363016
  error estimate for blocks of size 2^( 6) =       0.000443881693
  error estimate for blocks of size 2^( 7) =       0.000448932999

      target function =      -0.920483257455
              le_mean =     -16.898770104293
             les_mean =     285.863470949042
             stat err =       0.000439124351
             autocorr =       1.354123116693
   target nu stat err =       0.000439124351
   target dn stat err =       0.003379470626
      target stat err =       0.005324997515
              std dev =       0.533670802285
             le_variance =       0.284804525211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847671034
                                         uncertainty =       0.002739618090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284847671034
                                         uncertainty =       0.002739618090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377362246
  error estimate for blocks of size 2^( 2) =       0.000394132248
  error estimate for blocks of size 2^( 3) =       0.000411095444
  error estimate for blocks of size 2^( 4) =       0.000426319700
  error estimate for blocks of size 2^( 5) =       0.000437363020
  error estimate for blocks of size 2^( 6) =       0.000443881698
  error estimate for blocks of size 2^( 7) =       0.000448933003

      target function =      -0.920483257122
              le_mean =     -16.898770103786
             les_mean =     285.863470932098
             stat err =       0.000439124355
             autocorr =       1.354123118701
   target nu stat err =       0.000439124355
   target dn stat err =       0.003379470874
      target stat err =       0.005324997890
              std dev =       0.533670806856
             le_variance =       0.284804530090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920483257067        initial
     2.1176e+03     2.1176e+04             1.0835e-07        -0.920483257729  <--
     8.4703e+03     8.4703e+04             2.7087e-08        -0.920483257455
     3.3881e+04     3.3881e+05             6.7717e-09        -0.920483257122

*****************************************************************************
Applying the update for shift_i =   2.1176e+03     and shift_s =   2.1176e+04
*****************************************************************************

  Execution time = 2.3826e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122636e-02 3 1  ON 2
ci_0004                -3.036390e-02 3 1  ON 3
ci_0005                -3.057568e-02 3 1  ON 4
ci_0006                -3.070237e-02 3 1  ON 5
ci_0007                -1.389308e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887625e-02 3 1  ON 8
ci_0010                -1.816171e-02 3 1  ON 9
ci_0011                -1.478277e-02 3 1  ON 10
ci_0012                -1.470802e-02 3 1  ON 11
ci_0013                 1.533559e-02 3 1  ON 12
ci_0014                 1.479157e-02 3 1  ON 13
ci_0015                 1.591851e-02 3 1  ON 14
ci_0016                 1.552297e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301483e-02 3 1  ON 18
ci_0020                 1.259845e-02 3 1  ON 19
ci_0021                 7.727129e-03 3 1  ON 20
ci_0022                 8.376084e-03 3 1  ON 21
ci_0023                -1.187679e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043520e-03 3 1  ON 24
ci_0026                -2.789933e-03 3 1  ON 25
ci_0027                -1.200437e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051568e-02 3 1  ON 28
ci_0030                -1.046525e-02 3 1  ON 29
ci_0031                 1.356757e-02 3 1  ON 30
ci_0032                 1.227231e-02 3 1  ON 31
ci_0033                 7.993939e-03 3 1  ON 32
ci_0034                 8.506606e-03 3 1  ON 33
ci_0035                 4.985038e-03 3 1  ON 34
ci_0036                 5.102503e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153348e-02 3 1  ON 37
ci_0039                -4.038127e-03 3 1  ON 38
ci_0040                -4.033445e-03 3 1  ON 39
ci_0041                 8.952424e-03 3 1  ON 40
ci_0042                 8.741066e-03 3 1  ON 41
ci_0043                -1.252882e-02 3 1  ON 42
ci_0044                -1.316132e-02 3 1  ON 43
ci_0045                 1.066891e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627580e-03 3 1  ON 46
ci_0048                -3.413506e-03 3 1  ON 47
ci_0049                -2.519589e-03 3 1  ON 48
ci_0050                -2.770568e-03 3 1  ON 49
ci_0051                -1.757621e-03 3 1  ON 50
ci_0052                -2.066475e-03 3 1  ON 51
ci_0053                -3.968897e-03 3 1  ON 52
ci_0054                -3.314373e-03 3 1  ON 53
ci_0055                 2.827866e-03 3 1  ON 54
ci_0056                 2.256331e-03 3 1  ON 55
ci_0057                 2.243740e-03 3 1  ON 56
ci_0058                 3.163405e-03 3 1  ON 57
ci_0059                -3.375170e-03 3 1  ON 58
ci_0060                -3.196951e-03 3 1  ON 59
ci_0061                -3.953650e-03 3 1  ON 60
ci_0062                -4.023322e-03 3 1  ON 61
ci_0063                -9.956931e-03 3 1  ON 62
ci_0064                -9.490780e-03 3 1  ON 63
ci_0065                -6.357495e-03 3 1  ON 64
ci_0066                -6.200216e-03 3 1  ON 65
ci_0067                -3.652592e-03 3 1  ON 66
ci_0068                -3.426384e-03 3 1  ON 67
ci_0069                 3.754551e-03 3 1  ON 68
ci_0070                 3.412125e-03 3 1  ON 69
ci_0071                 2.917851e-03 3 1  ON 70
ci_0072                 3.673985e-03 3 1  ON 71
ci_0073                 3.661306e-03 3 1  ON 72
ci_0074                 3.592637e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.225346
====================================================
  Execution time = 1.4647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9207e-01
  Total weights = 1.950791625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281610636212
                                         uncertainty =       0.002118928943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281610636212
                                         uncertainty =       0.002118928943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375226124
  error estimate for blocks of size 2^( 2) =       0.000392091551
  error estimate for blocks of size 2^( 3) =       0.000409255982
  error estimate for blocks of size 2^( 4) =       0.000423951173
  error estimate for blocks of size 2^( 5) =       0.000435553585
  error estimate for blocks of size 2^( 6) =       0.000442336612
  error estimate for blocks of size 2^( 7) =       0.000448252481

      target function =      -0.925152801170
              le_mean =     -16.898457661641
             les_mean =     285.849938803135
             stat err =       0.000437523463
             autocorr =       1.359616918687
   target nu stat err =       0.000437523463
   target dn stat err =       0.002651315446
      target stat err =       0.004242178520
              std dev =       0.530649873740
             le_variance =       0.281589288501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689845766164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925170889467       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925171027600       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925171043376       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925171050361       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925171054257       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925171054851       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925171055176       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925171055216       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925171055322       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925171055409       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925171055462       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925171055474       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925171055479       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925171055479       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925171055487       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925171055470       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925171055471       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.2940e+02 is 5.329578e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925170889467       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925170924004       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925170927948       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925170929695       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925170930671       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925170930822       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925170930899       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925170930908       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925170930936       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925170930955       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925170930969       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925170930970       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925170930973       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925170930976       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925170930978       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925170930973       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925170930972       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+03 is 1.332544e-07

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925170889467       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925170898101       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925170899087       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925170899524       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925170899758       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925170899805       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925170899812       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925170899829       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925170899837       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925170899859       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925170899840       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925170899839       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925170899850       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925170899878       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925170899840       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925170899823       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925170899855       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+03 is 3.331454e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.289181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7243e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122632e-02 3 1  ON 2
ci_0004                -3.036390e-02 3 1  ON 3
ci_0005                -3.057568e-02 3 1  ON 4
ci_0006                -3.070237e-02 3 1  ON 5
ci_0007                -1.389300e-02 3 1  ON 6
ci_0008                -1.362987e-02 3 1  ON 7
ci_0009                -1.887624e-02 3 1  ON 8
ci_0010                -1.816171e-02 3 1  ON 9
ci_0011                -1.478279e-02 3 1  ON 10
ci_0012                -1.470802e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479155e-02 3 1  ON 13
ci_0015                 1.591849e-02 3 1  ON 14
ci_0016                 1.552292e-02 3 1  ON 15
ci_0017                 1.342854e-02 3 1  ON 16
ci_0018                 1.316886e-02 3 1  ON 17
ci_0019                 1.301485e-02 3 1  ON 18
ci_0020                 1.259846e-02 3 1  ON 19
ci_0021                 7.727094e-03 3 1  ON 20
ci_0022                 8.376062e-03 3 1  ON 21
ci_0023                -1.187677e-02 3 1  ON 22
ci_0024                -1.137883e-02 3 1  ON 23
ci_0025                -2.043574e-03 3 1  ON 24
ci_0026                -2.789887e-03 3 1  ON 25
ci_0027                -1.200437e-02 3 1  ON 26
ci_0028                -1.159462e-02 3 1  ON 27
ci_0029                -1.051567e-02 3 1  ON 28
ci_0030                -1.046526e-02 3 1  ON 29
ci_0031                 1.356750e-02 3 1  ON 30
ci_0032                 1.227230e-02 3 1  ON 31
ci_0033                 7.993872e-03 3 1  ON 32
ci_0034                 8.506592e-03 3 1  ON 33
ci_0035                 4.984904e-03 3 1  ON 34
ci_0036                 5.102481e-03 3 1  ON 35
ci_0037                -1.125844e-02 3 1  ON 36
ci_0038                -1.153347e-02 3 1  ON 37
ci_0039                -4.038111e-03 3 1  ON 38
ci_0040                -4.033427e-03 3 1  ON 39
ci_0041                 8.952458e-03 3 1  ON 40
ci_0042                 8.741087e-03 3 1  ON 41
ci_0043                -1.252890e-02 3 1  ON 42
ci_0044                -1.316140e-02 3 1  ON 43
ci_0045                 1.066889e-02 3 1  ON 44
ci_0046                 1.018361e-02 3 1  ON 45
ci_0047                -3.627577e-03 3 1  ON 46
ci_0048                -3.413504e-03 3 1  ON 47
ci_0049                -2.519534e-03 3 1  ON 48
ci_0050                -2.770571e-03 3 1  ON 49
ci_0051                -1.757609e-03 3 1  ON 50
ci_0052                -2.066427e-03 3 1  ON 51
ci_0053                -3.968870e-03 3 1  ON 52
ci_0054                -3.314354e-03 3 1  ON 53
ci_0055                 2.827797e-03 3 1  ON 54
ci_0056                 2.256318e-03 3 1  ON 55
ci_0057                 2.243736e-03 3 1  ON 56
ci_0058                 3.163337e-03 3 1  ON 57
ci_0059                -3.375188e-03 3 1  ON 58
ci_0060                -3.196964e-03 3 1  ON 59
ci_0061                -3.953668e-03 3 1  ON 60
ci_0062                -4.023332e-03 3 1  ON 61
ci_0063                -9.956939e-03 3 1  ON 62
ci_0064                -9.490766e-03 3 1  ON 63
ci_0065                -6.357506e-03 3 1  ON 64
ci_0066                -6.200240e-03 3 1  ON 65
ci_0067                -3.652608e-03 3 1  ON 66
ci_0068                -3.426406e-03 3 1  ON 67
ci_0069                 3.754512e-03 3 1  ON 68
ci_0070                 3.412142e-03 3 1  ON 69
ci_0071                 2.917886e-03 3 1  ON 70
ci_0072                 3.673995e-03 3 1  ON 71
ci_0073                 3.661319e-03 3 1  ON 72
ci_0074                 3.592612e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8904
    reference variance = 0.237642
====================================================
  Execution time = 1.4156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9414e-01
  Total weights = 1.9508e+06
  Execution time = 1.8846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051994383
                                         uncertainty =       0.001638479065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051994383
                                         uncertainty =       0.001638479065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376916578
  error estimate for blocks of size 2^( 2) =       0.000393770052
  error estimate for blocks of size 2^( 3) =       0.000411029780
  error estimate for blocks of size 2^( 4) =       0.000426561919
  error estimate for blocks of size 2^( 5) =       0.000438952602
  error estimate for blocks of size 2^( 6) =       0.000447244635
  error estimate for blocks of size 2^( 7) =       0.000452841782

      target function =      -0.921899197971
              le_mean =     -16.897943435501
             les_mean =     285.834633323390
             stat err =       0.000441400235
             autocorr =       1.371433144534
   target nu stat err =       0.000441400235
   target dn stat err =       0.002446661620
      target stat err =       0.003895726136
              std dev =       0.533040536087
             le_variance =       0.284132213112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051891289
                                         uncertainty =       0.001638465211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051891289
                                         uncertainty =       0.001638465211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376916510
  error estimate for blocks of size 2^( 2) =       0.000393770002
  error estimate for blocks of size 2^( 3) =       0.000411029750
  error estimate for blocks of size 2^( 4) =       0.000426561902
  error estimate for blocks of size 2^( 5) =       0.000438952594
  error estimate for blocks of size 2^( 6) =       0.000447244624
  error estimate for blocks of size 2^( 7) =       0.000452841767

      target function =      -0.921899002080
              le_mean =     -16.897943433877
             les_mean =     285.834633394072
             stat err =       0.000441400222
             autocorr =       1.371433553481
   target nu stat err =       0.000441400222
   target dn stat err =       0.002446635492
      target stat err =       0.003895684426
              std dev =       0.533040440724
             le_variance =       0.284132111448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051942825
                                         uncertainty =       0.001638472137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051942825
                                         uncertainty =       0.001638472137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376916544
  error estimate for blocks of size 2^( 2) =       0.000393770027
  error estimate for blocks of size 2^( 3) =       0.000411029765
  error estimate for blocks of size 2^( 4) =       0.000426561910
  error estimate for blocks of size 2^( 5) =       0.000438952598
  error estimate for blocks of size 2^( 6) =       0.000447244630
  error estimate for blocks of size 2^( 7) =       0.000452841775

      target function =      -0.921899103795
              le_mean =     -16.897943434689
             les_mean =     285.834633356300
             stat err =       0.000441400228
             autocorr =       1.371433349041
   target nu stat err =       0.000441400228
   target dn stat err =       0.002446648491
      target stat err =       0.003895705213
              std dev =       0.533040488396
             le_variance =       0.284132162269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051987938
                                         uncertainty =       0.001638478199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284051987938
                                         uncertainty =       0.001638478199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376916573
  error estimate for blocks of size 2^( 2) =       0.000393770049
  error estimate for blocks of size 2^( 3) =       0.000411029778
  error estimate for blocks of size 2^( 4) =       0.000426561918
  error estimate for blocks of size 2^( 5) =       0.000438952602
  error estimate for blocks of size 2^( 6) =       0.000447244634
  error estimate for blocks of size 2^( 7) =       0.000452841781

      target function =      -0.921899186601
              le_mean =     -16.897943435400
             les_mean =     285.834633327244
             stat err =       0.000441400234
             autocorr =       1.371433170108
   target nu stat err =       0.000441400234
   target dn stat err =       0.002446659972
      target stat err =       0.003895723513
              std dev =       0.533040530125
             le_variance =       0.284132206756


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921899197971        initial  <--
     5.2940e+02     5.2940e+03             5.3296e-07        -0.921899002080
     2.1176e+03     2.1176e+04             1.3325e-07        -0.921899103795
     8.4703e+03     8.4703e+04             3.3315e-08        -0.921899186601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8231
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122636e-02 3 1  ON 2
ci_0004                -3.036390e-02 3 1  ON 3
ci_0005                -3.057568e-02 3 1  ON 4
ci_0006                -3.070237e-02 3 1  ON 5
ci_0007                -1.389308e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887625e-02 3 1  ON 8
ci_0010                -1.816171e-02 3 1  ON 9
ci_0011                -1.478277e-02 3 1  ON 10
ci_0012                -1.470802e-02 3 1  ON 11
ci_0013                 1.533559e-02 3 1  ON 12
ci_0014                 1.479157e-02 3 1  ON 13
ci_0015                 1.591851e-02 3 1  ON 14
ci_0016                 1.552297e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301483e-02 3 1  ON 18
ci_0020                 1.259845e-02 3 1  ON 19
ci_0021                 7.727129e-03 3 1  ON 20
ci_0022                 8.376084e-03 3 1  ON 21
ci_0023                -1.187679e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043520e-03 3 1  ON 24
ci_0026                -2.789933e-03 3 1  ON 25
ci_0027                -1.200437e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051568e-02 3 1  ON 28
ci_0030                -1.046525e-02 3 1  ON 29
ci_0031                 1.356757e-02 3 1  ON 30
ci_0032                 1.227231e-02 3 1  ON 31
ci_0033                 7.993939e-03 3 1  ON 32
ci_0034                 8.506606e-03 3 1  ON 33
ci_0035                 4.985038e-03 3 1  ON 34
ci_0036                 5.102503e-03 3 1  ON 35
ci_0037                -1.125845e-02 3 1  ON 36
ci_0038                -1.153348e-02 3 1  ON 37
ci_0039                -4.038127e-03 3 1  ON 38
ci_0040                -4.033445e-03 3 1  ON 39
ci_0041                 8.952424e-03 3 1  ON 40
ci_0042                 8.741066e-03 3 1  ON 41
ci_0043                -1.252882e-02 3 1  ON 42
ci_0044                -1.316132e-02 3 1  ON 43
ci_0045                 1.066891e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627580e-03 3 1  ON 46
ci_0048                -3.413506e-03 3 1  ON 47
ci_0049                -2.519589e-03 3 1  ON 48
ci_0050                -2.770568e-03 3 1  ON 49
ci_0051                -1.757621e-03 3 1  ON 50
ci_0052                -2.066475e-03 3 1  ON 51
ci_0053                -3.968897e-03 3 1  ON 52
ci_0054                -3.314373e-03 3 1  ON 53
ci_0055                 2.827866e-03 3 1  ON 54
ci_0056                 2.256331e-03 3 1  ON 55
ci_0057                 2.243740e-03 3 1  ON 56
ci_0058                 3.163405e-03 3 1  ON 57
ci_0059                -3.375170e-03 3 1  ON 58
ci_0060                -3.196951e-03 3 1  ON 59
ci_0061                -3.953650e-03 3 1  ON 60
ci_0062                -4.023322e-03 3 1  ON 61
ci_0063                -9.956931e-03 3 1  ON 62
ci_0064                -9.490780e-03 3 1  ON 63
ci_0065                -6.357495e-03 3 1  ON 64
ci_0066                -6.200216e-03 3 1  ON 65
ci_0067                -3.652592e-03 3 1  ON 66
ci_0068                -3.426384e-03 3 1  ON 67
ci_0069                 3.754551e-03 3 1  ON 68
ci_0070                 3.412125e-03 3 1  ON 69
ci_0071                 2.917851e-03 3 1  ON 70
ci_0072                 3.673985e-03 3 1  ON 71
ci_0073                 3.661306e-03 3 1  ON 72
ci_0074                 3.592637e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.8599
    reference variance = 0.267901
====================================================
  Execution time = 1.4573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9073e-01
  Total weights = 1.950927150e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281571943297
                                         uncertainty =       0.001701554410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281571943297
                                         uncertainty =       0.001701554410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375183249
  error estimate for blocks of size 2^( 2) =       0.000392475940
  error estimate for blocks of size 2^( 3) =       0.000409968217
  error estimate for blocks of size 2^( 4) =       0.000425367368
  error estimate for blocks of size 2^( 5) =       0.000437690948
  error estimate for blocks of size 2^( 6) =       0.000444706880
  error estimate for blocks of size 2^( 7) =       0.000449515821

      target function =      -0.927284392099
              le_mean =     -16.898835541420
             les_mean =     285.861367688373
             stat err =       0.000439320254
             autocorr =       1.371120338240
   target nu stat err =       0.000439320254
   target dn stat err =       0.002077855349
      target stat err =       0.003374773978
              std dev =       0.530589238823
             le_variance =       0.281524940355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689883554142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927295102485       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927295105898       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927295106929       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927295107353       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927295107623       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927295107682       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927295107649       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927295107666       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927295107658       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927295107685       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927295107721       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927295107722       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927295107722       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927295107734       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927295107729       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927295107731       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927295107750       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.2940e+03 is 4.744351e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927295102485       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927295103338       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927295103596       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927295103702       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927295103770       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927295103784       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927295103796       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927295103749       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927295103762       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927295103748       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927295103715       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927295103817       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927295103813       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927295103756       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927295103776       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927295103747       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927295103823       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+04 is 1.186088e-08

solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927295102485       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927295102698       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927295102762       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927295102789       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927295102806       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927295102625       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927295103051       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927295102783       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927295102772       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927295102867       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927295102753       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927295102841       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927295102892       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927295102789       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927295102775       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927295102784       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927295102844       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.4703e+04 is 2.965222e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.298286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7161e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122636e-02 3 1  ON 2
ci_0004                -3.036390e-02 3 1  ON 3
ci_0005                -3.057568e-02 3 1  ON 4
ci_0006                -3.070237e-02 3 1  ON 5
ci_0007                -1.389307e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887625e-02 3 1  ON 8
ci_0010                -1.816171e-02 3 1  ON 9
ci_0011                -1.478277e-02 3 1  ON 10
ci_0012                -1.470802e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479157e-02 3 1  ON 13
ci_0015                 1.591850e-02 3 1  ON 14
ci_0016                 1.552297e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301483e-02 3 1  ON 18
ci_0020                 1.259845e-02 3 1  ON 19
ci_0021                 7.727119e-03 3 1  ON 20
ci_0022                 8.376076e-03 3 1  ON 21
ci_0023                -1.187679e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043521e-03 3 1  ON 24
ci_0026                -2.789931e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051568e-02 3 1  ON 28
ci_0030                -1.046525e-02 3 1  ON 29
ci_0031                 1.356757e-02 3 1  ON 30
ci_0032                 1.227231e-02 3 1  ON 31
ci_0033                 7.993942e-03 3 1  ON 32
ci_0034                 8.506606e-03 3 1  ON 33
ci_0035                 4.985035e-03 3 1  ON 34
ci_0036                 5.102499e-03 3 1  ON 35
ci_0037                -1.125844e-02 3 1  ON 36
ci_0038                -1.153348e-02 3 1  ON 37
ci_0039                -4.038126e-03 3 1  ON 38
ci_0040                -4.033443e-03 3 1  ON 39
ci_0041                 8.952424e-03 3 1  ON 40
ci_0042                 8.741066e-03 3 1  ON 41
ci_0043                -1.252883e-02 3 1  ON 42
ci_0044                -1.316132e-02 3 1  ON 43
ci_0045                 1.066891e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627579e-03 3 1  ON 46
ci_0048                -3.413506e-03 3 1  ON 47
ci_0049                -2.519592e-03 3 1  ON 48
ci_0050                -2.770569e-03 3 1  ON 49
ci_0051                -1.757620e-03 3 1  ON 50
ci_0052                -2.066476e-03 3 1  ON 51
ci_0053                -3.968897e-03 3 1  ON 52
ci_0054                -3.314372e-03 3 1  ON 53
ci_0055                 2.827866e-03 3 1  ON 54
ci_0056                 2.256328e-03 3 1  ON 55
ci_0057                 2.243743e-03 3 1  ON 56
ci_0058                 3.163405e-03 3 1  ON 57
ci_0059                -3.375168e-03 3 1  ON 58
ci_0060                -3.196954e-03 3 1  ON 59
ci_0061                -3.953648e-03 3 1  ON 60
ci_0062                -4.023321e-03 3 1  ON 61
ci_0063                -9.956929e-03 3 1  ON 62
ci_0064                -9.490781e-03 3 1  ON 63
ci_0065                -6.357495e-03 3 1  ON 64
ci_0066                -6.200219e-03 3 1  ON 65
ci_0067                -3.652589e-03 3 1  ON 66
ci_0068                -3.426380e-03 3 1  ON 67
ci_0069                 3.754551e-03 3 1  ON 68
ci_0070                 3.412125e-03 3 1  ON 69
ci_0071                 2.917851e-03 3 1  ON 70
ci_0072                 3.673980e-03 3 1  ON 71
ci_0073                 3.661305e-03 3 1  ON 72
ci_0074                 3.592636e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.357473
====================================================
  Execution time = 1.6325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6899e+01
  VMC Evar = 2.9594e-01
  Total weights = 1.9510e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228171619
                                         uncertainty =       0.002032771725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228171619
                                         uncertainty =       0.002032771725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377598140
  error estimate for blocks of size 2^( 2) =       0.000394622496
  error estimate for blocks of size 2^( 3) =       0.000412050422
  error estimate for blocks of size 2^( 4) =       0.000427264188
  error estimate for blocks of size 2^( 5) =       0.000439255103
  error estimate for blocks of size 2^( 6) =       0.000445632515
  error estimate for blocks of size 2^( 7) =       0.000451475370

      target function =      -0.919083773024
              le_mean =     -16.898674749413
             les_mean =     285.861151205403
             stat err =       0.000440906794
             autocorr =       1.363433276265
   target nu stat err =       0.000440906794
   target dn stat err =       0.002950880200
      target stat err =       0.004649444161
              std dev =       0.534004410885
             le_variance =       0.285160710845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228167716
                                         uncertainty =       0.002032771901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228167716
                                         uncertainty =       0.002032771901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377598138
  error estimate for blocks of size 2^( 2) =       0.000394622493
  error estimate for blocks of size 2^( 3) =       0.000412050419
  error estimate for blocks of size 2^( 4) =       0.000427264184
  error estimate for blocks of size 2^( 5) =       0.000439255100
  error estimate for blocks of size 2^( 6) =       0.000445632512
  error estimate for blocks of size 2^( 7) =       0.000451475368

      target function =      -0.919083812390
              le_mean =     -16.898674749537
             les_mean =     285.861151184278
             stat err =       0.000440906791
             autocorr =       1.363433275108
   target nu stat err =       0.000440906791
   target dn stat err =       0.002950880496
      target stat err =       0.004649445007
              std dev =       0.534004407237
             le_variance =       0.285160706949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228169667
                                         uncertainty =       0.002032771813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228169667
                                         uncertainty =       0.002032771813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377598139
  error estimate for blocks of size 2^( 2) =       0.000394622495
  error estimate for blocks of size 2^( 3) =       0.000412050421
  error estimate for blocks of size 2^( 4) =       0.000427264186
  error estimate for blocks of size 2^( 5) =       0.000439255101
  error estimate for blocks of size 2^( 6) =       0.000445632514
  error estimate for blocks of size 2^( 7) =       0.000451475369

      target function =      -0.919083792710
              le_mean =     -16.898674749475
             les_mean =     285.861151194838
             stat err =       0.000440906793
             autocorr =       1.363433275682
   target nu stat err =       0.000440906793
   target dn stat err =       0.002950880348
      target stat err =       0.004649444584
              std dev =       0.534004409061
             le_variance =       0.285160708896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228171375
                                         uncertainty =       0.002032771736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228171375
                                         uncertainty =       0.002032771736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377598140
  error estimate for blocks of size 2^( 2) =       0.000394622496
  error estimate for blocks of size 2^( 3) =       0.000412050422
  error estimate for blocks of size 2^( 4) =       0.000427264187
  error estimate for blocks of size 2^( 5) =       0.000439255103
  error estimate for blocks of size 2^( 6) =       0.000445632515
  error estimate for blocks of size 2^( 7) =       0.000451475370

      target function =      -0.919083775485
              le_mean =     -16.898674749421
             les_mean =     285.861151204082
             stat err =       0.000440906794
             autocorr =       1.363433276199
   target nu stat err =       0.000440906794
   target dn stat err =       0.002950880219
      target stat err =       0.004649444213
              std dev =       0.534004410657
             le_variance =       0.285160710601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919083773024        initial
     5.2940e+03     5.2940e+04             4.7444e-08        -0.919083812390  <--
     2.1176e+04     2.1176e+05             1.1861e-08        -0.919083792710
     8.4703e+04     8.4703e+05             2.9652e-09        -0.919083775485

*****************************************************************************
Applying the update for shift_i =   5.2940e+03     and shift_s =   5.2940e+04
*****************************************************************************

  Execution time = 2.5878e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933193e-01 3 1  ON 1
ci_0003                -3.122635e-02 3 1  ON 2
ci_0004                -3.036390e-02 3 1  ON 3
ci_0005                -3.057567e-02 3 1  ON 4
ci_0006                -3.070237e-02 3 1  ON 5
ci_0007                -1.389306e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887624e-02 3 1  ON 8
ci_0010                -1.816170e-02 3 1  ON 9
ci_0011                -1.478276e-02 3 1  ON 10
ci_0012                -1.470801e-02 3 1  ON 11
ci_0013                 1.533558e-02 3 1  ON 12
ci_0014                 1.479158e-02 3 1  ON 13
ci_0015                 1.591850e-02 3 1  ON 14
ci_0016                 1.552297e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301484e-02 3 1  ON 18
ci_0020                 1.259844e-02 3 1  ON 19
ci_0021                 7.727088e-03 3 1  ON 20
ci_0022                 8.376051e-03 3 1  ON 21
ci_0023                -1.187679e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043522e-03 3 1  ON 24
ci_0026                -2.789926e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159462e-02 3 1  ON 27
ci_0029                -1.051569e-02 3 1  ON 28
ci_0030                -1.046525e-02 3 1  ON 29
ci_0031                 1.356757e-02 3 1  ON 30
ci_0032                 1.227231e-02 3 1  ON 31
ci_0033                 7.993950e-03 3 1  ON 32
ci_0034                 8.506605e-03 3 1  ON 33
ci_0035                 4.985028e-03 3 1  ON 34
ci_0036                 5.102488e-03 3 1  ON 35
ci_0037                -1.125843e-02 3 1  ON 36
ci_0038                -1.153347e-02 3 1  ON 37
ci_0039                -4.038124e-03 3 1  ON 38
ci_0040                -4.033438e-03 3 1  ON 39
ci_0041                 8.952425e-03 3 1  ON 40
ci_0042                 8.741065e-03 3 1  ON 41
ci_0043                -1.252884e-02 3 1  ON 42
ci_0044                -1.316132e-02 3 1  ON 43
ci_0045                 1.066891e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627576e-03 3 1  ON 46
ci_0048                -3.413505e-03 3 1  ON 47
ci_0049                -2.519600e-03 3 1  ON 48
ci_0050                -2.770571e-03 3 1  ON 49
ci_0051                -1.757619e-03 3 1  ON 50
ci_0052                -2.066478e-03 3 1  ON 51
ci_0053                -3.968897e-03 3 1  ON 52
ci_0054                -3.314371e-03 3 1  ON 53
ci_0055                 2.827865e-03 3 1  ON 54
ci_0056                 2.256320e-03 3 1  ON 55
ci_0057                 2.243750e-03 3 1  ON 56
ci_0058                 3.163405e-03 3 1  ON 57
ci_0059                -3.375162e-03 3 1  ON 58
ci_0060                -3.196963e-03 3 1  ON 59
ci_0061                -3.953642e-03 3 1  ON 60
ci_0062                -4.023318e-03 3 1  ON 61
ci_0063                -9.956924e-03 3 1  ON 62
ci_0064                -9.490783e-03 3 1  ON 63
ci_0065                -6.357493e-03 3 1  ON 64
ci_0066                -6.200229e-03 3 1  ON 65
ci_0067                -3.652581e-03 3 1  ON 66
ci_0068                -3.426370e-03 3 1  ON 67
ci_0069                 3.754550e-03 3 1  ON 68
ci_0070                 3.412125e-03 3 1  ON 69
ci_0071                 2.917851e-03 3 1  ON 70
ci_0072                 3.673964e-03 3 1  ON 71
ci_0073                 3.661301e-03 3 1  ON 72
ci_0074                 3.592632e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3045e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9093
    reference variance = 0.261431
====================================================
  Execution time = 1.4656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9431e-01
  Total weights = 1.951024234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285486269870
                                         uncertainty =       0.001814749037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285486269870
                                         uncertainty =       0.001814749037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377798586
  error estimate for blocks of size 2^( 2) =       0.000394494617
  error estimate for blocks of size 2^( 3) =       0.000411753414
  error estimate for blocks of size 2^( 4) =       0.000426744777
  error estimate for blocks of size 2^( 5) =       0.000440349997
  error estimate for blocks of size 2^( 6) =       0.000447893528
  error estimate for blocks of size 2^( 7) =       0.000451229837

      target function =      -0.921642915925
              le_mean =     -16.898195502680
             les_mean =     285.843316584437
             stat err =       0.000441554535
             autocorr =       1.365991641264
   target nu stat err =       0.000441554535
   target dn stat err =       0.002477664865
      target stat err =       0.003943008177
              std dev =       0.534287884197
             le_variance =       0.285463543200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689819550268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+03, overlap shift 1.3235e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921658339206       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921658366989       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921658371808       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921658372871       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921658373504       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921658373822       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921658373859       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921658373898       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921658373918       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921658373918       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921658373913       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921658373904       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921658373911       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921658373916       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921658373926       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921658373927       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.3235e+03 is 1.291996e-07

solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921658339206       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921658346152       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921658347357       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921658347625       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921658347786       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921658347858       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921658347870       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921658347874       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921658347888       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921658347885       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921658347884       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921658347888       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921658347884       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921658347896       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921658347885       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921658347888       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.2940e+03 is 3.230132e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega -1.7442e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921658339206       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921658340942       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921658341244       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921658341309       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921658341357       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921658341343       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921658341372       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921658341407       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921658341374       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921658341387       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921658341469       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921658341353       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.921658341324       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921658341353       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921658341388       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921658341391       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.1176e+04 is 8.075419e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.306489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7241e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933193e-01 3 1  ON 1
ci_0003                -3.122634e-02 3 1  ON 2
ci_0004                -3.036390e-02 3 1  ON 3
ci_0005                -3.057567e-02 3 1  ON 4
ci_0006                -3.070235e-02 3 1  ON 5
ci_0007                -1.389306e-02 3 1  ON 6
ci_0008                -1.362991e-02 3 1  ON 7
ci_0009                -1.887623e-02 3 1  ON 8
ci_0010                -1.816169e-02 3 1  ON 9
ci_0011                -1.478277e-02 3 1  ON 10
ci_0012                -1.470802e-02 3 1  ON 11
ci_0013                 1.533557e-02 3 1  ON 12
ci_0014                 1.479158e-02 3 1  ON 13
ci_0015                 1.591849e-02 3 1  ON 14
ci_0016                 1.552296e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316887e-02 3 1  ON 17
ci_0019                 1.301485e-02 3 1  ON 18
ci_0020                 1.259844e-02 3 1  ON 19
ci_0021                 7.727076e-03 3 1  ON 20
ci_0022                 8.376038e-03 3 1  ON 21
ci_0023                -1.187679e-02 3 1  ON 22
ci_0024                -1.137882e-02 3 1  ON 23
ci_0025                -2.043532e-03 3 1  ON 24
ci_0026                -2.789907e-03 3 1  ON 25
ci_0027                -1.200438e-02 3 1  ON 26
ci_0028                -1.159462e-02 3 1  ON 27
ci_0029                -1.051568e-02 3 1  ON 28
ci_0030                -1.046525e-02 3 1  ON 29
ci_0031                 1.356756e-02 3 1  ON 30
ci_0032                 1.227231e-02 3 1  ON 31
ci_0033                 7.993939e-03 3 1  ON 32
ci_0034                 8.506587e-03 3 1  ON 33
ci_0035                 4.985054e-03 3 1  ON 34
ci_0036                 5.102486e-03 3 1  ON 35
ci_0037                -1.125842e-02 3 1  ON 36
ci_0038                -1.153346e-02 3 1  ON 37
ci_0039                -4.038120e-03 3 1  ON 38
ci_0040                -4.033434e-03 3 1  ON 39
ci_0041                 8.952429e-03 3 1  ON 40
ci_0042                 8.741064e-03 3 1  ON 41
ci_0043                -1.252886e-02 3 1  ON 42
ci_0044                -1.316134e-02 3 1  ON 43
ci_0045                 1.066890e-02 3 1  ON 44
ci_0046                 1.018362e-02 3 1  ON 45
ci_0047                -3.627570e-03 3 1  ON 46
ci_0048                -3.413503e-03 3 1  ON 47
ci_0049                -2.519584e-03 3 1  ON 48
ci_0050                -2.770562e-03 3 1  ON 49
ci_0051                -1.757607e-03 3 1  ON 50
ci_0052                -2.066468e-03 3 1  ON 51
ci_0053                -3.968897e-03 3 1  ON 52
ci_0054                -3.314368e-03 3 1  ON 53
ci_0055                 2.827867e-03 3 1  ON 54
ci_0056                 2.256310e-03 3 1  ON 55
ci_0057                 2.243751e-03 3 1  ON 56
ci_0058                 3.163373e-03 3 1  ON 57
ci_0059                -3.375161e-03 3 1  ON 58
ci_0060                -3.196973e-03 3 1  ON 59
ci_0061                -3.953637e-03 3 1  ON 60
ci_0062                -4.023303e-03 3 1  ON 61
ci_0063                -9.956925e-03 3 1  ON 62
ci_0064                -9.490787e-03 3 1  ON 63
ci_0065                -6.357500e-03 3 1  ON 64
ci_0066                -6.200237e-03 3 1  ON 65
ci_0067                -3.652582e-03 3 1  ON 66
ci_0068                -3.426373e-03 3 1  ON 67
ci_0069                 3.754537e-03 3 1  ON 68
ci_0070                 3.412121e-03 3 1  ON 69
ci_0071                 2.917842e-03 3 1  ON 70
ci_0072                 3.673945e-03 3 1  ON 71
ci_0073                 3.661303e-03 3 1  ON 72
ci_0074                 3.592620e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8712
    reference variance = 0.179294
====================================================
  Execution time = 1.4265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 2.9531e-01
  Total weights = 1.9509e+06
  Execution time = 1.8971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922436882
                                         uncertainty =       0.002237830192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922436882
                                         uncertainty =       0.002237830192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378085077
  error estimate for blocks of size 2^( 2) =       0.000395045790
  error estimate for blocks of size 2^( 3) =       0.000412718213
  error estimate for blocks of size 2^( 4) =       0.000427996924
  error estimate for blocks of size 2^( 5) =       0.000440286726
  error estimate for blocks of size 2^( 6) =       0.000447213331
  error estimate for blocks of size 2^( 7) =       0.000451893436

      target function =      -0.920072660439
              le_mean =     -16.898098050068
             les_mean =     285.841028617580
             stat err =       0.000441847604
             autocorr =       1.365733422092
   target nu stat err =       0.000441847604
   target dn stat err =       0.002592890763
      target stat err =       0.004105480223
              std dev =       0.534693043259
             le_variance =       0.285896650510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922447897
                                         uncertainty =       0.002237832137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922447897
                                         uncertainty =       0.002237832137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378085084
  error estimate for blocks of size 2^( 2) =       0.000395045799
  error estimate for blocks of size 2^( 3) =       0.000412718222
  error estimate for blocks of size 2^( 4) =       0.000427996932
  error estimate for blocks of size 2^( 5) =       0.000440286736
  error estimate for blocks of size 2^( 6) =       0.000447213338
  error estimate for blocks of size 2^( 7) =       0.000451893445

      target function =      -0.920072691145
              le_mean =     -16.898098049894
             les_mean =     285.841028591915
             stat err =       0.000441847613
             autocorr =       1.365733424667
   target nu stat err =       0.000441847613
   target dn stat err =       0.002592900444
      target stat err =       0.004105495315
              std dev =       0.534693053425
             le_variance =       0.285896661381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922442389
                                         uncertainty =       0.002237831165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922442389
                                         uncertainty =       0.002237831165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378085080
  error estimate for blocks of size 2^( 2) =       0.000395045794
  error estimate for blocks of size 2^( 3) =       0.000412718218
  error estimate for blocks of size 2^( 4) =       0.000427996928
  error estimate for blocks of size 2^( 5) =       0.000440286731
  error estimate for blocks of size 2^( 6) =       0.000447213335
  error estimate for blocks of size 2^( 7) =       0.000451893441

      target function =      -0.920072675913
              le_mean =     -16.898098049981
             les_mean =     285.841028604668
             stat err =       0.000441847609
             autocorr =       1.365733423374
   target nu stat err =       0.000441847609
   target dn stat err =       0.002592895603
      target stat err =       0.004105487770
              std dev =       0.534693048342
             le_variance =       0.285896655945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922437571
                                         uncertainty =       0.002237830314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285922437571
                                         uncertainty =       0.002237830314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378085077
  error estimate for blocks of size 2^( 2) =       0.000395045791
  error estimate for blocks of size 2^( 3) =       0.000412718214
  error estimate for blocks of size 2^( 4) =       0.000427996924
  error estimate for blocks of size 2^( 5) =       0.000440286727
  error estimate for blocks of size 2^( 6) =       0.000447213332
  error estimate for blocks of size 2^( 7) =       0.000451893437

      target function =      -0.920072662387
              le_mean =     -16.898098050057
             les_mean =     285.841028615958
             stat err =       0.000441847605
             autocorr =       1.365733422250
   target nu stat err =       0.000441847605
   target dn stat err =       0.002592891368
      target stat err =       0.004105481167
              std dev =       0.534693043895
             le_variance =       0.285896651189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920072660439        initial
     1.3235e+03     1.3235e+04             1.2920e-07        -0.920072691145  <--
     5.2940e+03     5.2940e+04             3.2301e-08        -0.920072675913
     2.1176e+04     2.1176e+05             8.0754e-09        -0.920072662387

*****************************************************************************
Applying the update for shift_i =   1.3235e+03     and shift_s =   1.3235e+04
*****************************************************************************

  Execution time = 2.3841e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.079780e-01 3 1  ON 0
ci_0002                 6.933194e-01 3 1  ON 1
ci_0003                -3.122630e-02 3 1  ON 2
ci_0004                -3.036388e-02 3 1  ON 3
ci_0005                -3.057567e-02 3 1  ON 4
ci_0006                -3.070230e-02 3 1  ON 5
ci_0007                -1.389308e-02 3 1  ON 6
ci_0008                -1.362992e-02 3 1  ON 7
ci_0009                -1.887619e-02 3 1  ON 8
ci_0010                -1.816167e-02 3 1  ON 9
ci_0011                -1.478278e-02 3 1  ON 10
ci_0012                -1.470802e-02 3 1  ON 11
ci_0013                 1.533554e-02 3 1  ON 12
ci_0014                 1.479157e-02 3 1  ON 13
ci_0015                 1.591847e-02 3 1  ON 14
ci_0016                 1.552294e-02 3 1  ON 15
ci_0017                 1.342855e-02 3 1  ON 16
ci_0018                 1.316885e-02 3 1  ON 17
ci_0019                 1.301488e-02 3 1  ON 18
ci_0020                 1.259843e-02 3 1  ON 19
ci_0021                 7.727039e-03 3 1  ON 20
ci_0022                 8.375999e-03 3 1  ON 21
ci_0023                -1.187680e-02 3 1  ON 22
ci_0024                -1.137883e-02 3 1  ON 23
ci_0025                -2.043564e-03 3 1  ON 24
ci_0026                -2.789847e-03 3 1  ON 25
ci_0027                -1.200439e-02 3 1  ON 26
ci_0028                -1.159463e-02 3 1  ON 27
ci_0029                -1.051565e-02 3 1  ON 28
ci_0030                -1.046525e-02 3 1  ON 29
ci_0031                 1.356754e-02 3 1  ON 30
ci_0032                 1.227231e-02 3 1  ON 31
ci_0033                 7.993906e-03 3 1  ON 32
ci_0034                 8.506531e-03 3 1  ON 33
ci_0035                 4.985131e-03 3 1  ON 34
ci_0036                 5.102479e-03 3 1  ON 35
ci_0037                -1.125841e-02 3 1  ON 36
ci_0038                -1.153342e-02 3 1  ON 37
ci_0039                -4.038109e-03 3 1  ON 38
ci_0040                -4.033425e-03 3 1  ON 39
ci_0041                 8.952440e-03 3 1  ON 40
ci_0042                 8.741061e-03 3 1  ON 41
ci_0043                -1.252890e-02 3 1  ON 42
ci_0044                -1.316139e-02 3 1  ON 43
ci_0045                 1.066887e-02 3 1  ON 44
ci_0046                 1.018361e-02 3 1  ON 45
ci_0047                -3.627552e-03 3 1  ON 46
ci_0048                -3.413498e-03 3 1  ON 47
ci_0049                -2.519539e-03 3 1  ON 48
ci_0050                -2.770533e-03 3 1  ON 49
ci_0051                -1.757573e-03 3 1  ON 50
ci_0052                -2.066438e-03 3 1  ON 51
ci_0053                -3.968896e-03 3 1  ON 52
ci_0054                -3.314361e-03 3 1  ON 53
ci_0055                 2.827874e-03 3 1  ON 54
ci_0056                 2.256278e-03 3 1  ON 55
ci_0057                 2.243754e-03 3 1  ON 56
ci_0058                 3.163276e-03 3 1  ON 57
ci_0059                -3.375157e-03 3 1  ON 58
ci_0060                -3.197002e-03 3 1  ON 59
ci_0061                -3.953623e-03 3 1  ON 60
ci_0062                -4.023260e-03 3 1  ON 61
ci_0063                -9.956930e-03 3 1  ON 62
ci_0064                -9.490800e-03 3 1  ON 63
ci_0065                -6.357519e-03 3 1  ON 64
ci_0066                -6.200259e-03 3 1  ON 65
ci_0067                -3.652584e-03 3 1  ON 66
ci_0068                -3.426384e-03 3 1  ON 67
ci_0069                 3.754496e-03 3 1  ON 68
ci_0070                 3.412111e-03 3 1  ON 69
ci_0071                 2.917816e-03 3 1  ON 70
ci_0072                 3.673890e-03 3 1  ON 71
ci_0073                 3.661308e-03 3 1  ON 72
ci_0074                 3.592584e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1087e+01 secs
  Total Execution time = 4.1725e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
