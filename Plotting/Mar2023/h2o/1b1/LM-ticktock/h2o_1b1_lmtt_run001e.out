Rank =    0  Free Memory = 71114 MB
Rank =    1  Free Memory = 71114 MB
Rank =    2  Free Memory = 71114 MB
Rank =    3  Free Memory = 71114 MB
Rank =    4  Free Memory = 71114 MB
Rank =    5  Free Memory = 71113 MB
Rank =    6  Free Memory = 71113 MB
Rank =    7  Free Memory = 71112 MB
Rank =    8  Free Memory = 71112 MB
Rank =    9  Free Memory = 71111 MB
Rank =   10  Free Memory = 71111 MB
Rank =   11  Free Memory = 71111 MB
Rank =   12  Free Memory = 71110 MB
Rank =   13  Free Memory = 71110 MB
Rank =   14  Free Memory = 71110 MB
Rank =   15  Free Memory = 71097 MB
Rank =   16  Free Memory = 71097 MB
Rank =   17  Free Memory = 71097 MB
Rank =   18  Free Memory = 71097 MB
Rank =   19  Free Memory = 71097 MB
Rank =   20  Free Memory = 71097 MB
Rank =   21  Free Memory = 71097 MB
Rank =   22  Free Memory = 71097 MB
Rank =   23  Free Memory = 71097 MB
Rank =   24  Free Memory = 71097 MB
Rank =   25  Free Memory = 71097 MB
Rank =   26  Free Memory = 71097 MB
Rank =   27  Free Memory = 71097 MB
Rank =   28  Free Memory = 71097 MB
Rank =   29  Free Memory = 71097 MB
Rank =   30  Free Memory = 71097 MB
Rank =   31  Free Memory = 71097 MB
Rank =   32  Free Memory = 73148 MB
Rank =   33  Free Memory = 73148 MB
Rank =   34  Free Memory = 73148 MB
Rank =   35  Free Memory = 73148 MB
Rank =   36  Free Memory = 73148 MB
Rank =   37  Free Memory = 73148 MB
Rank =   38  Free Memory = 73148 MB
Rank =   39  Free Memory = 73148 MB
Rank =   40  Free Memory = 73148 MB
Rank =   41  Free Memory = 73148 MB
Rank =   42  Free Memory = 73148 MB
Rank =   43  Free Memory = 73148 MB
Rank =   44  Free Memory = 73148 MB
Rank =   45  Free Memory = 73148 MB
Rank =   46  Free Memory = 73148 MB
Rank =   47  Free Memory = 73148 MB
Rank =   48  Free Memory = 73148 MB
Rank =   49  Free Memory = 73148 MB
Rank =   50  Free Memory = 73148 MB
Rank =   51  Free Memory = 73148 MB
Rank =   52  Free Memory = 73148 MB
Rank =   53  Free Memory = 73148 MB
Rank =   54  Free Memory = 73148 MB
Rank =   55  Free Memory = 73148 MB
Rank =   56  Free Memory = 73148 MB
Rank =   57  Free Memory = 73148 MB
Rank =   58  Free Memory = 73148 MB
Rank =   59  Free Memory = 73148 MB
Rank =   60  Free Memory = 73148 MB
Rank =   61  Free Memory = 73148 MB
Rank =   62  Free Memory = 73148 MB
Rank =   63  Free Memory = 73148 MB
Rank =   64  Free Memory = 89732 MB
Rank =   65  Free Memory = 89732 MB
Rank =   66  Free Memory = 89732 MB
Rank =   67  Free Memory = 89732 MB
Rank =   68  Free Memory = 89732 MB
Rank =   69  Free Memory = 89732 MB
Rank =   70  Free Memory = 89732 MB
Rank =   71  Free Memory = 89732 MB
Rank =   72  Free Memory = 89732 MB
Rank =   73  Free Memory = 89732 MB
Rank =   74  Free Memory = 89732 MB
Rank =   75  Free Memory = 89732 MB
Rank =   76  Free Memory = 89732 MB
Rank =   77  Free Memory = 89732 MB
Rank =   78  Free Memory = 89732 MB
Rank =   79  Free Memory = 89732 MB
Rank =   80  Free Memory = 89732 MB
Rank =   81  Free Memory = 89732 MB
Rank =   82  Free Memory = 89732 MB
Rank =   83  Free Memory = 89732 MB
Rank =   84  Free Memory = 89732 MB
Rank =   85  Free Memory = 89732 MB
Rank =   86  Free Memory = 89732 MB
Rank =   87  Free Memory = 89732 MB
Rank =   88  Free Memory = 89732 MB
Rank =   89  Free Memory = 89732 MB
Rank =   90  Free Memory = 89732 MB
Rank =   91  Free Memory = 89732 MB
Rank =   92  Free Memory = 89732 MB
Rank =   93  Free Memory = 89732 MB
Rank =   94  Free Memory = 89732 MB
Rank =   95  Free Memory = 89732 MB
Rank =   96  Free Memory = 62988 MB
Rank =   97  Free Memory = 62988 MB
Rank =   98  Free Memory = 62988 MB
Rank =   99  Free Memory = 62988 MB
Rank =  100  Free Memory = 62988 MB
Rank =  101  Free Memory = 62987 MB
Rank =  102  Free Memory = 62987 MB
Rank =  103  Free Memory = 62987 MB
Rank =  104  Free Memory = 62987 MB
Rank =  105  Free Memory = 62987 MB
Rank =  106  Free Memory = 62987 MB
Rank =  107  Free Memory = 62987 MB
Rank =  108  Free Memory = 62987 MB
Rank =  109  Free Memory = 62987 MB
Rank =  110  Free Memory = 62987 MB
Rank =  111  Free Memory = 62987 MB
Rank =  112  Free Memory = 62987 MB
Rank =  113  Free Memory = 62987 MB
Rank =  114  Free Memory = 62987 MB
Rank =  115  Free Memory = 62987 MB
Rank =  116  Free Memory = 62987 MB
Rank =  117  Free Memory = 62987 MB
Rank =  118  Free Memory = 62987 MB
Rank =  119  Free Memory = 62987 MB
Rank =  120  Free Memory = 62987 MB
Rank =  121  Free Memory = 62987 MB
Rank =  122  Free Memory = 62987 MB
Rank =  123  Free Memory = 62987 MB
Rank =  124  Free Memory = 62987 MB
Rank =  125  Free Memory = 62987 MB
Rank =  126  Free Memory = 62987 MB
Rank =  127  Free Memory = 62987 MB
  Input file(s): opt_h2o_1b1_lmtt_run001e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmtt_run001e.xml

  Project = H2O
  date    = 2023-03-06 10:43:49 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 101

  Range of prime numbers to use as seeds over processors and threads = 563-1453


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.942481e-01    1         1 OFF
     uu_1                 1.270412e-01    1         1 OFF
     uu_2                 2.528026e-02    1         1 OFF
     uu_3                -3.753264e-02    1         1 OFF
     uu_4                -8.372467e-02    1         1 OFF
     uu_5                -1.196959e-01    1         1 OFF
     uu_6                -1.485198e-01    1         1 OFF
     uu_7                -1.637823e-01    1         1 OFF
     uu_8                -1.562092e-01    1         1 OFF
     uu_9                -1.292149e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.555331e-01    1         1 OFF
     ud_1                 1.901366e-01    1         1 OFF
     ud_2                 7.057246e-02    1         1 OFF
     ud_3                -3.332269e-04    1         1 OFF
     ud_4                -5.810219e-02    1         1 OFF
     ud_5                -1.007342e-01    1         1 OFF
     ud_6                -1.296202e-01    1         1 OFF
     ud_7                -1.478016e-01    1         1 OFF
     ud_8                -1.501945e-01    1         1 OFF
     ud_9                -1.418084e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.054643e-01    1         1 OFF
     eO_1                -3.855099e-01    1         1 OFF
     eO_2                 2.827987e-02    1         1 OFF
     eO_3                 3.439425e-01    1         1 OFF
     eO_4                 5.684037e-01    1         1 OFF
     eO_5                 5.255973e-01    1         1 OFF
     eO_6                 2.820607e-01    1         1 OFF
     eO_7                -6.503643e-02    1         1 OFF
     eO_8                -3.287143e-01    1         1 OFF
     eO_9                -2.252435e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.921668e-01    1         1 OFF
     eH1_1                -1.886546e-01    1         1 OFF
     eH1_2                -1.402081e-01    1         1 OFF
     eH1_3                -8.504652e-02    1         1 OFF
     eH1_4                -3.489092e-02    1         1 OFF
     eH1_5                 4.648488e-03    1         1 OFF
     eH1_6                 7.311275e-02    1         1 OFF
     eH1_7                 1.571238e-01    1         1 OFF
     eH1_8                 2.279282e-01    1         1 OFF
     eH1_9                 2.110868e-01    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.902169e-01    1         1 OFF
     eH2_1                -1.870564e-01    1         1 OFF
     eH2_2                -1.384916e-01    1         1 OFF
     eH2_3                -8.317207e-02    1         1 OFF
     eH2_4                -3.312963e-02    1         1 OFF
     eH2_5                 5.737123e-03    1         1 OFF
     eH2_6                 7.505429e-02    1         1 OFF
     eH2_7                 1.571223e-01    1         1 OFF
     eH2_8                 2.244125e-01    1         1 OFF
     eH2_9                 2.362982e-01    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.931956e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.9006e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9779
    reference variance = 0.192148
====================================================
  Execution time = 1.5234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3487e-01
  Total weights = 1.951440588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322127789304
                                         uncertainty =       0.002005346232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322127789304
                                         uncertainty =       0.002005346232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401298072
  error estimate for blocks of size 2^( 2) =       0.000414512681
  error estimate for blocks of size 2^( 3) =       0.000428314567
  error estimate for blocks of size 2^( 4) =       0.000441013146
  error estimate for blocks of size 2^( 5) =       0.000453174956
  error estimate for blocks of size 2^( 6) =       0.000462978402
  error estimate for blocks of size 2^( 7) =       0.000467275875

      target function =                  N/A
              le_mean =     -16.906595706885
             les_mean =     286.167849721130
             stat err =       0.000456110595
             autocorr =       1.291832404168
              std dev =       0.567521176268
             le_variance =       0.322080285512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690659570689e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906595706882       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906613761342       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906613425124       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906613222692       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.107991e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906595706882       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602398445       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602012182       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906601949218       residual = 3.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 3.617236e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906595706882       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906597609259       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906597482546       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906597460395       residual = 1.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 9.788470e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7853e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.012918e-01                 3 1 ON  0
ci_0002 7.003622e-01                 3 1 ON  1
ci_0003 -2.806774e-02                3 1 ON  2
ci_0004 -2.818908e-02                3 1 ON  3
ci_0005 -3.382165e-02                3 1 ON  4
ci_0006 -3.438132e-02                3 1 ON  5
ci_0007 -2.247922e-02                3 1 ON  6
ci_0008 -2.251595e-02                3 1 ON  7
ci_0009 -1.770121e-02                3 1 ON  8
ci_0010 -1.797776e-02                3 1 ON  9
ci_0011 -1.248188e-02                3 1 ON  10
ci_0012 -1.263995e-02                3 1 ON  11
ci_0013 1.336770e-02                 3 1 ON  12
ci_0014 1.337104e-02                 3 1 ON  13
ci_0015 1.365810e-02                 3 1 ON  14
ci_0016 1.329139e-02                 3 1 ON  15
ci_0017 1.161443e-02                 3 1 ON  16
ci_0018 1.158613e-02                 3 1 ON  17
ci_0019 1.177167e-02                 3 1 ON  18
ci_0020 1.183584e-02                 3 1 ON  19
ci_0021 1.988781e-03                 3 1 ON  20
ci_0022 2.931471e-03                 3 1 ON  21
ci_0023 -1.180293e-02                3 1 ON  22
ci_0024 -1.112305e-02                3 1 ON  23
ci_0025 -1.116343e-02                3 1 ON  24
ci_0026 -1.119019e-02                3 1 ON  25
ci_0027 -1.110723e-02                3 1 ON  26
ci_0028 -1.112350e-02                3 1 ON  27
ci_0029 -1.083710e-02                3 1 ON  28
ci_0030 -1.007116e-02                3 1 ON  29
ci_0031 1.952574e-02                 3 1 ON  30
ci_0032 1.978606e-02                 3 1 ON  31
ci_0033 9.848722e-03                 3 1 ON  32
ci_0034 9.984457e-03                 3 1 ON  33
ci_0035 7.583461e-03                 3 1 ON  34
ci_0036 6.843888e-03                 3 1 ON  35
ci_0037 -1.070479e-02                3 1 ON  36
ci_0038 -1.094338e-02                3 1 ON  37
ci_0039 -2.773145e-03                3 1 ON  38
ci_0040 -3.040158e-03                3 1 ON  39
ci_0041 7.370372e-03                 3 1 ON  40
ci_0042 7.458937e-03                 3 1 ON  41
ci_0043 -1.526489e-02                3 1 ON  42
ci_0044 -1.601029e-02                3 1 ON  43
ci_0045 8.010396e-03                 3 1 ON  44
ci_0046 7.244086e-03                 3 1 ON  45
ci_0047 -2.102563e-03                3 1 ON  46
ci_0048 -2.193965e-03                3 1 ON  47
ci_0049 -5.627881e-03                3 1 ON  48
ci_0050 -5.584069e-03                3 1 ON  49
ci_0051 -3.555224e-03                3 1 ON  50
ci_0052 -3.198061e-03                3 1 ON  51
ci_0053 -5.174393e-03                3 1 ON  52
ci_0054 -5.016690e-03                3 1 ON  53
ci_0055 5.875012e-03                 3 1 ON  54
ci_0056 6.564863e-03                 3 1 ON  55
ci_0057 4.684659e-03                 3 1 ON  56
ci_0058 5.252180e-03                 3 1 ON  57
ci_0059 -5.070947e-03                3 1 ON  58
ci_0060 -4.833958e-03                3 1 ON  59
ci_0061 -3.820358e-03                3 1 ON  60
ci_0062 -3.321419e-03                3 1 ON  61
ci_0063 -8.752729e-03                3 1 ON  62
ci_0064 -8.889565e-03                3 1 ON  63
ci_0065 -5.497946e-03                3 1 ON  64
ci_0066 -5.017644e-03                3 1 ON  65
ci_0067 -5.260129e-03                3 1 ON  66
ci_0068 -5.351095e-03                3 1 ON  67
ci_0069 4.866120e-03                 3 1 ON  68
ci_0070 4.609686e-03                 3 1 ON  69
ci_0071 2.067298e-03                 3 1 ON  70
ci_0072 1.781466e-03                 3 1 ON  71
ci_0073 4.502090e-03                 3 1 ON  72
ci_0074 4.139260e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.320525
====================================================
  Execution time = 1.4184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3796e-01
  Total weights = 1.9520e+06
  Execution time = 1.8860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325741102822
                                         uncertainty =       0.002345591441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325741102822
                                         uncertainty =       0.002345591441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403549182
  error estimate for blocks of size 2^( 2) =       0.000416551197
  error estimate for blocks of size 2^( 3) =       0.000430534899
  error estimate for blocks of size 2^( 4) =       0.000442890513
  error estimate for blocks of size 2^( 5) =       0.000454011964
  error estimate for blocks of size 2^( 6) =       0.000463656807
  error estimate for blocks of size 2^( 7) =       0.000468426888

      target function =                  N/A
              le_mean =     -16.906367587810
             les_mean =     286.178061772127
             stat err =       0.000457246543
             autocorr =       1.283831180482
              std dev =       0.570704726188
             le_variance =       0.325703884494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119589915
                                         uncertainty =       0.002378797347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119589915
                                         uncertainty =       0.002378797347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403785713
  error estimate for blocks of size 2^( 2) =       0.000416799704
  error estimate for blocks of size 2^( 3) =       0.000430771476
  error estimate for blocks of size 2^( 4) =       0.000443117795
  error estimate for blocks of size 2^( 5) =       0.000454226325
  error estimate for blocks of size 2^( 6) =       0.000463870766
  error estimate for blocks of size 2^( 7) =       0.000468600173

      target function =                  N/A
              le_mean =     -16.906351405677
             les_mean =     286.167172579521
             stat err =       0.000457453765
             autocorr =       1.283490076377
              std dev =       0.571039231723
             le_variance =       0.326085804167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797662967
                                         uncertainty =       0.002335090072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797662967
                                         uncertainty =       0.002335090072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403586192
  error estimate for blocks of size 2^( 2) =       0.000416602396
  error estimate for blocks of size 2^( 3) =       0.000430589617
  error estimate for blocks of size 2^( 4) =       0.000442943636
  error estimate for blocks of size 2^( 5) =       0.000454050162
  error estimate for blocks of size 2^( 6) =       0.000463681236
  error estimate for blocks of size 2^( 7) =       0.000468416749

      target function =                  N/A
              le_mean =     -16.906355430891
             les_mean =     286.164267093952
             stat err =       0.000457272946
             autocorr =       1.283743969434
              std dev =       0.570757066535
             le_variance =       0.325763629000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325730498439
                                         uncertainty =       0.002342624929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325730498439
                                         uncertainty =       0.002342624929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403542881
  error estimate for blocks of size 2^( 2) =       0.000416547139
  error estimate for blocks of size 2^( 3) =       0.000430532025
  error estimate for blocks of size 2^( 4) =       0.000442888007
  error estimate for blocks of size 2^( 5) =       0.000454008325
  error estimate for blocks of size 2^( 6) =       0.000463648336
  error estimate for blocks of size 2^( 7) =       0.000468413137

      target function =                  N/A
              le_mean =     -16.906363964931
             les_mean =     286.230286128796
             stat err =       0.000457239451
             autocorr =       1.283831447970
              std dev =       0.570695814975
             le_variance =       0.325693713230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906367587810        initial  <--
     2.5000e-01     2.5000e+00             1.1080e-03       -16.906351405677
     1.0000e+00     1.0000e+01             3.6172e-04       -16.906355430891
     4.0000e+00     4.0000e+01             9.7885e-05       -16.906363964931

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6800
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6961e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8553
    reference variance = 0.222831
====================================================
  Execution time = 1.4615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3557e-01
  Total weights = 1.951402667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320834481394
                                         uncertainty =       0.003203755854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320834481394
                                         uncertainty =       0.003203755854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400506519
  error estimate for blocks of size 2^( 2) =       0.000413360274
  error estimate for blocks of size 2^( 3) =       0.000426076748
  error estimate for blocks of size 2^( 4) =       0.000438304653
  error estimate for blocks of size 2^( 5) =       0.000449133852
  error estimate for blocks of size 2^( 6) =       0.000456679484
  error estimate for blocks of size 2^( 7) =       0.000462198814

      target function =                  N/A
              le_mean =     -16.906303895780
             les_mean =     286.158679809718
             stat err =       0.000451579201
             autocorr =       1.271301856457
              std dev =       0.566401751598
             le_variance =       0.320810944213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630389578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303895769       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906306224497       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906306274457       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906306275675       residual = 4.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.667081e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303895769       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304514549       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906304515995       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906304515427       residual = 6.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 4.506506e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303895769       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304052934       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906304052536       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906304052271       residual = 7.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+01 is 1.149994e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.004934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7201e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.011995e-01 3 1  ON 0
ci_0002                 7.004593e-01 3 1  ON 1
ci_0003                -2.803176e-02 3 1  ON 2
ci_0004                -2.833719e-02 3 1  ON 3
ci_0005                -3.385348e-02 3 1  ON 4
ci_0006                -3.434776e-02 3 1  ON 5
ci_0007                -2.242293e-02 3 1  ON 6
ci_0008                -2.248536e-02 3 1  ON 7
ci_0009                -1.780348e-02 3 1  ON 8
ci_0010                -1.796197e-02 3 1  ON 9
ci_0011                -1.250608e-02 3 1  ON 10
ci_0012                -1.265723e-02 3 1  ON 11
ci_0013                 1.335208e-02 3 1  ON 12
ci_0014                 1.351183e-02 3 1  ON 13
ci_0015                 1.366897e-02 3 1  ON 14
ci_0016                 1.313120e-02 3 1  ON 15
ci_0017                 1.169112e-02 3 1  ON 16
ci_0018                 1.179206e-02 3 1  ON 17
ci_0019                 1.190326e-02 3 1  ON 18
ci_0020                 1.192596e-02 3 1  ON 19
ci_0021                 1.915366e-03 3 1  ON 20
ci_0022                 3.142934e-03 3 1  ON 21
ci_0023                -1.187203e-02 3 1  ON 22
ci_0024                -1.116800e-02 3 1  ON 23
ci_0025                -1.137605e-02 3 1  ON 24
ci_0026                -1.121306e-02 3 1  ON 25
ci_0027                -1.121799e-02 3 1  ON 26
ci_0028                -1.110625e-02 3 1  ON 27
ci_0029                -1.077334e-02 3 1  ON 28
ci_0030                -1.015288e-02 3 1  ON 29
ci_0031                 1.936112e-02 3 1  ON 30
ci_0032                 1.971200e-02 3 1  ON 31
ci_0033                 9.456497e-03 3 1  ON 32
ci_0034                 9.920509e-03 3 1  ON 33
ci_0035                 7.413931e-03 3 1  ON 34
ci_0036                 6.823854e-03 3 1  ON 35
ci_0037                -1.084486e-02 3 1  ON 36
ci_0038                -1.073606e-02 3 1  ON 37
ci_0039                -2.776296e-03 3 1  ON 38
ci_0040                -3.038075e-03 3 1  ON 39
ci_0041                 7.348471e-03 3 1  ON 40
ci_0042                 7.424105e-03 3 1  ON 41
ci_0043                -1.498206e-02 3 1  ON 42
ci_0044                -1.567845e-02 3 1  ON 43
ci_0045                 8.052030e-03 3 1  ON 44
ci_0046                 7.462187e-03 3 1  ON 45
ci_0047                -2.210179e-03 3 1  ON 46
ci_0048                -2.285848e-03 3 1  ON 47
ci_0049                -5.406963e-03 3 1  ON 48
ci_0050                -5.437922e-03 3 1  ON 49
ci_0051                -3.545314e-03 3 1  ON 50
ci_0052                -3.081880e-03 3 1  ON 51
ci_0053                -5.131587e-03 3 1  ON 52
ci_0054                -4.998583e-03 3 1  ON 53
ci_0055                 5.897956e-03 3 1  ON 54
ci_0056                 6.301509e-03 3 1  ON 55
ci_0057                 4.625807e-03 3 1  ON 56
ci_0058                 5.201520e-03 3 1  ON 57
ci_0059                -5.184739e-03 3 1  ON 58
ci_0060                -4.956991e-03 3 1  ON 59
ci_0061                -3.793237e-03 3 1  ON 60
ci_0062                -3.104180e-03 3 1  ON 61
ci_0063                -8.674378e-03 3 1  ON 62
ci_0064                -9.095705e-03 3 1  ON 63
ci_0065                -5.694643e-03 3 1  ON 64
ci_0066                -4.933140e-03 3 1  ON 65
ci_0067                -5.426008e-03 3 1  ON 66
ci_0068                -5.447958e-03 3 1  ON 67
ci_0069                 5.010308e-03 3 1  ON 68
ci_0070                 4.705014e-03 3 1  ON 69
ci_0071                 2.313579e-03 3 1  ON 70
ci_0072                 1.758495e-03 3 1  ON 71
ci_0073                 4.429143e-03 3 1  ON 72
ci_0074                 4.194295e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9754
    reference variance = 0.279377
====================================================
  Execution time = 1.4116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3460e-01
  Total weights = 1.9518e+06
  Execution time = 1.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321936103246
                                         uncertainty =       0.001969289242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321936103246
                                         uncertainty =       0.001969289242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401182011
  error estimate for blocks of size 2^( 2) =       0.000414081739
  error estimate for blocks of size 2^( 3) =       0.000427106290
  error estimate for blocks of size 2^( 4) =       0.000438930159
  error estimate for blocks of size 2^( 5) =       0.000448411948
  error estimate for blocks of size 2^( 6) =       0.000454716145
  error estimate for blocks of size 2^( 7) =       0.000457842292

      target function =                  N/A
              le_mean =     -16.906415402711
             les_mean =     286.164047262306
             stat err =       0.000449975136
             autocorr =       1.258039080968
              std dev =       0.567357040240
             le_variance =       0.321894011110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321922627606
                                         uncertainty =       0.001970781997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321922627606
                                         uncertainty =       0.001970781997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401173608
  error estimate for blocks of size 2^( 2) =       0.000414074564
  error estimate for blocks of size 2^( 3) =       0.000427102445
  error estimate for blocks of size 2^( 4) =       0.000438934297
  error estimate for blocks of size 2^( 5) =       0.000448417832
  error estimate for blocks of size 2^( 6) =       0.000454720071
  error estimate for blocks of size 2^( 7) =       0.000457846305

      target function =                  N/A
              le_mean =     -16.906417901210
             les_mean =     286.161656911538
             stat err =       0.000449979626
             autocorr =       1.258116890047
              std dev =       0.567345156965
             le_variance =       0.321880527132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926786491
                                         uncertainty =       0.001970030085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926786491
                                         uncertainty =       0.001970030085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401176203
  error estimate for blocks of size 2^( 2) =       0.000414076562
  error estimate for blocks of size 2^( 3) =       0.000427102905
  error estimate for blocks of size 2^( 4) =       0.000438931176
  error estimate for blocks of size 2^( 5) =       0.000448414225
  error estimate for blocks of size 2^( 6) =       0.000454717350
  error estimate for blocks of size 2^( 7) =       0.000457843792

      target function =                  N/A
              le_mean =     -16.906416470329
             les_mean =     286.161512262359
             stat err =       0.000449976636
             autocorr =       1.258083893411
              std dev =       0.567348826514
             le_variance =       0.321884690947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321934672164
                                         uncertainty =       0.001969371957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321934672164
                                         uncertainty =       0.001969371957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401181119
  error estimate for blocks of size 2^( 2) =       0.000414080931
  error estimate for blocks of size 2^( 3) =       0.000427105688
  error estimate for blocks of size 2^( 4) =       0.000438930281
  error estimate for blocks of size 2^( 5) =       0.000448412821
  error estimate for blocks of size 2^( 6) =       0.000454716851
  error estimate for blocks of size 2^( 7) =       0.000457843383

      target function =                  N/A
              le_mean =     -16.906415422702
             les_mean =     286.161541700673
             stat err =       0.000449975834
             autocorr =       1.258048578975
              std dev =       0.567355778789
             le_variance =       0.321892579725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906415402711        initial
     2.5000e+00     2.5000e+01             1.6671e-04       -16.906417901210  <--
     1.0000e+01     1.0000e+02             4.5065e-05       -16.906416470329
     4.0000e+01     4.0000e+02             1.1500e-05       -16.906415422702

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3583e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801964e-02 3 1  ON 2
ci_0004                -2.824585e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440047e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248317e-02 3 1  ON 7
ci_0009                -1.779363e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242630e-02 3 1  ON 10
ci_0012                -1.269247e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349906e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308730e-02 3 1  ON 15
ci_0017                 1.160060e-02 3 1  ON 16
ci_0018                 1.175206e-02 3 1  ON 17
ci_0019                 1.188120e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940128e-03 3 1  ON 20
ci_0022                 3.071029e-03 3 1  ON 21
ci_0023                -1.177503e-02 3 1  ON 22
ci_0024                -1.107954e-02 3 1  ON 23
ci_0025                -1.134786e-02 3 1  ON 24
ci_0026                -1.126004e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102651e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022850e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976894e-02 3 1  ON 31
ci_0033                 9.368792e-03 3 1  ON 32
ci_0034                 1.000576e-02 3 1  ON 33
ci_0035                 7.396734e-03 3 1  ON 34
ci_0036                 6.855891e-03 3 1  ON 35
ci_0037                -1.089287e-02 3 1  ON 36
ci_0038                -1.066174e-02 3 1  ON 37
ci_0039                -2.823305e-03 3 1  ON 38
ci_0040                -2.965292e-03 3 1  ON 39
ci_0041                 7.307041e-03 3 1  ON 40
ci_0042                 7.398048e-03 3 1  ON 41
ci_0043                -1.504572e-02 3 1  ON 42
ci_0044                -1.572257e-02 3 1  ON 43
ci_0045                 8.068196e-03 3 1  ON 44
ci_0046                 7.490856e-03 3 1  ON 45
ci_0047                -2.192962e-03 3 1  ON 46
ci_0048                -2.227264e-03 3 1  ON 47
ci_0049                -5.375774e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523473e-03 3 1  ON 50
ci_0052                -3.135384e-03 3 1  ON 51
ci_0053                -5.126524e-03 3 1  ON 52
ci_0054                -4.939516e-03 3 1  ON 53
ci_0055                 5.929689e-03 3 1  ON 54
ci_0056                 6.353378e-03 3 1  ON 55
ci_0057                 4.662075e-03 3 1  ON 56
ci_0058                 5.180958e-03 3 1  ON 57
ci_0059                -5.145778e-03 3 1  ON 58
ci_0060                -4.987336e-03 3 1  ON 59
ci_0061                -3.815083e-03 3 1  ON 60
ci_0062                -3.100744e-03 3 1  ON 61
ci_0063                -8.643958e-03 3 1  ON 62
ci_0064                -9.217348e-03 3 1  ON 63
ci_0065                -5.728111e-03 3 1  ON 64
ci_0066                -5.047851e-03 3 1  ON 65
ci_0067                -5.383616e-03 3 1  ON 66
ci_0068                -5.457297e-03 3 1  ON 67
ci_0069                 4.998278e-03 3 1  ON 68
ci_0070                 4.769827e-03 3 1  ON 69
ci_0071                 2.244049e-03 3 1  ON 70
ci_0072                 1.743420e-03 3 1  ON 71
ci_0073                 4.313088e-03 3 1  ON 72
ci_0074                 4.192366e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0790e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6938e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8611
    reference variance = 0.553243
====================================================
  Execution time = 1.4498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4396e-01
  Total weights = 1.952259408e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330486385386
                                         uncertainty =       0.004638558141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330486385386
                                         uncertainty =       0.004638558141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406490129
  error estimate for blocks of size 2^( 2) =       0.000419227622
  error estimate for blocks of size 2^( 3) =       0.000431598193
  error estimate for blocks of size 2^( 4) =       0.000443323440
  error estimate for blocks of size 2^( 5) =       0.000452922456
  error estimate for blocks of size 2^( 6) =       0.000460198636
  error estimate for blocks of size 2^( 7) =       0.000464900252

      target function =                  N/A
              le_mean =     -16.906348456815
             les_mean =     286.168576898068
             stat err =       0.000455336196
             autocorr =       1.254770623112
              std dev =       0.574863853471
             le_variance =       0.330468450028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634845682e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906348456801       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361078445       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906360985369       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361014942       residual = 4.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 4.328627e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906348456801       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906352411460       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906352388781       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906352386816       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.240596e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906348456801       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906349512304       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906349509021       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906349507757       residual = 2.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 3.219177e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7110e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.011643e-01 3 1  ON 0
ci_0002                 7.004968e-01 3 1  ON 1
ci_0003                -2.793854e-02 3 1  ON 2
ci_0004                -2.823422e-02 3 1  ON 3
ci_0005                -3.400055e-02 3 1  ON 4
ci_0006                -3.452453e-02 3 1  ON 5
ci_0007                -2.239414e-02 3 1  ON 6
ci_0008                -2.252690e-02 3 1  ON 7
ci_0009                -1.782072e-02 3 1  ON 8
ci_0010                -1.788318e-02 3 1  ON 9
ci_0011                -1.245834e-02 3 1  ON 10
ci_0012                -1.266243e-02 3 1  ON 11
ci_0013                 1.332318e-02 3 1  ON 12
ci_0014                 1.338591e-02 3 1  ON 13
ci_0015                 1.361429e-02 3 1  ON 14
ci_0016                 1.317329e-02 3 1  ON 15
ci_0017                 1.160069e-02 3 1  ON 16
ci_0018                 1.171464e-02 3 1  ON 17
ci_0019                 1.188974e-02 3 1  ON 18
ci_0020                 1.194890e-02 3 1  ON 19
ci_0021                 1.877363e-03 3 1  ON 20
ci_0022                 2.976157e-03 3 1  ON 21
ci_0023                -1.173436e-02 3 1  ON 22
ci_0024                -1.109132e-02 3 1  ON 23
ci_0025                -1.128324e-02 3 1  ON 24
ci_0026                -1.119011e-02 3 1  ON 25
ci_0027                -1.119882e-02 3 1  ON 26
ci_0028                -1.105682e-02 3 1  ON 27
ci_0029                -1.089149e-02 3 1  ON 28
ci_0030                -1.020030e-02 3 1  ON 29
ci_0031                 1.940545e-02 3 1  ON 30
ci_0032                 1.979911e-02 3 1  ON 31
ci_0033                 9.369869e-03 3 1  ON 32
ci_0034                 1.008662e-02 3 1  ON 33
ci_0035                 7.361678e-03 3 1  ON 34
ci_0036                 6.814734e-03 3 1  ON 35
ci_0037                -1.080049e-02 3 1  ON 36
ci_0038                -1.067541e-02 3 1  ON 37
ci_0039                -2.759528e-03 3 1  ON 38
ci_0040                -2.932344e-03 3 1  ON 39
ci_0041                 7.298528e-03 3 1  ON 40
ci_0042                 7.458798e-03 3 1  ON 41
ci_0043                -1.511069e-02 3 1  ON 42
ci_0044                -1.575044e-02 3 1  ON 43
ci_0045                 8.059398e-03 3 1  ON 44
ci_0046                 7.516303e-03 3 1  ON 45
ci_0047                -2.080155e-03 3 1  ON 46
ci_0048                -2.119595e-03 3 1  ON 47
ci_0049                -5.331787e-03 3 1  ON 48
ci_0050                -5.362135e-03 3 1  ON 49
ci_0051                -3.518126e-03 3 1  ON 50
ci_0052                -3.142947e-03 3 1  ON 51
ci_0053                -5.101963e-03 3 1  ON 52
ci_0054                -4.917144e-03 3 1  ON 53
ci_0055                 5.866629e-03 3 1  ON 54
ci_0056                 6.360224e-03 3 1  ON 55
ci_0057                 4.695742e-03 3 1  ON 56
ci_0058                 5.186097e-03 3 1  ON 57
ci_0059                -5.104379e-03 3 1  ON 58
ci_0060                -4.970269e-03 3 1  ON 59
ci_0061                -3.758722e-03 3 1  ON 60
ci_0062                -3.212940e-03 3 1  ON 61
ci_0063                -8.577267e-03 3 1  ON 62
ci_0064                -9.180505e-03 3 1  ON 63
ci_0065                -5.749866e-03 3 1  ON 64
ci_0066                -5.108082e-03 3 1  ON 65
ci_0067                -5.284069e-03 3 1  ON 66
ci_0068                -5.370285e-03 3 1  ON 67
ci_0069                 4.940637e-03 3 1  ON 68
ci_0070                 4.700981e-03 3 1  ON 69
ci_0071                 2.229456e-03 3 1  ON 70
ci_0072                 1.668159e-03 3 1  ON 71
ci_0073                 4.284068e-03 3 1  ON 72
ci_0074                 4.221640e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8108
    reference variance = 0.302929
====================================================
  Execution time = 1.4189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3986e-01
  Total weights = 1.9520e+06
  Execution time = 1.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321476245333
                                         uncertainty =       0.001767666600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321476245333
                                         uncertainty =       0.001767666600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400924359
  error estimate for blocks of size 2^( 2) =       0.000413656487
  error estimate for blocks of size 2^( 3) =       0.000426561014
  error estimate for blocks of size 2^( 4) =       0.000438542678
  error estimate for blocks of size 2^( 5) =       0.000449057000
  error estimate for blocks of size 2^( 6) =       0.000456103922
  error estimate for blocks of size 2^( 7) =       0.000462487531

      target function =                  N/A
              le_mean =     -16.905384504120
             les_mean =     286.128185474148
             stat err =       0.000451547783
             autocorr =       1.268476833541
              std dev =       0.566992666532
             le_variance =       0.321480683901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321077608240
                                         uncertainty =       0.001754147952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321077608240
                                         uncertainty =       0.001754147952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677142
  error estimate for blocks of size 2^( 2) =       0.000413420510
  error estimate for blocks of size 2^( 3) =       0.000426332637
  error estimate for blocks of size 2^( 4) =       0.000438321655
  error estimate for blocks of size 2^( 5) =       0.000448846344
  error estimate for blocks of size 2^( 6) =       0.000455894481
  error estimate for blocks of size 2^( 7) =       0.000462280887

      target function =                  N/A
              le_mean =     -16.905383227106
             les_mean =     286.173818181402
             stat err =       0.000451335842
             autocorr =       1.268850664711
              std dev =       0.566643048769
             le_variance =       0.321084344719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321471729116
                                         uncertainty =       0.001786615638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321471729116
                                         uncertainty =       0.001786615638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400922493
  error estimate for blocks of size 2^( 2) =       0.000413662408
  error estimate for blocks of size 2^( 3) =       0.000426541111
  error estimate for blocks of size 2^( 4) =       0.000438511162
  error estimate for blocks of size 2^( 5) =       0.000449041591
  error estimate for blocks of size 2^( 6) =       0.000456171105
  error estimate for blocks of size 2^( 7) =       0.000462505119

      target function =                  N/A
              le_mean =     -16.905369100724
             les_mean =     290.323734810153
             stat err =       0.000451557244
             autocorr =       1.268541802913
              std dev =       0.566990026866
             le_variance =       0.321477690565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321438191508
                                         uncertainty =       0.001766501613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321438191508
                                         uncertainty =       0.001766501613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400900755
  error estimate for blocks of size 2^( 2) =       0.000413633750
  error estimate for blocks of size 2^( 3) =       0.000426539483
  error estimate for blocks of size 2^( 4) =       0.000438521388
  error estimate for blocks of size 2^( 5) =       0.000449036938
  error estimate for blocks of size 2^( 6) =       0.000456084628
  error estimate for blocks of size 2^( 7) =       0.000462468134

      target function =                  N/A
              le_mean =     -16.905383817006
             les_mean =     286.128512077843
             stat err =       0.000451527772
             autocorr =       1.268513772429
              std dev =       0.566959284951
             le_variance =       0.321442830792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905384504120        initial  <--
     6.2500e-01     6.2500e+00             4.3286e-04       -16.905383227106
     2.5000e+00     2.5000e+01             1.2406e-04       -16.905369100724
     1.0000e+01     1.0000e+02             3.2192e-05       -16.905383817006

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6963
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801964e-02 3 1  ON 2
ci_0004                -2.824585e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440047e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248317e-02 3 1  ON 7
ci_0009                -1.779363e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242630e-02 3 1  ON 10
ci_0012                -1.269247e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349906e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308730e-02 3 1  ON 15
ci_0017                 1.160060e-02 3 1  ON 16
ci_0018                 1.175206e-02 3 1  ON 17
ci_0019                 1.188120e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940128e-03 3 1  ON 20
ci_0022                 3.071029e-03 3 1  ON 21
ci_0023                -1.177503e-02 3 1  ON 22
ci_0024                -1.107954e-02 3 1  ON 23
ci_0025                -1.134786e-02 3 1  ON 24
ci_0026                -1.126004e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102651e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022850e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976894e-02 3 1  ON 31
ci_0033                 9.368792e-03 3 1  ON 32
ci_0034                 1.000576e-02 3 1  ON 33
ci_0035                 7.396734e-03 3 1  ON 34
ci_0036                 6.855891e-03 3 1  ON 35
ci_0037                -1.089287e-02 3 1  ON 36
ci_0038                -1.066174e-02 3 1  ON 37
ci_0039                -2.823305e-03 3 1  ON 38
ci_0040                -2.965292e-03 3 1  ON 39
ci_0041                 7.307041e-03 3 1  ON 40
ci_0042                 7.398048e-03 3 1  ON 41
ci_0043                -1.504572e-02 3 1  ON 42
ci_0044                -1.572257e-02 3 1  ON 43
ci_0045                 8.068196e-03 3 1  ON 44
ci_0046                 7.490856e-03 3 1  ON 45
ci_0047                -2.192962e-03 3 1  ON 46
ci_0048                -2.227264e-03 3 1  ON 47
ci_0049                -5.375774e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523473e-03 3 1  ON 50
ci_0052                -3.135384e-03 3 1  ON 51
ci_0053                -5.126524e-03 3 1  ON 52
ci_0054                -4.939516e-03 3 1  ON 53
ci_0055                 5.929689e-03 3 1  ON 54
ci_0056                 6.353378e-03 3 1  ON 55
ci_0057                 4.662075e-03 3 1  ON 56
ci_0058                 5.180958e-03 3 1  ON 57
ci_0059                -5.145778e-03 3 1  ON 58
ci_0060                -4.987336e-03 3 1  ON 59
ci_0061                -3.815083e-03 3 1  ON 60
ci_0062                -3.100744e-03 3 1  ON 61
ci_0063                -8.643958e-03 3 1  ON 62
ci_0064                -9.217348e-03 3 1  ON 63
ci_0065                -5.728111e-03 3 1  ON 64
ci_0066                -5.047851e-03 3 1  ON 65
ci_0067                -5.383616e-03 3 1  ON 66
ci_0068                -5.457297e-03 3 1  ON 67
ci_0069                 4.998278e-03 3 1  ON 68
ci_0070                 4.769827e-03 3 1  ON 69
ci_0071                 2.244049e-03 3 1  ON 70
ci_0072                 1.743420e-03 3 1  ON 71
ci_0073                 4.313088e-03 3 1  ON 72
ci_0074                 4.192366e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.477165
====================================================
  Execution time = 1.6681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3445e-01
  Total weights = 1.951472804e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322076667981
                                         uncertainty =       0.002155925399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322076667981
                                         uncertainty =       0.002155925399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401263482
  error estimate for blocks of size 2^( 2) =       0.000414223364
  error estimate for blocks of size 2^( 3) =       0.000427999915
  error estimate for blocks of size 2^( 4) =       0.000440917340
  error estimate for blocks of size 2^( 5) =       0.000452417722
  error estimate for blocks of size 2^( 6) =       0.000461638130
  error estimate for blocks of size 2^( 7) =       0.000470698041

      target function =                  N/A
              le_mean =     -16.905930233428
             les_mean =     286.144931294076
             stat err =       0.000456417808
             autocorr =       1.293796245967
              std dev =       0.567472258647
             le_variance =       0.322024764334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593023343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905930233397       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905931011777       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905930971763       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905930974961       residual = 3.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 5.916117e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905930233397       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905930432702       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905930422913       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905930423562       residual = 3.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 1.500143e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905930233397       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905930283527       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905930281095       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905930281249       residual = 3.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 3.763787e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9262e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.011562e-01 3 1  ON 0
ci_0002                 7.005058e-01 3 1  ON 1
ci_0003                -2.802059e-02 3 1  ON 2
ci_0004                -2.823679e-02 3 1  ON 3
ci_0005                -3.396035e-02 3 1  ON 4
ci_0006                -3.441547e-02 3 1  ON 5
ci_0007                -2.236518e-02 3 1  ON 6
ci_0008                -2.248700e-02 3 1  ON 7
ci_0009                -1.779582e-02 3 1  ON 8
ci_0010                -1.792537e-02 3 1  ON 9
ci_0011                -1.242025e-02 3 1  ON 10
ci_0012                -1.268272e-02 3 1  ON 11
ci_0013                 1.337491e-02 3 1  ON 12
ci_0014                 1.350227e-02 3 1  ON 13
ci_0015                 1.365332e-02 3 1  ON 14
ci_0016                 1.308437e-02 3 1  ON 15
ci_0017                 1.159948e-02 3 1  ON 16
ci_0018                 1.175238e-02 3 1  ON 17
ci_0019                 1.188084e-02 3 1  ON 18
ci_0020                 1.194430e-02 3 1  ON 19
ci_0021                 1.930534e-03 3 1  ON 20
ci_0022                 3.063734e-03 3 1  ON 21
ci_0023                -1.176795e-02 3 1  ON 22
ci_0024                -1.107929e-02 3 1  ON 23
ci_0025                -1.133883e-02 3 1  ON 24
ci_0026                -1.125599e-02 3 1  ON 25
ci_0027                -1.121252e-02 3 1  ON 26
ci_0028                -1.102788e-02 3 1  ON 27
ci_0029                -1.080097e-02 3 1  ON 28
ci_0030                -1.023908e-02 3 1  ON 29
ci_0031                 1.934038e-02 3 1  ON 30
ci_0032                 1.977109e-02 3 1  ON 31
ci_0033                 9.367075e-03 3 1  ON 32
ci_0034                 9.995996e-03 3 1  ON 33
ci_0035                 7.384193e-03 3 1  ON 34
ci_0036                 6.845608e-03 3 1  ON 35
ci_0037                -1.088393e-02 3 1  ON 36
ci_0038                -1.066121e-02 3 1  ON 37
ci_0039                -2.823297e-03 3 1  ON 38
ci_0040                -2.957080e-03 3 1  ON 39
ci_0041                 7.315313e-03 3 1  ON 40
ci_0042                 7.394469e-03 3 1  ON 41
ci_0043                -1.505424e-02 3 1  ON 42
ci_0044                -1.572077e-02 3 1  ON 43
ci_0045                 8.067750e-03 3 1  ON 44
ci_0046                 7.489972e-03 3 1  ON 45
ci_0047                -2.192196e-03 3 1  ON 46
ci_0048                -2.214194e-03 3 1  ON 47
ci_0049                -5.373183e-03 3 1  ON 48
ci_0050                -5.417962e-03 3 1  ON 49
ci_0051                -3.523065e-03 3 1  ON 50
ci_0052                -3.135206e-03 3 1  ON 51
ci_0053                -5.116876e-03 3 1  ON 52
ci_0054                -4.933423e-03 3 1  ON 53
ci_0055                 5.926692e-03 3 1  ON 54
ci_0056                 6.361689e-03 3 1  ON 55
ci_0057                 4.657267e-03 3 1  ON 56
ci_0058                 5.184040e-03 3 1  ON 57
ci_0059                -5.145607e-03 3 1  ON 58
ci_0060                -4.988227e-03 3 1  ON 59
ci_0061                -3.815525e-03 3 1  ON 60
ci_0062                -3.099635e-03 3 1  ON 61
ci_0063                -8.645446e-03 3 1  ON 62
ci_0064                -9.207867e-03 3 1  ON 63
ci_0065                -5.729200e-03 3 1  ON 64
ci_0066                -5.058076e-03 3 1  ON 65
ci_0067                -5.377629e-03 3 1  ON 66
ci_0068                -5.451717e-03 3 1  ON 67
ci_0069                 4.987480e-03 3 1  ON 68
ci_0070                 4.767461e-03 3 1  ON 69
ci_0071                 2.233032e-03 3 1  ON 70
ci_0072                 1.741722e-03 3 1  ON 71
ci_0073                 4.309469e-03 3 1  ON 72
ci_0074                 4.193255e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.208905
====================================================
  Execution time = 1.4413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3677e-01
  Total weights = 1.9520e+06
  Execution time = 1.8904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323796960946
                                         uncertainty =       0.002738504994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323796960946
                                         uncertainty =       0.002738504994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402313052
  error estimate for blocks of size 2^( 2) =       0.000415331779
  error estimate for blocks of size 2^( 3) =       0.000428663314
  error estimate for blocks of size 2^( 4) =       0.000439550464
  error estimate for blocks of size 2^( 5) =       0.000449105937
  error estimate for blocks of size 2^( 6) =       0.000455039471
  error estimate for blocks of size 2^( 7) =       0.000461818741

      target function =                  N/A
              le_mean =     -16.907685873794
             les_mean =     286.206650475998
             stat err =       0.000451378653
             autocorr =       1.258791463414
              std dev =       0.568956574025
             le_variance =       0.323711583126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323757537910
                                         uncertainty =       0.002739061534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323757537910
                                         uncertainty =       0.002739061534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402288568
  error estimate for blocks of size 2^( 2) =       0.000415308921
  error estimate for blocks of size 2^( 3) =       0.000428641113
  error estimate for blocks of size 2^( 4) =       0.000439529273
  error estimate for blocks of size 2^( 5) =       0.000449083339
  error estimate for blocks of size 2^( 6) =       0.000455016675
  error estimate for blocks of size 2^( 7) =       0.000461797384

      target function =                  N/A
              le_mean =     -16.907684900864
             les_mean =     286.206519685252
             stat err =       0.000451356668
             autocorr =       1.258822055578
              std dev =       0.568921948404
             le_variance =       0.323672183376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323776430501
                                         uncertainty =       0.002738790996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323776430501
                                         uncertainty =       0.002738790996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402300301
  error estimate for blocks of size 2^( 2) =       0.000415319861
  error estimate for blocks of size 2^( 3) =       0.000428651729
  error estimate for blocks of size 2^( 4) =       0.000439539390
  error estimate for blocks of size 2^( 5) =       0.000449094149
  error estimate for blocks of size 2^( 6) =       0.000455027577
  error estimate for blocks of size 2^( 7) =       0.000461807551

      target function =                  N/A
              le_mean =     -16.907685357509
             les_mean =     286.206555855773
             stat err =       0.000451367167
             autocorr =       1.258807185089
              std dev =       0.568938542185
             le_variance =       0.323691064784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323794351205
                                         uncertainty =       0.002738540585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323794351205
                                         uncertainty =       0.002738540585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402311431
  error estimate for blocks of size 2^( 2) =       0.000415330263
  error estimate for blocks of size 2^( 3) =       0.000428661839
  error estimate for blocks of size 2^( 4) =       0.000439549054
  error estimate for blocks of size 2^( 5) =       0.000449104438
  error estimate for blocks of size 2^( 6) =       0.000455037958
  error estimate for blocks of size 2^( 7) =       0.000461817316

      target function =                  N/A
              le_mean =     -16.907685806231
             les_mean =     286.206637501325
             stat err =       0.000451377191
             autocorr =       1.258793450759
              std dev =       0.568954281926
             le_variance =       0.323708974922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907685873794        initial  <--
     6.2500e+00     6.2500e+01             5.9161e-05       -16.907684900864
     2.5000e+01     2.5000e+02             1.5001e-05       -16.907685357509
     1.0000e+02     1.0000e+03             3.7638e-06       -16.907685806231

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9224
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801964e-02 3 1  ON 2
ci_0004                -2.824585e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440047e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248317e-02 3 1  ON 7
ci_0009                -1.779363e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242630e-02 3 1  ON 10
ci_0012                -1.269247e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349906e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308730e-02 3 1  ON 15
ci_0017                 1.160060e-02 3 1  ON 16
ci_0018                 1.175206e-02 3 1  ON 17
ci_0019                 1.188120e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940128e-03 3 1  ON 20
ci_0022                 3.071029e-03 3 1  ON 21
ci_0023                -1.177503e-02 3 1  ON 22
ci_0024                -1.107954e-02 3 1  ON 23
ci_0025                -1.134786e-02 3 1  ON 24
ci_0026                -1.126004e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102651e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022850e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976894e-02 3 1  ON 31
ci_0033                 9.368792e-03 3 1  ON 32
ci_0034                 1.000576e-02 3 1  ON 33
ci_0035                 7.396734e-03 3 1  ON 34
ci_0036                 6.855891e-03 3 1  ON 35
ci_0037                -1.089287e-02 3 1  ON 36
ci_0038                -1.066174e-02 3 1  ON 37
ci_0039                -2.823305e-03 3 1  ON 38
ci_0040                -2.965292e-03 3 1  ON 39
ci_0041                 7.307041e-03 3 1  ON 40
ci_0042                 7.398048e-03 3 1  ON 41
ci_0043                -1.504572e-02 3 1  ON 42
ci_0044                -1.572257e-02 3 1  ON 43
ci_0045                 8.068196e-03 3 1  ON 44
ci_0046                 7.490856e-03 3 1  ON 45
ci_0047                -2.192962e-03 3 1  ON 46
ci_0048                -2.227264e-03 3 1  ON 47
ci_0049                -5.375774e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523473e-03 3 1  ON 50
ci_0052                -3.135384e-03 3 1  ON 51
ci_0053                -5.126524e-03 3 1  ON 52
ci_0054                -4.939516e-03 3 1  ON 53
ci_0055                 5.929689e-03 3 1  ON 54
ci_0056                 6.353378e-03 3 1  ON 55
ci_0057                 4.662075e-03 3 1  ON 56
ci_0058                 5.180958e-03 3 1  ON 57
ci_0059                -5.145778e-03 3 1  ON 58
ci_0060                -4.987336e-03 3 1  ON 59
ci_0061                -3.815083e-03 3 1  ON 60
ci_0062                -3.100744e-03 3 1  ON 61
ci_0063                -8.643958e-03 3 1  ON 62
ci_0064                -9.217348e-03 3 1  ON 63
ci_0065                -5.728111e-03 3 1  ON 64
ci_0066                -5.047851e-03 3 1  ON 65
ci_0067                -5.383616e-03 3 1  ON 66
ci_0068                -5.457297e-03 3 1  ON 67
ci_0069                 4.998278e-03 3 1  ON 68
ci_0070                 4.769827e-03 3 1  ON 69
ci_0071                 2.244049e-03 3 1  ON 70
ci_0072                 1.743420e-03 3 1  ON 71
ci_0073                 4.313088e-03 3 1  ON 72
ci_0074                 4.192366e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.184011
====================================================
  Execution time = 1.4686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3999e-01
  Total weights = 1.952111260e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326165058319
                                         uncertainty =       0.002710299187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326165058319
                                         uncertainty =       0.002710299187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403985734
  error estimate for blocks of size 2^( 2) =       0.000417103567
  error estimate for blocks of size 2^( 3) =       0.000430233429
  error estimate for blocks of size 2^( 4) =       0.000442557409
  error estimate for blocks of size 2^( 5) =       0.000452580777
  error estimate for blocks of size 2^( 6) =       0.000462945884
  error estimate for blocks of size 2^( 7) =       0.000470615965

      target function =                  N/A
              le_mean =     -16.905836971334
             les_mean =     286.147309966951
             stat err =       0.000457175009
             autocorr =       1.280657231996
              std dev =       0.571322103598
             le_variance =       0.326408946060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583697133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905836971348       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905837076929       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905837079477       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905837079255       residual = 1.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 6.430711e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905836971348       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905836997808       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905836998452       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905836998393       residual = 1.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+02 is 1.612058e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905836971348       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905836977967       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905836978129       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905836978114       residual = 1.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+03 is 4.032894e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7275e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801878e-02 3 1  ON 2
ci_0004                -2.824515e-02 3 1  ON 3
ci_0005                -3.394689e-02 3 1  ON 4
ci_0006                -3.440114e-02 3 1  ON 5
ci_0007                -2.237581e-02 3 1  ON 6
ci_0008                -2.248191e-02 3 1  ON 7
ci_0009                -1.779318e-02 3 1  ON 8
ci_0010                -1.793095e-02 3 1  ON 9
ci_0011                -1.242628e-02 3 1  ON 10
ci_0012                -1.269254e-02 3 1  ON 11
ci_0013                 1.336728e-02 3 1  ON 12
ci_0014                 1.349823e-02 3 1  ON 13
ci_0015                 1.364992e-02 3 1  ON 14
ci_0016                 1.308756e-02 3 1  ON 15
ci_0017                 1.160164e-02 3 1  ON 16
ci_0018                 1.175085e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194717e-02 3 1  ON 19
ci_0021                 1.939825e-03 3 1  ON 20
ci_0022                 3.070030e-03 3 1  ON 21
ci_0023                -1.177507e-02 3 1  ON 22
ci_0024                -1.108010e-02 3 1  ON 23
ci_0025                -1.134625e-02 3 1  ON 24
ci_0026                -1.126002e-02 3 1  ON 25
ci_0027                -1.120354e-02 3 1  ON 26
ci_0028                -1.102673e-02 3 1  ON 27
ci_0029                -1.080273e-02 3 1  ON 28
ci_0030                -1.022846e-02 3 1  ON 29
ci_0031                 1.933904e-02 3 1  ON 30
ci_0032                 1.976985e-02 3 1  ON 31
ci_0033                 9.369408e-03 3 1  ON 32
ci_0034                 1.000493e-02 3 1  ON 33
ci_0035                 7.395540e-03 3 1  ON 34
ci_0036                 6.855681e-03 3 1  ON 35
ci_0037                -1.089187e-02 3 1  ON 36
ci_0038                -1.066124e-02 3 1  ON 37
ci_0039                -2.823619e-03 3 1  ON 38
ci_0040                -2.964884e-03 3 1  ON 39
ci_0041                 7.307021e-03 3 1  ON 40
ci_0042                 7.397845e-03 3 1  ON 41
ci_0043                -1.504635e-02 3 1  ON 42
ci_0044                -1.572328e-02 3 1  ON 43
ci_0045                 8.067814e-03 3 1  ON 44
ci_0046                 7.490973e-03 3 1  ON 45
ci_0047                -2.192254e-03 3 1  ON 46
ci_0048                -2.226695e-03 3 1  ON 47
ci_0049                -5.376338e-03 3 1  ON 48
ci_0050                -5.414602e-03 3 1  ON 49
ci_0051                -3.523817e-03 3 1  ON 50
ci_0052                -3.135515e-03 3 1  ON 51
ci_0053                -5.125644e-03 3 1  ON 52
ci_0054                -4.939722e-03 3 1  ON 53
ci_0055                 5.930248e-03 3 1  ON 54
ci_0056                 6.353993e-03 3 1  ON 55
ci_0057                 4.662234e-03 3 1  ON 56
ci_0058                 5.179768e-03 3 1  ON 57
ci_0059                -5.145123e-03 3 1  ON 58
ci_0060                -4.986493e-03 3 1  ON 59
ci_0061                -3.814560e-03 3 1  ON 60
ci_0062                -3.100918e-03 3 1  ON 61
ci_0063                -8.643248e-03 3 1  ON 62
ci_0064                -9.216294e-03 3 1  ON 63
ci_0065                -5.727800e-03 3 1  ON 64
ci_0066                -5.048523e-03 3 1  ON 65
ci_0067                -5.382871e-03 3 1  ON 66
ci_0068                -5.456478e-03 3 1  ON 67
ci_0069                 4.997988e-03 3 1  ON 68
ci_0070                 4.769965e-03 3 1  ON 69
ci_0071                 2.242890e-03 3 1  ON 70
ci_0072                 1.743185e-03 3 1  ON 71
ci_0073                 4.312901e-03 3 1  ON 72
ci_0074                 4.192989e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9185
    reference variance = 0.200551
====================================================
  Execution time = 1.4054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3403e-01
  Total weights = 1.9519e+06
  Execution time = 1.8835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321868161232
                                         uncertainty =       0.002172282519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321868161232
                                         uncertainty =       0.002172282519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124393
  error estimate for blocks of size 2^( 2) =       0.000413978431
  error estimate for blocks of size 2^( 3) =       0.000427504542
  error estimate for blocks of size 2^( 4) =       0.000440426597
  error estimate for blocks of size 2^( 5) =       0.000450709227
  error estimate for blocks of size 2^( 6) =       0.000457844288
  error estimate for blocks of size 2^( 7) =       0.000462675457

      target function =                  N/A
              le_mean =     -16.905735218389
             les_mean =     286.137912989094
             stat err =       0.000452913892
             autocorr =       1.274891244267
              std dev =       0.567275556628
             le_variance =       0.321801557148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321864801017
                                         uncertainty =       0.002172143941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321864801017
                                         uncertainty =       0.002172143941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401122307
  error estimate for blocks of size 2^( 2) =       0.000413976515
  error estimate for blocks of size 2^( 3) =       0.000427502726
  error estimate for blocks of size 2^( 4) =       0.000440424696
  error estimate for blocks of size 2^( 5) =       0.000450707313
  error estimate for blocks of size 2^( 6) =       0.000457842579
  error estimate for blocks of size 2^( 7) =       0.000462673863

      target function =                  N/A
              le_mean =     -16.905735160969
             les_mean =     286.137926660487
             stat err =       0.000452912113
             autocorr =       1.274894486783
              std dev =       0.567272606414
             le_variance =       0.321798209988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321866473460
                                         uncertainty =       0.002172213009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321866473460
                                         uncertainty =       0.002172213009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401123345
  error estimate for blocks of size 2^( 2) =       0.000413977468
  error estimate for blocks of size 2^( 3) =       0.000427503630
  error estimate for blocks of size 2^( 4) =       0.000440425642
  error estimate for blocks of size 2^( 5) =       0.000450708266
  error estimate for blocks of size 2^( 6) =       0.000457843429
  error estimate for blocks of size 2^( 7) =       0.000462674656

      target function =                  N/A
              le_mean =     -16.905735189367
             les_mean =     286.137919571334
             stat err =       0.000452912998
             autocorr =       1.274892871890
              std dev =       0.567274074784
             le_variance =       0.321799875922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321867949832
                                         uncertainty =       0.002172273817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321867949832
                                         uncertainty =       0.002172273817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124262
  error estimate for blocks of size 2^( 2) =       0.000413978310
  error estimate for blocks of size 2^( 3) =       0.000427504428
  error estimate for blocks of size 2^( 4) =       0.000440426478
  error estimate for blocks of size 2^( 5) =       0.000450709107
  error estimate for blocks of size 2^( 6) =       0.000457844180
  error estimate for blocks of size 2^( 7) =       0.000462675356

      target function =                  N/A
              le_mean =     -16.905735214733
             les_mean =     286.137913782540
             stat err =       0.000452913780
             autocorr =       1.274891447980
              std dev =       0.567275371021
             le_variance =       0.321801346567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905735218389        initial  <--
     6.2500e+01     6.2500e+02             6.4307e-06       -16.905735160969
     2.5000e+02     2.5000e+03             1.6121e-06       -16.905735189367
     1.0000e+03     1.0000e+04             4.0329e-07       -16.905735214733

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5422
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801964e-02 3 1  ON 2
ci_0004                -2.824585e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440047e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248317e-02 3 1  ON 7
ci_0009                -1.779363e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242630e-02 3 1  ON 10
ci_0012                -1.269247e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349906e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308730e-02 3 1  ON 15
ci_0017                 1.160060e-02 3 1  ON 16
ci_0018                 1.175206e-02 3 1  ON 17
ci_0019                 1.188120e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940128e-03 3 1  ON 20
ci_0022                 3.071029e-03 3 1  ON 21
ci_0023                -1.177503e-02 3 1  ON 22
ci_0024                -1.107954e-02 3 1  ON 23
ci_0025                -1.134786e-02 3 1  ON 24
ci_0026                -1.126004e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102651e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022850e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976894e-02 3 1  ON 31
ci_0033                 9.368792e-03 3 1  ON 32
ci_0034                 1.000576e-02 3 1  ON 33
ci_0035                 7.396734e-03 3 1  ON 34
ci_0036                 6.855891e-03 3 1  ON 35
ci_0037                -1.089287e-02 3 1  ON 36
ci_0038                -1.066174e-02 3 1  ON 37
ci_0039                -2.823305e-03 3 1  ON 38
ci_0040                -2.965292e-03 3 1  ON 39
ci_0041                 7.307041e-03 3 1  ON 40
ci_0042                 7.398048e-03 3 1  ON 41
ci_0043                -1.504572e-02 3 1  ON 42
ci_0044                -1.572257e-02 3 1  ON 43
ci_0045                 8.068196e-03 3 1  ON 44
ci_0046                 7.490856e-03 3 1  ON 45
ci_0047                -2.192962e-03 3 1  ON 46
ci_0048                -2.227264e-03 3 1  ON 47
ci_0049                -5.375774e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523473e-03 3 1  ON 50
ci_0052                -3.135384e-03 3 1  ON 51
ci_0053                -5.126524e-03 3 1  ON 52
ci_0054                -4.939516e-03 3 1  ON 53
ci_0055                 5.929689e-03 3 1  ON 54
ci_0056                 6.353378e-03 3 1  ON 55
ci_0057                 4.662075e-03 3 1  ON 56
ci_0058                 5.180958e-03 3 1  ON 57
ci_0059                -5.145778e-03 3 1  ON 58
ci_0060                -4.987336e-03 3 1  ON 59
ci_0061                -3.815083e-03 3 1  ON 60
ci_0062                -3.100744e-03 3 1  ON 61
ci_0063                -8.643958e-03 3 1  ON 62
ci_0064                -9.217348e-03 3 1  ON 63
ci_0065                -5.728111e-03 3 1  ON 64
ci_0066                -5.047851e-03 3 1  ON 65
ci_0067                -5.383616e-03 3 1  ON 66
ci_0068                -5.457297e-03 3 1  ON 67
ci_0069                 4.998278e-03 3 1  ON 68
ci_0070                 4.769827e-03 3 1  ON 69
ci_0071                 2.244049e-03 3 1  ON 70
ci_0072                 1.743420e-03 3 1  ON 71
ci_0073                 4.313088e-03 3 1  ON 72
ci_0074                 4.192366e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8919
    reference variance = 0.379104
====================================================
  Execution time = 1.4953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3191e-01
  Total weights = 1.951781313e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320748601463
                                         uncertainty =       0.002261991236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320748601463
                                         uncertainty =       0.002261991236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400475713
  error estimate for blocks of size 2^( 2) =       0.000412983323
  error estimate for blocks of size 2^( 3) =       0.000425794588
  error estimate for blocks of size 2^( 4) =       0.000437809532
  error estimate for blocks of size 2^( 5) =       0.000448172980
  error estimate for blocks of size 2^( 6) =       0.000455234980
  error estimate for blocks of size 2^( 7) =       0.000461154830

      target function =                  N/A
              le_mean =     -16.906925395127
             les_mean =     286.176038370176
             stat err =       0.000450593081
             autocorr =       1.265950342400
              std dev =       0.566358184444
             le_variance =       0.320761593087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690692539513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906925395114       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906925410528       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906925410479       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906925410507       residual = 4.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 5.706268e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906925395114       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906925398969       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906925398957       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906925398964       residual = 4.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 1.427096e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906925395114       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906925396078       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906925396075       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906925396077       residual = 4.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+04 is 3.568072e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7530e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005072e-01 3 1  ON 1
ci_0003                -2.801957e-02 3 1  ON 2
ci_0004                -2.824574e-02 3 1  ON 3
ci_0005                -3.394586e-02 3 1  ON 4
ci_0006                -3.440049e-02 3 1  ON 5
ci_0007                -2.237550e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779362e-02 3 1  ON 8
ci_0010                -1.793006e-02 3 1  ON 9
ci_0011                -1.242622e-02 3 1  ON 10
ci_0012                -1.269246e-02 3 1  ON 11
ci_0013                 1.336636e-02 3 1  ON 12
ci_0014                 1.349895e-02 3 1  ON 13
ci_0015                 1.364990e-02 3 1  ON 14
ci_0016                 1.308735e-02 3 1  ON 15
ci_0017                 1.160061e-02 3 1  ON 16
ci_0018                 1.175203e-02 3 1  ON 17
ci_0019                 1.188117e-02 3 1  ON 18
ci_0020                 1.194805e-02 3 1  ON 19
ci_0021                 1.940018e-03 3 1  ON 20
ci_0022                 3.070943e-03 3 1  ON 21
ci_0023                -1.177495e-02 3 1  ON 22
ci_0024                -1.107957e-02 3 1  ON 23
ci_0025                -1.134775e-02 3 1  ON 24
ci_0026                -1.125993e-02 3 1  ON 25
ci_0027                -1.120284e-02 3 1  ON 26
ci_0028                -1.102645e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022851e-02 3 1  ON 29
ci_0031                 1.933888e-02 3 1  ON 30
ci_0032                 1.976890e-02 3 1  ON 31
ci_0033                 9.368829e-03 3 1  ON 32
ci_0034                 1.000573e-02 3 1  ON 33
ci_0035                 7.396650e-03 3 1  ON 34
ci_0036                 6.855924e-03 3 1  ON 35
ci_0037                -1.089292e-02 3 1  ON 36
ci_0038                -1.066175e-02 3 1  ON 37
ci_0039                -2.823320e-03 3 1  ON 38
ci_0040                -2.965214e-03 3 1  ON 39
ci_0041                 7.306974e-03 3 1  ON 40
ci_0042                 7.398082e-03 3 1  ON 41
ci_0043                -1.504579e-02 3 1  ON 42
ci_0044                -1.572263e-02 3 1  ON 43
ci_0045                 8.068119e-03 3 1  ON 44
ci_0046                 7.490830e-03 3 1  ON 45
ci_0047                -2.192928e-03 3 1  ON 46
ci_0048                -2.227185e-03 3 1  ON 47
ci_0049                -5.375780e-03 3 1  ON 48
ci_0050                -5.413903e-03 3 1  ON 49
ci_0051                -3.523473e-03 3 1  ON 50
ci_0052                -3.135396e-03 3 1  ON 51
ci_0053                -5.126532e-03 3 1  ON 52
ci_0054                -4.939492e-03 3 1  ON 53
ci_0055                 5.929724e-03 3 1  ON 54
ci_0056                 6.353443e-03 3 1  ON 55
ci_0057                 4.662044e-03 3 1  ON 56
ci_0058                 5.180868e-03 3 1  ON 57
ci_0059                -5.145636e-03 3 1  ON 58
ci_0060                -4.987321e-03 3 1  ON 59
ci_0061                -3.815063e-03 3 1  ON 60
ci_0062                -3.100828e-03 3 1  ON 61
ci_0063                -8.644039e-03 3 1  ON 62
ci_0064                -9.217365e-03 3 1  ON 63
ci_0065                -5.728118e-03 3 1  ON 64
ci_0066                -5.047874e-03 3 1  ON 65
ci_0067                -5.383577e-03 3 1  ON 66
ci_0068                -5.457263e-03 3 1  ON 67
ci_0069                 4.998247e-03 3 1  ON 68
ci_0070                 4.769929e-03 3 1  ON 69
ci_0071                 2.243973e-03 3 1  ON 70
ci_0072                 1.743345e-03 3 1  ON 71
ci_0073                 4.313091e-03 3 1  ON 72
ci_0074                 4.192408e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.946
    reference variance = 1.48245
====================================================
  Execution time = 1.4048e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3624e-01
  Total weights = 1.9518e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544764784
                                         uncertainty =       0.002578248102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544764784
                                         uncertainty =       0.002578248102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403466701
  error estimate for blocks of size 2^( 2) =       0.000416757435
  error estimate for blocks of size 2^( 3) =       0.000430496708
  error estimate for blocks of size 2^( 4) =       0.000443139845
  error estimate for blocks of size 2^( 5) =       0.000454407635
  error estimate for blocks of size 2^( 6) =       0.000463680798
  error estimate for blocks of size 2^( 7) =       0.000471037959

      target function =                  N/A
              le_mean =     -16.906133345618
             les_mean =     286.153582043490
             stat err =       0.000458066559
             autocorr =       1.288966947516
              std dev =       0.570588080239
             le_variance =       0.325570757310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544429190
                                         uncertainty =       0.002578246377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544429190
                                         uncertainty =       0.002578246377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403466491
  error estimate for blocks of size 2^( 2) =       0.000416757234
  error estimate for blocks of size 2^( 3) =       0.000430496520
  error estimate for blocks of size 2^( 4) =       0.000443139665
  error estimate for blocks of size 2^( 5) =       0.000454407457
  error estimate for blocks of size 2^( 6) =       0.000463680633
  error estimate for blocks of size 2^( 7) =       0.000471037804

      target function =                  N/A
              le_mean =     -16.906133339195
             les_mean =     286.153579261136
             stat err =       0.000458066390
             autocorr =       1.288967335585
              std dev =       0.570587783384
             le_variance =       0.325570418547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544596920
                                         uncertainty =       0.002578247239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544596920
                                         uncertainty =       0.002578247239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403466596
  error estimate for blocks of size 2^( 2) =       0.000416757335
  error estimate for blocks of size 2^( 3) =       0.000430496614
  error estimate for blocks of size 2^( 4) =       0.000443139755
  error estimate for blocks of size 2^( 5) =       0.000454407546
  error estimate for blocks of size 2^( 6) =       0.000463680716
  error estimate for blocks of size 2^( 7) =       0.000471037881

      target function =                  N/A
              le_mean =     -16.906133342402
             les_mean =     286.153580630309
             stat err =       0.000458066474
             autocorr =       1.288967141638
              std dev =       0.570587931752
             le_variance =       0.325570587862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544743797
                                         uncertainty =       0.002578247994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325544743797
                                         uncertainty =       0.002578247994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403466688
  error estimate for blocks of size 2^( 2) =       0.000416757423
  error estimate for blocks of size 2^( 3) =       0.000430496696
  error estimate for blocks of size 2^( 4) =       0.000443139833
  error estimate for blocks of size 2^( 5) =       0.000454407624
  error estimate for blocks of size 2^( 6) =       0.000463680788
  error estimate for blocks of size 2^( 7) =       0.000471037949

      target function =                  N/A
              le_mean =     -16.906133345216
             les_mean =     286.153581864385
             stat err =       0.000458066549
             autocorr =       1.288966971788
              std dev =       0.570588061675
             le_variance =       0.325570736126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906133345618        initial  <--
     6.2500e+02     6.2500e+03             5.7063e-07       -16.906133339195
     2.5000e+03     2.5000e+04             1.4271e-07       -16.906133342402
     1.0000e+04     1.0000e+05             3.5681e-08       -16.906133345216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5230
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801964e-02 3 1  ON 2
ci_0004                -2.824585e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440047e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248317e-02 3 1  ON 7
ci_0009                -1.779363e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242630e-02 3 1  ON 10
ci_0012                -1.269247e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349906e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308730e-02 3 1  ON 15
ci_0017                 1.160060e-02 3 1  ON 16
ci_0018                 1.175206e-02 3 1  ON 17
ci_0019                 1.188120e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940128e-03 3 1  ON 20
ci_0022                 3.071029e-03 3 1  ON 21
ci_0023                -1.177503e-02 3 1  ON 22
ci_0024                -1.107954e-02 3 1  ON 23
ci_0025                -1.134786e-02 3 1  ON 24
ci_0026                -1.126004e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102651e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022850e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976894e-02 3 1  ON 31
ci_0033                 9.368792e-03 3 1  ON 32
ci_0034                 1.000576e-02 3 1  ON 33
ci_0035                 7.396734e-03 3 1  ON 34
ci_0036                 6.855891e-03 3 1  ON 35
ci_0037                -1.089287e-02 3 1  ON 36
ci_0038                -1.066174e-02 3 1  ON 37
ci_0039                -2.823305e-03 3 1  ON 38
ci_0040                -2.965292e-03 3 1  ON 39
ci_0041                 7.307041e-03 3 1  ON 40
ci_0042                 7.398048e-03 3 1  ON 41
ci_0043                -1.504572e-02 3 1  ON 42
ci_0044                -1.572257e-02 3 1  ON 43
ci_0045                 8.068196e-03 3 1  ON 44
ci_0046                 7.490856e-03 3 1  ON 45
ci_0047                -2.192962e-03 3 1  ON 46
ci_0048                -2.227264e-03 3 1  ON 47
ci_0049                -5.375774e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523473e-03 3 1  ON 50
ci_0052                -3.135384e-03 3 1  ON 51
ci_0053                -5.126524e-03 3 1  ON 52
ci_0054                -4.939516e-03 3 1  ON 53
ci_0055                 5.929689e-03 3 1  ON 54
ci_0056                 6.353378e-03 3 1  ON 55
ci_0057                 4.662075e-03 3 1  ON 56
ci_0058                 5.180958e-03 3 1  ON 57
ci_0059                -5.145778e-03 3 1  ON 58
ci_0060                -4.987336e-03 3 1  ON 59
ci_0061                -3.815083e-03 3 1  ON 60
ci_0062                -3.100744e-03 3 1  ON 61
ci_0063                -8.643958e-03 3 1  ON 62
ci_0064                -9.217348e-03 3 1  ON 63
ci_0065                -5.728111e-03 3 1  ON 64
ci_0066                -5.047851e-03 3 1  ON 65
ci_0067                -5.383616e-03 3 1  ON 66
ci_0068                -5.457297e-03 3 1  ON 67
ci_0069                 4.998278e-03 3 1  ON 68
ci_0070                 4.769827e-03 3 1  ON 69
ci_0071                 2.244049e-03 3 1  ON 70
ci_0072                 1.743420e-03 3 1  ON 71
ci_0073                 4.313088e-03 3 1  ON 72
ci_0074                 4.192366e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9136
    reference variance = 0.340982
====================================================
  Execution time = 1.4574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3458e-01
  Total weights = 1.951576289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322193340182
                                         uncertainty =       0.002116112018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322193340182
                                         uncertainty =       0.002116112018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401471249
  error estimate for blocks of size 2^( 2) =       0.000414495481
  error estimate for blocks of size 2^( 3) =       0.000427523619
  error estimate for blocks of size 2^( 4) =       0.000439318309
  error estimate for blocks of size 2^( 5) =       0.000450484207
  error estimate for blocks of size 2^( 6) =       0.000456122934
  error estimate for blocks of size 2^( 7) =       0.000461904588

      target function =                  N/A
              le_mean =     -16.906358110195
             les_mean =     286.159528427257
             stat err =       0.000451957509
             autocorr =       1.267320075710
              std dev =       0.567766085733
             le_variance =       0.322358328108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635811020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358110193       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358110392       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358110487       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358110481       residual = 5.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+03 is 7.691637e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358110193       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358110243       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358110267       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358110265       residual = 5.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+04 is 1.922951e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358110193       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358110206       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358110212       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358110211       residual = 5.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+05 is 4.807405e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7167e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801965e-02 3 1  ON 2
ci_0004                -2.824583e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440048e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248318e-02 3 1  ON 7
ci_0009                -1.779362e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242631e-02 3 1  ON 10
ci_0012                -1.269247e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349906e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308729e-02 3 1  ON 15
ci_0017                 1.160059e-02 3 1  ON 16
ci_0018                 1.175206e-02 3 1  ON 17
ci_0019                 1.188119e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940124e-03 3 1  ON 20
ci_0022                 3.071018e-03 3 1  ON 21
ci_0023                -1.177502e-02 3 1  ON 22
ci_0024                -1.107955e-02 3 1  ON 23
ci_0025                -1.134786e-02 3 1  ON 24
ci_0026                -1.126003e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102650e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022849e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976893e-02 3 1  ON 31
ci_0033                 9.368803e-03 3 1  ON 32
ci_0034                 1.000576e-02 3 1  ON 33
ci_0035                 7.396719e-03 3 1  ON 34
ci_0036                 6.855883e-03 3 1  ON 35
ci_0037                -1.089287e-02 3 1  ON 36
ci_0038                -1.066173e-02 3 1  ON 37
ci_0039                -2.823306e-03 3 1  ON 38
ci_0040                -2.965288e-03 3 1  ON 39
ci_0041                 7.307038e-03 3 1  ON 40
ci_0042                 7.398050e-03 3 1  ON 41
ci_0043                -1.504573e-02 3 1  ON 42
ci_0044                -1.572258e-02 3 1  ON 43
ci_0045                 8.068192e-03 3 1  ON 44
ci_0046                 7.490867e-03 3 1  ON 45
ci_0047                -2.192952e-03 3 1  ON 46
ci_0048                -2.227250e-03 3 1  ON 47
ci_0049                -5.375774e-03 3 1  ON 48
ci_0050                -5.413886e-03 3 1  ON 49
ci_0051                -3.523461e-03 3 1  ON 50
ci_0052                -3.135390e-03 3 1  ON 51
ci_0053                -5.126519e-03 3 1  ON 52
ci_0054                -4.939511e-03 3 1  ON 53
ci_0055                 5.929702e-03 3 1  ON 54
ci_0056                 6.353383e-03 3 1  ON 55
ci_0057                 4.662065e-03 3 1  ON 56
ci_0058                 5.180948e-03 3 1  ON 57
ci_0059                -5.145775e-03 3 1  ON 58
ci_0060                -4.987330e-03 3 1  ON 59
ci_0061                -3.815071e-03 3 1  ON 60
ci_0062                -3.100741e-03 3 1  ON 61
ci_0063                -8.643969e-03 3 1  ON 62
ci_0064                -9.217334e-03 3 1  ON 63
ci_0065                -5.728108e-03 3 1  ON 64
ci_0066                -5.047860e-03 3 1  ON 65
ci_0067                -5.383615e-03 3 1  ON 66
ci_0068                -5.457290e-03 3 1  ON 67
ci_0069                 4.998271e-03 3 1  ON 68
ci_0070                 4.769819e-03 3 1  ON 69
ci_0071                 2.244038e-03 3 1  ON 70
ci_0072                 1.743414e-03 3 1  ON 71
ci_0073                 4.313091e-03 3 1  ON 72
ci_0074                 4.192365e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8697
    reference variance = 0.706126
====================================================
  Execution time = 1.4128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4438e-01
  Total weights = 1.9520e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628873828
                                         uncertainty =       0.003029612044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628873828
                                         uncertainty =       0.003029612044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405331927
  error estimate for blocks of size 2^( 2) =       0.000418366416
  error estimate for blocks of size 2^( 3) =       0.000432234876
  error estimate for blocks of size 2^( 4) =       0.000445400446
  error estimate for blocks of size 2^( 5) =       0.000456515687
  error estimate for blocks of size 2^( 6) =       0.000463481278
  error estimate for blocks of size 2^( 7) =       0.000470205413

      target function =                  N/A
              le_mean =     -16.904870506494
             les_mean =     286.119023726362
             stat err =       0.000458900706
             autocorr =       1.281786886881
              std dev =       0.573225908618
             le_variance =       0.328587942311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628826560
                                         uncertainty =       0.003029609378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628826560
                                         uncertainty =       0.003029609378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405331898
  error estimate for blocks of size 2^( 2) =       0.000418366389
  error estimate for blocks of size 2^( 3) =       0.000432234851
  error estimate for blocks of size 2^( 4) =       0.000445400421
  error estimate for blocks of size 2^( 5) =       0.000456515662
  error estimate for blocks of size 2^( 6) =       0.000463481257
  error estimate for blocks of size 2^( 7) =       0.000470205393

      target function =                  N/A
              le_mean =     -16.904870506712
             les_mean =     286.119023554185
             stat err =       0.000458900683
             autocorr =       1.281786944789
              std dev =       0.573225867331
             le_variance =       0.328587894978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628850193
                                         uncertainty =       0.003029610711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628850193
                                         uncertainty =       0.003029610711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405331913
  error estimate for blocks of size 2^( 2) =       0.000418366403
  error estimate for blocks of size 2^( 3) =       0.000432234863
  error estimate for blocks of size 2^( 4) =       0.000445400433
  error estimate for blocks of size 2^( 5) =       0.000456515674
  error estimate for blocks of size 2^( 6) =       0.000463481267
  error estimate for blocks of size 2^( 7) =       0.000470205403

      target function =                  N/A
              le_mean =     -16.904870506603
             les_mean =     286.119023640257
             stat err =       0.000458900694
             autocorr =       1.281786915834
              std dev =       0.573225887974
             le_variance =       0.328587918643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628870874
                                         uncertainty =       0.003029611878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328628870874
                                         uncertainty =       0.003029611878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405331925
  error estimate for blocks of size 2^( 2) =       0.000418366415
  error estimate for blocks of size 2^( 3) =       0.000432234875
  error estimate for blocks of size 2^( 4) =       0.000445400444
  error estimate for blocks of size 2^( 5) =       0.000456515685
  error estimate for blocks of size 2^( 6) =       0.000463481277
  error estimate for blocks of size 2^( 7) =       0.000470205412

      target function =                  N/A
              le_mean =     -16.904870506508
             les_mean =     286.119023715598
             stat err =       0.000458900704
             autocorr =       1.281786890499
              std dev =       0.573225906037
             le_variance =       0.328587939352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904870506494        initial
     6.2500e+03     6.2500e+04             7.6916e-08       -16.904870506712  <--
     2.5000e+04     2.5000e+05             1.9230e-08       -16.904870506603
     1.0000e+05     1.0000e+06             4.8074e-09       -16.904870506508

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 2.3626e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801965e-02 3 1  ON 2
ci_0004                -2.824578e-02 3 1  ON 3
ci_0005                -3.394581e-02 3 1  ON 4
ci_0006                -3.440049e-02 3 1  ON 5
ci_0007                -2.237551e-02 3 1  ON 6
ci_0008                -2.248319e-02 3 1  ON 7
ci_0009                -1.779360e-02 3 1  ON 8
ci_0010                -1.793015e-02 3 1  ON 9
ci_0011                -1.242632e-02 3 1  ON 10
ci_0012                -1.269248e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349907e-02 3 1  ON 13
ci_0015                 1.364997e-02 3 1  ON 14
ci_0016                 1.308728e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175205e-02 3 1  ON 17
ci_0019                 1.188119e-02 3 1  ON 18
ci_0020                 1.194813e-02 3 1  ON 19
ci_0021                 1.940114e-03 3 1  ON 20
ci_0022                 3.070986e-03 3 1  ON 21
ci_0023                -1.177501e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134785e-02 3 1  ON 24
ci_0026                -1.125999e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102649e-02 3 1  ON 27
ci_0029                -1.080388e-02 3 1  ON 28
ci_0030                -1.022846e-02 3 1  ON 29
ci_0031                 1.933886e-02 3 1  ON 30
ci_0032                 1.976893e-02 3 1  ON 31
ci_0033                 9.368834e-03 3 1  ON 32
ci_0034                 1.000575e-02 3 1  ON 33
ci_0035                 7.396674e-03 3 1  ON 34
ci_0036                 6.855860e-03 3 1  ON 35
ci_0037                -1.089288e-02 3 1  ON 36
ci_0038                -1.066167e-02 3 1  ON 37
ci_0039                -2.823311e-03 3 1  ON 38
ci_0040                -2.965276e-03 3 1  ON 39
ci_0041                 7.307028e-03 3 1  ON 40
ci_0042                 7.398057e-03 3 1  ON 41
ci_0043                -1.504576e-02 3 1  ON 42
ci_0044                -1.572262e-02 3 1  ON 43
ci_0045                 8.068177e-03 3 1  ON 44
ci_0046                 7.490897e-03 3 1  ON 45
ci_0047                -2.192919e-03 3 1  ON 46
ci_0048                -2.227209e-03 3 1  ON 47
ci_0049                -5.375775e-03 3 1  ON 48
ci_0050                -5.413869e-03 3 1  ON 49
ci_0051                -3.523423e-03 3 1  ON 50
ci_0052                -3.135407e-03 3 1  ON 51
ci_0053                -5.126506e-03 3 1  ON 52
ci_0054                -4.939494e-03 3 1  ON 53
ci_0055                 5.929743e-03 3 1  ON 54
ci_0056                 6.353396e-03 3 1  ON 55
ci_0057                 4.662038e-03 3 1  ON 56
ci_0058                 5.180917e-03 3 1  ON 57
ci_0059                -5.145764e-03 3 1  ON 58
ci_0060                -4.987312e-03 3 1  ON 59
ci_0061                -3.815032e-03 3 1  ON 60
ci_0062                -3.100734e-03 3 1  ON 61
ci_0063                -8.644003e-03 3 1  ON 62
ci_0064                -9.217290e-03 3 1  ON 63
ci_0065                -5.728099e-03 3 1  ON 64
ci_0066                -5.047887e-03 3 1  ON 65
ci_0067                -5.383614e-03 3 1  ON 66
ci_0068                -5.457269e-03 3 1  ON 67
ci_0069                 4.998250e-03 3 1  ON 68
ci_0070                 4.769793e-03 3 1  ON 69
ci_0071                 2.244004e-03 3 1  ON 70
ci_0072                 1.743394e-03 3 1  ON 71
ci_0073                 4.313102e-03 3 1  ON 72
ci_0074                 4.192362e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.208955
====================================================
  Execution time = 1.4468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3673e-01
  Total weights = 1.951748951e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322799747106
                                         uncertainty =       0.002264688950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322799747106
                                         uncertainty =       0.002264688950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401727614
  error estimate for blocks of size 2^( 2) =       0.000414672396
  error estimate for blocks of size 2^( 3) =       0.000427469015
  error estimate for blocks of size 2^( 4) =       0.000439353876
  error estimate for blocks of size 2^( 5) =       0.000450350287
  error estimate for blocks of size 2^( 6) =       0.000458665943
  error estimate for blocks of size 2^( 7) =       0.000463251387

      target function =                  N/A
              le_mean =     -16.906598192839
             les_mean =     286.169789627441
             stat err =       0.000452905373
             autocorr =       1.271017635609
              std dev =       0.568128639515
             le_variance =       0.322770151037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659819284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906598192815       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906598201172       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906598201213       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906598201200       residual = 2.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 2.210587e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906598192815       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906598194905       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906598194915       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906598194912       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+03 is 5.527296e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906598192815       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906598193338       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906598193340       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906598193339       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+04 is 1.381876e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7052e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801964e-02 3 1  ON 2
ci_0004                -2.824574e-02 3 1  ON 3
ci_0005                -3.394584e-02 3 1  ON 4
ci_0006                -3.440050e-02 3 1  ON 5
ci_0007                -2.237550e-02 3 1  ON 6
ci_0008                -2.248314e-02 3 1  ON 7
ci_0009                -1.779357e-02 3 1  ON 8
ci_0010                -1.793014e-02 3 1  ON 9
ci_0011                -1.242633e-02 3 1  ON 10
ci_0012                -1.269245e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349910e-02 3 1  ON 13
ci_0015                 1.364997e-02 3 1  ON 14
ci_0016                 1.308731e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175202e-02 3 1  ON 17
ci_0019                 1.188117e-02 3 1  ON 18
ci_0020                 1.194809e-02 3 1  ON 19
ci_0021                 1.940111e-03 3 1  ON 20
ci_0022                 3.070960e-03 3 1  ON 21
ci_0023                -1.177497e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134782e-02 3 1  ON 24
ci_0026                -1.125993e-02 3 1  ON 25
ci_0027                -1.120283e-02 3 1  ON 26
ci_0028                -1.102652e-02 3 1  ON 27
ci_0029                -1.080389e-02 3 1  ON 28
ci_0030                -1.022848e-02 3 1  ON 29
ci_0031                 1.933889e-02 3 1  ON 30
ci_0032                 1.976891e-02 3 1  ON 31
ci_0033                 9.368843e-03 3 1  ON 32
ci_0034                 1.000579e-02 3 1  ON 33
ci_0035                 7.396653e-03 3 1  ON 34
ci_0036                 6.855838e-03 3 1  ON 35
ci_0037                -1.089289e-02 3 1  ON 36
ci_0038                -1.066165e-02 3 1  ON 37
ci_0039                -2.823283e-03 3 1  ON 38
ci_0040                -2.965232e-03 3 1  ON 39
ci_0041                 7.307024e-03 3 1  ON 40
ci_0042                 7.398058e-03 3 1  ON 41
ci_0043                -1.504577e-02 3 1  ON 42
ci_0044                -1.572265e-02 3 1  ON 43
ci_0045                 8.068184e-03 3 1  ON 44
ci_0046                 7.490892e-03 3 1  ON 45
ci_0047                -2.192880e-03 3 1  ON 46
ci_0048                -2.227155e-03 3 1  ON 47
ci_0049                -5.375792e-03 3 1  ON 48
ci_0050                -5.413875e-03 3 1  ON 49
ci_0051                -3.523377e-03 3 1  ON 50
ci_0052                -3.135409e-03 3 1  ON 51
ci_0053                -5.126526e-03 3 1  ON 52
ci_0054                -4.939440e-03 3 1  ON 53
ci_0055                 5.929760e-03 3 1  ON 54
ci_0056                 6.353418e-03 3 1  ON 55
ci_0057                 4.662015e-03 3 1  ON 56
ci_0058                 5.180922e-03 3 1  ON 57
ci_0059                -5.145709e-03 3 1  ON 58
ci_0060                -4.987303e-03 3 1  ON 59
ci_0061                -3.815029e-03 3 1  ON 60
ci_0062                -3.100743e-03 3 1  ON 61
ci_0063                -8.644015e-03 3 1  ON 62
ci_0064                -9.217244e-03 3 1  ON 63
ci_0065                -5.728087e-03 3 1  ON 64
ci_0066                -5.047911e-03 3 1  ON 65
ci_0067                -5.383584e-03 3 1  ON 66
ci_0068                -5.457269e-03 3 1  ON 67
ci_0069                 4.998239e-03 3 1  ON 68
ci_0070                 4.769776e-03 3 1  ON 69
ci_0071                 2.243950e-03 3 1  ON 70
ci_0072                 1.743358e-03 3 1  ON 71
ci_0073                 4.313095e-03 3 1  ON 72
ci_0074                 4.192333e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9211
    reference variance = 0.205241
====================================================
  Execution time = 1.4297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 1.9520e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409340807
                                         uncertainty =       0.003065466250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409340807
                                         uncertainty =       0.003065466250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756648
  error estimate for blocks of size 2^( 2) =       0.000415843863
  error estimate for blocks of size 2^( 3) =       0.000428872299
  error estimate for blocks of size 2^( 4) =       0.000441834571
  error estimate for blocks of size 2^( 5) =       0.000452815433
  error estimate for blocks of size 2^( 6) =       0.000461734078
  error estimate for blocks of size 2^( 7) =       0.000467558214

      target function =                  N/A
              le_mean =     -16.906165547417
             les_mean =     286.154650699756
             stat err =       0.000455985574
             autocorr =       1.281789678710
              std dev =       0.569583914390
             le_variance =       0.324425835532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409073836
                                         uncertainty =       0.003065447187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409073836
                                         uncertainty =       0.003065447187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756483
  error estimate for blocks of size 2^( 2) =       0.000415843702
  error estimate for blocks of size 2^( 3) =       0.000428872144
  error estimate for blocks of size 2^( 4) =       0.000441834423
  error estimate for blocks of size 2^( 5) =       0.000452815283
  error estimate for blocks of size 2^( 6) =       0.000461733929
  error estimate for blocks of size 2^( 7) =       0.000467558066

      target function =                  N/A
              le_mean =     -16.906165552129
             les_mean =     286.154650555537
             stat err =       0.000455985425
             autocorr =       1.281789891962
              std dev =       0.569583681108
             le_variance =       0.324425569785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409207300
                                         uncertainty =       0.003065456717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409207300
                                         uncertainty =       0.003065456717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756566
  error estimate for blocks of size 2^( 2) =       0.000415843783
  error estimate for blocks of size 2^( 3) =       0.000428872221
  error estimate for blocks of size 2^( 4) =       0.000441834497
  error estimate for blocks of size 2^( 5) =       0.000452815358
  error estimate for blocks of size 2^( 6) =       0.000461734004
  error estimate for blocks of size 2^( 7) =       0.000467558140

      target function =                  N/A
              le_mean =     -16.906165549773
             les_mean =     286.154650627555
             stat err =       0.000455985500
             autocorr =       1.281789785363
              std dev =       0.569583797730
             le_variance =       0.324425702637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409324118
                                         uncertainty =       0.003065465058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324409324118
                                         uncertainty =       0.003065465058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756638
  error estimate for blocks of size 2^( 2) =       0.000415843853
  error estimate for blocks of size 2^( 3) =       0.000428872289
  error estimate for blocks of size 2^( 4) =       0.000441834562
  error estimate for blocks of size 2^( 5) =       0.000452815424
  error estimate for blocks of size 2^( 6) =       0.000461734069
  error estimate for blocks of size 2^( 7) =       0.000467558205

      target function =                  N/A
              le_mean =     -16.906165547711
             les_mean =     286.154650690722
             stat err =       0.000455985565
             autocorr =       1.281789692046
              std dev =       0.569583899807
             le_variance =       0.324425818919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906165547417        initial
     1.5625e+03     1.5625e+04             2.2106e-07       -16.906165552129  <--
     6.2500e+03     6.2500e+04             5.5273e-08       -16.906165549773
     2.5000e+04     2.5000e+05             1.3819e-08       -16.906165547711

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.3782e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801962e-02 3 1  ON 2
ci_0004                -2.824564e-02 3 1  ON 3
ci_0005                -3.394592e-02 3 1  ON 4
ci_0006                -3.440053e-02 3 1  ON 5
ci_0007                -2.237548e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779349e-02 3 1  ON 8
ci_0010                -1.793010e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349916e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308743e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175193e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194799e-02 3 1  ON 19
ci_0021                 1.940103e-03 3 1  ON 20
ci_0022                 3.070881e-03 3 1  ON 21
ci_0023                -1.177484e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134774e-02 3 1  ON 24
ci_0026                -1.125978e-02 3 1  ON 25
ci_0027                -1.120288e-02 3 1  ON 26
ci_0028                -1.102661e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933898e-02 3 1  ON 30
ci_0032                 1.976884e-02 3 1  ON 31
ci_0033                 9.368871e-03 3 1  ON 32
ci_0034                 1.000588e-02 3 1  ON 33
ci_0035                 7.396591e-03 3 1  ON 34
ci_0036                 6.855771e-03 3 1  ON 35
ci_0037                -1.089294e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823200e-03 3 1  ON 38
ci_0040                -2.965100e-03 3 1  ON 39
ci_0041                 7.307010e-03 3 1  ON 40
ci_0042                 7.398061e-03 3 1  ON 41
ci_0043                -1.504581e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068205e-03 3 1  ON 44
ci_0046                 7.490876e-03 3 1  ON 45
ci_0047                -2.192761e-03 3 1  ON 46
ci_0048                -2.226995e-03 3 1  ON 47
ci_0049                -5.375843e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135416e-03 3 1  ON 51
ci_0053                -5.126586e-03 3 1  ON 52
ci_0054                -4.939277e-03 3 1  ON 53
ci_0055                 5.929814e-03 3 1  ON 54
ci_0056                 6.353483e-03 3 1  ON 55
ci_0057                 4.661944e-03 3 1  ON 56
ci_0058                 5.180938e-03 3 1  ON 57
ci_0059                -5.145543e-03 3 1  ON 58
ci_0060                -4.987275e-03 3 1  ON 59
ci_0061                -3.815020e-03 3 1  ON 60
ci_0062                -3.100772e-03 3 1  ON 61
ci_0063                -8.644053e-03 3 1  ON 62
ci_0064                -9.217106e-03 3 1  ON 63
ci_0065                -5.728051e-03 3 1  ON 64
ci_0066                -5.047981e-03 3 1  ON 65
ci_0067                -5.383492e-03 3 1  ON 66
ci_0068                -5.457270e-03 3 1  ON 67
ci_0069                 4.998207e-03 3 1  ON 68
ci_0070                 4.769722e-03 3 1  ON 69
ci_0071                 2.243785e-03 3 1  ON 70
ci_0072                 1.743248e-03 3 1  ON 71
ci_0073                 4.313073e-03 3 1  ON 72
ci_0074                 4.192246e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9256
    reference variance = 0.230493
====================================================
  Execution time = 1.4597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3416e-01
  Total weights = 1.951491776e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322002556440
                                         uncertainty =       0.002509379207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322002556440
                                         uncertainty =       0.002509379207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401201619
  error estimate for blocks of size 2^( 2) =       0.000413739711
  error estimate for blocks of size 2^( 3) =       0.000427154318
  error estimate for blocks of size 2^( 4) =       0.000439535161
  error estimate for blocks of size 2^( 5) =       0.000450041747
  error estimate for blocks of size 2^( 6) =       0.000457380358
  error estimate for blocks of size 2^( 7) =       0.000463710432

      target function =                  N/A
              le_mean =     -16.906346892260
             les_mean =     286.158723572131
             stat err =       0.000452666925
             autocorr =       1.273011041359
              std dev =       0.567384771519
             le_variance =       0.321925478951


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634689226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906346892266       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906346901036       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906346900322       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906346900234       residual = 1.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 7.881734e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906346892266       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906346894459       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906346894280       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906346894258       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+03 is 1.971837e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906346892266       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906346892814       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906346892769       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906346892764       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+03 is 4.930471e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7188e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801949e-02 3 1  ON 2
ci_0004                -2.824560e-02 3 1  ON 3
ci_0005                -3.394607e-02 3 1  ON 4
ci_0006                -3.440060e-02 3 1  ON 5
ci_0007                -2.237543e-02 3 1  ON 6
ci_0008                -2.248307e-02 3 1  ON 7
ci_0009                -1.779350e-02 3 1  ON 8
ci_0010                -1.793003e-02 3 1  ON 9
ci_0011                -1.242624e-02 3 1  ON 10
ci_0012                -1.269235e-02 3 1  ON 11
ci_0013                 1.336649e-02 3 1  ON 12
ci_0014                 1.349907e-02 3 1  ON 13
ci_0015                 1.365000e-02 3 1  ON 14
ci_0016                 1.308749e-02 3 1  ON 15
ci_0017                 1.160068e-02 3 1  ON 16
ci_0018                 1.175185e-02 3 1  ON 17
ci_0019                 1.188108e-02 3 1  ON 18
ci_0020                 1.194786e-02 3 1  ON 19
ci_0021                 1.940019e-03 3 1  ON 20
ci_0022                 3.070799e-03 3 1  ON 21
ci_0023                -1.177488e-02 3 1  ON 22
ci_0024                -1.107948e-02 3 1  ON 23
ci_0025                -1.134765e-02 3 1  ON 24
ci_0026                -1.125974e-02 3 1  ON 25
ci_0027                -1.120287e-02 3 1  ON 26
ci_0028                -1.102655e-02 3 1  ON 27
ci_0029                -1.080396e-02 3 1  ON 28
ci_0030                -1.022867e-02 3 1  ON 29
ci_0031                 1.933909e-02 3 1  ON 30
ci_0032                 1.976885e-02 3 1  ON 31
ci_0033                 9.368900e-03 3 1  ON 32
ci_0034                 1.000593e-02 3 1  ON 33
ci_0035                 7.396516e-03 3 1  ON 34
ci_0036                 6.855787e-03 3 1  ON 35
ci_0037                -1.089300e-02 3 1  ON 36
ci_0038                -1.066147e-02 3 1  ON 37
ci_0039                -2.823186e-03 3 1  ON 38
ci_0040                -2.964903e-03 3 1  ON 39
ci_0041                 7.307132e-03 3 1  ON 40
ci_0042                 7.398124e-03 3 1  ON 41
ci_0043                -1.504600e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068153e-03 3 1  ON 44
ci_0046                 7.490881e-03 3 1  ON 45
ci_0047                -2.192571e-03 3 1  ON 46
ci_0048                -2.226890e-03 3 1  ON 47
ci_0049                -5.375735e-03 3 1  ON 48
ci_0050                -5.413958e-03 3 1  ON 49
ci_0051                -3.523226e-03 3 1  ON 50
ci_0052                -3.135497e-03 3 1  ON 51
ci_0053                -5.126704e-03 3 1  ON 52
ci_0054                -4.939206e-03 3 1  ON 53
ci_0055                 5.929825e-03 3 1  ON 54
ci_0056                 6.353562e-03 3 1  ON 55
ci_0057                 4.661904e-03 3 1  ON 56
ci_0058                 5.180945e-03 3 1  ON 57
ci_0059                -5.145503e-03 3 1  ON 58
ci_0060                -4.987291e-03 3 1  ON 59
ci_0061                -3.814855e-03 3 1  ON 60
ci_0062                -3.100873e-03 3 1  ON 61
ci_0063                -8.644096e-03 3 1  ON 62
ci_0064                -9.216954e-03 3 1  ON 63
ci_0065                -5.728035e-03 3 1  ON 64
ci_0066                -5.048059e-03 3 1  ON 65
ci_0067                -5.383490e-03 3 1  ON 66
ci_0068                -5.457251e-03 3 1  ON 67
ci_0069                 4.998174e-03 3 1  ON 68
ci_0070                 4.769704e-03 3 1  ON 69
ci_0071                 2.243761e-03 3 1  ON 70
ci_0072                 1.743151e-03 3 1  ON 71
ci_0073                 4.313051e-03 3 1  ON 72
ci_0074                 4.192230e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.213657
====================================================
  Execution time = 1.4178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2896e-01
  Total weights = 1.9518e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086391984
                                         uncertainty =       0.001844664665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086391984
                                         uncertainty =       0.001844664665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399367495
  error estimate for blocks of size 2^( 2) =       0.000412319029
  error estimate for blocks of size 2^( 3) =       0.000425635705
  error estimate for blocks of size 2^( 4) =       0.000437739368
  error estimate for blocks of size 2^( 5) =       0.000449255237
  error estimate for blocks of size 2^( 6) =       0.000457409199
  error estimate for blocks of size 2^( 7) =       0.000461745137

      target function =                  N/A
              le_mean =     -16.907300007841
             les_mean =     286.185748542395
             stat err =       0.000451537235
             autocorr =       1.278326263250
              std dev =       0.564790927142
             le_variance =       0.318988791382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086139708
                                         uncertainty =       0.001844640658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086139708
                                         uncertainty =       0.001844640658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399367337
  error estimate for blocks of size 2^( 2) =       0.000412318867
  error estimate for blocks of size 2^( 3) =       0.000425635544
  error estimate for blocks of size 2^( 4) =       0.000437739210
  error estimate for blocks of size 2^( 5) =       0.000449255069
  error estimate for blocks of size 2^( 6) =       0.000457409022
  error estimate for blocks of size 2^( 7) =       0.000461744989

      target function =                  N/A
              le_mean =     -16.907300000380
             les_mean =     286.185748544803
             stat err =       0.000451537072
             autocorr =       1.278326351011
              std dev =       0.564790704080
             le_variance =       0.318988539415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086265754
                                         uncertainty =       0.001844652656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086265754
                                         uncertainty =       0.001844652656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399367416
  error estimate for blocks of size 2^( 2) =       0.000412318948
  error estimate for blocks of size 2^( 3) =       0.000425635624
  error estimate for blocks of size 2^( 4) =       0.000437739289
  error estimate for blocks of size 2^( 5) =       0.000449255153
  error estimate for blocks of size 2^( 6) =       0.000457409110
  error estimate for blocks of size 2^( 7) =       0.000461745063

      target function =                  N/A
              le_mean =     -16.907300004105
             les_mean =     286.185748542622
             stat err =       0.000451537154
             autocorr =       1.278326307179
              std dev =       0.564790815530
             le_variance =       0.318988665307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086376200
                                         uncertainty =       0.001844663164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319086376200
                                         uncertainty =       0.001844663164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399367485
  error estimate for blocks of size 2^( 2) =       0.000412319019
  error estimate for blocks of size 2^( 3) =       0.000425635695
  error estimate for blocks of size 2^( 4) =       0.000437739359
  error estimate for blocks of size 2^( 5) =       0.000449255226
  error estimate for blocks of size 2^( 6) =       0.000457409187
  error estimate for blocks of size 2^( 7) =       0.000461745128

      target function =                  N/A
              le_mean =     -16.907300007374
             les_mean =     286.185748542315
             stat err =       0.000451537225
             autocorr =       1.278326268745
              std dev =       0.564790913186
             le_variance =       0.318988775618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907300007841        initial  <--
     3.9062e+02     3.9062e+03             7.8817e-07       -16.907300000380
     1.5625e+03     1.5625e+04             1.9718e-07       -16.907300004105
     6.2500e+03     6.2500e+04             4.9305e-08       -16.907300007374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6455
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801962e-02 3 1  ON 2
ci_0004                -2.824564e-02 3 1  ON 3
ci_0005                -3.394592e-02 3 1  ON 4
ci_0006                -3.440053e-02 3 1  ON 5
ci_0007                -2.237548e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779349e-02 3 1  ON 8
ci_0010                -1.793010e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349916e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308743e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175193e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194799e-02 3 1  ON 19
ci_0021                 1.940103e-03 3 1  ON 20
ci_0022                 3.070881e-03 3 1  ON 21
ci_0023                -1.177484e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134774e-02 3 1  ON 24
ci_0026                -1.125978e-02 3 1  ON 25
ci_0027                -1.120288e-02 3 1  ON 26
ci_0028                -1.102661e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933898e-02 3 1  ON 30
ci_0032                 1.976884e-02 3 1  ON 31
ci_0033                 9.368871e-03 3 1  ON 32
ci_0034                 1.000588e-02 3 1  ON 33
ci_0035                 7.396591e-03 3 1  ON 34
ci_0036                 6.855771e-03 3 1  ON 35
ci_0037                -1.089294e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823200e-03 3 1  ON 38
ci_0040                -2.965100e-03 3 1  ON 39
ci_0041                 7.307010e-03 3 1  ON 40
ci_0042                 7.398061e-03 3 1  ON 41
ci_0043                -1.504581e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068205e-03 3 1  ON 44
ci_0046                 7.490876e-03 3 1  ON 45
ci_0047                -2.192761e-03 3 1  ON 46
ci_0048                -2.226995e-03 3 1  ON 47
ci_0049                -5.375843e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135416e-03 3 1  ON 51
ci_0053                -5.126586e-03 3 1  ON 52
ci_0054                -4.939277e-03 3 1  ON 53
ci_0055                 5.929814e-03 3 1  ON 54
ci_0056                 6.353483e-03 3 1  ON 55
ci_0057                 4.661944e-03 3 1  ON 56
ci_0058                 5.180938e-03 3 1  ON 57
ci_0059                -5.145543e-03 3 1  ON 58
ci_0060                -4.987275e-03 3 1  ON 59
ci_0061                -3.815020e-03 3 1  ON 60
ci_0062                -3.100772e-03 3 1  ON 61
ci_0063                -8.644053e-03 3 1  ON 62
ci_0064                -9.217106e-03 3 1  ON 63
ci_0065                -5.728051e-03 3 1  ON 64
ci_0066                -5.047981e-03 3 1  ON 65
ci_0067                -5.383492e-03 3 1  ON 66
ci_0068                -5.457270e-03 3 1  ON 67
ci_0069                 4.998207e-03 3 1  ON 68
ci_0070                 4.769722e-03 3 1  ON 69
ci_0071                 2.243785e-03 3 1  ON 70
ci_0072                 1.743248e-03 3 1  ON 71
ci_0073                 4.313073e-03 3 1  ON 72
ci_0074                 4.192246e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9678
    reference variance = 0.225841
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3113e-01
  Total weights = 1.951481231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320142925316
                                         uncertainty =       0.001882753626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320142925316
                                         uncertainty =       0.001882753626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400062772
  error estimate for blocks of size 2^( 2) =       0.000412670032
  error estimate for blocks of size 2^( 3) =       0.000425957000
  error estimate for blocks of size 2^( 4) =       0.000438042265
  error estimate for blocks of size 2^( 5) =       0.000448078965
  error estimate for blocks of size 2^( 6) =       0.000454425146
  error estimate for blocks of size 2^( 7) =       0.000460625541

      target function =                  N/A
              le_mean =     -16.906028342221
             les_mean =     286.144919814384
             stat err =       0.000450292979
             autocorr =       1.266875892097
              std dev =       0.565774198014
             le_variance =       0.320100443138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602834222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906028342210       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906028344115       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906028344151       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906028344170       residual = 4.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+03 is 8.643074e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906028342210       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906028342686       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906028342695       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906028342700       residual = 4.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+04 is 2.160849e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906028342210       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906028342329       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906028342331       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906028342333       residual = 4.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+04 is 5.402174e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7065e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801961e-02 3 1  ON 2
ci_0004                -2.824563e-02 3 1  ON 3
ci_0005                -3.394592e-02 3 1  ON 4
ci_0006                -3.440054e-02 3 1  ON 5
ci_0007                -2.237547e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779347e-02 3 1  ON 8
ci_0010                -1.793011e-02 3 1  ON 9
ci_0011                -1.242635e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349916e-02 3 1  ON 13
ci_0015                 1.364997e-02 3 1  ON 14
ci_0016                 1.308744e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175193e-02 3 1  ON 17
ci_0019                 1.188112e-02 3 1  ON 18
ci_0020                 1.194798e-02 3 1  ON 19
ci_0021                 1.940083e-03 3 1  ON 20
ci_0022                 3.070874e-03 3 1  ON 21
ci_0023                -1.177483e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134773e-02 3 1  ON 24
ci_0026                -1.125979e-02 3 1  ON 25
ci_0027                -1.120290e-02 3 1  ON 26
ci_0028                -1.102660e-02 3 1  ON 27
ci_0029                -1.080391e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933897e-02 3 1  ON 30
ci_0032                 1.976885e-02 3 1  ON 31
ci_0033                 9.368883e-03 3 1  ON 32
ci_0034                 1.000589e-02 3 1  ON 33
ci_0035                 7.396570e-03 3 1  ON 34
ci_0036                 6.855774e-03 3 1  ON 35
ci_0037                -1.089295e-02 3 1  ON 36
ci_0038                -1.066161e-02 3 1  ON 37
ci_0039                -2.823216e-03 3 1  ON 38
ci_0040                -2.965082e-03 3 1  ON 39
ci_0041                 7.306992e-03 3 1  ON 40
ci_0042                 7.398074e-03 3 1  ON 41
ci_0043                -1.504583e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068202e-03 3 1  ON 44
ci_0046                 7.490867e-03 3 1  ON 45
ci_0047                -2.192761e-03 3 1  ON 46
ci_0048                -2.226996e-03 3 1  ON 47
ci_0049                -5.375853e-03 3 1  ON 48
ci_0050                -5.413894e-03 3 1  ON 49
ci_0051                -3.523233e-03 3 1  ON 50
ci_0052                -3.135415e-03 3 1  ON 51
ci_0053                -5.126577e-03 3 1  ON 52
ci_0054                -4.939276e-03 3 1  ON 53
ci_0055                 5.929823e-03 3 1  ON 54
ci_0056                 6.353492e-03 3 1  ON 55
ci_0057                 4.661930e-03 3 1  ON 56
ci_0058                 5.180931e-03 3 1  ON 57
ci_0059                -5.145553e-03 3 1  ON 58
ci_0060                -4.987266e-03 3 1  ON 59
ci_0061                -3.815016e-03 3 1  ON 60
ci_0062                -3.100771e-03 3 1  ON 61
ci_0063                -8.644046e-03 3 1  ON 62
ci_0064                -9.217111e-03 3 1  ON 63
ci_0065                -5.728039e-03 3 1  ON 64
ci_0066                -5.047997e-03 3 1  ON 65
ci_0067                -5.383487e-03 3 1  ON 66
ci_0068                -5.457259e-03 3 1  ON 67
ci_0069                 4.998195e-03 3 1  ON 68
ci_0070                 4.769708e-03 3 1  ON 69
ci_0071                 2.243763e-03 3 1  ON 70
ci_0072                 1.743236e-03 3 1  ON 71
ci_0073                 4.313067e-03 3 1  ON 72
ci_0074                 4.192248e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 0.421012
====================================================
  Execution time = 1.4239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3667e-01
  Total weights = 1.9515e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388400847
                                         uncertainty =       0.002191973424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388400847
                                         uncertainty =       0.002191973424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402804371
  error estimate for blocks of size 2^( 2) =       0.000415443493
  error estimate for blocks of size 2^( 3) =       0.000428686824
  error estimate for blocks of size 2^( 4) =       0.000440665651
  error estimate for blocks of size 2^( 5) =       0.000451283192
  error estimate for blocks of size 2^( 6) =       0.000458262337
  error estimate for blocks of size 2^( 7) =       0.000464061289

      target function =                  N/A
              le_mean =     -16.907109782666
             les_mean =     286.187035266072
             stat err =       0.000453568117
             autocorr =       1.267934118865
              std dev =       0.569651404568
             le_variance =       0.324502722726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388383099
                                         uncertainty =       0.002191973117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388383099
                                         uncertainty =       0.002191973117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402804360
  error estimate for blocks of size 2^( 2) =       0.000415443483
  error estimate for blocks of size 2^( 3) =       0.000428686816
  error estimate for blocks of size 2^( 4) =       0.000440665642
  error estimate for blocks of size 2^( 5) =       0.000451283180
  error estimate for blocks of size 2^( 6) =       0.000458262323
  error estimate for blocks of size 2^( 7) =       0.000464061278

      target function =                  N/A
              le_mean =     -16.907109782552
             les_mean =     286.187034607113
             stat err =       0.000453568106
             autocorr =       1.267934125255
              std dev =       0.569651388740
             le_variance =       0.324502704693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388391971
                                         uncertainty =       0.002191973270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388391971
                                         uncertainty =       0.002191973270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402804365
  error estimate for blocks of size 2^( 2) =       0.000415443488
  error estimate for blocks of size 2^( 3) =       0.000428686820
  error estimate for blocks of size 2^( 4) =       0.000440665646
  error estimate for blocks of size 2^( 5) =       0.000451283186
  error estimate for blocks of size 2^( 6) =       0.000458262330
  error estimate for blocks of size 2^( 7) =       0.000464061283

      target function =                  N/A
              le_mean =     -16.907109782609
             les_mean =     286.187034935716
             stat err =       0.000453568111
             autocorr =       1.267934122064
              std dev =       0.569651396652
             le_variance =       0.324502713708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388399737
                                         uncertainty =       0.002191973404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324388399737
                                         uncertainty =       0.002191973404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402804370
  error estimate for blocks of size 2^( 2) =       0.000415443492
  error estimate for blocks of size 2^( 3) =       0.000428686824
  error estimate for blocks of size 2^( 4) =       0.000440665650
  error estimate for blocks of size 2^( 5) =       0.000451283191
  error estimate for blocks of size 2^( 6) =       0.000458262336
  error estimate for blocks of size 2^( 7) =       0.000464061288

      target function =                  N/A
              le_mean =     -16.907109782659
             les_mean =     286.187035224683
             stat err =       0.000453568116
             autocorr =       1.267934119264
              std dev =       0.569651403578
             le_variance =       0.324502721598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907109782666        initial  <--
     3.9062e+03     3.9062e+04             8.6431e-08       -16.907109782552
     1.5625e+04     1.5625e+05             2.1608e-08       -16.907109782609
     6.2500e+04     6.2500e+05             5.4022e-09       -16.907109782659

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7367
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801962e-02 3 1  ON 2
ci_0004                -2.824564e-02 3 1  ON 3
ci_0005                -3.394592e-02 3 1  ON 4
ci_0006                -3.440053e-02 3 1  ON 5
ci_0007                -2.237548e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779349e-02 3 1  ON 8
ci_0010                -1.793010e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349916e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308743e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175193e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194799e-02 3 1  ON 19
ci_0021                 1.940103e-03 3 1  ON 20
ci_0022                 3.070881e-03 3 1  ON 21
ci_0023                -1.177484e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134774e-02 3 1  ON 24
ci_0026                -1.125978e-02 3 1  ON 25
ci_0027                -1.120288e-02 3 1  ON 26
ci_0028                -1.102661e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933898e-02 3 1  ON 30
ci_0032                 1.976884e-02 3 1  ON 31
ci_0033                 9.368871e-03 3 1  ON 32
ci_0034                 1.000588e-02 3 1  ON 33
ci_0035                 7.396591e-03 3 1  ON 34
ci_0036                 6.855771e-03 3 1  ON 35
ci_0037                -1.089294e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823200e-03 3 1  ON 38
ci_0040                -2.965100e-03 3 1  ON 39
ci_0041                 7.307010e-03 3 1  ON 40
ci_0042                 7.398061e-03 3 1  ON 41
ci_0043                -1.504581e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068205e-03 3 1  ON 44
ci_0046                 7.490876e-03 3 1  ON 45
ci_0047                -2.192761e-03 3 1  ON 46
ci_0048                -2.226995e-03 3 1  ON 47
ci_0049                -5.375843e-03 3 1  ON 48
ci_0050                -5.413892e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135416e-03 3 1  ON 51
ci_0053                -5.126586e-03 3 1  ON 52
ci_0054                -4.939277e-03 3 1  ON 53
ci_0055                 5.929814e-03 3 1  ON 54
ci_0056                 6.353483e-03 3 1  ON 55
ci_0057                 4.661944e-03 3 1  ON 56
ci_0058                 5.180938e-03 3 1  ON 57
ci_0059                -5.145543e-03 3 1  ON 58
ci_0060                -4.987275e-03 3 1  ON 59
ci_0061                -3.815020e-03 3 1  ON 60
ci_0062                -3.100772e-03 3 1  ON 61
ci_0063                -8.644053e-03 3 1  ON 62
ci_0064                -9.217106e-03 3 1  ON 63
ci_0065                -5.728051e-03 3 1  ON 64
ci_0066                -5.047981e-03 3 1  ON 65
ci_0067                -5.383492e-03 3 1  ON 66
ci_0068                -5.457270e-03 3 1  ON 67
ci_0069                 4.998207e-03 3 1  ON 68
ci_0070                 4.769722e-03 3 1  ON 69
ci_0071                 2.243785e-03 3 1  ON 70
ci_0072                 1.743248e-03 3 1  ON 71
ci_0073                 4.313073e-03 3 1  ON 72
ci_0074                 4.192246e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.18905
====================================================
  Execution time = 1.4517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3807e-01
  Total weights = 1.951468285e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323668206151
                                         uncertainty =       0.002354124043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323668206151
                                         uncertainty =       0.002354124043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402249221
  error estimate for blocks of size 2^( 2) =       0.000414932675
  error estimate for blocks of size 2^( 3) =       0.000427698738
  error estimate for blocks of size 2^( 4) =       0.000440927494
  error estimate for blocks of size 2^( 5) =       0.000452842078
  error estimate for blocks of size 2^( 6) =       0.000460744617
  error estimate for blocks of size 2^( 7) =       0.000466916760

      target function =                  N/A
              le_mean =     -16.905553148947
             les_mean =     286.135796552357
             stat err =       0.000455357738
             autocorr =       1.281489401189
              std dev =       0.568866303344
             le_variance =       0.323608871080


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555314895e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905553148937       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905553149261       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905553149245       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905553149248       residual = 6.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+04 is 9.887896e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905553148937       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905553149018       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905553149014       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905553149002       residual = 6.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+05 is 2.471985e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905553148937       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905553148957       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905553148957       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905553148955       residual = 6.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+05 is 6.179970e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7103e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801962e-02 3 1  ON 2
ci_0004                -2.824564e-02 3 1  ON 3
ci_0005                -3.394592e-02 3 1  ON 4
ci_0006                -3.440053e-02 3 1  ON 5
ci_0007                -2.237548e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779349e-02 3 1  ON 8
ci_0010                -1.793010e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349916e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308743e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175193e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194799e-02 3 1  ON 19
ci_0021                 1.940103e-03 3 1  ON 20
ci_0022                 3.070880e-03 3 1  ON 21
ci_0023                -1.177485e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134774e-02 3 1  ON 24
ci_0026                -1.125978e-02 3 1  ON 25
ci_0027                -1.120288e-02 3 1  ON 26
ci_0028                -1.102661e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933898e-02 3 1  ON 30
ci_0032                 1.976884e-02 3 1  ON 31
ci_0033                 9.368871e-03 3 1  ON 32
ci_0034                 1.000588e-02 3 1  ON 33
ci_0035                 7.396592e-03 3 1  ON 34
ci_0036                 6.855772e-03 3 1  ON 35
ci_0037                -1.089294e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823199e-03 3 1  ON 38
ci_0040                -2.965099e-03 3 1  ON 39
ci_0041                 7.307009e-03 3 1  ON 40
ci_0042                 7.398061e-03 3 1  ON 41
ci_0043                -1.504581e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068203e-03 3 1  ON 44
ci_0046                 7.490876e-03 3 1  ON 45
ci_0047                -2.192759e-03 3 1  ON 46
ci_0048                -2.226994e-03 3 1  ON 47
ci_0049                -5.375844e-03 3 1  ON 48
ci_0050                -5.413894e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135416e-03 3 1  ON 51
ci_0053                -5.126586e-03 3 1  ON 52
ci_0054                -4.939277e-03 3 1  ON 53
ci_0055                 5.929814e-03 3 1  ON 54
ci_0056                 6.353485e-03 3 1  ON 55
ci_0057                 4.661945e-03 3 1  ON 56
ci_0058                 5.180936e-03 3 1  ON 57
ci_0059                -5.145543e-03 3 1  ON 58
ci_0060                -4.987274e-03 3 1  ON 59
ci_0061                -3.815020e-03 3 1  ON 60
ci_0062                -3.100772e-03 3 1  ON 61
ci_0063                -8.644053e-03 3 1  ON 62
ci_0064                -9.217105e-03 3 1  ON 63
ci_0065                -5.728051e-03 3 1  ON 64
ci_0066                -5.047982e-03 3 1  ON 65
ci_0067                -5.383491e-03 3 1  ON 66
ci_0068                -5.457271e-03 3 1  ON 67
ci_0069                 4.998206e-03 3 1  ON 68
ci_0070                 4.769721e-03 3 1  ON 69
ci_0071                 2.243783e-03 3 1  ON 70
ci_0072                 1.743248e-03 3 1  ON 71
ci_0073                 4.313072e-03 3 1  ON 72
ci_0074                 4.192245e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9487
    reference variance = 0.362637
====================================================
  Execution time = 1.6366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3517e-01
  Total weights = 1.9516e+06
  Execution time = 1.8978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464191779
                                         uncertainty =       0.002186999572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464191779
                                         uncertainty =       0.002186999572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401482627
  error estimate for blocks of size 2^( 2) =       0.000414385919
  error estimate for blocks of size 2^( 3) =       0.000427934391
  error estimate for blocks of size 2^( 4) =       0.000440162443
  error estimate for blocks of size 2^( 5) =       0.000451529448
  error estimate for blocks of size 2^( 6) =       0.000460854248
  error estimate for blocks of size 2^( 7) =       0.000466588659

      target function =                  N/A
              le_mean =     -16.905333035922
             les_mean =     286.125458243207
             stat err =       0.000454783700
             autocorr =       1.283146566232
              std dev =       0.567782176228
             le_variance =       0.322376599642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464184541
                                         uncertainty =       0.002186999312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464184541
                                         uncertainty =       0.002186999312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401482623
  error estimate for blocks of size 2^( 2) =       0.000414385915
  error estimate for blocks of size 2^( 3) =       0.000427934387
  error estimate for blocks of size 2^( 4) =       0.000440162439
  error estimate for blocks of size 2^( 5) =       0.000451529444
  error estimate for blocks of size 2^( 6) =       0.000460854243
  error estimate for blocks of size 2^( 7) =       0.000466588654

      target function =                  N/A
              le_mean =     -16.905333036014
             les_mean =     286.125458238591
             stat err =       0.000454783695
             autocorr =       1.283146569527
              std dev =       0.567782169859
             le_variance =       0.322376592410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464188160
                                         uncertainty =       0.002186999442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464188160
                                         uncertainty =       0.002186999442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401482625
  error estimate for blocks of size 2^( 2) =       0.000414385917
  error estimate for blocks of size 2^( 3) =       0.000427934389
  error estimate for blocks of size 2^( 4) =       0.000440162441
  error estimate for blocks of size 2^( 5) =       0.000451529446
  error estimate for blocks of size 2^( 6) =       0.000460854246
  error estimate for blocks of size 2^( 7) =       0.000466588656

      target function =                  N/A
              le_mean =     -16.905333035968
             les_mean =     286.125458240899
             stat err =       0.000454783697
             autocorr =       1.283146567880
              std dev =       0.567782173044
             le_variance =       0.322376596026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464191327
                                         uncertainty =       0.002186999556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322464191327
                                         uncertainty =       0.002186999556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401482627
  error estimate for blocks of size 2^( 2) =       0.000414385919
  error estimate for blocks of size 2^( 3) =       0.000427934391
  error estimate for blocks of size 2^( 4) =       0.000440162443
  error estimate for blocks of size 2^( 5) =       0.000451529448
  error estimate for blocks of size 2^( 6) =       0.000460854248
  error estimate for blocks of size 2^( 7) =       0.000466588659

      target function =                  N/A
              le_mean =     -16.905333035928
             les_mean =     286.125458242918
             stat err =       0.000454783699
             autocorr =       1.283146566433
              std dev =       0.567782175830
             le_variance =       0.322376599190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905333035922        initial
     3.9062e+04     3.9062e+05             9.8879e-09       -16.905333036014  <--
     1.5625e+05     1.5625e+06             2.4720e-09       -16.905333035968
     6.2500e+05     6.2500e+06             6.1800e-10       -16.905333035928

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 2.5926e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801961e-02 3 1  ON 2
ci_0004                -2.824563e-02 3 1  ON 3
ci_0005                -3.394592e-02 3 1  ON 4
ci_0006                -3.440054e-02 3 1  ON 5
ci_0007                -2.237548e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779348e-02 3 1  ON 8
ci_0010                -1.793009e-02 3 1  ON 9
ci_0011                -1.242635e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349916e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308743e-02 3 1  ON 15
ci_0017                 1.160056e-02 3 1  ON 16
ci_0018                 1.175193e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194799e-02 3 1  ON 19
ci_0021                 1.940101e-03 3 1  ON 20
ci_0022                 3.070877e-03 3 1  ON 21
ci_0023                -1.177485e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134773e-02 3 1  ON 24
ci_0026                -1.125977e-02 3 1  ON 25
ci_0027                -1.120288e-02 3 1  ON 26
ci_0028                -1.102661e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933899e-02 3 1  ON 30
ci_0032                 1.976884e-02 3 1  ON 31
ci_0033                 9.368872e-03 3 1  ON 32
ci_0034                 1.000588e-02 3 1  ON 33
ci_0035                 7.396595e-03 3 1  ON 34
ci_0036                 6.855772e-03 3 1  ON 35
ci_0037                -1.089293e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823197e-03 3 1  ON 38
ci_0040                -2.965096e-03 3 1  ON 39
ci_0041                 7.307008e-03 3 1  ON 40
ci_0042                 7.398062e-03 3 1  ON 41
ci_0043                -1.504582e-02 3 1  ON 42
ci_0044                -1.572277e-02 3 1  ON 43
ci_0045                 8.068199e-03 3 1  ON 44
ci_0046                 7.490876e-03 3 1  ON 45
ci_0047                -2.192755e-03 3 1  ON 46
ci_0048                -2.226993e-03 3 1  ON 47
ci_0049                -5.375846e-03 3 1  ON 48
ci_0050                -5.413899e-03 3 1  ON 49
ci_0051                -3.523237e-03 3 1  ON 50
ci_0052                -3.135418e-03 3 1  ON 51
ci_0053                -5.126587e-03 3 1  ON 52
ci_0054                -4.939276e-03 3 1  ON 53
ci_0055                 5.929813e-03 3 1  ON 54
ci_0056                 6.353492e-03 3 1  ON 55
ci_0057                 4.661945e-03 3 1  ON 56
ci_0058                 5.180932e-03 3 1  ON 57
ci_0059                -5.145541e-03 3 1  ON 58
ci_0060                -4.987273e-03 3 1  ON 59
ci_0061                -3.815018e-03 3 1  ON 60
ci_0062                -3.100772e-03 3 1  ON 61
ci_0063                -8.644052e-03 3 1  ON 62
ci_0064                -9.217103e-03 3 1  ON 63
ci_0065                -5.728050e-03 3 1  ON 64
ci_0066                -5.047985e-03 3 1  ON 65
ci_0067                -5.383488e-03 3 1  ON 66
ci_0068                -5.457273e-03 3 1  ON 67
ci_0069                 4.998203e-03 3 1  ON 68
ci_0070                 4.769717e-03 3 1  ON 69
ci_0071                 2.243777e-03 3 1  ON 70
ci_0072                 1.743247e-03 3 1  ON 71
ci_0073                 4.313069e-03 3 1  ON 72
ci_0074                 4.192242e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8573
    reference variance = 0.481372
====================================================
  Execution time = 1.4340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3259e-01
  Total weights = 1.951802121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321023214644
                                         uncertainty =       0.001925937504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321023214644
                                         uncertainty =       0.001925937504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400666951
  error estimate for blocks of size 2^( 2) =       0.000413516517
  error estimate for blocks of size 2^( 3) =       0.000426971694
  error estimate for blocks of size 2^( 4) =       0.000438956596
  error estimate for blocks of size 2^( 5) =       0.000450213162
  error estimate for blocks of size 2^( 6) =       0.000459485998
  error estimate for blocks of size 2^( 7) =       0.000464873584

      target function =                  N/A
              le_mean =     -16.906061821490
             les_mean =     286.147519516280
             stat err =       0.000453382335
             autocorr =       1.280448592021
              std dev =       0.566628636467
             le_variance =       0.321068011664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606182149e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061821509       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061821407       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906061821443       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906061821440       residual = 3.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 3.824876e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061821509       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061821484       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906061821493       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906061821492       residual = 3.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+04 is 9.562376e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061821509       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061821503       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906061821505       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906061821454       residual = 3.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+05 is 2.390606e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6901e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801961e-02 3 1  ON 2
ci_0004                -2.824563e-02 3 1  ON 3
ci_0005                -3.394593e-02 3 1  ON 4
ci_0006                -3.440054e-02 3 1  ON 5
ci_0007                -2.237547e-02 3 1  ON 6
ci_0008                -2.248299e-02 3 1  ON 7
ci_0009                -1.779348e-02 3 1  ON 8
ci_0010                -1.793009e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349915e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308744e-02 3 1  ON 15
ci_0017                 1.160055e-02 3 1  ON 16
ci_0018                 1.175192e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194798e-02 3 1  ON 19
ci_0021                 1.940100e-03 3 1  ON 20
ci_0022                 3.070874e-03 3 1  ON 21
ci_0023                -1.177484e-02 3 1  ON 22
ci_0024                -1.107956e-02 3 1  ON 23
ci_0025                -1.134773e-02 3 1  ON 24
ci_0026                -1.125977e-02 3 1  ON 25
ci_0027                -1.120289e-02 3 1  ON 26
ci_0028                -1.102662e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022855e-02 3 1  ON 29
ci_0031                 1.933899e-02 3 1  ON 30
ci_0032                 1.976884e-02 3 1  ON 31
ci_0033                 9.368867e-03 3 1  ON 32
ci_0034                 1.000588e-02 3 1  ON 33
ci_0035                 7.396592e-03 3 1  ON 34
ci_0036                 6.855777e-03 3 1  ON 35
ci_0037                -1.089293e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823195e-03 3 1  ON 38
ci_0040                -2.965097e-03 3 1  ON 39
ci_0041                 7.307004e-03 3 1  ON 40
ci_0042                 7.398060e-03 3 1  ON 41
ci_0043                -1.504582e-02 3 1  ON 42
ci_0044                -1.572278e-02 3 1  ON 43
ci_0045                 8.068199e-03 3 1  ON 44
ci_0046                 7.490882e-03 3 1  ON 45
ci_0047                -2.192753e-03 3 1  ON 46
ci_0048                -2.226989e-03 3 1  ON 47
ci_0049                -5.375845e-03 3 1  ON 48
ci_0050                -5.413900e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135419e-03 3 1  ON 51
ci_0053                -5.126587e-03 3 1  ON 52
ci_0054                -4.939274e-03 3 1  ON 53
ci_0055                 5.929819e-03 3 1  ON 54
ci_0056                 6.353490e-03 3 1  ON 55
ci_0057                 4.661945e-03 3 1  ON 56
ci_0058                 5.180934e-03 3 1  ON 57
ci_0059                -5.145534e-03 3 1  ON 58
ci_0060                -4.987276e-03 3 1  ON 59
ci_0061                -3.815017e-03 3 1  ON 60
ci_0062                -3.100771e-03 3 1  ON 61
ci_0063                -8.644051e-03 3 1  ON 62
ci_0064                -9.217097e-03 3 1  ON 63
ci_0065                -5.728048e-03 3 1  ON 64
ci_0066                -5.047987e-03 3 1  ON 65
ci_0067                -5.383486e-03 3 1  ON 66
ci_0068                -5.457269e-03 3 1  ON 67
ci_0069                 4.998195e-03 3 1  ON 68
ci_0070                 4.769713e-03 3 1  ON 69
ci_0071                 2.243769e-03 3 1  ON 70
ci_0072                 1.743247e-03 3 1  ON 71
ci_0073                 4.313071e-03 3 1  ON 72
ci_0074                 4.192242e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9289
    reference variance = 0.215336
====================================================
  Execution time = 1.4090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3633e-01
  Total weights = 1.9519e+06
  Execution time = 1.8765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653910636
                                         uncertainty =       0.002406235498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653910636
                                         uncertainty =       0.002406235498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402210904
  error estimate for blocks of size 2^( 2) =       0.000415458155
  error estimate for blocks of size 2^( 3) =       0.000428655381
  error estimate for blocks of size 2^( 4) =       0.000440490629
  error estimate for blocks of size 2^( 5) =       0.000451983412
  error estimate for blocks of size 2^( 6) =       0.000462466725
  error estimate for blocks of size 2^( 7) =       0.000469808158

      target function =                  N/A
              le_mean =     -16.905717392302
             les_mean =     286.139607590774
             stat err =       0.000456187231
             autocorr =       1.286407514887
              std dev =       0.568812115815
             le_variance =       0.323547223098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653907354
                                         uncertainty =       0.002406236555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653907354
                                         uncertainty =       0.002406236555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402210902
  error estimate for blocks of size 2^( 2) =       0.000415458154
  error estimate for blocks of size 2^( 3) =       0.000428655381
  error estimate for blocks of size 2^( 4) =       0.000440490629
  error estimate for blocks of size 2^( 5) =       0.000451983412
  error estimate for blocks of size 2^( 6) =       0.000462466727
  error estimate for blocks of size 2^( 7) =       0.000469808159

      target function =                  N/A
              le_mean =     -16.905717393147
             les_mean =     286.139607476212
             stat err =       0.000456187232
             autocorr =       1.286407533394
              std dev =       0.568812112938
             le_variance =       0.323547219825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653908995
                                         uncertainty =       0.002406236026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653908995
                                         uncertainty =       0.002406236026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402210903
  error estimate for blocks of size 2^( 2) =       0.000415458154
  error estimate for blocks of size 2^( 3) =       0.000428655381
  error estimate for blocks of size 2^( 4) =       0.000440490629
  error estimate for blocks of size 2^( 5) =       0.000451983412
  error estimate for blocks of size 2^( 6) =       0.000462466726
  error estimate for blocks of size 2^( 7) =       0.000469808159

      target function =                  N/A
              le_mean =     -16.905717392725
             les_mean =     286.139607533476
             stat err =       0.000456187231
             autocorr =       1.286407524144
              std dev =       0.568812114376
             le_variance =       0.323547221461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653910431
                                         uncertainty =       0.002406235564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323653910431
                                         uncertainty =       0.002406235564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402210904
  error estimate for blocks of size 2^( 2) =       0.000415458155
  error estimate for blocks of size 2^( 3) =       0.000428655381
  error estimate for blocks of size 2^( 4) =       0.000440490629
  error estimate for blocks of size 2^( 5) =       0.000451983412
  error estimate for blocks of size 2^( 6) =       0.000462466725
  error estimate for blocks of size 2^( 7) =       0.000469808158

      target function =                  N/A
              le_mean =     -16.905717392355
             les_mean =     286.139607583610
             stat err =       0.000456187231
             autocorr =       1.286407516053
              std dev =       0.568812115635
             le_variance =       0.323547222893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905717392302        initial
     9.7656e+03     9.7656e+04             3.8249e-08       -16.905717393147  <--
     3.9062e+04     3.9062e+05             9.5624e-09       -16.905717392725
     1.5625e+05     1.5625e+06             2.3906e-09       -16.905717392355

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.3572e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801961e-02 3 1  ON 2
ci_0004                -2.824561e-02 3 1  ON 3
ci_0005                -3.394594e-02 3 1  ON 4
ci_0006                -3.440054e-02 3 1  ON 5
ci_0007                -2.237547e-02 3 1  ON 6
ci_0008                -2.248300e-02 3 1  ON 7
ci_0009                -1.779348e-02 3 1  ON 8
ci_0010                -1.793008e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269238e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349914e-02 3 1  ON 13
ci_0015                 1.364997e-02 3 1  ON 14
ci_0016                 1.308746e-02 3 1  ON 15
ci_0017                 1.160053e-02 3 1  ON 16
ci_0018                 1.175192e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194797e-02 3 1  ON 19
ci_0021                 1.940099e-03 3 1  ON 20
ci_0022                 3.070865e-03 3 1  ON 21
ci_0023                -1.177481e-02 3 1  ON 22
ci_0024                -1.107957e-02 3 1  ON 23
ci_0025                -1.134773e-02 3 1  ON 24
ci_0026                -1.125976e-02 3 1  ON 25
ci_0027                -1.120290e-02 3 1  ON 26
ci_0028                -1.102663e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022856e-02 3 1  ON 29
ci_0031                 1.933898e-02 3 1  ON 30
ci_0032                 1.976885e-02 3 1  ON 31
ci_0033                 9.368851e-03 3 1  ON 32
ci_0034                 1.000587e-02 3 1  ON 33
ci_0035                 7.396585e-03 3 1  ON 34
ci_0036                 6.855791e-03 3 1  ON 35
ci_0037                -1.089294e-02 3 1  ON 36
ci_0038                -1.066160e-02 3 1  ON 37
ci_0039                -2.823187e-03 3 1  ON 38
ci_0040                -2.965101e-03 3 1  ON 39
ci_0041                 7.306992e-03 3 1  ON 40
ci_0042                 7.398056e-03 3 1  ON 41
ci_0043                -1.504582e-02 3 1  ON 42
ci_0044                -1.572280e-02 3 1  ON 43
ci_0045                 8.068197e-03 3 1  ON 44
ci_0046                 7.490901e-03 3 1  ON 45
ci_0047                -2.192748e-03 3 1  ON 46
ci_0048                -2.226978e-03 3 1  ON 47
ci_0049                -5.375840e-03 3 1  ON 48
ci_0050                -5.413904e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135424e-03 3 1  ON 51
ci_0053                -5.126585e-03 3 1  ON 52
ci_0054                -4.939266e-03 3 1  ON 53
ci_0055                 5.929836e-03 3 1  ON 54
ci_0056                 6.353484e-03 3 1  ON 55
ci_0057                 4.661944e-03 3 1  ON 56
ci_0058                 5.180940e-03 3 1  ON 57
ci_0059                -5.145512e-03 3 1  ON 58
ci_0060                -4.987285e-03 3 1  ON 59
ci_0061                -3.815013e-03 3 1  ON 60
ci_0062                -3.100771e-03 3 1  ON 61
ci_0063                -8.644049e-03 3 1  ON 62
ci_0064                -9.217081e-03 3 1  ON 63
ci_0065                -5.728040e-03 3 1  ON 64
ci_0066                -5.047992e-03 3 1  ON 65
ci_0067                -5.383480e-03 3 1  ON 66
ci_0068                -5.457256e-03 3 1  ON 67
ci_0069                 4.998171e-03 3 1  ON 68
ci_0070                 4.769702e-03 3 1  ON 69
ci_0071                 2.243745e-03 3 1  ON 70
ci_0072                 1.743248e-03 3 1  ON 71
ci_0073                 4.313078e-03 3 1  ON 72
ci_0074                 4.192240e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8406
    reference variance = 0.220299
====================================================
  Execution time = 1.4406e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3615e-01
  Total weights = 1.951875238e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325091480456
                                         uncertainty =       0.002987354097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325091480456
                                         uncertainty =       0.002987354097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403160078
  error estimate for blocks of size 2^( 2) =       0.000415529601
  error estimate for blocks of size 2^( 3) =       0.000428474610
  error estimate for blocks of size 2^( 4) =       0.000439880062
  error estimate for blocks of size 2^( 5) =       0.000450393421
  error estimate for blocks of size 2^( 6) =       0.000457857999
  error estimate for blocks of size 2^( 7) =       0.000461907981

      target function =                  N/A
              le_mean =     -16.907549845038
             les_mean =     286.201391561837
             stat err =       0.000452509866
             autocorr =       1.259798431959
              std dev =       0.570154449845
             le_variance =       0.325076096678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690754984504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907549845061       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907549846194       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907549846101       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907549846108       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.585378e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907549845061       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907549845344       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907549845321       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907549845323       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 3.963842e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907549845061       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907549845132       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907549845126       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907549845088       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+04 is 9.909853e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6986e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801959e-02 3 1  ON 2
ci_0004                -2.824560e-02 3 1  ON 3
ci_0005                -3.394596e-02 3 1  ON 4
ci_0006                -3.440056e-02 3 1  ON 5
ci_0007                -2.237546e-02 3 1  ON 6
ci_0008                -2.248301e-02 3 1  ON 7
ci_0009                -1.779346e-02 3 1  ON 8
ci_0010                -1.793007e-02 3 1  ON 9
ci_0011                -1.242634e-02 3 1  ON 10
ci_0012                -1.269237e-02 3 1  ON 11
ci_0013                 1.336641e-02 3 1  ON 12
ci_0014                 1.349913e-02 3 1  ON 13
ci_0015                 1.364998e-02 3 1  ON 14
ci_0016                 1.308747e-02 3 1  ON 15
ci_0017                 1.160052e-02 3 1  ON 16
ci_0018                 1.175192e-02 3 1  ON 17
ci_0019                 1.188111e-02 3 1  ON 18
ci_0020                 1.194796e-02 3 1  ON 19
ci_0021                 1.940078e-03 3 1  ON 20
ci_0022                 3.070856e-03 3 1  ON 21
ci_0023                -1.177479e-02 3 1  ON 22
ci_0024                -1.107958e-02 3 1  ON 23
ci_0025                -1.134772e-02 3 1  ON 24
ci_0026                -1.125975e-02 3 1  ON 25
ci_0027                -1.120289e-02 3 1  ON 26
ci_0028                -1.102665e-02 3 1  ON 27
ci_0029                -1.080391e-02 3 1  ON 28
ci_0030                -1.022857e-02 3 1  ON 29
ci_0031                 1.933900e-02 3 1  ON 30
ci_0032                 1.976886e-02 3 1  ON 31
ci_0033                 9.368875e-03 3 1  ON 32
ci_0034                 1.000587e-02 3 1  ON 33
ci_0035                 7.396579e-03 3 1  ON 34
ci_0036                 6.855780e-03 3 1  ON 35
ci_0037                -1.089293e-02 3 1  ON 36
ci_0038                -1.066161e-02 3 1  ON 37
ci_0039                -2.823193e-03 3 1  ON 38
ci_0040                -2.965081e-03 3 1  ON 39
ci_0041                 7.306998e-03 3 1  ON 40
ci_0042                 7.398067e-03 3 1  ON 41
ci_0043                -1.504585e-02 3 1  ON 42
ci_0044                -1.572281e-02 3 1  ON 43
ci_0045                 8.068183e-03 3 1  ON 44
ci_0046                 7.490893e-03 3 1  ON 45
ci_0047                -2.192741e-03 3 1  ON 46
ci_0048                -2.226971e-03 3 1  ON 47
ci_0049                -5.375858e-03 3 1  ON 48
ci_0050                -5.413905e-03 3 1  ON 49
ci_0051                -3.523237e-03 3 1  ON 50
ci_0052                -3.135439e-03 3 1  ON 51
ci_0053                -5.126607e-03 3 1  ON 52
ci_0054                -4.939259e-03 3 1  ON 53
ci_0055                 5.929849e-03 3 1  ON 54
ci_0056                 6.353485e-03 3 1  ON 55
ci_0057                 4.661957e-03 3 1  ON 56
ci_0058                 5.180925e-03 3 1  ON 57
ci_0059                -5.145505e-03 3 1  ON 58
ci_0060                -4.987273e-03 3 1  ON 59
ci_0061                -3.815003e-03 3 1  ON 60
ci_0062                -3.100773e-03 3 1  ON 61
ci_0063                -8.644040e-03 3 1  ON 62
ci_0064                -9.217072e-03 3 1  ON 63
ci_0065                -5.728033e-03 3 1  ON 64
ci_0066                -5.048012e-03 3 1  ON 65
ci_0067                -5.383480e-03 3 1  ON 66
ci_0068                -5.457216e-03 3 1  ON 67
ci_0069                 4.998144e-03 3 1  ON 68
ci_0070                 4.769711e-03 3 1  ON 69
ci_0071                 2.243719e-03 3 1  ON 70
ci_0072                 1.743231e-03 3 1  ON 71
ci_0073                 4.313075e-03 3 1  ON 72
ci_0074                 4.192241e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8757
    reference variance = 0.188508
====================================================
  Execution time = 1.3983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3473e-01
  Total weights = 1.9519e+06
  Execution time = 1.8870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750295217
                                         uncertainty =       0.002509107128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750295217
                                         uncertainty =       0.002509107128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401076426
  error estimate for blocks of size 2^( 2) =       0.000413926168
  error estimate for blocks of size 2^( 3) =       0.000426511904
  error estimate for blocks of size 2^( 4) =       0.000438100126
  error estimate for blocks of size 2^( 5) =       0.000448427558
  error estimate for blocks of size 2^( 6) =       0.000455739428
  error estimate for blocks of size 2^( 7) =       0.000461655659

      target function =                  N/A
              le_mean =     -16.906345047846
             les_mean =     286.159233337338
             stat err =       0.000450980693
             autocorr =       1.264333441761
              std dev =       0.567207721591
             le_variance =       0.321724599432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750230848
                                         uncertainty =       0.002509106049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750230848
                                         uncertainty =       0.002509106049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401076386
  error estimate for blocks of size 2^( 2) =       0.000413926131
  error estimate for blocks of size 2^( 3) =       0.000426511867
  error estimate for blocks of size 2^( 4) =       0.000438100090
  error estimate for blocks of size 2^( 5) =       0.000448427520
  error estimate for blocks of size 2^( 6) =       0.000455739392
  error estimate for blocks of size 2^( 7) =       0.000461655625

      target function =                  N/A
              le_mean =     -16.906345048272
             les_mean =     286.159233322993
             stat err =       0.000450980657
             autocorr =       1.264333494656
              std dev =       0.567207664943
             le_variance =       0.321724535171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750263029
                                         uncertainty =       0.002509106588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750263029
                                         uncertainty =       0.002509106588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401076406
  error estimate for blocks of size 2^( 2) =       0.000413926149
  error estimate for blocks of size 2^( 3) =       0.000426511885
  error estimate for blocks of size 2^( 4) =       0.000438100108
  error estimate for blocks of size 2^( 5) =       0.000448427539
  error estimate for blocks of size 2^( 6) =       0.000455739410
  error estimate for blocks of size 2^( 7) =       0.000461655642

      target function =                  N/A
              le_mean =     -16.906345048059
             les_mean =     286.159233330108
             stat err =       0.000450980675
             autocorr =       1.264333468202
              std dev =       0.567207693264
             le_variance =       0.321724567298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750291193
                                         uncertainty =       0.002509107060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750291193
                                         uncertainty =       0.002509107060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401076424
  error estimate for blocks of size 2^( 2) =       0.000413926166
  error estimate for blocks of size 2^( 3) =       0.000426511902
  error estimate for blocks of size 2^( 4) =       0.000438100123
  error estimate for blocks of size 2^( 5) =       0.000448427555
  error estimate for blocks of size 2^( 6) =       0.000455739426
  error estimate for blocks of size 2^( 7) =       0.000461655657

      target function =                  N/A
              le_mean =     -16.906345047873
             les_mean =     286.159233336428
             stat err =       0.000450980690
             autocorr =       1.264333445066
              std dev =       0.567207718049
             le_variance =       0.321724595415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906345047846        initial
     2.4414e+03     2.4414e+04             1.5854e-07       -16.906345048272  <--
     9.7656e+03     9.7656e+04             3.9638e-08       -16.906345048059
     3.9062e+04     3.9062e+05             9.9099e-09       -16.906345047873

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.3477e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801954e-02 3 1  ON 2
ci_0004                -2.824554e-02 3 1  ON 3
ci_0005                -3.394601e-02 3 1  ON 4
ci_0006                -3.440063e-02 3 1  ON 5
ci_0007                -2.237542e-02 3 1  ON 6
ci_0008                -2.248302e-02 3 1  ON 7
ci_0009                -1.779341e-02 3 1  ON 8
ci_0010                -1.793003e-02 3 1  ON 9
ci_0011                -1.242633e-02 3 1  ON 10
ci_0012                -1.269233e-02 3 1  ON 11
ci_0013                 1.336643e-02 3 1  ON 12
ci_0014                 1.349911e-02 3 1  ON 13
ci_0015                 1.365001e-02 3 1  ON 14
ci_0016                 1.308749e-02 3 1  ON 15
ci_0017                 1.160048e-02 3 1  ON 16
ci_0018                 1.175194e-02 3 1  ON 17
ci_0019                 1.188110e-02 3 1  ON 18
ci_0020                 1.194792e-02 3 1  ON 19
ci_0021                 1.940016e-03 3 1  ON 20
ci_0022                 3.070828e-03 3 1  ON 21
ci_0023                -1.177472e-02 3 1  ON 22
ci_0024                -1.107962e-02 3 1  ON 23
ci_0025                -1.134767e-02 3 1  ON 24
ci_0026                -1.125972e-02 3 1  ON 25
ci_0027                -1.120287e-02 3 1  ON 26
ci_0028                -1.102671e-02 3 1  ON 27
ci_0029                -1.080390e-02 3 1  ON 28
ci_0030                -1.022857e-02 3 1  ON 29
ci_0031                 1.933904e-02 3 1  ON 30
ci_0032                 1.976891e-02 3 1  ON 31
ci_0033                 9.368945e-03 3 1  ON 32
ci_0034                 1.000587e-02 3 1  ON 33
ci_0035                 7.396564e-03 3 1  ON 34
ci_0036                 6.855745e-03 3 1  ON 35
ci_0037                -1.089292e-02 3 1  ON 36
ci_0038                -1.066163e-02 3 1  ON 37
ci_0039                -2.823211e-03 3 1  ON 38
ci_0040                -2.965020e-03 3 1  ON 39
ci_0041                 7.307018e-03 3 1  ON 40
ci_0042                 7.398099e-03 3 1  ON 41
ci_0043                -1.504593e-02 3 1  ON 42
ci_0044                -1.572283e-02 3 1  ON 43
ci_0045                 8.068142e-03 3 1  ON 44
ci_0046                 7.490871e-03 3 1  ON 45
ci_0047                -2.192717e-03 3 1  ON 46
ci_0048                -2.226952e-03 3 1  ON 47
ci_0049                -5.375910e-03 3 1  ON 48
ci_0050                -5.413909e-03 3 1  ON 49
ci_0051                -3.523231e-03 3 1  ON 50
ci_0052                -3.135485e-03 3 1  ON 51
ci_0053                -5.126671e-03 3 1  ON 52
ci_0054                -4.939238e-03 3 1  ON 53
ci_0055                 5.929887e-03 3 1  ON 54
ci_0056                 6.353487e-03 3 1  ON 55
ci_0057                 4.661994e-03 3 1  ON 56
ci_0058                 5.180881e-03 3 1  ON 57
ci_0059                -5.145484e-03 3 1  ON 58
ci_0060                -4.987237e-03 3 1  ON 59
ci_0061                -3.814972e-03 3 1  ON 60
ci_0062                -3.100781e-03 3 1  ON 61
ci_0063                -8.644012e-03 3 1  ON 62
ci_0064                -9.217043e-03 3 1  ON 63
ci_0065                -5.728015e-03 3 1  ON 64
ci_0066                -5.048072e-03 3 1  ON 65
ci_0067                -5.383480e-03 3 1  ON 66
ci_0068                -5.457097e-03 3 1  ON 67
ci_0069                 4.998061e-03 3 1  ON 68
ci_0070                 4.769739e-03 3 1  ON 69
ci_0071                 2.243643e-03 3 1  ON 70
ci_0072                 1.743179e-03 3 1  ON 71
ci_0073                 4.313065e-03 3 1  ON 72
ci_0074                 4.192246e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.424108
====================================================
  Execution time = 1.4413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3125e-01
  Total weights = 1.951448405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238250145
                                         uncertainty =       0.002551974593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238250145
                                         uncertainty =       0.002551974593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400731622
  error estimate for blocks of size 2^( 2) =       0.000413569361
  error estimate for blocks of size 2^( 3) =       0.000427423313
  error estimate for blocks of size 2^( 4) =       0.000439080929
  error estimate for blocks of size 2^( 5) =       0.000449522199
  error estimate for blocks of size 2^( 6) =       0.000457192243
  error estimate for blocks of size 2^( 7) =       0.000458804924

      target function =                  N/A
              le_mean =     -16.905634167683
             les_mean =     286.131714647349
             stat err =       0.000451150074
             autocorr =       1.267461677929
              std dev =       0.566720094243
             le_variance =       0.321171665218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563416768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905634167655       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634174441       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905634174787       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634174823       residual = 2.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 6.501838e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905634167655       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634169352       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905634169438       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634169448       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.626173e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905634167655       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634168079       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905634168101       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905634168103       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 4.065879e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6981e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005071e-01 3 1  ON 1
ci_0003                -2.801949e-02 3 1  ON 2
ci_0004                -2.824554e-02 3 1  ON 3
ci_0005                -3.394604e-02 3 1  ON 4
ci_0006                -3.440062e-02 3 1  ON 5
ci_0007                -2.237544e-02 3 1  ON 6
ci_0008                -2.248307e-02 3 1  ON 7
ci_0009                -1.779331e-02 3 1  ON 8
ci_0010                -1.792991e-02 3 1  ON 9
ci_0011                -1.242637e-02 3 1  ON 10
ci_0012                -1.269231e-02 3 1  ON 11
ci_0013                 1.336646e-02 3 1  ON 12
ci_0014                 1.349909e-02 3 1  ON 13
ci_0015                 1.365003e-02 3 1  ON 14
ci_0016                 1.308741e-02 3 1  ON 15
ci_0017                 1.160049e-02 3 1  ON 16
ci_0018                 1.175191e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194792e-02 3 1  ON 19
ci_0021                 1.939982e-03 3 1  ON 20
ci_0022                 3.070755e-03 3 1  ON 21
ci_0023                -1.177466e-02 3 1  ON 22
ci_0024                -1.107967e-02 3 1  ON 23
ci_0025                -1.134758e-02 3 1  ON 24
ci_0026                -1.125969e-02 3 1  ON 25
ci_0027                -1.120281e-02 3 1  ON 26
ci_0028                -1.102672e-02 3 1  ON 27
ci_0029                -1.080392e-02 3 1  ON 28
ci_0030                -1.022853e-02 3 1  ON 29
ci_0031                 1.933905e-02 3 1  ON 30
ci_0032                 1.976894e-02 3 1  ON 31
ci_0033                 9.368999e-03 3 1  ON 32
ci_0034                 1.000583e-02 3 1  ON 33
ci_0035                 7.396572e-03 3 1  ON 34
ci_0036                 6.855796e-03 3 1  ON 35
ci_0037                -1.089285e-02 3 1  ON 36
ci_0038                -1.066156e-02 3 1  ON 37
ci_0039                -2.823166e-03 3 1  ON 38
ci_0040                -2.964921e-03 3 1  ON 39
ci_0041                 7.306969e-03 3 1  ON 40
ci_0042                 7.398086e-03 3 1  ON 41
ci_0043                -1.504590e-02 3 1  ON 42
ci_0044                -1.572295e-02 3 1  ON 43
ci_0045                 8.068116e-03 3 1  ON 44
ci_0046                 7.490909e-03 3 1  ON 45
ci_0047                -2.192555e-03 3 1  ON 46
ci_0048                -2.226878e-03 3 1  ON 47
ci_0049                -5.375904e-03 3 1  ON 48
ci_0050                -5.413919e-03 3 1  ON 49
ci_0051                -3.523238e-03 3 1  ON 50
ci_0052                -3.135535e-03 3 1  ON 51
ci_0053                -5.126620e-03 3 1  ON 52
ci_0054                -4.939215e-03 3 1  ON 53
ci_0055                 5.929932e-03 3 1  ON 54
ci_0056                 6.353479e-03 3 1  ON 55
ci_0057                 4.661933e-03 3 1  ON 56
ci_0058                 5.180824e-03 3 1  ON 57
ci_0059                -5.145449e-03 3 1  ON 58
ci_0060                -4.987231e-03 3 1  ON 59
ci_0061                -3.814869e-03 3 1  ON 60
ci_0062                -3.100775e-03 3 1  ON 61
ci_0063                -8.643977e-03 3 1  ON 62
ci_0064                -9.216962e-03 3 1  ON 63
ci_0065                -5.727987e-03 3 1  ON 64
ci_0066                -5.048161e-03 3 1  ON 65
ci_0067                -5.383353e-03 3 1  ON 66
ci_0068                -5.457062e-03 3 1  ON 67
ci_0069                 4.998013e-03 3 1  ON 68
ci_0070                 4.769830e-03 3 1  ON 69
ci_0071                 2.243580e-03 3 1  ON 70
ci_0072                 1.743220e-03 3 1  ON 71
ci_0073                 4.313119e-03 3 1  ON 72
ci_0074                 4.192288e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.246834
====================================================
  Execution time = 1.4108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3277e-01
  Total weights = 1.9515e+06
  Execution time = 1.8852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402815160
                                         uncertainty =       0.002239843960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402815160
                                         uncertainty =       0.002239843960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588531
  error estimate for blocks of size 2^( 2) =       0.000414299969
  error estimate for blocks of size 2^( 3) =       0.000427472442
  error estimate for blocks of size 2^( 4) =       0.000438927190
  error estimate for blocks of size 2^( 5) =       0.000449285913
  error estimate for blocks of size 2^( 6) =       0.000456443290
  error estimate for blocks of size 2^( 7) =       0.000462845904

      target function =                  N/A
              le_mean =     -16.905655191731
             les_mean =     286.133946997500
             stat err =       0.000451875574
             autocorr =       1.266120763101
              std dev =       0.567931946989
             le_variance =       0.322546696410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402635048
                                         uncertainty =       0.002239841101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402635048
                                         uncertainty =       0.002239841101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588419
  error estimate for blocks of size 2^( 2) =       0.000414299868
  error estimate for blocks of size 2^( 3) =       0.000427472350
  error estimate for blocks of size 2^( 4) =       0.000438927105
  error estimate for blocks of size 2^( 5) =       0.000449285820
  error estimate for blocks of size 2^( 6) =       0.000456443180
  error estimate for blocks of size 2^( 7) =       0.000462845811

      target function =                  N/A
              le_mean =     -16.905655201195
             les_mean =     286.133939261225
             stat err =       0.000451875479
             autocorr =       1.266120931397
              std dev =       0.567931789155
             le_variance =       0.322546517133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402725057
                                         uncertainty =       0.002239842530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402725057
                                         uncertainty =       0.002239842530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588475
  error estimate for blocks of size 2^( 2) =       0.000414299918
  error estimate for blocks of size 2^( 3) =       0.000427472396
  error estimate for blocks of size 2^( 4) =       0.000438927148
  error estimate for blocks of size 2^( 5) =       0.000449285867
  error estimate for blocks of size 2^( 6) =       0.000456443235
  error estimate for blocks of size 2^( 7) =       0.000462845857

      target function =                  N/A
              le_mean =     -16.905655196463
             les_mean =     286.133943082939
             stat err =       0.000451875527
             autocorr =       1.266120847286
              std dev =       0.567931868030
             le_variance =       0.322546606724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402803895
                                         uncertainty =       0.002239843781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322402803895
                                         uncertainty =       0.002239843781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588524
  error estimate for blocks of size 2^( 2) =       0.000414299963
  error estimate for blocks of size 2^( 3) =       0.000427472437
  error estimate for blocks of size 2^( 4) =       0.000438927185
  error estimate for blocks of size 2^( 5) =       0.000449285908
  error estimate for blocks of size 2^( 6) =       0.000456443283
  error estimate for blocks of size 2^( 7) =       0.000462845898

      target function =                  N/A
              le_mean =     -16.905655192323
             les_mean =     286.133946503172
             stat err =       0.000451875568
             autocorr =       1.266120773625
              std dev =       0.567931937117
             le_variance =       0.322546685197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905655191731        initial
     6.1035e+02     6.1035e+03             6.5018e-07       -16.905655201195  <--
     2.4414e+03     2.4414e+04             1.6262e-07       -16.905655196463
     9.7656e+03     9.7656e+04             4.0659e-08       -16.905655192323

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.3596e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801934e-02 3 1  ON 2
ci_0004                -2.824552e-02 3 1  ON 3
ci_0005                -3.394611e-02 3 1  ON 4
ci_0006                -3.440059e-02 3 1  ON 5
ci_0007                -2.237550e-02 3 1  ON 6
ci_0008                -2.248319e-02 3 1  ON 7
ci_0009                -1.779301e-02 3 1  ON 8
ci_0010                -1.792957e-02 3 1  ON 9
ci_0011                -1.242648e-02 3 1  ON 10
ci_0012                -1.269226e-02 3 1  ON 11
ci_0013                 1.336652e-02 3 1  ON 12
ci_0014                 1.349904e-02 3 1  ON 13
ci_0015                 1.365012e-02 3 1  ON 14
ci_0016                 1.308719e-02 3 1  ON 15
ci_0017                 1.160052e-02 3 1  ON 16
ci_0018                 1.175183e-02 3 1  ON 17
ci_0019                 1.188125e-02 3 1  ON 18
ci_0020                 1.194792e-02 3 1  ON 19
ci_0021                 1.939880e-03 3 1  ON 20
ci_0022                 3.070535e-03 3 1  ON 21
ci_0023                -1.177448e-02 3 1  ON 22
ci_0024                -1.107982e-02 3 1  ON 23
ci_0025                -1.134731e-02 3 1  ON 24
ci_0026                -1.125963e-02 3 1  ON 25
ci_0027                -1.120263e-02 3 1  ON 26
ci_0028                -1.102675e-02 3 1  ON 27
ci_0029                -1.080397e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933908e-02 3 1  ON 30
ci_0032                 1.976903e-02 3 1  ON 31
ci_0033                 9.369160e-03 3 1  ON 32
ci_0034                 1.000571e-02 3 1  ON 33
ci_0035                 7.396596e-03 3 1  ON 34
ci_0036                 6.855948e-03 3 1  ON 35
ci_0037                -1.089263e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823032e-03 3 1  ON 38
ci_0040                -2.964623e-03 3 1  ON 39
ci_0041                 7.306824e-03 3 1  ON 40
ci_0042                 7.398047e-03 3 1  ON 41
ci_0043                -1.504581e-02 3 1  ON 42
ci_0044                -1.572330e-02 3 1  ON 43
ci_0045                 8.068040e-03 3 1  ON 44
ci_0046                 7.491022e-03 3 1  ON 45
ci_0047                -2.192067e-03 3 1  ON 46
ci_0048                -2.226656e-03 3 1  ON 47
ci_0049                -5.375887e-03 3 1  ON 48
ci_0050                -5.413949e-03 3 1  ON 49
ci_0051                -3.523259e-03 3 1  ON 50
ci_0052                -3.135686e-03 3 1  ON 51
ci_0053                -5.126465e-03 3 1  ON 52
ci_0054                -4.939146e-03 3 1  ON 53
ci_0055                 5.930067e-03 3 1  ON 54
ci_0056                 6.353457e-03 3 1  ON 55
ci_0057                 4.661750e-03 3 1  ON 56
ci_0058                 5.180654e-03 3 1  ON 57
ci_0059                -5.145347e-03 3 1  ON 58
ci_0060                -4.987213e-03 3 1  ON 59
ci_0061                -3.814561e-03 3 1  ON 60
ci_0062                -3.100755e-03 3 1  ON 61
ci_0063                -8.643871e-03 3 1  ON 62
ci_0064                -9.216720e-03 3 1  ON 63
ci_0065                -5.727903e-03 3 1  ON 64
ci_0066                -5.048428e-03 3 1  ON 65
ci_0067                -5.382975e-03 3 1  ON 66
ci_0068                -5.456956e-03 3 1  ON 67
ci_0069                 4.997869e-03 3 1  ON 68
ci_0070                 4.770104e-03 3 1  ON 69
ci_0071                 2.243390e-03 3 1  ON 70
ci_0072                 1.743343e-03 3 1  ON 71
ci_0073                 4.313280e-03 3 1  ON 72
ci_0074                 4.192414e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.331865
====================================================
  Execution time = 1.4457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3893e-01
  Total weights = 1.951802393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671033956
                                         uncertainty =       0.002278695670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671033956
                                         uncertainty =       0.002278695670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402274456
  error estimate for blocks of size 2^( 2) =       0.000414871470
  error estimate for blocks of size 2^( 3) =       0.000427892839
  error estimate for blocks of size 2^( 4) =       0.000439868206
  error estimate for blocks of size 2^( 5) =       0.000449894259
  error estimate for blocks of size 2^( 6) =       0.000457544997
  error estimate for blocks of size 2^( 7) =       0.000460965841

      target function =                  N/A
              le_mean =     -16.905952647368
             les_mean =     286.150163272428
             stat err =       0.000452068326
             autocorr =       1.262883371591
              std dev =       0.568901992169
             le_variance =       0.323649476693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595264737e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905952647364       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905952665981       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905952664061       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905952664115       residual = 3.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.397205e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905952647364       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905952652023       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905952651541       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905952651553       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 5.996016e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905952647364       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905952648529       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905952648408       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905952648411       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.499192e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7022e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.011548e-01 3 1  ON 0
ci_0002                 7.005072e-01 3 1  ON 1
ci_0003                -2.801906e-02 3 1  ON 2
ci_0004                -2.824584e-02 3 1  ON 3
ci_0005                -3.394614e-02 3 1  ON 4
ci_0006                -3.440103e-02 3 1  ON 5
ci_0007                -2.237558e-02 3 1  ON 6
ci_0008                -2.248334e-02 3 1  ON 7
ci_0009                -1.779263e-02 3 1  ON 8
ci_0010                -1.792969e-02 3 1  ON 9
ci_0011                -1.242679e-02 3 1  ON 10
ci_0012                -1.269198e-02 3 1  ON 11
ci_0013                 1.336619e-02 3 1  ON 12
ci_0014                 1.349884e-02 3 1  ON 13
ci_0015                 1.365007e-02 3 1  ON 14
ci_0016                 1.308671e-02 3 1  ON 15
ci_0017                 1.160030e-02 3 1  ON 16
ci_0018                 1.175145e-02 3 1  ON 17
ci_0019                 1.188101e-02 3 1  ON 18
ci_0020                 1.194770e-02 3 1  ON 19
ci_0021                 1.939646e-03 3 1  ON 20
ci_0022                 3.070331e-03 3 1  ON 21
ci_0023                -1.177429e-02 3 1  ON 22
ci_0024                -1.108016e-02 3 1  ON 23
ci_0025                -1.134731e-02 3 1  ON 24
ci_0026                -1.125972e-02 3 1  ON 25
ci_0027                -1.120251e-02 3 1  ON 26
ci_0028                -1.102695e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022828e-02 3 1  ON 29
ci_0031                 1.933934e-02 3 1  ON 30
ci_0032                 1.976914e-02 3 1  ON 31
ci_0033                 9.369590e-03 3 1  ON 32
ci_0034                 1.000602e-02 3 1  ON 33
ci_0035                 7.396852e-03 3 1  ON 34
ci_0036                 6.855930e-03 3 1  ON 35
ci_0037                -1.089275e-02 3 1  ON 36
ci_0038                -1.066136e-02 3 1  ON 37
ci_0039                -2.822692e-03 3 1  ON 38
ci_0040                -2.964478e-03 3 1  ON 39
ci_0041                 7.306893e-03 3 1  ON 40
ci_0042                 7.397783e-03 3 1  ON 41
ci_0043                -1.504641e-02 3 1  ON 42
ci_0044                -1.572372e-02 3 1  ON 43
ci_0045                 8.068155e-03 3 1  ON 44
ci_0046                 7.490780e-03 3 1  ON 45
ci_0047                -2.191818e-03 3 1  ON 46
ci_0048                -2.226294e-03 3 1  ON 47
ci_0049                -5.376153e-03 3 1  ON 48
ci_0050                -5.413961e-03 3 1  ON 49
ci_0051                -3.523596e-03 3 1  ON 50
ci_0052                -3.136058e-03 3 1  ON 51
ci_0053                -5.125878e-03 3 1  ON 52
ci_0054                -4.938966e-03 3 1  ON 53
ci_0055                 5.930103e-03 3 1  ON 54
ci_0056                 6.353796e-03 3 1  ON 55
ci_0057                 4.662298e-03 3 1  ON 56
ci_0058                 5.180176e-03 3 1  ON 57
ci_0059                -5.144874e-03 3 1  ON 58
ci_0060                -4.987149e-03 3 1  ON 59
ci_0061                -3.814696e-03 3 1  ON 60
ci_0062                -3.100712e-03 3 1  ON 61
ci_0063                -8.644131e-03 3 1  ON 62
ci_0064                -9.216562e-03 3 1  ON 63
ci_0065                -5.728168e-03 3 1  ON 64
ci_0066                -5.048957e-03 3 1  ON 65
ci_0067                -5.383050e-03 3 1  ON 66
ci_0068                -5.456569e-03 3 1  ON 67
ci_0069                 4.997470e-03 3 1  ON 68
ci_0070                 4.769986e-03 3 1  ON 69
ci_0071                 2.243322e-03 3 1  ON 70
ci_0072                 1.743036e-03 3 1  ON 71
ci_0073                 4.313295e-03 3 1  ON 72
ci_0074                 4.192208e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9881
    reference variance = 0.395325
====================================================
  Execution time = 1.4289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3437e-01
  Total weights = 1.9521e+06
  Execution time = 1.8802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323233407611
                                         uncertainty =       0.001917802805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323233407611
                                         uncertainty =       0.001917802805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402010286
  error estimate for blocks of size 2^( 2) =       0.000414597737
  error estimate for blocks of size 2^( 3) =       0.000427556016
  error estimate for blocks of size 2^( 4) =       0.000439711472
  error estimate for blocks of size 2^( 5) =       0.000449574403
  error estimate for blocks of size 2^( 6) =       0.000459043068
  error estimate for blocks of size 2^( 7) =       0.000462450763

      target function =                  N/A
              le_mean =     -16.906242576569
             les_mean =     286.155412496537
             stat err =       0.000452694927
             autocorr =       1.268051590680
              std dev =       0.568528399196
             le_variance =       0.323224540693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323232971826
                                         uncertainty =       0.001917720099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323232971826
                                         uncertainty =       0.001917720099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402010016
  error estimate for blocks of size 2^( 2) =       0.000414597516
  error estimate for blocks of size 2^( 3) =       0.000427555794
  error estimate for blocks of size 2^( 4) =       0.000439711266
  error estimate for blocks of size 2^( 5) =       0.000449574167
  error estimate for blocks of size 2^( 6) =       0.000459042797
  error estimate for blocks of size 2^( 7) =       0.000462450566

      target function =                  N/A
              le_mean =     -16.906242559613
             les_mean =     286.155414031191
             stat err =       0.000452694699
             autocorr =       1.268052025971
              std dev =       0.568528016144
             le_variance =       0.323224105140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323233188763
                                         uncertainty =       0.001917761369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323233188763
                                         uncertainty =       0.001917761369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402010150
  error estimate for blocks of size 2^( 2) =       0.000414597626
  error estimate for blocks of size 2^( 3) =       0.000427555904
  error estimate for blocks of size 2^( 4) =       0.000439711369
  error estimate for blocks of size 2^( 5) =       0.000449574285
  error estimate for blocks of size 2^( 6) =       0.000459042932
  error estimate for blocks of size 2^( 7) =       0.000462450664

      target function =                  N/A
              le_mean =     -16.906242568035
             les_mean =     286.155413252436
             stat err =       0.000452694812
             autocorr =       1.268051809012
              std dev =       0.568528206830
             le_variance =       0.323224321962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323233380195
                                         uncertainty =       0.001917797622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323233380195
                                         uncertainty =       0.001917797622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402010269
  error estimate for blocks of size 2^( 2) =       0.000414597723
  error estimate for blocks of size 2^( 3) =       0.000427556002
  error estimate for blocks of size 2^( 4) =       0.000439711459
  error estimate for blocks of size 2^( 5) =       0.000449574388
  error estimate for blocks of size 2^( 6) =       0.000459043051
  error estimate for blocks of size 2^( 7) =       0.000462450750

      target function =                  N/A
              le_mean =     -16.906242575497
             les_mean =     286.155412589753
             stat err =       0.000452694912
             autocorr =       1.268051618010
              std dev =       0.568528375098
             le_variance =       0.323224513292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906242576569        initial  <--
     1.5259e+02     1.5259e+03             2.3972e-06       -16.906242559613
     6.1035e+02     6.1035e+03             5.9960e-07       -16.906242568035
     2.4414e+03     2.4414e+04             1.4992e-07       -16.906242575497

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7519
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801934e-02 3 1  ON 2
ci_0004                -2.824552e-02 3 1  ON 3
ci_0005                -3.394611e-02 3 1  ON 4
ci_0006                -3.440059e-02 3 1  ON 5
ci_0007                -2.237550e-02 3 1  ON 6
ci_0008                -2.248319e-02 3 1  ON 7
ci_0009                -1.779301e-02 3 1  ON 8
ci_0010                -1.792957e-02 3 1  ON 9
ci_0011                -1.242648e-02 3 1  ON 10
ci_0012                -1.269226e-02 3 1  ON 11
ci_0013                 1.336652e-02 3 1  ON 12
ci_0014                 1.349904e-02 3 1  ON 13
ci_0015                 1.365012e-02 3 1  ON 14
ci_0016                 1.308719e-02 3 1  ON 15
ci_0017                 1.160052e-02 3 1  ON 16
ci_0018                 1.175183e-02 3 1  ON 17
ci_0019                 1.188125e-02 3 1  ON 18
ci_0020                 1.194792e-02 3 1  ON 19
ci_0021                 1.939880e-03 3 1  ON 20
ci_0022                 3.070535e-03 3 1  ON 21
ci_0023                -1.177448e-02 3 1  ON 22
ci_0024                -1.107982e-02 3 1  ON 23
ci_0025                -1.134731e-02 3 1  ON 24
ci_0026                -1.125963e-02 3 1  ON 25
ci_0027                -1.120263e-02 3 1  ON 26
ci_0028                -1.102675e-02 3 1  ON 27
ci_0029                -1.080397e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933908e-02 3 1  ON 30
ci_0032                 1.976903e-02 3 1  ON 31
ci_0033                 9.369160e-03 3 1  ON 32
ci_0034                 1.000571e-02 3 1  ON 33
ci_0035                 7.396596e-03 3 1  ON 34
ci_0036                 6.855948e-03 3 1  ON 35
ci_0037                -1.089263e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823032e-03 3 1  ON 38
ci_0040                -2.964623e-03 3 1  ON 39
ci_0041                 7.306824e-03 3 1  ON 40
ci_0042                 7.398047e-03 3 1  ON 41
ci_0043                -1.504581e-02 3 1  ON 42
ci_0044                -1.572330e-02 3 1  ON 43
ci_0045                 8.068040e-03 3 1  ON 44
ci_0046                 7.491022e-03 3 1  ON 45
ci_0047                -2.192067e-03 3 1  ON 46
ci_0048                -2.226656e-03 3 1  ON 47
ci_0049                -5.375887e-03 3 1  ON 48
ci_0050                -5.413949e-03 3 1  ON 49
ci_0051                -3.523259e-03 3 1  ON 50
ci_0052                -3.135686e-03 3 1  ON 51
ci_0053                -5.126465e-03 3 1  ON 52
ci_0054                -4.939146e-03 3 1  ON 53
ci_0055                 5.930067e-03 3 1  ON 54
ci_0056                 6.353457e-03 3 1  ON 55
ci_0057                 4.661750e-03 3 1  ON 56
ci_0058                 5.180654e-03 3 1  ON 57
ci_0059                -5.145347e-03 3 1  ON 58
ci_0060                -4.987213e-03 3 1  ON 59
ci_0061                -3.814561e-03 3 1  ON 60
ci_0062                -3.100755e-03 3 1  ON 61
ci_0063                -8.643871e-03 3 1  ON 62
ci_0064                -9.216720e-03 3 1  ON 63
ci_0065                -5.727903e-03 3 1  ON 64
ci_0066                -5.048428e-03 3 1  ON 65
ci_0067                -5.382975e-03 3 1  ON 66
ci_0068                -5.456956e-03 3 1  ON 67
ci_0069                 4.997869e-03 3 1  ON 68
ci_0070                 4.770104e-03 3 1  ON 69
ci_0071                 2.243390e-03 3 1  ON 70
ci_0072                 1.743343e-03 3 1  ON 71
ci_0073                 4.313280e-03 3 1  ON 72
ci_0074                 4.192414e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0791e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9441
    reference variance = 0.329686
====================================================
  Execution time = 1.4577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3791e-01
  Total weights = 1.951667917e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325255749562
                                         uncertainty =       0.002609413698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325255749562
                                         uncertainty =       0.002609413698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403239930
  error estimate for blocks of size 2^( 2) =       0.000415849483
  error estimate for blocks of size 2^( 3) =       0.000428626680
  error estimate for blocks of size 2^( 4) =       0.000439968535
  error estimate for blocks of size 2^( 5) =       0.000449056476
  error estimate for blocks of size 2^( 6) =       0.000455239630
  error estimate for blocks of size 2^( 7) =       0.000461721377

      target function =                  N/A
              le_mean =     -16.906616797581
             les_mean =     286.171598842257
             stat err =       0.000451496505
             autocorr =       1.253665643296
              std dev =       0.570267377591
             le_variance =       0.325204881944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661679758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906616797581       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906616803548       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906616803037       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906616803003       residual = 2.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 2.725740e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906616797581       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906616799073       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906616798945       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906616798936       residual = 2.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 6.815317e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906616797581       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906616797954       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906616797922       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906616797913       residual = 2.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+04 is 1.703890e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023859 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7159e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801933e-02 3 1  ON 2
ci_0004                -2.824547e-02 3 1  ON 3
ci_0005                -3.394615e-02 3 1  ON 4
ci_0006                -3.440062e-02 3 1  ON 5
ci_0007                -2.237549e-02 3 1  ON 6
ci_0008                -2.248320e-02 3 1  ON 7
ci_0009                -1.779301e-02 3 1  ON 8
ci_0010                -1.792956e-02 3 1  ON 9
ci_0011                -1.242645e-02 3 1  ON 10
ci_0012                -1.269226e-02 3 1  ON 11
ci_0013                 1.336653e-02 3 1  ON 12
ci_0014                 1.349903e-02 3 1  ON 13
ci_0015                 1.365010e-02 3 1  ON 14
ci_0016                 1.308718e-02 3 1  ON 15
ci_0017                 1.160049e-02 3 1  ON 16
ci_0018                 1.175183e-02 3 1  ON 17
ci_0019                 1.188122e-02 3 1  ON 18
ci_0020                 1.194790e-02 3 1  ON 19
ci_0021                 1.939860e-03 3 1  ON 20
ci_0022                 3.070482e-03 3 1  ON 21
ci_0023                -1.177447e-02 3 1  ON 22
ci_0024                -1.107983e-02 3 1  ON 23
ci_0025                -1.134729e-02 3 1  ON 24
ci_0026                -1.125961e-02 3 1  ON 25
ci_0027                -1.120262e-02 3 1  ON 26
ci_0028                -1.102676e-02 3 1  ON 27
ci_0029                -1.080398e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933910e-02 3 1  ON 30
ci_0032                 1.976905e-02 3 1  ON 31
ci_0033                 9.369187e-03 3 1  ON 32
ci_0034                 1.000574e-02 3 1  ON 33
ci_0035                 7.396570e-03 3 1  ON 34
ci_0036                 6.855915e-03 3 1  ON 35
ci_0037                -1.089263e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823047e-03 3 1  ON 38
ci_0040                -2.964612e-03 3 1  ON 39
ci_0041                 7.306817e-03 3 1  ON 40
ci_0042                 7.398008e-03 3 1  ON 41
ci_0043                -1.504583e-02 3 1  ON 42
ci_0044                -1.572334e-02 3 1  ON 43
ci_0045                 8.068014e-03 3 1  ON 44
ci_0046                 7.491028e-03 3 1  ON 45
ci_0047                -2.192058e-03 3 1  ON 46
ci_0048                -2.226622e-03 3 1  ON 47
ci_0049                -5.375832e-03 3 1  ON 48
ci_0050                -5.413998e-03 3 1  ON 49
ci_0051                -3.523227e-03 3 1  ON 50
ci_0052                -3.135718e-03 3 1  ON 51
ci_0053                -5.126437e-03 3 1  ON 52
ci_0054                -4.939151e-03 3 1  ON 53
ci_0055                 5.930045e-03 3 1  ON 54
ci_0056                 6.353432e-03 3 1  ON 55
ci_0057                 4.661755e-03 3 1  ON 56
ci_0058                 5.180633e-03 3 1  ON 57
ci_0059                -5.145324e-03 3 1  ON 58
ci_0060                -4.987257e-03 3 1  ON 59
ci_0061                -3.814571e-03 3 1  ON 60
ci_0062                -3.100785e-03 3 1  ON 61
ci_0063                -8.643939e-03 3 1  ON 62
ci_0064                -9.216703e-03 3 1  ON 63
ci_0065                -5.727904e-03 3 1  ON 64
ci_0066                -5.048418e-03 3 1  ON 65
ci_0067                -5.382964e-03 3 1  ON 66
ci_0068                -5.456924e-03 3 1  ON 67
ci_0069                 4.997831e-03 3 1  ON 68
ci_0070                 4.770099e-03 3 1  ON 69
ci_0071                 2.243385e-03 3 1  ON 70
ci_0072                 1.743327e-03 3 1  ON 71
ci_0073                 4.313273e-03 3 1  ON 72
ci_0074                 4.192406e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9687
    reference variance = 0.759558
====================================================
  Execution time = 1.3976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3807e-01
  Total weights = 1.9518e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729619807
                                         uncertainty =       0.002348568967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729619807
                                         uncertainty =       0.002348568967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939140
  error estimate for blocks of size 2^( 2) =       0.000416076404
  error estimate for blocks of size 2^( 3) =       0.000429623502
  error estimate for blocks of size 2^( 4) =       0.000442376800
  error estimate for blocks of size 2^( 5) =       0.000453427466
  error estimate for blocks of size 2^( 6) =       0.000462440469
  error estimate for blocks of size 2^( 7) =       0.000469977306

      target function =                  N/A
              le_mean =     -16.905897766512
             les_mean =     286.147451928381
             stat err =       0.000457055510
             autocorr =       1.286645741553
              std dev =       0.569841997261
             le_variance =       0.324719901842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729483397
                                         uncertainty =       0.002348561211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729483397
                                         uncertainty =       0.002348561211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939056
  error estimate for blocks of size 2^( 2) =       0.000416076330
  error estimate for blocks of size 2^( 3) =       0.000429623436
  error estimate for blocks of size 2^( 4) =       0.000442376734
  error estimate for blocks of size 2^( 5) =       0.000453427413
  error estimate for blocks of size 2^( 6) =       0.000462440410
  error estimate for blocks of size 2^( 7) =       0.000469977254

      target function =                  N/A
              le_mean =     -16.905897768708
             les_mean =     286.147451710870
             stat err =       0.000457055453
             autocorr =       1.286645960297
              std dev =       0.569841877184
             le_variance =       0.324719764993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729551590
                                         uncertainty =       0.002348565089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729551590
                                         uncertainty =       0.002348565089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939098
  error estimate for blocks of size 2^( 2) =       0.000416076367
  error estimate for blocks of size 2^( 3) =       0.000429623469
  error estimate for blocks of size 2^( 4) =       0.000442376767
  error estimate for blocks of size 2^( 5) =       0.000453427439
  error estimate for blocks of size 2^( 6) =       0.000462440440
  error estimate for blocks of size 2^( 7) =       0.000469977280

      target function =                  N/A
              le_mean =     -16.905897767610
             les_mean =     286.147451819392
             stat err =       0.000457055482
             autocorr =       1.286645850942
              std dev =       0.569841937212
             le_variance =       0.324719833405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729611279
                                         uncertainty =       0.002348568482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324729611279
                                         uncertainty =       0.002348568482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939135
  error estimate for blocks of size 2^( 2) =       0.000416076400
  error estimate for blocks of size 2^( 3) =       0.000429623498
  error estimate for blocks of size 2^( 4) =       0.000442376796
  error estimate for blocks of size 2^( 5) =       0.000453427462
  error estimate for blocks of size 2^( 6) =       0.000462440466
  error estimate for blocks of size 2^( 7) =       0.000469977303

      target function =                  N/A
              le_mean =     -16.905897766649
             les_mean =     286.147451914733
             stat err =       0.000457055507
             autocorr =       1.286645755234
              std dev =       0.569841989754
             le_variance =       0.324719893287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905897766512        initial
     1.5259e+03     1.5259e+04             2.7257e-07       -16.905897768708  <--
     6.1035e+03     6.1035e+04             6.8153e-08       -16.905897767610
     2.4414e+04     2.4414e+05             1.7039e-08       -16.905897766649

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.3569e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9439
    reference variance = 0.334717
====================================================
  Execution time = 1.4684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3038e-01
  Total weights = 1.951865298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318783869455
                                         uncertainty =       0.001522362368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318783869455
                                         uncertainty =       0.001522362368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399202821
  error estimate for blocks of size 2^( 2) =       0.000412089981
  error estimate for blocks of size 2^( 3) =       0.000424749945
  error estimate for blocks of size 2^( 4) =       0.000437414909
  error estimate for blocks of size 2^( 5) =       0.000447942307
  error estimate for blocks of size 2^( 6) =       0.000456394591
  error estimate for blocks of size 2^( 7) =       0.000462151400

      target function =                  N/A
              le_mean =     -16.906287599170
             les_mean =     286.152937204570
             stat err =       0.000450975802
             autocorr =       1.276201574997
              std dev =       0.564558043336
             le_variance =       0.318725784295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628759917e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287599149       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287609701       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287609748       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287609687       residual = 1.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.285779e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287599149       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287601788       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287601799       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287601784       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 3.216221e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287599149       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287599809       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287599812       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287599808       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 8.041661e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7271e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.011550e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801925e-02 3 1  ON 2
ci_0004                -2.824530e-02 3 1  ON 3
ci_0005                -3.394625e-02 3 1  ON 4
ci_0006                -3.440074e-02 3 1  ON 5
ci_0007                -2.237535e-02 3 1  ON 6
ci_0008                -2.248326e-02 3 1  ON 7
ci_0009                -1.779304e-02 3 1  ON 8
ci_0010                -1.792950e-02 3 1  ON 9
ci_0011                -1.242641e-02 3 1  ON 10
ci_0012                -1.269218e-02 3 1  ON 11
ci_0013                 1.336650e-02 3 1  ON 12
ci_0014                 1.349894e-02 3 1  ON 13
ci_0015                 1.365010e-02 3 1  ON 14
ci_0016                 1.308717e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175179e-02 3 1  ON 17
ci_0019                 1.188120e-02 3 1  ON 18
ci_0020                 1.194775e-02 3 1  ON 19
ci_0021                 1.939680e-03 3 1  ON 20
ci_0022                 3.070072e-03 3 1  ON 21
ci_0023                -1.177436e-02 3 1  ON 22
ci_0024                -1.107993e-02 3 1  ON 23
ci_0025                -1.134718e-02 3 1  ON 24
ci_0026                -1.125951e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102677e-02 3 1  ON 27
ci_0029                -1.080401e-02 3 1  ON 28
ci_0030                -1.022838e-02 3 1  ON 29
ci_0031                 1.933920e-02 3 1  ON 30
ci_0032                 1.976912e-02 3 1  ON 31
ci_0033                 9.369486e-03 3 1  ON 32
ci_0034                 1.000578e-02 3 1  ON 33
ci_0035                 7.396303e-03 3 1  ON 34
ci_0036                 6.855762e-03 3 1  ON 35
ci_0037                -1.089254e-02 3 1  ON 36
ci_0038                -1.066134e-02 3 1  ON 37
ci_0039                -2.823199e-03 3 1  ON 38
ci_0040                -2.964542e-03 3 1  ON 39
ci_0041                 7.306818e-03 3 1  ON 40
ci_0042                 7.397915e-03 3 1  ON 41
ci_0043                -1.504597e-02 3 1  ON 42
ci_0044                -1.572363e-02 3 1  ON 43
ci_0045                 8.067772e-03 3 1  ON 44
ci_0046                 7.491040e-03 3 1  ON 45
ci_0047                -2.191783e-03 3 1  ON 46
ci_0048                -2.226335e-03 3 1  ON 47
ci_0049                -5.375597e-03 3 1  ON 48
ci_0050                -5.414340e-03 3 1  ON 49
ci_0051                -3.523174e-03 3 1  ON 50
ci_0052                -3.135972e-03 3 1  ON 51
ci_0053                -5.126309e-03 3 1  ON 52
ci_0054                -4.939079e-03 3 1  ON 53
ci_0055                 5.930055e-03 3 1  ON 54
ci_0056                 6.353214e-03 3 1  ON 55
ci_0057                 4.661911e-03 3 1  ON 56
ci_0058                 5.180493e-03 3 1  ON 57
ci_0059                -5.145162e-03 3 1  ON 58
ci_0060                -4.987441e-03 3 1  ON 59
ci_0061                -3.814565e-03 3 1  ON 60
ci_0062                -3.100946e-03 3 1  ON 61
ci_0063                -8.644282e-03 3 1  ON 62
ci_0064                -9.216332e-03 3 1  ON 63
ci_0065                -5.727759e-03 3 1  ON 64
ci_0066                -5.048509e-03 3 1  ON 65
ci_0067                -5.382774e-03 3 1  ON 66
ci_0068                -5.456671e-03 3 1  ON 67
ci_0069                 4.997533e-03 3 1  ON 68
ci_0070                 4.770041e-03 3 1  ON 69
ci_0071                 2.243223e-03 3 1  ON 70
ci_0072                 1.743212e-03 3 1  ON 71
ci_0073                 4.313364e-03 3 1  ON 72
ci_0074                 4.192384e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8407
    reference variance = 0.226603
====================================================
  Execution time = 1.4032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2793e-01
  Total weights = 1.9516e+06
  Execution time = 1.8909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318001034186
                                         uncertainty =       0.001716694663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318001034186
                                         uncertainty =       0.001716694663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398688009
  error estimate for blocks of size 2^( 2) =       0.000411559856
  error estimate for blocks of size 2^( 3) =       0.000424984003
  error estimate for blocks of size 2^( 4) =       0.000437238383
  error estimate for blocks of size 2^( 5) =       0.000449119104
  error estimate for blocks of size 2^( 6) =       0.000459612285
  error estimate for blocks of size 2^( 7) =       0.000464096837

      target function =                  N/A
              le_mean =     -16.905589942699
             les_mean =     286.126904789795
             stat err =       0.000452516652
             autocorr =       1.288257808541
              std dev =       0.563829989360
             le_variance =       0.317904256901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318000587472
                                         uncertainty =       0.001716689253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318000587472
                                         uncertainty =       0.001716689253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398687730
  error estimate for blocks of size 2^( 2) =       0.000411559602
  error estimate for blocks of size 2^( 3) =       0.000424983766
  error estimate for blocks of size 2^( 4) =       0.000437238137
  error estimate for blocks of size 2^( 5) =       0.000449118863
  error estimate for blocks of size 2^( 6) =       0.000459612012
  error estimate for blocks of size 2^( 7) =       0.000464096568

      target function =                  N/A
              le_mean =     -16.905589938273
             les_mean =     286.126904118875
             stat err =       0.000452516395
             autocorr =       1.288258148327
              std dev =       0.563829594500
             le_variance =       0.317903811635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318000810645
                                         uncertainty =       0.001716691956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318000810645
                                         uncertainty =       0.001716691956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398687869
  error estimate for blocks of size 2^( 2) =       0.000411559729
  error estimate for blocks of size 2^( 3) =       0.000424983884
  error estimate for blocks of size 2^( 4) =       0.000437238260
  error estimate for blocks of size 2^( 5) =       0.000449118984
  error estimate for blocks of size 2^( 6) =       0.000459612148
  error estimate for blocks of size 2^( 7) =       0.000464096703

      target function =                  N/A
              le_mean =     -16.905589940476
             les_mean =     286.126904451534
             stat err =       0.000452516524
             autocorr =       1.288257978595
              std dev =       0.563829791768
             le_variance =       0.317904034085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318001006233
                                         uncertainty =       0.001716694325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318001006233
                                         uncertainty =       0.001716694325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398687991
  error estimate for blocks of size 2^( 2) =       0.000411559840
  error estimate for blocks of size 2^( 3) =       0.000424983988
  error estimate for blocks of size 2^( 4) =       0.000437238368
  error estimate for blocks of size 2^( 5) =       0.000449119089
  error estimate for blocks of size 2^( 6) =       0.000459612267
  error estimate for blocks of size 2^( 7) =       0.000464096820

      target function =                  N/A
              le_mean =     -16.905589942420
             les_mean =     286.126904747217
             stat err =       0.000452516636
             autocorr =       1.288257829814
              std dev =       0.563829964652
             le_variance =       0.317904229039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905589942699        initial  <--
     3.8147e+02     3.8147e+03             1.2858e-06       -16.905589938273
     1.5259e+03     1.5259e+04             3.2162e-07       -16.905589940476
     6.1035e+03     6.1035e+04             8.0417e-08       -16.905589942420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5366
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9856
    reference variance = 0.3143
====================================================
  Execution time = 1.4594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3551e-01
  Total weights = 1.951634164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322006046315
                                         uncertainty =       0.002233194516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322006046315
                                         uncertainty =       0.002233194516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401295004
  error estimate for blocks of size 2^( 2) =       0.000414388233
  error estimate for blocks of size 2^( 3) =       0.000427942843
  error estimate for blocks of size 2^( 4) =       0.000440388467
  error estimate for blocks of size 2^( 5) =       0.000449998772
  error estimate for blocks of size 2^( 6) =       0.000455382779
  error estimate for blocks of size 2^( 7) =       0.000461605234

      target function =                  N/A
              le_mean =     -16.906806383663
             les_mean =     286.175614016134
             stat err =       0.000451843813
             autocorr =       1.267795404476
              std dev =       0.567516837521
             le_variance =       0.322075360869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680638366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906806383667       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906806386052       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906806386136       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906806386150       residual = 2.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 1.047584e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906806383667       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906806384263       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906806384284       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906806384287       residual = 2.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 2.619064e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906806383667       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906806383816       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906806383821       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906806383845       residual = 2.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 6.547724e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7178e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801933e-02 3 1  ON 2
ci_0004                -2.824533e-02 3 1  ON 3
ci_0005                -3.394628e-02 3 1  ON 4
ci_0006                -3.440071e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248320e-02 3 1  ON 7
ci_0009                -1.779300e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242635e-02 3 1  ON 10
ci_0012                -1.269227e-02 3 1  ON 11
ci_0013                 1.336653e-02 3 1  ON 12
ci_0014                 1.349900e-02 3 1  ON 13
ci_0015                 1.365004e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160039e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194781e-02 3 1  ON 19
ci_0021                 1.939784e-03 3 1  ON 20
ci_0022                 3.070309e-03 3 1  ON 21
ci_0023                -1.177444e-02 3 1  ON 22
ci_0024                -1.107989e-02 3 1  ON 23
ci_0025                -1.134722e-02 3 1  ON 24
ci_0026                -1.125955e-02 3 1  ON 25
ci_0027                -1.120259e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080403e-02 3 1  ON 28
ci_0030                -1.022843e-02 3 1  ON 29
ci_0031                 1.933916e-02 3 1  ON 30
ci_0032                 1.976910e-02 3 1  ON 31
ci_0033                 9.369279e-03 3 1  ON 32
ci_0034                 1.000583e-02 3 1  ON 33
ci_0035                 7.396466e-03 3 1  ON 34
ci_0036                 6.855820e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066132e-02 3 1  ON 37
ci_0039                -2.823082e-03 3 1  ON 38
ci_0040                -2.964572e-03 3 1  ON 39
ci_0041                 7.306808e-03 3 1  ON 40
ci_0042                 7.397889e-03 3 1  ON 41
ci_0043                -1.504590e-02 3 1  ON 42
ci_0044                -1.572346e-02 3 1  ON 43
ci_0045                 8.067917e-03 3 1  ON 44
ci_0046                 7.491046e-03 3 1  ON 45
ci_0047                -2.192021e-03 3 1  ON 46
ci_0048                -2.226499e-03 3 1  ON 47
ci_0049                -5.375652e-03 3 1  ON 48
ci_0050                -5.414144e-03 3 1  ON 49
ci_0051                -3.523129e-03 3 1  ON 50
ci_0052                -3.135822e-03 3 1  ON 51
ci_0053                -5.126343e-03 3 1  ON 52
ci_0054                -4.939166e-03 3 1  ON 53
ci_0055                 5.929985e-03 3 1  ON 54
ci_0056                 6.353367e-03 3 1  ON 55
ci_0057                 4.661779e-03 3 1  ON 56
ci_0058                 5.180557e-03 3 1  ON 57
ci_0059                -5.145243e-03 3 1  ON 58
ci_0060                -4.987391e-03 3 1  ON 59
ci_0061                -3.814589e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644151e-03 3 1  ON 62
ci_0064                -9.216642e-03 3 1  ON 63
ci_0065                -5.727901e-03 3 1  ON 64
ci_0066                -5.048396e-03 3 1  ON 65
ci_0067                -5.382931e-03 3 1  ON 66
ci_0068                -5.456817e-03 3 1  ON 67
ci_0069                 4.997711e-03 3 1  ON 68
ci_0070                 4.770078e-03 3 1  ON 69
ci_0071                 2.243352e-03 3 1  ON 70
ci_0072                 1.743268e-03 3 1  ON 71
ci_0073                 4.313253e-03 3 1  ON 72
ci_0074                 4.192384e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9244
    reference variance = 0.214535
====================================================
  Execution time = 1.4122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3134e-01
  Total weights = 1.9519e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726656814
                                         uncertainty =       0.002015519056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726656814
                                         uncertainty =       0.002015519056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400567425
  error estimate for blocks of size 2^( 2) =       0.000413657325
  error estimate for blocks of size 2^( 3) =       0.000426428268
  error estimate for blocks of size 2^( 4) =       0.000438609771
  error estimate for blocks of size 2^( 5) =       0.000449474938
  error estimate for blocks of size 2^( 6) =       0.000455416199
  error estimate for blocks of size 2^( 7) =       0.000461273912

      target function =                  N/A
              le_mean =     -16.906199563167
             les_mean =     286.150924500287
             stat err =       0.000451193705
             autocorr =       1.268746353975
              std dev =       0.566487884507
             le_variance =       0.320908523294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726579809
                                         uncertainty =       0.002015516886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726579809
                                         uncertainty =       0.002015516886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400567376
  error estimate for blocks of size 2^( 2) =       0.000413657278
  error estimate for blocks of size 2^( 3) =       0.000426428224
  error estimate for blocks of size 2^( 4) =       0.000438609729
  error estimate for blocks of size 2^( 5) =       0.000449474893
  error estimate for blocks of size 2^( 6) =       0.000455416152
  error estimate for blocks of size 2^( 7) =       0.000461273859

      target function =                  N/A
              le_mean =     -16.906199562200
             les_mean =     286.150924194401
             stat err =       0.000451193658
             autocorr =       1.268746396964
              std dev =       0.566487816131
             le_variance =       0.320908445825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726618309
                                         uncertainty =       0.002015517971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726618309
                                         uncertainty =       0.002015517971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400567400
  error estimate for blocks of size 2^( 2) =       0.000413657301
  error estimate for blocks of size 2^( 3) =       0.000426428246
  error estimate for blocks of size 2^( 4) =       0.000438609750
  error estimate for blocks of size 2^( 5) =       0.000449474915
  error estimate for blocks of size 2^( 6) =       0.000455416176
  error estimate for blocks of size 2^( 7) =       0.000461273886

      target function =                  N/A
              le_mean =     -16.906199562683
             les_mean =     286.150924347221
             stat err =       0.000451193682
             autocorr =       1.268746375474
              std dev =       0.566487850317
             le_variance =       0.320908484557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726652000
                                         uncertainty =       0.002015518920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320726652000
                                         uncertainty =       0.002015518920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400567422
  error estimate for blocks of size 2^( 2) =       0.000413657322
  error estimate for blocks of size 2^( 3) =       0.000426428266
  error estimate for blocks of size 2^( 4) =       0.000438609768
  error estimate for blocks of size 2^( 5) =       0.000449474935
  error estimate for blocks of size 2^( 6) =       0.000455416196
  error estimate for blocks of size 2^( 7) =       0.000461273908

      target function =                  N/A
              le_mean =     -16.906199563106
             les_mean =     286.150924481140
             stat err =       0.000451193702
             autocorr =       1.268746356668
              std dev =       0.566487880233
             le_variance =       0.320908518451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906199563167        initial  <--
     3.8147e+03     3.8147e+04             1.0476e-07       -16.906199562200
     1.5259e+04     1.5259e+05             2.6191e-08       -16.906199562683
     6.1035e+04     6.1035e+05             6.5477e-09       -16.906199563106

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.6356
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8405
    reference variance = 0.195399
====================================================
  Execution time = 1.4523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3091e-01
  Total weights = 1.951801392e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319860398029
                                         uncertainty =       0.001787757615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319860398029
                                         uncertainty =       0.001787757615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399891045
  error estimate for blocks of size 2^( 2) =       0.000412985356
  error estimate for blocks of size 2^( 3) =       0.000426554075
  error estimate for blocks of size 2^( 4) =       0.000439834651
  error estimate for blocks of size 2^( 5) =       0.000451226516
  error estimate for blocks of size 2^( 6) =       0.000461217915
  error estimate for blocks of size 2^( 7) =       0.000469834573

      target function =                  N/A
              le_mean =     -16.905985002568
             les_mean =     286.143240391276
             stat err =       0.000455528414
             autocorr =       1.297620163936
              std dev =       0.565531339234
             le_variance =       0.319825695656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598500257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905985002557       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905985002809       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985002796       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985002796       residual = 5.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 8.808256e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905985002557       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905985002620       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985002616       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985002617       residual = 5.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+05 is 2.202069e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905985002557       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905985002572       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985002572       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985002455       residual = 5.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+05 is 5.505174e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7099e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365004e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939796e-03 3 1  ON 20
ci_0022                 3.070321e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396491e-03 3 1  ON 34
ci_0036                 6.855814e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823091e-03 3 1  ON 38
ci_0040                -2.964581e-03 3 1  ON 39
ci_0041                 7.306795e-03 3 1  ON 40
ci_0042                 7.397889e-03 3 1  ON 41
ci_0043                -1.504589e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067934e-03 3 1  ON 44
ci_0046                 7.491044e-03 3 1  ON 45
ci_0047                -2.192030e-03 3 1  ON 46
ci_0048                -2.226519e-03 3 1  ON 47
ci_0049                -5.375668e-03 3 1  ON 48
ci_0050                -5.414144e-03 3 1  ON 49
ci_0051                -3.523130e-03 3 1  ON 50
ci_0052                -3.135817e-03 3 1  ON 51
ci_0053                -5.126353e-03 3 1  ON 52
ci_0054                -4.939164e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353356e-03 3 1  ON 55
ci_0057                 4.661768e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145254e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814603e-03 3 1  ON 60
ci_0062                -3.100876e-03 3 1  ON 61
ci_0063                -8.644145e-03 3 1  ON 62
ci_0064                -9.216653e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048388e-03 3 1  ON 65
ci_0067                -5.382933e-03 3 1  ON 66
ci_0068                -5.456823e-03 3 1  ON 67
ci_0069                 4.997716e-03 3 1  ON 68
ci_0070                 4.770084e-03 3 1  ON 69
ci_0071                 2.243368e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313252e-03 3 1  ON 72
ci_0074                 4.192383e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.290999
====================================================
  Execution time = 1.4219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2893e-01
  Total weights = 1.9520e+06
  Execution time = 1.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953960390
                                         uncertainty =       0.001527074140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953960390
                                         uncertainty =       0.001527074140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399335787
  error estimate for blocks of size 2^( 2) =       0.000412503745
  error estimate for blocks of size 2^( 3) =       0.000426164609
  error estimate for blocks of size 2^( 4) =       0.000438902488
  error estimate for blocks of size 2^( 5) =       0.000448500056
  error estimate for blocks of size 2^( 6) =       0.000455998768
  error estimate for blocks of size 2^( 7) =       0.000460379371

      target function =                  N/A
              le_mean =     -16.905186429699
             les_mean =     286.114258963626
             stat err =       0.000450945171
             autocorr =       1.275178603647
              std dev =       0.564746086074
             le_variance =       0.318938141735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953953665
                                         uncertainty =       0.001527073984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953953665
                                         uncertainty =       0.001527073984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399335783
  error estimate for blocks of size 2^( 2) =       0.000412503741
  error estimate for blocks of size 2^( 3) =       0.000426164605
  error estimate for blocks of size 2^( 4) =       0.000438902484
  error estimate for blocks of size 2^( 5) =       0.000448500053
  error estimate for blocks of size 2^( 6) =       0.000455998765
  error estimate for blocks of size 2^( 7) =       0.000460379368

      target function =                  N/A
              le_mean =     -16.905186429643
             les_mean =     286.114258958889
             stat err =       0.000450945167
             autocorr =       1.275178610306
              std dev =       0.564746080135
             le_variance =       0.318938135027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953957027
                                         uncertainty =       0.001527074062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953957027
                                         uncertainty =       0.001527074062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399335785
  error estimate for blocks of size 2^( 2) =       0.000412503743
  error estimate for blocks of size 2^( 3) =       0.000426164607
  error estimate for blocks of size 2^( 4) =       0.000438902486
  error estimate for blocks of size 2^( 5) =       0.000448500054
  error estimate for blocks of size 2^( 6) =       0.000455998767
  error estimate for blocks of size 2^( 7) =       0.000460379369

      target function =                  N/A
              le_mean =     -16.905186429671
             les_mean =     286.114258961258
             stat err =       0.000450945169
             autocorr =       1.275178606981
              std dev =       0.564746083104
             le_variance =       0.318938138381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953959969
                                         uncertainty =       0.001527074130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953959969
                                         uncertainty =       0.001527074130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399335787
  error estimate for blocks of size 2^( 2) =       0.000412503745
  error estimate for blocks of size 2^( 3) =       0.000426164608
  error estimate for blocks of size 2^( 4) =       0.000438902488
  error estimate for blocks of size 2^( 5) =       0.000448500056
  error estimate for blocks of size 2^( 6) =       0.000455998768
  error estimate for blocks of size 2^( 7) =       0.000460379371

      target function =                  N/A
              le_mean =     -16.905186429695
             les_mean =     286.114258963330
             stat err =       0.000450945171
             autocorr =       1.275178604063
              std dev =       0.564746085702
             le_variance =       0.318938141316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905186429699        initial  <--
     3.8147e+04     3.8147e+05             8.8083e-09       -16.905186429643
     1.5259e+05     1.5259e+06             2.2021e-09       -16.905186429671
     6.1035e+05     6.1035e+06             5.5052e-10       -16.905186429695

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7441
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.140681
====================================================
  Execution time = 1.4430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3600e-01
  Total weights = 1.951911041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322902300646
                                         uncertainty =       0.002356767024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322902300646
                                         uncertainty =       0.002356767024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401792405
  error estimate for blocks of size 2^( 2) =       0.000414452880
  error estimate for blocks of size 2^( 3) =       0.000427663237
  error estimate for blocks of size 2^( 4) =       0.000440290436
  error estimate for blocks of size 2^( 5) =       0.000450212765
  error estimate for blocks of size 2^( 6) =       0.000457137422
  error estimate for blocks of size 2^( 7) =       0.000461426434

      target function =                  N/A
              le_mean =     -16.905850281585
             les_mean =     286.143778318871
             stat err =       0.000452266764
             autocorr =       1.267027091294
              std dev =       0.568220268625
             le_variance =       0.322874273676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585028158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905850281571       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850281579       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850281578       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850281578       residual = 3.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+05 is 1.385508e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905850281571       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850281573       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850281573       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850281590       residual = 3.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+06 is 3.463770e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905850281571       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850281571       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850281571       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850281571       residual = 3.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+06 is 8.659420e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7035e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939797e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126353e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814603e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8095
    reference variance = 0.237636
====================================================
  Execution time = 1.4106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3734e-01
  Total weights = 1.9518e+06
  Execution time = 1.8886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337800621
                                         uncertainty =       0.004527689502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337800621
                                         uncertainty =       0.004527689502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403960535
  error estimate for blocks of size 2^( 2) =       0.000416584997
  error estimate for blocks of size 2^( 3) =       0.000429358576
  error estimate for blocks of size 2^( 4) =       0.000441066869
  error estimate for blocks of size 2^( 5) =       0.000452138307
  error estimate for blocks of size 2^( 6) =       0.000459323568
  error estimate for blocks of size 2^( 7) =       0.000465737047

      target function =                  N/A
              le_mean =     -16.906293528892
             les_mean =     286.160096562211
             stat err =       0.000454566448
             autocorr =       1.266242473393
              std dev =       0.571286466579
             le_variance =       0.326368226896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337799980
                                         uncertainty =       0.004527689393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337799980
                                         uncertainty =       0.004527689393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403960534
  error estimate for blocks of size 2^( 2) =       0.000416584997
  error estimate for blocks of size 2^( 3) =       0.000429358576
  error estimate for blocks of size 2^( 4) =       0.000441066869
  error estimate for blocks of size 2^( 5) =       0.000452138306
  error estimate for blocks of size 2^( 6) =       0.000459323567
  error estimate for blocks of size 2^( 7) =       0.000465737047

      target function =                  N/A
              le_mean =     -16.906293528878
             les_mean =     286.160096561813
             stat err =       0.000454566447
             autocorr =       1.266242473609
              std dev =       0.571286466021
             le_variance =       0.326368226258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337800301
                                         uncertainty =       0.004527689447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337800301
                                         uncertainty =       0.004527689447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403960534
  error estimate for blocks of size 2^( 2) =       0.000416584997
  error estimate for blocks of size 2^( 3) =       0.000429358576
  error estimate for blocks of size 2^( 4) =       0.000441066869
  error estimate for blocks of size 2^( 5) =       0.000452138307
  error estimate for blocks of size 2^( 6) =       0.000459323567
  error estimate for blocks of size 2^( 7) =       0.000465737047

      target function =                  N/A
              le_mean =     -16.906293528885
             les_mean =     286.160096562012
             stat err =       0.000454566448
             autocorr =       1.266242473497
              std dev =       0.571286466300
             le_variance =       0.326368226577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337800581
                                         uncertainty =       0.004527689495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337800581
                                         uncertainty =       0.004527689495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403960534
  error estimate for blocks of size 2^( 2) =       0.000416584997
  error estimate for blocks of size 2^( 3) =       0.000429358576
  error estimate for blocks of size 2^( 4) =       0.000441066869
  error estimate for blocks of size 2^( 5) =       0.000452138307
  error estimate for blocks of size 2^( 6) =       0.000459323568
  error estimate for blocks of size 2^( 7) =       0.000465737047

      target function =                  N/A
              le_mean =     -16.906293528891
             les_mean =     286.160096562187
             stat err =       0.000454566448
             autocorr =       1.266242473406
              std dev =       0.571286466544
             le_variance =       0.326368226856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906293528892        initial  <--
     3.8147e+05     3.8147e+06             1.3855e-09       -16.906293528878
     1.5259e+06     1.5259e+07             3.4638e-10       -16.906293528885
     6.1035e+06     6.1035e+07             8.6594e-11       -16.906293528891

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6059
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8587
    reference variance = 0.200501
====================================================
  Execution time = 1.4431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3243e-01
  Total weights = 1.951538321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320697664217
                                         uncertainty =       0.002049638348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320697664217
                                         uncertainty =       0.002049638348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400435132
  error estimate for blocks of size 2^( 2) =       0.000412950127
  error estimate for blocks of size 2^( 3) =       0.000425683415
  error estimate for blocks of size 2^( 4) =       0.000436939475
  error estimate for blocks of size 2^( 5) =       0.000446782721
  error estimate for blocks of size 2^( 6) =       0.000453604746
  error estimate for blocks of size 2^( 7) =       0.000458273114

      target function =                  N/A
              le_mean =     -16.906279057023
             les_mean =     286.154698241187
             stat err =       0.000448900014
             autocorr =       1.256709481776
              std dev =       0.566300794401
             le_variance =       0.320696589739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627905702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279057010       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279057013       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279057013       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279057013       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+06 is 7.156134e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279057010       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279057011       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279057011       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279057011       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+07 is 1.789034e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279057010       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279057011       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279057011       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279080732       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+07 is 4.472593e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7016e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8889
    reference variance = 0.257057
====================================================
  Execution time = 1.4077e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3062e-01
  Total weights = 1.9518e+06
  Execution time = 1.8794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043313
                                         uncertainty =       0.002281367295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043313
                                         uncertainty =       0.002281367295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399338545
  error estimate for blocks of size 2^( 2) =       0.000412160429
  error estimate for blocks of size 2^( 3) =       0.000425942676
  error estimate for blocks of size 2^( 4) =       0.000438093080
  error estimate for blocks of size 2^( 5) =       0.000448750548
  error estimate for blocks of size 2^( 6) =       0.000456637490
  error estimate for blocks of size 2^( 7) =       0.000459684217

      target function =                  N/A
              le_mean =     -16.906144615046
             les_mean =     286.148345075501
             stat err =       0.000450791334
             autocorr =       1.274291110808
              std dev =       0.564749986817
             le_variance =       0.318942547610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043289
                                         uncertainty =       0.002281367294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043289
                                         uncertainty =       0.002281367294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399338545
  error estimate for blocks of size 2^( 2) =       0.000412160429
  error estimate for blocks of size 2^( 3) =       0.000425942676
  error estimate for blocks of size 2^( 4) =       0.000438093080
  error estimate for blocks of size 2^( 5) =       0.000448750548
  error estimate for blocks of size 2^( 6) =       0.000456637490
  error estimate for blocks of size 2^( 7) =       0.000459684217

      target function =                  N/A
              le_mean =     -16.906144615046
             les_mean =     286.148345075917
             stat err =       0.000450791334
             autocorr =       1.274291110810
              std dev =       0.564749986795
             le_variance =       0.318942547585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043301
                                         uncertainty =       0.002281367294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043301
                                         uncertainty =       0.002281367294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399338545
  error estimate for blocks of size 2^( 2) =       0.000412160429
  error estimate for blocks of size 2^( 3) =       0.000425942676
  error estimate for blocks of size 2^( 4) =       0.000438093080
  error estimate for blocks of size 2^( 5) =       0.000448750548
  error estimate for blocks of size 2^( 6) =       0.000456637490
  error estimate for blocks of size 2^( 7) =       0.000459684217

      target function =                  N/A
              le_mean =     -16.906144615046
             les_mean =     286.148345075709
             stat err =       0.000450791334
             autocorr =       1.274291110804
              std dev =       0.564749986806
             le_variance =       0.318942547598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043312
                                         uncertainty =       0.002281367295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014043312
                                         uncertainty =       0.002281367295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399338545
  error estimate for blocks of size 2^( 2) =       0.000412160429
  error estimate for blocks of size 2^( 3) =       0.000425942676
  error estimate for blocks of size 2^( 4) =       0.000438093080
  error estimate for blocks of size 2^( 5) =       0.000448750548
  error estimate for blocks of size 2^( 6) =       0.000456637490
  error estimate for blocks of size 2^( 7) =       0.000459684217

      target function =                  N/A
              le_mean =     -16.906144615046
             les_mean =     286.148345075527
             stat err =       0.000450791334
             autocorr =       1.274291110799
              std dev =       0.564749986816
             le_variance =       0.318942547609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906144615046        initial  <--
     3.8147e+06     3.8147e+07             7.1561e-11       -16.906144615046
     1.5259e+07     1.5259e+08             1.7890e-11       -16.906144615046
     6.1035e+07     6.1035e+08             4.4726e-12       -16.906144615046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5453
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.834
    reference variance = 0.559179
====================================================
  Execution time = 1.4594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3946e-01
  Total weights = 1.951725220e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324848996817
                                         uncertainty =       0.002649093152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324848996817
                                         uncertainty =       0.002649093152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403008887
  error estimate for blocks of size 2^( 2) =       0.000415438099
  error estimate for blocks of size 2^( 3) =       0.000428497043
  error estimate for blocks of size 2^( 4) =       0.000440743322
  error estimate for blocks of size 2^( 5) =       0.000449951635
  error estimate for blocks of size 2^( 6) =       0.000456247360
  error estimate for blocks of size 2^( 7) =       0.000459097463

      target function =                  N/A
              le_mean =     -16.907074644949
             les_mean =     286.188630805535
             stat err =       0.000451509945
             autocorr =       1.255178221138
              std dev =       0.569940633734
             le_variance =       0.324832325981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690707464495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907074644920       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907074644920       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907074644920       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907074644920       residual = 5.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+07 is 1.294636e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907074644920       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907074644920       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907074644920       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907074644920       residual = 5.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+08 is 3.236623e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907074644920       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907074644920       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907074644920       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907074644920       residual = 5.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+08 is 8.091467e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031845 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7159e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9353
    reference variance = 0.236626
====================================================
  Execution time = 1.4175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3509e-01
  Total weights = 1.9517e+06
  Execution time = 1.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899144
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899144
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386027
  error estimate for blocks of size 2^( 2) =       0.000414059516
  error estimate for blocks of size 2^( 3) =       0.000426929174
  error estimate for blocks of size 2^( 4) =       0.000437683339
  error estimate for blocks of size 2^( 5) =       0.000447211494
  error estimate for blocks of size 2^( 6) =       0.000454709031
  error estimate for blocks of size 2^( 7) =       0.000460647331

      target function =                  N/A
              le_mean =     -16.907090699621
             les_mean =     286.184802075906
             stat err =       0.000450062799
             autocorr =       1.257250256228
              std dev =       0.567645563351
             le_variance =       0.322221485593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899138
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899138
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386027
  error estimate for blocks of size 2^( 2) =       0.000414059516
  error estimate for blocks of size 2^( 3) =       0.000426929174
  error estimate for blocks of size 2^( 4) =       0.000437683339
  error estimate for blocks of size 2^( 5) =       0.000447211494
  error estimate for blocks of size 2^( 6) =       0.000454709031
  error estimate for blocks of size 2^( 7) =       0.000460647331

      target function =                  N/A
              le_mean =     -16.907090699621
             les_mean =     286.184802075861
             stat err =       0.000450062799
             autocorr =       1.257250256235
              std dev =       0.567645563346
             le_variance =       0.322221485586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899141
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899141
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386027
  error estimate for blocks of size 2^( 2) =       0.000414059516
  error estimate for blocks of size 2^( 3) =       0.000426929174
  error estimate for blocks of size 2^( 4) =       0.000437683339
  error estimate for blocks of size 2^( 5) =       0.000447211494
  error estimate for blocks of size 2^( 6) =       0.000454709031
  error estimate for blocks of size 2^( 7) =       0.000460647331

      target function =                  N/A
              le_mean =     -16.907090699621
             les_mean =     286.184802075884
             stat err =       0.000450062799
             autocorr =       1.257250256230
              std dev =       0.567645563349
             le_variance =       0.322221485590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899144
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183899144
                                         uncertainty =       0.002072886880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386027
  error estimate for blocks of size 2^( 2) =       0.000414059516
  error estimate for blocks of size 2^( 3) =       0.000426929174
  error estimate for blocks of size 2^( 4) =       0.000437683339
  error estimate for blocks of size 2^( 5) =       0.000447211494
  error estimate for blocks of size 2^( 6) =       0.000454709031
  error estimate for blocks of size 2^( 7) =       0.000460647331

      target function =                  N/A
              le_mean =     -16.907090699621
             les_mean =     286.184802075903
             stat err =       0.000450062799
             autocorr =       1.257250256226
              std dev =       0.567645563351
             le_variance =       0.322221485592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907090699621        initial  <--
     3.8147e+07     3.8147e+08             1.2946e-11       -16.907090699621
     1.5259e+08     1.5259e+09             3.2366e-12       -16.907090699621
     6.1035e+08     6.1035e+09             8.0915e-13       -16.907090699621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6490
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9292
    reference variance = 0.158449
====================================================
  Execution time = 1.4428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3062e-01
  Total weights = 1.951979080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320186025180
                                         uncertainty =       0.001901446849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320186025180
                                         uncertainty =       0.001901446849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400206304
  error estimate for blocks of size 2^( 2) =       0.000412823446
  error estimate for blocks of size 2^( 3) =       0.000426043458
  error estimate for blocks of size 2^( 4) =       0.000437992381
  error estimate for blocks of size 2^( 5) =       0.000448697013
  error estimate for blocks of size 2^( 6) =       0.000457011803
  error estimate for blocks of size 2^( 7) =       0.000463429221

      target function =                  N/A
              le_mean =     -16.906495289031
             les_mean =     286.160204245342
             stat err =       0.000451782605
             autocorr =       1.274357146870
              std dev =       0.565977182913
             le_variance =       0.320330171579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649528903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906495289016       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495289016       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906495289016       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906495289016       residual = 2.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+08 is 1.209319e-12

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906495289016       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495289016       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906495289016       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906495343150       residual = 2.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+09 is 3.022875e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906495289016       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495289016       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906495289016       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906495289016       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+09 is 7.556127e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7011e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8844
    reference variance = 0.277632
====================================================
  Execution time = 1.4098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3336e-01
  Total weights = 1.9522e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401385617
  error estimate for blocks of size 2^( 2) =       0.000414273834
  error estimate for blocks of size 2^( 3) =       0.000427459986
  error estimate for blocks of size 2^( 4) =       0.000439547055
  error estimate for blocks of size 2^( 5) =       0.000449948565
  error estimate for blocks of size 2^( 6) =       0.000459990183
  error estimate for blocks of size 2^( 7) =       0.000467190132

      target function =                  N/A
              le_mean =     -16.906895110411
             les_mean =     286.176463651024
             stat err =       0.000454168984
             autocorr =       1.280298780241
              std dev =       0.567644983115
             le_variance =       0.322220826856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401385617
  error estimate for blocks of size 2^( 2) =       0.000414273834
  error estimate for blocks of size 2^( 3) =       0.000427459986
  error estimate for blocks of size 2^( 4) =       0.000439547055
  error estimate for blocks of size 2^( 5) =       0.000449948565
  error estimate for blocks of size 2^( 6) =       0.000459990183
  error estimate for blocks of size 2^( 7) =       0.000467190132

      target function =                  N/A
              le_mean =     -16.906895110411
             les_mean =     286.176463651028
             stat err =       0.000454168984
             autocorr =       1.280298780243
              std dev =       0.567644983114
             le_variance =       0.322220826855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401385617
  error estimate for blocks of size 2^( 2) =       0.000414273834
  error estimate for blocks of size 2^( 3) =       0.000427459986
  error estimate for blocks of size 2^( 4) =       0.000439547055
  error estimate for blocks of size 2^( 5) =       0.000449948565
  error estimate for blocks of size 2^( 6) =       0.000459990183
  error estimate for blocks of size 2^( 7) =       0.000467190132

      target function =                  N/A
              le_mean =     -16.906895110411
             les_mean =     286.176463651026
             stat err =       0.000454168984
             autocorr =       1.280298780237
              std dev =       0.567644983115
             le_variance =       0.322220826855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322316075615
                                         uncertainty =       0.002339813816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401385617
  error estimate for blocks of size 2^( 2) =       0.000414273834
  error estimate for blocks of size 2^( 3) =       0.000427459986
  error estimate for blocks of size 2^( 4) =       0.000439547055
  error estimate for blocks of size 2^( 5) =       0.000449948565
  error estimate for blocks of size 2^( 6) =       0.000459990183
  error estimate for blocks of size 2^( 7) =       0.000467190132

      target function =                  N/A
              le_mean =     -16.906895110411
             les_mean =     286.176463651024
             stat err =       0.000454168984
             autocorr =       1.280298780238
              std dev =       0.567644983115
             le_variance =       0.322220826856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906895110411        initial  <--
     3.8147e+08     3.8147e+09             1.2093e-12       -16.906895110411
     1.5259e+09     1.5259e+10             3.0229e-13       -16.906895110411
     6.1035e+09     6.1035e+10             7.5561e-14       -16.906895110411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7471
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.255845
====================================================
  Execution time = 1.4582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3773e-01
  Total weights = 1.951594304e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323700719793
                                         uncertainty =       0.002510089533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323700719793
                                         uncertainty =       0.002510089533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402412851
  error estimate for blocks of size 2^( 2) =       0.000415751651
  error estimate for blocks of size 2^( 3) =       0.000428805522
  error estimate for blocks of size 2^( 4) =       0.000440901360
  error estimate for blocks of size 2^( 5) =       0.000451454214
  error estimate for blocks of size 2^( 6) =       0.000458614829
  error estimate for blocks of size 2^( 7) =       0.000461928798

      target function =                  N/A
              le_mean =     -16.906300997027
             les_mean =     286.160743866608
             stat err =       0.000453224800
             autocorr =       1.268480075583
              std dev =       0.569097711510
             le_variance =       0.323872205246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630099703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300997044       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300997044       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300997044       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906302157883       residual = 5.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+09 is 1.339003e-13

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300997044       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300997044       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300997044       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303444283       residual = 6.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+10 is 3.345511e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906300997044       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300997044       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300997044       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300997044       residual = 5.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+10 is 8.366965e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7200e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9231
    reference variance = 0.200069
====================================================
  Execution time = 1.4080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4237e-01
  Total weights = 1.9517e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404086629
  error estimate for blocks of size 2^( 2) =       0.000416861500
  error estimate for blocks of size 2^( 3) =       0.000429408070
  error estimate for blocks of size 2^( 4) =       0.000442066251
  error estimate for blocks of size 2^( 5) =       0.000452587048
  error estimate for blocks of size 2^( 6) =       0.000462109895
  error estimate for blocks of size 2^( 7) =       0.000468597663

      target function =                  N/A
              le_mean =     -16.906618738984
             les_mean =     286.176127064169
             stat err =       0.000456340214
             autocorr =       1.275347467954
              std dev =       0.571464790605
             le_variance =       0.326572006901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404086629
  error estimate for blocks of size 2^( 2) =       0.000416861500
  error estimate for blocks of size 2^( 3) =       0.000429408070
  error estimate for blocks of size 2^( 4) =       0.000442066251
  error estimate for blocks of size 2^( 5) =       0.000452587048
  error estimate for blocks of size 2^( 6) =       0.000462109895
  error estimate for blocks of size 2^( 7) =       0.000468597663

      target function =                  N/A
              le_mean =     -16.906618738984
             les_mean =     286.176127064169
             stat err =       0.000456340214
             autocorr =       1.275347467955
              std dev =       0.571464790605
             le_variance =       0.326572006901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404086629
  error estimate for blocks of size 2^( 2) =       0.000416861500
  error estimate for blocks of size 2^( 3) =       0.000429408070
  error estimate for blocks of size 2^( 4) =       0.000442066251
  error estimate for blocks of size 2^( 5) =       0.000452587048
  error estimate for blocks of size 2^( 6) =       0.000462109895
  error estimate for blocks of size 2^( 7) =       0.000468597663

      target function =                  N/A
              le_mean =     -16.906618738984
             les_mean =     286.176127064169
             stat err =       0.000456340214
             autocorr =       1.275347467960
              std dev =       0.571464790605
             le_variance =       0.326572006901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326577880848
                                         uncertainty =       0.002826750698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404086629
  error estimate for blocks of size 2^( 2) =       0.000416861500
  error estimate for blocks of size 2^( 3) =       0.000429408070
  error estimate for blocks of size 2^( 4) =       0.000442066251
  error estimate for blocks of size 2^( 5) =       0.000452587048
  error estimate for blocks of size 2^( 6) =       0.000462109895
  error estimate for blocks of size 2^( 7) =       0.000468597663

      target function =                  N/A
              le_mean =     -16.906618738984
             les_mean =     286.176127064169
             stat err =       0.000456340214
             autocorr =       1.275347467957
              std dev =       0.571464790605
             le_variance =       0.326572006901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906618738984        initial  <--
     3.8147e+09     3.8147e+10             1.3390e-13       -16.906618738984
     1.5259e+10     1.5259e+11             3.3455e-14       -16.906618738984
     6.1035e+10     6.1035e+11             8.3670e-15       -16.906618738984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6058
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0812e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8663
    reference variance = 0.378747
====================================================
  Execution time = 1.4560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3717e-01
  Total weights = 1.951524958e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911856518
                                         uncertainty =       0.002325836048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911856518
                                         uncertainty =       0.002325836048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402436781
  error estimate for blocks of size 2^( 2) =       0.000415816664
  error estimate for blocks of size 2^( 3) =       0.000429673985
  error estimate for blocks of size 2^( 4) =       0.000441498961
  error estimate for blocks of size 2^( 5) =       0.000452670122
  error estimate for blocks of size 2^( 6) =       0.000461616127
  error estimate for blocks of size 2^( 7) =       0.000466435042

      target function =                  N/A
              le_mean =     -16.905757725413
             les_mean =     286.141817109845
             stat err =       0.000455555063
             autocorr =       1.281405026221
              std dev =       0.569131553227
             le_variance =       0.323910724878


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575772541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905757725412       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905757725412       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905757725412       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905757725412       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905735486725       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+10 is 1.157748e-14

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905757725412       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905757725412       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905757725412       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848024839       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905757541535       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.899072589075       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904495017700       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904325756147       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.861659326918       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.902470699296       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907049928005       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.946927238530       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.985168314210       residual = 5.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.950131608530       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.940702790511       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.517974801442       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -23.394470611632       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.027619782626       residual = 5.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -20.163577036104       residual = 6.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -14.205207559072       residual = 1.40e+03           smallest_sin_value = 9.99e-01
davidson iteration   20 stopping due to too large eigenvalue change
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+11 is 2.897201e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905757725412       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905757725412       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905757725412       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905757725412       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905497280871       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744736629       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905824735530       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905853687056       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910940363194       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909255787899       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.755417429031       residual = 1.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.067940572673       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.416753555316       residual = 9.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -15.161373588277       residual = 1.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -25.526661086417       residual = 5.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -18.990356159152       residual = 6.00e+04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -19.443546978177       residual = 1.88e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -13.580111684443       residual = 1.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+11 is 7.388212e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7160e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.828
    reference variance = 0.380743
====================================================
  Execution time = 1.4085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3244e-01
  Total weights = 1.9514e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400179756
  error estimate for blocks of size 2^( 2) =       0.000413096931
  error estimate for blocks of size 2^( 3) =       0.000426010335
  error estimate for blocks of size 2^( 4) =       0.000438280998
  error estimate for blocks of size 2^( 5) =       0.000448160341
  error estimate for blocks of size 2^( 6) =       0.000456804256
  error estimate for blocks of size 2^( 7) =       0.000461825893

      target function =                  N/A
              le_mean =     -16.906543857374
             les_mean =     286.163662079156
             stat err =       0.000451267872
             autocorr =       1.271623660410
              std dev =       0.565939638107
             le_variance =       0.320287673981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400179756
  error estimate for blocks of size 2^( 2) =       0.000413096931
  error estimate for blocks of size 2^( 3) =       0.000426010335
  error estimate for blocks of size 2^( 4) =       0.000438280998
  error estimate for blocks of size 2^( 5) =       0.000448160341
  error estimate for blocks of size 2^( 6) =       0.000456804256
  error estimate for blocks of size 2^( 7) =       0.000461825893

      target function =                  N/A
              le_mean =     -16.906543857374
             les_mean =     286.163662079156
             stat err =       0.000451267872
             autocorr =       1.271623660408
              std dev =       0.565939638107
             le_variance =       0.320287673981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400179756
  error estimate for blocks of size 2^( 2) =       0.000413096931
  error estimate for blocks of size 2^( 3) =       0.000426010335
  error estimate for blocks of size 2^( 4) =       0.000438280998
  error estimate for blocks of size 2^( 5) =       0.000448160341
  error estimate for blocks of size 2^( 6) =       0.000456804256
  error estimate for blocks of size 2^( 7) =       0.000461825893

      target function =                  N/A
              le_mean =     -16.906543857374
             les_mean =     286.163662079156
             stat err =       0.000451267872
             autocorr =       1.271623660411
              std dev =       0.565939638107
             le_variance =       0.320287673981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320253500653
                                         uncertainty =       0.001937027625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400179756
  error estimate for blocks of size 2^( 2) =       0.000413096931
  error estimate for blocks of size 2^( 3) =       0.000426010335
  error estimate for blocks of size 2^( 4) =       0.000438280998
  error estimate for blocks of size 2^( 5) =       0.000448160341
  error estimate for blocks of size 2^( 6) =       0.000456804256
  error estimate for blocks of size 2^( 7) =       0.000461825893

      target function =                  N/A
              le_mean =     -16.906543857374
             les_mean =     286.163662079156
             stat err =       0.000451267872
             autocorr =       1.271623660409
              std dev =       0.565939638107
             le_variance =       0.320287673981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906543857374        initial  <--
     3.8147e+10     3.8147e+11             1.1577e-14       -16.906543857374
     1.5259e+11     1.5259e+12             2.8972e-15       -16.906543857374
     6.1035e+11     6.1035e+12             7.3882e-16       -16.906543857374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5593
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0736e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8207
    reference variance = 0.242683
====================================================
  Execution time = 1.6496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5221e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3720e-01
  Total weights = 1.951549938e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324991354908
                                         uncertainty =       0.002611509982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324991354908
                                         uncertainty =       0.002611509982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403076892
  error estimate for blocks of size 2^( 2) =       0.000416295565
  error estimate for blocks of size 2^( 3) =       0.000429561025
  error estimate for blocks of size 2^( 4) =       0.000441930529
  error estimate for blocks of size 2^( 5) =       0.000453147774
  error estimate for blocks of size 2^( 6) =       0.000461845594
  error estimate for blocks of size 2^( 7) =       0.000466321489

      target function =                  N/A
              le_mean =     -16.905372380436
             les_mean =     286.128810468022
             stat err =       0.000455811346
             autocorr =       1.278775952756
              std dev =       0.570036807562
             le_variance =       0.324941961975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537238044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905372380423       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905372380423       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372380423       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372380423       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+11 is 1.183751e-15

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905372380423       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905372380423       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372380423       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372380423       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905372380423       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904175798082       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905487517681       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904494203963       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906210140522       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.887795927069       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.929977402393       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.550128380271       residual = 2.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.915889109796       residual = 4.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+12 is 3.033706e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905372380423       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905372380423       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905372380423       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905372380423       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+12 is 7.464524e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9072e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.965
    reference variance = 0.30523
====================================================
  Execution time = 1.4017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3310e-01
  Total weights = 1.9520e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400853582
  error estimate for blocks of size 2^( 2) =       0.000414328576
  error estimate for blocks of size 2^( 3) =       0.000427461402
  error estimate for blocks of size 2^( 4) =       0.000439949755
  error estimate for blocks of size 2^( 5) =       0.000450709702
  error estimate for blocks of size 2^( 6) =       0.000457528252
  error estimate for blocks of size 2^( 7) =       0.000463445482

      target function =                  N/A
              le_mean =     -16.906016352769
             les_mean =     286.146485396737
             stat err =       0.000452908298
             autocorr =       1.276582883264
              std dev =       0.566892572445
             le_variance =       0.321367188693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400853582
  error estimate for blocks of size 2^( 2) =       0.000414328576
  error estimate for blocks of size 2^( 3) =       0.000427461402
  error estimate for blocks of size 2^( 4) =       0.000439949755
  error estimate for blocks of size 2^( 5) =       0.000450709702
  error estimate for blocks of size 2^( 6) =       0.000457528252
  error estimate for blocks of size 2^( 7) =       0.000463445482

      target function =                  N/A
              le_mean =     -16.906016352769
             les_mean =     286.146485396737
             stat err =       0.000452908298
             autocorr =       1.276582883258
              std dev =       0.566892572445
             le_variance =       0.321367188693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400853582
  error estimate for blocks of size 2^( 2) =       0.000414328576
  error estimate for blocks of size 2^( 3) =       0.000427461402
  error estimate for blocks of size 2^( 4) =       0.000439949755
  error estimate for blocks of size 2^( 5) =       0.000450709702
  error estimate for blocks of size 2^( 6) =       0.000457528252
  error estimate for blocks of size 2^( 7) =       0.000463445482

      target function =                  N/A
              le_mean =     -16.906016352769
             les_mean =     286.146485396737
             stat err =       0.000452908298
             autocorr =       1.276582883261
              std dev =       0.566892572445
             le_variance =       0.321367188693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321365600324
                                         uncertainty =       0.002008897055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400853582
  error estimate for blocks of size 2^( 2) =       0.000414328576
  error estimate for blocks of size 2^( 3) =       0.000427461402
  error estimate for blocks of size 2^( 4) =       0.000439949755
  error estimate for blocks of size 2^( 5) =       0.000450709702
  error estimate for blocks of size 2^( 6) =       0.000457528252
  error estimate for blocks of size 2^( 7) =       0.000463445482

      target function =                  N/A
              le_mean =     -16.906016352769
             les_mean =     286.146485396737
             stat err =       0.000452908298
             autocorr =       1.276582883261
              std dev =       0.566892572445
             le_variance =       0.321367188693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906016352769        initial  <--
     3.8147e+11     3.8147e+12             1.1838e-15       -16.906016352769
     1.5259e+12     1.5259e+13             3.0337e-16       -16.906016352769
     6.1035e+12     6.1035e+13             7.4645e-17       -16.906016352769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5115
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2614e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.206533
====================================================
  Execution time = 1.4479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3732e-01
  Total weights = 1.951514295e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324809155991
                                         uncertainty =       0.003441163285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324809155991
                                         uncertainty =       0.003441163285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403161403
  error estimate for blocks of size 2^( 2) =       0.000415498632
  error estimate for blocks of size 2^( 3) =       0.000428078793
  error estimate for blocks of size 2^( 4) =       0.000439739374
  error estimate for blocks of size 2^( 5) =       0.000451712155
  error estimate for blocks of size 2^( 6) =       0.000458757515
  error estimate for blocks of size 2^( 7) =       0.000462160354

      target function =                  N/A
              le_mean =     -16.906823947632
             les_mean =     286.178016370956
             stat err =       0.000453092350
             autocorr =       1.263035517896
              std dev =       0.570156323350
             le_variance =       0.325078233056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682394763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906823947640       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906823947640       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906823947640       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906823947640       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907463179164       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906823947625       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909231342248       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912478895427       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894965406695       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.929779805185       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.973333217069       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.798614407870       residual = 5.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.923606047848       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.924833063648       residual = 6.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   14 stopping due to too large eigenvalue change
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+12 is 9.781465e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906823947640       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906823947640       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906823947640       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906823947640       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7049e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9354
    reference variance = 0.250196
====================================================
  Execution time = 1.4202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3516e-01
  Total weights = 1.9517e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401490574
  error estimate for blocks of size 2^( 2) =       0.000414469361
  error estimate for blocks of size 2^( 3) =       0.000427395021
  error estimate for blocks of size 2^( 4) =       0.000438514106
  error estimate for blocks of size 2^( 5) =       0.000447955307
  error estimate for blocks of size 2^( 6) =       0.000454660179
  error estimate for blocks of size 2^( 7) =       0.000459913902

      target function =                  N/A
              le_mean =     -16.907144497493
             les_mean =     286.186690390267
             stat err =       0.000450260874
             autocorr =       1.257701887750
              std dev =       0.567793414367
             le_variance =       0.322389361399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401490574
  error estimate for blocks of size 2^( 2) =       0.000414469361
  error estimate for blocks of size 2^( 3) =       0.000427395021
  error estimate for blocks of size 2^( 4) =       0.000438514106
  error estimate for blocks of size 2^( 5) =       0.000447955307
  error estimate for blocks of size 2^( 6) =       0.000454660179
  error estimate for blocks of size 2^( 7) =       0.000459913902

      target function =                  N/A
              le_mean =     -16.907144497493
             les_mean =     286.186690390267
             stat err =       0.000450260874
             autocorr =       1.257701887750
              std dev =       0.567793414367
             le_variance =       0.322389361399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401490574
  error estimate for blocks of size 2^( 2) =       0.000414469361
  error estimate for blocks of size 2^( 3) =       0.000427395021
  error estimate for blocks of size 2^( 4) =       0.000438514106
  error estimate for blocks of size 2^( 5) =       0.000447955307
  error estimate for blocks of size 2^( 6) =       0.000454660179
  error estimate for blocks of size 2^( 7) =       0.000459913902

      target function =                  N/A
              le_mean =     -16.907144497493
             les_mean =     286.186690390267
             stat err =       0.000450260874
             autocorr =       1.257701887750
              std dev =       0.567793414367
             le_variance =       0.322389361399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322448953206
                                         uncertainty =       0.002248332450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401490574
  error estimate for blocks of size 2^( 2) =       0.000414469361
  error estimate for blocks of size 2^( 3) =       0.000427395021
  error estimate for blocks of size 2^( 4) =       0.000438514106
  error estimate for blocks of size 2^( 5) =       0.000447955307
  error estimate for blocks of size 2^( 6) =       0.000454660179
  error estimate for blocks of size 2^( 7) =       0.000459913902

      target function =                  N/A
              le_mean =     -16.907144497493
             les_mean =     286.186690390267
             stat err =       0.000450260874
             autocorr =       1.257701887750
              std dev =       0.567793414367
             le_variance =       0.322389361399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907144497493        initial  <--
     3.8147e+12     3.8147e+13             9.7815e-17       -16.907144497493
     1.5259e+13     1.5259e+14             0.0000e+00       -16.907144497493
     6.1035e+13     6.1035e+14             0.0000e+00       -16.907144497493

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6837
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.299579
====================================================
  Execution time = 1.4440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3872e-01
  Total weights = 1.951744189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325756197992
                                         uncertainty =       0.002314192828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325756197992
                                         uncertainty =       0.002314192828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403534510
  error estimate for blocks of size 2^( 2) =       0.000416405269
  error estimate for blocks of size 2^( 3) =       0.000430050457
  error estimate for blocks of size 2^( 4) =       0.000442636332
  error estimate for blocks of size 2^( 5) =       0.000453172417
  error estimate for blocks of size 2^( 6) =       0.000461157818
  error estimate for blocks of size 2^( 7) =       0.000464911523

      target function =                  N/A
              le_mean =     -16.906620329849
             les_mean =     286.172529782946
             stat err =       0.000455469522
             autocorr =       1.273964365736
              std dev =       0.570683977099
             le_variance =       0.325680201718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690662032985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620329863       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620329863       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.78e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620329863       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620329863       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.78e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620329863       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620329863       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.78e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7007e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.404244
====================================================
  Execution time = 1.4154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3767e-01
  Total weights = 1.9516e+06
  Execution time = 1.8885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403907342
  error estimate for blocks of size 2^( 2) =       0.000416732778
  error estimate for blocks of size 2^( 3) =       0.000429346473
  error estimate for blocks of size 2^( 4) =       0.000441262587
  error estimate for blocks of size 2^( 5) =       0.000451851004
  error estimate for blocks of size 2^( 6) =       0.000459777950
  error estimate for blocks of size 2^( 7) =       0.000467855139

      target function =                  N/A
              le_mean =     -16.905756156416
             les_mean =     286.142260430930
             stat err =       0.000455186670
             autocorr =       1.270034667302
              std dev =       0.571211240906
             le_variance =       0.326282281737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403907342
  error estimate for blocks of size 2^( 2) =       0.000416732778
  error estimate for blocks of size 2^( 3) =       0.000429346473
  error estimate for blocks of size 2^( 4) =       0.000441262587
  error estimate for blocks of size 2^( 5) =       0.000451851004
  error estimate for blocks of size 2^( 6) =       0.000459777950
  error estimate for blocks of size 2^( 7) =       0.000467855139

      target function =                  N/A
              le_mean =     -16.905756156416
             les_mean =     286.142260430930
             stat err =       0.000455186670
             autocorr =       1.270034667302
              std dev =       0.571211240906
             le_variance =       0.326282281737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403907342
  error estimate for blocks of size 2^( 2) =       0.000416732778
  error estimate for blocks of size 2^( 3) =       0.000429346473
  error estimate for blocks of size 2^( 4) =       0.000441262587
  error estimate for blocks of size 2^( 5) =       0.000451851004
  error estimate for blocks of size 2^( 6) =       0.000459777950
  error estimate for blocks of size 2^( 7) =       0.000467855139

      target function =                  N/A
              le_mean =     -16.905756156416
             les_mean =     286.142260430930
             stat err =       0.000455186670
             autocorr =       1.270034667302
              std dev =       0.571211240906
             le_variance =       0.326282281737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326295738330
                                         uncertainty =       0.002392199916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403907342
  error estimate for blocks of size 2^( 2) =       0.000416732778
  error estimate for blocks of size 2^( 3) =       0.000429346473
  error estimate for blocks of size 2^( 4) =       0.000441262587
  error estimate for blocks of size 2^( 5) =       0.000451851004
  error estimate for blocks of size 2^( 6) =       0.000459777950
  error estimate for blocks of size 2^( 7) =       0.000467855139

      target function =                  N/A
              le_mean =     -16.905756156416
             les_mean =     286.142260430930
             stat err =       0.000455186670
             autocorr =       1.270034667302
              std dev =       0.571211240906
             le_variance =       0.326282281737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905756156416        initial  <--
     3.8147e+13     3.8147e+14             0.0000e+00       -16.905756156416
     1.5259e+14     1.5259e+15             0.0000e+00       -16.905756156416
     6.1035e+14     6.1035e+15             0.0000e+00       -16.905756156416

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6596
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8645
    reference variance = 0.307209
====================================================
  Execution time = 1.4349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3513e-01
  Total weights = 1.951620714e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323636038405
                                         uncertainty =       0.001940372698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323636038405
                                         uncertainty =       0.001940372698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402253021
  error estimate for blocks of size 2^( 2) =       0.000415519024
  error estimate for blocks of size 2^( 3) =       0.000428648713
  error estimate for blocks of size 2^( 4) =       0.000441126806
  error estimate for blocks of size 2^( 5) =       0.000451717066
  error estimate for blocks of size 2^( 6) =       0.000461083738
  error estimate for blocks of size 2^( 7) =       0.000466523693

      target function =                  N/A
              le_mean =     -16.905508217138
             les_mean =     286.131342421931
             stat err =       0.000455112826
             autocorr =       1.280087102281
              std dev =       0.568871677252
             le_variance =       0.323614985179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690550821714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905508217103       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905508217103       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905508217103       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905508217103       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905508217103       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905508217103       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6943e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.275032
====================================================
  Execution time = 1.4027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3935e-01
  Total weights = 1.9518e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403873281
  error estimate for blocks of size 2^( 2) =       0.000416538946
  error estimate for blocks of size 2^( 3) =       0.000429634149
  error estimate for blocks of size 2^( 4) =       0.000441432965
  error estimate for blocks of size 2^( 5) =       0.000452879788
  error estimate for blocks of size 2^( 6) =       0.000463295804
  error estimate for blocks of size 2^( 7) =       0.000468237990

      target function =                  N/A
              le_mean =     -16.906198736090
             les_mean =     286.158908133020
             stat err =       0.000456461637
             autocorr =       1.277374731818
              std dev =       0.571163071728
             le_variance =       0.326227254506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403873281
  error estimate for blocks of size 2^( 2) =       0.000416538946
  error estimate for blocks of size 2^( 3) =       0.000429634149
  error estimate for blocks of size 2^( 4) =       0.000441432965
  error estimate for blocks of size 2^( 5) =       0.000452879788
  error estimate for blocks of size 2^( 6) =       0.000463295804
  error estimate for blocks of size 2^( 7) =       0.000468237990

      target function =                  N/A
              le_mean =     -16.906198736090
             les_mean =     286.158908133020
             stat err =       0.000456461637
             autocorr =       1.277374731818
              std dev =       0.571163071728
             le_variance =       0.326227254506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403873281
  error estimate for blocks of size 2^( 2) =       0.000416538946
  error estimate for blocks of size 2^( 3) =       0.000429634149
  error estimate for blocks of size 2^( 4) =       0.000441432965
  error estimate for blocks of size 2^( 5) =       0.000452879788
  error estimate for blocks of size 2^( 6) =       0.000463295804
  error estimate for blocks of size 2^( 7) =       0.000468237990

      target function =                  N/A
              le_mean =     -16.906198736090
             les_mean =     286.158908133020
             stat err =       0.000456461637
             autocorr =       1.277374731818
              std dev =       0.571163071728
             le_variance =       0.326227254506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326119657583
                                         uncertainty =       0.002382902007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403873281
  error estimate for blocks of size 2^( 2) =       0.000416538946
  error estimate for blocks of size 2^( 3) =       0.000429634149
  error estimate for blocks of size 2^( 4) =       0.000441432965
  error estimate for blocks of size 2^( 5) =       0.000452879788
  error estimate for blocks of size 2^( 6) =       0.000463295804
  error estimate for blocks of size 2^( 7) =       0.000468237990

      target function =                  N/A
              le_mean =     -16.906198736090
             les_mean =     286.158908133020
             stat err =       0.000456461637
             autocorr =       1.277374731818
              std dev =       0.571163071728
             le_variance =       0.326227254506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906198736090        initial  <--
     3.8147e+14     3.8147e+15             0.0000e+00       -16.906198736090
     1.5259e+15     1.5259e+16             0.0000e+00       -16.906198736090
     6.1035e+15     6.1035e+16             0.0000e+00       -16.906198736090

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5172
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8467
    reference variance = 0.140784
====================================================
  Execution time = 1.4443e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3451e-01
  Total weights = 1.952111464e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323736780019
                                         uncertainty =       0.002136092404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323736780019
                                         uncertainty =       0.002136092404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402290331
  error estimate for blocks of size 2^( 2) =       0.000415011883
  error estimate for blocks of size 2^( 3) =       0.000428346726
  error estimate for blocks of size 2^( 4) =       0.000441522639
  error estimate for blocks of size 2^( 5) =       0.000453200658
  error estimate for blocks of size 2^( 6) =       0.000462422407
  error estimate for blocks of size 2^( 7) =       0.000467781807

      target function =                  N/A
              le_mean =     -16.906263013398
             les_mean =     286.156239814458
             stat err =       0.000456231878
             autocorr =       1.286151310940
              std dev =       0.568924442294
             le_variance =       0.323675021039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626301340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906263013413       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906263013413       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906263013413       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906263013413       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906263013413       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906263013413       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6998e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8639
    reference variance = 0.226261
====================================================
  Execution time = 1.4094e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3326e-01
  Total weights = 1.9518e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401106193
  error estimate for blocks of size 2^( 2) =       0.000413985694
  error estimate for blocks of size 2^( 3) =       0.000426971042
  error estimate for blocks of size 2^( 4) =       0.000439705011
  error estimate for blocks of size 2^( 5) =       0.000450590512
  error estimate for blocks of size 2^( 6) =       0.000458549601
  error estimate for blocks of size 2^( 7) =       0.000462696940

      target function =                  N/A
              le_mean =     -16.905845290715
             les_mean =     286.140867628164
             stat err =       0.000452885516
             autocorr =       1.274847179051
              std dev =       0.567249818599
             le_variance =       0.321772356701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401106193
  error estimate for blocks of size 2^( 2) =       0.000413985694
  error estimate for blocks of size 2^( 3) =       0.000426971042
  error estimate for blocks of size 2^( 4) =       0.000439705011
  error estimate for blocks of size 2^( 5) =       0.000450590512
  error estimate for blocks of size 2^( 6) =       0.000458549601
  error estimate for blocks of size 2^( 7) =       0.000462696940

      target function =                  N/A
              le_mean =     -16.905845290715
             les_mean =     286.140867628164
             stat err =       0.000452885516
             autocorr =       1.274847179051
              std dev =       0.567249818599
             le_variance =       0.321772356701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401106193
  error estimate for blocks of size 2^( 2) =       0.000413985694
  error estimate for blocks of size 2^( 3) =       0.000426971042
  error estimate for blocks of size 2^( 4) =       0.000439705011
  error estimate for blocks of size 2^( 5) =       0.000450590512
  error estimate for blocks of size 2^( 6) =       0.000458549601
  error estimate for blocks of size 2^( 7) =       0.000462696940

      target function =                  N/A
              le_mean =     -16.905845290715
             les_mean =     286.140867628164
             stat err =       0.000452885516
             autocorr =       1.274847179051
              std dev =       0.567249818599
             le_variance =       0.321772356701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321830207999
                                         uncertainty =       0.002165280387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401106193
  error estimate for blocks of size 2^( 2) =       0.000413985694
  error estimate for blocks of size 2^( 3) =       0.000426971042
  error estimate for blocks of size 2^( 4) =       0.000439705011
  error estimate for blocks of size 2^( 5) =       0.000450590512
  error estimate for blocks of size 2^( 6) =       0.000458549601
  error estimate for blocks of size 2^( 7) =       0.000462696940

      target function =                  N/A
              le_mean =     -16.905845290715
             les_mean =     286.140867628164
             stat err =       0.000452885516
             autocorr =       1.274847179051
              std dev =       0.567249818599
             le_variance =       0.321772356701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905845290715        initial  <--
     3.8147e+15     3.8147e+16             0.0000e+00       -16.905845290715
     1.5259e+16     1.5259e+17             0.0000e+00       -16.905845290715
     6.1035e+16     6.1035e+17             0.0000e+00       -16.905845290715

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6281
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0632e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9404
    reference variance = 0.189641
====================================================
  Execution time = 1.4342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4089e-01
  Total weights = 1.951817670e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327675430653
                                         uncertainty =       0.005149509367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327675430653
                                         uncertainty =       0.005149509367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404765726
  error estimate for blocks of size 2^( 2) =       0.000417770002
  error estimate for blocks of size 2^( 3) =       0.000430917216
  error estimate for blocks of size 2^( 4) =       0.000443412323
  error estimate for blocks of size 2^( 5) =       0.000453357958
  error estimate for blocks of size 2^( 6) =       0.000460902959
  error estimate for blocks of size 2^( 7) =       0.000467195136

      target function =                  N/A
              le_mean =     -16.905829788390
             les_mean =     286.147975279190
             stat err =       0.000456217094
             autocorr =       1.270385845776
              std dev =       0.572425178768
             le_variance =       0.327670585288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582978839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829788345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829788345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829788345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829788345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829788345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829788345       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6908e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8553
    reference variance = 0.218784
====================================================
  Execution time = 1.4047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2890e-01
  Total weights = 1.9518e+06
  Execution time = 1.8870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398705986
  error estimate for blocks of size 2^( 2) =       0.000411612299
  error estimate for blocks of size 2^( 3) =       0.000425095789
  error estimate for blocks of size 2^( 4) =       0.000437050790
  error estimate for blocks of size 2^( 5) =       0.000448590369
  error estimate for blocks of size 2^( 6) =       0.000457138949
  error estimate for blocks of size 2^( 7) =       0.000464705952

      target function =                  N/A
              le_mean =     -16.906246668531
             les_mean =     286.150075163747
             stat err =       0.000451871515
             autocorr =       1.284471336703
              std dev =       0.563855413344
             le_variance =       0.317932927157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398705986
  error estimate for blocks of size 2^( 2) =       0.000411612299
  error estimate for blocks of size 2^( 3) =       0.000425095789
  error estimate for blocks of size 2^( 4) =       0.000437050790
  error estimate for blocks of size 2^( 5) =       0.000448590369
  error estimate for blocks of size 2^( 6) =       0.000457138949
  error estimate for blocks of size 2^( 7) =       0.000464705952

      target function =                  N/A
              le_mean =     -16.906246668531
             les_mean =     286.150075163747
             stat err =       0.000451871515
             autocorr =       1.284471336703
              std dev =       0.563855413344
             le_variance =       0.317932927157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398705986
  error estimate for blocks of size 2^( 2) =       0.000411612299
  error estimate for blocks of size 2^( 3) =       0.000425095789
  error estimate for blocks of size 2^( 4) =       0.000437050790
  error estimate for blocks of size 2^( 5) =       0.000448590369
  error estimate for blocks of size 2^( 6) =       0.000457138949
  error estimate for blocks of size 2^( 7) =       0.000464705952

      target function =                  N/A
              le_mean =     -16.906246668531
             les_mean =     286.150075163747
             stat err =       0.000451871515
             autocorr =       1.284471336703
              std dev =       0.563855413344
             le_variance =       0.317932927157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317963862779
                                         uncertainty =       0.001626320256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398705986
  error estimate for blocks of size 2^( 2) =       0.000411612299
  error estimate for blocks of size 2^( 3) =       0.000425095789
  error estimate for blocks of size 2^( 4) =       0.000437050790
  error estimate for blocks of size 2^( 5) =       0.000448590369
  error estimate for blocks of size 2^( 6) =       0.000457138949
  error estimate for blocks of size 2^( 7) =       0.000464705952

      target function =                  N/A
              le_mean =     -16.906246668531
             les_mean =     286.150075163747
             stat err =       0.000451871515
             autocorr =       1.284471336703
              std dev =       0.563855413344
             le_variance =       0.317932927157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906246668531        initial  <--
     3.8147e+16     3.8147e+17             0.0000e+00       -16.906246668531
     1.5259e+17     1.5259e+18             0.0000e+00       -16.906246668531
     6.1035e+17     6.1035e+18             0.0000e+00       -16.906246668531

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5565
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9492
    reference variance = 0.283912
====================================================
  Execution time = 1.4464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3914e-01
  Total weights = 1.951809226e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322559362377
                                         uncertainty =       0.002237105281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322559362377
                                         uncertainty =       0.002237105281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401597792
  error estimate for blocks of size 2^( 2) =       0.000414458043
  error estimate for blocks of size 2^( 3) =       0.000427605315
  error estimate for blocks of size 2^( 4) =       0.000439876785
  error estimate for blocks of size 2^( 5) =       0.000450571477
  error estimate for blocks of size 2^( 6) =       0.000457736518
  error estimate for blocks of size 2^( 7) =       0.000462127043

      target function =                  N/A
              le_mean =     -16.906800276150
             les_mean =     286.179038021811
             stat err =       0.000452577956
             autocorr =       1.270001284259
              std dev =       0.567945044018
             le_variance =       0.322561573025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680027615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800276161       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800276161       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800276161       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911459919074       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+17 is 2.298953e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800276161       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800276161       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800276161       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800276161       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+18 is 5.747384e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800276161       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800276161       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800276161       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+18 is 1.436846e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7042e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.953
    reference variance = 0.193766
====================================================
  Execution time = 1.4126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4236e-01
  Total weights = 1.9516e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402332822
  error estimate for blocks of size 2^( 2) =       0.000415175645
  error estimate for blocks of size 2^( 3) =       0.000427709571
  error estimate for blocks of size 2^( 4) =       0.000439619113
  error estimate for blocks of size 2^( 5) =       0.000448687468
  error estimate for blocks of size 2^( 6) =       0.000455728905
  error estimate for blocks of size 2^( 7) =       0.000460722176

      target function =                  N/A
              le_mean =     -16.906434112094
             les_mean =     286.169876447940
             stat err =       0.000451189415
             autocorr =       1.257612599440
              std dev =       0.568984532955
             le_variance =       0.323743398742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402332822
  error estimate for blocks of size 2^( 2) =       0.000415175645
  error estimate for blocks of size 2^( 3) =       0.000427709571
  error estimate for blocks of size 2^( 4) =       0.000439619113
  error estimate for blocks of size 2^( 5) =       0.000448687468
  error estimate for blocks of size 2^( 6) =       0.000455728905
  error estimate for blocks of size 2^( 7) =       0.000460722176

      target function =                  N/A
              le_mean =     -16.906434112094
             les_mean =     286.169876447940
             stat err =       0.000451189415
             autocorr =       1.257612599440
              std dev =       0.568984532955
             le_variance =       0.323743398742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402332822
  error estimate for blocks of size 2^( 2) =       0.000415175645
  error estimate for blocks of size 2^( 3) =       0.000427709571
  error estimate for blocks of size 2^( 4) =       0.000439619113
  error estimate for blocks of size 2^( 5) =       0.000448687468
  error estimate for blocks of size 2^( 6) =       0.000455728905
  error estimate for blocks of size 2^( 7) =       0.000460722176

      target function =                  N/A
              le_mean =     -16.906434112094
             les_mean =     286.169876447940
             stat err =       0.000451189415
             autocorr =       1.257612599440
              std dev =       0.568984532955
             le_variance =       0.323743398742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323683930219
                                         uncertainty =       0.002688996633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402332822
  error estimate for blocks of size 2^( 2) =       0.000415175645
  error estimate for blocks of size 2^( 3) =       0.000427709571
  error estimate for blocks of size 2^( 4) =       0.000439619113
  error estimate for blocks of size 2^( 5) =       0.000448687468
  error estimate for blocks of size 2^( 6) =       0.000455728905
  error estimate for blocks of size 2^( 7) =       0.000460722176

      target function =                  N/A
              le_mean =     -16.906434112094
             les_mean =     286.169876447940
             stat err =       0.000451189415
             autocorr =       1.257612599440
              std dev =       0.568984532955
             le_variance =       0.323743398742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906434112094        initial  <--
     3.8147e+17     3.8147e+18             2.2990e-21       -16.906434112094
     1.5259e+18     1.5259e+19             5.7474e-22       -16.906434112094
     6.1035e+18     6.1035e+19             1.4368e-22       -16.906434112094

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6123
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9714
    reference variance = 0.450384
====================================================
  Execution time = 1.5339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4080e-01
  Total weights = 1.951541980e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322170787375
                                         uncertainty =       0.002341897626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322170787375
                                         uncertainty =       0.002341897626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401331417
  error estimate for blocks of size 2^( 2) =       0.000414231329
  error estimate for blocks of size 2^( 3) =       0.000427454069
  error estimate for blocks of size 2^( 4) =       0.000439055697
  error estimate for blocks of size 2^( 5) =       0.000449082204
  error estimate for blocks of size 2^( 6) =       0.000456470327
  error estimate for blocks of size 2^( 7) =       0.000459170273

      target function =                  N/A
              le_mean =     -16.906122539860
             les_mean =     286.157777118283
             stat err =       0.000450944625
             autocorr =       1.262525368456
              std dev =       0.567568332634
             le_variance =       0.322133812209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612253986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122539887       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122539887       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122539887       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122539887       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122539887       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122539887       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.1535e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9193
    reference variance = 0.230674
====================================================
  Execution time = 1.4470e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3320e-01
  Total weights = 1.9517e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400785648
  error estimate for blocks of size 2^( 2) =       0.000413550656
  error estimate for blocks of size 2^( 3) =       0.000427268420
  error estimate for blocks of size 2^( 4) =       0.000439806650
  error estimate for blocks of size 2^( 5) =       0.000451948159
  error estimate for blocks of size 2^( 6) =       0.000461300472
  error estimate for blocks of size 2^( 7) =       0.000469810711

      target function =                  N/A
              le_mean =     -16.906167211374
             les_mean =     286.151686927942
             stat err =       0.000455716498
             autocorr =       1.292900725734
              std dev =       0.566796499530
             le_variance =       0.321258271879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400785648
  error estimate for blocks of size 2^( 2) =       0.000413550656
  error estimate for blocks of size 2^( 3) =       0.000427268420
  error estimate for blocks of size 2^( 4) =       0.000439806650
  error estimate for blocks of size 2^( 5) =       0.000451948159
  error estimate for blocks of size 2^( 6) =       0.000461300472
  error estimate for blocks of size 2^( 7) =       0.000469810711

      target function =                  N/A
              le_mean =     -16.906167211374
             les_mean =     286.151686927942
             stat err =       0.000455716498
             autocorr =       1.292900725734
              std dev =       0.566796499530
             le_variance =       0.321258271879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400785648
  error estimate for blocks of size 2^( 2) =       0.000413550656
  error estimate for blocks of size 2^( 3) =       0.000427268420
  error estimate for blocks of size 2^( 4) =       0.000439806650
  error estimate for blocks of size 2^( 5) =       0.000451948159
  error estimate for blocks of size 2^( 6) =       0.000461300472
  error estimate for blocks of size 2^( 7) =       0.000469810711

      target function =                  N/A
              le_mean =     -16.906167211374
             les_mean =     286.151686927942
             stat err =       0.000455716498
             autocorr =       1.292900725734
              std dev =       0.566796499530
             le_variance =       0.321258271879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321120795449
                                         uncertainty =       0.002281592111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400785648
  error estimate for blocks of size 2^( 2) =       0.000413550656
  error estimate for blocks of size 2^( 3) =       0.000427268420
  error estimate for blocks of size 2^( 4) =       0.000439806650
  error estimate for blocks of size 2^( 5) =       0.000451948159
  error estimate for blocks of size 2^( 6) =       0.000461300472
  error estimate for blocks of size 2^( 7) =       0.000469810711

      target function =                  N/A
              le_mean =     -16.906167211374
             les_mean =     286.151686927942
             stat err =       0.000455716498
             autocorr =       1.292900725734
              std dev =       0.566796499530
             le_variance =       0.321258271879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906167211374        initial  <--
     3.8147e+18     3.8147e+19             0.0000e+00       -16.906167211374
     1.5259e+19     1.5259e+20             0.0000e+00       -16.906167211374
     6.1035e+19     6.1035e+20             0.0000e+00       -16.906167211374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9663
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.270776
====================================================
  Execution time = 1.4414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3290e-01
  Total weights = 1.951791933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319982807426
                                         uncertainty =       0.002011503110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319982807426
                                         uncertainty =       0.002011503110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399958403
  error estimate for blocks of size 2^( 2) =       0.000412643586
  error estimate for blocks of size 2^( 3) =       0.000425204291
  error estimate for blocks of size 2^( 4) =       0.000436873020
  error estimate for blocks of size 2^( 5) =       0.000447373614
  error estimate for blocks of size 2^( 6) =       0.000455720306
  error estimate for blocks of size 2^( 7) =       0.000462138759

      target function =                  N/A
              le_mean =     -16.906494055858
             les_mean =     286.162445571228
             stat err =       0.000450526425
             autocorr =       1.268851761374
              std dev =       0.565626597668
             le_variance =       0.319933447990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649405586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494055880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494055880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494055880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494055880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494055880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494055880       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6982e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.861
    reference variance = 0.375468
====================================================
  Execution time = 1.4146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3774e-01
  Total weights = 1.9517e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402941600
  error estimate for blocks of size 2^( 2) =       0.000415606701
  error estimate for blocks of size 2^( 3) =       0.000429160574
  error estimate for blocks of size 2^( 4) =       0.000440913721
  error estimate for blocks of size 2^( 5) =       0.000451233012
  error estimate for blocks of size 2^( 6) =       0.000459316351
  error estimate for blocks of size 2^( 7) =       0.000462894203

      target function =                  N/A
              le_mean =     -16.907238002867
             les_mean =     286.192432017241
             stat err =       0.000453589322
             autocorr =       1.267189106515
              std dev =       0.569845475410
             le_variance =       0.324723865846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402941600
  error estimate for blocks of size 2^( 2) =       0.000415606701
  error estimate for blocks of size 2^( 3) =       0.000429160574
  error estimate for blocks of size 2^( 4) =       0.000440913721
  error estimate for blocks of size 2^( 5) =       0.000451233012
  error estimate for blocks of size 2^( 6) =       0.000459316351
  error estimate for blocks of size 2^( 7) =       0.000462894203

      target function =                  N/A
              le_mean =     -16.907238002867
             les_mean =     286.192432017241
             stat err =       0.000453589322
             autocorr =       1.267189106515
              std dev =       0.569845475410
             le_variance =       0.324723865846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402941600
  error estimate for blocks of size 2^( 2) =       0.000415606701
  error estimate for blocks of size 2^( 3) =       0.000429160574
  error estimate for blocks of size 2^( 4) =       0.000440913721
  error estimate for blocks of size 2^( 5) =       0.000451233012
  error estimate for blocks of size 2^( 6) =       0.000459316351
  error estimate for blocks of size 2^( 7) =       0.000462894203

      target function =                  N/A
              le_mean =     -16.907238002867
             les_mean =     286.192432017241
             stat err =       0.000453589322
             autocorr =       1.267189106515
              std dev =       0.569845475410
             le_variance =       0.324723865846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324765198414
                                         uncertainty =       0.002606585965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402941600
  error estimate for blocks of size 2^( 2) =       0.000415606701
  error estimate for blocks of size 2^( 3) =       0.000429160574
  error estimate for blocks of size 2^( 4) =       0.000440913721
  error estimate for blocks of size 2^( 5) =       0.000451233012
  error estimate for blocks of size 2^( 6) =       0.000459316351
  error estimate for blocks of size 2^( 7) =       0.000462894203

      target function =                  N/A
              le_mean =     -16.907238002867
             les_mean =     286.192432017241
             stat err =       0.000453589322
             autocorr =       1.267189106515
              std dev =       0.569845475410
             le_variance =       0.324723865846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907238002867        initial  <--
     3.8147e+19     3.8147e+20             0.0000e+00       -16.907238002867
     1.5259e+20     1.5259e+21             0.0000e+00       -16.907238002867
     6.1035e+20     6.1035e+21             0.0000e+00       -16.907238002867

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6121
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.273036
====================================================
  Execution time = 1.4499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3017e-01
  Total weights = 1.951607114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318549325266
                                         uncertainty =       0.001923398585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318549325266
                                         uncertainty =       0.001923398585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399208137
  error estimate for blocks of size 2^( 2) =       0.000411946987
  error estimate for blocks of size 2^( 3) =       0.000425004566
  error estimate for blocks of size 2^( 4) =       0.000436561543
  error estimate for blocks of size 2^( 5) =       0.000446520440
  error estimate for blocks of size 2^( 6) =       0.000453929151
  error estimate for blocks of size 2^( 7) =       0.000457469845

      target function =                  N/A
              le_mean =     -16.906668198295
             les_mean =     286.165596913600
             stat err =       0.000448620245
             autocorr =       1.262870925123
              std dev =       0.564565562244
             le_variance =       0.318734274072


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690666819829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906668198316       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906668198316       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906668198316       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906668198316       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906668198316       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906668198316       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7069e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.427257
====================================================
  Execution time = 1.4380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3407e-01
  Total weights = 1.9518e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400448307
  error estimate for blocks of size 2^( 2) =       0.000413032974
  error estimate for blocks of size 2^( 3) =       0.000425735771
  error estimate for blocks of size 2^( 4) =       0.000436816367
  error estimate for blocks of size 2^( 5) =       0.000446739939
  error estimate for blocks of size 2^( 6) =       0.000455146002
  error estimate for blocks of size 2^( 7) =       0.000455906588

      target function =                  N/A
              le_mean =     -16.906428521409
             les_mean =     286.161396633506
             stat err =       0.000448652224
             autocorr =       1.255239872098
              std dev =       0.566319426795
             le_variance =       0.320717693165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400448307
  error estimate for blocks of size 2^( 2) =       0.000413032974
  error estimate for blocks of size 2^( 3) =       0.000425735771
  error estimate for blocks of size 2^( 4) =       0.000436816367
  error estimate for blocks of size 2^( 5) =       0.000446739939
  error estimate for blocks of size 2^( 6) =       0.000455146002
  error estimate for blocks of size 2^( 7) =       0.000455906588

      target function =                  N/A
              le_mean =     -16.906428521409
             les_mean =     286.161396633506
             stat err =       0.000448652224
             autocorr =       1.255239872098
              std dev =       0.566319426795
             le_variance =       0.320717693165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400448307
  error estimate for blocks of size 2^( 2) =       0.000413032974
  error estimate for blocks of size 2^( 3) =       0.000425735771
  error estimate for blocks of size 2^( 4) =       0.000436816367
  error estimate for blocks of size 2^( 5) =       0.000446739939
  error estimate for blocks of size 2^( 6) =       0.000455146002
  error estimate for blocks of size 2^( 7) =       0.000455906588

      target function =                  N/A
              le_mean =     -16.906428521409
             les_mean =     286.161396633506
             stat err =       0.000448652224
             autocorr =       1.255239872098
              std dev =       0.566319426795
             le_variance =       0.320717693165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320687420295
                                         uncertainty =       0.002050696430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400448307
  error estimate for blocks of size 2^( 2) =       0.000413032974
  error estimate for blocks of size 2^( 3) =       0.000425735771
  error estimate for blocks of size 2^( 4) =       0.000436816367
  error estimate for blocks of size 2^( 5) =       0.000446739939
  error estimate for blocks of size 2^( 6) =       0.000455146002
  error estimate for blocks of size 2^( 7) =       0.000455906588

      target function =                  N/A
              le_mean =     -16.906428521409
             les_mean =     286.161396633506
             stat err =       0.000448652224
             autocorr =       1.255239872098
              std dev =       0.566319426795
             le_variance =       0.320717693165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906428521409        initial  <--
     3.8147e+20     3.8147e+21             0.0000e+00       -16.906428521409
     1.5259e+21     1.5259e+22             0.0000e+00       -16.906428521409
     6.1035e+21     6.1035e+22             0.0000e+00       -16.906428521409

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8499
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0950e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9446
    reference variance = 0.244164
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5348e-01
  Total weights = 1.951792894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338343362396
                                         uncertainty =       0.012261896339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338343362396
                                         uncertainty =       0.012261896339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411255577
  error estimate for blocks of size 2^( 2) =       0.000424279551
  error estimate for blocks of size 2^( 3) =       0.000437387289
  error estimate for blocks of size 2^( 4) =       0.000450364603
  error estimate for blocks of size 2^( 5) =       0.000460832556
  error estimate for blocks of size 2^( 6) =       0.000469668626
  error estimate for blocks of size 2^( 7) =       0.000476212230

      target function =                  N/A
              le_mean =     -16.906007366635
             les_mean =     286.166563438115
             stat err =       0.000464269504
             autocorr =       1.274432136572
              std dev =       0.581603214392
             le_variance =       0.338262298991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600736663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906007366647       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007366647       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906007366647       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007366647       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906007366647       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007366647       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7035e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.956
    reference variance = 0.218745
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3907e-01
  Total weights = 1.9517e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402344382
  error estimate for blocks of size 2^( 2) =       0.000414910326
  error estimate for blocks of size 2^( 3) =       0.000427772649
  error estimate for blocks of size 2^( 4) =       0.000439466689
  error estimate for blocks of size 2^( 5) =       0.000449904607
  error estimate for blocks of size 2^( 6) =       0.000456502085
  error estimate for blocks of size 2^( 7) =       0.000459860384

      target function =                  N/A
              le_mean =     -16.906254139375
             les_mean =     286.160501187974
             stat err =       0.000451433441
             autocorr =       1.258900980582
              std dev =       0.569000881910
             le_variance =       0.323762003615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402344382
  error estimate for blocks of size 2^( 2) =       0.000414910326
  error estimate for blocks of size 2^( 3) =       0.000427772649
  error estimate for blocks of size 2^( 4) =       0.000439466689
  error estimate for blocks of size 2^( 5) =       0.000449904607
  error estimate for blocks of size 2^( 6) =       0.000456502085
  error estimate for blocks of size 2^( 7) =       0.000459860384

      target function =                  N/A
              le_mean =     -16.906254139375
             les_mean =     286.160501187974
             stat err =       0.000451433441
             autocorr =       1.258900980582
              std dev =       0.569000881910
             le_variance =       0.323762003615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402344382
  error estimate for blocks of size 2^( 2) =       0.000414910326
  error estimate for blocks of size 2^( 3) =       0.000427772649
  error estimate for blocks of size 2^( 4) =       0.000439466689
  error estimate for blocks of size 2^( 5) =       0.000449904607
  error estimate for blocks of size 2^( 6) =       0.000456502085
  error estimate for blocks of size 2^( 7) =       0.000459860384

      target function =                  N/A
              le_mean =     -16.906254139375
             les_mean =     286.160501187974
             stat err =       0.000451433441
             autocorr =       1.258900980582
              std dev =       0.569000881910
             le_variance =       0.323762003615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323761526265
                                         uncertainty =       0.002279045728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402344382
  error estimate for blocks of size 2^( 2) =       0.000414910326
  error estimate for blocks of size 2^( 3) =       0.000427772649
  error estimate for blocks of size 2^( 4) =       0.000439466689
  error estimate for blocks of size 2^( 5) =       0.000449904607
  error estimate for blocks of size 2^( 6) =       0.000456502085
  error estimate for blocks of size 2^( 7) =       0.000459860384

      target function =                  N/A
              le_mean =     -16.906254139375
             les_mean =     286.160501187974
             stat err =       0.000451433441
             autocorr =       1.258900980582
              std dev =       0.569000881910
             le_variance =       0.323762003615


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906254139375        initial  <--
     3.8147e+21     3.8147e+22             0.0000e+00       -16.906254139375
     1.5259e+22     1.5259e+23             0.0000e+00       -16.906254139375
     6.1035e+22     6.1035e+23             0.0000e+00       -16.906254139375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8078
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8665
    reference variance = 0.216997
====================================================
  Execution time = 1.4572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4021e-01
  Total weights = 1.951743680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325814559806
                                         uncertainty =       0.002060816869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325814559806
                                         uncertainty =       0.002060816869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403602393
  error estimate for blocks of size 2^( 2) =       0.000416724695
  error estimate for blocks of size 2^( 3) =       0.000429488751
  error estimate for blocks of size 2^( 4) =       0.000440897295
  error estimate for blocks of size 2^( 5) =       0.000451366447
  error estimate for blocks of size 2^( 6) =       0.000459460164
  error estimate for blocks of size 2^( 7) =       0.000464352562

      target function =                  N/A
              le_mean =     -16.906630562924
             les_mean =     286.174364207463
             stat err =       0.000454019117
             autocorr =       1.265437832069
              std dev =       0.570779978334
             le_variance =       0.325789783667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663056292e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906630562915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906630562915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906630562915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906630562915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906630562915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906630562915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7150e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9422
    reference variance = 0.216407
====================================================
  Execution time = 1.4141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3539e-01
  Total weights = 1.9519e+06
  Execution time = 1.8856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401055613
  error estimate for blocks of size 2^( 2) =       0.000414074056
  error estimate for blocks of size 2^( 3) =       0.000427231777
  error estimate for blocks of size 2^( 4) =       0.000439840891
  error estimate for blocks of size 2^( 5) =       0.000450202597
  error estimate for blocks of size 2^( 6) =       0.000457444818
  error estimate for blocks of size 2^( 7) =       0.000462376529

      target function =                  N/A
              le_mean =     -16.906678883144
             les_mean =     286.171183288186
             stat err =       0.000452466209
             autocorr =       1.272808608127
              std dev =       0.567178286656
             le_variance =       0.321691208854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401055613
  error estimate for blocks of size 2^( 2) =       0.000414074056
  error estimate for blocks of size 2^( 3) =       0.000427231777
  error estimate for blocks of size 2^( 4) =       0.000439840891
  error estimate for blocks of size 2^( 5) =       0.000450202597
  error estimate for blocks of size 2^( 6) =       0.000457444818
  error estimate for blocks of size 2^( 7) =       0.000462376529

      target function =                  N/A
              le_mean =     -16.906678883144
             les_mean =     286.171183288186
             stat err =       0.000452466209
             autocorr =       1.272808608127
              std dev =       0.567178286656
             le_variance =       0.321691208854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401055613
  error estimate for blocks of size 2^( 2) =       0.000414074056
  error estimate for blocks of size 2^( 3) =       0.000427231777
  error estimate for blocks of size 2^( 4) =       0.000439840891
  error estimate for blocks of size 2^( 5) =       0.000450202597
  error estimate for blocks of size 2^( 6) =       0.000457444818
  error estimate for blocks of size 2^( 7) =       0.000462376529

      target function =                  N/A
              le_mean =     -16.906678883144
             les_mean =     286.171183288186
             stat err =       0.000452466209
             autocorr =       1.272808608127
              std dev =       0.567178286656
             le_variance =       0.321691208854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717476705
                                         uncertainty =       0.002010781061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401055613
  error estimate for blocks of size 2^( 2) =       0.000414074056
  error estimate for blocks of size 2^( 3) =       0.000427231777
  error estimate for blocks of size 2^( 4) =       0.000439840891
  error estimate for blocks of size 2^( 5) =       0.000450202597
  error estimate for blocks of size 2^( 6) =       0.000457444818
  error estimate for blocks of size 2^( 7) =       0.000462376529

      target function =                  N/A
              le_mean =     -16.906678883144
             les_mean =     286.171183288186
             stat err =       0.000452466209
             autocorr =       1.272808608127
              std dev =       0.567178286656
             le_variance =       0.321691208854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906678883144        initial  <--
     3.8147e+22     3.8147e+23             0.0000e+00       -16.906678883144
     1.5259e+23     1.5259e+24             0.0000e+00       -16.906678883144
     6.1035e+23     6.1035e+24             0.0000e+00       -16.906678883144

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6313
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0787e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8604
    reference variance = 0.268729
====================================================
  Execution time = 1.4513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3835e-01
  Total weights = 1.952065722e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326545928345
                                         uncertainty =       0.003187584983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326545928345
                                         uncertainty =       0.003187584983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404043268
  error estimate for blocks of size 2^( 2) =       0.000416808509
  error estimate for blocks of size 2^( 3) =       0.000430087476
  error estimate for blocks of size 2^( 4) =       0.000442852019
  error estimate for blocks of size 2^( 5) =       0.000454013975
  error estimate for blocks of size 2^( 6) =       0.000463633075
  error estimate for blocks of size 2^( 7) =       0.000469093881

      target function =                  N/A
              le_mean =     -16.905829979493
             les_mean =     286.145437621104
             stat err =       0.000457398238
             autocorr =       1.281543119177
              std dev =       0.571403469534
             le_variance =       0.326501924995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582997949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829979441       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829979441       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829979441       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829979441       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829979441       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829979441       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7071e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.163451
====================================================
  Execution time = 1.4181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3655e-01
  Total weights = 1.9515e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840268
  error estimate for blocks of size 2^( 2) =       0.000415743536
  error estimate for blocks of size 2^( 3) =       0.000429032648
  error estimate for blocks of size 2^( 4) =       0.000441548394
  error estimate for blocks of size 2^( 5) =       0.000453731607
  error estimate for blocks of size 2^( 6) =       0.000461696005
  error estimate for blocks of size 2^( 7) =       0.000466018755

      target function =                  N/A
              le_mean =     -16.906196682683
             les_mean =     286.156038268835
             stat err =       0.000455748690
             autocorr =       1.279926724059
              std dev =       0.569702169770
             le_variance =       0.324560562241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840268
  error estimate for blocks of size 2^( 2) =       0.000415743536
  error estimate for blocks of size 2^( 3) =       0.000429032648
  error estimate for blocks of size 2^( 4) =       0.000441548394
  error estimate for blocks of size 2^( 5) =       0.000453731607
  error estimate for blocks of size 2^( 6) =       0.000461696005
  error estimate for blocks of size 2^( 7) =       0.000466018755

      target function =                  N/A
              le_mean =     -16.906196682683
             les_mean =     286.156038268835
             stat err =       0.000455748690
             autocorr =       1.279926724059
              std dev =       0.569702169770
             le_variance =       0.324560562241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840268
  error estimate for blocks of size 2^( 2) =       0.000415743536
  error estimate for blocks of size 2^( 3) =       0.000429032648
  error estimate for blocks of size 2^( 4) =       0.000441548394
  error estimate for blocks of size 2^( 5) =       0.000453731607
  error estimate for blocks of size 2^( 6) =       0.000461696005
  error estimate for blocks of size 2^( 7) =       0.000466018755

      target function =                  N/A
              le_mean =     -16.906196682683
             les_mean =     286.156038268835
             stat err =       0.000455748690
             autocorr =       1.279926724059
              std dev =       0.569702169770
             le_variance =       0.324560562241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324571360246
                                         uncertainty =       0.002153999378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840268
  error estimate for blocks of size 2^( 2) =       0.000415743536
  error estimate for blocks of size 2^( 3) =       0.000429032648
  error estimate for blocks of size 2^( 4) =       0.000441548394
  error estimate for blocks of size 2^( 5) =       0.000453731607
  error estimate for blocks of size 2^( 6) =       0.000461696005
  error estimate for blocks of size 2^( 7) =       0.000466018755

      target function =                  N/A
              le_mean =     -16.906196682683
             les_mean =     286.156038268835
             stat err =       0.000455748690
             autocorr =       1.279926724059
              std dev =       0.569702169770
             le_variance =       0.324560562241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906196682683        initial  <--
     3.8147e+23     3.8147e+24             0.0000e+00       -16.906196682683
     1.5259e+24     1.5259e+25             0.0000e+00       -16.906196682683
     6.1035e+24     6.1035e+25             0.0000e+00       -16.906196682683

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6604
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9641
    reference variance = 0.352716
====================================================
  Execution time = 1.4608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3195e-01
  Total weights = 1.951775661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320833725880
                                         uncertainty =       0.002002480944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320833725880
                                         uncertainty =       0.002002480944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400524914
  error estimate for blocks of size 2^( 2) =       0.000413439908
  error estimate for blocks of size 2^( 3) =       0.000426824986
  error estimate for blocks of size 2^( 4) =       0.000438911244
  error estimate for blocks of size 2^( 5) =       0.000450152021
  error estimate for blocks of size 2^( 6) =       0.000458171284
  error estimate for blocks of size 2^( 7) =       0.000464973508

      target function =                  N/A
              le_mean =     -16.906836898969
             les_mean =     286.173087950494
             stat err =       0.000453052014
             autocorr =       1.279490483230
              std dev =       0.566427764974
             le_variance =       0.320840412934


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683689897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906836898967       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836898967       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906836898967       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836898967       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906836898967       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836898967       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7184e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.935
    reference variance = 0.23476
====================================================
  Execution time = 1.4105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4342e-01
  Total weights = 1.9516e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404731133
  error estimate for blocks of size 2^( 2) =       0.000417591144
  error estimate for blocks of size 2^( 3) =       0.000430538471
  error estimate for blocks of size 2^( 4) =       0.000442732422
  error estimate for blocks of size 2^( 5) =       0.000453967386
  error estimate for blocks of size 2^( 6) =       0.000463583226
  error estimate for blocks of size 2^( 7) =       0.000469744349

      target function =                  N/A
              le_mean =     -16.906489362638
             les_mean =     286.172803250628
             stat err =       0.000457506846
             autocorr =       1.277797303164
              std dev =       0.572376257911
             le_variance =       0.327614580620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404731133
  error estimate for blocks of size 2^( 2) =       0.000417591144
  error estimate for blocks of size 2^( 3) =       0.000430538471
  error estimate for blocks of size 2^( 4) =       0.000442732422
  error estimate for blocks of size 2^( 5) =       0.000453967386
  error estimate for blocks of size 2^( 6) =       0.000463583226
  error estimate for blocks of size 2^( 7) =       0.000469744349

      target function =                  N/A
              le_mean =     -16.906489362638
             les_mean =     286.172803250628
             stat err =       0.000457506846
             autocorr =       1.277797303164
              std dev =       0.572376257911
             le_variance =       0.327614580620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404731133
  error estimate for blocks of size 2^( 2) =       0.000417591144
  error estimate for blocks of size 2^( 3) =       0.000430538471
  error estimate for blocks of size 2^( 4) =       0.000442732422
  error estimate for blocks of size 2^( 5) =       0.000453967386
  error estimate for blocks of size 2^( 6) =       0.000463583226
  error estimate for blocks of size 2^( 7) =       0.000469744349

      target function =                  N/A
              le_mean =     -16.906489362638
             les_mean =     286.172803250628
             stat err =       0.000457506846
             autocorr =       1.277797303164
              std dev =       0.572376257911
             le_variance =       0.327614580620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327713497324
                                         uncertainty =       0.002876087838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404731133
  error estimate for blocks of size 2^( 2) =       0.000417591144
  error estimate for blocks of size 2^( 3) =       0.000430538471
  error estimate for blocks of size 2^( 4) =       0.000442732422
  error estimate for blocks of size 2^( 5) =       0.000453967386
  error estimate for blocks of size 2^( 6) =       0.000463583226
  error estimate for blocks of size 2^( 7) =       0.000469744349

      target function =                  N/A
              le_mean =     -16.906489362638
             les_mean =     286.172803250628
             stat err =       0.000457506846
             autocorr =       1.277797303164
              std dev =       0.572376257911
             le_variance =       0.327614580620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906489362638        initial  <--
     3.8147e+24     3.8147e+25             0.0000e+00       -16.906489362638
     1.5259e+25     1.5259e+26             0.0000e+00       -16.906489362638
     6.1035e+25     6.1035e+26             0.0000e+00       -16.906489362638

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5864
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0845e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9688
    reference variance = 0.381631
====================================================
  Execution time = 1.4646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4491e-01
  Total weights = 1.951526758e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326958670236
                                         uncertainty =       0.002558113718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326958670236
                                         uncertainty =       0.002558113718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404329361
  error estimate for blocks of size 2^( 2) =       0.000417197114
  error estimate for blocks of size 2^( 3) =       0.000429967213
  error estimate for blocks of size 2^( 4) =       0.000443116703
  error estimate for blocks of size 2^( 5) =       0.000454505534
  error estimate for blocks of size 2^( 6) =       0.000461165070
  error estimate for blocks of size 2^( 7) =       0.000464445212

      target function =                  N/A
              le_mean =     -16.906402948850
             les_mean =     286.171373616043
             stat err =       0.000455808130
             autocorr =       1.270847898093
              std dev =       0.571808065954
             le_variance =       0.326964464290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640294885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906402948831       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906402948831       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906402948831       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+25 is 1.292149e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+26, overlap shift 1.5259e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906402948831       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906402948831       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906402948829       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+26 is 3.247585e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906402948831       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906402948831       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906402948831       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906402948836       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+26 is 8.075930e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7237e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.278088
====================================================
  Execution time = 1.6149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3137e-01
  Total weights = 1.9516e+06
  Execution time = 1.8838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400057911
  error estimate for blocks of size 2^( 2) =       0.000412694612
  error estimate for blocks of size 2^( 3) =       0.000425863622
  error estimate for blocks of size 2^( 4) =       0.000438044251
  error estimate for blocks of size 2^( 5) =       0.000448049843
  error estimate for blocks of size 2^( 6) =       0.000454669605
  error estimate for blocks of size 2^( 7) =       0.000459825381

      target function =                  N/A
              le_mean =     -16.906577245681
             les_mean =     286.163724676499
             stat err =       0.000450147270
             autocorr =       1.266086899028
              std dev =       0.565767323532
             le_variance =       0.320092664377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400057911
  error estimate for blocks of size 2^( 2) =       0.000412694612
  error estimate for blocks of size 2^( 3) =       0.000425863622
  error estimate for blocks of size 2^( 4) =       0.000438044251
  error estimate for blocks of size 2^( 5) =       0.000448049843
  error estimate for blocks of size 2^( 6) =       0.000454669605
  error estimate for blocks of size 2^( 7) =       0.000459825381

      target function =                  N/A
              le_mean =     -16.906577245681
             les_mean =     286.163724676499
             stat err =       0.000450147270
             autocorr =       1.266086899028
              std dev =       0.565767323532
             le_variance =       0.320092664377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400057911
  error estimate for blocks of size 2^( 2) =       0.000412694612
  error estimate for blocks of size 2^( 3) =       0.000425863622
  error estimate for blocks of size 2^( 4) =       0.000438044251
  error estimate for blocks of size 2^( 5) =       0.000448049843
  error estimate for blocks of size 2^( 6) =       0.000454669605
  error estimate for blocks of size 2^( 7) =       0.000459825381

      target function =                  N/A
              le_mean =     -16.906577245681
             les_mean =     286.163724676499
             stat err =       0.000450147270
             autocorr =       1.266086899028
              std dev =       0.565767323532
             le_variance =       0.320092664377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073026996
                                         uncertainty =       0.001940307630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400057911
  error estimate for blocks of size 2^( 2) =       0.000412694612
  error estimate for blocks of size 2^( 3) =       0.000425863622
  error estimate for blocks of size 2^( 4) =       0.000438044251
  error estimate for blocks of size 2^( 5) =       0.000448049843
  error estimate for blocks of size 2^( 6) =       0.000454669605
  error estimate for blocks of size 2^( 7) =       0.000459825381

      target function =                  N/A
              le_mean =     -16.906577245681
             les_mean =     286.163724676499
             stat err =       0.000450147270
             autocorr =       1.266086899028
              std dev =       0.565767323532
             le_variance =       0.320092664377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906577245681        initial  <--
     3.8147e+25     3.8147e+26             1.2921e-29       -16.906577245681
     1.5259e+26     1.5259e+27             3.2476e-30       -16.906577245681
     6.1035e+26     6.1035e+27             8.0759e-31       -16.906577245681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.6335
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9714
    reference variance = 0.239586
====================================================
  Execution time = 1.4555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3740e-01
  Total weights = 1.952017931e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325211067211
                                         uncertainty =       0.002791172373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325211067211
                                         uncertainty =       0.002791172373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403226289
  error estimate for blocks of size 2^( 2) =       0.000416135226
  error estimate for blocks of size 2^( 3) =       0.000428264182
  error estimate for blocks of size 2^( 4) =       0.000440170260
  error estimate for blocks of size 2^( 5) =       0.000449317980
  error estimate for blocks of size 2^( 6) =       0.000456235197
  error estimate for blocks of size 2^( 7) =       0.000461342841

      target function =                  N/A
              le_mean =     -16.907146865194
             les_mean =     286.189011115826
             stat err =       0.000451766569
             autocorr =       1.255250788564
              std dev =       0.570248086260
             le_variance =       0.325182879884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690714686519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907146865179       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907146865179       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907146865182       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+26 is 1.378478e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+27, overlap shift 1.5259e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907146865179       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907146865179       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907146865182       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+27 is 3.446196e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907146865179       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907146865179       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907146865182       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+27 is 8.615490e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7153e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9053
    reference variance = 0.368811
====================================================
  Execution time = 1.4266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3085e-01
  Total weights = 1.9517e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398007029
  error estimate for blocks of size 2^( 2) =       0.000410951986
  error estimate for blocks of size 2^( 3) =       0.000424133235
  error estimate for blocks of size 2^( 4) =       0.000436577482
  error estimate for blocks of size 2^( 5) =       0.000447275012
  error estimate for blocks of size 2^( 6) =       0.000456883215
  error estimate for blocks of size 2^( 7) =       0.000462316769

      target function =                  N/A
              le_mean =     -16.906411821619
             les_mean =     286.157606249212
             stat err =       0.000450763119
             autocorr =       1.282670974719
              std dev =       0.562866938474
             le_variance =       0.316819190427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398007029
  error estimate for blocks of size 2^( 2) =       0.000410951986
  error estimate for blocks of size 2^( 3) =       0.000424133235
  error estimate for blocks of size 2^( 4) =       0.000436577482
  error estimate for blocks of size 2^( 5) =       0.000447275012
  error estimate for blocks of size 2^( 6) =       0.000456883215
  error estimate for blocks of size 2^( 7) =       0.000462316769

      target function =                  N/A
              le_mean =     -16.906411821619
             les_mean =     286.157606249212
             stat err =       0.000450763119
             autocorr =       1.282670974719
              std dev =       0.562866938474
             le_variance =       0.316819190427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398007029
  error estimate for blocks of size 2^( 2) =       0.000410951986
  error estimate for blocks of size 2^( 3) =       0.000424133235
  error estimate for blocks of size 2^( 4) =       0.000436577482
  error estimate for blocks of size 2^( 5) =       0.000447275012
  error estimate for blocks of size 2^( 6) =       0.000456883215
  error estimate for blocks of size 2^( 7) =       0.000462316769

      target function =                  N/A
              le_mean =     -16.906411821619
             les_mean =     286.157606249212
             stat err =       0.000450763119
             autocorr =       1.282670974719
              std dev =       0.562866938474
             le_variance =       0.316819190427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316877540114
                                         uncertainty =       0.001885938562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398007029
  error estimate for blocks of size 2^( 2) =       0.000410951986
  error estimate for blocks of size 2^( 3) =       0.000424133235
  error estimate for blocks of size 2^( 4) =       0.000436577482
  error estimate for blocks of size 2^( 5) =       0.000447275012
  error estimate for blocks of size 2^( 6) =       0.000456883215
  error estimate for blocks of size 2^( 7) =       0.000462316769

      target function =                  N/A
              le_mean =     -16.906411821619
             les_mean =     286.157606249212
             stat err =       0.000450763119
             autocorr =       1.282670974719
              std dev =       0.562866938474
             le_variance =       0.316819190427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906411821619        initial  <--
     3.8147e+26     3.8147e+27             1.3785e-30       -16.906411821619
     1.5259e+27     1.5259e+28             3.4462e-31       -16.906411821619
     6.1035e+27     6.1035e+28             8.6155e-32       -16.906411821619

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7613
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.427818
====================================================
  Execution time = 1.4489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3795e-01
  Total weights = 1.952034068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324945302372
                                         uncertainty =       0.003092009563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324945302372
                                         uncertainty =       0.003092009563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403042365
  error estimate for blocks of size 2^( 2) =       0.000415755629
  error estimate for blocks of size 2^( 3) =       0.000428611564
  error estimate for blocks of size 2^( 4) =       0.000440622274
  error estimate for blocks of size 2^( 5) =       0.000451593862
  error estimate for blocks of size 2^( 6) =       0.000459949087
  error estimate for blocks of size 2^( 7) =       0.000467817854

      target function =                  N/A
              le_mean =     -16.906419053018
             les_mean =     286.164955300026
             stat err =       0.000454995769
             autocorr =       1.274422173370
              std dev =       0.569987979257
             le_variance =       0.324886296497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641905302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906419053006       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906419053006       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+28, overlap shift 1.5259e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906419053006       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906419053006       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+28, overlap shift 6.1035e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906419053006       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906419053006       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7046e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9324
    reference variance = 0.609254
====================================================
  Execution time = 1.4093e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3579e-01
  Total weights = 1.9515e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401362417
  error estimate for blocks of size 2^( 2) =       0.000414517878
  error estimate for blocks of size 2^( 3) =       0.000428011701
  error estimate for blocks of size 2^( 4) =       0.000439949778
  error estimate for blocks of size 2^( 5) =       0.000451507387
  error estimate for blocks of size 2^( 6) =       0.000459817734
  error estimate for blocks of size 2^( 7) =       0.000462573006

      target function =                  N/A
              le_mean =     -16.905593747171
             les_mean =     286.134890489513
             stat err =       0.000453461976
             autocorr =       1.276463335957
              std dev =       0.567612174084
             le_variance =       0.322183580168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401362417
  error estimate for blocks of size 2^( 2) =       0.000414517878
  error estimate for blocks of size 2^( 3) =       0.000428011701
  error estimate for blocks of size 2^( 4) =       0.000439949778
  error estimate for blocks of size 2^( 5) =       0.000451507387
  error estimate for blocks of size 2^( 6) =       0.000459817734
  error estimate for blocks of size 2^( 7) =       0.000462573006

      target function =                  N/A
              le_mean =     -16.905593747171
             les_mean =     286.134890489513
             stat err =       0.000453461976
             autocorr =       1.276463335957
              std dev =       0.567612174084
             le_variance =       0.322183580168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401362417
  error estimate for blocks of size 2^( 2) =       0.000414517878
  error estimate for blocks of size 2^( 3) =       0.000428011701
  error estimate for blocks of size 2^( 4) =       0.000439949778
  error estimate for blocks of size 2^( 5) =       0.000451507387
  error estimate for blocks of size 2^( 6) =       0.000459817734
  error estimate for blocks of size 2^( 7) =       0.000462573006

      target function =                  N/A
              le_mean =     -16.905593747171
             les_mean =     286.134890489513
             stat err =       0.000453461976
             autocorr =       1.276463335957
              std dev =       0.567612174084
             le_variance =       0.322183580168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322099738977
                                         uncertainty =       0.002153867001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401362417
  error estimate for blocks of size 2^( 2) =       0.000414517878
  error estimate for blocks of size 2^( 3) =       0.000428011701
  error estimate for blocks of size 2^( 4) =       0.000439949778
  error estimate for blocks of size 2^( 5) =       0.000451507387
  error estimate for blocks of size 2^( 6) =       0.000459817734
  error estimate for blocks of size 2^( 7) =       0.000462573006

      target function =                  N/A
              le_mean =     -16.905593747171
             les_mean =     286.134890489513
             stat err =       0.000453461976
             autocorr =       1.276463335957
              std dev =       0.567612174084
             le_variance =       0.322183580168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905593747171        initial  <--
     3.8147e+27     3.8147e+28             0.0000e+00       -16.905593747171
     1.5259e+28     1.5259e+29             0.0000e+00       -16.905593747171
     6.1035e+28     6.1035e+29             0.0000e+00       -16.905593747171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5976
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.239201
====================================================
  Execution time = 1.4614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2967e-01
  Total weights = 1.951699775e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318174401071
                                         uncertainty =       0.002073017989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318174401071
                                         uncertainty =       0.002073017989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398819503
  error estimate for blocks of size 2^( 2) =       0.000412233163
  error estimate for blocks of size 2^( 3) =       0.000425898498
  error estimate for blocks of size 2^( 4) =       0.000438448583
  error estimate for blocks of size 2^( 5) =       0.000450079910
  error estimate for blocks of size 2^( 6) =       0.000457208404
  error estimate for blocks of size 2^( 7) =       0.000462834506

      target function =                  N/A
              le_mean =     -16.905338437212
             les_mean =     286.120133625864
             stat err =       0.000452142851
             autocorr =       1.285282403254
              std dev =       0.564015949395
             le_variance =       0.318113991172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533843721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905338437201       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905338437201       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+29, overlap shift 1.5259e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905338437201       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905338437201       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+29, overlap shift 6.1035e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905338437201       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905338437201       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7204e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.307635
====================================================
  Execution time = 1.4142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3569e-01
  Total weights = 1.9519e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402450792
  error estimate for blocks of size 2^( 2) =       0.000415281057
  error estimate for blocks of size 2^( 3) =       0.000427884255
  error estimate for blocks of size 2^( 4) =       0.000440146951
  error estimate for blocks of size 2^( 5) =       0.000449512081
  error estimate for blocks of size 2^( 6) =       0.000457371554
  error estimate for blocks of size 2^( 7) =       0.000462057777

      target function =                  N/A
              le_mean =     -16.906076013898
             les_mean =     286.151100024660
             stat err =       0.000452272091
             autocorr =       1.262914659976
              std dev =       0.569151368296
             le_variance =       0.323933280033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402450792
  error estimate for blocks of size 2^( 2) =       0.000415281057
  error estimate for blocks of size 2^( 3) =       0.000427884255
  error estimate for blocks of size 2^( 4) =       0.000440146951
  error estimate for blocks of size 2^( 5) =       0.000449512081
  error estimate for blocks of size 2^( 6) =       0.000457371554
  error estimate for blocks of size 2^( 7) =       0.000462057777

      target function =                  N/A
              le_mean =     -16.906076013898
             les_mean =     286.151100024660
             stat err =       0.000452272091
             autocorr =       1.262914659976
              std dev =       0.569151368296
             le_variance =       0.323933280033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402450792
  error estimate for blocks of size 2^( 2) =       0.000415281057
  error estimate for blocks of size 2^( 3) =       0.000427884255
  error estimate for blocks of size 2^( 4) =       0.000440146951
  error estimate for blocks of size 2^( 5) =       0.000449512081
  error estimate for blocks of size 2^( 6) =       0.000457371554
  error estimate for blocks of size 2^( 7) =       0.000462057777

      target function =                  N/A
              le_mean =     -16.906076013898
             les_mean =     286.151100024660
             stat err =       0.000452272091
             autocorr =       1.262914659976
              std dev =       0.569151368296
             le_variance =       0.323933280033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943812042
                                         uncertainty =       0.002691461283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402450792
  error estimate for blocks of size 2^( 2) =       0.000415281057
  error estimate for blocks of size 2^( 3) =       0.000427884255
  error estimate for blocks of size 2^( 4) =       0.000440146951
  error estimate for blocks of size 2^( 5) =       0.000449512081
  error estimate for blocks of size 2^( 6) =       0.000457371554
  error estimate for blocks of size 2^( 7) =       0.000462057777

      target function =                  N/A
              le_mean =     -16.906076013898
             les_mean =     286.151100024660
             stat err =       0.000452272091
             autocorr =       1.262914659976
              std dev =       0.569151368296
             le_variance =       0.323933280033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906076013898        initial  <--
     3.8147e+28     3.8147e+29             0.0000e+00       -16.906076013898
     1.5259e+29     1.5259e+30             0.0000e+00       -16.906076013898
     6.1035e+29     6.1035e+30             0.0000e+00       -16.906076013898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6274
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0838e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.611121
====================================================
  Execution time = 1.4434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3560e-01
  Total weights = 1.951819239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323204318598
                                         uncertainty =       0.002339527084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323204318598
                                         uncertainty =       0.002339527084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401977066
  error estimate for blocks of size 2^( 2) =       0.000414644604
  error estimate for blocks of size 2^( 3) =       0.000428044629
  error estimate for blocks of size 2^( 4) =       0.000439937882
  error estimate for blocks of size 2^( 5) =       0.000449811304
  error estimate for blocks of size 2^( 6) =       0.000458679609
  error estimate for blocks of size 2^( 7) =       0.000461706843

      target function =                  N/A
              le_mean =     -16.907392699105
             les_mean =     286.195524911073
             stat err =       0.000452533909
             autocorr =       1.267359145706
              std dev =       0.568481418308
             le_variance =       0.323171122962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690739269910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907392699109       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907392699109       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+30, overlap shift 1.5259e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907392699109       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907392699109       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+30, overlap shift 6.1035e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907392699109       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907392699109       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7036e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.8386
    reference variance = 0.29818
====================================================
  Execution time = 1.4276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3812e-01
  Total weights = 1.9517e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403360786
  error estimate for blocks of size 2^( 2) =       0.000416414126
  error estimate for blocks of size 2^( 3) =       0.000430226959
  error estimate for blocks of size 2^( 4) =       0.000442214485
  error estimate for blocks of size 2^( 5) =       0.000452877996
  error estimate for blocks of size 2^( 6) =       0.000461168237
  error estimate for blocks of size 2^( 7) =       0.000465337283

      target function =                  N/A
              le_mean =     -16.906215387093
             les_mean =     286.158243086184
             stat err =       0.000455399500
             autocorr =       1.274669955245
              std dev =       0.570438294568
             le_variance =       0.325399847909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403360786
  error estimate for blocks of size 2^( 2) =       0.000416414126
  error estimate for blocks of size 2^( 3) =       0.000430226959
  error estimate for blocks of size 2^( 4) =       0.000442214485
  error estimate for blocks of size 2^( 5) =       0.000452877996
  error estimate for blocks of size 2^( 6) =       0.000461168237
  error estimate for blocks of size 2^( 7) =       0.000465337283

      target function =                  N/A
              le_mean =     -16.906215387093
             les_mean =     286.158243086184
             stat err =       0.000455399500
             autocorr =       1.274669955245
              std dev =       0.570438294568
             le_variance =       0.325399847909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403360786
  error estimate for blocks of size 2^( 2) =       0.000416414126
  error estimate for blocks of size 2^( 3) =       0.000430226959
  error estimate for blocks of size 2^( 4) =       0.000442214485
  error estimate for blocks of size 2^( 5) =       0.000452877996
  error estimate for blocks of size 2^( 6) =       0.000461168237
  error estimate for blocks of size 2^( 7) =       0.000465337283

      target function =                  N/A
              le_mean =     -16.906215387093
             les_mean =     286.158243086184
             stat err =       0.000455399500
             autocorr =       1.274669955245
              std dev =       0.570438294568
             le_variance =       0.325399847909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325416639744
                                         uncertainty =       0.002607146325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403360786
  error estimate for blocks of size 2^( 2) =       0.000416414126
  error estimate for blocks of size 2^( 3) =       0.000430226959
  error estimate for blocks of size 2^( 4) =       0.000442214485
  error estimate for blocks of size 2^( 5) =       0.000452877996
  error estimate for blocks of size 2^( 6) =       0.000461168237
  error estimate for blocks of size 2^( 7) =       0.000465337283

      target function =                  N/A
              le_mean =     -16.906215387093
             les_mean =     286.158243086184
             stat err =       0.000455399500
             autocorr =       1.274669955245
              std dev =       0.570438294568
             le_variance =       0.325399847909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906215387093        initial  <--
     3.8147e+29     3.8147e+30             0.0000e+00       -16.906215387093
     1.5259e+30     1.5259e+31             0.0000e+00       -16.906215387093
     6.1035e+30     6.1035e+31             0.0000e+00       -16.906215387093

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7636
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0806e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.419865
====================================================
  Execution time = 1.4507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3536e-01
  Total weights = 1.951750700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322540169442
                                         uncertainty =       0.002131319255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322540169442
                                         uncertainty =       0.002131319255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401528918
  error estimate for blocks of size 2^( 2) =       0.000414381487
  error estimate for blocks of size 2^( 3) =       0.000428009339
  error estimate for blocks of size 2^( 4) =       0.000439788637
  error estimate for blocks of size 2^( 5) =       0.000449143094
  error estimate for blocks of size 2^( 6) =       0.000458179744
  error estimate for blocks of size 2^( 7) =       0.000462451950

      target function =                  N/A
              le_mean =     -16.906534558663
             les_mean =     286.166267229296
             stat err =       0.000452390856
             autocorr =       1.269386807066
              std dev =       0.567847641020
             le_variance =       0.322450943413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653455866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534558677       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534558677       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534558679       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+30 is 9.437170e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+31, overlap shift 1.5259e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534558677       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534558677       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534558677       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534558677       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+31 is 2.536664e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+31, overlap shift 6.1035e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534558677       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534558677       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534558671       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+31 is 5.898231e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7110e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8814
    reference variance = 0.267761
====================================================
  Execution time = 1.4411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3194e-01
  Total weights = 1.9516e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399003080
  error estimate for blocks of size 2^( 2) =       0.000411635945
  error estimate for blocks of size 2^( 3) =       0.000424256028
  error estimate for blocks of size 2^( 4) =       0.000436324782
  error estimate for blocks of size 2^( 5) =       0.000447132709
  error estimate for blocks of size 2^( 6) =       0.000453847988
  error estimate for blocks of size 2^( 7) =       0.000461544277

      target function =                  N/A
              le_mean =     -16.906581027049
             les_mean =     286.164424828447
             stat err =       0.000449712439
             autocorr =       1.270332191838
              std dev =       0.564275567778
             le_variance =       0.318406916391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399003080
  error estimate for blocks of size 2^( 2) =       0.000411635945
  error estimate for blocks of size 2^( 3) =       0.000424256028
  error estimate for blocks of size 2^( 4) =       0.000436324782
  error estimate for blocks of size 2^( 5) =       0.000447132709
  error estimate for blocks of size 2^( 6) =       0.000453847988
  error estimate for blocks of size 2^( 7) =       0.000461544277

      target function =                  N/A
              le_mean =     -16.906581027049
             les_mean =     286.164424828447
             stat err =       0.000449712439
             autocorr =       1.270332191838
              std dev =       0.564275567778
             le_variance =       0.318406916391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399003080
  error estimate for blocks of size 2^( 2) =       0.000411635945
  error estimate for blocks of size 2^( 3) =       0.000424256028
  error estimate for blocks of size 2^( 4) =       0.000436324782
  error estimate for blocks of size 2^( 5) =       0.000447132709
  error estimate for blocks of size 2^( 6) =       0.000453847988
  error estimate for blocks of size 2^( 7) =       0.000461544277

      target function =                  N/A
              le_mean =     -16.906581027049
             les_mean =     286.164424828447
             stat err =       0.000449712439
             autocorr =       1.270332191838
              std dev =       0.564275567778
             le_variance =       0.318406916391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318396981342
                                         uncertainty =       0.001937517803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399003080
  error estimate for blocks of size 2^( 2) =       0.000411635945
  error estimate for blocks of size 2^( 3) =       0.000424256028
  error estimate for blocks of size 2^( 4) =       0.000436324782
  error estimate for blocks of size 2^( 5) =       0.000447132709
  error estimate for blocks of size 2^( 6) =       0.000453847988
  error estimate for blocks of size 2^( 7) =       0.000461544277

      target function =                  N/A
              le_mean =     -16.906581027049
             les_mean =     286.164424828447
             stat err =       0.000449712439
             autocorr =       1.270332191838
              std dev =       0.564275567778
             le_variance =       0.318406916391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906581027049        initial  <--
     3.8147e+30     3.8147e+31             9.4372e-35       -16.906581027049
     1.5259e+31     1.5259e+32             2.5367e-35       -16.906581027049
     6.1035e+31     6.1035e+32             5.8982e-36       -16.906581027049

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8931
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9366
    reference variance = 0.216977
====================================================
  Execution time = 1.4419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 1.951731779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361982718
                                         uncertainty =       0.002497381392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361982718
                                         uncertainty =       0.002497381392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402679135
  error estimate for blocks of size 2^( 2) =       0.000415584848
  error estimate for blocks of size 2^( 3) =       0.000428612548
  error estimate for blocks of size 2^( 4) =       0.000440739644
  error estimate for blocks of size 2^( 5) =       0.000451258163
  error estimate for blocks of size 2^( 6) =       0.000458631433
  error estimate for blocks of size 2^( 7) =       0.000463075985

      target function =                  N/A
              le_mean =     -16.906029161483
             les_mean =     286.151710414422
             stat err =       0.000453426306
             autocorr =       1.267929692616
              std dev =       0.569474293393
             le_variance =       0.324300970835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602916148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029161443       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029161443       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -20.115669400039       residual = 1.07e+14           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+31 is 1.012311e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+32, overlap shift 1.5259e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029161443       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029161443       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906029161443       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+32 is 2.530778e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+32, overlap shift 6.1035e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029161443       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029161443       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+32 is 6.326945e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6984e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8214
    reference variance = 0.70312
====================================================
  Execution time = 1.4286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3635e-01
  Total weights = 1.9514e+06
  Execution time = 1.8885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402742706
  error estimate for blocks of size 2^( 2) =       0.000415474197
  error estimate for blocks of size 2^( 3) =       0.000428458867
  error estimate for blocks of size 2^( 4) =       0.000440647362
  error estimate for blocks of size 2^( 5) =       0.000452375151
  error estimate for blocks of size 2^( 6) =       0.000460167799
  error estimate for blocks of size 2^( 7) =       0.000465530564

      target function =                  N/A
              le_mean =     -16.905889874048
             les_mean =     286.145459495646
             stat err =       0.000454680219
             autocorr =       1.274549633483
              std dev =       0.569564197602
             le_variance =       0.324403375190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402742706
  error estimate for blocks of size 2^( 2) =       0.000415474197
  error estimate for blocks of size 2^( 3) =       0.000428458867
  error estimate for blocks of size 2^( 4) =       0.000440647362
  error estimate for blocks of size 2^( 5) =       0.000452375151
  error estimate for blocks of size 2^( 6) =       0.000460167799
  error estimate for blocks of size 2^( 7) =       0.000465530564

      target function =                  N/A
              le_mean =     -16.905889874048
             les_mean =     286.145459495646
             stat err =       0.000454680219
             autocorr =       1.274549633483
              std dev =       0.569564197602
             le_variance =       0.324403375190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402742706
  error estimate for blocks of size 2^( 2) =       0.000415474197
  error estimate for blocks of size 2^( 3) =       0.000428458867
  error estimate for blocks of size 2^( 4) =       0.000440647362
  error estimate for blocks of size 2^( 5) =       0.000452375151
  error estimate for blocks of size 2^( 6) =       0.000460167799
  error estimate for blocks of size 2^( 7) =       0.000465530564

      target function =                  N/A
              le_mean =     -16.905889874048
             les_mean =     286.145459495646
             stat err =       0.000454680219
             autocorr =       1.274549633483
              std dev =       0.569564197602
             le_variance =       0.324403375190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312836620
                                         uncertainty =       0.002913759513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402742706
  error estimate for blocks of size 2^( 2) =       0.000415474197
  error estimate for blocks of size 2^( 3) =       0.000428458867
  error estimate for blocks of size 2^( 4) =       0.000440647362
  error estimate for blocks of size 2^( 5) =       0.000452375151
  error estimate for blocks of size 2^( 6) =       0.000460167799
  error estimate for blocks of size 2^( 7) =       0.000465530564

      target function =                  N/A
              le_mean =     -16.905889874048
             les_mean =     286.145459495646
             stat err =       0.000454680219
             autocorr =       1.274549633483
              std dev =       0.569564197602
             le_variance =       0.324403375190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905889874048        initial  <--
     3.8147e+31     3.8147e+32             1.0123e-35       -16.905889874048
     1.5259e+32     1.5259e+33             2.5308e-36       -16.905889874048
     6.1035e+32     6.1035e+33             6.3269e-37       -16.905889874048

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7925
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.560823
====================================================
  Execution time = 1.4473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4693e-01
  Total weights = 1.951603712e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329959443501
                                         uncertainty =       0.003194920071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329959443501
                                         uncertainty =       0.003194920071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406198367
  error estimate for blocks of size 2^( 2) =       0.000419038619
  error estimate for blocks of size 2^( 3) =       0.000431387539
  error estimate for blocks of size 2^( 4) =       0.000444196816
  error estimate for blocks of size 2^( 5) =       0.000455806354
  error estimate for blocks of size 2^( 6) =       0.000465088462
  error estimate for blocks of size 2^( 7) =       0.000469136785

      target function =                  N/A
              le_mean =     -16.904993447819
             les_mean =     286.125728670563
             stat err =       0.000458557104
             autocorr =       1.274413921606
              std dev =       0.574451239020
             le_variance =       0.329994226012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690499344782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904993447804       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904993447804       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904993447804       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904993444681       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+32 is 1.053813e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+33, overlap shift 1.5259e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904993447804       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904993447804       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904993447804       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904993447804       residual = 2.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+33 is 2.618477e-37

solving harmonic davidson linear method for identity shift 6.1035e+33, overlap shift 6.1035e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904993447804       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904993447804       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904993447804       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904993444681       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+33 is 6.586334e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7072e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8112
    reference variance = 0.292837
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3912e-01
  Total weights = 1.9517e+06
  Execution time = 1.8802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403494076
  error estimate for blocks of size 2^( 2) =       0.000416155389
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000441157363
  error estimate for blocks of size 2^( 5) =       0.000451307354
  error estimate for blocks of size 2^( 6) =       0.000460857661
  error estimate for blocks of size 2^( 7) =       0.000466408289

      target function =                  N/A
              le_mean =     -16.906426515425
             les_mean =     286.166377120486
             stat err =       0.000454932667
             autocorr =       1.271217665532
              std dev =       0.570626794664
             le_variance =       0.325614938789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403494076
  error estimate for blocks of size 2^( 2) =       0.000416155389
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000441157363
  error estimate for blocks of size 2^( 5) =       0.000451307354
  error estimate for blocks of size 2^( 6) =       0.000460857661
  error estimate for blocks of size 2^( 7) =       0.000466408289

      target function =                  N/A
              le_mean =     -16.906426515425
             les_mean =     286.166377120486
             stat err =       0.000454932667
             autocorr =       1.271217665532
              std dev =       0.570626794664
             le_variance =       0.325614938789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403494076
  error estimate for blocks of size 2^( 2) =       0.000416155389
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000441157363
  error estimate for blocks of size 2^( 5) =       0.000451307354
  error estimate for blocks of size 2^( 6) =       0.000460857661
  error estimate for blocks of size 2^( 7) =       0.000466408289

      target function =                  N/A
              le_mean =     -16.906426515425
             les_mean =     286.166377120486
             stat err =       0.000454932667
             autocorr =       1.271217665532
              std dev =       0.570626794664
             le_variance =       0.325614938789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325697136926
                                         uncertainty =       0.003565248226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403494076
  error estimate for blocks of size 2^( 2) =       0.000416155389
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000441157363
  error estimate for blocks of size 2^( 5) =       0.000451307354
  error estimate for blocks of size 2^( 6) =       0.000460857661
  error estimate for blocks of size 2^( 7) =       0.000466408289

      target function =                  N/A
              le_mean =     -16.906426515425
             les_mean =     286.166377120486
             stat err =       0.000454932667
             autocorr =       1.271217665532
              std dev =       0.570626794664
             le_variance =       0.325614938789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906426515425        initial  <--
     3.8147e+32     3.8147e+33             1.0538e-36       -16.906426515425
     1.5259e+33     1.5259e+34             2.6185e-37       -16.906426515425
     6.1035e+33     6.1035e+34             6.5863e-38       -16.906426515425

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7410
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.47227
====================================================
  Execution time = 1.4453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3596e-01
  Total weights = 1.951789096e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324107904102
                                         uncertainty =       0.002553407981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324107904102
                                         uncertainty =       0.002553407981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402544374
  error estimate for blocks of size 2^( 2) =       0.000415345795
  error estimate for blocks of size 2^( 3) =       0.000428410582
  error estimate for blocks of size 2^( 4) =       0.000440347870
  error estimate for blocks of size 2^( 5) =       0.000450856483
  error estimate for blocks of size 2^( 6) =       0.000458184168
  error estimate for blocks of size 2^( 7) =       0.000464256907

      target function =                  N/A
              le_mean =     -16.906849989205
             les_mean =     286.177537209873
             stat err =       0.000453411357
             autocorr =       1.268695106946
              std dev =       0.569283713591
             le_variance =       0.324083946560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690684998920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906849989254       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906849989254       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+34, overlap shift 1.5259e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906849989254       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906849989254       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+34, overlap shift 6.1035e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906849989254       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906849989254       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078042 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7038e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.0121
    reference variance = 0.570051
====================================================
  Execution time = 1.4058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3978e-01
  Total weights = 1.9516e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403416191
  error estimate for blocks of size 2^( 2) =       0.000416299496
  error estimate for blocks of size 2^( 3) =       0.000429397644
  error estimate for blocks of size 2^( 4) =       0.000441239572
  error estimate for blocks of size 2^( 5) =       0.000452349710
  error estimate for blocks of size 2^( 6) =       0.000459458626
  error estimate for blocks of size 2^( 7) =       0.000462625840

      target function =                  N/A
              le_mean =     -16.906388895087
             les_mean =     286.165769596824
             stat err =       0.000453918437
             autocorr =       1.266044574025
              std dev =       0.570516649136
             le_variance =       0.325489246942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403416191
  error estimate for blocks of size 2^( 2) =       0.000416299496
  error estimate for blocks of size 2^( 3) =       0.000429397644
  error estimate for blocks of size 2^( 4) =       0.000441239572
  error estimate for blocks of size 2^( 5) =       0.000452349710
  error estimate for blocks of size 2^( 6) =       0.000459458626
  error estimate for blocks of size 2^( 7) =       0.000462625840

      target function =                  N/A
              le_mean =     -16.906388895087
             les_mean =     286.165769596824
             stat err =       0.000453918437
             autocorr =       1.266044574025
              std dev =       0.570516649136
             le_variance =       0.325489246942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403416191
  error estimate for blocks of size 2^( 2) =       0.000416299496
  error estimate for blocks of size 2^( 3) =       0.000429397644
  error estimate for blocks of size 2^( 4) =       0.000441239572
  error estimate for blocks of size 2^( 5) =       0.000452349710
  error estimate for blocks of size 2^( 6) =       0.000459458626
  error estimate for blocks of size 2^( 7) =       0.000462625840

      target function =                  N/A
              le_mean =     -16.906388895087
             les_mean =     286.165769596824
             stat err =       0.000453918437
             autocorr =       1.266044574025
              std dev =       0.570516649136
             le_variance =       0.325489246942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325550203947
                                         uncertainty =       0.003111864984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403416191
  error estimate for blocks of size 2^( 2) =       0.000416299496
  error estimate for blocks of size 2^( 3) =       0.000429397644
  error estimate for blocks of size 2^( 4) =       0.000441239572
  error estimate for blocks of size 2^( 5) =       0.000452349710
  error estimate for blocks of size 2^( 6) =       0.000459458626
  error estimate for blocks of size 2^( 7) =       0.000462625840

      target function =                  N/A
              le_mean =     -16.906388895087
             les_mean =     286.165769596824
             stat err =       0.000453918437
             autocorr =       1.266044574025
              std dev =       0.570516649136
             le_variance =       0.325489246942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906388895087        initial  <--
     3.8147e+33     3.8147e+34             0.0000e+00       -16.906388895087
     1.5259e+34     1.5259e+35             0.0000e+00       -16.906388895087
     6.1035e+34     6.1035e+35             0.0000e+00       -16.906388895087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5264
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9544
    reference variance = 0.224281
====================================================
  Execution time = 1.4452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3309e-01
  Total weights = 1.951625322e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320034486990
                                         uncertainty =       0.001826650234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320034486990
                                         uncertainty =       0.001826650234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399966664
  error estimate for blocks of size 2^( 2) =       0.000412542945
  error estimate for blocks of size 2^( 3) =       0.000425140437
  error estimate for blocks of size 2^( 4) =       0.000436951522
  error estimate for blocks of size 2^( 5) =       0.000446082922
  error estimate for blocks of size 2^( 6) =       0.000453058725
  error estimate for blocks of size 2^( 7) =       0.000456557621

      target function =                  N/A
              le_mean =     -16.906413196307
             les_mean =     286.159898370458
             stat err =       0.000448162698
             autocorr =       1.255520534547
              std dev =       0.565638280562
             le_variance =       0.319946664437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641319631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413196312       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413196312       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+35, overlap shift 1.5259e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413196312       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413196312       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+35, overlap shift 6.1035e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413196312       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413196312       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079116 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7033e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9146
    reference variance = 0.293906
====================================================
  Execution time = 1.4099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3962e-01
  Total weights = 1.9517e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402021099
  error estimate for blocks of size 2^( 2) =       0.000414941961
  error estimate for blocks of size 2^( 3) =       0.000427527968
  error estimate for blocks of size 2^( 4) =       0.000439034621
  error estimate for blocks of size 2^( 5) =       0.000448228928
  error estimate for blocks of size 2^( 6) =       0.000455617520
  error estimate for blocks of size 2^( 7) =       0.000459332582

      target function =                  N/A
              le_mean =     -16.906316668102
             les_mean =     286.163160012553
             stat err =       0.000450553413
             autocorr =       1.256015139676
              std dev =       0.568543690535
             le_variance =       0.323241928047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402021099
  error estimate for blocks of size 2^( 2) =       0.000414941961
  error estimate for blocks of size 2^( 3) =       0.000427527968
  error estimate for blocks of size 2^( 4) =       0.000439034621
  error estimate for blocks of size 2^( 5) =       0.000448228928
  error estimate for blocks of size 2^( 6) =       0.000455617520
  error estimate for blocks of size 2^( 7) =       0.000459332582

      target function =                  N/A
              le_mean =     -16.906316668102
             les_mean =     286.163160012553
             stat err =       0.000450553413
             autocorr =       1.256015139676
              std dev =       0.568543690535
             le_variance =       0.323241928047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402021099
  error estimate for blocks of size 2^( 2) =       0.000414941961
  error estimate for blocks of size 2^( 3) =       0.000427527968
  error estimate for blocks of size 2^( 4) =       0.000439034621
  error estimate for blocks of size 2^( 5) =       0.000448228928
  error estimate for blocks of size 2^( 6) =       0.000455617520
  error estimate for blocks of size 2^( 7) =       0.000459332582

      target function =                  N/A
              le_mean =     -16.906316668102
             les_mean =     286.163160012553
             stat err =       0.000450553413
             autocorr =       1.256015139676
              std dev =       0.568543690535
             le_variance =       0.323241928047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323284284967
                                         uncertainty =       0.002440108837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402021099
  error estimate for blocks of size 2^( 2) =       0.000414941961
  error estimate for blocks of size 2^( 3) =       0.000427527968
  error estimate for blocks of size 2^( 4) =       0.000439034621
  error estimate for blocks of size 2^( 5) =       0.000448228928
  error estimate for blocks of size 2^( 6) =       0.000455617520
  error estimate for blocks of size 2^( 7) =       0.000459332582

      target function =                  N/A
              le_mean =     -16.906316668102
             les_mean =     286.163160012553
             stat err =       0.000450553413
             autocorr =       1.256015139676
              std dev =       0.568543690535
             le_variance =       0.323241928047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906316668102        initial  <--
     3.8147e+34     3.8147e+35             0.0000e+00       -16.906316668102
     1.5259e+35     1.5259e+36             0.0000e+00       -16.906316668102
     6.1035e+35     6.1035e+36             0.0000e+00       -16.906316668102

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5628
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.279806
====================================================
  Execution time = 1.4530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3909e-01
  Total weights = 1.951602770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323940327375
                                         uncertainty =       0.002010539335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323940327375
                                         uncertainty =       0.002010539335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402359179
  error estimate for blocks of size 2^( 2) =       0.000415117408
  error estimate for blocks of size 2^( 3) =       0.000427945206
  error estimate for blocks of size 2^( 4) =       0.000439685245
  error estimate for blocks of size 2^( 5) =       0.000449432981
  error estimate for blocks of size 2^( 6) =       0.000456914065
  error estimate for blocks of size 2^( 7) =       0.000462406918

      target function =                  N/A
              le_mean =     -16.906967829615
             les_mean =     286.184654459606
             stat err =       0.000452109803
             autocorr =       1.262583238478
              std dev =       0.569021808309
             le_variance =       0.323785818331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690696782962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906967829598       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906967829598       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+36, overlap shift 1.5259e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906967829598       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906967829598       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+36, overlap shift 6.1035e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906967829598       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906967829598       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7085e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8779
    reference variance = 0.359995
====================================================
  Execution time = 1.4027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3996e-01
  Total weights = 1.9517e+06
  Execution time = 1.8862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404448010
  error estimate for blocks of size 2^( 2) =       0.000417426873
  error estimate for blocks of size 2^( 3) =       0.000430768684
  error estimate for blocks of size 2^( 4) =       0.000443811912
  error estimate for blocks of size 2^( 5) =       0.000455267425
  error estimate for blocks of size 2^( 6) =       0.000462930974
  error estimate for blocks of size 2^( 7) =       0.000466322418

      target function =                  N/A
              le_mean =     -16.906308407937
             les_mean =     286.163223404088
             stat err =       0.000457083183
             autocorr =       1.277218142479
              std dev =       0.571975861289
             le_variance =       0.327156385897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404448010
  error estimate for blocks of size 2^( 2) =       0.000417426873
  error estimate for blocks of size 2^( 3) =       0.000430768684
  error estimate for blocks of size 2^( 4) =       0.000443811912
  error estimate for blocks of size 2^( 5) =       0.000455267425
  error estimate for blocks of size 2^( 6) =       0.000462930974
  error estimate for blocks of size 2^( 7) =       0.000466322418

      target function =                  N/A
              le_mean =     -16.906308407937
             les_mean =     286.163223404088
             stat err =       0.000457083183
             autocorr =       1.277218142479
              std dev =       0.571975861289
             le_variance =       0.327156385897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404448010
  error estimate for blocks of size 2^( 2) =       0.000417426873
  error estimate for blocks of size 2^( 3) =       0.000430768684
  error estimate for blocks of size 2^( 4) =       0.000443811912
  error estimate for blocks of size 2^( 5) =       0.000455267425
  error estimate for blocks of size 2^( 6) =       0.000462930974
  error estimate for blocks of size 2^( 7) =       0.000466322418

      target function =                  N/A
              le_mean =     -16.906308407937
             les_mean =     286.163223404088
             stat err =       0.000457083183
             autocorr =       1.277218142479
              std dev =       0.571975861289
             le_variance =       0.327156385897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327161963490
                                         uncertainty =       0.002715379211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404448010
  error estimate for blocks of size 2^( 2) =       0.000417426873
  error estimate for blocks of size 2^( 3) =       0.000430768684
  error estimate for blocks of size 2^( 4) =       0.000443811912
  error estimate for blocks of size 2^( 5) =       0.000455267425
  error estimate for blocks of size 2^( 6) =       0.000462930974
  error estimate for blocks of size 2^( 7) =       0.000466322418

      target function =                  N/A
              le_mean =     -16.906308407937
             les_mean =     286.163223404088
             stat err =       0.000457083183
             autocorr =       1.277218142479
              std dev =       0.571975861289
             le_variance =       0.327156385897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906308407937        initial  <--
     3.8147e+35     3.8147e+36             0.0000e+00       -16.906308407937
     1.5259e+36     1.5259e+37             0.0000e+00       -16.906308407937
     6.1035e+36     6.1035e+37             0.0000e+00       -16.906308407937

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5112
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9231
    reference variance = 0.250932
====================================================
  Execution time = 1.4441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5221e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3349e-01
  Total weights = 1.951509735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323306855388
                                         uncertainty =       0.002332952296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323306855388
                                         uncertainty =       0.002332952296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402071156
  error estimate for blocks of size 2^( 2) =       0.000414622307
  error estimate for blocks of size 2^( 3) =       0.000427474338
  error estimate for blocks of size 2^( 4) =       0.000439761232
  error estimate for blocks of size 2^( 5) =       0.000450492849
  error estimate for blocks of size 2^( 6) =       0.000460953838
  error estimate for blocks of size 2^( 7) =       0.000469805122

      target function =                  N/A
              le_mean =     -16.907153982733
             les_mean =     286.185344942550
             stat err =       0.000455253260
             autocorr =       1.282036211265
              std dev =       0.568614481832
             le_variance =       0.323322428949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690715398273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+36, overlap shift 3.8147e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907153982744       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907153982744       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+37, overlap shift 1.5259e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907153982744       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907153982744       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+37, overlap shift 6.1035e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907153982744       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907153982744       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7041e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.226234
====================================================
  Execution time = 1.4118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3466e-01
  Total weights = 1.9516e+06
  Execution time = 1.8880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402044471
  error estimate for blocks of size 2^( 2) =       0.000415179895
  error estimate for blocks of size 2^( 3) =       0.000428353869
  error estimate for blocks of size 2^( 4) =       0.000439994862
  error estimate for blocks of size 2^( 5) =       0.000450789331
  error estimate for blocks of size 2^( 6) =       0.000459786298
  error estimate for blocks of size 2^( 7) =       0.000464330497

      target function =                  N/A
              le_mean =     -16.907130278703
             les_mean =     286.185712342775
             stat err =       0.000453725247
             autocorr =       1.273613643173
              std dev =       0.568576744039
             le_variance =       0.323279513862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402044471
  error estimate for blocks of size 2^( 2) =       0.000415179895
  error estimate for blocks of size 2^( 3) =       0.000428353869
  error estimate for blocks of size 2^( 4) =       0.000439994862
  error estimate for blocks of size 2^( 5) =       0.000450789331
  error estimate for blocks of size 2^( 6) =       0.000459786298
  error estimate for blocks of size 2^( 7) =       0.000464330497

      target function =                  N/A
              le_mean =     -16.907130278703
             les_mean =     286.185712342775
             stat err =       0.000453725247
             autocorr =       1.273613643173
              std dev =       0.568576744039
             le_variance =       0.323279513862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402044471
  error estimate for blocks of size 2^( 2) =       0.000415179895
  error estimate for blocks of size 2^( 3) =       0.000428353869
  error estimate for blocks of size 2^( 4) =       0.000439994862
  error estimate for blocks of size 2^( 5) =       0.000450789331
  error estimate for blocks of size 2^( 6) =       0.000459786298
  error estimate for blocks of size 2^( 7) =       0.000464330497

      target function =                  N/A
              le_mean =     -16.907130278703
             les_mean =     286.185712342775
             stat err =       0.000453725247
             autocorr =       1.273613643173
              std dev =       0.568576744039
             le_variance =       0.323279513862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323329042664
                                         uncertainty =       0.002107694845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402044471
  error estimate for blocks of size 2^( 2) =       0.000415179895
  error estimate for blocks of size 2^( 3) =       0.000428353869
  error estimate for blocks of size 2^( 4) =       0.000439994862
  error estimate for blocks of size 2^( 5) =       0.000450789331
  error estimate for blocks of size 2^( 6) =       0.000459786298
  error estimate for blocks of size 2^( 7) =       0.000464330497

      target function =                  N/A
              le_mean =     -16.907130278703
             les_mean =     286.185712342775
             stat err =       0.000453725247
             autocorr =       1.273613643173
              std dev =       0.568576744039
             le_variance =       0.323279513862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907130278703        initial  <--
     3.8147e+36     3.8147e+37             0.0000e+00       -16.907130278703
     1.5259e+37     1.5259e+38             0.0000e+00       -16.907130278703
     6.1035e+37     6.1035e+38             0.0000e+00       -16.907130278703

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5960
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9176
    reference variance = 0.257935
====================================================
  Execution time = 1.4405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3628e-01
  Total weights = 1.951674999e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325223412689
                                         uncertainty =       0.002482534489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325223412689
                                         uncertainty =       0.002482534489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403299986
  error estimate for blocks of size 2^( 2) =       0.000416402313
  error estimate for blocks of size 2^( 3) =       0.000429980651
  error estimate for blocks of size 2^( 4) =       0.000442280940
  error estimate for blocks of size 2^( 5) =       0.000453551635
  error estimate for blocks of size 2^( 6) =       0.000463098631
  error estimate for blocks of size 2^( 7) =       0.000466256455

      target function =                  N/A
              le_mean =     -16.906505872446
             les_mean =     286.166221899909
             stat err =       0.000456296915
             autocorr =       1.280084532321
              std dev =       0.570352310596
             le_variance =       0.325301758202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650587245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+37, overlap shift 3.8147e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906505872443       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906505872443       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906505872443       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505872443       residual = 3.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+37 is 1.096254e-41

solving harmonic davidson linear method for identity shift 1.5259e+38, overlap shift 1.5259e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906505872443       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906505872443       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906505872443       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505872443       residual = 3.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+38 is 2.740634e-42

solving harmonic davidson linear method for identity shift 6.1035e+38, overlap shift 6.1035e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906505872443       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906505872443       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906505872443       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505872443       residual = 3.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+38 is 6.851586e-43

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6996e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8353
    reference variance = 0.187918
====================================================
  Execution time = 1.4501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3709e-01
  Total weights = 1.9517e+06
  Execution time = 1.8963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723368
  error estimate for blocks of size 2^( 2) =       0.000415640498
  error estimate for blocks of size 2^( 3) =       0.000429019816
  error estimate for blocks of size 2^( 4) =       0.000442700336
  error estimate for blocks of size 2^( 5) =       0.000454577448
  error estimate for blocks of size 2^( 6) =       0.000463894247
  error estimate for blocks of size 2^( 7) =       0.000469642218

      target function =                  N/A
              le_mean =     -16.906864932023
             les_mean =     286.179174423910
             stat err =       0.000457703562
             autocorr =       1.291679970144
              std dev =       0.569536848752
             le_variance =       0.324372222087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723368
  error estimate for blocks of size 2^( 2) =       0.000415640498
  error estimate for blocks of size 2^( 3) =       0.000429019816
  error estimate for blocks of size 2^( 4) =       0.000442700336
  error estimate for blocks of size 2^( 5) =       0.000454577448
  error estimate for blocks of size 2^( 6) =       0.000463894247
  error estimate for blocks of size 2^( 7) =       0.000469642218

      target function =                  N/A
              le_mean =     -16.906864932023
             les_mean =     286.179174423910
             stat err =       0.000457703562
             autocorr =       1.291679970144
              std dev =       0.569536848752
             le_variance =       0.324372222087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723368
  error estimate for blocks of size 2^( 2) =       0.000415640498
  error estimate for blocks of size 2^( 3) =       0.000429019816
  error estimate for blocks of size 2^( 4) =       0.000442700336
  error estimate for blocks of size 2^( 5) =       0.000454577448
  error estimate for blocks of size 2^( 6) =       0.000463894247
  error estimate for blocks of size 2^( 7) =       0.000469642218

      target function =                  N/A
              le_mean =     -16.906864932023
             les_mean =     286.179174423910
             stat err =       0.000457703562
             autocorr =       1.291679970144
              std dev =       0.569536848752
             le_variance =       0.324372222087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324404621064
                                         uncertainty =       0.002292333207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723368
  error estimate for blocks of size 2^( 2) =       0.000415640498
  error estimate for blocks of size 2^( 3) =       0.000429019816
  error estimate for blocks of size 2^( 4) =       0.000442700336
  error estimate for blocks of size 2^( 5) =       0.000454577448
  error estimate for blocks of size 2^( 6) =       0.000463894247
  error estimate for blocks of size 2^( 7) =       0.000469642218

      target function =                  N/A
              le_mean =     -16.906864932023
             les_mean =     286.179174423910
             stat err =       0.000457703562
             autocorr =       1.291679970144
              std dev =       0.569536848752
             le_variance =       0.324372222087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906864932023        initial  <--
     3.8147e+37     3.8147e+38             1.0963e-41       -16.906864932023
     1.5259e+38     1.5259e+39             2.7406e-42       -16.906864932023
     6.1035e+38     6.1035e+39             6.8516e-43       -16.906864932023

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0309
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.361881
====================================================
  Execution time = 1.4438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3214e-01
  Total weights = 1.951819003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319467976277
                                         uncertainty =       0.002617919110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319467976277
                                         uncertainty =       0.002617919110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399618371
  error estimate for blocks of size 2^( 2) =       0.000412298100
  error estimate for blocks of size 2^( 3) =       0.000425346446
  error estimate for blocks of size 2^( 4) =       0.000437489400
  error estimate for blocks of size 2^( 5) =       0.000447812464
  error estimate for blocks of size 2^( 6) =       0.000456453656
  error estimate for blocks of size 2^( 7) =       0.000461802920

      target function =                  N/A
              le_mean =     -16.906799040474
             les_mean =     286.171996742101
             stat err =       0.000450889610
             autocorr =       1.273062029863
              std dev =       0.565145720030
             le_variance =       0.319389684869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679904047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+38, overlap shift 3.8147e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906799040490       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906799040490       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799316406       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+38 is 9.767187e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+39, overlap shift 1.5259e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906799040490       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906799040490       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799316406       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+39 is 2.441797e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+39, overlap shift 6.1035e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906799040490       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906799040490       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799316406       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+39 is 6.104492e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6987e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.248238
====================================================
  Execution time = 1.4303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3576e-01
  Total weights = 1.9516e+06
  Execution time = 1.9139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400909343
  error estimate for blocks of size 2^( 2) =       0.000413798775
  error estimate for blocks of size 2^( 3) =       0.000426467658
  error estimate for blocks of size 2^( 4) =       0.000438720764
  error estimate for blocks of size 2^( 5) =       0.000450155195
  error estimate for blocks of size 2^( 6) =       0.000458241459
  error estimate for blocks of size 2^( 7) =       0.000462612038

      target function =                  N/A
              le_mean =     -16.905182509721
             les_mean =     286.120954403107
             stat err =       0.000452432364
             autocorr =       1.273546986606
              std dev =       0.566971430226
             le_variance =       0.321456602692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400909343
  error estimate for blocks of size 2^( 2) =       0.000413798775
  error estimate for blocks of size 2^( 3) =       0.000426467658
  error estimate for blocks of size 2^( 4) =       0.000438720764
  error estimate for blocks of size 2^( 5) =       0.000450155195
  error estimate for blocks of size 2^( 6) =       0.000458241459
  error estimate for blocks of size 2^( 7) =       0.000462612038

      target function =                  N/A
              le_mean =     -16.905182509721
             les_mean =     286.120954403107
             stat err =       0.000452432364
             autocorr =       1.273546986606
              std dev =       0.566971430226
             le_variance =       0.321456602692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400909343
  error estimate for blocks of size 2^( 2) =       0.000413798775
  error estimate for blocks of size 2^( 3) =       0.000426467658
  error estimate for blocks of size 2^( 4) =       0.000438720764
  error estimate for blocks of size 2^( 5) =       0.000450155195
  error estimate for blocks of size 2^( 6) =       0.000458241459
  error estimate for blocks of size 2^( 7) =       0.000462612038

      target function =                  N/A
              le_mean =     -16.905182509721
             les_mean =     286.120954403107
             stat err =       0.000452432364
             autocorr =       1.273546986606
              std dev =       0.566971430226
             le_variance =       0.321456602692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482504652
                                         uncertainty =       0.002450629155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400909343
  error estimate for blocks of size 2^( 2) =       0.000413798775
  error estimate for blocks of size 2^( 3) =       0.000426467658
  error estimate for blocks of size 2^( 4) =       0.000438720764
  error estimate for blocks of size 2^( 5) =       0.000450155195
  error estimate for blocks of size 2^( 6) =       0.000458241459
  error estimate for blocks of size 2^( 7) =       0.000462612038

      target function =                  N/A
              le_mean =     -16.905182509721
             les_mean =     286.120954403107
             stat err =       0.000452432364
             autocorr =       1.273546986606
              std dev =       0.566971430226
             le_variance =       0.321456602692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905182509721        initial  <--
     3.8147e+38     3.8147e+39             9.7672e-43       -16.905182509721
     1.5259e+39     1.5259e+40             2.4418e-43       -16.905182509721
     6.1035e+39     6.1035e+40             6.1045e-44       -16.905182509721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8327
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9649
    reference variance = 0.198479
====================================================
  Execution time = 1.4412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3118e-01
  Total weights = 1.952054957e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319886594195
                                         uncertainty =       0.001889704128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319886594195
                                         uncertainty =       0.001889704128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399959296
  error estimate for blocks of size 2^( 2) =       0.000412496802
  error estimate for blocks of size 2^( 3) =       0.000425453830
  error estimate for blocks of size 2^( 4) =       0.000437708648
  error estimate for blocks of size 2^( 5) =       0.000447621201
  error estimate for blocks of size 2^( 6) =       0.000455279390
  error estimate for blocks of size 2^( 7) =       0.000458485815

      target function =                  N/A
              le_mean =     -16.906339305587
             les_mean =     286.155491762535
             stat err =       0.000449773763
             autocorr =       1.264610102255
              std dev =       0.565627860240
             le_variance =       0.319934876280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633930559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+39, overlap shift 3.8147e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906339305581       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906339305581       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+40, overlap shift 1.5259e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906339305581       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906339305581       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+40, overlap shift 6.1035e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906339305581       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906339305581       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6983e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8746
    reference variance = 0.22378
====================================================
  Execution time = 1.4114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3979e-01
  Total weights = 1.9519e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403806824
  error estimate for blocks of size 2^( 2) =       0.000416528455
  error estimate for blocks of size 2^( 3) =       0.000430177826
  error estimate for blocks of size 2^( 4) =       0.000441925019
  error estimate for blocks of size 2^( 5) =       0.000452469019
  error estimate for blocks of size 2^( 6) =       0.000461224296
  error estimate for blocks of size 2^( 7) =       0.000464821562

      target function =                  N/A
              le_mean =     -16.906840459593
             les_mean =     286.181042369896
             stat err =       0.000455109974
             autocorr =       1.270238872311
              std dev =       0.571069087248
             le_variance =       0.326119902410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403806824
  error estimate for blocks of size 2^( 2) =       0.000416528455
  error estimate for blocks of size 2^( 3) =       0.000430177826
  error estimate for blocks of size 2^( 4) =       0.000441925019
  error estimate for blocks of size 2^( 5) =       0.000452469019
  error estimate for blocks of size 2^( 6) =       0.000461224296
  error estimate for blocks of size 2^( 7) =       0.000464821562

      target function =                  N/A
              le_mean =     -16.906840459593
             les_mean =     286.181042369896
             stat err =       0.000455109974
             autocorr =       1.270238872311
              std dev =       0.571069087248
             le_variance =       0.326119902410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403806824
  error estimate for blocks of size 2^( 2) =       0.000416528455
  error estimate for blocks of size 2^( 3) =       0.000430177826
  error estimate for blocks of size 2^( 4) =       0.000441925019
  error estimate for blocks of size 2^( 5) =       0.000452469019
  error estimate for blocks of size 2^( 6) =       0.000461224296
  error estimate for blocks of size 2^( 7) =       0.000464821562

      target function =                  N/A
              le_mean =     -16.906840459593
             les_mean =     286.181042369896
             stat err =       0.000455109974
             autocorr =       1.270238872311
              std dev =       0.571069087248
             le_variance =       0.326119902410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326123757000
                                         uncertainty =       0.004379698313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403806824
  error estimate for blocks of size 2^( 2) =       0.000416528455
  error estimate for blocks of size 2^( 3) =       0.000430177826
  error estimate for blocks of size 2^( 4) =       0.000441925019
  error estimate for blocks of size 2^( 5) =       0.000452469019
  error estimate for blocks of size 2^( 6) =       0.000461224296
  error estimate for blocks of size 2^( 7) =       0.000464821562

      target function =                  N/A
              le_mean =     -16.906840459593
             les_mean =     286.181042369896
             stat err =       0.000455109974
             autocorr =       1.270238872311
              std dev =       0.571069087248
             le_variance =       0.326119902410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906840459593        initial  <--
     3.8147e+39     3.8147e+40             0.0000e+00       -16.906840459593
     1.5259e+40     1.5259e+41             0.0000e+00       -16.906840459593
     6.1035e+40     6.1035e+41             0.0000e+00       -16.906840459593

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5950
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.265279
====================================================
  Execution time = 1.6845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3709e-01
  Total weights = 1.951832601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321493531305
                                         uncertainty =       0.002379733971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321493531305
                                         uncertainty =       0.002379733971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400942311
  error estimate for blocks of size 2^( 2) =       0.000413954763
  error estimate for blocks of size 2^( 3) =       0.000427740927
  error estimate for blocks of size 2^( 4) =       0.000440499244
  error estimate for blocks of size 2^( 5) =       0.000452099639
  error estimate for blocks of size 2^( 6) =       0.000461402309
  error estimate for blocks of size 2^( 7) =       0.000465465570

      target function =                  N/A
              le_mean =     -16.906238830661
             les_mean =     286.158000253811
             stat err =       0.000454866691
             autocorr =       1.287076884070
              std dev =       0.567018054603
             le_variance =       0.321509474246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623883066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+40, overlap shift 3.8147e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238830648       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238830648       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+41, overlap shift 1.5259e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238830648       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238830648       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+41, overlap shift 6.1035e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238830648       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238830648       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9434e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.819
    reference variance = 0.251253
====================================================
  Execution time = 1.4116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3877e-01
  Total weights = 1.9514e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403175677
  error estimate for blocks of size 2^( 2) =       0.000416031935
  error estimate for blocks of size 2^( 3) =       0.000429276995
  error estimate for blocks of size 2^( 4) =       0.000441269623
  error estimate for blocks of size 2^( 5) =       0.000452104796
  error estimate for blocks of size 2^( 6) =       0.000460020074
  error estimate for blocks of size 2^( 7) =       0.000462031439

      target function =                  N/A
              le_mean =     -16.906004574164
             les_mean =     286.151756581527
             stat err =       0.000453856483
             autocorr =       1.267209556920
              std dev =       0.570176510307
             le_variance =       0.325101252906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403175677
  error estimate for blocks of size 2^( 2) =       0.000416031935
  error estimate for blocks of size 2^( 3) =       0.000429276995
  error estimate for blocks of size 2^( 4) =       0.000441269623
  error estimate for blocks of size 2^( 5) =       0.000452104796
  error estimate for blocks of size 2^( 6) =       0.000460020074
  error estimate for blocks of size 2^( 7) =       0.000462031439

      target function =                  N/A
              le_mean =     -16.906004574164
             les_mean =     286.151756581527
             stat err =       0.000453856483
             autocorr =       1.267209556920
              std dev =       0.570176510307
             le_variance =       0.325101252906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403175677
  error estimate for blocks of size 2^( 2) =       0.000416031935
  error estimate for blocks of size 2^( 3) =       0.000429276995
  error estimate for blocks of size 2^( 4) =       0.000441269623
  error estimate for blocks of size 2^( 5) =       0.000452104796
  error estimate for blocks of size 2^( 6) =       0.000460020074
  error estimate for blocks of size 2^( 7) =       0.000462031439

      target function =                  N/A
              le_mean =     -16.906004574164
             les_mean =     286.151756581527
             stat err =       0.000453856483
             autocorr =       1.267209556920
              std dev =       0.570176510307
             le_variance =       0.325101252906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325130538192
                                         uncertainty =       0.002588906723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403175677
  error estimate for blocks of size 2^( 2) =       0.000416031935
  error estimate for blocks of size 2^( 3) =       0.000429276995
  error estimate for blocks of size 2^( 4) =       0.000441269623
  error estimate for blocks of size 2^( 5) =       0.000452104796
  error estimate for blocks of size 2^( 6) =       0.000460020074
  error estimate for blocks of size 2^( 7) =       0.000462031439

      target function =                  N/A
              le_mean =     -16.906004574164
             les_mean =     286.151756581527
             stat err =       0.000453856483
             autocorr =       1.267209556920
              std dev =       0.570176510307
             le_variance =       0.325101252906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906004574164        initial  <--
     3.8147e+40     3.8147e+41             0.0000e+00       -16.906004574164
     1.5259e+41     1.5259e+42             0.0000e+00       -16.906004574164
     6.1035e+41     6.1035e+42             0.0000e+00       -16.906004574164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7170
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3158e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8001
    reference variance = 0.27411
====================================================
  Execution time = 1.4602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3243e-01
  Total weights = 1.951550126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320936752293
                                         uncertainty =       0.002241560030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320936752293
                                         uncertainty =       0.002241560030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400973386
  error estimate for blocks of size 2^( 2) =       0.000413500592
  error estimate for blocks of size 2^( 3) =       0.000426129804
  error estimate for blocks of size 2^( 4) =       0.000438212814
  error estimate for blocks of size 2^( 5) =       0.000448151728
  error estimate for blocks of size 2^( 6) =       0.000455413857
  error estimate for blocks of size 2^( 7) =       0.000458638971

      target function =                  N/A
              le_mean =     -16.906164954651
             les_mean =     286.150841416009
             stat err =       0.000450104343
             autocorr =       1.260071855245
              std dev =       0.567061999990
             le_variance =       0.321559311833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616495465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+41, overlap shift 3.8147e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164954664       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164954664       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+42, overlap shift 1.5259e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164954664       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164954664       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+42, overlap shift 6.1035e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164954664       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164954664       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7200e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8366
    reference variance = 0.120827
====================================================
  Execution time = 1.4319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3724e-01
  Total weights = 1.9520e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403552779
  error estimate for blocks of size 2^( 2) =       0.000416801100
  error estimate for blocks of size 2^( 3) =       0.000430138818
  error estimate for blocks of size 2^( 4) =       0.000442627882
  error estimate for blocks of size 2^( 5) =       0.000452994387
  error estimate for blocks of size 2^( 6) =       0.000461031742
  error estimate for blocks of size 2^( 7) =       0.000466333617

      target function =                  N/A
              le_mean =     -16.905789228358
             les_mean =     286.142946291592
             stat err =       0.000455746907
             autocorr =       1.275401065976
              std dev =       0.570709812927
             le_variance =       0.325709690572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403552779
  error estimate for blocks of size 2^( 2) =       0.000416801100
  error estimate for blocks of size 2^( 3) =       0.000430138818
  error estimate for blocks of size 2^( 4) =       0.000442627882
  error estimate for blocks of size 2^( 5) =       0.000452994387
  error estimate for blocks of size 2^( 6) =       0.000461031742
  error estimate for blocks of size 2^( 7) =       0.000466333617

      target function =                  N/A
              le_mean =     -16.905789228358
             les_mean =     286.142946291592
             stat err =       0.000455746907
             autocorr =       1.275401065976
              std dev =       0.570709812927
             le_variance =       0.325709690572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403552779
  error estimate for blocks of size 2^( 2) =       0.000416801100
  error estimate for blocks of size 2^( 3) =       0.000430138818
  error estimate for blocks of size 2^( 4) =       0.000442627882
  error estimate for blocks of size 2^( 5) =       0.000452994387
  error estimate for blocks of size 2^( 6) =       0.000461031742
  error estimate for blocks of size 2^( 7) =       0.000466333617

      target function =                  N/A
              le_mean =     -16.905789228358
             les_mean =     286.142946291592
             stat err =       0.000455746907
             autocorr =       1.275401065976
              std dev =       0.570709812927
             le_variance =       0.325709690572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325648822071
                                         uncertainty =       0.002913938822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403552779
  error estimate for blocks of size 2^( 2) =       0.000416801100
  error estimate for blocks of size 2^( 3) =       0.000430138818
  error estimate for blocks of size 2^( 4) =       0.000442627882
  error estimate for blocks of size 2^( 5) =       0.000452994387
  error estimate for blocks of size 2^( 6) =       0.000461031742
  error estimate for blocks of size 2^( 7) =       0.000466333617

      target function =                  N/A
              le_mean =     -16.905789228358
             les_mean =     286.142946291592
             stat err =       0.000455746907
             autocorr =       1.275401065976
              std dev =       0.570709812927
             le_variance =       0.325709690572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905789228358        initial  <--
     3.8147e+41     3.8147e+42             0.0000e+00       -16.905789228358
     1.5259e+42     1.5259e+43             0.0000e+00       -16.905789228358
     6.1035e+42     6.1035e+43             0.0000e+00       -16.905789228358

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8076
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.335745
====================================================
  Execution time = 1.4495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3885e-01
  Total weights = 1.952295897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326189947345
                                         uncertainty =       0.002362347890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326189947345
                                         uncertainty =       0.002362347890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403809684
  error estimate for blocks of size 2^( 2) =       0.000416870571
  error estimate for blocks of size 2^( 3) =       0.000429105433
  error estimate for blocks of size 2^( 4) =       0.000441152795
  error estimate for blocks of size 2^( 5) =       0.000451810824
  error estimate for blocks of size 2^( 6) =       0.000460247127
  error estimate for blocks of size 2^( 7) =       0.000463400146

      target function =                  N/A
              le_mean =     -16.906179766758
             les_mean =     286.157768229187
             stat err =       0.000454152723
             autocorr =       1.264883088025
              std dev =       0.571073131383
             le_variance =       0.326124521388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617976676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+42, overlap shift 3.8147e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179766740       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179766740       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179766740       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+42 is 8.770832e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+43, overlap shift 1.5259e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179766740       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179766740       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179766740       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+43 is 2.192708e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+43, overlap shift 6.1035e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179766740       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179766740       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179766740       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.000000000000       residual = 1.79e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+43 is 5.481770e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7094e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.956
    reference variance = 0.433337
====================================================
  Execution time = 1.4221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3736e-01
  Total weights = 1.9513e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386321
  error estimate for blocks of size 2^( 2) =       0.000414309032
  error estimate for blocks of size 2^( 3) =       0.000427866121
  error estimate for blocks of size 2^( 4) =       0.000439633022
  error estimate for blocks of size 2^( 5) =       0.000449600944
  error estimate for blocks of size 2^( 6) =       0.000458259230
  error estimate for blocks of size 2^( 7) =       0.000467755381

      target function =                  N/A
              le_mean =     -16.905284547281
             les_mean =     286.126008024555
             stat err =       0.000453812144
             autocorr =       1.278283230734
              std dev =       0.567645978881
             le_variance =       0.322221957340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386321
  error estimate for blocks of size 2^( 2) =       0.000414309032
  error estimate for blocks of size 2^( 3) =       0.000427866121
  error estimate for blocks of size 2^( 4) =       0.000439633022
  error estimate for blocks of size 2^( 5) =       0.000449600944
  error estimate for blocks of size 2^( 6) =       0.000458259230
  error estimate for blocks of size 2^( 7) =       0.000467755381

      target function =                  N/A
              le_mean =     -16.905284547281
             les_mean =     286.126008024555
             stat err =       0.000453812144
             autocorr =       1.278283230734
              std dev =       0.567645978881
             le_variance =       0.322221957340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386321
  error estimate for blocks of size 2^( 2) =       0.000414309032
  error estimate for blocks of size 2^( 3) =       0.000427866121
  error estimate for blocks of size 2^( 4) =       0.000439633022
  error estimate for blocks of size 2^( 5) =       0.000449600944
  error estimate for blocks of size 2^( 6) =       0.000458259230
  error estimate for blocks of size 2^( 7) =       0.000467755381

      target function =                  N/A
              le_mean =     -16.905284547281
             les_mean =     286.126008024555
             stat err =       0.000453812144
             autocorr =       1.278283230734
              std dev =       0.567645978881
             le_variance =       0.322221957340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262155451
                                         uncertainty =       0.002351625842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401386321
  error estimate for blocks of size 2^( 2) =       0.000414309032
  error estimate for blocks of size 2^( 3) =       0.000427866121
  error estimate for blocks of size 2^( 4) =       0.000439633022
  error estimate for blocks of size 2^( 5) =       0.000449600944
  error estimate for blocks of size 2^( 6) =       0.000458259230
  error estimate for blocks of size 2^( 7) =       0.000467755381

      target function =                  N/A
              le_mean =     -16.905284547281
             les_mean =     286.126008024555
             stat err =       0.000453812144
             autocorr =       1.278283230734
              std dev =       0.567645978881
             le_variance =       0.322221957340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905284547281        initial  <--
     3.8147e+42     3.8147e+43             8.7708e-47       -16.905284547281
     1.5259e+43     1.5259e+44             2.1927e-47       -16.905284547281
     6.1035e+43     6.1035e+44             5.4818e-48       -16.905284547281

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7415
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9567
    reference variance = 0.280243
====================================================
  Execution time = 1.4535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3897e-01
  Total weights = 1.951475232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323792731993
                                         uncertainty =       0.002374754971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323792731993
                                         uncertainty =       0.002374754971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402488854
  error estimate for blocks of size 2^( 2) =       0.000415283306
  error estimate for blocks of size 2^( 3) =       0.000428285338
  error estimate for blocks of size 2^( 4) =       0.000440858825
  error estimate for blocks of size 2^( 5) =       0.000451895910
  error estimate for blocks of size 2^( 6) =       0.000461530100
  error estimate for blocks of size 2^( 7) =       0.000466684364

      target function =                  N/A
              le_mean =     -16.906368214369
             les_mean =     286.164251735191
             stat err =       0.000455242300
             autocorr =       1.279315024504
              std dev =       0.569205196513
             le_variance =       0.323994555737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636821437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+43, overlap shift 3.8147e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906368214376       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906368214376       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368214376       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+43 is 1.096888e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+44, overlap shift 1.5259e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906368214376       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906368214376       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368214376       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+44 is 2.742219e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+44, overlap shift 6.1035e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906368214376       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906368214376       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368214376       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+44 is 6.855547e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7127e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9433
    reference variance = 0.339469
====================================================
  Execution time = 1.4113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3567e-01
  Total weights = 1.9517e+06
  Execution time = 1.8862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402398174
  error estimate for blocks of size 2^( 2) =       0.000415325798
  error estimate for blocks of size 2^( 3) =       0.000428581034
  error estimate for blocks of size 2^( 4) =       0.000441058774
  error estimate for blocks of size 2^( 5) =       0.000453294197
  error estimate for blocks of size 2^( 6) =       0.000461452237
  error estimate for blocks of size 2^( 7) =       0.000468178930

      target function =                  N/A
              le_mean =     -16.906079416125
             les_mean =     286.151193755103
             stat err =       0.000455996034
             autocorr =       1.284133358572
              std dev =       0.569076955713
             le_variance =       0.323848581523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402398174
  error estimate for blocks of size 2^( 2) =       0.000415325798
  error estimate for blocks of size 2^( 3) =       0.000428581034
  error estimate for blocks of size 2^( 4) =       0.000441058774
  error estimate for blocks of size 2^( 5) =       0.000453294197
  error estimate for blocks of size 2^( 6) =       0.000461452237
  error estimate for blocks of size 2^( 7) =       0.000468178930

      target function =                  N/A
              le_mean =     -16.906079416125
             les_mean =     286.151193755103
             stat err =       0.000455996034
             autocorr =       1.284133358572
              std dev =       0.569076955713
             le_variance =       0.323848581523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402398174
  error estimate for blocks of size 2^( 2) =       0.000415325798
  error estimate for blocks of size 2^( 3) =       0.000428581034
  error estimate for blocks of size 2^( 4) =       0.000441058774
  error estimate for blocks of size 2^( 5) =       0.000453294197
  error estimate for blocks of size 2^( 6) =       0.000461452237
  error estimate for blocks of size 2^( 7) =       0.000468178930

      target function =                  N/A
              le_mean =     -16.906079416125
             les_mean =     286.151193755103
             stat err =       0.000455996034
             autocorr =       1.284133358572
              std dev =       0.569076955713
             le_variance =       0.323848581523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908513436
                                         uncertainty =       0.004617437864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402398174
  error estimate for blocks of size 2^( 2) =       0.000415325798
  error estimate for blocks of size 2^( 3) =       0.000428581034
  error estimate for blocks of size 2^( 4) =       0.000441058774
  error estimate for blocks of size 2^( 5) =       0.000453294197
  error estimate for blocks of size 2^( 6) =       0.000461452237
  error estimate for blocks of size 2^( 7) =       0.000468178930

      target function =                  N/A
              le_mean =     -16.906079416125
             les_mean =     286.151193755103
             stat err =       0.000455996034
             autocorr =       1.284133358572
              std dev =       0.569076955713
             le_variance =       0.323848581523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906079416125        initial  <--
     3.8147e+43     3.8147e+44             1.0969e-47       -16.906079416125
     1.5259e+44     1.5259e+45             2.7422e-48       -16.906079416125
     6.1035e+44     6.1035e+45             6.8555e-49       -16.906079416125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5950
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9752
    reference variance = 0.903865
====================================================
  Execution time = 1.4532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3572e-01
  Total weights = 1.951514187e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324791189085
                                         uncertainty =       0.002713418297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324791189085
                                         uncertainty =       0.002713418297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402971957
  error estimate for blocks of size 2^( 2) =       0.000416116644
  error estimate for blocks of size 2^( 3) =       0.000429234109
  error estimate for blocks of size 2^( 4) =       0.000441234645
  error estimate for blocks of size 2^( 5) =       0.000452802591
  error estimate for blocks of size 2^( 6) =       0.000462034775
  error estimate for blocks of size 2^( 7) =       0.000466012563

      target function =                  N/A
              le_mean =     -16.905744043765
             les_mean =     286.139898277861
             stat err =       0.000455521144
             autocorr =       1.277813378251
              std dev =       0.569888407373
             le_variance =       0.324772796858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574404377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+44, overlap shift 3.8147e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744043768       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744043768       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+45, overlap shift 1.5259e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744043768       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744043768       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+45, overlap shift 6.1035e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905744043768       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744043768       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7123e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.8679
    reference variance = 0.140555
====================================================
  Execution time = 1.4181e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3400e-01
  Total weights = 1.9518e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484185
  error estimate for blocks of size 2^( 2) =       0.000414319885
  error estimate for blocks of size 2^( 3) =       0.000427262809
  error estimate for blocks of size 2^( 4) =       0.000439395300
  error estimate for blocks of size 2^( 5) =       0.000450803208
  error estimate for blocks of size 2^( 6) =       0.000458626852
  error estimate for blocks of size 2^( 7) =       0.000463783276

      target function =                  N/A
              le_mean =     -16.906521896887
             les_mean =     286.164481779825
             stat err =       0.000453152159
             autocorr =       1.273946595517
              std dev =       0.567784379347
             le_variance =       0.322379101430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484185
  error estimate for blocks of size 2^( 2) =       0.000414319885
  error estimate for blocks of size 2^( 3) =       0.000427262809
  error estimate for blocks of size 2^( 4) =       0.000439395300
  error estimate for blocks of size 2^( 5) =       0.000450803208
  error estimate for blocks of size 2^( 6) =       0.000458626852
  error estimate for blocks of size 2^( 7) =       0.000463783276

      target function =                  N/A
              le_mean =     -16.906521896887
             les_mean =     286.164481779825
             stat err =       0.000453152159
             autocorr =       1.273946595517
              std dev =       0.567784379347
             le_variance =       0.322379101430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484185
  error estimate for blocks of size 2^( 2) =       0.000414319885
  error estimate for blocks of size 2^( 3) =       0.000427262809
  error estimate for blocks of size 2^( 4) =       0.000439395300
  error estimate for blocks of size 2^( 5) =       0.000450803208
  error estimate for blocks of size 2^( 6) =       0.000458626852
  error estimate for blocks of size 2^( 7) =       0.000463783276

      target function =                  N/A
              le_mean =     -16.906521896887
             les_mean =     286.164481779825
             stat err =       0.000453152159
             autocorr =       1.273946595517
              std dev =       0.567784379347
             le_variance =       0.322379101430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322510037450
                                         uncertainty =       0.003003921769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484185
  error estimate for blocks of size 2^( 2) =       0.000414319885
  error estimate for blocks of size 2^( 3) =       0.000427262809
  error estimate for blocks of size 2^( 4) =       0.000439395300
  error estimate for blocks of size 2^( 5) =       0.000450803208
  error estimate for blocks of size 2^( 6) =       0.000458626852
  error estimate for blocks of size 2^( 7) =       0.000463783276

      target function =                  N/A
              le_mean =     -16.906521896887
             les_mean =     286.164481779825
             stat err =       0.000453152159
             autocorr =       1.273946595517
              std dev =       0.567784379347
             le_variance =       0.322379101430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906521896887        initial  <--
     3.8147e+44     3.8147e+45             0.0000e+00       -16.906521896887
     1.5259e+45     1.5259e+46             0.0000e+00       -16.906521896887
     6.1035e+45     6.1035e+46             0.0000e+00       -16.906521896887

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6837
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9638
    reference variance = 0.302013
====================================================
  Execution time = 1.4815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3960e-01
  Total weights = 1.951984618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327453768176
                                         uncertainty =       0.002601393094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327453768176
                                         uncertainty =       0.002601393094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404711506
  error estimate for blocks of size 2^( 2) =       0.000417064531
  error estimate for blocks of size 2^( 3) =       0.000430289004
  error estimate for blocks of size 2^( 4) =       0.000442065285
  error estimate for blocks of size 2^( 5) =       0.000452609454
  error estimate for blocks of size 2^( 6) =       0.000460104078
  error estimate for blocks of size 2^( 7) =       0.000464840531

      target function =                  N/A
              le_mean =     -16.906581048258
             les_mean =     286.172087092162
             stat err =       0.000454904837
             autocorr =       1.263426573336
              std dev =       0.572348500058
             le_variance =       0.327582805519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658104826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+45, overlap shift 3.8147e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906581048264       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906581048264       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906581048264       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906581048264       residual = 1.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+45 is 1.053070e-49

solving harmonic davidson linear method for identity shift 1.5259e+46, overlap shift 1.5259e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906581048264       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906581048264       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906581048264       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906581048264       residual = 1.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+46 is 2.632674e-50

solving harmonic davidson linear method for identity shift 6.1035e+46, overlap shift 6.1035e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906581048264       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906581048264       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906581048264       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906581048264       residual = 1.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+46 is 6.581684e-51

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7419e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9745
    reference variance = 0.225077
====================================================
  Execution time = 1.4058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4555e-01
  Total weights = 1.9518e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405844844
  error estimate for blocks of size 2^( 2) =       0.000418641145
  error estimate for blocks of size 2^( 3) =       0.000431805140
  error estimate for blocks of size 2^( 4) =       0.000443768027
  error estimate for blocks of size 2^( 5) =       0.000455063983
  error estimate for blocks of size 2^( 6) =       0.000465248521
  error estimate for blocks of size 2^( 7) =       0.000469823681

      target function =                  N/A
              le_mean =     -16.906909882580
             les_mean =     286.189155776212
             stat err =       0.000458476053
             autocorr =       1.276183857766
              std dev =       0.573951283145
             le_variance =       0.329420075424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405844844
  error estimate for blocks of size 2^( 2) =       0.000418641145
  error estimate for blocks of size 2^( 3) =       0.000431805140
  error estimate for blocks of size 2^( 4) =       0.000443768027
  error estimate for blocks of size 2^( 5) =       0.000455063983
  error estimate for blocks of size 2^( 6) =       0.000465248521
  error estimate for blocks of size 2^( 7) =       0.000469823681

      target function =                  N/A
              le_mean =     -16.906909882580
             les_mean =     286.189155776212
             stat err =       0.000458476053
             autocorr =       1.276183857766
              std dev =       0.573951283145
             le_variance =       0.329420075424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405844844
  error estimate for blocks of size 2^( 2) =       0.000418641145
  error estimate for blocks of size 2^( 3) =       0.000431805140
  error estimate for blocks of size 2^( 4) =       0.000443768027
  error estimate for blocks of size 2^( 5) =       0.000455063983
  error estimate for blocks of size 2^( 6) =       0.000465248521
  error estimate for blocks of size 2^( 7) =       0.000469823681

      target function =                  N/A
              le_mean =     -16.906909882580
             les_mean =     286.189155776212
             stat err =       0.000458476053
             autocorr =       1.276183857766
              std dev =       0.573951283145
             le_variance =       0.329420075424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329433251196
                                         uncertainty =       0.006012455031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405844844
  error estimate for blocks of size 2^( 2) =       0.000418641145
  error estimate for blocks of size 2^( 3) =       0.000431805140
  error estimate for blocks of size 2^( 4) =       0.000443768027
  error estimate for blocks of size 2^( 5) =       0.000455063983
  error estimate for blocks of size 2^( 6) =       0.000465248521
  error estimate for blocks of size 2^( 7) =       0.000469823681

      target function =                  N/A
              le_mean =     -16.906909882580
             les_mean =     286.189155776212
             stat err =       0.000458476053
             autocorr =       1.276183857766
              std dev =       0.573951283145
             le_variance =       0.329420075424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906909882580        initial  <--
     3.8147e+45     3.8147e+46             1.0531e-49       -16.906909882580
     1.5259e+46     1.5259e+47             2.6327e-50       -16.906909882580
     6.1035e+46     6.1035e+47             6.5817e-51       -16.906909882580

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5126
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.011549e-01 3 1  ON 0
ci_0002                 7.005070e-01 3 1  ON 1
ci_0003                -2.801932e-02 3 1  ON 2
ci_0004                -2.824534e-02 3 1  ON 3
ci_0005                -3.394627e-02 3 1  ON 4
ci_0006                -3.440069e-02 3 1  ON 5
ci_0007                -2.237545e-02 3 1  ON 6
ci_0008                -2.248322e-02 3 1  ON 7
ci_0009                -1.779299e-02 3 1  ON 8
ci_0010                -1.792955e-02 3 1  ON 9
ci_0011                -1.242636e-02 3 1  ON 10
ci_0012                -1.269228e-02 3 1  ON 11
ci_0013                 1.336654e-02 3 1  ON 12
ci_0014                 1.349899e-02 3 1  ON 13
ci_0015                 1.365005e-02 3 1  ON 14
ci_0016                 1.308714e-02 3 1  ON 15
ci_0017                 1.160040e-02 3 1  ON 16
ci_0018                 1.175182e-02 3 1  ON 17
ci_0019                 1.188114e-02 3 1  ON 18
ci_0020                 1.194783e-02 3 1  ON 19
ci_0021                 1.939798e-03 3 1  ON 20
ci_0022                 3.070323e-03 3 1  ON 21
ci_0023                -1.177445e-02 3 1  ON 22
ci_0024                -1.107988e-02 3 1  ON 23
ci_0025                -1.134723e-02 3 1  ON 24
ci_0026                -1.125957e-02 3 1  ON 25
ci_0027                -1.120258e-02 3 1  ON 26
ci_0028                -1.102680e-02 3 1  ON 27
ci_0029                -1.080404e-02 3 1  ON 28
ci_0030                -1.022842e-02 3 1  ON 29
ci_0031                 1.933915e-02 3 1  ON 30
ci_0032                 1.976911e-02 3 1  ON 31
ci_0033                 9.369270e-03 3 1  ON 32
ci_0034                 1.000582e-02 3 1  ON 33
ci_0035                 7.396492e-03 3 1  ON 34
ci_0036                 6.855815e-03 3 1  ON 35
ci_0037                -1.089262e-02 3 1  ON 36
ci_0038                -1.066133e-02 3 1  ON 37
ci_0039                -2.823092e-03 3 1  ON 38
ci_0040                -2.964582e-03 3 1  ON 39
ci_0041                 7.306797e-03 3 1  ON 40
ci_0042                 7.397890e-03 3 1  ON 41
ci_0043                -1.504588e-02 3 1  ON 42
ci_0044                -1.572345e-02 3 1  ON 43
ci_0045                 8.067935e-03 3 1  ON 44
ci_0046                 7.491045e-03 3 1  ON 45
ci_0047                -2.192031e-03 3 1  ON 46
ci_0048                -2.226520e-03 3 1  ON 47
ci_0049                -5.375667e-03 3 1  ON 48
ci_0050                -5.414143e-03 3 1  ON 49
ci_0051                -3.523131e-03 3 1  ON 50
ci_0052                -3.135816e-03 3 1  ON 51
ci_0053                -5.126354e-03 3 1  ON 52
ci_0054                -4.939165e-03 3 1  ON 53
ci_0055                 5.929980e-03 3 1  ON 54
ci_0056                 6.353357e-03 3 1  ON 55
ci_0057                 4.661770e-03 3 1  ON 56
ci_0058                 5.180571e-03 3 1  ON 57
ci_0059                -5.145255e-03 3 1  ON 58
ci_0060                -4.987388e-03 3 1  ON 59
ci_0061                -3.814602e-03 3 1  ON 60
ci_0062                -3.100875e-03 3 1  ON 61
ci_0063                -8.644144e-03 3 1  ON 62
ci_0064                -9.216654e-03 3 1  ON 63
ci_0065                -5.727906e-03 3 1  ON 64
ci_0066                -5.048387e-03 3 1  ON 65
ci_0067                -5.382932e-03 3 1  ON 66
ci_0068                -5.456825e-03 3 1  ON 67
ci_0069                 4.997717e-03 3 1  ON 68
ci_0070                 4.770086e-03 3 1  ON 69
ci_0071                 2.243369e-03 3 1  ON 70
ci_0072                 1.743279e-03 3 1  ON 71
ci_0073                 4.313251e-03 3 1  ON 72
ci_0074                 4.192382e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0937e+01 secs
  Total Execution time = 2.4699e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
