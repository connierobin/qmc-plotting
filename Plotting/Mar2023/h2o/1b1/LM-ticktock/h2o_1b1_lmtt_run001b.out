Rank =    0  Free Memory = 85574 MB
Rank =    1  Free Memory = 85574 MB
Rank =    2  Free Memory = 85574 MB
Rank =    3  Free Memory = 85574 MB
Rank =    4  Free Memory = 85573 MB
Rank =    5  Free Memory = 85573 MB
Rank =    6  Free Memory = 85572 MB
Rank =    7  Free Memory = 85572 MB
Rank =    8  Free Memory = 85572 MB
Rank =    9  Free Memory = 85572 MB
Rank =   10  Free Memory = 85572 MB
Rank =   11  Free Memory = 85572 MB
Rank =   12  Free Memory = 85572 MB
Rank =   13  Free Memory = 85572 MB
Rank =   14  Free Memory = 85572 MB
Rank =   15  Free Memory = 85559 MB
Rank =   16  Free Memory = 85559 MB
Rank =   17  Free Memory = 85559 MB
Rank =   18  Free Memory = 85559 MB
Rank =   19  Free Memory = 85559 MB
Rank =   20  Free Memory = 85559 MB
Rank =   21  Free Memory = 85559 MB
Rank =   22  Free Memory = 85559 MB
Rank =   23  Free Memory = 85559 MB
Rank =   24  Free Memory = 85559 MB
Rank =   25  Free Memory = 85558 MB
Rank =   26  Free Memory = 85558 MB
Rank =   27  Free Memory = 85558 MB
Rank =   28  Free Memory = 85558 MB
Rank =   29  Free Memory = 85558 MB
Rank =   30  Free Memory = 85558 MB
Rank =   31  Free Memory = 85558 MB
Rank =   32  Free Memory = 75744 MB
Rank =   33  Free Memory = 75744 MB
Rank =   34  Free Memory = 75743 MB
Rank =   35  Free Memory = 75743 MB
Rank =   36  Free Memory = 75743 MB
Rank =   37  Free Memory = 75743 MB
Rank =   38  Free Memory = 75743 MB
Rank =   39  Free Memory = 75743 MB
Rank =   40  Free Memory = 75743 MB
Rank =   41  Free Memory = 75743 MB
Rank =   42  Free Memory = 75743 MB
Rank =   43  Free Memory = 75743 MB
Rank =   44  Free Memory = 75743 MB
Rank =   45  Free Memory = 75743 MB
Rank =   46  Free Memory = 75743 MB
Rank =   47  Free Memory = 75743 MB
Rank =   48  Free Memory = 75743 MB
Rank =   49  Free Memory = 75743 MB
Rank =   50  Free Memory = 75743 MB
Rank =   51  Free Memory = 75743 MB
Rank =   52  Free Memory = 75743 MB
Rank =   53  Free Memory = 75742 MB
Rank =   54  Free Memory = 75742 MB
Rank =   55  Free Memory = 75742 MB
Rank =   56  Free Memory = 75742 MB
Rank =   57  Free Memory = 75742 MB
Rank =   58  Free Memory = 75742 MB
Rank =   59  Free Memory = 75742 MB
Rank =   60  Free Memory = 75742 MB
Rank =   61  Free Memory = 75741 MB
Rank =   62  Free Memory = 75741 MB
Rank =   63  Free Memory = 75741 MB
Rank =   64  Free Memory = 87350 MB
Rank =   65  Free Memory = 87350 MB
Rank =   66  Free Memory = 87349 MB
Rank =   67  Free Memory = 87349 MB
Rank =   68  Free Memory = 87349 MB
Rank =   69  Free Memory = 87348 MB
Rank =   70  Free Memory = 87348 MB
Rank =   71  Free Memory = 87348 MB
Rank =   72  Free Memory = 87348 MB
Rank =   73  Free Memory = 87348 MB
Rank =   74  Free Memory = 87348 MB
Rank =   75  Free Memory = 87348 MB
Rank =   76  Free Memory = 87348 MB
Rank =   77  Free Memory = 87348 MB
Rank =   78  Free Memory = 87348 MB
Rank =   79  Free Memory = 87348 MB
Rank =   80  Free Memory = 87348 MB
Rank =   81  Free Memory = 87348 MB
Rank =   82  Free Memory = 87348 MB
Rank =   83  Free Memory = 87348 MB
Rank =   84  Free Memory = 87348 MB
Rank =   85  Free Memory = 87348 MB
Rank =   86  Free Memory = 87348 MB
Rank =   87  Free Memory = 87348 MB
Rank =   88  Free Memory = 87348 MB
Rank =   89  Free Memory = 87348 MB
Rank =   90  Free Memory = 87348 MB
Rank =   91  Free Memory = 87348 MB
Rank =   92  Free Memory = 87348 MB
Rank =   93  Free Memory = 87348 MB
Rank =   94  Free Memory = 87348 MB
Rank =   95  Free Memory = 87348 MB
Rank =   96  Free Memory = 88262 MB
Rank =   97  Free Memory = 88262 MB
Rank =   98  Free Memory = 88262 MB
Rank =   99  Free Memory = 88262 MB
Rank =  100  Free Memory = 88262 MB
Rank =  101  Free Memory = 88262 MB
Rank =  102  Free Memory = 88262 MB
Rank =  103  Free Memory = 88262 MB
Rank =  104  Free Memory = 88262 MB
Rank =  105  Free Memory = 88262 MB
Rank =  106  Free Memory = 88262 MB
Rank =  107  Free Memory = 88262 MB
Rank =  108  Free Memory = 88262 MB
Rank =  109  Free Memory = 88262 MB
Rank =  110  Free Memory = 88262 MB
Rank =  111  Free Memory = 88262 MB
Rank =  112  Free Memory = 88262 MB
Rank =  113  Free Memory = 88262 MB
Rank =  114  Free Memory = 88262 MB
Rank =  115  Free Memory = 88262 MB
Rank =  116  Free Memory = 88262 MB
Rank =  117  Free Memory = 88262 MB
Rank =  118  Free Memory = 88262 MB
Rank =  119  Free Memory = 88262 MB
Rank =  120  Free Memory = 88262 MB
Rank =  121  Free Memory = 88262 MB
Rank =  122  Free Memory = 88262 MB
Rank =  123  Free Memory = 88262 MB
Rank =  124  Free Memory = 88262 MB
Rank =  125  Free Memory = 88262 MB
Rank =  126  Free Memory = 88262 MB
Rank =  127  Free Memory = 88262 MB
  Input file(s): opt_h2o_1b1_lmtt_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmtt_run001b.xml

  Project = H2O
  date    = 2023-03-02 16:14:02 PST
  host    = n0089.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 970

  Range of prime numbers to use as seeds over processors and threads = 7669-8831


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.930414e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3323e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9409
    reference variance = 0.368366
====================================================
  Execution time = 2.1227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324697804594
                                         uncertainty =       0.003332811224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324697804594
                                         uncertainty =       0.003332811224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402897379
  error estimate for blocks of size 2^( 2) =       0.000416917066
  error estimate for blocks of size 2^( 3) =       0.000431164031
  error estimate for blocks of size 2^( 4) =       0.000444610017
  error estimate for blocks of size 2^( 5) =       0.000455978094
  error estimate for blocks of size 2^( 6) =       0.000463147194
  error estimate for blocks of size 2^( 7) =       0.000468417841

      target function =                  N/A
              le_mean =     -16.903759342696
             les_mean =     286.061732349802
             stat err =       0.000458038286
             autocorr =       1.292452758057
              std dev =       0.569782937925
             le_variance =       0.324652596351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690375934270e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903759342696       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904012999804       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904148472410       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904201748666       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904289413238       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904317709665       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904326646367       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904325739807       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904325055540       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904326555621       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904325913833       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904325565451       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904325906475       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.049185e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903759342696       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903859966186       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903923678233       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903941539968       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903971001454       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903980846339       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903985437170       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903984777069       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903984330544       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903984441585       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903984441334       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.600936e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903759342696       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903788822713       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903809428258       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903814769659       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903821666411       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903825225558       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903826572736       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903826494221       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903826381024       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903826392081       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903826382601       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.007124e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6864e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.028437e-01                 1 1 ON  0
uu_1  1.395432e-01                 1 1 ON  1
uu_2  4.128571e-02                 1 1 ON  2
uu_3  -1.926035e-02                1 1 ON  3
uu_4  -6.300734e-02                1 1 ON  4
uu_5  -9.590971e-02                1 1 ON  5
uu_6  -1.207780e-01                1 1 ON  6
uu_7  -1.312533e-01                1 1 ON  7
uu_8  -1.204382e-01                1 1 ON  8
uu_9  -9.277187e-02                1 1 ON  9
ud_0  4.148396e-01                 1 1 ON  10
ud_1  1.607795e-01                 1 1 ON  11
ud_2  5.916921e-02                 1 1 ON  12
ud_3  5.251870e-04                 1 1 ON  13
ud_4  -5.753490e-02                1 1 ON  14
ud_5  -1.016232e-01                1 1 ON  15
ud_6  -1.290640e-01                1 1 ON  16
ud_7  -1.438654e-01                1 1 ON  17
ud_8  -1.428322e-01                1 1 ON  18
ud_9  -1.346214e-01                1 1 ON  19
eO_0  -7.079109e-01                1 1 ON  20
eO_1  -4.141470e-01                1 1 ON  21
eO_2  -2.914773e-02                1 1 ON  22
eO_3  2.711675e-01                 1 1 ON  23
eO_4  4.919761e-01                 1 1 ON  24
eO_5  4.591173e-01                 1 1 ON  25
eO_6  2.358637e-01                 1 1 ON  26
eO_7  -5.588485e-02                1 1 ON  27
eO_8  -1.961041e-01                1 1 ON  28
eO_9  -5.783086e-02                1 1 ON  29
eH1_0 -2.113482e-01                1 1 ON  30
eH1_1 -1.276651e-01                1 1 ON  31
eH1_2 -8.804363e-02                1 1 ON  32
eH1_3 -3.696714e-02                1 1 ON  33
eH1_4 1.187076e-02                 1 1 ON  34
eH1_5 4.481900e-02                 1 1 ON  35
eH1_6 9.475169e-02                 1 1 ON  36
eH1_7 1.382707e-01                 1 1 ON  37
eH1_8 1.459380e-01                 1 1 ON  38
eH1_9 3.300081e-02                 1 1 ON  39
eH2_0 -2.102342e-01                1 1 ON  40
eH2_1 -1.266092e-01                1 1 ON  41
eH2_2 -8.704609e-02                1 1 ON  42
eH2_3 -3.590418e-02                1 1 ON  43
eH2_4 1.327678e-02                 1 1 ON  44
eH2_5 4.815863e-02                 1 1 ON  45
eH2_6 1.004989e-01                 1 1 ON  46
eH2_7 1.494929e-01                 1 1 ON  47
eH2_8 1.538188e-01                 1 1 ON  48
eH2_9 1.308582e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8548
    reference variance = 0.278253
====================================================
  Execution time = 2.0640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2055e-01
  Total weights = 2.0000e+06
  Execution time = 1.9305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319623632894
                                         uncertainty =       0.002197353149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319623632894
                                         uncertainty =       0.002197353149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399810578
  error estimate for blocks of size 2^( 2) =       0.000413367894
  error estimate for blocks of size 2^( 3) =       0.000427440212
  error estimate for blocks of size 2^( 4) =       0.000439928320
  error estimate for blocks of size 2^( 5) =       0.000449968928
  error estimate for blocks of size 2^( 6) =       0.000459442047
  error estimate for blocks of size 2^( 7) =       0.000465830883

      target function =                  N/A
              le_mean =     -16.905282581758
             les_mean =     286.108276005831
             stat err =       0.000453792544
             autocorr =       1.288267800299
              std dev =       0.565417541809
             le_variance =       0.319696996585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323066869554
                                         uncertainty =       0.002257806981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323066869554
                                         uncertainty =       0.002257806981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401953783
  error estimate for blocks of size 2^( 2) =       0.000414804367
  error estimate for blocks of size 2^( 3) =       0.000428306740
  error estimate for blocks of size 2^( 4) =       0.000440422945
  error estimate for blocks of size 2^( 5) =       0.000450017994
  error estimate for blocks of size 2^( 6) =       0.000459349268
  error estimate for blocks of size 2^( 7) =       0.000465740097

      target function =                  N/A
              le_mean =     -16.905369143442
             les_mean =     286.114639401194
             stat err =       0.000453882576
             autocorr =       1.275072215355
              std dev =       0.568448490821
             le_variance =       0.323133686716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321945912030
                                         uncertainty =       0.002244767407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321945912030
                                         uncertainty =       0.002244767407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401256923
  error estimate for blocks of size 2^( 2) =       0.000414235553
  error estimate for blocks of size 2^( 3) =       0.000427845108
  error estimate for blocks of size 2^( 4) =       0.000440031593
  error estimate for blocks of size 2^( 5) =       0.000449691771
  error estimate for blocks of size 2^( 6) =       0.000459056997
  error estimate for blocks of size 2^( 7) =       0.000465417840

      target function =                  N/A
              le_mean =     -16.905317624102
             les_mean =     286.111778047658
             stat err =       0.000453549550
             autocorr =       1.277627949191
              std dev =       0.567462982826
             le_variance =       0.322014236877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319774437463
                                         uncertainty =       0.002204086753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319774437463
                                         uncertainty =       0.002204086753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399904399
  error estimate for blocks of size 2^( 2) =       0.000413365457
  error estimate for blocks of size 2^( 3) =       0.000427362491
  error estimate for blocks of size 2^( 4) =       0.000439802885
  error estimate for blocks of size 2^( 5) =       0.000449783918
  error estimate for blocks of size 2^( 6) =       0.000459243518
  error estimate for blocks of size 2^( 7) =       0.000465625540

      target function =                  N/A
              le_mean =     -16.905262107828
             les_mean =     286.107733831230
             stat err =       0.000453613965
             autocorr =       1.286650136081
              std dev =       0.565550224830
             le_variance =       0.319847056805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905282581758        initial
     2.5000e-01     2.5000e+00             1.0492e-02       -16.905369143442  <--
     1.0000e+00     1.0000e+01             3.6009e-03       -16.905317624102
     4.0000e+00     4.0000e+01             1.0071e-03       -16.905262107828

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0316e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.034213e-01 1 1  ON 0
 uu_1                 1.396148e-01 1 1  ON 1
 uu_2                 4.088342e-02 1 1  ON 2
 uu_3                -1.923643e-02 1 1  ON 3
 uu_4                -6.269429e-02 1 1  ON 4
 uu_5                -9.584882e-02 1 1  ON 5
 uu_6                -1.211308e-01 1 1  ON 6
 uu_7                -1.317664e-01 1 1  ON 7
 uu_8                -1.207958e-01 1 1  ON 8
 uu_9                -9.277714e-02 1 1  ON 9
 ud_0                 4.208641e-01 1 1  ON 10
 ud_1                 1.641760e-01 1 1  ON 11
 ud_2                 5.762411e-02 1 1  ON 12
 ud_3                -3.030468e-03 1 1  ON 13
 ud_4                -5.904985e-02 1 1  ON 14
 ud_5                -1.019676e-01 1 1  ON 15
 ud_6                -1.295223e-01 1 1  ON 16
 ud_7                -1.444435e-01 1 1  ON 17
 ud_8                -1.437084e-01 1 1  ON 18
 ud_9                -1.350141e-01 1 1  ON 19
 eO_0                -7.148019e-01 1 1  ON 20
 eO_1                -4.153961e-01 1 1  ON 21
 eO_2                -2.493427e-02 1 1  ON 22
 eO_3                 2.752326e-01 1 1  ON 23
 eO_4                 4.936336e-01 1 1  ON 24
 eO_5                 4.585284e-01 1 1  ON 25
 eO_6                 2.354741e-01 1 1  ON 26
 eO_7                -5.574741e-02 1 1  ON 27
 eO_8                -1.965860e-01 1 1  ON 28
 eO_9                -5.824076e-02 1 1  ON 29
eH1_0                -2.147321e-01 1 1  ON 30
eH1_1                -1.282458e-01 1 1  ON 31
eH1_2                -8.732021e-02 1 1  ON 32
eH1_3                -3.616999e-02 1 1  ON 33
eH1_4                 1.235984e-02 1 1  ON 34
eH1_5                 4.510076e-02 1 1  ON 35
eH1_6                 9.491089e-02 1 1  ON 36
eH1_7                 1.386103e-01 1 1  ON 37
eH1_8                 1.466796e-01 1 1  ON 38
eH1_9                 3.350374e-02 1 1  ON 39
eH2_0                -2.135611e-01 1 1  ON 40
eH2_1                -1.269287e-01 1 1  ON 41
eH2_2                -8.618119e-02 1 1  ON 42
eH2_3                -3.488593e-02 1 1  ON 43
eH2_4                 1.404730e-02 1 1  ON 44
eH2_5                 4.875262e-02 1 1  ON 45
eH2_6                 1.003993e-01 1 1  ON 46
eH2_7                 1.492578e-01 1 1  ON 47
eH2_8                 1.540480e-01 1 1  ON 48
eH2_9                 1.357441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7187e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9041
    reference variance = 0.238091
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326851560491
                                         uncertainty =       0.004578475228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326851560491
                                         uncertainty =       0.004578475228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404268592
  error estimate for blocks of size 2^( 2) =       0.000417667561
  error estimate for blocks of size 2^( 3) =       0.000431426946
  error estimate for blocks of size 2^( 4) =       0.000444137356
  error estimate for blocks of size 2^( 5) =       0.000454543309
  error estimate for blocks of size 2^( 6) =       0.000461251920
  error estimate for blocks of size 2^( 7) =       0.000466838020

      target function =                  N/A
              le_mean =     -16.905425860669
             les_mean =     286.120289556614
             stat err =       0.000456692651
             autocorr =       1.276168563278
              std dev =       0.571722126093
             le_variance =       0.326866189465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690542586067e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905425860669       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905486563237       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905550283340       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905652851934       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905662855670       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905676155637       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905676555750       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905691700793       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905693431125       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905696571312       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905695506854       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905693829609       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905696156667       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905697939299       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905697166931       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905696980413       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905697137986       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.527554e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905425860669       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905461913347       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905503857541       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542512535       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566496915       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566539048       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568721901       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905570712542       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905572078255       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905571190591       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905571384185       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905571055915       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905571192443       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.843136e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905425860669       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905439598570       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905457457228       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905463449764       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905479069594       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905479669047       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905479161997       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905480055789       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905480038877       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905479828332       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905479763917       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.294474e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6002e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.038530e-01 1 1  ON 0
 uu_1                 1.395744e-01 1 1  ON 1
 uu_2                 4.051899e-02 1 1  ON 2
 uu_3                -1.946938e-02 1 1  ON 3
 uu_4                -6.261187e-02 1 1  ON 4
 uu_5                -9.565604e-02 1 1  ON 5
 uu_6                -1.212277e-01 1 1  ON 6
 uu_7                -1.321828e-01 1 1  ON 7
 uu_8                -1.213155e-01 1 1  ON 8
 uu_9                -9.274946e-02 1 1  ON 9
 ud_0                 4.266090e-01 1 1  ON 10
 ud_1                 1.672741e-01 1 1  ON 11
 ud_2                 5.677168e-02 1 1  ON 12
 ud_3                -6.023440e-03 1 1  ON 13
 ud_4                -6.088032e-02 1 1  ON 14
 ud_5                -1.027061e-01 1 1  ON 15
 ud_6                -1.300076e-01 1 1  ON 16
 ud_7                -1.454348e-01 1 1  ON 17
 ud_8                -1.446445e-01 1 1  ON 18
 ud_9                -1.351625e-01 1 1  ON 19
 eO_0                -7.216450e-01 1 1  ON 20
 eO_1                -4.167738e-01 1 1  ON 21
 eO_2                -2.136169e-02 1 1  ON 22
 eO_3                 2.791639e-01 1 1  ON 23
 eO_4                 4.957175e-01 1 1  ON 24
 eO_5                 4.583144e-01 1 1  ON 25
 eO_6                 2.354030e-01 1 1  ON 26
 eO_7                -5.547384e-02 1 1  ON 27
 eO_8                -1.973593e-01 1 1  ON 28
 eO_9                -5.874605e-02 1 1  ON 29
eH1_0                -2.187374e-01 1 1  ON 30
eH1_1                -1.289206e-01 1 1  ON 31
eH1_2                -8.698167e-02 1 1  ON 32
eH1_3                -3.508401e-02 1 1  ON 33
eH1_4                 1.309661e-02 1 1  ON 34
eH1_5                 4.584417e-02 1 1  ON 35
eH1_6                 9.541361e-02 1 1  ON 36
eH1_7                 1.388252e-01 1 1  ON 37
eH1_8                 1.473416e-01 1 1  ON 38
eH1_9                 3.399773e-02 1 1  ON 39
eH2_0                -2.173626e-01 1 1  ON 40
eH2_1                -1.276827e-01 1 1  ON 41
eH2_2                -8.523497e-02 1 1  ON 42
eH2_3                -3.376381e-02 1 1  ON 43
eH2_4                 1.499746e-02 1 1  ON 44
eH2_5                 4.870198e-02 1 1  ON 45
eH2_6                 1.005970e-01 1 1  ON 46
eH2_7                 1.489741e-01 1 1  ON 47
eH2_8                 1.546710e-01 1 1  ON 48
eH2_9                 1.451410e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9734
    reference variance = 0.168037
====================================================
  Execution time = 2.0053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3186e-01
  Total weights = 2.0000e+06
  Execution time = 1.9105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328633137424
                                         uncertainty =       0.006222894159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328633137424
                                         uncertainty =       0.006222894159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405337224
  error estimate for blocks of size 2^( 2) =       0.000418222372
  error estimate for blocks of size 2^( 3) =       0.000431136765
  error estimate for blocks of size 2^( 4) =       0.000443376238
  error estimate for blocks of size 2^( 5) =       0.000454153241
  error estimate for blocks of size 2^( 6) =       0.000460933072
  error estimate for blocks of size 2^( 7) =       0.000464905009

      target function =                  N/A
              le_mean =     -16.906038110858
             les_mean =     286.142720972216
             stat err =       0.000455841890
             autocorr =       1.264723203609
              std dev =       0.573233399883
             le_variance =       0.328596530741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335069278828
                                         uncertainty =       0.006443971674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335069278828
                                         uncertainty =       0.006443971674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409285244
  error estimate for blocks of size 2^( 2) =       0.000421693678
  error estimate for blocks of size 2^( 3) =       0.000434199725
  error estimate for blocks of size 2^( 4) =       0.000446143562
  error estimate for blocks of size 2^( 5) =       0.000456743491
  error estimate for blocks of size 2^( 6) =       0.000463395725
  error estimate for blocks of size 2^( 7) =       0.000467339418

      target function =                  N/A
              le_mean =     -16.906019460896
             les_mean =     286.148522666292
             stat err =       0.000458405549
             autocorr =       1.254433252784
              std dev =       0.578816742672
             le_variance =       0.335028821597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335916421562
                                         uncertainty =       0.006460326668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335916421562
                                         uncertainty =       0.006460326668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409801429
  error estimate for blocks of size 2^( 2) =       0.000422172721
  error estimate for blocks of size 2^( 3) =       0.000434663822
  error estimate for blocks of size 2^( 4) =       0.000446608003
  error estimate for blocks of size 2^( 5) =       0.000457199321
  error estimate for blocks of size 2^( 6) =       0.000463828927
  error estimate for blocks of size 2^( 7) =       0.000467769411

      target function =                  N/A
              le_mean =     -16.906041158044
             les_mean =     286.150101892763
             stat err =       0.000458851416
             autocorr =       1.253710357136
              std dev =       0.579546739473
             le_variance =       0.335874423234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329794587323
                                         uncertainty =       0.006266483512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329794587323
                                         uncertainty =       0.006266483512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406052205
  error estimate for blocks of size 2^( 2) =       0.000418820151
  error estimate for blocks of size 2^( 3) =       0.000431640943
  error estimate for blocks of size 2^( 4) =       0.000443819513
  error estimate for blocks of size 2^( 5) =       0.000454558131
  error estimate for blocks of size 2^( 6) =       0.000461303323
  error estimate for blocks of size 2^( 7) =       0.000465269153

      target function =                  N/A
              le_mean =     -16.905995881637
             les_mean =     286.142453371686
             stat err =       0.000456237530
             autocorr =       1.262461864296
              std dev =       0.574244535579
             le_variance =       0.329756786643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906038110858        initial
     6.2500e-02     6.2500e-01             1.5276e-02       -16.906019460896
     2.5000e-01     2.5000e+00             6.8431e-03       -16.906041158044  <--
     1.0000e+00     1.0000e+01             2.2945e-03       -16.905995881637

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9693e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.038530e-01 1 1  ON 0
 uu_1                 1.395744e-01 1 1  ON 1
 uu_2                 4.051899e-02 1 1  ON 2
 uu_3                -1.946938e-02 1 1  ON 3
 uu_4                -6.261187e-02 1 1  ON 4
 uu_5                -9.565604e-02 1 1  ON 5
 uu_6                -1.212277e-01 1 1  ON 6
 uu_7                -1.321828e-01 1 1  ON 7
 uu_8                -1.213155e-01 1 1  ON 8
 uu_9                -9.274946e-02 1 1  ON 9
 ud_0                 4.266090e-01 1 1  ON 10
 ud_1                 1.672741e-01 1 1  ON 11
 ud_2                 5.677168e-02 1 1  ON 12
 ud_3                -6.023440e-03 1 1  ON 13
 ud_4                -6.088032e-02 1 1  ON 14
 ud_5                -1.027061e-01 1 1  ON 15
 ud_6                -1.300076e-01 1 1  ON 16
 ud_7                -1.454348e-01 1 1  ON 17
 ud_8                -1.446445e-01 1 1  ON 18
 ud_9                -1.351625e-01 1 1  ON 19
 eO_0                -7.216450e-01 1 1  ON 20
 eO_1                -4.167738e-01 1 1  ON 21
 eO_2                -2.136169e-02 1 1  ON 22
 eO_3                 2.791639e-01 1 1  ON 23
 eO_4                 4.957175e-01 1 1  ON 24
 eO_5                 4.583144e-01 1 1  ON 25
 eO_6                 2.354030e-01 1 1  ON 26
 eO_7                -5.547384e-02 1 1  ON 27
 eO_8                -1.973593e-01 1 1  ON 28
 eO_9                -5.874605e-02 1 1  ON 29
eH1_0                -2.187374e-01 1 1  ON 30
eH1_1                -1.289206e-01 1 1  ON 31
eH1_2                -8.698167e-02 1 1  ON 32
eH1_3                -3.508401e-02 1 1  ON 33
eH1_4                 1.309661e-02 1 1  ON 34
eH1_5                 4.584417e-02 1 1  ON 35
eH1_6                 9.541361e-02 1 1  ON 36
eH1_7                 1.388252e-01 1 1  ON 37
eH1_8                 1.473416e-01 1 1  ON 38
eH1_9                 3.399773e-02 1 1  ON 39
eH2_0                -2.173626e-01 1 1  ON 40
eH2_1                -1.276827e-01 1 1  ON 41
eH2_2                -8.523497e-02 1 1  ON 42
eH2_3                -3.376381e-02 1 1  ON 43
eH2_4                 1.499746e-02 1 1  ON 44
eH2_5                 4.870198e-02 1 1  ON 45
eH2_6                 1.005970e-01 1 1  ON 46
eH2_7                 1.489741e-01 1 1  ON 47
eH2_8                 1.546710e-01 1 1  ON 48
eH2_9                 1.451410e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8702
    reference variance = 0.443101
====================================================
  Execution time = 2.0742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326909674621
                                         uncertainty =       0.002529888403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326909674621
                                         uncertainty =       0.002529888403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404271291
  error estimate for blocks of size 2^( 2) =       0.000416505586
  error estimate for blocks of size 2^( 3) =       0.000429598726
  error estimate for blocks of size 2^( 4) =       0.000441792220
  error estimate for blocks of size 2^( 5) =       0.000452142364
  error estimate for blocks of size 2^( 6) =       0.000459639891
  error estimate for blocks of size 2^( 7) =       0.000464849140

      target function =                  N/A
              le_mean =     -16.905966416536
             les_mean =     286.138570867420
             stat err =       0.000454605904
             autocorr =       1.264516031780
              std dev =       0.571725942920
             le_variance =       0.326870553808


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596641654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905966416536       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905991181855       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906032373030       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906054115158       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906051722263       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906070724668       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906077039788       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906084990614       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906088387671       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906086189095       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906088042691       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906087910954       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906088134417       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906087588256       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906088347295       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906088905034       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.013305e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905966416536       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905980655636       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906008330023       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017664748       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906014594679       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906020583921       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906023277545       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025124977       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906025749755       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906025336290       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906025205404       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906025310769       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906025294798       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.371804e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905966416536       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905971689960       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905983576721       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985875920       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984933789       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905985976221       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905986667174       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905986787249       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905986984210       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905987027103       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.420474e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165574 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6254e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.046573e-01 1 1  ON 0
 uu_1                 1.397986e-01 1 1  ON 1
 uu_2                 4.028202e-02 1 1  ON 2
 uu_3                -1.972650e-02 1 1  ON 3
 uu_4                -6.252481e-02 1 1  ON 4
 uu_5                -9.526813e-02 1 1  ON 5
 uu_6                -1.211759e-01 1 1  ON 6
 uu_7                -1.323498e-01 1 1  ON 7
 uu_8                -1.222143e-01 1 1  ON 8
 uu_9                -9.338741e-02 1 1  ON 9
 ud_0                 4.302055e-01 1 1  ON 10
 ud_1                 1.692839e-01 1 1  ON 11
 ud_2                 5.694315e-02 1 1  ON 12
 ud_3                -7.289615e-03 1 1  ON 13
 ud_4                -6.210547e-02 1 1  ON 14
 ud_5                -1.032339e-01 1 1  ON 15
 ud_6                -1.304500e-01 1 1  ON 16
 ud_7                -1.460367e-01 1 1  ON 17
 ud_8                -1.455726e-01 1 1  ON 18
 ud_9                -1.356026e-01 1 1  ON 19
 eO_0                -7.260168e-01 1 1  ON 20
 eO_1                -4.179903e-01 1 1  ON 21
 eO_2                -1.946799e-02 1 1  ON 22
 eO_3                 2.821176e-01 1 1  ON 23
 eO_4                 4.975966e-01 1 1  ON 24
 eO_5                 4.585680e-01 1 1  ON 25
 eO_6                 2.354659e-01 1 1  ON 26
 eO_7                -5.546227e-02 1 1  ON 27
 eO_8                -1.982033e-01 1 1  ON 28
 eO_9                -5.931816e-02 1 1  ON 29
eH1_0                -2.215132e-01 1 1  ON 30
eH1_1                -1.296210e-01 1 1  ON 31
eH1_2                -8.648273e-02 1 1  ON 32
eH1_3                -3.449279e-02 1 1  ON 33
eH1_4                 1.377107e-02 1 1  ON 34
eH1_5                 4.594722e-02 1 1  ON 35
eH1_6                 9.553389e-02 1 1  ON 36
eH1_7                 1.389008e-01 1 1  ON 37
eH1_8                 1.480983e-01 1 1  ON 38
eH1_9                 3.462313e-02 1 1  ON 39
eH2_0                -2.201378e-01 1 1  ON 40
eH2_1                -1.279117e-01 1 1  ON 41
eH2_2                -8.498197e-02 1 1  ON 42
eH2_3                -3.280104e-02 1 1  ON 43
eH2_4                 1.556835e-02 1 1  ON 44
eH2_5                 4.880558e-02 1 1  ON 45
eH2_6                 1.006049e-01 1 1  ON 46
eH2_7                 1.489305e-01 1 1  ON 47
eH2_8                 1.552525e-01 1 1  ON 48
eH2_9                 1.511632e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9067
    reference variance = 0.336464
====================================================
  Execution time = 2.0611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4324e-01
  Total weights = 2.0000e+06
  Execution time = 1.9111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340950388699
                                         uncertainty =       0.008348854937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340950388699
                                         uncertainty =       0.008348854937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412903576
  error estimate for blocks of size 2^( 2) =       0.000425508391
  error estimate for blocks of size 2^( 3) =       0.000438537310
  error estimate for blocks of size 2^( 4) =       0.000449820226
  error estimate for blocks of size 2^( 5) =       0.000459487773
  error estimate for blocks of size 2^( 6) =       0.000465324738
  error estimate for blocks of size 2^( 7) =       0.000469402488

      target function =                  N/A
              le_mean =     -16.905956246993
             les_mean =     286.152335180209
             stat err =       0.000461008806
             autocorr =       1.246582871383
              std dev =       0.583933836541
             le_variance =       0.340978725458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345409974115
                                         uncertainty =       0.008557163524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345409974115
                                         uncertainty =       0.008557163524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415594945
  error estimate for blocks of size 2^( 2) =       0.000427980162
  error estimate for blocks of size 2^( 3) =       0.000440781081
  error estimate for blocks of size 2^( 4) =       0.000451895904
  error estimate for blocks of size 2^( 5) =       0.000461434310
  error estimate for blocks of size 2^( 6) =       0.000467188039
  error estimate for blocks of size 2^( 7) =       0.000471272876

      target function =                  N/A
              le_mean =     -16.905961793455
             les_mean =     286.156982305744
             stat err =       0.000462947782
             autocorr =       1.240862051785
              std dev =       0.587740007733
             le_variance =       0.345438316690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345690224859
                                         uncertainty =       0.008523657145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345690224859
                                         uncertainty =       0.008523657145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415763486
  error estimate for blocks of size 2^( 2) =       0.000428139704
  error estimate for blocks of size 2^( 3) =       0.000440938519
  error estimate for blocks of size 2^( 4) =       0.000452061823
  error estimate for blocks of size 2^( 5) =       0.000461600712
  error estimate for blocks of size 2^( 6) =       0.000467348016
  error estimate for blocks of size 2^( 7) =       0.000471450439

      target function =                  N/A
              le_mean =     -16.905958769455
             les_mean =     286.157160293510
             stat err =       0.000463115247
             autocorr =       1.240753388485
              std dev =       0.587978360038
             le_variance =       0.345718551872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341776662071
                                         uncertainty =       0.008374797944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341776662071
                                         uncertainty =       0.008374797944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413403553
  error estimate for blocks of size 2^( 2) =       0.000425961314
  error estimate for blocks of size 2^( 3) =       0.000438944069
  error estimate for blocks of size 2^( 4) =       0.000450196070
  error estimate for blocks of size 2^( 5) =       0.000459839110
  error estimate for blocks of size 2^( 6) =       0.000465657869
  error estimate for blocks of size 2^( 7) =       0.000469741228

      target function =                  N/A
              le_mean =     -16.905944405216
             les_mean =     286.152761056239
             stat err =       0.000461358569
             autocorr =       1.245457102855
              std dev =       0.584640911066
             le_variance =       0.341804994892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905956246993        initial
     6.2500e-02     6.2500e-01             1.0133e-02       -16.905961793455  <--
     2.5000e-01     2.5000e+00             4.3718e-03       -16.905958769455
     1.0000e+00     1.0000e+01             1.4205e-03       -16.905944405216

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.0264e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.062349e-01 1 1  ON 0
 uu_1                 1.406089e-01 1 1  ON 1
 uu_2                 4.054860e-02 1 1  ON 2
 uu_3                -1.992392e-02 1 1  ON 3
 uu_4                -6.281026e-02 1 1  ON 4
 uu_5                -9.522458e-02 1 1  ON 5
 uu_6                -1.212899e-01 1 1  ON 6
 uu_7                -1.327646e-01 1 1  ON 7
 uu_8                -1.239085e-01 1 1  ON 8
 uu_9                -9.509907e-02 1 1  ON 9
 ud_0                 4.341075e-01 1 1  ON 10
 ud_1                 1.719232e-01 1 1  ON 11
 ud_2                 5.812330e-02 1 1  ON 12
 ud_3                -7.722999e-03 1 1  ON 13
 ud_4                -6.327484e-02 1 1  ON 14
 ud_5                -1.041412e-01 1 1  ON 15
 ud_6                -1.312375e-01 1 1  ON 16
 ud_7                -1.468564e-01 1 1  ON 17
 ud_8                -1.470538e-01 1 1  ON 18
 ud_9                -1.366653e-01 1 1  ON 19
 eO_0                -7.317780e-01 1 1  ON 20
 eO_1                -4.207474e-01 1 1  ON 21
 eO_2                -1.835217e-02 1 1  ON 22
 eO_3                 2.860398e-01 1 1  ON 23
 eO_4                 5.017698e-01 1 1  ON 24
 eO_5                 4.608657e-01 1 1  ON 25
 eO_6                 2.363382e-01 1 1  ON 26
 eO_7                -5.525487e-02 1 1  ON 27
 eO_8                -2.004646e-01 1 1  ON 28
 eO_9                -6.097277e-02 1 1  ON 29
eH1_0                -2.256623e-01 1 1  ON 30
eH1_1                -1.309891e-01 1 1  ON 31
eH1_2                -8.675783e-02 1 1  ON 32
eH1_3                -3.424395e-02 1 1  ON 33
eH1_4                 1.409798e-02 1 1  ON 34
eH1_5                 4.594129e-02 1 1  ON 35
eH1_6                 9.605669e-02 1 1  ON 36
eH1_7                 1.394379e-01 1 1  ON 37
eH1_8                 1.503113e-01 1 1  ON 38
eH1_9                 3.647627e-02 1 1  ON 39
eH2_0                -2.240577e-01 1 1  ON 40
eH2_1                -1.288107e-01 1 1  ON 41
eH2_2                -8.512915e-02 1 1  ON 42
eH2_3                -3.217566e-02 1 1  ON 43
eH2_4                 1.600278e-02 1 1  ON 44
eH2_5                 4.884067e-02 1 1  ON 45
eH2_6                 1.008986e-01 1 1  ON 46
eH2_7                 1.491331e-01 1 1  ON 47
eH2_8                 1.569459e-01 1 1  ON 48
eH2_9                 1.688671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.313636
====================================================
  Execution time = 2.0780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371322469791
                                         uncertainty =       0.036204898480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371322469791
                                         uncertainty =       0.036204898480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430783913
  error estimate for blocks of size 2^( 2) =       0.000442701003
  error estimate for blocks of size 2^( 3) =       0.000455292890
  error estimate for blocks of size 2^( 4) =       0.000467489822
  error estimate for blocks of size 2^( 5) =       0.000477798356
  error estimate for blocks of size 2^( 6) =       0.000484507728
  error estimate for blocks of size 2^( 7) =       0.000489083716

      target function =                  N/A
              le_mean =     -16.905586826328
             les_mean =     286.170015316705
             stat err =       0.000479719905
             autocorr =       1.240099477942
              std dev =       0.609220452525
             le_variance =       0.371149559775


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558682633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905586826328       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905584251927       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905597110010       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608294498       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905609351933       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905617313928       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905621372303       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905629799753       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905629738055       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905628768866       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905630803830       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905632266918       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905632681573       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905637823072       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905639803392       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905640381591       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905639864209       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905640412452       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905640314306       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905640057045       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905640486918       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905640669441       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905640978678       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.511015e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905586826328       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905584759283       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595428480       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905602610753       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905601270623       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905607516766       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905609516138       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611700592       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611450116       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905610376732       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905611243425       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905610892250       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905611576153       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905612141952       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905612127979       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.418838e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905586826328       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905585670462       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905592379500       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905594320097       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905593154778       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595082050       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595988816       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905596417439       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905596189067       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905595971349       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905595978318       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.316561e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6442e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.082973e-01 1 1  ON 0
 uu_1                 1.420538e-01 1 1  ON 1
 uu_2                 4.113489e-02 1 1  ON 2
 uu_3                -2.011216e-02 1 1  ON 3
 uu_4                -6.358245e-02 1 1  ON 4
 uu_5                -9.629320e-02 1 1  ON 5
 uu_6                -1.226851e-01 1 1  ON 6
 uu_7                -1.337145e-01 1 1  ON 7
 uu_8                -1.254727e-01 1 1  ON 8
 uu_9                -9.622987e-02 1 1  ON 9
 ud_0                 4.373585e-01 1 1  ON 10
 ud_1                 1.741025e-01 1 1  ON 11
 ud_2                 5.891758e-02 1 1  ON 12
 ud_3                -8.333292e-03 1 1  ON 13
 ud_4                -6.485073e-02 1 1  ON 14
 ud_5                -1.056343e-01 1 1  ON 15
 ud_6                -1.320165e-01 1 1  ON 16
 ud_7                -1.472627e-01 1 1  ON 17
 ud_8                -1.474894e-01 1 1  ON 18
 ud_9                -1.379071e-01 1 1  ON 19
 eO_0                -7.381969e-01 1 1  ON 20
 eO_1                -4.247466e-01 1 1  ON 21
 eO_2                -1.779809e-02 1 1  ON 22
 eO_3                 2.896881e-01 1 1  ON 23
 eO_4                 5.066801e-01 1 1  ON 24
 eO_5                 4.645642e-01 1 1  ON 25
 eO_6                 2.379727e-01 1 1  ON 26
 eO_7                -5.402726e-02 1 1  ON 27
 eO_8                -2.030747e-01 1 1  ON 28
 eO_9                -6.329029e-02 1 1  ON 29
eH1_0                -2.294004e-01 1 1  ON 30
eH1_1                -1.327351e-01 1 1  ON 31
eH1_2                -8.767184e-02 1 1  ON 32
eH1_3                -3.468519e-02 1 1  ON 33
eH1_4                 1.293990e-02 1 1  ON 34
eH1_5                 4.642912e-02 1 1  ON 35
eH1_6                 9.771037e-02 1 1  ON 36
eH1_7                 1.416454e-01 1 1  ON 37
eH1_8                 1.525106e-01 1 1  ON 38
eH1_9                 3.821707e-02 1 1  ON 39
eH2_0                -2.285369e-01 1 1  ON 40
eH2_1                -1.308898e-01 1 1  ON 41
eH2_2                -8.587046e-02 1 1  ON 42
eH2_3                -3.303680e-02 1 1  ON 43
eH2_4                 1.608757e-02 1 1  ON 44
eH2_5                 4.920170e-02 1 1  ON 45
eH2_6                 1.012040e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.599391e-01 1 1  ON 48
eH2_9                 2.046356e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.931372
====================================================
  Execution time = 2.2477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4697e-01
  Total weights = 2.0000e+06
  Execution time = 1.9134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344575612115
                                         uncertainty =       0.009127427279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344575612115
                                         uncertainty =       0.009127427279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415096180
  error estimate for blocks of size 2^( 2) =       0.000427862823
  error estimate for blocks of size 2^( 3) =       0.000440592901
  error estimate for blocks of size 2^( 4) =       0.000453099203
  error estimate for blocks of size 2^( 5) =       0.000464164545
  error estimate for blocks of size 2^( 6) =       0.000472565036
  error estimate for blocks of size 2^( 7) =       0.000477365046

      target function =                  N/A
              le_mean =     -16.906335227716
             les_mean =     286.168780337201
             stat err =       0.000466798457
             autocorr =       1.264623799493
              std dev =       0.587034647698
             le_variance =       0.344609677598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348681082685
                                         uncertainty =       0.009295298995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348681082685
                                         uncertainty =       0.009295298995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417563315
  error estimate for blocks of size 2^( 2) =       0.000430215289
  error estimate for blocks of size 2^( 3) =       0.000442803862
  error estimate for blocks of size 2^( 4) =       0.000455173372
  error estimate for blocks of size 2^( 5) =       0.000466161362
  error estimate for blocks of size 2^( 6) =       0.000474541388
  error estimate for blocks of size 2^( 7) =       0.000479255302

      target function =                  N/A
              le_mean =     -16.906347111883
             les_mean =     286.173290737882
             stat err =       0.000468782856
             autocorr =       1.260372059041
              std dev =       0.590523703805
             le_variance =       0.348718244756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349445724738
                                         uncertainty =       0.009331768327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349445724738
                                         uncertainty =       0.009331768327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418021102
  error estimate for blocks of size 2^( 2) =       0.000430646456
  error estimate for blocks of size 2^( 3) =       0.000443227949
  error estimate for blocks of size 2^( 4) =       0.000455606203
  error estimate for blocks of size 2^( 5) =       0.000466600744
  error estimate for blocks of size 2^( 6) =       0.000474983775
  error estimate for blocks of size 2^( 7) =       0.000479699012

      target function =                  N/A
              le_mean =     -16.906352065807
             les_mean =     286.174223282363
             stat err =       0.000469222434
             autocorr =       1.259972663875
              std dev =       0.591171112362
             le_variance =       0.349483284091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654278144
                                         uncertainty =       0.009173059845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654278144
                                         uncertainty =       0.009173059845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415745760
  error estimate for blocks of size 2^( 2) =       0.000428471806
  error estimate for blocks of size 2^( 3) =       0.000441164845
  error estimate for blocks of size 2^( 4) =       0.000453643861
  error estimate for blocks of size 2^( 5) =       0.000464692069
  error estimate for blocks of size 2^( 6) =       0.000473086419
  error estimate for blocks of size 2^( 7) =       0.000477873053

      target function =                  N/A
              le_mean =     -16.906326592151
             les_mean =     286.169567742076
             stat err =       0.000467323850
             autocorr =       1.263514512162
              std dev =       0.587953292741
             le_variance =       0.345689074445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906335227716        initial
     1.5625e-02     1.5625e-01             1.5110e-02       -16.906347111883
     6.2500e-02     6.2500e-01             6.4188e-03       -16.906352065807  <--
     2.5000e-01     2.5000e+00             2.3166e-03       -16.906326592151

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.2129e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.082973e-01 1 1  ON 0
 uu_1                 1.420538e-01 1 1  ON 1
 uu_2                 4.113489e-02 1 1  ON 2
 uu_3                -2.011216e-02 1 1  ON 3
 uu_4                -6.358245e-02 1 1  ON 4
 uu_5                -9.629320e-02 1 1  ON 5
 uu_6                -1.226851e-01 1 1  ON 6
 uu_7                -1.337145e-01 1 1  ON 7
 uu_8                -1.254727e-01 1 1  ON 8
 uu_9                -9.622987e-02 1 1  ON 9
 ud_0                 4.373585e-01 1 1  ON 10
 ud_1                 1.741025e-01 1 1  ON 11
 ud_2                 5.891758e-02 1 1  ON 12
 ud_3                -8.333292e-03 1 1  ON 13
 ud_4                -6.485073e-02 1 1  ON 14
 ud_5                -1.056343e-01 1 1  ON 15
 ud_6                -1.320165e-01 1 1  ON 16
 ud_7                -1.472627e-01 1 1  ON 17
 ud_8                -1.474894e-01 1 1  ON 18
 ud_9                -1.379071e-01 1 1  ON 19
 eO_0                -7.381969e-01 1 1  ON 20
 eO_1                -4.247466e-01 1 1  ON 21
 eO_2                -1.779809e-02 1 1  ON 22
 eO_3                 2.896881e-01 1 1  ON 23
 eO_4                 5.066801e-01 1 1  ON 24
 eO_5                 4.645642e-01 1 1  ON 25
 eO_6                 2.379727e-01 1 1  ON 26
 eO_7                -5.402726e-02 1 1  ON 27
 eO_8                -2.030747e-01 1 1  ON 28
 eO_9                -6.329029e-02 1 1  ON 29
eH1_0                -2.294004e-01 1 1  ON 30
eH1_1                -1.327351e-01 1 1  ON 31
eH1_2                -8.767184e-02 1 1  ON 32
eH1_3                -3.468519e-02 1 1  ON 33
eH1_4                 1.293990e-02 1 1  ON 34
eH1_5                 4.642912e-02 1 1  ON 35
eH1_6                 9.771037e-02 1 1  ON 36
eH1_7                 1.416454e-01 1 1  ON 37
eH1_8                 1.525106e-01 1 1  ON 38
eH1_9                 3.821707e-02 1 1  ON 39
eH2_0                -2.285369e-01 1 1  ON 40
eH2_1                -1.308898e-01 1 1  ON 41
eH2_2                -8.587046e-02 1 1  ON 42
eH2_3                -3.303680e-02 1 1  ON 43
eH2_4                 1.608757e-02 1 1  ON 44
eH2_5                 4.920170e-02 1 1  ON 45
eH2_6                 1.012040e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.599391e-01 1 1  ON 48
eH2_9                 2.046356e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.234956
====================================================
  Execution time = 2.0794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336931894864
                                         uncertainty =       0.004890451700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336931894864
                                         uncertainty =       0.004890451700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410411230
  error estimate for blocks of size 2^( 2) =       0.000423021922
  error estimate for blocks of size 2^( 3) =       0.000435684241
  error estimate for blocks of size 2^( 4) =       0.000446563107
  error estimate for blocks of size 2^( 5) =       0.000457321536
  error estimate for blocks of size 2^( 6) =       0.000464234283
  error estimate for blocks of size 2^( 7) =       0.000467801750

      target function =                  N/A
              le_mean =     -16.906265065669
             les_mean =     286.158673058250
             stat err =       0.000458980169
             autocorr =       1.250689116125
              std dev =       0.580409128138
             le_variance =       0.336874756026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626506567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906265065669       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906270807511       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278637582       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272777486       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906277393303       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906284453197       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290201769       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906292270663       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906294630495       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906297441733       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906297096120       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906299531694       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906305031113       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906305438869       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906303450198       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906303391934       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906305917824       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906306493724       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906307661824       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906307506834       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906307123957       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906307081006       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.573783e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906265065669       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269794005       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906276156656       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271450396       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272867176       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906277372553       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279972372       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279982208       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906281414205       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906280937782       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906281426340       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906281309599       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906282161226       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906282161433       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.612818e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906265065669       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906267837179       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906271687589       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906270162857       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906268821968       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906270724372       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906271357864       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906271657307       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906271657317       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906271696270       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.406282e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6419e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.094451e-01 1 1  ON 0
 uu_1                 1.428443e-01 1 1  ON 1
 uu_2                 4.179847e-02 1 1  ON 2
 uu_3                -1.992487e-02 1 1  ON 3
 uu_4                -6.417855e-02 1 1  ON 4
 uu_5                -9.789951e-02 1 1  ON 5
 uu_6                -1.236636e-01 1 1  ON 6
 uu_7                -1.355881e-01 1 1  ON 7
 uu_8                -1.269396e-01 1 1  ON 8
 uu_9                -9.662816e-02 1 1  ON 9
 ud_0                 4.388383e-01 1 1  ON 10
 ud_1                 1.754011e-01 1 1  ON 11
 ud_2                 5.986114e-02 1 1  ON 12
 ud_3                -7.816352e-03 1 1  ON 13
 ud_4                -6.441364e-02 1 1  ON 14
 ud_5                -1.055632e-01 1 1  ON 15
 ud_6                -1.322587e-01 1 1  ON 16
 ud_7                -1.477521e-01 1 1  ON 17
 ud_8                -1.487655e-01 1 1  ON 18
 ud_9                -1.387061e-01 1 1  ON 19
 eO_0                -7.419272e-01 1 1  ON 20
 eO_1                -4.269500e-01 1 1  ON 21
 eO_2                -1.864644e-02 1 1  ON 22
 eO_3                 2.905608e-01 1 1  ON 23
 eO_4                 5.104681e-01 1 1  ON 24
 eO_5                 4.691770e-01 1 1  ON 25
 eO_6                 2.404156e-01 1 1  ON 26
 eO_7                -5.365091e-02 1 1  ON 27
 eO_8                -2.057369e-01 1 1  ON 28
 eO_9                -6.545784e-02 1 1  ON 29
eH1_0                -2.333191e-01 1 1  ON 30
eH1_1                -1.350529e-01 1 1  ON 31
eH1_2                -8.945561e-02 1 1  ON 32
eH1_3                -3.585879e-02 1 1  ON 33
eH1_4                 1.276988e-02 1 1  ON 34
eH1_5                 4.656679e-02 1 1  ON 35
eH1_6                 9.827011e-02 1 1  ON 36
eH1_7                 1.437867e-01 1 1  ON 37
eH1_8                 1.565436e-01 1 1  ON 38
eH1_9                 4.109367e-02 1 1  ON 39
eH2_0                -2.310404e-01 1 1  ON 40
eH2_1                -1.324212e-01 1 1  ON 41
eH2_2                -8.690169e-02 1 1  ON 42
eH2_3                -3.372584e-02 1 1  ON 43
eH2_4                 1.525658e-02 1 1  ON 44
eH2_5                 4.894333e-02 1 1  ON 45
eH2_6                 1.015866e-01 1 1  ON 46
eH2_7                 1.509812e-01 1 1  ON 47
eH2_8                 1.623289e-01 1 1  ON 48
eH2_9                 2.373076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9712
    reference variance = 1.19116
====================================================
  Execution time = 2.0252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5542e-01
  Total weights = 2.0000e+06
  Execution time = 1.9166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354807233544
                                         uncertainty =       0.020646954074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354807233544
                                         uncertainty =       0.020646954074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421230417
  error estimate for blocks of size 2^( 2) =       0.000434097943
  error estimate for blocks of size 2^( 3) =       0.000448319288
  error estimate for blocks of size 2^( 4) =       0.000461207029
  error estimate for blocks of size 2^( 5) =       0.000474045575
  error estimate for blocks of size 2^( 6) =       0.000482575211
  error estimate for blocks of size 2^( 7) =       0.000488532232

      target function =                  N/A
              le_mean =     -16.905125989104
             les_mean =     286.138154658379
             stat err =       0.000476590012
             autocorr =       1.280119238804
              std dev =       0.595709768535
             le_variance =       0.354870128328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356251844116
                                         uncertainty =       0.020652733758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356251844116
                                         uncertainty =       0.020652733758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422087209
  error estimate for blocks of size 2^( 2) =       0.000434924152
  error estimate for blocks of size 2^( 3) =       0.000449076570
  error estimate for blocks of size 2^( 4) =       0.000461857578
  error estimate for blocks of size 2^( 5) =       0.000474612596
  error estimate for blocks of size 2^( 6) =       0.000483092531
  error estimate for blocks of size 2^( 7) =       0.000488933335

      target function =                  N/A
              le_mean =     -16.905134697483
             les_mean =     286.139894185331
             stat err =       0.000477124010
             autocorr =       1.277786105467
              std dev =       0.596921454998
             le_variance =       0.356315223437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355949545359
                                         uncertainty =       0.020640739423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355949545359
                                         uncertainty =       0.020640739423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421908267
  error estimate for blocks of size 2^( 2) =       0.000434752625
  error estimate for blocks of size 2^( 3) =       0.000448926642
  error estimate for blocks of size 2^( 4) =       0.000461736592
  error estimate for blocks of size 2^( 5) =       0.000474530148
  error estimate for blocks of size 2^( 6) =       0.000483023605
  error estimate for blocks of size 2^( 7) =       0.000488879764

      target function =                  N/A
              le_mean =     -16.905139767293
             les_mean =     286.139763545171
             stat err =       0.000477042528
             autocorr =       1.278433447361
              std dev =       0.596668393223
             le_variance =       0.356013171472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354929518556
                                         uncertainty =       0.020632832948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354929518556
                                         uncertainty =       0.020632832948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421303096
  error estimate for blocks of size 2^( 2) =       0.000434166691
  error estimate for blocks of size 2^( 3) =       0.000448382064
  error estimate for blocks of size 2^( 4) =       0.000461259396
  error estimate for blocks of size 2^( 5) =       0.000474095017
  error estimate for blocks of size 2^( 6) =       0.000482619040
  error estimate for blocks of size 2^( 7) =       0.000488560360

      target function =                  N/A
              le_mean =     -16.905127377392
             les_mean =     286.138324066120
             stat err =       0.000476633453
             autocorr =       1.279910904994
              std dev =       0.595812552551
             le_variance =       0.354992597778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905125989104        initial
     1.5625e-02     1.5625e-01             1.5738e-02       -16.905134697483
     6.2500e-02     6.2500e-01             4.6128e-03       -16.905139767293  <--
     2.5000e-01     2.5000e+00             1.4063e-03       -16.905127377392

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9923e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.094451e-01 1 1  ON 0
 uu_1                 1.428443e-01 1 1  ON 1
 uu_2                 4.179847e-02 1 1  ON 2
 uu_3                -1.992487e-02 1 1  ON 3
 uu_4                -6.417855e-02 1 1  ON 4
 uu_5                -9.789951e-02 1 1  ON 5
 uu_6                -1.236636e-01 1 1  ON 6
 uu_7                -1.355881e-01 1 1  ON 7
 uu_8                -1.269396e-01 1 1  ON 8
 uu_9                -9.662816e-02 1 1  ON 9
 ud_0                 4.388383e-01 1 1  ON 10
 ud_1                 1.754011e-01 1 1  ON 11
 ud_2                 5.986114e-02 1 1  ON 12
 ud_3                -7.816352e-03 1 1  ON 13
 ud_4                -6.441364e-02 1 1  ON 14
 ud_5                -1.055632e-01 1 1  ON 15
 ud_6                -1.322587e-01 1 1  ON 16
 ud_7                -1.477521e-01 1 1  ON 17
 ud_8                -1.487655e-01 1 1  ON 18
 ud_9                -1.387061e-01 1 1  ON 19
 eO_0                -7.419272e-01 1 1  ON 20
 eO_1                -4.269500e-01 1 1  ON 21
 eO_2                -1.864644e-02 1 1  ON 22
 eO_3                 2.905608e-01 1 1  ON 23
 eO_4                 5.104681e-01 1 1  ON 24
 eO_5                 4.691770e-01 1 1  ON 25
 eO_6                 2.404156e-01 1 1  ON 26
 eO_7                -5.365091e-02 1 1  ON 27
 eO_8                -2.057369e-01 1 1  ON 28
 eO_9                -6.545784e-02 1 1  ON 29
eH1_0                -2.333191e-01 1 1  ON 30
eH1_1                -1.350529e-01 1 1  ON 31
eH1_2                -8.945561e-02 1 1  ON 32
eH1_3                -3.585879e-02 1 1  ON 33
eH1_4                 1.276988e-02 1 1  ON 34
eH1_5                 4.656679e-02 1 1  ON 35
eH1_6                 9.827011e-02 1 1  ON 36
eH1_7                 1.437867e-01 1 1  ON 37
eH1_8                 1.565436e-01 1 1  ON 38
eH1_9                 4.109367e-02 1 1  ON 39
eH2_0                -2.310404e-01 1 1  ON 40
eH2_1                -1.324212e-01 1 1  ON 41
eH2_2                -8.690169e-02 1 1  ON 42
eH2_3                -3.372584e-02 1 1  ON 43
eH2_4                 1.525658e-02 1 1  ON 44
eH2_5                 4.894333e-02 1 1  ON 45
eH2_6                 1.015866e-01 1 1  ON 46
eH2_7                 1.509812e-01 1 1  ON 47
eH2_8                 1.623289e-01 1 1  ON 48
eH2_9                 2.373076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9501
    reference variance = 0.21354
====================================================
  Execution time = 2.0631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3296e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333035511159
                                         uncertainty =       0.002992880903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333035511159
                                         uncertainty =       0.002992880903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408018493
  error estimate for blocks of size 2^( 2) =       0.000421008128
  error estimate for blocks of size 2^( 3) =       0.000434662592
  error estimate for blocks of size 2^( 4) =       0.000447193546
  error estimate for blocks of size 2^( 5) =       0.000459081544
  error estimate for blocks of size 2^( 6) =       0.000467492270
  error estimate for blocks of size 2^( 7) =       0.000471763747

      target function =                  N/A
              le_mean =     -16.905406265233
             les_mean =     286.125719007447
             stat err =       0.000461382777
             autocorr =       1.278683500836
              std dev =       0.577025286583
             le_variance =       0.332958181357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540626523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406265233       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905403619263       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406070582       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905408862229       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905409874562       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905410228231       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905419801997       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905420613238       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905432374968       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905429922727       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905434295149       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905434675509       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905432561186       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905435072794       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905435130371       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905435285385       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905433981451       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905434170423       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905433929706       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905434151243       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.721226e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406265233       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404113344       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405954286       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905407909074       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905409228064       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905408708830       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905413551656       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905412590799       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905415246659       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905414426266       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905415930996       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905415438640       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905414856730       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.156945e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905406265233       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405033413       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405905206       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905406504661       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905407632047       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905406910738       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905408065642       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905408189272       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905408280502       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905408387482       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.046382e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6203e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.102993e-01 1 1  ON 0
 uu_1                 1.434182e-01 1 1  ON 1
 uu_2                 4.202019e-02 1 1  ON 2
 uu_3                -2.013397e-02 1 1  ON 3
 uu_4                -6.500671e-02 1 1  ON 4
 uu_5                -9.834701e-02 1 1  ON 5
 uu_6                -1.248383e-01 1 1  ON 6
 uu_7                -1.372980e-01 1 1  ON 7
 uu_8                -1.282220e-01 1 1  ON 8
 uu_9                -9.727418e-02 1 1  ON 9
 ud_0                 4.395761e-01 1 1  ON 10
 ud_1                 1.759926e-01 1 1  ON 11
 ud_2                 6.042246e-02 1 1  ON 12
 ud_3                -8.087852e-03 1 1  ON 13
 ud_4                -6.528710e-02 1 1  ON 14
 ud_5                -1.064439e-01 1 1  ON 15
 ud_6                -1.328850e-01 1 1  ON 16
 ud_7                -1.481792e-01 1 1  ON 17
 ud_8                -1.489184e-01 1 1  ON 18
 ud_9                -1.390049e-01 1 1  ON 19
 eO_0                -7.441659e-01 1 1  ON 20
 eO_1                -4.294170e-01 1 1  ON 21
 eO_2                -1.946739e-02 1 1  ON 22
 eO_3                 2.920344e-01 1 1  ON 23
 eO_4                 5.130725e-01 1 1  ON 24
 eO_5                 4.721346e-01 1 1  ON 25
 eO_6                 2.424938e-01 1 1  ON 26
 eO_7                -5.310606e-02 1 1  ON 27
 eO_8                -2.080688e-01 1 1  ON 28
 eO_9                -6.715594e-02 1 1  ON 29
eH1_0                -2.356535e-01 1 1  ON 30
eH1_1                -1.366727e-01 1 1  ON 31
eH1_2                -9.142601e-02 1 1  ON 32
eH1_3                -3.716965e-02 1 1  ON 33
eH1_4                 1.210200e-02 1 1  ON 34
eH1_5                 4.581724e-02 1 1  ON 35
eH1_6                 9.930734e-02 1 1  ON 36
eH1_7                 1.469676e-01 1 1  ON 37
eH1_8                 1.589359e-01 1 1  ON 38
eH1_9                 4.316532e-02 1 1  ON 39
eH2_0                -2.323680e-01 1 1  ON 40
eH2_1                -1.336581e-01 1 1  ON 41
eH2_2                -8.859854e-02 1 1  ON 42
eH2_3                -3.471689e-02 1 1  ON 43
eH2_4                 1.406422e-02 1 1  ON 44
eH2_5                 4.842073e-02 1 1  ON 45
eH2_6                 1.011093e-01 1 1  ON 46
eH2_7                 1.510880e-01 1 1  ON 47
eH2_8                 1.651138e-01 1 1  ON 48
eH2_9                 2.788771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8362
    reference variance = 0.22936
====================================================
  Execution time = 2.0323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3451e-01
  Total weights = 2.0000e+06
  Execution time = 1.9122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333932223403
                                         uncertainty =       0.002696227615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333932223403
                                         uncertainty =       0.002696227615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575483
  error estimate for blocks of size 2^( 2) =       0.000421297594
  error estimate for blocks of size 2^( 3) =       0.000433695353
  error estimate for blocks of size 2^( 4) =       0.000446355919
  error estimate for blocks of size 2^( 5) =       0.000456696323
  error estimate for blocks of size 2^( 6) =       0.000464187755
  error estimate for blocks of size 2^( 7) =       0.000469243653

      target function =                  N/A
              le_mean =     -16.905765596486
             les_mean =     286.138778087555
             stat err =       0.000459120912
             autocorr =       1.262727222472
              std dev =       0.577812989778
             le_variance =       0.333867851156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335376073446
                                         uncertainty =       0.002708375282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335376073446
                                         uncertainty =       0.002708375282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409458198
  error estimate for blocks of size 2^( 2) =       0.000422160547
  error estimate for blocks of size 2^( 3) =       0.000434491282
  error estimate for blocks of size 2^( 4) =       0.000447071493
  error estimate for blocks of size 2^( 5) =       0.000457335465
  error estimate for blocks of size 2^( 6) =       0.000464805913
  error estimate for blocks of size 2^( 7) =       0.000469844047

      target function =                  N/A
              le_mean =     -16.905767322528
             les_mean =     286.140280628176
             stat err =       0.000459764229
             autocorr =       1.260814562323
              std dev =       0.579061337332
             le_variance =       0.335312032393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335256113633
                                         uncertainty =       0.002707350871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335256113633
                                         uncertainty =       0.002707350871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409385013
  error estimate for blocks of size 2^( 2) =       0.000422092309
  error estimate for blocks of size 2^( 3) =       0.000434427058
  error estimate for blocks of size 2^( 4) =       0.000447029188
  error estimate for blocks of size 2^( 5) =       0.000457313325
  error estimate for blocks of size 2^( 6) =       0.000464796137
  error estimate for blocks of size 2^( 7) =       0.000469836362

      target function =                  N/A
              le_mean =     -16.905759273766
             les_mean =     286.139888632098
             stat err =       0.000459743753
             autocorr =       1.261153050495
              std dev =       0.578957837139
             le_variance =       0.335192177185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334149819191
                                         uncertainty =       0.002698121733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334149819191
                                         uncertainty =       0.002698121733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408708663
  error estimate for blocks of size 2^( 2) =       0.000421428344
  error estimate for blocks of size 2^( 3) =       0.000433813411
  error estimate for blocks of size 2^( 4) =       0.000446465985
  error estimate for blocks of size 2^( 5) =       0.000456797736
  error estimate for blocks of size 2^( 6) =       0.000464287541
  error estimate for blocks of size 2^( 7) =       0.000469339695

      target function =                  N/A
              le_mean =     -16.905760586373
             les_mean =     286.138826379861
             stat err =       0.000459222739
             autocorr =       1.262464230028
              std dev =       0.578001334906
             le_variance =       0.334085543153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905765596486        initial
     1.5625e-02     1.5625e-01             1.7212e-02       -16.905767322528  <--
     6.2500e-02     6.2500e-01             4.1569e-03       -16.905759273766
     2.5000e-01     2.5000e+00             1.0464e-03       -16.905760586373

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 2.9909e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.107268e-01 1 1  ON 0
 uu_1                 1.437543e-01 1 1  ON 1
 uu_2                 4.199255e-02 1 1  ON 2
 uu_3                -2.061666e-02 1 1  ON 3
 uu_4                -6.614461e-02 1 1  ON 4
 uu_5                -1.000148e-01 1 1  ON 5
 uu_6                -1.273475e-01 1 1  ON 6
 uu_7                -1.407713e-01 1 1  ON 7
 uu_8                -1.311986e-01 1 1  ON 8
 uu_9                -1.000156e-01 1 1  ON 9
 ud_0                 4.406110e-01 1 1  ON 10
 ud_1                 1.768556e-01 1 1  ON 11
 ud_2                 6.101260e-02 1 1  ON 12
 ud_3                -8.039793e-03 1 1  ON 13
 ud_4                -6.587609e-02 1 1  ON 14
 ud_5                -1.075182e-01 1 1  ON 15
 ud_6                -1.343449e-01 1 1  ON 16
 ud_7                -1.498637e-01 1 1  ON 17
 ud_8                -1.501526e-01 1 1  ON 18
 ud_9                -1.402999e-01 1 1  ON 19
 eO_0                -7.474529e-01 1 1  ON 20
 eO_1                -4.321177e-01 1 1  ON 21
 eO_2                -2.044180e-02 1 1  ON 22
 eO_3                 2.935142e-01 1 1  ON 23
 eO_4                 5.172312e-01 1 1  ON 24
 eO_5                 4.779425e-01 1 1  ON 25
 eO_6                 2.485466e-01 1 1  ON 26
 eO_7                -5.065512e-02 1 1  ON 27
 eO_8                -2.150594e-01 1 1  ON 28
 eO_9                -7.276748e-02 1 1  ON 29
eH1_0                -2.404142e-01 1 1  ON 30
eH1_1                -1.409069e-01 1 1  ON 31
eH1_2                -9.549900e-02 1 1  ON 32
eH1_3                -4.070547e-02 1 1  ON 33
eH1_4                 9.072606e-03 1 1  ON 34
eH1_5                 4.380798e-02 1 1  ON 35
eH1_6                 9.944870e-02 1 1  ON 36
eH1_7                 1.530689e-01 1 1  ON 37
eH1_8                 1.669699e-01 1 1  ON 38
eH1_9                 5.054691e-02 1 1  ON 39
eH2_0                -2.366797e-01 1 1  ON 40
eH2_1                -1.377853e-01 1 1  ON 41
eH2_2                -9.265903e-02 1 1  ON 42
eH2_3                -3.831254e-02 1 1  ON 43
eH2_4                 1.066215e-02 1 1  ON 44
eH2_5                 4.566842e-02 1 1  ON 45
eH2_6                 9.971041e-02 1 1  ON 46
eH2_7                 1.522268e-01 1 1  ON 47
eH2_8                 1.732127e-01 1 1  ON 48
eH2_9                 4.094302e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9108
    reference variance = 0.209197
====================================================
  Execution time = 2.0667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348468773267
                                         uncertainty =       0.008873853836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348468773267
                                         uncertainty =       0.008873853836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417410650
  error estimate for blocks of size 2^( 2) =       0.000430023362
  error estimate for blocks of size 2^( 3) =       0.000442317450
  error estimate for blocks of size 2^( 4) =       0.000452748158
  error estimate for blocks of size 2^( 5) =       0.000461199070
  error estimate for blocks of size 2^( 6) =       0.000469011264
  error estimate for blocks of size 2^( 7) =       0.000474964369

      target function =                  N/A
              le_mean =     -16.905326358439
             les_mean =     286.138522413051
             stat err =       0.000464480715
             autocorr =       1.238249960155
              std dev =       0.590307802730
             le_variance =       0.348463301964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690532635844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905326358439       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905330692540       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905335519590       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905338907480       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340576311       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905336777364       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905339634578       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905333254214       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905333594495       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905331718857       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905346529274       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905355130721       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905358407183       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905365748034       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905371188831       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905377200341       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905373127958       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905374298956       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905374361118       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905375758921       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905373976609       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905377784550       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905376103838       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905375278295       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905375892752       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905377669983       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905377004883       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905377459238       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 5.249023e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905326358439       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905330461802       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905334604174       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337993007       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905339782644       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905336346378       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905338944826       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905334083640       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905334000310       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905332711141       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905339478692       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905344117233       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905344291176       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905346382188       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905347985813       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905348078462       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905347062638       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905346822927       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905347373190       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.397800e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905326358439       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905329741398       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905332110545       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905335429871       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905337541678       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905335311575       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905336675726       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905333859830       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905333168918       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905333886350       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905335835628       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905336092146       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905335960352       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.603852e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6284e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.106767e-01 1 1  ON 0
 uu_1                 1.440231e-01 1 1  ON 1
 uu_2                 4.208518e-02 1 1  ON 2
 uu_3                -2.067448e-02 1 1  ON 3
 uu_4                -6.612675e-02 1 1  ON 4
 uu_5                -1.012414e-01 1 1  ON 5
 uu_6                -1.284065e-01 1 1  ON 6
 uu_7                -1.417678e-01 1 1  ON 7
 uu_8                -1.340563e-01 1 1  ON 8
 uu_9                -1.034603e-01 1 1  ON 9
 ud_0                 4.426302e-01 1 1  ON 10
 ud_1                 1.789274e-01 1 1  ON 11
 ud_2                 6.244982e-02 1 1  ON 12
 ud_3                -6.580442e-03 1 1  ON 13
 ud_4                -6.447986e-02 1 1  ON 14
 ud_5                -1.067239e-01 1 1  ON 15
 ud_6                -1.341587e-01 1 1  ON 16
 ud_7                -1.513950e-01 1 1  ON 17
 ud_8                -1.506567e-01 1 1  ON 18
 ud_9                -1.396953e-01 1 1  ON 19
 eO_0                -7.493612e-01 1 1  ON 20
 eO_1                -4.332820e-01 1 1  ON 21
 eO_2                -2.056098e-02 1 1  ON 22
 eO_3                 2.945709e-01 1 1  ON 23
 eO_4                 5.214254e-01 1 1  ON 24
 eO_5                 4.829312e-01 1 1  ON 25
 eO_6                 2.555059e-01 1 1  ON 26
 eO_7                -4.635176e-02 1 1  ON 27
 eO_8                -2.231307e-01 1 1  ON 28
 eO_9                -8.110850e-02 1 1  ON 29
eH1_0                -2.440046e-01 1 1  ON 30
eH1_1                -1.439618e-01 1 1  ON 31
eH1_2                -9.813451e-02 1 1  ON 32
eH1_3                -4.338135e-02 1 1  ON 33
eH1_4                 5.785085e-03 1 1  ON 34
eH1_5                 4.082869e-02 1 1  ON 35
eH1_6                 9.677702e-02 1 1  ON 36
eH1_7                 1.507469e-01 1 1  ON 37
eH1_8                 1.748652e-01 1 1  ON 38
eH1_9                 6.452491e-02 1 1  ON 39
eH2_0                -2.423491e-01 1 1  ON 40
eH2_1                -1.414990e-01 1 1  ON 41
eH2_2                -9.568075e-02 1 1  ON 42
eH2_3                -4.095029e-02 1 1  ON 43
eH2_4                 8.669770e-03 1 1  ON 44
eH2_5                 4.383899e-02 1 1  ON 45
eH2_6                 1.008899e-01 1 1  ON 46
eH2_7                 1.562617e-01 1 1  ON 47
eH2_8                 1.797322e-01 1 1  ON 48
eH2_9                 4.949230e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9136
    reference variance = 0.24755
====================================================
  Execution time = 2.0120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4475e-01
  Total weights = 2.0000e+06
  Execution time = 1.8933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344560355567
                                         uncertainty =       0.010514207095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344560355567
                                         uncertainty =       0.010514207095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415025712
  error estimate for blocks of size 2^( 2) =       0.000427354007
  error estimate for blocks of size 2^( 3) =       0.000440303473
  error estimate for blocks of size 2^( 4) =       0.000452518172
  error estimate for blocks of size 2^( 5) =       0.000462087576
  error estimate for blocks of size 2^( 6) =       0.000469794727
  error estimate for blocks of size 2^( 7) =       0.000476907911

      target function =                  N/A
              le_mean =     -16.905300984972
             les_mean =     286.133693903773
             stat err =       0.000465327097
             autocorr =       1.257090888279
              std dev =       0.586934990882
             le_variance =       0.344492683522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345196695618
                                         uncertainty =       0.010520402710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345196695618
                                         uncertainty =       0.010520402710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415408671
  error estimate for blocks of size 2^( 2) =       0.000427719425
  error estimate for blocks of size 2^( 3) =       0.000440620345
  error estimate for blocks of size 2^( 4) =       0.000452774894
  error estimate for blocks of size 2^( 5) =       0.000462272990
  error estimate for blocks of size 2^( 6) =       0.000469925069
  error estimate for blocks of size 2^( 7) =       0.000477057925

      target function =                  N/A
              le_mean =     -16.905306752058
             les_mean =     286.134524936480
             stat err =       0.000465507719
             autocorr =       1.255748475247
              std dev =       0.587476576438
             le_variance =       0.345128727863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345128308921
                                         uncertainty =       0.010512466739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345128308921
                                         uncertainty =       0.010512466739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415367471
  error estimate for blocks of size 2^( 2) =       0.000427692411
  error estimate for blocks of size 2^( 3) =       0.000440616060
  error estimate for blocks of size 2^( 4) =       0.000452782724
  error estimate for blocks of size 2^( 5) =       0.000462304392
  error estimate for blocks of size 2^( 6) =       0.000469977393
  error estimate for blocks of size 2^( 7) =       0.000477124452

      target function =                  N/A
              le_mean =     -16.905315751237
             les_mean =     286.134760749180
             stat err =       0.000465547240
             autocorr =       1.256210870153
              std dev =       0.587418311489
             le_variance =       0.345060272673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344581694278
                                         uncertainty =       0.010512223934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344581694278
                                         uncertainty =       0.010512223934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415038485
  error estimate for blocks of size 2^( 2) =       0.000427366104
  error estimate for blocks of size 2^( 3) =       0.000440314475
  error estimate for blocks of size 2^( 4) =       0.000452520948
  error estimate for blocks of size 2^( 5) =       0.000462087559
  error estimate for blocks of size 2^( 6) =       0.000469789885
  error estimate for blocks of size 2^( 7) =       0.000476915961

      target function =                  N/A
              le_mean =     -16.905300790853
             les_mean =     286.133708544906
             stat err =       0.000465328588
             autocorr =       1.257021575309
              std dev =       0.586953054296
             le_variance =       0.344513887947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905300984972        initial
     3.9062e-03     3.9062e-02             5.2490e-02       -16.905306752058
     1.5625e-02     1.5625e-01             1.3978e-02       -16.905315751237  <--
     6.2500e-02     6.2500e-01             3.6039e-03       -16.905300790853

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 2.9650e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.106767e-01 1 1  ON 0
 uu_1                 1.440231e-01 1 1  ON 1
 uu_2                 4.208518e-02 1 1  ON 2
 uu_3                -2.067448e-02 1 1  ON 3
 uu_4                -6.612675e-02 1 1  ON 4
 uu_5                -1.012414e-01 1 1  ON 5
 uu_6                -1.284065e-01 1 1  ON 6
 uu_7                -1.417678e-01 1 1  ON 7
 uu_8                -1.340563e-01 1 1  ON 8
 uu_9                -1.034603e-01 1 1  ON 9
 ud_0                 4.426302e-01 1 1  ON 10
 ud_1                 1.789274e-01 1 1  ON 11
 ud_2                 6.244982e-02 1 1  ON 12
 ud_3                -6.580442e-03 1 1  ON 13
 ud_4                -6.447986e-02 1 1  ON 14
 ud_5                -1.067239e-01 1 1  ON 15
 ud_6                -1.341587e-01 1 1  ON 16
 ud_7                -1.513950e-01 1 1  ON 17
 ud_8                -1.506567e-01 1 1  ON 18
 ud_9                -1.396953e-01 1 1  ON 19
 eO_0                -7.493612e-01 1 1  ON 20
 eO_1                -4.332820e-01 1 1  ON 21
 eO_2                -2.056098e-02 1 1  ON 22
 eO_3                 2.945709e-01 1 1  ON 23
 eO_4                 5.214254e-01 1 1  ON 24
 eO_5                 4.829312e-01 1 1  ON 25
 eO_6                 2.555059e-01 1 1  ON 26
 eO_7                -4.635176e-02 1 1  ON 27
 eO_8                -2.231307e-01 1 1  ON 28
 eO_9                -8.110850e-02 1 1  ON 29
eH1_0                -2.440046e-01 1 1  ON 30
eH1_1                -1.439618e-01 1 1  ON 31
eH1_2                -9.813451e-02 1 1  ON 32
eH1_3                -4.338135e-02 1 1  ON 33
eH1_4                 5.785085e-03 1 1  ON 34
eH1_5                 4.082869e-02 1 1  ON 35
eH1_6                 9.677702e-02 1 1  ON 36
eH1_7                 1.507469e-01 1 1  ON 37
eH1_8                 1.748652e-01 1 1  ON 38
eH1_9                 6.452491e-02 1 1  ON 39
eH2_0                -2.423491e-01 1 1  ON 40
eH2_1                -1.414990e-01 1 1  ON 41
eH2_2                -9.568075e-02 1 1  ON 42
eH2_3                -4.095029e-02 1 1  ON 43
eH2_4                 8.669770e-03 1 1  ON 44
eH2_5                 4.383899e-02 1 1  ON 45
eH2_6                 1.008899e-01 1 1  ON 46
eH2_7                 1.562617e-01 1 1  ON 47
eH2_8                 1.797322e-01 1 1  ON 48
eH2_9                 4.949230e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9428
    reference variance = 0.343722
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329617721371
                                         uncertainty =       0.002544121248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329617721371
                                         uncertainty =       0.002544121248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405996606
  error estimate for blocks of size 2^( 2) =       0.000418769673
  error estimate for blocks of size 2^( 3) =       0.000431851934
  error estimate for blocks of size 2^( 4) =       0.000445085239
  error estimate for blocks of size 2^( 5) =       0.000456428786
  error estimate for blocks of size 2^( 6) =       0.000465957611
  error estimate for blocks of size 2^( 7) =       0.000472758982

      target function =                  N/A
              le_mean =     -16.905512719527
             les_mean =     286.126026634036
             stat err =       0.000460057655
             autocorr =       1.284043435895
              std dev =       0.574165907026
             le_variance =       0.329666488791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551271953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905512719527       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905513998395       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905516377273       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905517412353       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905516659622       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905518038345       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905522506054       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524488837       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905531497686       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905539600664       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905545658798       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905553801907       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905566527276       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905565114519       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905566676866       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905566638138       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905565919285       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905570880411       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905573070160       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905574359864       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905573206211       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905572645109       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905572097560       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905573479986       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905574182591       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905574630624       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905573945472       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905573960805       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 5.042167e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905512719527       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905513949415       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905516044367       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905516878621       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905516035827       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905517186031       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905521247593       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905522499835       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905527311502       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905531489825       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905534612071       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905535347861       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905538097577       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905536314088       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905536288167       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905535674350       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905535996853       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905536674661       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905536644062       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905536691089       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.220420e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905512719527       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905513786030       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905515192960       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905515647728       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905514888128       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905515832605       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905518207860       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905519095130       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905520284204       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905520849280       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905521495275       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905521322273       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905521558070       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905521089930       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.938610e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5936e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.101167e-01 1 1  ON 0
 uu_1                 1.436081e-01 1 1  ON 1
 uu_2                 4.157166e-02 1 1  ON 2
 uu_3                -2.149988e-02 1 1  ON 3
 uu_4                -6.771155e-02 1 1  ON 4
 uu_5                -1.027909e-01 1 1  ON 5
 uu_6                -1.305233e-01 1 1  ON 6
 uu_7                -1.451224e-01 1 1  ON 7
 uu_8                -1.362679e-01 1 1  ON 8
 uu_9                -1.051058e-01 1 1  ON 9
 ud_0                 4.432809e-01 1 1  ON 10
 ud_1                 1.798364e-01 1 1  ON 11
 ud_2                 6.361078e-02 1 1  ON 12
 ud_3                -5.419934e-03 1 1  ON 13
 ud_4                -6.370573e-02 1 1  ON 14
 ud_5                -1.065483e-01 1 1  ON 15
 ud_6                -1.343929e-01 1 1  ON 16
 ud_7                -1.500742e-01 1 1  ON 17
 ud_8                -1.516357e-01 1 1  ON 18
 ud_9                -1.428512e-01 1 1  ON 19
 eO_0                -7.504371e-01 1 1  ON 20
 eO_1                -4.339950e-01 1 1  ON 21
 eO_2                -2.040019e-02 1 1  ON 22
 eO_3                 2.962209e-01 1 1  ON 23
 eO_4                 5.232387e-01 1 1  ON 24
 eO_5                 4.882059e-01 1 1  ON 25
 eO_6                 2.614086e-01 1 1  ON 26
 eO_7                -4.100602e-02 1 1  ON 27
 eO_8                -2.292291e-01 1 1  ON 28
 eO_9                -9.172251e-02 1 1  ON 29
eH1_0                -2.486076e-01 1 1  ON 30
eH1_1                -1.493146e-01 1 1  ON 31
eH1_2                -1.034929e-01 1 1  ON 32
eH1_3                -4.907376e-02 1 1  ON 33
eH1_4                 5.345500e-04 1 1  ON 34
eH1_5                 3.821871e-02 1 1  ON 35
eH1_6                 9.785939e-02 1 1  ON 36
eH1_7                 1.566423e-01 1 1  ON 37
eH1_8                 1.841173e-01 1 1  ON 38
eH1_9                 7.672911e-02 1 1  ON 39
eH2_0                -2.438098e-01 1 1  ON 40
eH2_1                -1.443127e-01 1 1  ON 41
eH2_2                -9.854973e-02 1 1  ON 42
eH2_3                -4.391361e-02 1 1  ON 43
eH2_4                 5.270701e-03 1 1  ON 44
eH2_5                 4.062557e-02 1 1  ON 45
eH2_6                 1.008443e-01 1 1  ON 46
eH2_7                 1.586359e-01 1 1  ON 47
eH2_8                 1.863734e-01 1 1  ON 48
eH2_9                 5.912197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9716
    reference variance = 0.262411
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3478e-01
  Total weights = 2.0000e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334942963559
                                         uncertainty =       0.003598732149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334942963559
                                         uncertainty =       0.003598732149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409173685
  error estimate for blocks of size 2^( 2) =       0.000422275927
  error estimate for blocks of size 2^( 3) =       0.000434383688
  error estimate for blocks of size 2^( 4) =       0.000446775557
  error estimate for blocks of size 2^( 5) =       0.000457167293
  error estimate for blocks of size 2^( 6) =       0.000464359702
  error estimate for blocks of size 2^( 7) =       0.000469584638

      target function =                  N/A
              le_mean =     -16.905380505576
             les_mean =     286.126736079898
             stat err =       0.000459471797
             autocorr =       1.260962954425
              std dev =       0.578658974710
             le_variance =       0.334846209012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335161241150
                                         uncertainty =       0.003595406440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335161241150
                                         uncertainty =       0.003595406440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409306767
  error estimate for blocks of size 2^( 2) =       0.000422419490
  error estimate for blocks of size 2^( 3) =       0.000434509092
  error estimate for blocks of size 2^( 4) =       0.000446851851
  error estimate for blocks of size 2^( 5) =       0.000457190530
  error estimate for blocks of size 2^( 6) =       0.000464282404
  error estimate for blocks of size 2^( 7) =       0.000469469184

      target function =                  N/A
              le_mean =     -16.905385843143
             les_mean =     286.127134396995
             stat err =       0.000459448492
             autocorr =       1.260015280582
              std dev =       0.578847181023
             le_variance =       0.335064058978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334852928993
                                         uncertainty =       0.003593984631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334852928993
                                         uncertainty =       0.003593984631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409118460
  error estimate for blocks of size 2^( 2) =       0.000422255962
  error estimate for blocks of size 2^( 3) =       0.000434384084
  error estimate for blocks of size 2^( 4) =       0.000446768096
  error estimate for blocks of size 2^( 5) =       0.000457151740
  error estimate for blocks of size 2^( 6) =       0.000464275369
  error estimate for blocks of size 2^( 7) =       0.000469480064

      target function =                  N/A
              le_mean =     -16.905386331806
             les_mean =     286.126842689237
             stat err =       0.000459418817
             autocorr =       1.261012542795
              std dev =       0.578580875086
             le_variance =       0.334755829016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334720317673
                                         uncertainty =       0.003595886269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334720317673
                                         uncertainty =       0.003595886269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409037603
  error estimate for blocks of size 2^( 2) =       0.000422151011
  error estimate for blocks of size 2^( 3) =       0.000434269877
  error estimate for blocks of size 2^( 4) =       0.000446666488
  error estimate for blocks of size 2^( 5) =       0.000457066204
  error estimate for blocks of size 2^( 6) =       0.000464249149
  error estimate for blocks of size 2^( 7) =       0.000469476427

      target function =                  N/A
              le_mean =     -16.905375674164
             les_mean =     286.126350038867
             stat err =       0.000459364567
             autocorr =       1.261213223459
              std dev =       0.578466525869
             le_variance =       0.334623521551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905380505576        initial
     3.9062e-03     3.9062e-02             5.0422e-02       -16.905385843143
     1.5625e-02     1.5625e-01             1.2204e-02       -16.905386331806  <--
     6.2500e-02     6.2500e-01             2.9386e-03       -16.905375674164

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 2.9840e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.101167e-01 1 1  ON 0
 uu_1                 1.436081e-01 1 1  ON 1
 uu_2                 4.157166e-02 1 1  ON 2
 uu_3                -2.149988e-02 1 1  ON 3
 uu_4                -6.771155e-02 1 1  ON 4
 uu_5                -1.027909e-01 1 1  ON 5
 uu_6                -1.305233e-01 1 1  ON 6
 uu_7                -1.451224e-01 1 1  ON 7
 uu_8                -1.362679e-01 1 1  ON 8
 uu_9                -1.051058e-01 1 1  ON 9
 ud_0                 4.432809e-01 1 1  ON 10
 ud_1                 1.798364e-01 1 1  ON 11
 ud_2                 6.361078e-02 1 1  ON 12
 ud_3                -5.419934e-03 1 1  ON 13
 ud_4                -6.370573e-02 1 1  ON 14
 ud_5                -1.065483e-01 1 1  ON 15
 ud_6                -1.343929e-01 1 1  ON 16
 ud_7                -1.500742e-01 1 1  ON 17
 ud_8                -1.516357e-01 1 1  ON 18
 ud_9                -1.428512e-01 1 1  ON 19
 eO_0                -7.504371e-01 1 1  ON 20
 eO_1                -4.339950e-01 1 1  ON 21
 eO_2                -2.040019e-02 1 1  ON 22
 eO_3                 2.962209e-01 1 1  ON 23
 eO_4                 5.232387e-01 1 1  ON 24
 eO_5                 4.882059e-01 1 1  ON 25
 eO_6                 2.614086e-01 1 1  ON 26
 eO_7                -4.100602e-02 1 1  ON 27
 eO_8                -2.292291e-01 1 1  ON 28
 eO_9                -9.172251e-02 1 1  ON 29
eH1_0                -2.486076e-01 1 1  ON 30
eH1_1                -1.493146e-01 1 1  ON 31
eH1_2                -1.034929e-01 1 1  ON 32
eH1_3                -4.907376e-02 1 1  ON 33
eH1_4                 5.345500e-04 1 1  ON 34
eH1_5                 3.821871e-02 1 1  ON 35
eH1_6                 9.785939e-02 1 1  ON 36
eH1_7                 1.566423e-01 1 1  ON 37
eH1_8                 1.841173e-01 1 1  ON 38
eH1_9                 7.672911e-02 1 1  ON 39
eH2_0                -2.438098e-01 1 1  ON 40
eH2_1                -1.443127e-01 1 1  ON 41
eH2_2                -9.854973e-02 1 1  ON 42
eH2_3                -4.391361e-02 1 1  ON 43
eH2_4                 5.270701e-03 1 1  ON 44
eH2_5                 4.062557e-02 1 1  ON 45
eH2_6                 1.008443e-01 1 1  ON 46
eH2_7                 1.586359e-01 1 1  ON 47
eH2_8                 1.863734e-01 1 1  ON 48
eH2_9                 5.912197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5791e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9334
    reference variance = 0.203764
====================================================
  Execution time = 2.0548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334570484978
                                         uncertainty =       0.003544004089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334570484978
                                         uncertainty =       0.003544004089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409032711
  error estimate for blocks of size 2^( 2) =       0.000421692446
  error estimate for blocks of size 2^( 3) =       0.000434680288
  error estimate for blocks of size 2^( 4) =       0.000447045089
  error estimate for blocks of size 2^( 5) =       0.000458395590
  error estimate for blocks of size 2^( 6) =       0.000464691029
  error estimate for blocks of size 2^( 7) =       0.000468867310

      target function =                  N/A
              le_mean =     -16.906250006622
             les_mean =     286.155904636801
             stat err =       0.000459749755
             autocorr =       1.263359442678
              std dev =       0.578459607654
             le_variance =       0.334615517687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625000662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906250006622       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906252744473       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906254537031       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906259812315       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906260946678       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906259689927       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906259174166       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906260594931       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906268144152       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906267076979       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906267858485       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906268240281       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906271775270       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906276317120       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906281910978       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906283789239       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906286214056       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906288029499       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906286639789       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906288581821       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906288399950       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906288902610       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906287863960       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906287701956       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906287421508       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906287765675       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 3.576515e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906250006622       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906252469250       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906253732202       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906258783865       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906259489069       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906258081500       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906257669149       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906258518752       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906263843191       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906262873677       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906262815845       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906262213610       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906263036827       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906263778262       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906265144031       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906265215730       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906265881242       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 9.194075e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906250006622       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906251763006       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906252029738       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256392147       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906255978533       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906254756286       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906254703189       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906254788768       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906257070977       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906256478648       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906256415338       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906256033630       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906256261659       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.347621e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.098216e-01 1 1  ON 0
 uu_1                 1.425690e-01 1 1  ON 1
 uu_2                 4.071741e-02 1 1  ON 2
 uu_3                -2.196085e-02 1 1  ON 3
 uu_4                -6.818972e-02 1 1  ON 4
 uu_5                -1.034376e-01 1 1  ON 5
 uu_6                -1.319343e-01 1 1  ON 6
 uu_7                -1.462998e-01 1 1  ON 7
 uu_8                -1.391309e-01 1 1  ON 8
 uu_9                -1.069553e-01 1 1  ON 9
 ud_0                 4.451025e-01 1 1  ON 10
 ud_1                 1.814695e-01 1 1  ON 11
 ud_2                 6.528447e-02 1 1  ON 12
 ud_3                -3.800850e-03 1 1  ON 13
 ud_4                -6.277675e-02 1 1  ON 14
 ud_5                -1.062643e-01 1 1  ON 15
 ud_6                -1.348532e-01 1 1  ON 16
 ud_7                -1.512823e-01 1 1  ON 17
 ud_8                -1.515113e-01 1 1  ON 18
 ud_9                -1.431205e-01 1 1  ON 19
 eO_0                -7.488514e-01 1 1  ON 20
 eO_1                -4.324253e-01 1 1  ON 21
 eO_2                -1.897268e-02 1 1  ON 22
 eO_3                 2.974114e-01 1 1  ON 23
 eO_4                 5.274551e-01 1 1  ON 24
 eO_5                 4.935264e-01 1 1  ON 25
 eO_6                 2.630491e-01 1 1  ON 26
 eO_7                -4.139123e-02 1 1  ON 27
 eO_8                -2.362551e-01 1 1  ON 28
 eO_9                -1.003188e-01 1 1  ON 29
eH1_0                -2.516261e-01 1 1  ON 30
eH1_1                -1.519025e-01 1 1  ON 31
eH1_2                -1.060564e-01 1 1  ON 32
eH1_3                -5.159013e-02 1 1  ON 33
eH1_4                -2.363993e-03 1 1  ON 34
eH1_5                 3.498533e-02 1 1  ON 35
eH1_6                 9.605059e-02 1 1  ON 36
eH1_7                 1.568138e-01 1 1  ON 37
eH1_8                 1.913047e-01 1 1  ON 38
eH1_9                 8.592318e-02 1 1  ON 39
eH2_0                -2.463835e-01 1 1  ON 40
eH2_1                -1.468955e-01 1 1  ON 41
eH2_2                -1.008857e-01 1 1  ON 42
eH2_3                -4.616383e-02 1 1  ON 43
eH2_4                 3.405017e-03 1 1  ON 44
eH2_5                 4.015131e-02 1 1  ON 45
eH2_6                 1.008019e-01 1 1  ON 46
eH2_7                 1.581749e-01 1 1  ON 47
eH2_8                 1.908147e-01 1 1  ON 48
eH2_9                 6.781845e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8813
    reference variance = 0.233412
====================================================
  Execution time = 2.0497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3676e-01
  Total weights = 2.0000e+06
  Execution time = 2.4911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336562629812
                                         uncertainty =       0.002907370466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336562629812
                                         uncertainty =       0.002907370466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410168061
  error estimate for blocks of size 2^( 2) =       0.000423313909
  error estimate for blocks of size 2^( 3) =       0.000436794114
  error estimate for blocks of size 2^( 4) =       0.000449510102
  error estimate for blocks of size 2^( 5) =       0.000460108049
  error estimate for blocks of size 2^( 6) =       0.000469103398
  error estimate for blocks of size 2^( 7) =       0.000473348884

      target function =                  N/A
              le_mean =     -16.905803269970
             les_mean =     286.142659710569
             stat err =       0.000463017608
             autocorr =       1.274298981437
              std dev =       0.580065234159
             le_variance =       0.336475675879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923225999
                                         uncertainty =       0.002908807212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336923225999
                                         uncertainty =       0.002908807212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410387847
  error estimate for blocks of size 2^( 2) =       0.000423523739
  error estimate for blocks of size 2^( 3) =       0.000436975330
  error estimate for blocks of size 2^( 4) =       0.000449638407
  error estimate for blocks of size 2^( 5) =       0.000460182285
  error estimate for blocks of size 2^( 6) =       0.000469129592
  error estimate for blocks of size 2^( 7) =       0.000473337026

      target function =                  N/A
              le_mean =     -16.905804750459
             les_mean =     286.143070462008
             stat err =       0.000463071827
             autocorr =       1.273232564033
              std dev =       0.580376058941
             le_variance =       0.336836369792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337159736897
                                         uncertainty =       0.002909590288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337159736897
                                         uncertainty =       0.002909590288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410531922
  error estimate for blocks of size 2^( 2) =       0.000423675174
  error estimate for blocks of size 2^( 3) =       0.000437129226
  error estimate for blocks of size 2^( 4) =       0.000449788175
  error estimate for blocks of size 2^( 5) =       0.000460342060
  error estimate for blocks of size 2^( 6) =       0.000469307909
  error estimate for blocks of size 2^( 7) =       0.000473515942

      target function =                  N/A
              le_mean =     -16.905802755289
             les_mean =     286.143239549940
             stat err =       0.000463238521
             autocorr =       1.273255228870
              std dev =       0.580579811681
             le_variance =       0.337072917732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336758570128
                                         uncertainty =       0.002908897154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336758570128
                                         uncertainty =       0.002908897154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410287461
  error estimate for blocks of size 2^( 2) =       0.000423430454
  error estimate for blocks of size 2^( 3) =       0.000436903853
  error estimate for blocks of size 2^( 4) =       0.000449604850
  error estimate for blocks of size 2^( 5) =       0.000460191955
  error estimate for blocks of size 2^( 6) =       0.000469183524
  error estimate for blocks of size 2^( 7) =       0.000473416657

      target function =                  N/A
              le_mean =     -16.905796890675
             les_mean =     286.142639940986
             stat err =       0.000463099246
             autocorr =       1.274006549600
              std dev =       0.580234091184
             le_variance =       0.336671600572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905803269970        initial
     3.9062e-03     3.9062e-02             3.5765e-02       -16.905804750459  <--
     1.5625e-02     1.5625e-01             9.1941e-03       -16.905802755289
     6.2500e-02     6.2500e-01             2.3476e-03       -16.905796890675

*****************************************************************************
Applying the update for shift_i =   3.9062e-03     and shift_s =   3.9062e-02
*****************************************************************************

  Execution time = 3.1019e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.070948e-01 1 1  ON 0
 uu_1                 1.397757e-01 1 1  ON 1
 uu_2                 3.792887e-02 1 1  ON 2
 uu_3                -2.474771e-02 1 1  ON 3
 uu_4                -7.102573e-02 1 1  ON 4
 uu_5                -1.064492e-01 1 1  ON 5
 uu_6                -1.351369e-01 1 1  ON 6
 uu_7                -1.497985e-01 1 1  ON 7
 uu_8                -1.431027e-01 1 1  ON 8
 uu_9                -1.106618e-01 1 1  ON 9
 ud_0                 4.476558e-01 1 1  ON 10
 ud_1                 1.839637e-01 1 1  ON 11
 ud_2                 6.776155e-02 1 1  ON 12
 ud_3                -1.391452e-03 1 1  ON 13
 ud_4                -6.052906e-02 1 1  ON 14
 ud_5                -1.043154e-01 1 1  ON 15
 ud_6                -1.333437e-01 1 1  ON 16
 ud_7                -1.502440e-01 1 1  ON 17
 ud_8                -1.507432e-01 1 1  ON 18
 ud_9                -1.414292e-01 1 1  ON 19
 eO_0                -7.407771e-01 1 1  ON 20
 eO_1                -4.244105e-01 1 1  ON 21
 eO_2                -1.091791e-02 1 1  ON 22
 eO_3                 3.053667e-01 1 1  ON 23
 eO_4                 5.353085e-01 1 1  ON 24
 eO_5                 5.007649e-01 1 1  ON 25
 eO_6                 2.667710e-01 1 1  ON 26
 eO_7                -4.517203e-02 1 1  ON 27
 eO_8                -2.545539e-01 1 1  ON 28
 eO_9                -1.259720e-01 1 1  ON 29
eH1_0                -2.590661e-01 1 1  ON 30
eH1_1                -1.593762e-01 1 1  ON 31
eH1_2                -1.134865e-01 1 1  ON 32
eH1_3                -5.884733e-02 1 1  ON 33
eH1_4                -9.423604e-03 1 1  ON 34
eH1_5                 2.864932e-02 1 1  ON 35
eH1_6                 9.198219e-02 1 1  ON 36
eH1_7                 1.572706e-01 1 1  ON 37
eH1_8                 2.035027e-01 1 1  ON 38
eH1_9                 1.124943e-01 1 1  ON 39
eH2_0                -2.528125e-01 1 1  ON 40
eH2_1                -1.527730e-01 1 1  ON 41
eH2_2                -1.068166e-01 1 1  ON 42
eH2_3                -5.182687e-02 1 1  ON 43
eH2_4                -1.892610e-03 1 1  ON 44
eH2_5                 3.584322e-02 1 1  ON 45
eH2_6                 9.835800e-02 1 1  ON 46
eH2_7                 1.598586e-01 1 1  ON 47
eH2_8                 2.007947e-01 1 1  ON 48
eH2_9                 9.285312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8839
    reference variance = 0.235187
====================================================
  Execution time = 2.0836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4229e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342406999789
                                         uncertainty =       0.006045433027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342406999789
                                         uncertainty =       0.006045433027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413695043
  error estimate for blocks of size 2^( 2) =       0.000425829642
  error estimate for blocks of size 2^( 3) =       0.000438123207
  error estimate for blocks of size 2^( 4) =       0.000448955888
  error estimate for blocks of size 2^( 5) =       0.000458070821
  error estimate for blocks of size 2^( 6) =       0.000465229920
  error estimate for blocks of size 2^( 7) =       0.000470554488

      target function =                  N/A
              le_mean =     -16.906026171628
             les_mean =     286.156007921850
             stat err =       0.000460702779
             autocorr =       1.240169454418
              std dev =       0.585053140507
             le_variance =       0.342287177217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602617163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-04, overlap shift 9.7656e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026171628       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032771073       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906035845084       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906037714426       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906038981453       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043960718       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906048147115       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906045554111       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906051924591       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906055903748       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906058799322       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906062653942       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906069545732       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906072426414       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906072027920       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906076751667       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906079607297       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906094110342       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906110459864       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906122188821       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906134768216       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906140248410       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906140883092       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906145423581       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906144964897       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906146351926       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906145894387       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906147611611       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906147977590       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906148032287       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906147008043       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906148762398       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-04 is 1.203438e-01

solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026171628       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032621861       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906035608668       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906037394168       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906038537027       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043154229       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906047062846       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906044511098       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906050518421       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906053703815       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906056228596       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906058302132       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906062713067       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906063600401       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906062639927       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906064635586       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906065149178       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906070370901       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906073695900       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906076399585       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906078719831       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906079871254       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906079716483       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906080592357       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906080056590       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906080169475       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 3.706662e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026171628       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906032086891       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906034801310       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906036325261       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906037093041       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040592775       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043673879       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906041423642       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906046258384       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906047470561       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906049224864       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906048621332       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906049844330       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906049755304       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906049043767       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906049402499       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906049334551       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906050289996       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906050355669       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906050591360       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.009554e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6334e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.053358e-01 1 1  ON 0
 uu_1                 1.385413e-01 1 1  ON 1
 uu_2                 3.676110e-02 1 1  ON 2
 uu_3                -2.617721e-02 1 1  ON 3
 uu_4                -7.276845e-02 1 1  ON 4
 uu_5                -1.089633e-01 1 1  ON 5
 uu_6                -1.383294e-01 1 1  ON 6
 uu_7                -1.544563e-01 1 1  ON 7
 uu_8                -1.492633e-01 1 1  ON 8
 uu_9                -1.212885e-01 1 1  ON 9
 ud_0                 4.515903e-01 1 1  ON 10
 ud_1                 1.876984e-01 1 1  ON 11
 ud_2                 7.128245e-02 1 1  ON 12
 ud_3                 1.808324e-03 1 1  ON 13
 ud_4                -5.689923e-02 1 1  ON 14
 ud_5                -1.002173e-01 1 1  ON 15
 ud_6                -1.296419e-01 1 1  ON 16
 ud_7                -1.480404e-01 1 1  ON 17
 ud_8                -1.523092e-01 1 1  ON 18
 ud_9                -1.475901e-01 1 1  ON 19
 eO_0                -7.276141e-01 1 1  ON 20
 eO_1                -4.112019e-01 1 1  ON 21
 eO_2                 2.581656e-03 1 1  ON 22
 eO_3                 3.196344e-01 1 1  ON 23
 eO_4                 5.448255e-01 1 1  ON 24
 eO_5                 5.074494e-01 1 1  ON 25
 eO_6                 2.703359e-01 1 1  ON 26
 eO_7                -4.836398e-02 1 1  ON 27
 eO_8                -2.802244e-01 1 1  ON 28
 eO_9                -1.630386e-01 1 1  ON 29
eH1_0                -2.664286e-01 1 1  ON 30
eH1_1                -1.672673e-01 1 1  ON 31
eH1_2                -1.211136e-01 1 1  ON 32
eH1_3                -6.599938e-02 1 1  ON 33
eH1_4                -1.541311e-02 1 1  ON 34
eH1_5                 2.196314e-02 1 1  ON 35
eH1_6                 8.850738e-02 1 1  ON 36
eH1_7                 1.548443e-01 1 1  ON 37
eH1_8                 2.130176e-01 1 1  ON 38
eH1_9                 1.478780e-01 1 1  ON 39
eH2_0                -2.630226e-01 1 1  ON 40
eH2_1                -1.628151e-01 1 1  ON 41
eH2_2                -1.169543e-01 1 1  ON 42
eH2_3                -6.242893e-02 1 1  ON 43
eH2_4                -1.119349e-02 1 1  ON 44
eH2_5                 2.891840e-02 1 1  ON 45
eH2_6                 9.554039e-02 1 1  ON 46
eH2_7                 1.633246e-01 1 1  ON 47
eH2_8                 2.184641e-01 1 1  ON 48
eH2_9                 1.288281e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.88
    reference variance = 0.307174
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4208e-01
  Total weights = 2.0000e+06
  Execution time = 1.8909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341607837793
                                         uncertainty =       0.004572448188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341607837793
                                         uncertainty =       0.004572448188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413588387
  error estimate for blocks of size 2^( 2) =       0.000426490938
  error estimate for blocks of size 2^( 3) =       0.000439685704
  error estimate for blocks of size 2^( 4) =       0.000452706034
  error estimate for blocks of size 2^( 5) =       0.000462595246
  error estimate for blocks of size 2^( 6) =       0.000470266031
  error estimate for blocks of size 2^( 7) =       0.000475655706

      target function =                  N/A
              le_mean =     -16.906074549504
             les_mean =     286.157467210164
             stat err =       0.000465305754
             autocorr =       1.265727379254
              std dev =       0.584902306241
             le_variance =       0.342110707846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341250737036
                                         uncertainty =       0.004565132205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341250737036
                                         uncertainty =       0.004565132205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413372142
  error estimate for blocks of size 2^( 2) =       0.000426205026
  error estimate for blocks of size 2^( 3) =       0.000439318816
  error estimate for blocks of size 2^( 4) =       0.000452250769
  error estimate for blocks of size 2^( 5) =       0.000462125546
  error estimate for blocks of size 2^( 6) =       0.000469744609
  error estimate for blocks of size 2^( 7) =       0.000475130830

      target function =                  N/A
              le_mean =     -16.906061242132
             les_mean =     286.156659606953
             stat err =       0.000464812938
             autocorr =       1.264369488669
              std dev =       0.584596489128
             le_variance =       0.341753055101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341639621607
                                         uncertainty =       0.004566534094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341639621607
                                         uncertainty =       0.004566534094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413606898
  error estimate for blocks of size 2^( 2) =       0.000426436207
  error estimate for blocks of size 2^( 3) =       0.000439542088
  error estimate for blocks of size 2^( 4) =       0.000452476897
  error estimate for blocks of size 2^( 5) =       0.000462387620
  error estimate for blocks of size 2^( 6) =       0.000470042769
  error estimate for blocks of size 2^( 7) =       0.000475459118

      target function =                  N/A
              le_mean =     -16.906063471345
             les_mean =     286.157123258795
             stat err =       0.000465091601
             autocorr =       1.264449376227
              std dev =       0.584928485137
             le_variance =       0.342141332725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341517773577
                                         uncertainty =       0.004568393847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341517773577
                                         uncertainty =       0.004568393847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413533774
  error estimate for blocks of size 2^( 2) =       0.000426408883
  error estimate for blocks of size 2^( 3) =       0.000439573029
  error estimate for blocks of size 2^( 4) =       0.000452570887
  error estimate for blocks of size 2^( 5) =       0.000462477364
  error estimate for blocks of size 2^( 6) =       0.000470150662
  error estimate for blocks of size 2^( 7) =       0.000475557314

      target function =                  N/A
              le_mean =     -16.906053856206
             les_mean =     286.156677181986
             stat err =       0.000465189057
             autocorr =       1.265426747520
              std dev =       0.584825071324
             le_variance =       0.342020364049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906074549504        initial  <--
     9.7656e-04     9.7656e-03             1.2034e-01       -16.906061242132
     3.9062e-03     3.9062e-02             3.7067e-02       -16.906063471345
     1.5625e-02     1.5625e-01             1.0096e-02       -16.906053856206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8379
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.070948e-01 1 1  ON 0
 uu_1                 1.397757e-01 1 1  ON 1
 uu_2                 3.792887e-02 1 1  ON 2
 uu_3                -2.474771e-02 1 1  ON 3
 uu_4                -7.102573e-02 1 1  ON 4
 uu_5                -1.064492e-01 1 1  ON 5
 uu_6                -1.351369e-01 1 1  ON 6
 uu_7                -1.497985e-01 1 1  ON 7
 uu_8                -1.431027e-01 1 1  ON 8
 uu_9                -1.106618e-01 1 1  ON 9
 ud_0                 4.476558e-01 1 1  ON 10
 ud_1                 1.839637e-01 1 1  ON 11
 ud_2                 6.776155e-02 1 1  ON 12
 ud_3                -1.391452e-03 1 1  ON 13
 ud_4                -6.052906e-02 1 1  ON 14
 ud_5                -1.043154e-01 1 1  ON 15
 ud_6                -1.333437e-01 1 1  ON 16
 ud_7                -1.502440e-01 1 1  ON 17
 ud_8                -1.507432e-01 1 1  ON 18
 ud_9                -1.414292e-01 1 1  ON 19
 eO_0                -7.407771e-01 1 1  ON 20
 eO_1                -4.244105e-01 1 1  ON 21
 eO_2                -1.091791e-02 1 1  ON 22
 eO_3                 3.053667e-01 1 1  ON 23
 eO_4                 5.353085e-01 1 1  ON 24
 eO_5                 5.007649e-01 1 1  ON 25
 eO_6                 2.667710e-01 1 1  ON 26
 eO_7                -4.517203e-02 1 1  ON 27
 eO_8                -2.545539e-01 1 1  ON 28
 eO_9                -1.259720e-01 1 1  ON 29
eH1_0                -2.590661e-01 1 1  ON 30
eH1_1                -1.593762e-01 1 1  ON 31
eH1_2                -1.134865e-01 1 1  ON 32
eH1_3                -5.884733e-02 1 1  ON 33
eH1_4                -9.423604e-03 1 1  ON 34
eH1_5                 2.864932e-02 1 1  ON 35
eH1_6                 9.198219e-02 1 1  ON 36
eH1_7                 1.572706e-01 1 1  ON 37
eH1_8                 2.035027e-01 1 1  ON 38
eH1_9                 1.124943e-01 1 1  ON 39
eH2_0                -2.528125e-01 1 1  ON 40
eH2_1                -1.527730e-01 1 1  ON 41
eH2_2                -1.068166e-01 1 1  ON 42
eH2_3                -5.182687e-02 1 1  ON 43
eH2_4                -1.892610e-03 1 1  ON 44
eH2_5                 3.584322e-02 1 1  ON 45
eH2_6                 9.835800e-02 1 1  ON 46
eH2_7                 1.598586e-01 1 1  ON 47
eH2_8                 2.007947e-01 1 1  ON 48
eH2_9                 9.285312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9201
    reference variance = 0.309168
====================================================
  Execution time = 2.0738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4448e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344407013587
                                         uncertainty =       0.007350418074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344407013587
                                         uncertainty =       0.007350418074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415015225
  error estimate for blocks of size 2^( 2) =       0.000427840766
  error estimate for blocks of size 2^( 3) =       0.000440697604
  error estimate for blocks of size 2^( 4) =       0.000452984737
  error estimate for blocks of size 2^( 5) =       0.000462769945
  error estimate for blocks of size 2^( 6) =       0.000468560080
  error estimate for blocks of size 2^( 7) =       0.000472475473

      target function =                  N/A
              le_mean =     -16.905887684794
             les_mean =     286.153513511986
             stat err =       0.000464197559
             autocorr =       1.251058583006
              std dev =       0.586920159277
             le_variance =       0.344475273366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588768479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887684794       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905888630809       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905889133742       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905892405318       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892971393       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905896506016       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897929239       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905900291674       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905898223412       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905899139908       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905907418059       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905908946379       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905908401938       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905905835324       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905907741002       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905908802375       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905909288590       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905909642020       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905909243463       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905909346057       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.715198e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887684794       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905888528909       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905888867230       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891700998       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892327660       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905894235081       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895059871       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905896187205       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905894272136       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905895665252       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905897074409       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905897820322       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905897018612       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905896275777       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905896671149       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.341888e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905887684794       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905888274730       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905888363876       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890120898       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890863172       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891340782       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891420546       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891701852       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905891353964       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905891351639       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905891360108       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.031865e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6268e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.066840e-01 1 1  ON 0
 uu_1                 1.395240e-01 1 1  ON 1
 uu_2                 3.779582e-02 1 1  ON 2
 uu_3                -2.529312e-02 1 1  ON 3
 uu_4                -7.112586e-02 1 1  ON 4
 uu_5                -1.072155e-01 1 1  ON 5
 uu_6                -1.358421e-01 1 1  ON 6
 uu_7                -1.501908e-01 1 1  ON 7
 uu_8                -1.436835e-01 1 1  ON 8
 uu_9                -1.119931e-01 1 1  ON 9
 ud_0                 4.484871e-01 1 1  ON 10
 ud_1                 1.844379e-01 1 1  ON 11
 ud_2                 6.783176e-02 1 1  ON 12
 ud_3                -1.440555e-03 1 1  ON 13
 ud_4                -6.013516e-02 1 1  ON 14
 ud_5                -1.036716e-01 1 1  ON 15
 ud_6                -1.326080e-01 1 1  ON 16
 ud_7                -1.502716e-01 1 1  ON 17
 ud_8                -1.509667e-01 1 1  ON 18
 ud_9                -1.422929e-01 1 1  ON 19
 eO_0                -7.404093e-01 1 1  ON 20
 eO_1                -4.233312e-01 1 1  ON 21
 eO_2                -1.014480e-02 1 1  ON 22
 eO_3                 3.070075e-01 1 1  ON 23
 eO_4                 5.357384e-01 1 1  ON 24
 eO_5                 5.000758e-01 1 1  ON 25
 eO_6                 2.692065e-01 1 1  ON 26
 eO_7                -4.471453e-02 1 1  ON 27
 eO_8                -2.565264e-01 1 1  ON 28
 eO_9                -1.295757e-01 1 1  ON 29
eH1_0                -2.604197e-01 1 1  ON 30
eH1_1                -1.609345e-01 1 1  ON 31
eH1_2                -1.145459e-01 1 1  ON 32
eH1_3                -6.009279e-02 1 1  ON 33
eH1_4                -1.050185e-02 1 1  ON 34
eH1_5                 2.700618e-02 1 1  ON 35
eH1_6                 9.183107e-02 1 1  ON 36
eH1_7                 1.584270e-01 1 1  ON 37
eH1_8                 2.046794e-01 1 1  ON 38
eH1_9                 1.168362e-01 1 1  ON 39
eH2_0                -2.531082e-01 1 1  ON 40
eH2_1                -1.533166e-01 1 1  ON 41
eH2_2                -1.071315e-01 1 1  ON 42
eH2_3                -5.217241e-02 1 1  ON 43
eH2_4                -2.476669e-03 1 1  ON 44
eH2_5                 3.423513e-02 1 1  ON 45
eH2_6                 9.676770e-02 1 1  ON 46
eH2_7                 1.605867e-01 1 1  ON 47
eH2_8                 2.016991e-01 1 1  ON 48
eH2_9                 9.681384e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.301172
====================================================
  Execution time = 2.0150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3506e-01
  Total weights = 2.0000e+06
  Execution time = 1.8891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334626918870
                                         uncertainty =       0.003629324678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334626918870
                                         uncertainty =       0.003629324678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409047168
  error estimate for blocks of size 2^( 2) =       0.000422246326
  error estimate for blocks of size 2^( 3) =       0.000435577805
  error estimate for blocks of size 2^( 4) =       0.000447761213
  error estimate for blocks of size 2^( 5) =       0.000459787561
  error estimate for blocks of size 2^( 6) =       0.000469470195
  error estimate for blocks of size 2^( 7) =       0.000476425952

      target function =                  N/A
              le_mean =     -16.905821591553
             les_mean =     286.141442689895
             stat err =       0.000463361230
             autocorr =       1.283194842858
              std dev =       0.578480053069
             le_variance =       0.334639171799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335155055275
                                         uncertainty =       0.003632696806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335155055275
                                         uncertainty =       0.003632696806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409369885
  error estimate for blocks of size 2^( 2) =       0.000422540358
  error estimate for blocks of size 2^( 3) =       0.000435836054
  error estimate for blocks of size 2^( 4) =       0.000447992557
  error estimate for blocks of size 2^( 5) =       0.000460005483
  error estimate for blocks of size 2^( 6) =       0.000469663265
  error estimate for blocks of size 2^( 7) =       0.000476587368

      target function =                  N/A
              le_mean =     -16.905826690489
             les_mean =     286.142143325990
             stat err =       0.000463562168
             autocorr =       1.282283903501
              std dev =       0.578936442743
             le_variance =       0.335167404735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335492038051
                                         uncertainty =       0.003635016284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335492038051
                                         uncertainty =       0.003635016284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409575695
  error estimate for blocks of size 2^( 2) =       0.000422735764
  error estimate for blocks of size 2^( 3) =       0.000436024030
  error estimate for blocks of size 2^( 4) =       0.000448181963
  error estimate for blocks of size 2^( 5) =       0.000460204431
  error estimate for blocks of size 2^( 6) =       0.000469867896
  error estimate for blocks of size 2^( 7) =       0.000476785337

      target function =                  N/A
              le_mean =     -16.905828426206
             les_mean =     286.142539109224
             stat err =       0.000463759907
             autocorr =       1.282088621412
              std dev =       0.579227503362
             le_variance =       0.335504500651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334954682443
                                         uncertainty =       0.003631746311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334954682443
                                         uncertainty =       0.003631746311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409247483
  error estimate for blocks of size 2^( 2) =       0.000422432525
  error estimate for blocks of size 2^( 3) =       0.000435748330
  error estimate for blocks of size 2^( 4) =       0.000447922260
  error estimate for blocks of size 2^( 5) =       0.000459946503
  error estimate for blocks of size 2^( 6) =       0.000469623838
  error estimate for blocks of size 2^( 7) =       0.000476567236

      target function =                  N/A
              le_mean =     -16.905820992219
             les_mean =     286.141750258929
             stat err =       0.000463514959
             autocorr =       1.282789731178
              std dev =       0.578763341505
             le_variance =       0.334967005470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905821591553        initial
     9.7656e-03     9.7656e-02             1.7152e-02       -16.905826690489
     3.9062e-02     3.9062e-01             4.3419e-03       -16.905828426206  <--
     1.5625e-01     1.5625e+00             1.0319e-03       -16.905820992219

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9687e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.066840e-01 1 1  ON 0
 uu_1                 1.395240e-01 1 1  ON 1
 uu_2                 3.779582e-02 1 1  ON 2
 uu_3                -2.529312e-02 1 1  ON 3
 uu_4                -7.112586e-02 1 1  ON 4
 uu_5                -1.072155e-01 1 1  ON 5
 uu_6                -1.358421e-01 1 1  ON 6
 uu_7                -1.501908e-01 1 1  ON 7
 uu_8                -1.436835e-01 1 1  ON 8
 uu_9                -1.119931e-01 1 1  ON 9
 ud_0                 4.484871e-01 1 1  ON 10
 ud_1                 1.844379e-01 1 1  ON 11
 ud_2                 6.783176e-02 1 1  ON 12
 ud_3                -1.440555e-03 1 1  ON 13
 ud_4                -6.013516e-02 1 1  ON 14
 ud_5                -1.036716e-01 1 1  ON 15
 ud_6                -1.326080e-01 1 1  ON 16
 ud_7                -1.502716e-01 1 1  ON 17
 ud_8                -1.509667e-01 1 1  ON 18
 ud_9                -1.422929e-01 1 1  ON 19
 eO_0                -7.404093e-01 1 1  ON 20
 eO_1                -4.233312e-01 1 1  ON 21
 eO_2                -1.014480e-02 1 1  ON 22
 eO_3                 3.070075e-01 1 1  ON 23
 eO_4                 5.357384e-01 1 1  ON 24
 eO_5                 5.000758e-01 1 1  ON 25
 eO_6                 2.692065e-01 1 1  ON 26
 eO_7                -4.471453e-02 1 1  ON 27
 eO_8                -2.565264e-01 1 1  ON 28
 eO_9                -1.295757e-01 1 1  ON 29
eH1_0                -2.604197e-01 1 1  ON 30
eH1_1                -1.609345e-01 1 1  ON 31
eH1_2                -1.145459e-01 1 1  ON 32
eH1_3                -6.009279e-02 1 1  ON 33
eH1_4                -1.050185e-02 1 1  ON 34
eH1_5                 2.700618e-02 1 1  ON 35
eH1_6                 9.183107e-02 1 1  ON 36
eH1_7                 1.584270e-01 1 1  ON 37
eH1_8                 2.046794e-01 1 1  ON 38
eH1_9                 1.168362e-01 1 1  ON 39
eH2_0                -2.531082e-01 1 1  ON 40
eH2_1                -1.533166e-01 1 1  ON 41
eH2_2                -1.071315e-01 1 1  ON 42
eH2_3                -5.217241e-02 1 1  ON 43
eH2_4                -2.476669e-03 1 1  ON 44
eH2_5                 3.423513e-02 1 1  ON 45
eH2_6                 9.676770e-02 1 1  ON 46
eH2_7                 1.605867e-01 1 1  ON 47
eH2_8                 2.016991e-01 1 1  ON 48
eH2_9                 9.681384e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.204402
====================================================
  Execution time = 2.0676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335552895993
                                         uncertainty =       0.003973056577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335552895993
                                         uncertainty =       0.003973056577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409607177
  error estimate for blocks of size 2^( 2) =       0.000422269972
  error estimate for blocks of size 2^( 3) =       0.000434781678
  error estimate for blocks of size 2^( 4) =       0.000446050155
  error estimate for blocks of size 2^( 5) =       0.000456075902
  error estimate for blocks of size 2^( 6) =       0.000465766956
  error estimate for blocks of size 2^( 7) =       0.000471520014

      target function =                  N/A
              le_mean =     -16.906562569598
             les_mean =     286.167413831162
             stat err =       0.000459853257
             autocorr =       1.260385557580
              std dev =       0.579272025223
             le_variance =       0.335556079206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656256960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906562569598       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906561067916       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906561967156       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906562957167       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906561807927       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906562229376       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906561733333       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906560770144       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906558567867       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906559975026       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906564655064       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906569640681       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906572141738       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906569235125       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906566429997       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906565839446       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906568412598       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906568852251       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906568770610       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906568173285       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.708533e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906562569598       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906561247778       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906562005392       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906562512872       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906561482905       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906562226731       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906561511265       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906560831924       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906559926080       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906561075170       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906562421106       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906563600065       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906563931719       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906563276071       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.301328e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906562569598       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906561675929       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906561963543       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906561482656       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906561727147       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906562286013       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906561755605       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906561748974       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906561483827       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906561689254       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.052827e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6179e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.062721e-01 1 1  ON 0
 uu_1                 1.393686e-01 1 1  ON 1
 uu_2                 3.744611e-02 1 1  ON 2
 uu_3                -2.539218e-02 1 1  ON 3
 uu_4                -7.184387e-02 1 1  ON 4
 uu_5                -1.077784e-01 1 1  ON 5
 uu_6                -1.363601e-01 1 1  ON 6
 uu_7                -1.510279e-01 1 1  ON 7
 uu_8                -1.440408e-01 1 1  ON 8
 uu_9                -1.125946e-01 1 1  ON 9
 ud_0                 4.482239e-01 1 1  ON 10
 ud_1                 1.846938e-01 1 1  ON 11
 ud_2                 6.804357e-02 1 1  ON 12
 ud_3                -1.140767e-03 1 1  ON 13
 ud_4                -5.954096e-02 1 1  ON 14
 ud_5                -1.031823e-01 1 1  ON 15
 ud_6                -1.319434e-01 1 1  ON 16
 ud_7                -1.503800e-01 1 1  ON 17
 ud_8                -1.518674e-01 1 1  ON 18
 ud_9                -1.414015e-01 1 1  ON 19
 eO_0                -7.395148e-01 1 1  ON 20
 eO_1                -4.224766e-01 1 1  ON 21
 eO_2                -9.006520e-03 1 1  ON 22
 eO_3                 3.075113e-01 1 1  ON 23
 eO_4                 5.358608e-01 1 1  ON 24
 eO_5                 5.009848e-01 1 1  ON 25
 eO_6                 2.706436e-01 1 1  ON 26
 eO_7                -4.580701e-02 1 1  ON 27
 eO_8                -2.583410e-01 1 1  ON 28
 eO_9                -1.319073e-01 1 1  ON 29
eH1_0                -2.610186e-01 1 1  ON 30
eH1_1                -1.611866e-01 1 1  ON 31
eH1_2                -1.150587e-01 1 1  ON 32
eH1_3                -6.034832e-02 1 1  ON 33
eH1_4                -1.103607e-02 1 1  ON 34
eH1_5                 2.635091e-02 1 1  ON 35
eH1_6                 9.031163e-02 1 1  ON 36
eH1_7                 1.562238e-01 1 1  ON 37
eH1_8                 2.055670e-01 1 1  ON 38
eH1_9                 1.210292e-01 1 1  ON 39
eH2_0                -2.538368e-01 1 1  ON 40
eH2_1                -1.540512e-01 1 1  ON 41
eH2_2                -1.079749e-01 1 1  ON 42
eH2_3                -5.360566e-02 1 1  ON 43
eH2_4                -3.778380e-03 1 1  ON 44
eH2_5                 3.269206e-02 1 1  ON 45
eH2_6                 9.647141e-02 1 1  ON 46
eH2_7                 1.611157e-01 1 1  ON 47
eH2_8                 2.028924e-01 1 1  ON 48
eH2_9                 1.011152e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9524
    reference variance = 0.209064
====================================================
  Execution time = 2.0456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4465e-01
  Total weights = 2.0000e+06
  Execution time = 1.8923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345104099846
                                         uncertainty =       0.006888767608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345104099846
                                         uncertainty =       0.006888767608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415410037
  error estimate for blocks of size 2^( 2) =       0.000427984569
  error estimate for blocks of size 2^( 3) =       0.000440837960
  error estimate for blocks of size 2^( 4) =       0.000452197477
  error estimate for blocks of size 2^( 5) =       0.000462547829
  error estimate for blocks of size 2^( 6) =       0.000469448579
  error estimate for blocks of size 2^( 7) =       0.000475809926

      target function =                  N/A
              le_mean =     -16.906223597546
             les_mean =     286.165527154933
             stat err =       0.000465000953
             autocorr =       1.253007628875
              std dev =       0.587478507928
             le_variance =       0.345130997278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344604684863
                                         uncertainty =       0.006866236752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344604684863
                                         uncertainty =       0.006866236752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415109487
  error estimate for blocks of size 2^( 2) =       0.000427686416
  error estimate for blocks of size 2^( 3) =       0.000440543721
  error estimate for blocks of size 2^( 4) =       0.000451899103
  error estimate for blocks of size 2^( 5) =       0.000462251201
  error estimate for blocks of size 2^( 6) =       0.000469148960
  error estimate for blocks of size 2^( 7) =       0.000475510130

      target function =                  N/A
              le_mean =     -16.906222062612
             les_mean =     286.164976030329
             stat err =       0.000464702348
             autocorr =       1.253211630091
              std dev =       0.587053466310
             le_variance =       0.344631772306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344159699984
                                         uncertainty =       0.006848069519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344159699984
                                         uncertainty =       0.006848069519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414841445
  error estimate for blocks of size 2^( 2) =       0.000427428732
  error estimate for blocks of size 2^( 3) =       0.000440300052
  error estimate for blocks of size 2^( 4) =       0.000451667481
  error estimate for blocks of size 2^( 5) =       0.000462028515
  error estimate for blocks of size 2^( 6) =       0.000468943870
  error estimate for blocks of size 2^( 7) =       0.000475320874

      target function =                  N/A
              le_mean =     -16.906224950300
             les_mean =     286.164628746840
             stat err =       0.000464490185
             autocorr =       1.253686086731
              std dev =       0.586674397593
             le_variance =       0.344186848791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344768870853
                                         uncertainty =       0.006873261843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344768870853
                                         uncertainty =       0.006873261843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415208312
  error estimate for blocks of size 2^( 2) =       0.000427787791
  error estimate for blocks of size 2^( 3) =       0.000440647784
  error estimate for blocks of size 2^( 4) =       0.000452010872
  error estimate for blocks of size 2^( 5) =       0.000462365553
  error estimate for blocks of size 2^( 6) =       0.000469272346
  error estimate for blocks of size 2^( 7) =       0.000475639352

      target function =                  N/A
              le_mean =     -16.906222323141
             les_mean =     286.165148951247
             stat err =       0.000464822031
             autocorr =       1.253260437898
              std dev =       0.587193225592
             le_variance =       0.344795884181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906223597546        initial
     9.7656e-03     9.7656e-02             1.7085e-02       -16.906222062612
     3.9062e-02     3.9062e-01             4.3013e-03       -16.906224950300  <--
     1.5625e-01     1.5625e+00             1.0528e-03       -16.906222323141

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.0017e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.062721e-01 1 1  ON 0
 uu_1                 1.393686e-01 1 1  ON 1
 uu_2                 3.744611e-02 1 1  ON 2
 uu_3                -2.539218e-02 1 1  ON 3
 uu_4                -7.184387e-02 1 1  ON 4
 uu_5                -1.077784e-01 1 1  ON 5
 uu_6                -1.363601e-01 1 1  ON 6
 uu_7                -1.510279e-01 1 1  ON 7
 uu_8                -1.440408e-01 1 1  ON 8
 uu_9                -1.125946e-01 1 1  ON 9
 ud_0                 4.482239e-01 1 1  ON 10
 ud_1                 1.846938e-01 1 1  ON 11
 ud_2                 6.804357e-02 1 1  ON 12
 ud_3                -1.140767e-03 1 1  ON 13
 ud_4                -5.954096e-02 1 1  ON 14
 ud_5                -1.031823e-01 1 1  ON 15
 ud_6                -1.319434e-01 1 1  ON 16
 ud_7                -1.503800e-01 1 1  ON 17
 ud_8                -1.518674e-01 1 1  ON 18
 ud_9                -1.414015e-01 1 1  ON 19
 eO_0                -7.395148e-01 1 1  ON 20
 eO_1                -4.224766e-01 1 1  ON 21
 eO_2                -9.006520e-03 1 1  ON 22
 eO_3                 3.075113e-01 1 1  ON 23
 eO_4                 5.358608e-01 1 1  ON 24
 eO_5                 5.009848e-01 1 1  ON 25
 eO_6                 2.706436e-01 1 1  ON 26
 eO_7                -4.580701e-02 1 1  ON 27
 eO_8                -2.583410e-01 1 1  ON 28
 eO_9                -1.319073e-01 1 1  ON 29
eH1_0                -2.610186e-01 1 1  ON 30
eH1_1                -1.611866e-01 1 1  ON 31
eH1_2                -1.150587e-01 1 1  ON 32
eH1_3                -6.034832e-02 1 1  ON 33
eH1_4                -1.103607e-02 1 1  ON 34
eH1_5                 2.635091e-02 1 1  ON 35
eH1_6                 9.031163e-02 1 1  ON 36
eH1_7                 1.562238e-01 1 1  ON 37
eH1_8                 2.055670e-01 1 1  ON 38
eH1_9                 1.210292e-01 1 1  ON 39
eH2_0                -2.538368e-01 1 1  ON 40
eH2_1                -1.540512e-01 1 1  ON 41
eH2_2                -1.079749e-01 1 1  ON 42
eH2_3                -5.360566e-02 1 1  ON 43
eH2_4                -3.778380e-03 1 1  ON 44
eH2_5                 3.269206e-02 1 1  ON 45
eH2_6                 9.647141e-02 1 1  ON 46
eH2_7                 1.611157e-01 1 1  ON 47
eH2_8                 2.028924e-01 1 1  ON 48
eH2_9                 1.011152e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9697
    reference variance = 0.250962
====================================================
  Execution time = 2.0710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333323276759
                                         uncertainty =       0.003551190088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333323276759
                                         uncertainty =       0.003551190088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408181673
  error estimate for blocks of size 2^( 2) =       0.000420785100
  error estimate for blocks of size 2^( 3) =       0.000433661758
  error estimate for blocks of size 2^( 4) =       0.000444855357
  error estimate for blocks of size 2^( 5) =       0.000455079199
  error estimate for blocks of size 2^( 6) =       0.000463547937
  error estimate for blocks of size 2^( 7) =       0.000467936560

      target function =                  N/A
              le_mean =     -16.905791264022
             les_mean =     286.139002652602
             stat err =       0.000457854763
             autocorr =       1.258196492345
              std dev =       0.577256058028
             le_variance =       0.333224556530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579126402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905791264022       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905796878164       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905795872593       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797598574       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905796348619       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905798082488       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905803157822       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905804421004       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905810427727       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905807685322       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905809849896       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905809491607       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905810664473       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905809339448       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905809674868       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905810333545       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905810274261       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905811001027       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905812463345       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905811878201       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905811605137       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905811371126       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.635770e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905791264022       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905795973240       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905794911183       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905796304358       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905795201357       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797216107       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799880998       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799046195       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905801914689       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905800785216       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905800872758       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905800865071       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905800448996       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905800557820       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.999480e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905791264022       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905794127210       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905793160916       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905793840990       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905793424742       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905794226069       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905794625399       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905795255345       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905795377840       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905794823855       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905795156930       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.125430e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6246e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.060652e-01 1 1  ON 0
 uu_1                 1.392625e-01 1 1  ON 1
 uu_2                 3.737275e-02 1 1  ON 2
 uu_3                -2.569994e-02 1 1  ON 3
 uu_4                -7.174834e-02 1 1  ON 4
 uu_5                -1.074551e-01 1 1  ON 5
 uu_6                -1.360238e-01 1 1  ON 6
 uu_7                -1.511803e-01 1 1  ON 7
 uu_8                -1.443559e-01 1 1  ON 8
 uu_9                -1.151146e-01 1 1  ON 9
 ud_0                 4.485612e-01 1 1  ON 10
 ud_1                 1.846415e-01 1 1  ON 11
 ud_2                 6.795534e-02 1 1  ON 12
 ud_3                -1.448144e-03 1 1  ON 13
 ud_4                -6.005068e-02 1 1  ON 14
 ud_5                -1.032764e-01 1 1  ON 15
 ud_6                -1.322641e-01 1 1  ON 16
 ud_7                -1.510118e-01 1 1  ON 17
 ud_8                -1.520274e-01 1 1  ON 18
 ud_9                -1.400804e-01 1 1  ON 19
 eO_0                -7.394127e-01 1 1  ON 20
 eO_1                -4.225028e-01 1 1  ON 21
 eO_2                -8.650385e-03 1 1  ON 22
 eO_3                 3.092840e-01 1 1  ON 23
 eO_4                 5.389514e-01 1 1  ON 24
 eO_5                 5.018488e-01 1 1  ON 25
 eO_6                 2.708188e-01 1 1  ON 26
 eO_7                -4.621408e-02 1 1  ON 27
 eO_8                -2.610063e-01 1 1  ON 28
 eO_9                -1.347890e-01 1 1  ON 29
eH1_0                -2.623454e-01 1 1  ON 30
eH1_1                -1.624973e-01 1 1  ON 31
eH1_2                -1.164356e-01 1 1  ON 32
eH1_3                -6.153279e-02 1 1  ON 33
eH1_4                -1.199803e-02 1 1  ON 34
eH1_5                 2.407318e-02 1 1  ON 35
eH1_6                 8.903501e-02 1 1  ON 36
eH1_7                 1.570769e-01 1 1  ON 37
eH1_8                 2.095451e-01 1 1  ON 38
eH1_9                 1.250287e-01 1 1  ON 39
eH2_0                -2.548343e-01 1 1  ON 40
eH2_1                -1.542964e-01 1 1  ON 41
eH2_2                -1.085962e-01 1 1  ON 42
eH2_3                -5.378750e-02 1 1  ON 43
eH2_4                -4.115663e-03 1 1  ON 44
eH2_5                 3.161080e-02 1 1  ON 45
eH2_6                 9.562251e-02 1 1  ON 46
eH2_7                 1.604732e-01 1 1  ON 47
eH2_8                 2.037031e-01 1 1  ON 48
eH2_9                 1.045548e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8824
    reference variance = 0.188312
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4131e-01
  Total weights = 2.0000e+06
  Execution time = 1.8995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341021644604
                                         uncertainty =       0.006111935876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341021644604
                                         uncertainty =       0.006111935876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412865084
  error estimate for blocks of size 2^( 2) =       0.000425575531
  error estimate for blocks of size 2^( 3) =       0.000438289743
  error estimate for blocks of size 2^( 4) =       0.000450523397
  error estimate for blocks of size 2^( 5) =       0.000460040832
  error estimate for blocks of size 2^( 6) =       0.000467867593
  error estimate for blocks of size 2^( 7) =       0.000472537528

      target function =                  N/A
              le_mean =     -16.906354825312
             les_mean =     286.165748463820
             stat err =       0.000462742337
             autocorr =       1.256209750555
              std dev =       0.583879401020
             le_variance =       0.340915154936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341612062809
                                         uncertainty =       0.006113803408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341612062809
                                         uncertainty =       0.006113803408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413222222
  error estimate for blocks of size 2^( 2) =       0.000425929477
  error estimate for blocks of size 2^( 3) =       0.000438623867
  error estimate for blocks of size 2^( 4) =       0.000450827278
  error estimate for blocks of size 2^( 5) =       0.000460312651
  error estimate for blocks of size 2^( 6) =       0.000468101124
  error estimate for blocks of size 2^( 7) =       0.000472768971

      target function =                  N/A
              le_mean =     -16.906355133349
             les_mean =     286.166348933305
             stat err =       0.000463002506
             autocorr =       1.255449782995
              std dev =       0.584384470316
             le_variance =       0.341505209146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341819662014
                                         uncertainty =       0.006114307394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341819662014
                                         uncertainty =       0.006114307394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413347768
  error estimate for blocks of size 2^( 2) =       0.000426056439
  error estimate for blocks of size 2^( 3) =       0.000438751686
  error estimate for blocks of size 2^( 4) =       0.000450953649
  error estimate for blocks of size 2^( 5) =       0.000460448983
  error estimate for blocks of size 2^( 6) =       0.000468237706
  error estimate for blocks of size 2^( 7) =       0.000472904555

      target function =                  N/A
              le_mean =     -16.906355107106
             les_mean =     286.166555590630
             stat err =       0.000463136223
             autocorr =       1.255412090396
              std dev =       0.584562018875
             le_variance =       0.341712753911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341296334981
                                         uncertainty =       0.006113688701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341296334981
                                         uncertainty =       0.006113688701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413031296
  error estimate for blocks of size 2^( 2) =       0.000425738989
  error estimate for blocks of size 2^( 3) =       0.000438446541
  error estimate for blocks of size 2^( 4) =       0.000450671161
  error estimate for blocks of size 2^( 5) =       0.000460182882
  error estimate for blocks of size 2^( 6) =       0.000467997706
  error estimate for blocks of size 2^( 7) =       0.000472666127

      target function =                  N/A
              le_mean =     -16.906353251392
             les_mean =     286.165969792709
             stat err =       0.000462879469
             autocorr =       1.255942963154
              std dev =       0.584114460068
             le_variance =       0.341189702460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906354825312        initial
     9.7656e-03     9.7656e-02             1.6358e-02       -16.906355133349  <--
     3.9062e-02     3.9062e-01             3.9995e-03       -16.906355107106
     1.5625e-01     1.5625e+00             1.1254e-03       -16.906353251392

*****************************************************************************
Applying the update for shift_i =   9.7656e-03     and shift_s =   9.7656e-02
*****************************************************************************

  Execution time = 2.9722e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.059235e-01 1 1  ON 0
 uu_1                 1.390195e-01 1 1  ON 1
 uu_2                 3.712379e-02 1 1  ON 2
 uu_3                -2.604628e-02 1 1  ON 3
 uu_4                -7.212165e-02 1 1  ON 4
 uu_5                -1.078481e-01 1 1  ON 5
 uu_6                -1.364602e-01 1 1  ON 6
 uu_7                -1.521309e-01 1 1  ON 7
 uu_8                -1.455970e-01 1 1  ON 8
 uu_9                -1.191587e-01 1 1  ON 9
 ud_0                 4.485547e-01 1 1  ON 10
 ud_1                 1.845323e-01 1 1  ON 11
 ud_2                 6.780702e-02 1 1  ON 12
 ud_3                -1.708558e-03 1 1  ON 13
 ud_4                -6.043398e-02 1 1  ON 14
 ud_5                -1.036644e-01 1 1  ON 15
 ud_6                -1.327732e-01 1 1  ON 16
 ud_7                -1.515785e-01 1 1  ON 17
 ud_8                -1.522961e-01 1 1  ON 18
 ud_9                -1.388841e-01 1 1  ON 19
 eO_0                -7.370616e-01 1 1  ON 20
 eO_1                -4.200951e-01 1 1  ON 21
 eO_2                -5.904128e-03 1 1  ON 22
 eO_3                 3.126519e-01 1 1  ON 23
 eO_4                 5.431482e-01 1 1  ON 24
 eO_5                 5.049809e-01 1 1  ON 25
 eO_6                 2.730081e-01 1 1  ON 26
 eO_7                -4.815521e-02 1 1  ON 27
 eO_8                -2.691984e-01 1 1  ON 28
 eO_9                -1.437897e-01 1 1  ON 29
eH1_0                -2.664494e-01 1 1  ON 30
eH1_1                -1.664793e-01 1 1  ON 31
eH1_2                -1.204690e-01 1 1  ON 32
eH1_3                -6.547465e-02 1 1  ON 33
eH1_4                -1.578854e-02 1 1  ON 34
eH1_5                 2.029500e-02 1 1  ON 35
eH1_6                 8.687493e-02 1 1  ON 36
eH1_7                 1.578076e-01 1 1  ON 37
eH1_8                 2.191463e-01 1 1  ON 38
eH1_9                 1.373869e-01 1 1  ON 39
eH2_0                -2.572046e-01 1 1  ON 40
eH2_1                -1.563534e-01 1 1  ON 41
eH2_2                -1.107450e-01 1 1  ON 42
eH2_3                -5.581684e-02 1 1  ON 43
eH2_4                -6.165731e-03 1 1  ON 44
eH2_5                 2.940978e-02 1 1  ON 45
eH2_6                 9.382341e-02 1 1  ON 46
eH2_7                 1.601292e-01 1 1  ON 47
eH2_8                 2.062680e-01 1 1  ON 48
eH2_9                 1.147556e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8203
    reference variance = 0.326827
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3397e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334034980160
                                         uncertainty =       0.002624373458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334034980160
                                         uncertainty =       0.002624373458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408637454
  error estimate for blocks of size 2^( 2) =       0.000421631616
  error estimate for blocks of size 2^( 3) =       0.000435039140
  error estimate for blocks of size 2^( 4) =       0.000447929811
  error estimate for blocks of size 2^( 5) =       0.000459103731
  error estimate for blocks of size 2^( 6) =       0.000466817144
  error estimate for blocks of size 2^( 7) =       0.000472228791

      target function =                  N/A
              le_mean =     -16.906270721029
             les_mean =     286.155958663400
             stat err =       0.000461519869
             autocorr =       1.275570497690
              std dev =       0.577900629585
             le_variance =       0.333969137674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627072103e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906270721029       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269468024       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906267677569       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271528301       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906269046919       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273040190       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906277671563       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906280349889       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906285370453       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906284028855       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906290783328       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906291533602       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906294235398       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906297974143       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906299825308       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906301703237       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906302401881       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906309277604       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906308928696       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906310919591       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906310921033       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906315350751       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906315610489       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906315047576       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906315464528       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906315315387       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906317435253       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906316779210       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906317537889       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906316909051       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 7.737496e-02

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906270721029       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269498849       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906267751141       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271432150       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906269127391       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272818391       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906277187190       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906278667355       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906282536031       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906280988538       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906284093784       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906283802773       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906283725156       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906285507010       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906285815736       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906285629842       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906286332016       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906287360133       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906286803316       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906287050473       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906286904287       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906287596547       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.020547e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906270721029       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269608341       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906268009517       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271085352       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906269387585       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272085181       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906275594086       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274904534       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906276687155       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906275959728       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906276137454       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906275993427       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906275750687       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906276052167       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906276230319       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.010474e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6126e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.028755e-01 1 1  ON 0
 uu_1                 1.360887e-01 1 1  ON 1
 uu_2                 3.423011e-02 1 1  ON 2
 uu_3                -2.890927e-02 1 1  ON 3
 uu_4                -7.540066e-02 1 1  ON 4
 uu_5                -1.113005e-01 1 1  ON 5
 uu_6                -1.399780e-01 1 1  ON 6
 uu_7                -1.554342e-01 1 1  ON 7
 uu_8                -1.460150e-01 1 1  ON 8
 uu_9                -1.145520e-01 1 1  ON 9
 ud_0                 4.483257e-01 1 1  ON 10
 ud_1                 1.845329e-01 1 1  ON 11
 ud_2                 6.816760e-02 1 1  ON 12
 ud_3                -1.279614e-03 1 1  ON 13
 ud_4                -6.063800e-02 1 1  ON 14
 ud_5                -1.042954e-01 1 1  ON 15
 ud_6                -1.330754e-01 1 1  ON 16
 ud_7                -1.506236e-01 1 1  ON 17
 ud_8                -1.530006e-01 1 1  ON 18
 ud_9                -1.416903e-01 1 1  ON 19
 eO_0                -7.312690e-01 1 1  ON 20
 eO_1                -4.145621e-01 1 1  ON 21
 eO_2                -1.223532e-03 1 1  ON 22
 eO_3                 3.164118e-01 1 1  ON 23
 eO_4                 5.461962e-01 1 1  ON 24
 eO_5                 5.082288e-01 1 1  ON 25
 eO_6                 2.722433e-01 1 1  ON 26
 eO_7                -5.429063e-02 1 1  ON 27
 eO_8                -2.757591e-01 1 1  ON 28
 eO_9                -1.530872e-01 1 1  ON 29
eH1_0                -2.704235e-01 1 1  ON 30
eH1_1                -1.698222e-01 1 1  ON 31
eH1_2                -1.239524e-01 1 1  ON 32
eH1_3                -6.861248e-02 1 1  ON 33
eH1_4                -1.761186e-02 1 1  ON 34
eH1_5                 2.002513e-02 1 1  ON 35
eH1_6                 8.466198e-02 1 1  ON 36
eH1_7                 1.549488e-01 1 1  ON 37
eH1_8                 2.132093e-01 1 1  ON 38
eH1_9                 1.537832e-01 1 1  ON 39
eH2_0                -2.623230e-01 1 1  ON 40
eH2_1                -1.643628e-01 1 1  ON 41
eH2_2                -1.180462e-01 1 1  ON 42
eH2_3                -6.230870e-02 1 1  ON 43
eH2_4                -1.212959e-02 1 1  ON 44
eH2_5                 2.571118e-02 1 1  ON 45
eH2_6                 9.233258e-02 1 1  ON 46
eH2_7                 1.643820e-01 1 1  ON 47
eH2_8                 2.159028e-01 1 1  ON 48
eH2_9                 1.349611e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.36875
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4093e-01
  Total weights = 2.0000e+06
  Execution time = 1.8993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341312645747
                                         uncertainty =       0.004853931168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341312645747
                                         uncertainty =       0.004853931168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413052431
  error estimate for blocks of size 2^( 2) =       0.000425803295
  error estimate for blocks of size 2^( 3) =       0.000438979955
  error estimate for blocks of size 2^( 4) =       0.000451981419
  error estimate for blocks of size 2^( 5) =       0.000462654894
  error estimate for blocks of size 2^( 6) =       0.000470168239
  error estimate for blocks of size 2^( 7) =       0.000475228404

      target function =                  N/A
              le_mean =     -16.906088637870
             les_mean =     286.157057481796
             stat err =       0.000465008239
             autocorr =       1.267391912423
              std dev =       0.584144349352
             le_variance =       0.341224620879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341032298335
                                         uncertainty =       0.004839952414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341032298335
                                         uncertainty =       0.004839952414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412882834
  error estimate for blocks of size 2^( 2) =       0.000425638594
  error estimate for blocks of size 2^( 3) =       0.000438811130
  error estimate for blocks of size 2^( 4) =       0.000451774968
  error estimate for blocks of size 2^( 5) =       0.000462384467
  error estimate for blocks of size 2^( 6) =       0.000469879330
  error estimate for blocks of size 2^( 7) =       0.000474865159

      target function =                  N/A
              le_mean =     -16.906095244941
             les_mean =     286.157000730464
             stat err =       0.000464725981
             autocorr =       1.266893916482
              std dev =       0.583904504101
             le_variance =       0.340944469909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340780702241
                                         uncertainty =       0.004826322960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340780702241
                                         uncertainty =       0.004826322960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412730465
  error estimate for blocks of size 2^( 2) =       0.000425507003
  error estimate for blocks of size 2^( 3) =       0.000438699997
  error estimate for blocks of size 2^( 4) =       0.000451686551
  error estimate for blocks of size 2^( 5) =       0.000462308137
  error estimate for blocks of size 2^( 6) =       0.000469808175
  error estimate for blocks of size 2^( 7) =       0.000474765057

      target function =                  N/A
              le_mean =     -16.906093062530
             les_mean =     286.156675341899
             stat err =       0.000464641980
             autocorr =       1.267371209463
              std dev =       0.583689021067
             le_variance =       0.340692873314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341096371434
                                         uncertainty =       0.004842521332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341096371434
                                         uncertainty =       0.004842521332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412921539
  error estimate for blocks of size 2^( 2) =       0.000425678940
  error estimate for blocks of size 2^( 3) =       0.000438859058
  error estimate for blocks of size 2^( 4) =       0.000451857487
  error estimate for blocks of size 2^( 5) =       0.000462517629
  error estimate for blocks of size 2^( 6) =       0.000470026126
  error estimate for blocks of size 2^( 7) =       0.000475066005

      target function =                  N/A
              le_mean =     -16.906082771771
             les_mean =     286.156642910059
             stat err =       0.000464866812
             autocorr =       1.267424239098
              std dev =       0.583959240509
             le_variance =       0.341008394576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906088637870        initial
     2.4414e-03     2.4414e-02             7.7375e-02       -16.906095244941  <--
     9.7656e-03     9.7656e-02             2.0205e-02       -16.906093062530
     3.9062e-02     3.9062e-01             5.0105e-03       -16.906082771771

*****************************************************************************
Applying the update for shift_i =   2.4414e-03     and shift_s =   2.4414e-02
*****************************************************************************

  Execution time = 2.9774e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.960660e-01 1 1  ON 0
 uu_1                 1.292424e-01 1 1  ON 1
 uu_2                 2.742631e-02 1 1  ON 2
 uu_3                -3.565069e-02 1 1  ON 3
 uu_4                -8.214119e-02 1 1  ON 4
 uu_5                -1.179950e-01 1 1  ON 5
 uu_6                -1.466698e-01 1 1  ON 6
 uu_7                -1.619843e-01 1 1  ON 7
 uu_8                -1.522858e-01 1 1  ON 8
 uu_9                -1.190893e-01 1 1  ON 9
 ud_0                 4.482213e-01 1 1  ON 10
 ud_1                 1.844051e-01 1 1  ON 11
 ud_2                 6.810422e-02 1 1  ON 12
 ud_3                -1.338527e-03 1 1  ON 13
 ud_4                -6.082829e-02 1 1  ON 14
 ud_5                -1.046029e-01 1 1  ON 15
 ud_6                -1.334850e-01 1 1  ON 16
 ud_7                -1.507060e-01 1 1  ON 17
 ud_8                -1.541906e-01 1 1  ON 18
 ud_9                -1.431401e-01 1 1  ON 19
 eO_0                -7.152748e-01 1 1  ON 20
 eO_1                -3.986198e-01 1 1  ON 21
 eO_2                 1.424816e-02 1 1  ON 22
 eO_3                 3.306567e-01 1 1  ON 23
 eO_4                 5.582904e-01 1 1  ON 24
 eO_5                 5.169019e-01 1 1  ON 25
 eO_6                 2.750137e-01 1 1  ON 26
 eO_7                -6.718524e-02 1 1  ON 27
 eO_8                -3.051620e-01 1 1  ON 28
 eO_9                -1.846890e-01 1 1  ON 29
eH1_0                -2.816697e-01 1 1  ON 30
eH1_1                -1.811181e-01 1 1  ON 31
eH1_2                -1.351992e-01 1 1  ON 32
eH1_3                -7.977143e-02 1 1  ON 33
eH1_4                -2.821255e-02 1 1  ON 34
eH1_5                 1.105502e-02 1 1  ON 35
eH1_6                 7.649039e-02 1 1  ON 36
eH1_7                 1.519627e-01 1 1  ON 37
eH1_8                 2.113256e-01 1 1  ON 38
eH1_9                 1.967791e-01 1 1  ON 39
eH2_0                -2.773778e-01 1 1  ON 40
eH2_1                -1.799215e-01 1 1  ON 41
eH2_2                -1.333636e-01 1 1  ON 42
eH2_3                -7.732502e-02 1 1  ON 43
eH2_4                -2.642083e-02 1 1  ON 44
eH2_5                 1.435363e-02 1 1  ON 45
eH2_6                 8.538404e-02 1 1  ON 46
eH2_7                 1.677630e-01 1 1  ON 47
eH2_8                 2.330391e-01 1 1  ON 48
eH2_9                 1.921306e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9518
    reference variance = 0.358432
====================================================
  Execution time = 2.2508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2997e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327980612908
                                         uncertainty =       0.002970040514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327980612908
                                         uncertainty =       0.002970040514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406181042
  error estimate for blocks of size 2^( 2) =       0.000418919470
  error estimate for blocks of size 2^( 3) =       0.000432020779
  error estimate for blocks of size 2^( 4) =       0.000443765566
  error estimate for blocks of size 2^( 5) =       0.000452129265
  error estimate for blocks of size 2^( 6) =       0.000459331414
  error estimate for blocks of size 2^( 7) =       0.000464519863

      target function =                  N/A
              le_mean =     -16.906134451414
             les_mean =     286.147348002827
             stat err =       0.000454936527
             autocorr =       1.254475879312
              std dev =       0.574426739043
             le_variance =       0.329966078527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613445141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-04, overlap shift 6.1035e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906134451414       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906134276698       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131222843       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906134940729       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133386473       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136658373       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906142379872       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906147340609       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906147722194       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906151107779       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906155483441       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906162439778       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906166391581       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906166779129       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906170141337       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906169470028       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906170091744       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906172691589       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906175895432       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906178600701       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906181545470       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906190764648       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906191444516       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906187284350       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906188329469       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906188983990       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906194271225       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906198287428       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906198982394       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906202596560       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906202881610       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906204342201       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906204071771       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-04 is 1.033284e-01

solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906134451414       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906134278131       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131218523       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906135002107       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133426802       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136550688       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906142033838       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906146777337       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906147091148       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906149982498       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906153452672       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906159121171       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906162327085       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906162041948       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906164353520       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906163449574       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906163720942       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906164592241       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906165794831       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906166868606       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906168073340       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906171469648       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906171051466       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906168846744       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906168450218       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906169559762       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906170059575       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906171406824       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906170936986       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 4.291722e-02

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906134451414       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906134283635       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131211649       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906135127951       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133654934       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136221148       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140831271       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906144895995       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906144982635       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906146588174       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906148037307       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906150999332       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906152752153       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906151766191       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906152465699       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906151701555       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906151809154       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906151480316       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906151664518       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906151925915       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906152204304       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906152629948       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.388186e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.343279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8047e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.937737e-01 1 1  ON 0
 uu_1                 1.265666e-01 1 1  ON 1
 uu_2                 2.494720e-02 1 1  ON 2
 uu_3                -3.765154e-02 1 1  ON 3
 uu_4                -8.357578e-02 1 1  ON 4
 uu_5                -1.188036e-01 1 1  ON 5
 uu_6                -1.479695e-01 1 1  ON 6
 uu_7                -1.625565e-01 1 1  ON 7
 uu_8                -1.553202e-01 1 1  ON 8
 uu_9                -1.288300e-01 1 1  ON 9
 ud_0                 4.512260e-01 1 1  ON 10
 ud_1                 1.873476e-01 1 1  ON 11
 ud_2                 7.076941e-02 1 1  ON 12
 ud_3                 1.341585e-03 1 1  ON 13
 ud_4                -5.725757e-02 1 1  ON 14
 ud_5                -1.006500e-01 1 1  ON 15
 ud_6                -1.293183e-01 1 1  ON 16
 ud_7                -1.478017e-01 1 1  ON 17
 ud_8                -1.503892e-01 1 1  ON 18
 ud_9                -1.414243e-01 1 1  ON 19
 eO_0                -7.038875e-01 1 1  ON 20
 eO_1                -3.868033e-01 1 1  ON 21
 eO_2                 2.627010e-02 1 1  ON 22
 eO_3                 3.409989e-01 1 1  ON 23
 eO_4                 5.658437e-01 1 1  ON 24
 eO_5                 5.256053e-01 1 1  ON 25
 eO_6                 2.812347e-01 1 1  ON 26
 eO_7                -6.459945e-02 1 1  ON 27
 eO_8                -3.263272e-01 1 1  ON 28
 eO_9                -2.211550e-01 1 1  ON 29
eH1_0                -2.872827e-01 1 1  ON 30
eH1_1                -1.866722e-01 1 1  ON 31
eH1_2                -1.406131e-01 1 1  ON 32
eH1_3                -8.610083e-02 1 1  ON 33
eH1_4                -3.622139e-02 1 1  ON 34
eH1_5                 4.601059e-03 1 1  ON 35
eH1_6                 7.350809e-02 1 1  ON 36
eH1_7                 1.574149e-01 1 1  ON 37
eH1_8                 2.282219e-01 1 1  ON 38
eH1_9                 2.081337e-01 1 1  ON 39
eH2_0                -2.839496e-01 1 1  ON 40
eH2_1                -1.846889e-01 1 1  ON 41
eH2_2                -1.382893e-01 1 1  ON 42
eH2_3                -8.379762e-02 1 1  ON 43
eH2_4                -3.407704e-02 1 1  ON 44
eH2_5                 5.117523e-03 1 1  ON 45
eH2_6                 7.487525e-02 1 1  ON 46
eH2_7                 1.547932e-01 1 1  ON 47
eH2_8                 2.239746e-01 1 1  ON 48
eH2_9                 2.350478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8379
    reference variance = 0.168353
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3270e-01
  Total weights = 2.0000e+06
  Execution time = 1.9001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333061228354
                                         uncertainty =       0.003575289246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333061228354
                                         uncertainty =       0.003575289246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408030588
  error estimate for blocks of size 2^( 2) =       0.000420500731
  error estimate for blocks of size 2^( 3) =       0.000433747018
  error estimate for blocks of size 2^( 4) =       0.000446315037
  error estimate for blocks of size 2^( 5) =       0.000455525510
  error estimate for blocks of size 2^( 6) =       0.000463845726
  error estimate for blocks of size 2^( 7) =       0.000467455724

      target function =                  N/A
              le_mean =     -16.906286221738
             les_mean =     286.155491566362
             stat err =       0.000458285499
             autocorr =       1.261498647166
              std dev =       0.577042391452
             le_variance =       0.332977921533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332565123308
                                         uncertainty =       0.003571022378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332565123308
                                         uncertainty =       0.003571022378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407726813
  error estimate for blocks of size 2^( 2) =       0.000420157989
  error estimate for blocks of size 2^( 3) =       0.000433366721
  error estimate for blocks of size 2^( 4) =       0.000445929324
  error estimate for blocks of size 2^( 5) =       0.000455164354
  error estimate for blocks of size 2^( 6) =       0.000463520350
  error estimate for blocks of size 2^( 7) =       0.000467120623

      target function =                  N/A
              le_mean =     -16.906274399684
             les_mean =     286.154596218431
             stat err =       0.000457933663
             autocorr =       1.261439993158
              std dev =       0.576612787993
             le_variance =       0.332482307277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332599429529
                                         uncertainty =       0.003570027353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332599429529
                                         uncertainty =       0.003570027353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407747857
  error estimate for blocks of size 2^( 2) =       0.000420180450
  error estimate for blocks of size 2^( 3) =       0.000433406864
  error estimate for blocks of size 2^( 4) =       0.000445986785
  error estimate for blocks of size 2^( 5) =       0.000455260571
  error estimate for blocks of size 2^( 6) =       0.000463656563
  error estimate for blocks of size 2^( 7) =       0.000467309325

      target function =                  N/A
              le_mean =     -16.906286829109
             les_mean =     286.155050810928
             stat err =       0.000458053311
             autocorr =       1.261968980075
              std dev =       0.576642548788
             le_variance =       0.332516629073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332873801025
                                         uncertainty =       0.003573644506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332873801025
                                         uncertainty =       0.003573644506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407915820
  error estimate for blocks of size 2^( 2) =       0.000420370994
  error estimate for blocks of size 2^( 3) =       0.000433612073
  error estimate for blocks of size 2^( 4) =       0.000446183133
  error estimate for blocks of size 2^( 5) =       0.000455417924
  error estimate for blocks of size 2^( 6) =       0.000463762377
  error estimate for blocks of size 2^( 7) =       0.000467399800

      target function =                  N/A
              le_mean =     -16.906272273025
             les_mean =     286.154832635628
             stat err =       0.000458190808
             autocorr =       1.261687058033
              std dev =       0.576880084911
             le_variance =       0.332790632366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906286221738        initial
     6.1035e-04     6.1035e-03             1.0333e-01       -16.906274399684
     2.4414e-03     2.4414e-02             4.2917e-02       -16.906286829109  <--
     9.7656e-03     9.7656e-02             1.3882e-02       -16.906272273025

*****************************************************************************
Applying the update for shift_i =   2.4414e-03     and shift_s =   2.4414e-02
*****************************************************************************

  Execution time = 2.9996e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.937737e-01 1 1  ON 0
 uu_1                 1.265666e-01 1 1  ON 1
 uu_2                 2.494720e-02 1 1  ON 2
 uu_3                -3.765154e-02 1 1  ON 3
 uu_4                -8.357578e-02 1 1  ON 4
 uu_5                -1.188036e-01 1 1  ON 5
 uu_6                -1.479695e-01 1 1  ON 6
 uu_7                -1.625565e-01 1 1  ON 7
 uu_8                -1.553202e-01 1 1  ON 8
 uu_9                -1.288300e-01 1 1  ON 9
 ud_0                 4.512260e-01 1 1  ON 10
 ud_1                 1.873476e-01 1 1  ON 11
 ud_2                 7.076941e-02 1 1  ON 12
 ud_3                 1.341585e-03 1 1  ON 13
 ud_4                -5.725757e-02 1 1  ON 14
 ud_5                -1.006500e-01 1 1  ON 15
 ud_6                -1.293183e-01 1 1  ON 16
 ud_7                -1.478017e-01 1 1  ON 17
 ud_8                -1.503892e-01 1 1  ON 18
 ud_9                -1.414243e-01 1 1  ON 19
 eO_0                -7.038875e-01 1 1  ON 20
 eO_1                -3.868033e-01 1 1  ON 21
 eO_2                 2.627010e-02 1 1  ON 22
 eO_3                 3.409989e-01 1 1  ON 23
 eO_4                 5.658437e-01 1 1  ON 24
 eO_5                 5.256053e-01 1 1  ON 25
 eO_6                 2.812347e-01 1 1  ON 26
 eO_7                -6.459945e-02 1 1  ON 27
 eO_8                -3.263272e-01 1 1  ON 28
 eO_9                -2.211550e-01 1 1  ON 29
eH1_0                -2.872827e-01 1 1  ON 30
eH1_1                -1.866722e-01 1 1  ON 31
eH1_2                -1.406131e-01 1 1  ON 32
eH1_3                -8.610083e-02 1 1  ON 33
eH1_4                -3.622139e-02 1 1  ON 34
eH1_5                 4.601059e-03 1 1  ON 35
eH1_6                 7.350809e-02 1 1  ON 36
eH1_7                 1.574149e-01 1 1  ON 37
eH1_8                 2.282219e-01 1 1  ON 38
eH1_9                 2.081337e-01 1 1  ON 39
eH2_0                -2.839496e-01 1 1  ON 40
eH2_1                -1.846889e-01 1 1  ON 41
eH2_2                -1.382893e-01 1 1  ON 42
eH2_3                -8.379762e-02 1 1  ON 43
eH2_4                -3.407704e-02 1 1  ON 44
eH2_5                 5.117523e-03 1 1  ON 45
eH2_6                 7.487525e-02 1 1  ON 46
eH2_7                 1.547932e-01 1 1  ON 47
eH2_8                 2.239746e-01 1 1  ON 48
eH2_9                 2.350478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.385006
====================================================
  Execution time = 2.0611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373494605539
                                         uncertainty =       0.034588297884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373494605539
                                         uncertainty =       0.034588297884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000432068536
  error estimate for blocks of size 2^( 2) =       0.000444249212
  error estimate for blocks of size 2^( 3) =       0.000456431463
  error estimate for blocks of size 2^( 4) =       0.000468196592
  error estimate for blocks of size 2^( 5) =       0.000478111079
  error estimate for blocks of size 2^( 6) =       0.000485270566
  error estimate for blocks of size 2^( 7) =       0.000488746397

      target function =                  N/A
              le_mean =     -16.906040068760
             les_mean =     286.187557059540
             stat err =       0.000480081158
             autocorr =       1.234593655028
              std dev =       0.611037183573
             le_variance =       0.373366439709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604006876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-04, overlap shift 6.1035e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040068760       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040206963       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906042250719       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906042486194       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906046134131       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047669456       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906049438321       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906048254878       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906049782246       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906052860733       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906059087866       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906060504428       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906061238135       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906064804785       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906063903637       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906068614941       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906070998816       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906079241191       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906077574897       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906085119310       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906084133502       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906083955059       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906087895364       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906087411109       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906088353185       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906090957988       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906092268619       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906089378290       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906089216349       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906089532805       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906089595265       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906091106490       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906090833203       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-04 is 8.769100e-02

solving harmonic davidson linear method for identity shift 2.4414e-03, overlap shift 2.4414e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040068760       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040205560       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906042232056       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906042461876       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906046023064       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047537998       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906049244281       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906048091697       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906049554710       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906052309107       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906057952833       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906059214047       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906059416281       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906062301532       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906061375978       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906065023606       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906066002753       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906070789755       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906067771040       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906070106055       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906069371990       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906068680768       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906070088665       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906069493940       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906069644727       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906070110097       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906070118095       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906069084137       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-03 is 3.754336e-02

solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040068760       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040200223       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906042161410       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906042369225       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906045619396       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047068868       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906048569207       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906047545648       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906048791479       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906050563127       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906054596589       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906055504645       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906054803795       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906056268709       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906055524679       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906057303398       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906056856452       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906058069504       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906056696108       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906056813440       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906056690701       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.186976e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6162e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.938354e-01 1 1  ON 0
 uu_1                 1.268659e-01 1 1  ON 1
 uu_2                 2.485157e-02 1 1  ON 2
 uu_3                -3.789646e-02 1 1  ON 3
 uu_4                -8.382807e-02 1 1  ON 4
 uu_5                -1.192521e-01 1 1  ON 5
 uu_6                -1.477527e-01 1 1  ON 6
 uu_7                -1.632742e-01 1 1  ON 7
 uu_8                -1.543234e-01 1 1  ON 8
 uu_9                -1.307383e-01 1 1  ON 9
 ud_0                 4.569076e-01 1 1  ON 10
 ud_1                 1.931954e-01 1 1  ON 11
 ud_2                 7.684031e-02 1 1  ON 12
 ud_3                 7.918806e-03 1 1  ON 13
 ud_4                -5.070213e-02 1 1  ON 14
 ud_5                -9.416568e-02 1 1  ON 15
 ud_6                -1.234579e-01 1 1  ON 16
 ud_7                -1.423568e-01 1 1  ON 17
 ud_8                -1.441861e-01 1 1  ON 18
 ud_9                -1.394271e-01 1 1  ON 19
 eO_0                -6.941215e-01 1 1  ON 20
 eO_1                -3.775573e-01 1 1  ON 21
 eO_2                 3.514862e-02 1 1  ON 22
 eO_3                 3.509605e-01 1 1  ON 23
 eO_4                 5.760146e-01 1 1  ON 24
 eO_5                 5.345524e-01 1 1  ON 25
 eO_6                 2.896501e-01 1 1  ON 26
 eO_7                -6.112194e-02 1 1  ON 27
 eO_8                -3.456586e-01 1 1  ON 28
 eO_9                -2.586984e-01 1 1  ON 29
eH1_0                -2.901253e-01 1 1  ON 30
eH1_1                -1.889514e-01 1 1  ON 31
eH1_2                -1.428702e-01 1 1  ON 32
eH1_3                -8.806349e-02 1 1  ON 33
eH1_4                -3.765093e-02 1 1  ON 34
eH1_5                 1.488021e-03 1 1  ON 35
eH1_6                 7.211410e-02 1 1  ON 36
eH1_7                 1.576601e-01 1 1  ON 37
eH1_8                 2.236782e-01 1 1  ON 38
eH1_9                 2.219184e-01 1 1  ON 39
eH2_0                -2.847909e-01 1 1  ON 40
eH2_1                -1.849016e-01 1 1  ON 41
eH2_2                -1.391620e-01 1 1  ON 42
eH2_3                -8.401228e-02 1 1  ON 43
eH2_4                -3.455679e-02 1 1  ON 44
eH2_5                 4.643564e-03 1 1  ON 45
eH2_6                 7.565963e-02 1 1  ON 46
eH2_7                 1.566114e-01 1 1  ON 47
eH2_8                 2.271106e-01 1 1  ON 48
eH2_9                 2.320067e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9106
    reference variance = 0.19827
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3541e-01
  Total weights = 2.0000e+06
  Execution time = 1.8955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335758282084
                                         uncertainty =       0.002994434477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335758282084
                                         uncertainty =       0.002994434477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409727263
  error estimate for blocks of size 2^( 2) =       0.000422444010
  error estimate for blocks of size 2^( 3) =       0.000435869479
  error estimate for blocks of size 2^( 4) =       0.000448436062
  error estimate for blocks of size 2^( 5) =       0.000460082458
  error estimate for blocks of size 2^( 6) =       0.000467335430
  error estimate for blocks of size 2^( 7) =       0.000470787562

      target function =                  N/A
              le_mean =     -16.905337401186
             les_mean =     286.126185340011
             stat err =       0.000461660378
             autocorr =       1.269566577965
              std dev =       0.579441852098
             le_variance =       0.335752859963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335275169721
                                         uncertainty =       0.002992596994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335275169721
                                         uncertainty =       0.002992596994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409432345
  error estimate for blocks of size 2^( 2) =       0.000422102390
  error estimate for blocks of size 2^( 3) =       0.000435499048
  error estimate for blocks of size 2^( 4) =       0.000448053220
  error estimate for blocks of size 2^( 5) =       0.000459720996
  error estimate for blocks of size 2^( 6) =       0.000467027846
  error estimate for blocks of size 2^( 7) =       0.000470502388

      target function =                  N/A
              le_mean =     -16.905318765295
             les_mean =     286.125072078925
             stat err =       0.000461326113
             autocorr =       1.269555753140
              std dev =       0.579024775226
             le_variance =       0.335269690326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335125192172
                                         uncertainty =       0.002991829732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335125192172
                                         uncertainty =       0.002991829732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409340508
  error estimate for blocks of size 2^( 2) =       0.000422008096
  error estimate for blocks of size 2^( 3) =       0.000435404710
  error estimate for blocks of size 2^( 4) =       0.000447959653
  error estimate for blocks of size 2^( 5) =       0.000459637079
  error estimate for blocks of size 2^( 6) =       0.000466955545
  error estimate for blocks of size 2^( 7) =       0.000470455369

      target function =                  N/A
              le_mean =     -16.905333182571
             les_mean =     286.125409149437
             stat err =       0.000461251911
             autocorr =       1.269716926255
              std dev =       0.578894898294
             le_variance =       0.335119303270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335508408190
                                         uncertainty =       0.002992805340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335508408190
                                         uncertainty =       0.002992805340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409574591
  error estimate for blocks of size 2^( 2) =       0.000422277687
  error estimate for blocks of size 2^( 3) =       0.000435695066
  error estimate for blocks of size 2^( 4) =       0.000448254390
  error estimate for blocks of size 2^( 5) =       0.000459909389
  error estimate for blocks of size 2^( 6) =       0.000467171936
  error estimate for blocks of size 2^( 7) =       0.000470631157

      target function =                  N/A
              le_mean =     -16.905330228754
             les_mean =     286.125692667024
             stat err =       0.000461491718
             autocorr =       1.269585079266
              std dev =       0.579225941710
             le_variance =       0.335502691550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905337401186        initial  <--
     6.1035e-04     6.1035e-03             8.7691e-02       -16.905318765295
     2.4414e-03     2.4414e-02             3.7543e-02       -16.905333182571
     9.7656e-03     9.7656e-02             1.1870e-02       -16.905330228754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7393
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.937737e-01 1 1  ON 0
 uu_1                 1.265666e-01 1 1  ON 1
 uu_2                 2.494720e-02 1 1  ON 2
 uu_3                -3.765154e-02 1 1  ON 3
 uu_4                -8.357578e-02 1 1  ON 4
 uu_5                -1.188036e-01 1 1  ON 5
 uu_6                -1.479695e-01 1 1  ON 6
 uu_7                -1.625565e-01 1 1  ON 7
 uu_8                -1.553202e-01 1 1  ON 8
 uu_9                -1.288300e-01 1 1  ON 9
 ud_0                 4.512260e-01 1 1  ON 10
 ud_1                 1.873476e-01 1 1  ON 11
 ud_2                 7.076941e-02 1 1  ON 12
 ud_3                 1.341585e-03 1 1  ON 13
 ud_4                -5.725757e-02 1 1  ON 14
 ud_5                -1.006500e-01 1 1  ON 15
 ud_6                -1.293183e-01 1 1  ON 16
 ud_7                -1.478017e-01 1 1  ON 17
 ud_8                -1.503892e-01 1 1  ON 18
 ud_9                -1.414243e-01 1 1  ON 19
 eO_0                -7.038875e-01 1 1  ON 20
 eO_1                -3.868033e-01 1 1  ON 21
 eO_2                 2.627010e-02 1 1  ON 22
 eO_3                 3.409989e-01 1 1  ON 23
 eO_4                 5.658437e-01 1 1  ON 24
 eO_5                 5.256053e-01 1 1  ON 25
 eO_6                 2.812347e-01 1 1  ON 26
 eO_7                -6.459945e-02 1 1  ON 27
 eO_8                -3.263272e-01 1 1  ON 28
 eO_9                -2.211550e-01 1 1  ON 29
eH1_0                -2.872827e-01 1 1  ON 30
eH1_1                -1.866722e-01 1 1  ON 31
eH1_2                -1.406131e-01 1 1  ON 32
eH1_3                -8.610083e-02 1 1  ON 33
eH1_4                -3.622139e-02 1 1  ON 34
eH1_5                 4.601059e-03 1 1  ON 35
eH1_6                 7.350809e-02 1 1  ON 36
eH1_7                 1.574149e-01 1 1  ON 37
eH1_8                 2.282219e-01 1 1  ON 38
eH1_9                 2.081337e-01 1 1  ON 39
eH2_0                -2.839496e-01 1 1  ON 40
eH2_1                -1.846889e-01 1 1  ON 41
eH2_2                -1.382893e-01 1 1  ON 42
eH2_3                -8.379762e-02 1 1  ON 43
eH2_4                -3.407704e-02 1 1  ON 44
eH2_5                 5.117523e-03 1 1  ON 45
eH2_6                 7.487525e-02 1 1  ON 46
eH2_7                 1.547932e-01 1 1  ON 47
eH2_8                 2.239746e-01 1 1  ON 48
eH2_9                 2.350478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.287176
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3466e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334697722936
                                         uncertainty =       0.002944302922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334697722936
                                         uncertainty =       0.002944302922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409059883
  error estimate for blocks of size 2^( 2) =       0.000422010303
  error estimate for blocks of size 2^( 3) =       0.000435337472
  error estimate for blocks of size 2^( 4) =       0.000447863655
  error estimate for blocks of size 2^( 5) =       0.000457964403
  error estimate for blocks of size 2^( 6) =       0.000467210237
  error estimate for blocks of size 2^( 7) =       0.000473565961

      target function =                  N/A
              le_mean =     -16.906310790919
             les_mean =     286.158004366787
             stat err =       0.000461651064
             autocorr =       1.273661153301
              std dev =       0.578498033677
             le_variance =       0.334659974968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631079092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906310790919       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906311867897       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906311398915       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906312050586       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906311000934       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310088533       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906309239381       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906307046250       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906308103145       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906311239652       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906312493182       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906313424546       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906317312760       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906316145852       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906315722529       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906317449892       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906317208449       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906316855133       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906317092214       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906316482368       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906317430984       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906318023407       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906318418541       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 1.437288e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906310790919       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906311769773       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906311370316       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906311969345       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906310999539       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310191424       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906309684320       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906308330862       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906309576937       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906311365118       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906311619329       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906311679041       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906312813434       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906312375883       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906312208223       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 3.551340e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906310790919       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906311508322       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906311284347       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906311720731       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906310961995       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310529997       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906310465424       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906310149261       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906310980185       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906311238624       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906311152873       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906311094465       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.063424e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.938598e-01 1 1  ON 0
 uu_1                 1.270209e-01 1 1  ON 1
 uu_2                 2.502939e-02 1 1  ON 2
 uu_3                -3.783928e-02 1 1  ON 3
 uu_4                -8.385222e-02 1 1  ON 4
 uu_5                -1.195512e-01 1 1  ON 5
 uu_6                -1.480202e-01 1 1  ON 6
 uu_7                -1.635537e-01 1 1  ON 7
 uu_8                -1.557426e-01 1 1  ON 8
 uu_9                -1.290463e-01 1 1  ON 9
 ud_0                 4.518846e-01 1 1  ON 10
 ud_1                 1.881339e-01 1 1  ON 11
 ud_2                 7.162383e-02 1 1  ON 12
 ud_3                 2.380885e-03 1 1  ON 13
 ud_4                -5.650436e-02 1 1  ON 14
 ud_5                -9.962550e-02 1 1  ON 15
 ud_6                -1.289289e-01 1 1  ON 16
 ud_7                -1.477519e-01 1 1  ON 17
 ud_8                -1.510309e-01 1 1  ON 18
 ud_9                -1.421229e-01 1 1  ON 19
 eO_0                -7.025550e-01 1 1  ON 20
 eO_1                -3.859281e-01 1 1  ON 21
 eO_2                 2.731407e-02 1 1  ON 22
 eO_3                 3.421493e-01 1 1  ON 23
 eO_4                 5.683247e-01 1 1  ON 24
 eO_5                 5.263218e-01 1 1  ON 25
 eO_6                 2.815345e-01 1 1  ON 26
 eO_7                -6.500888e-02 1 1  ON 27
 eO_8                -3.292529e-01 1 1  ON 28
 eO_9                -2.246412e-01 1 1  ON 29
eH1_0                -2.890073e-01 1 1  ON 30
eH1_1                -1.892067e-01 1 1  ON 31
eH1_2                -1.425942e-01 1 1  ON 32
eH1_3                -8.731247e-02 1 1  ON 33
eH1_4                -3.700062e-02 1 1  ON 34
eH1_5                 4.405194e-03 1 1  ON 35
eH1_6                 7.339274e-02 1 1  ON 36
eH1_7                 1.602090e-01 1 1  ON 37
eH1_8                 2.291516e-01 1 1  ON 38
eH1_9                 2.108822e-01 1 1  ON 39
eH2_0                -2.855557e-01 1 1  ON 40
eH2_1                -1.859444e-01 1 1  ON 41
eH2_2                -1.396995e-01 1 1  ON 42
eH2_3                -8.454655e-02 1 1  ON 43
eH2_4                -3.465069e-02 1 1  ON 44
eH2_5                 4.286347e-03 1 1  ON 45
eH2_6                 7.580231e-02 1 1  ON 46
eH2_7                 1.583446e-01 1 1  ON 47
eH2_8                 2.233819e-01 1 1  ON 48
eH2_9                 2.354965e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9494
    reference variance = 0.763198
====================================================
  Execution time = 2.0177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4718e-01
  Total weights = 2.0000e+06
  Execution time = 1.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347138753401
                                         uncertainty =       0.004224319529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347138753401
                                         uncertainty =       0.004224319529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416634588
  error estimate for blocks of size 2^( 2) =       0.000429342074
  error estimate for blocks of size 2^( 3) =       0.000442137465
  error estimate for blocks of size 2^( 4) =       0.000454236336
  error estimate for blocks of size 2^( 5) =       0.000467196569
  error estimate for blocks of size 2^( 6) =       0.000475690614
  error estimate for blocks of size 2^( 7) =       0.000482069497

      target function =                  N/A
              le_mean =     -16.905212658975
             les_mean =     286.133383631351
             stat err =       0.000469798254
             autocorr =       1.271487675450
              std dev =       0.589210284849
             le_variance =       0.347168759772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347156507133
                                         uncertainty =       0.004225288909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347156507133
                                         uncertainty =       0.004225288909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416645491
  error estimate for blocks of size 2^( 2) =       0.000429340919
  error estimate for blocks of size 2^( 3) =       0.000442119063
  error estimate for blocks of size 2^( 4) =       0.000454197422
  error estimate for blocks of size 2^( 5) =       0.000467153143
  error estimate for blocks of size 2^( 6) =       0.000475620584
  error estimate for blocks of size 2^( 7) =       0.000482004802

      target function =                  N/A
              le_mean =     -16.905207242113
             les_mean =     286.133218655338
             stat err =       0.000469743988
             autocorr =       1.271127423767
              std dev =       0.589225703893
             le_variance =       0.347186930128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347180423989
                                         uncertainty =       0.004226725262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347180423989
                                         uncertainty =       0.004226725262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416659985
  error estimate for blocks of size 2^( 2) =       0.000429352446
  error estimate for blocks of size 2^( 3) =       0.000442127215
  error estimate for blocks of size 2^( 4) =       0.000454203810
  error estimate for blocks of size 2^( 5) =       0.000467165671
  error estimate for blocks of size 2^( 6) =       0.000475627774
  error estimate for blocks of size 2^( 7) =       0.000482015729

      target function =                  N/A
              le_mean =     -16.905207498924
             les_mean =     286.133251493911
             stat err =       0.000469753246
             autocorr =       1.271089092348
              std dev =       0.589246201369
             le_variance =       0.347211085828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347080519742
                                         uncertainty =       0.004224821164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347080519742
                                         uncertainty =       0.004224821164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416599778
  error estimate for blocks of size 2^( 2) =       0.000429301710
  error estimate for blocks of size 2^( 3) =       0.000442091625
  error estimate for blocks of size 2^( 4) =       0.000454185978
  error estimate for blocks of size 2^( 5) =       0.000467149874
  error estimate for blocks of size 2^( 6) =       0.000475638639
  error estimate for blocks of size 2^( 7) =       0.000482022220

      target function =                  N/A
              le_mean =     -16.905209153948
             les_mean =     286.133207116032
             stat err =       0.000469749177
             autocorr =       1.271434487198
              std dev =       0.589161056801
             le_variance =       0.347110750851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905212658975        initial  <--
     6.1035e-03     6.1035e-02             1.4373e-02       -16.905207242113
     2.4414e-02     2.4414e-01             3.5513e-03       -16.905207498924
     9.7656e-02     9.7656e-01             1.0634e-03       -16.905209153948

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7776
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.937737e-01 1 1  ON 0
 uu_1                 1.265666e-01 1 1  ON 1
 uu_2                 2.494720e-02 1 1  ON 2
 uu_3                -3.765154e-02 1 1  ON 3
 uu_4                -8.357578e-02 1 1  ON 4
 uu_5                -1.188036e-01 1 1  ON 5
 uu_6                -1.479695e-01 1 1  ON 6
 uu_7                -1.625565e-01 1 1  ON 7
 uu_8                -1.553202e-01 1 1  ON 8
 uu_9                -1.288300e-01 1 1  ON 9
 ud_0                 4.512260e-01 1 1  ON 10
 ud_1                 1.873476e-01 1 1  ON 11
 ud_2                 7.076941e-02 1 1  ON 12
 ud_3                 1.341585e-03 1 1  ON 13
 ud_4                -5.725757e-02 1 1  ON 14
 ud_5                -1.006500e-01 1 1  ON 15
 ud_6                -1.293183e-01 1 1  ON 16
 ud_7                -1.478017e-01 1 1  ON 17
 ud_8                -1.503892e-01 1 1  ON 18
 ud_9                -1.414243e-01 1 1  ON 19
 eO_0                -7.038875e-01 1 1  ON 20
 eO_1                -3.868033e-01 1 1  ON 21
 eO_2                 2.627010e-02 1 1  ON 22
 eO_3                 3.409989e-01 1 1  ON 23
 eO_4                 5.658437e-01 1 1  ON 24
 eO_5                 5.256053e-01 1 1  ON 25
 eO_6                 2.812347e-01 1 1  ON 26
 eO_7                -6.459945e-02 1 1  ON 27
 eO_8                -3.263272e-01 1 1  ON 28
 eO_9                -2.211550e-01 1 1  ON 29
eH1_0                -2.872827e-01 1 1  ON 30
eH1_1                -1.866722e-01 1 1  ON 31
eH1_2                -1.406131e-01 1 1  ON 32
eH1_3                -8.610083e-02 1 1  ON 33
eH1_4                -3.622139e-02 1 1  ON 34
eH1_5                 4.601059e-03 1 1  ON 35
eH1_6                 7.350809e-02 1 1  ON 36
eH1_7                 1.574149e-01 1 1  ON 37
eH1_8                 2.282219e-01 1 1  ON 38
eH1_9                 2.081337e-01 1 1  ON 39
eH2_0                -2.839496e-01 1 1  ON 40
eH2_1                -1.846889e-01 1 1  ON 41
eH2_2                -1.382893e-01 1 1  ON 42
eH2_3                -8.379762e-02 1 1  ON 43
eH2_4                -3.407704e-02 1 1  ON 44
eH2_5                 5.117523e-03 1 1  ON 45
eH2_6                 7.487525e-02 1 1  ON 46
eH2_7                 1.547932e-01 1 1  ON 47
eH2_8                 2.239746e-01 1 1  ON 48
eH2_9                 2.350478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5860e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9063
    reference variance = 0.138465
====================================================
  Execution time = 2.0773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3343e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333575047912
                                         uncertainty =       0.004267712076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333575047912
                                         uncertainty =       0.004267712076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408306279
  error estimate for blocks of size 2^( 2) =       0.000420575973
  error estimate for blocks of size 2^( 3) =       0.000433197594
  error estimate for blocks of size 2^( 4) =       0.000444984517
  error estimate for blocks of size 2^( 5) =       0.000454421271
  error estimate for blocks of size 2^( 6) =       0.000461206810
  error estimate for blocks of size 2^( 7) =       0.000464773385

      target function =                  N/A
              le_mean =     -16.905742280901
             les_mean =     286.137549936889
             stat err =       0.000456346496
             autocorr =       1.249157852206
              std dev =       0.577432277736
             le_variance =       0.333428035371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574228090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905742280901       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905739038462       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905740552956       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905742111163       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905743967071       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745116428       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905746366588       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905746173782       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905746135352       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905745875065       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905746020186       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905746264937       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905746002757       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 2.387585e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905742280901       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905740392374       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905741170995       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905742431550       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905742883751       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905743166594       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905743430850       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905743503555       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905743488784       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905743348547       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 5.855582e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905742280901       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905741573650       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905741833355       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905742096979       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905742254074       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905742400457       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905742369914       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905742367893       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905742401742       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.904474e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6315e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.938925e-01 1 1  ON 0
 uu_1                 1.269088e-01 1 1  ON 1
 uu_2                 2.503871e-02 1 1  ON 2
 uu_3                -3.781053e-02 1 1  ON 3
 uu_4                -8.371141e-02 1 1  ON 4
 uu_5                -1.191038e-01 1 1  ON 5
 uu_6                -1.479575e-01 1 1  ON 6
 uu_7                -1.625588e-01 1 1  ON 7
 uu_8                -1.552610e-01 1 1  ON 8
 uu_9                -1.289611e-01 1 1  ON 9
 ud_0                 4.513124e-01 1 1  ON 10
 ud_1                 1.871712e-01 1 1  ON 11
 ud_2                 7.084376e-02 1 1  ON 12
 ud_3                 1.592644e-03 1 1  ON 13
 ud_4                -5.692301e-02 1 1  ON 14
 ud_5                -1.005139e-01 1 1  ON 15
 ud_6                -1.295340e-01 1 1  ON 16
 ud_7                -1.476898e-01 1 1  ON 17
 ud_8                -1.503051e-01 1 1  ON 18
 ud_9                -1.416958e-01 1 1  ON 19
 eO_0                -7.033466e-01 1 1  ON 20
 eO_1                -3.867498e-01 1 1  ON 21
 eO_2                 2.629867e-02 1 1  ON 22
 eO_3                 3.411798e-01 1 1  ON 23
 eO_4                 5.659970e-01 1 1  ON 24
 eO_5                 5.252898e-01 1 1  ON 25
 eO_6                 2.815033e-01 1 1  ON 26
 eO_7                -6.455066e-02 1 1  ON 27
 eO_8                -3.265468e-01 1 1  ON 28
 eO_9                -2.217406e-01 1 1  ON 29
eH1_0                -2.871602e-01 1 1  ON 30
eH1_1                -1.871205e-01 1 1  ON 31
eH1_2                -1.409179e-01 1 1  ON 32
eH1_3                -8.621215e-02 1 1  ON 33
eH1_4                -3.616613e-02 1 1  ON 34
eH1_5                 4.398407e-03 1 1  ON 35
eH1_6                 7.358556e-02 1 1  ON 36
eH1_7                 1.576038e-01 1 1  ON 37
eH1_8                 2.283797e-01 1 1  ON 38
eH1_9                 2.084948e-01 1 1  ON 39
eH2_0                -2.841366e-01 1 1  ON 40
eH2_1                -1.846850e-01 1 1  ON 41
eH2_2                -1.385054e-01 1 1  ON 42
eH2_3                -8.364614e-02 1 1  ON 43
eH2_4                -3.389150e-02 1 1  ON 44
eH2_5                 5.250462e-03 1 1  ON 45
eH2_6                 7.470022e-02 1 1  ON 46
eH2_7                 1.546812e-01 1 1  ON 47
eH2_8                 2.238822e-01 1 1  ON 48
eH2_9                 2.351499e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.222211
====================================================
  Execution time = 2.0119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4096e-01
  Total weights = 2.0000e+06
  Execution time = 1.8840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340753844833
                                         uncertainty =       0.003859332880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340753844833
                                         uncertainty =       0.003859332880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412784435
  error estimate for blocks of size 2^( 2) =       0.000425612041
  error estimate for blocks of size 2^( 3) =       0.000438840376
  error estimate for blocks of size 2^( 4) =       0.000450943004
  error estimate for blocks of size 2^( 5) =       0.000462708102
  error estimate for blocks of size 2^( 6) =       0.000473062940
  error estimate for blocks of size 2^( 7) =       0.000476219900

      target function =                  N/A
              le_mean =     -16.905955124996
             les_mean =     286.152100496854
             stat err =       0.000465733486
             autocorr =       1.272999710444
              std dev =       0.583765345731
             le_variance =       0.340781978877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340919962839
                                         uncertainty =       0.003868773241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340919962839
                                         uncertainty =       0.003868773241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412885004
  error estimate for blocks of size 2^( 2) =       0.000425705296
  error estimate for blocks of size 2^( 3) =       0.000438923916
  error estimate for blocks of size 2^( 4) =       0.000451018969
  error estimate for blocks of size 2^( 5) =       0.000462770385
  error estimate for blocks of size 2^( 6) =       0.000473122632
  error estimate for blocks of size 2^( 7) =       0.000476292812

      target function =                  N/A
              le_mean =     -16.905954079360
             les_mean =     286.152231216813
             stat err =       0.000465801199
             autocorr =       1.272749644312
              std dev =       0.583907573035
             le_variance =       0.340948053848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341114043851
                                         uncertainty =       0.003873119910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341114043851
                                         uncertainty =       0.003873119910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413002453
  error estimate for blocks of size 2^( 2) =       0.000425819134
  error estimate for blocks of size 2^( 3) =       0.000439034308
  error estimate for blocks of size 2^( 4) =       0.000451124799
  error estimate for blocks of size 2^( 5) =       0.000462869640
  error estimate for blocks of size 2^( 6) =       0.000473218338
  error estimate for blocks of size 2^( 7) =       0.000476388119

      target function =                  N/A
              le_mean =     -16.905954110759
             les_mean =     286.152426276166
             stat err =       0.000465900224
             autocorr =       1.272566765307
              std dev =       0.584073669722
             le_variance =       0.341142051663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340858132722
                                         uncertainty =       0.003862688781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340858132722
                                         uncertainty =       0.003862688781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412847567
  error estimate for blocks of size 2^( 2) =       0.000425671945
  error estimate for blocks of size 2^( 3) =       0.000438896686
  error estimate for blocks of size 2^( 4) =       0.000450995844
  error estimate for blocks of size 2^( 5) =       0.000462756250
  error estimate for blocks of size 2^( 6) =       0.000473109728
  error estimate for blocks of size 2^( 7) =       0.000476268774

      target function =                  N/A
              le_mean =     -16.905954304347
             les_mean =     286.152176997218
             stat err =       0.000465782649
             autocorr =       1.272879096459
              std dev =       0.583854628301
             le_variance =       0.340886226989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905955124996        initial  <--
     6.1035e-02     6.1035e-01             2.3876e-03       -16.905954079360
     2.4414e-01     2.4414e+00             5.8556e-04       -16.905954110759
     9.7656e-01     9.7656e+00             1.9045e-04       -16.905954304347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6307
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.937737e-01 1 1  ON 0
 uu_1                 1.265666e-01 1 1  ON 1
 uu_2                 2.494720e-02 1 1  ON 2
 uu_3                -3.765154e-02 1 1  ON 3
 uu_4                -8.357578e-02 1 1  ON 4
 uu_5                -1.188036e-01 1 1  ON 5
 uu_6                -1.479695e-01 1 1  ON 6
 uu_7                -1.625565e-01 1 1  ON 7
 uu_8                -1.553202e-01 1 1  ON 8
 uu_9                -1.288300e-01 1 1  ON 9
 ud_0                 4.512260e-01 1 1  ON 10
 ud_1                 1.873476e-01 1 1  ON 11
 ud_2                 7.076941e-02 1 1  ON 12
 ud_3                 1.341585e-03 1 1  ON 13
 ud_4                -5.725757e-02 1 1  ON 14
 ud_5                -1.006500e-01 1 1  ON 15
 ud_6                -1.293183e-01 1 1  ON 16
 ud_7                -1.478017e-01 1 1  ON 17
 ud_8                -1.503892e-01 1 1  ON 18
 ud_9                -1.414243e-01 1 1  ON 19
 eO_0                -7.038875e-01 1 1  ON 20
 eO_1                -3.868033e-01 1 1  ON 21
 eO_2                 2.627010e-02 1 1  ON 22
 eO_3                 3.409989e-01 1 1  ON 23
 eO_4                 5.658437e-01 1 1  ON 24
 eO_5                 5.256053e-01 1 1  ON 25
 eO_6                 2.812347e-01 1 1  ON 26
 eO_7                -6.459945e-02 1 1  ON 27
 eO_8                -3.263272e-01 1 1  ON 28
 eO_9                -2.211550e-01 1 1  ON 29
eH1_0                -2.872827e-01 1 1  ON 30
eH1_1                -1.866722e-01 1 1  ON 31
eH1_2                -1.406131e-01 1 1  ON 32
eH1_3                -8.610083e-02 1 1  ON 33
eH1_4                -3.622139e-02 1 1  ON 34
eH1_5                 4.601059e-03 1 1  ON 35
eH1_6                 7.350809e-02 1 1  ON 36
eH1_7                 1.574149e-01 1 1  ON 37
eH1_8                 2.282219e-01 1 1  ON 38
eH1_9                 2.081337e-01 1 1  ON 39
eH2_0                -2.839496e-01 1 1  ON 40
eH2_1                -1.846889e-01 1 1  ON 41
eH2_2                -1.382893e-01 1 1  ON 42
eH2_3                -8.379762e-02 1 1  ON 43
eH2_4                -3.407704e-02 1 1  ON 44
eH2_5                 5.117523e-03 1 1  ON 45
eH2_6                 7.487525e-02 1 1  ON 46
eH2_7                 1.547932e-01 1 1  ON 47
eH2_8                 2.239746e-01 1 1  ON 48
eH2_9                 2.350478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5951e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9529
    reference variance = 0.23976
====================================================
  Execution time = 2.0469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4577e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345890050919
                                         uncertainty =       0.006627422774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345890050919
                                         uncertainty =       0.006627422774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415793159
  error estimate for blocks of size 2^( 2) =       0.000428286840
  error estimate for blocks of size 2^( 3) =       0.000441778868
  error estimate for blocks of size 2^( 4) =       0.000453167898
  error estimate for blocks of size 2^( 5) =       0.000462623358
  error estimate for blocks of size 2^( 6) =       0.000470711243
  error estimate for blocks of size 2^( 7) =       0.000473987666

      target function =                  N/A
              le_mean =     -16.906357631311
             les_mean =     286.170696087170
             stat err =       0.000465122541
             autocorr =       1.251353737176
              std dev =       0.588020324691
             le_variance =       0.345767902250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635763131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906357631311       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906357681079       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358607906       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358799761       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906359208440       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906359056765       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358937857       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906358919426       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.443461e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906357631311       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906357647300       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906357911786       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906357939878       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358077447       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906358052667       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358014267       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906357997274       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.686409e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906357631311       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906357635615       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906357704281       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906357709028       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906357746265       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906357740972       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906357731328       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906357726253       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.061670e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6006e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.937281e-01 1 1  ON 0
 uu_1                 1.266009e-01 1 1  ON 1
 uu_2                 2.496873e-02 1 1  ON 2
 uu_3                -3.765954e-02 1 1  ON 3
 uu_4                -8.361133e-02 1 1  ON 4
 uu_5                -1.188448e-01 1 1  ON 5
 uu_6                -1.479261e-01 1 1  ON 6
 uu_7                -1.625488e-01 1 1  ON 7
 uu_8                -1.553199e-01 1 1  ON 8
 uu_9                -1.288249e-01 1 1  ON 9
 ud_0                 4.512268e-01 1 1  ON 10
 ud_1                 1.873367e-01 1 1  ON 11
 ud_2                 7.078356e-02 1 1  ON 12
 ud_3                 1.364212e-03 1 1  ON 13
 ud_4                -5.726940e-02 1 1  ON 14
 ud_5                -1.006088e-01 1 1  ON 15
 ud_6                -1.293394e-01 1 1  ON 16
 ud_7                -1.478192e-01 1 1  ON 17
 ud_8                -1.503880e-01 1 1  ON 18
 ud_9                -1.414269e-01 1 1  ON 19
 eO_0                -7.038578e-01 1 1  ON 20
 eO_1                -3.868210e-01 1 1  ON 21
 eO_2                 2.626987e-02 1 1  ON 22
 eO_3                 3.410500e-01 1 1  ON 23
 eO_4                 5.658343e-01 1 1  ON 24
 eO_5                 5.255947e-01 1 1  ON 25
 eO_6                 2.812692e-01 1 1  ON 26
 eO_7                -6.459810e-02 1 1  ON 27
 eO_8                -3.263527e-01 1 1  ON 28
 eO_9                -2.211948e-01 1 1  ON 29
eH1_0                -2.872560e-01 1 1  ON 30
eH1_1                -1.867304e-01 1 1  ON 31
eH1_2                -1.406007e-01 1 1  ON 32
eH1_3                -8.608283e-02 1 1  ON 33
eH1_4                -3.616755e-02 1 1  ON 34
eH1_5                 4.579727e-03 1 1  ON 35
eH1_6                 7.348845e-02 1 1  ON 36
eH1_7                 1.573973e-01 1 1  ON 37
eH1_8                 2.282066e-01 1 1  ON 38
eH1_9                 2.081479e-01 1 1  ON 39
eH2_0                -2.839815e-01 1 1  ON 40
eH2_1                -1.846786e-01 1 1  ON 41
eH2_2                -1.383662e-01 1 1  ON 42
eH2_3                -8.378120e-02 1 1  ON 43
eH2_4                -3.403687e-02 1 1  ON 44
eH2_5                 5.101699e-03 1 1  ON 45
eH2_6                 7.485362e-02 1 1  ON 46
eH2_7                 1.548205e-01 1 1  ON 47
eH2_8                 2.239961e-01 1 1  ON 48
eH2_9                 2.350588e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8904
    reference variance = 0.345917
====================================================
  Execution time = 1.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3757e-01
  Total weights = 2.0000e+06
  Execution time = 1.8989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337599753374
                                         uncertainty =       0.003703588859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337599753374
                                         uncertainty =       0.003703588859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410841298
  error estimate for blocks of size 2^( 2) =       0.000423490921
  error estimate for blocks of size 2^( 3) =       0.000436466372
  error estimate for blocks of size 2^( 4) =       0.000447953904
  error estimate for blocks of size 2^( 5) =       0.000457125415
  error estimate for blocks of size 2^( 6) =       0.000464414993
  error estimate for blocks of size 2^( 7) =       0.000472025506

      target function =                  N/A
              le_mean =     -16.905605245651
             les_mean =     286.137069697494
             stat err =       0.000460379954
             autocorr =       1.255696331691
              std dev =       0.581017335803
             le_variance =       0.337581144504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337547734086
                                         uncertainty =       0.003703508808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337547734086
                                         uncertainty =       0.003703508808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410809729
  error estimate for blocks of size 2^( 2) =       0.000423459445
  error estimate for blocks of size 2^( 3) =       0.000436434415
  error estimate for blocks of size 2^( 4) =       0.000447922365
  error estimate for blocks of size 2^( 5) =       0.000457093381
  error estimate for blocks of size 2^( 6) =       0.000464387329
  error estimate for blocks of size 2^( 7) =       0.000472000987

      target function =                  N/A
              le_mean =     -16.905606453621
             les_mean =     286.137058662116
             stat err =       0.000460351015
             autocorr =       1.255731449727
              std dev =       0.580972689691
             le_variance =       0.337529266167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337571217179
                                         uncertainty =       0.003703651518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337571217179
                                         uncertainty =       0.003703651518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410823987
  error estimate for blocks of size 2^( 2) =       0.000423473608
  error estimate for blocks of size 2^( 3) =       0.000436448681
  error estimate for blocks of size 2^( 4) =       0.000447936464
  error estimate for blocks of size 2^( 5) =       0.000457107585
  error estimate for blocks of size 2^( 6) =       0.000464399864
  error estimate for blocks of size 2^( 7) =       0.000472012698

      target function =                  N/A
              le_mean =     -16.905605914014
             les_mean =     286.137063847742
             stat err =       0.000460364153
             autocorr =       1.255715953967
              std dev =       0.580992854162
             le_variance =       0.337552696587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337596208714
                                         uncertainty =       0.003703603353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337596208714
                                         uncertainty =       0.003703603353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410839148
  error estimate for blocks of size 2^( 2) =       0.000423488763
  error estimate for blocks of size 2^( 3) =       0.000436464158
  error estimate for blocks of size 2^( 4) =       0.000447951722
  error estimate for blocks of size 2^( 5) =       0.000457123176
  error estimate for blocks of size 2^( 6) =       0.000464413115
  error estimate for blocks of size 2^( 7) =       0.000472023966

      target function =                  N/A
              le_mean =     -16.905605322864
             les_mean =     286.137068775363
             stat err =       0.000460377995
             autocorr =       1.255698782890
              std dev =       0.581014295610
             le_variance =       0.337577611703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905605245651        initial
     6.1035e-01     6.1035e+00             2.4435e-04       -16.905606453621  <--
     2.4414e+00     2.4414e+01             7.6864e-05       -16.905605914014
     9.7656e+00     9.7656e+01             2.0617e-05       -16.905605322864

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9589e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.936383e-01 1 1  ON 0
 uu_1                 1.266695e-01 1 1  ON 1
 uu_2                 2.500289e-02 1 1  ON 2
 uu_3                -3.768111e-02 1 1  ON 3
 uu_4                -8.369617e-02 1 1  ON 4
 uu_5                -1.189395e-01 1 1  ON 5
 uu_6                -1.478336e-01 1 1  ON 6
 uu_7                -1.625237e-01 1 1  ON 7
 uu_8                -1.553145e-01 1 1  ON 8
 uu_9                -1.288105e-01 1 1  ON 9
 ud_0                 4.512241e-01 1 1  ON 10
 ud_1                 1.873325e-01 1 1  ON 11
 ud_2                 7.081831e-02 1 1  ON 12
 ud_3                 1.412716e-03 1 1  ON 13
 ud_4                -5.728064e-02 1 1  ON 14
 ud_5                -1.005309e-01 1 1  ON 15
 ud_6                -1.293803e-01 1 1  ON 16
 ud_7                -1.478651e-01 1 1  ON 17
 ud_8                -1.503890e-01 1 1  ON 18
 ud_9                -1.414355e-01 1 1  ON 19
 eO_0                -7.037863e-01 1 1  ON 20
 eO_1                -3.868517e-01 1 1  ON 21
 eO_2                 2.627519e-02 1 1  ON 22
 eO_3                 3.411817e-01 1 1  ON 23
 eO_4                 5.658091e-01 1 1  ON 24
 eO_5                 5.255633e-01 1 1  ON 25
 eO_6                 2.813672e-01 1 1  ON 26
 eO_7                -6.459284e-02 1 1  ON 27
 eO_8                -3.264258e-01 1 1  ON 28
 eO_9                -2.213083e-01 1 1  ON 29
eH1_0                -2.871910e-01 1 1  ON 30
eH1_1                -1.868545e-01 1 1  ON 31
eH1_2                -1.405765e-01 1 1  ON 32
eH1_3                -8.603056e-02 1 1  ON 33
eH1_4                -3.603189e-02 1 1  ON 34
eH1_5                 4.521616e-03 1 1  ON 35
eH1_6                 7.342964e-02 1 1  ON 36
eH1_7                 1.573448e-01 1 1  ON 37
eH1_8                 2.281627e-01 1 1  ON 38
eH1_9                 2.081879e-01 1 1  ON 39
eH2_0                -2.840659e-01 1 1  ON 40
eH2_1                -1.846791e-01 1 1  ON 41
eH2_2                -1.385336e-01 1 1  ON 42
eH2_3                -8.376202e-02 1 1  ON 43
eH2_4                -3.393699e-02 1 1  ON 44
eH2_5                 5.068328e-03 1 1  ON 45
eH2_6                 7.479453e-02 1 1  ON 46
eH2_7                 1.548972e-01 1 1  ON 47
eH2_8                 2.240580e-01 1 1  ON 48
eH2_9                 2.350901e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.315654
====================================================
  Execution time = 2.0608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4030e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340202428573
                                         uncertainty =       0.004538104392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340202428573
                                         uncertainty =       0.004538104392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412493306
  error estimate for blocks of size 2^( 2) =       0.000425292304
  error estimate for blocks of size 2^( 3) =       0.000438843469
  error estimate for blocks of size 2^( 4) =       0.000451350113
  error estimate for blocks of size 2^( 5) =       0.000463374014
  error estimate for blocks of size 2^( 6) =       0.000474010465
  error estimate for blocks of size 2^( 7) =       0.000479913634

      target function =                  N/A
              le_mean =     -16.906481398036
             les_mean =     286.169414547543
             stat err =       0.000467162057
             autocorr =       1.282629759762
              std dev =       0.583353628219
             le_variance =       0.340301455556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648139804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906481398036       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906482255012       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906481367298       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906481953483       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480550824       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906481847760       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906481715031       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906481665744       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906481595389       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906481500853       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906481781213       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 9.017655e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906481398036       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906481735151       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906481307821       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906481573863       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906481066503       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906481493851       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906481483857       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906481326831       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.412077e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906481398036       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906481496421       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906481357678       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906481447749       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906481371656       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906481341901       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906481400919       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 6.007112e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6169e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.937460e-01 1 1  ON 0
 uu_1                 1.267344e-01 1 1  ON 1
 uu_2                 2.507723e-02 1 1  ON 2
 uu_3                -3.774851e-02 1 1  ON 3
 uu_4                -8.374343e-02 1 1  ON 4
 uu_5                -1.190576e-01 1 1  ON 5
 uu_6                -1.476703e-01 1 1  ON 6
 uu_7                -1.624103e-01 1 1  ON 7
 uu_8                -1.554833e-01 1 1  ON 8
 uu_9                -1.290517e-01 1 1  ON 9
 ud_0                 4.513157e-01 1 1  ON 10
 ud_1                 1.872918e-01 1 1  ON 11
 ud_2                 7.078787e-02 1 1  ON 12
 ud_3                 1.453143e-03 1 1  ON 13
 ud_4                -5.720620e-02 1 1  ON 14
 ud_5                -1.004366e-01 1 1  ON 15
 ud_6                -1.294009e-01 1 1  ON 16
 ud_7                -1.477194e-01 1 1  ON 17
 ud_8                -1.503912e-01 1 1  ON 18
 ud_9                -1.415538e-01 1 1  ON 19
 eO_0                -7.036379e-01 1 1  ON 20
 eO_1                -3.868224e-01 1 1  ON 21
 eO_2                 2.622198e-02 1 1  ON 22
 eO_3                 3.412491e-01 1 1  ON 23
 eO_4                 5.659867e-01 1 1  ON 24
 eO_5                 5.255324e-01 1 1  ON 25
 eO_6                 2.814261e-01 1 1  ON 26
 eO_7                -6.459656e-02 1 1  ON 27
 eO_8                -3.265596e-01 1 1  ON 28
 eO_9                -2.215123e-01 1 1  ON 29
eH1_0                -2.870473e-01 1 1  ON 30
eH1_1                -1.869320e-01 1 1  ON 31
eH1_2                -1.406891e-01 1 1  ON 32
eH1_3                -8.602939e-02 1 1  ON 33
eH1_4                -3.591584e-02 1 1  ON 34
eH1_5                 4.475817e-03 1 1  ON 35
eH1_6                 7.340955e-02 1 1  ON 36
eH1_7                 1.572749e-01 1 1  ON 37
eH1_8                 2.280291e-01 1 1  ON 38
eH1_9                 2.083000e-01 1 1  ON 39
eH2_0                -2.841775e-01 1 1  ON 40
eH2_1                -1.847130e-01 1 1  ON 41
eH2_2                -1.387160e-01 1 1  ON 42
eH2_3                -8.375688e-02 1 1  ON 43
eH2_4                -3.384918e-02 1 1  ON 44
eH2_5                 5.063335e-03 1 1  ON 45
eH2_6                 7.463938e-02 1 1  ON 46
eH2_7                 1.550118e-01 1 1  ON 47
eH2_8                 2.240854e-01 1 1  ON 48
eH2_9                 2.351894e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9401
    reference variance = 0.530984
====================================================
  Execution time = 2.2125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3706e-01
  Total weights = 2.0000e+06
  Execution time = 1.8971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336992950411
                                         uncertainty =       0.003491908702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336992950411
                                         uncertainty =       0.003491908702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410440191
  error estimate for blocks of size 2^( 2) =       0.000423169985
  error estimate for blocks of size 2^( 3) =       0.000436096590
  error estimate for blocks of size 2^( 4) =       0.000448217183
  error estimate for blocks of size 2^( 5) =       0.000458802218
  error estimate for blocks of size 2^( 6) =       0.000467066942
  error estimate for blocks of size 2^( 7) =       0.000471040421

      target function =                  N/A
              le_mean =     -16.906318532080
             les_mean =     286.160528441141
             stat err =       0.000461281691
             autocorr =       1.263085272398
              std dev =       0.580450085248
             le_variance =       0.336922301465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337258289179
                                         uncertainty =       0.003491261029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337258289179
                                         uncertainty =       0.003491261029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410601690
  error estimate for blocks of size 2^( 2) =       0.000423319071
  error estimate for blocks of size 2^( 3) =       0.000436231780
  error estimate for blocks of size 2^( 4) =       0.000448342492
  error estimate for blocks of size 2^( 5) =       0.000458916678
  error estimate for blocks of size 2^( 6) =       0.000467169370
  error estimate for blocks of size 2^( 7) =       0.000471152495

      target function =                  N/A
              le_mean =     -16.906320552288
             les_mean =     286.160861944170
             stat err =       0.000461395259
             autocorr =       1.262713399020
              std dev =       0.580678479077
             le_variance =       0.337187496064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337272928275
                                         uncertainty =       0.003491834647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337272928275
                                         uncertainty =       0.003491834647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410610607
  error estimate for blocks of size 2^( 2) =       0.000423328694
  error estimate for blocks of size 2^( 3) =       0.000436242748
  error estimate for blocks of size 2^( 4) =       0.000448353445
  error estimate for blocks of size 2^( 5) =       0.000458929136
  error estimate for blocks of size 2^( 6) =       0.000467182825
  error estimate for blocks of size 2^( 7) =       0.000471163343

      target function =                  N/A
              le_mean =     -16.906320016812
             les_mean =     286.160858483179
             stat err =       0.000461407187
             autocorr =       1.262723846903
              std dev =       0.580691089057
             le_variance =       0.337202140910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045798263
                                         uncertainty =       0.003492010145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045798263
                                         uncertainty =       0.003492010145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410472365
  error estimate for blocks of size 2^( 2) =       0.000423199986
  error estimate for blocks of size 2^( 3) =       0.000436124427
  error estimate for blocks of size 2^( 4) =       0.000448243251
  error estimate for blocks of size 2^( 5) =       0.000458826776
  error estimate for blocks of size 2^( 6) =       0.000467089657
  error estimate for blocks of size 2^( 7) =       0.000471064277

      target function =                  N/A
              le_mean =     -16.906318703288
             les_mean =     286.160587054073
             stat err =       0.000461305990
             autocorr =       1.263020327520
              std dev =       0.580495586047
             le_variance =       0.336975125420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906318532080        initial
     1.5259e-01     1.5259e+00             9.0177e-04       -16.906320552288  <--
     6.1035e-01     6.1035e+00             2.4121e-04       -16.906320016812
     2.4414e+00     2.4414e+01             6.0071e-05       -16.906318703288

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.1704e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.939144e-01 1 1  ON 0
 uu_1                 1.268648e-01 1 1  ON 1
 uu_2                 2.518166e-02 1 1  ON 2
 uu_3                -3.777280e-02 1 1  ON 3
 uu_4                -8.382976e-02 1 1  ON 4
 uu_5                -1.191871e-01 1 1  ON 5
 uu_6                -1.474930e-01 1 1  ON 6
 uu_7                -1.621549e-01 1 1  ON 7
 uu_8                -1.557979e-01 1 1  ON 8
 uu_9                -1.297123e-01 1 1  ON 9
 ud_0                 4.513969e-01 1 1  ON 10
 ud_1                 1.872808e-01 1 1  ON 11
 ud_2                 7.078462e-02 1 1  ON 12
 ud_3                 1.524429e-03 1 1  ON 13
 ud_4                -5.706604e-02 1 1  ON 14
 ud_5                -1.002259e-01 1 1  ON 15
 ud_6                -1.293033e-01 1 1  ON 16
 ud_7                -1.474172e-01 1 1  ON 17
 ud_8                -1.502844e-01 1 1  ON 18
 ud_9                -1.418315e-01 1 1  ON 19
 eO_0                -7.033788e-01 1 1  ON 20
 eO_1                -3.866784e-01 1 1  ON 21
 eO_2                 2.625242e-02 1 1  ON 22
 eO_3                 3.413880e-01 1 1  ON 23
 eO_4                 5.664249e-01 1 1  ON 24
 eO_5                 5.255407e-01 1 1  ON 25
 eO_6                 2.815742e-01 1 1  ON 26
 eO_7                -6.458688e-02 1 1  ON 27
 eO_8                -3.269333e-01 1 1  ON 28
 eO_9                -2.221410e-01 1 1  ON 29
eH1_0                -2.868021e-01 1 1  ON 30
eH1_1                -1.870450e-01 1 1  ON 31
eH1_2                -1.408639e-01 1 1  ON 32
eH1_3                -8.606071e-02 1 1  ON 33
eH1_4                -3.573987e-02 1 1  ON 34
eH1_5                 4.370476e-03 1 1  ON 35
eH1_6                 7.336737e-02 1 1  ON 36
eH1_7                 1.570765e-01 1 1  ON 37
eH1_8                 2.276390e-01 1 1  ON 38
eH1_9                 2.086608e-01 1 1  ON 39
eH2_0                -2.844382e-01 1 1  ON 40
eH2_1                -1.848745e-01 1 1  ON 41
eH2_2                -1.390441e-01 1 1  ON 42
eH2_3                -8.388376e-02 1 1  ON 43
eH2_4                -3.378906e-02 1 1  ON 44
eH2_5                 5.038317e-03 1 1  ON 45
eH2_6                 7.424787e-02 1 1  ON 46
eH2_7                 1.553433e-01 1 1  ON 47
eH2_8                 2.241782e-01 1 1  ON 48
eH2_9                 2.355133e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9137
    reference variance = 0.303081
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921976071
                                         uncertainty =       0.003087790630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921976071
                                         uncertainty =       0.003087790630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409800820
  error estimate for blocks of size 2^( 2) =       0.000422681700
  error estimate for blocks of size 2^( 3) =       0.000435670095
  error estimate for blocks of size 2^( 4) =       0.000448271537
  error estimate for blocks of size 2^( 5) =       0.000460379671
  error estimate for blocks of size 2^( 6) =       0.000470448718
  error estimate for blocks of size 2^( 7) =       0.000476570381

      target function =                  N/A
              le_mean =     -16.905990353954
             les_mean =     286.148383104162
             stat err =       0.000463917577
             autocorr =       1.281551337798
              std dev =       0.579545877500
             le_variance =       0.335873424127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599035395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905990353954       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905989848582       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990633253       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905990656942       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905989721374       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905990351582       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990198475       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905989983817       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905989797515       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905989580785       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905989449726       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905989635436       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905989740817       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 2.234375e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905990353954       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905990015938       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990629319       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905989941545       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905990021970       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905989823035       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990039435       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905989909277       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905989907788       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905989792780       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905989771160       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 6.332381e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905990353954       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905990208547       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990528491       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905990293586       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905990264500       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905990070026       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905990058287       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905990066027       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.514339e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6097e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.939367e-01 1 1  ON 0
 uu_1                 1.269254e-01 1 1  ON 1
 uu_2                 2.515308e-02 1 1  ON 2
 uu_3                -3.776535e-02 1 1  ON 3
 uu_4                -8.377504e-02 1 1  ON 4
 uu_5                -1.193875e-01 1 1  ON 5
 uu_6                -1.479303e-01 1 1  ON 6
 uu_7                -1.626842e-01 1 1  ON 7
 uu_8                -1.557573e-01 1 1  ON 8
 uu_9                -1.293183e-01 1 1  ON 9
 ud_0                 4.510982e-01 1 1  ON 10
 ud_1                 1.872399e-01 1 1  ON 11
 ud_2                 7.095523e-02 1 1  ON 12
 ud_3                 1.797446e-03 1 1  ON 13
 ud_4                -5.687291e-02 1 1  ON 14
 ud_5                -1.003425e-01 1 1  ON 15
 ud_6                -1.293853e-01 1 1  ON 16
 ud_7                -1.469754e-01 1 1  ON 17
 ud_8                -1.497902e-01 1 1  ON 18
 ud_9                -1.419376e-01 1 1  ON 19
 eO_0                -7.028457e-01 1 1  ON 20
 eO_1                -3.866245e-01 1 1  ON 21
 eO_2                 2.604384e-02 1 1  ON 22
 eO_3                 3.411678e-01 1 1  ON 23
 eO_4                 5.667446e-01 1 1  ON 24
 eO_5                 5.258286e-01 1 1  ON 25
 eO_6                 2.817485e-01 1 1  ON 26
 eO_7                -6.458067e-02 1 1  ON 27
 eO_8                -3.271405e-01 1 1  ON 28
 eO_9                -2.227317e-01 1 1  ON 29
eH1_0                -2.871043e-01 1 1  ON 30
eH1_1                -1.870915e-01 1 1  ON 31
eH1_2                -1.410437e-01 1 1  ON 32
eH1_3                -8.593488e-02 1 1  ON 33
eH1_4                -3.558566e-02 1 1  ON 34
eH1_5                 4.165427e-03 1 1  ON 35
eH1_6                 7.342694e-02 1 1  ON 36
eH1_7                 1.571352e-01 1 1  ON 37
eH1_8                 2.272953e-01 1 1  ON 38
eH1_9                 2.089715e-01 1 1  ON 39
eH2_0                -2.846241e-01 1 1  ON 40
eH2_1                -1.855077e-01 1 1  ON 41
eH2_2                -1.392070e-01 1 1  ON 42
eH2_3                -8.404109e-02 1 1  ON 43
eH2_4                -3.373604e-02 1 1  ON 44
eH2_5                 5.041522e-03 1 1  ON 45
eH2_6                 7.409531e-02 1 1  ON 46
eH2_7                 1.558054e-01 1 1  ON 47
eH2_8                 2.245136e-01 1 1  ON 48
eH2_9                 2.356719e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.19946
====================================================
  Execution time = 1.9952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352749862810
                                         uncertainty =       0.007194231374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352749862810
                                         uncertainty =       0.007194231374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419951310
  error estimate for blocks of size 2^( 2) =       0.000432075474
  error estimate for blocks of size 2^( 3) =       0.000444366824
  error estimate for blocks of size 2^( 4) =       0.000456158467
  error estimate for blocks of size 2^( 5) =       0.000467447135
  error estimate for blocks of size 2^( 6) =       0.000477000808
  error estimate for blocks of size 2^( 7) =       0.000482310027

      target function =                  N/A
              le_mean =     -16.906437063546
             les_mean =     286.180332212610
             stat err =       0.000470729109
             autocorr =       1.256447162525
              std dev =       0.593900837969
             le_variance =       0.352718205340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352316138975
                                         uncertainty =       0.007186180626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352316138975
                                         uncertainty =       0.007186180626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419693311
  error estimate for blocks of size 2^( 2) =       0.000431836516
  error estimate for blocks of size 2^( 3) =       0.000444141893
  error estimate for blocks of size 2^( 4) =       0.000455936368
  error estimate for blocks of size 2^( 5) =       0.000467228984
  error estimate for blocks of size 2^( 6) =       0.000476774102
  error estimate for blocks of size 2^( 7) =       0.000482075277

      target function =                  N/A
              le_mean =     -16.906437104721
             les_mean =     286.179900350219
             stat err =       0.000470503683
             autocorr =       1.256787810422
              std dev =       0.593535972356
             le_variance =       0.352284950480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352070127170
                                         uncertainty =       0.007181805953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352070127170
                                         uncertainty =       0.007181805953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419546875
  error estimate for blocks of size 2^( 2) =       0.000431699065
  error estimate for blocks of size 2^( 3) =       0.000444012810
  error estimate for blocks of size 2^( 4) =       0.000455815891
  error estimate for blocks of size 2^( 5) =       0.000467111681
  error estimate for blocks of size 2^( 6) =       0.000476655213
  error estimate for blocks of size 2^( 7) =       0.000481960700

      target function =                  N/A
              le_mean =     -16.906438726899
             les_mean =     286.179709411452
             stat err =       0.000470385871
             autocorr =       1.257035535431
              std dev =       0.593328881033
             le_variance =       0.352039161068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352590053533
                                         uncertainty =       0.007191347375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352590053533
                                         uncertainty =       0.007191347375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419856257
  error estimate for blocks of size 2^( 2) =       0.000431986688
  error estimate for blocks of size 2^( 3) =       0.000444282861
  error estimate for blocks of size 2^( 4) =       0.000456077457
  error estimate for blocks of size 2^( 5) =       0.000467367563
  error estimate for blocks of size 2^( 6) =       0.000476918678
  error estimate for blocks of size 2^( 7) =       0.000482228437

      target function =                  N/A
              le_mean =     -16.906437118412
             les_mean =     286.180174416052
             stat err =       0.000470648034
             autocorr =       1.256583165479
              std dev =       0.593766413256
             le_variance =       0.352558553510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906437063546        initial
     3.8147e-02     3.8147e-01             2.2344e-03       -16.906437104721
     1.5259e-01     1.5259e+00             6.3324e-04       -16.906438726899  <--
     6.1035e-01     6.1035e+00             2.5143e-04       -16.906437118412

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9480e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.939367e-01 1 1  ON 0
 uu_1                 1.269254e-01 1 1  ON 1
 uu_2                 2.515308e-02 1 1  ON 2
 uu_3                -3.776535e-02 1 1  ON 3
 uu_4                -8.377504e-02 1 1  ON 4
 uu_5                -1.193875e-01 1 1  ON 5
 uu_6                -1.479303e-01 1 1  ON 6
 uu_7                -1.626842e-01 1 1  ON 7
 uu_8                -1.557573e-01 1 1  ON 8
 uu_9                -1.293183e-01 1 1  ON 9
 ud_0                 4.510982e-01 1 1  ON 10
 ud_1                 1.872399e-01 1 1  ON 11
 ud_2                 7.095523e-02 1 1  ON 12
 ud_3                 1.797446e-03 1 1  ON 13
 ud_4                -5.687291e-02 1 1  ON 14
 ud_5                -1.003425e-01 1 1  ON 15
 ud_6                -1.293853e-01 1 1  ON 16
 ud_7                -1.469754e-01 1 1  ON 17
 ud_8                -1.497902e-01 1 1  ON 18
 ud_9                -1.419376e-01 1 1  ON 19
 eO_0                -7.028457e-01 1 1  ON 20
 eO_1                -3.866245e-01 1 1  ON 21
 eO_2                 2.604384e-02 1 1  ON 22
 eO_3                 3.411678e-01 1 1  ON 23
 eO_4                 5.667446e-01 1 1  ON 24
 eO_5                 5.258286e-01 1 1  ON 25
 eO_6                 2.817485e-01 1 1  ON 26
 eO_7                -6.458067e-02 1 1  ON 27
 eO_8                -3.271405e-01 1 1  ON 28
 eO_9                -2.227317e-01 1 1  ON 29
eH1_0                -2.871043e-01 1 1  ON 30
eH1_1                -1.870915e-01 1 1  ON 31
eH1_2                -1.410437e-01 1 1  ON 32
eH1_3                -8.593488e-02 1 1  ON 33
eH1_4                -3.558566e-02 1 1  ON 34
eH1_5                 4.165427e-03 1 1  ON 35
eH1_6                 7.342694e-02 1 1  ON 36
eH1_7                 1.571352e-01 1 1  ON 37
eH1_8                 2.272953e-01 1 1  ON 38
eH1_9                 2.089715e-01 1 1  ON 39
eH2_0                -2.846241e-01 1 1  ON 40
eH2_1                -1.855077e-01 1 1  ON 41
eH2_2                -1.392070e-01 1 1  ON 42
eH2_3                -8.404109e-02 1 1  ON 43
eH2_4                -3.373604e-02 1 1  ON 44
eH2_5                 5.041522e-03 1 1  ON 45
eH2_6                 7.409531e-02 1 1  ON 46
eH2_7                 1.558054e-01 1 1  ON 47
eH2_8                 2.245136e-01 1 1  ON 48
eH2_9                 2.356719e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.929
    reference variance = 0.169838
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5917e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359292900133
                                         uncertainty =       0.011562733783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359292900133
                                         uncertainty =       0.011562733783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423773377
  error estimate for blocks of size 2^( 2) =       0.000436455819
  error estimate for blocks of size 2^( 3) =       0.000448954822
  error estimate for blocks of size 2^( 4) =       0.000460928749
  error estimate for blocks of size 2^( 5) =       0.000471569509
  error estimate for blocks of size 2^( 6) =       0.000480342568
  error estimate for blocks of size 2^( 7) =       0.000486837711

      target function =                  N/A
              le_mean =     -16.905748707212
             les_mean =     286.163506921928
             stat err =       0.000474919634
             autocorr =       1.255951620185
              std dev =       0.599306057125
             le_variance =       0.359167750107


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574870721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748707212       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905751269245       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905752758974       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751929313       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905752916872       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905754917907       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905752977947       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905753147639       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905754044780       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905753840807       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905753341048       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905753529443       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905753352658       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 2.867711e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748707212       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905750540600       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751617291       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751346966       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905751530450       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905752726443       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905751929287       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905752096006       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905752031930       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905752031114       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 7.475401e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748707212       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749564895       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905750116601       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905750246083       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905750125749       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905750314420       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905750451012       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905750288632       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.854971e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6365e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.939531e-01 1 1  ON 0
 uu_1                 1.267112e-01 1 1  ON 1
 uu_2                 2.487068e-02 1 1  ON 2
 uu_3                -3.814169e-02 1 1  ON 3
 uu_4                -8.423419e-02 1 1  ON 4
 uu_5                -1.195693e-01 1 1  ON 5
 uu_6                -1.480279e-01 1 1  ON 6
 uu_7                -1.627633e-01 1 1  ON 7
 uu_8                -1.556433e-01 1 1  ON 8
 uu_9                -1.288940e-01 1 1  ON 9
 ud_0                 4.512425e-01 1 1  ON 10
 ud_1                 1.872930e-01 1 1  ON 11
 ud_2                 7.091049e-02 1 1  ON 12
 ud_3                 1.682776e-03 1 1  ON 13
 ud_4                -5.669581e-02 1 1  ON 14
 ud_5                -1.003434e-01 1 1  ON 15
 ud_6                -1.295858e-01 1 1  ON 16
 ud_7                -1.475399e-01 1 1  ON 17
 ud_8                -1.493959e-01 1 1  ON 18
 ud_9                -1.414520e-01 1 1  ON 19
 eO_0                -7.028454e-01 1 1  ON 20
 eO_1                -3.866615e-01 1 1  ON 21
 eO_2                 2.604336e-02 1 1  ON 22
 eO_3                 3.414025e-01 1 1  ON 23
 eO_4                 5.668775e-01 1 1  ON 24
 eO_5                 5.260918e-01 1 1  ON 25
 eO_6                 2.818659e-01 1 1  ON 26
 eO_7                -6.455558e-02 1 1  ON 27
 eO_8                -3.272457e-01 1 1  ON 28
 eO_9                -2.232149e-01 1 1  ON 29
eH1_0                -2.872942e-01 1 1  ON 30
eH1_1                -1.874227e-01 1 1  ON 31
eH1_2                -1.410535e-01 1 1  ON 32
eH1_3                -8.594927e-02 1 1  ON 33
eH1_4                -3.593584e-02 1 1  ON 34
eH1_5                 4.025721e-03 1 1  ON 35
eH1_6                 7.306894e-02 1 1  ON 36
eH1_7                 1.570897e-01 1 1  ON 37
eH1_8                 2.276602e-01 1 1  ON 38
eH1_9                 2.097190e-01 1 1  ON 39
eH2_0                -2.850457e-01 1 1  ON 40
eH2_1                -1.856624e-01 1 1  ON 41
eH2_2                -1.394533e-01 1 1  ON 42
eH2_3                -8.412393e-02 1 1  ON 43
eH2_4                -3.378029e-02 1 1  ON 44
eH2_5                 4.583507e-03 1 1  ON 45
eH2_6                 7.389447e-02 1 1  ON 46
eH2_7                 1.565059e-01 1 1  ON 47
eH2_8                 2.247307e-01 1 1  ON 48
eH2_9                 2.358163e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.284322
====================================================
  Execution time = 2.0114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3538e-01
  Total weights = 2.0000e+06
  Execution time = 1.8946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335157641415
                                         uncertainty =       0.002646641336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335157641415
                                         uncertainty =       0.002646641336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409369469
  error estimate for blocks of size 2^( 2) =       0.000422026923
  error estimate for blocks of size 2^( 3) =       0.000435190382
  error estimate for blocks of size 2^( 4) =       0.000447524612
  error estimate for blocks of size 2^( 5) =       0.000458279254
  error estimate for blocks of size 2^( 6) =       0.000464892047
  error estimate for blocks of size 2^( 7) =       0.000467612223

      target function =                  N/A
              le_mean =     -16.906573768144
             les_mean =     286.167403135057
             stat err =       0.000459577034
             autocorr =       1.260334242444
              std dev =       0.578935855636
             le_variance =       0.335166724941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470025941
                                         uncertainty =       0.002648623941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335470025941
                                         uncertainty =       0.002648623941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409560203
  error estimate for blocks of size 2^( 2) =       0.000422216382
  error estimate for blocks of size 2^( 3) =       0.000435379558
  error estimate for blocks of size 2^( 4) =       0.000447706204
  error estimate for blocks of size 2^( 5) =       0.000458449456
  error estimate for blocks of size 2^( 6) =       0.000465046172
  error estimate for blocks of size 2^( 7) =       0.000467764885

      target function =                  N/A
              le_mean =     -16.906570224031
             les_mean =     286.167595691297
             stat err =       0.000459741679
             autocorr =       1.260062994087
              std dev =       0.579205592998
             le_variance =       0.335479118960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335590700220
                                         uncertainty =       0.002649033005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335590700220
                                         uncertainty =       0.002649033005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409633875
  error estimate for blocks of size 2^( 2) =       0.000422284263
  error estimate for blocks of size 2^( 3) =       0.000435441807
  error estimate for blocks of size 2^( 4) =       0.000447766493
  error estimate for blocks of size 2^( 5) =       0.000458511639
  error estimate for blocks of size 2^( 6) =       0.000465108212
  error estimate for blocks of size 2^( 7) =       0.000467826838

      target function =                  N/A
              le_mean =     -16.906569468141
             les_mean =     286.167690836466
             stat err =       0.000459803295
             autocorr =       1.259947448583
              std dev =       0.579309781721
             le_variance =       0.335599823198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335254564935
                                         uncertainty =       0.002647033883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335254564935
                                         uncertainty =       0.002647033883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409428659
  error estimate for blocks of size 2^( 2) =       0.000422083870
  error estimate for blocks of size 2^( 3) =       0.000435245291
  error estimate for blocks of size 2^( 4) =       0.000447576981
  error estimate for blocks of size 2^( 5) =       0.000458329733
  error estimate for blocks of size 2^( 6) =       0.000464938694
  error estimate for blocks of size 2^( 7) =       0.000467658889

      target function =                  N/A
              le_mean =     -16.906572348334
             les_mean =     286.167452055236
             stat err =       0.000459626074
             autocorr =       1.260238776011
              std dev =       0.579019562208
             le_variance =       0.335263653419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906573768144        initial  <--
     3.8147e-02     3.8147e-01             2.8677e-03       -16.906570224031
     1.5259e-01     1.5259e+00             7.4754e-04       -16.906569468141
     6.1035e-01     6.1035e+00             1.8550e-04       -16.906572348334

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6839
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.939367e-01 1 1  ON 0
 uu_1                 1.269254e-01 1 1  ON 1
 uu_2                 2.515308e-02 1 1  ON 2
 uu_3                -3.776535e-02 1 1  ON 3
 uu_4                -8.377504e-02 1 1  ON 4
 uu_5                -1.193875e-01 1 1  ON 5
 uu_6                -1.479303e-01 1 1  ON 6
 uu_7                -1.626842e-01 1 1  ON 7
 uu_8                -1.557573e-01 1 1  ON 8
 uu_9                -1.293183e-01 1 1  ON 9
 ud_0                 4.510982e-01 1 1  ON 10
 ud_1                 1.872399e-01 1 1  ON 11
 ud_2                 7.095523e-02 1 1  ON 12
 ud_3                 1.797446e-03 1 1  ON 13
 ud_4                -5.687291e-02 1 1  ON 14
 ud_5                -1.003425e-01 1 1  ON 15
 ud_6                -1.293853e-01 1 1  ON 16
 ud_7                -1.469754e-01 1 1  ON 17
 ud_8                -1.497902e-01 1 1  ON 18
 ud_9                -1.419376e-01 1 1  ON 19
 eO_0                -7.028457e-01 1 1  ON 20
 eO_1                -3.866245e-01 1 1  ON 21
 eO_2                 2.604384e-02 1 1  ON 22
 eO_3                 3.411678e-01 1 1  ON 23
 eO_4                 5.667446e-01 1 1  ON 24
 eO_5                 5.258286e-01 1 1  ON 25
 eO_6                 2.817485e-01 1 1  ON 26
 eO_7                -6.458067e-02 1 1  ON 27
 eO_8                -3.271405e-01 1 1  ON 28
 eO_9                -2.227317e-01 1 1  ON 29
eH1_0                -2.871043e-01 1 1  ON 30
eH1_1                -1.870915e-01 1 1  ON 31
eH1_2                -1.410437e-01 1 1  ON 32
eH1_3                -8.593488e-02 1 1  ON 33
eH1_4                -3.558566e-02 1 1  ON 34
eH1_5                 4.165427e-03 1 1  ON 35
eH1_6                 7.342694e-02 1 1  ON 36
eH1_7                 1.571352e-01 1 1  ON 37
eH1_8                 2.272953e-01 1 1  ON 38
eH1_9                 2.089715e-01 1 1  ON 39
eH2_0                -2.846241e-01 1 1  ON 40
eH2_1                -1.855077e-01 1 1  ON 41
eH2_2                -1.392070e-01 1 1  ON 42
eH2_3                -8.404109e-02 1 1  ON 43
eH2_4                -3.373604e-02 1 1  ON 44
eH2_5                 5.041522e-03 1 1  ON 45
eH2_6                 7.409531e-02 1 1  ON 46
eH2_7                 1.558054e-01 1 1  ON 47
eH2_8                 2.245136e-01 1 1  ON 48
eH2_9                 2.356719e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8669
    reference variance = 0.302856
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338445963164
                                         uncertainty =       0.003789707608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338445963164
                                         uncertainty =       0.003789707608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411370305
  error estimate for blocks of size 2^( 2) =       0.000423842489
  error estimate for blocks of size 2^( 3) =       0.000436043952
  error estimate for blocks of size 2^( 4) =       0.000446746979
  error estimate for blocks of size 2^( 5) =       0.000456013147
  error estimate for blocks of size 2^( 6) =       0.000462452234
  error estimate for blocks of size 2^( 7) =       0.000468017060

      target function =                  N/A
              le_mean =     -16.906313001711
             les_mean =     286.161870197520
             stat err =       0.000458307355
             autocorr =       1.241217177400
              std dev =       0.581765463852
             le_variance =       0.338451054931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631300171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313001711       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313831009       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906314340508       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906314843942       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906314464776       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906314987495       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314788787       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906314715213       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906314813009       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 3.607214e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313001711       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313244828       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313360712       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313455958       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313320626       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313508076       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313446746       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313436601       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 9.601899e-05

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313001711       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313065232       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313092152       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313112049       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313073571       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313126173       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313111759       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313108282       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.415905e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6131e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.939675e-01 1 1  ON 0
 uu_1                 1.269542e-01 1 1  ON 1
 uu_2                 2.517404e-02 1 1  ON 2
 uu_3                -3.773560e-02 1 1  ON 3
 uu_4                -8.376627e-02 1 1  ON 4
 uu_5                -1.193889e-01 1 1  ON 5
 uu_6                -1.479731e-01 1 1  ON 6
 uu_7                -1.627440e-01 1 1  ON 7
 uu_8                -1.558177e-01 1 1  ON 8
 uu_9                -1.293443e-01 1 1  ON 9
 ud_0                 4.511825e-01 1 1  ON 10
 ud_1                 1.872440e-01 1 1  ON 11
 ud_2                 7.102338e-02 1 1  ON 12
 ud_3                 1.811321e-03 1 1  ON 13
 ud_4                -5.681727e-02 1 1  ON 14
 ud_5                -1.003168e-01 1 1  ON 15
 ud_6                -1.293462e-01 1 1  ON 16
 ud_7                -1.470625e-01 1 1  ON 17
 ud_8                -1.498862e-01 1 1  ON 18
 ud_9                -1.419858e-01 1 1  ON 19
 eO_0                -7.028293e-01 1 1  ON 20
 eO_1                -3.865929e-01 1 1  ON 21
 eO_2                 2.608710e-02 1 1  ON 22
 eO_3                 3.411837e-01 1 1  ON 23
 eO_4                 5.667977e-01 1 1  ON 24
 eO_5                 5.258846e-01 1 1  ON 25
 eO_6                 2.817072e-01 1 1  ON 26
 eO_7                -6.460850e-02 1 1  ON 27
 eO_8                -3.272051e-01 1 1  ON 28
 eO_9                -2.228002e-01 1 1  ON 29
eH1_0                -2.870506e-01 1 1  ON 30
eH1_1                -1.871241e-01 1 1  ON 31
eH1_2                -1.410844e-01 1 1  ON 32
eH1_3                -8.595532e-02 1 1  ON 33
eH1_4                -3.559308e-02 1 1  ON 34
eH1_5                 4.170339e-03 1 1  ON 35
eH1_6                 7.342760e-02 1 1  ON 36
eH1_7                 1.571074e-01 1 1  ON 37
eH1_8                 2.273175e-01 1 1  ON 38
eH1_9                 2.089940e-01 1 1  ON 39
eH2_0                -2.846621e-01 1 1  ON 40
eH2_1                -1.855445e-01 1 1  ON 41
eH2_2                -1.391978e-01 1 1  ON 42
eH2_3                -8.404618e-02 1 1  ON 43
eH2_4                -3.373692e-02 1 1  ON 44
eH2_5                 5.066745e-03 1 1  ON 45
eH2_6                 7.409204e-02 1 1  ON 46
eH2_7                 1.557914e-01 1 1  ON 47
eH2_8                 2.245079e-01 1 1  ON 48
eH2_9                 2.356930e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.984
    reference variance = 0.907267
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4468e-01
  Total weights = 2.0000e+06
  Execution time = 1.8927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344601230142
                                         uncertainty =       0.006435971149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344601230142
                                         uncertainty =       0.006435971149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415113918
  error estimate for blocks of size 2^( 2) =       0.000427752553
  error estimate for blocks of size 2^( 3) =       0.000440340170
  error estimate for blocks of size 2^( 4) =       0.000452266874
  error estimate for blocks of size 2^( 5) =       0.000463797760
  error estimate for blocks of size 2^( 6) =       0.000472301047
  error estimate for blocks of size 2^( 7) =       0.000477027343

      target function =                  N/A
              le_mean =     -16.906726770762
             les_mean =     286.182049059089
             stat err =       0.000466348256
             autocorr =       1.262077789172
              std dev =       0.587059733080
             le_variance =       0.344639130204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344690643825
                                         uncertainty =       0.006438821311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344690643825
                                         uncertainty =       0.006438821311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415167738
  error estimate for blocks of size 2^( 2) =       0.000427803547
  error estimate for blocks of size 2^( 3) =       0.000440386200
  error estimate for blocks of size 2^( 4) =       0.000452308296
  error estimate for blocks of size 2^( 5) =       0.000463836390
  error estimate for blocks of size 2^( 6) =       0.000472347269
  error estimate for blocks of size 2^( 7) =       0.000477077886

      target function =                  N/A
              le_mean =     -16.906725440686
             les_mean =     286.182093455129
             stat err =       0.000466392460
             autocorr =       1.261989807525
              std dev =       0.587135845225
             le_variance =       0.344728500748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344678896122
                                         uncertainty =       0.006438653382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344678896122
                                         uncertainty =       0.006438653382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415160672
  error estimate for blocks of size 2^( 2) =       0.000427797288
  error estimate for blocks of size 2^( 3) =       0.000440381508
  error estimate for blocks of size 2^( 4) =       0.000452305359
  error estimate for blocks of size 2^( 5) =       0.000463834537
  error estimate for blocks of size 2^( 6) =       0.000472343120
  error estimate for blocks of size 2^( 7) =       0.000477073752

      target function =                  N/A
              le_mean =     -16.906725393844
             les_mean =     286.182080138249
             stat err =       0.000466389192
             autocorr =       1.262015073839
              std dev =       0.587125853426
             le_variance =       0.344716767761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344612795687
                                         uncertainty =       0.006436397979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344612795687
                                         uncertainty =       0.006436397979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415120881
  error estimate for blocks of size 2^( 2) =       0.000427759232
  error estimate for blocks of size 2^( 3) =       0.000440346376
  error estimate for blocks of size 2^( 4) =       0.000452272699
  error estimate for blocks of size 2^( 5) =       0.000463803347
  error estimate for blocks of size 2^( 6) =       0.000472307382
  error estimate for blocks of size 2^( 7) =       0.000477034344

      target function =                  N/A
              le_mean =     -16.906726546176
             les_mean =     286.182053026147
             stat err =       0.000466354443
             autocorr =       1.262068942625
              std dev =       0.587069579604
             le_variance =       0.344650691297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906726770762        initial  <--
     3.8147e-01     3.8147e+00             3.6072e-04       -16.906725440686
     1.5259e+00     1.5259e+01             9.6019e-05       -16.906725393844
     6.1035e+00     6.1035e+01             2.4159e-05       -16.906726546176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7112
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.939367e-01 1 1  ON 0
 uu_1                 1.269254e-01 1 1  ON 1
 uu_2                 2.515308e-02 1 1  ON 2
 uu_3                -3.776535e-02 1 1  ON 3
 uu_4                -8.377504e-02 1 1  ON 4
 uu_5                -1.193875e-01 1 1  ON 5
 uu_6                -1.479303e-01 1 1  ON 6
 uu_7                -1.626842e-01 1 1  ON 7
 uu_8                -1.557573e-01 1 1  ON 8
 uu_9                -1.293183e-01 1 1  ON 9
 ud_0                 4.510982e-01 1 1  ON 10
 ud_1                 1.872399e-01 1 1  ON 11
 ud_2                 7.095523e-02 1 1  ON 12
 ud_3                 1.797446e-03 1 1  ON 13
 ud_4                -5.687291e-02 1 1  ON 14
 ud_5                -1.003425e-01 1 1  ON 15
 ud_6                -1.293853e-01 1 1  ON 16
 ud_7                -1.469754e-01 1 1  ON 17
 ud_8                -1.497902e-01 1 1  ON 18
 ud_9                -1.419376e-01 1 1  ON 19
 eO_0                -7.028457e-01 1 1  ON 20
 eO_1                -3.866245e-01 1 1  ON 21
 eO_2                 2.604384e-02 1 1  ON 22
 eO_3                 3.411678e-01 1 1  ON 23
 eO_4                 5.667446e-01 1 1  ON 24
 eO_5                 5.258286e-01 1 1  ON 25
 eO_6                 2.817485e-01 1 1  ON 26
 eO_7                -6.458067e-02 1 1  ON 27
 eO_8                -3.271405e-01 1 1  ON 28
 eO_9                -2.227317e-01 1 1  ON 29
eH1_0                -2.871043e-01 1 1  ON 30
eH1_1                -1.870915e-01 1 1  ON 31
eH1_2                -1.410437e-01 1 1  ON 32
eH1_3                -8.593488e-02 1 1  ON 33
eH1_4                -3.558566e-02 1 1  ON 34
eH1_5                 4.165427e-03 1 1  ON 35
eH1_6                 7.342694e-02 1 1  ON 36
eH1_7                 1.571352e-01 1 1  ON 37
eH1_8                 2.272953e-01 1 1  ON 38
eH1_9                 2.089715e-01 1 1  ON 39
eH2_0                -2.846241e-01 1 1  ON 40
eH2_1                -1.855077e-01 1 1  ON 41
eH2_2                -1.392070e-01 1 1  ON 42
eH2_3                -8.404109e-02 1 1  ON 43
eH2_4                -3.373604e-02 1 1  ON 44
eH2_5                 5.041522e-03 1 1  ON 45
eH2_6                 7.409531e-02 1 1  ON 46
eH2_7                 1.558054e-01 1 1  ON 47
eH2_8                 2.245136e-01 1 1  ON 48
eH2_9                 2.356719e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9378
    reference variance = 0.297594
====================================================
  Execution time = 2.0811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3593e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335786891901
                                         uncertainty =       0.002849587295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335786891901
                                         uncertainty =       0.002849587295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409833780
  error estimate for blocks of size 2^( 2) =       0.000422693753
  error estimate for blocks of size 2^( 3) =       0.000435789843
  error estimate for blocks of size 2^( 4) =       0.000447890929
  error estimate for blocks of size 2^( 5) =       0.000457956432
  error estimate for blocks of size 2^( 6) =       0.000466177483
  error estimate for blocks of size 2^( 7) =       0.000471246272

      target function =                  N/A
              le_mean =     -16.906060812040
             les_mean =     286.150819466377
             stat err =       0.000460817779
             autocorr =       1.264279074459
              std dev =       0.579592489557
             le_variance =       0.335927453951


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606081204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906060812040       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906060874390       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906060894748       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906060943914       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906060886756       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906060915462       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906060923676       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.774563e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906060812040       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906060828086       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906060833790       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906060846775       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906060831968       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906060838576       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906060840297       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 9.589209e-06

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906060812040       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906060816081       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906060817550       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906060820845       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906060817119       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906060818709       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906060819117       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 2.406731e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6285e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.939336e-01 1 1  ON 0
 uu_1                 1.269230e-01 1 1  ON 1
 uu_2                 2.515692e-02 1 1  ON 2
 uu_3                -3.776963e-02 1 1  ON 3
 uu_4                -8.377771e-02 1 1  ON 4
 uu_5                -1.193851e-01 1 1  ON 5
 uu_6                -1.479343e-01 1 1  ON 6
 uu_7                -1.626805e-01 1 1  ON 7
 uu_8                -1.557592e-01 1 1  ON 8
 uu_9                -1.293179e-01 1 1  ON 9
 ud_0                 4.510964e-01 1 1  ON 10
 ud_1                 1.872414e-01 1 1  ON 11
 ud_2                 7.095210e-02 1 1  ON 12
 ud_3                 1.797197e-03 1 1  ON 13
 ud_4                -5.687372e-02 1 1  ON 14
 ud_5                -1.003439e-01 1 1  ON 15
 ud_6                -1.293846e-01 1 1  ON 16
 ud_7                -1.469779e-01 1 1  ON 17
 ud_8                -1.497854e-01 1 1  ON 18
 ud_9                -1.419313e-01 1 1  ON 19
 eO_0                -7.028432e-01 1 1  ON 20
 eO_1                -3.866292e-01 1 1  ON 21
 eO_2                 2.604530e-02 1 1  ON 22
 eO_3                 3.411753e-01 1 1  ON 23
 eO_4                 5.667475e-01 1 1  ON 24
 eO_5                 5.258271e-01 1 1  ON 25
 eO_6                 2.817486e-01 1 1  ON 26
 eO_7                -6.457889e-02 1 1  ON 27
 eO_8                -3.271439e-01 1 1  ON 28
 eO_9                -2.227370e-01 1 1  ON 29
eH1_0                -2.871058e-01 1 1  ON 30
eH1_1                -1.870921e-01 1 1  ON 31
eH1_2                -1.410446e-01 1 1  ON 32
eH1_3                -8.593675e-02 1 1  ON 33
eH1_4                -3.558289e-02 1 1  ON 34
eH1_5                 4.163431e-03 1 1  ON 35
eH1_6                 7.342680e-02 1 1  ON 36
eH1_7                 1.571343e-01 1 1  ON 37
eH1_8                 2.272964e-01 1 1  ON 38
eH1_9                 2.089734e-01 1 1  ON 39
eH2_0                -2.846337e-01 1 1  ON 40
eH2_1                -1.855124e-01 1 1  ON 41
eH2_2                -1.392088e-01 1 1  ON 42
eH2_3                -8.404717e-02 1 1  ON 43
eH2_4                -3.374131e-02 1 1  ON 44
eH2_5                 5.047096e-03 1 1  ON 45
eH2_6                 7.409448e-02 1 1  ON 46
eH2_7                 1.558113e-01 1 1  ON 47
eH2_8                 2.245186e-01 1 1  ON 48
eH2_9                 2.356774e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.162106
====================================================
  Execution time = 1.9973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3599e-01
  Total weights = 2.0000e+06
  Execution time = 1.8950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335926071530
                                         uncertainty =       0.002714158143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335926071530
                                         uncertainty =       0.002714158143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409871825
  error estimate for blocks of size 2^( 2) =       0.000422631370
  error estimate for blocks of size 2^( 3) =       0.000435727513
  error estimate for blocks of size 2^( 4) =       0.000447785706
  error estimate for blocks of size 2^( 5) =       0.000458871649
  error estimate for blocks of size 2^( 6) =       0.000465643468
  error estimate for blocks of size 2^( 7) =       0.000472490121

      target function =                  N/A
              le_mean =     -16.906580277781
             les_mean =     286.168446347212
             stat err =       0.000461197736
             autocorr =       1.266129715214
              std dev =       0.579646294017
             le_variance =       0.335989826167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335914849796
                                         uncertainty =       0.002714079445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335914849796
                                         uncertainty =       0.002714079445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409864976
  error estimate for blocks of size 2^( 2) =       0.000422624916
  error estimate for blocks of size 2^( 3) =       0.000435721359
  error estimate for blocks of size 2^( 4) =       0.000447779799
  error estimate for blocks of size 2^( 5) =       0.000458865496
  error estimate for blocks of size 2^( 6) =       0.000465636969
  error estimate for blocks of size 2^( 7) =       0.000472484445

      target function =                  N/A
              le_mean =     -16.906580502353
             les_mean =     286.168442711306
             stat err =       0.000461191677
             autocorr =       1.266138767392
              std dev =       0.579636607510
             le_variance =       0.335978596766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335920001940
                                         uncertainty =       0.002714114121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335920001940
                                         uncertainty =       0.002714114121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409868121
  error estimate for blocks of size 2^( 2) =       0.000422627874
  error estimate for blocks of size 2^( 3) =       0.000435724174
  error estimate for blocks of size 2^( 4) =       0.000447782506
  error estimate for blocks of size 2^( 5) =       0.000458868323
  error estimate for blocks of size 2^( 6) =       0.000465639976
  error estimate for blocks of size 2^( 7) =       0.000472487084

      target function =                  N/A
              le_mean =     -16.906580398780
             les_mean =     286.168444365284
             stat err =       0.000461194472
             autocorr =       1.266134682303
              std dev =       0.579641055190
             le_variance =       0.335983752861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335925295370
                                         uncertainty =       0.002714152468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335925295370
                                         uncertainty =       0.002714152468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409871351
  error estimate for blocks of size 2^( 2) =       0.000422630922
  error estimate for blocks of size 2^( 3) =       0.000435727086
  error estimate for blocks of size 2^( 4) =       0.000447785296
  error estimate for blocks of size 2^( 5) =       0.000458871223
  error estimate for blocks of size 2^( 6) =       0.000465643022
  error estimate for blocks of size 2^( 7) =       0.000472489733

      target function =                  N/A
              le_mean =     -16.906580293136
             les_mean =     286.168446089820
             stat err =       0.000461197319
             autocorr =       1.266130352403
              std dev =       0.579645624108
             le_variance =       0.335989049547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906580277781        initial
     3.8147e+00     3.8147e+01             3.7746e-05       -16.906580502353  <--
     1.5259e+01     1.5259e+02             9.5892e-06       -16.906580398780
     6.1035e+01     6.1035e+02             2.4067e-06       -16.906580293136

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.9532e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.939244e-01 1 1  ON 0
 uu_1                 1.269168e-01 1 1  ON 1
 uu_2                 2.516677e-02 1 1  ON 2
 uu_3                -3.778106e-02 1 1  ON 3
 uu_4                -8.378590e-02 1 1  ON 4
 uu_5                -1.193783e-01 1 1  ON 5
 uu_6                -1.479461e-01 1 1  ON 6
 uu_7                -1.626696e-01 1 1  ON 7
 uu_8                -1.557648e-01 1 1  ON 8
 uu_9                -1.293167e-01 1 1  ON 9
 ud_0                 4.510915e-01 1 1  ON 10
 ud_1                 1.872454e-01 1 1  ON 11
 ud_2                 7.094363e-02 1 1  ON 12
 ud_3                 1.795857e-03 1 1  ON 13
 ud_4                -5.687615e-02 1 1  ON 14
 ud_5                -1.003478e-01 1 1  ON 15
 ud_6                -1.293828e-01 1 1  ON 16
 ud_7                -1.469854e-01 1 1  ON 17
 ud_8                -1.497711e-01 1 1  ON 18
 ud_9                -1.419128e-01 1 1  ON 19
 eO_0                -7.028366e-01 1 1  ON 20
 eO_1                -3.866420e-01 1 1  ON 21
 eO_2                 2.604961e-02 1 1  ON 22
 eO_3                 3.411970e-01 1 1  ON 23
 eO_4                 5.667564e-01 1 1  ON 24
 eO_5                 5.258227e-01 1 1  ON 25
 eO_6                 2.817487e-01 1 1  ON 26
 eO_7                -6.457361e-02 1 1  ON 27
 eO_8                -3.271539e-01 1 1  ON 28
 eO_9                -2.227525e-01 1 1  ON 29
eH1_0                -2.871098e-01 1 1  ON 30
eH1_1                -1.870940e-01 1 1  ON 31
eH1_2                -1.410474e-01 1 1  ON 32
eH1_3                -8.594194e-02 1 1  ON 33
eH1_4                -3.557506e-02 1 1  ON 34
eH1_5                 4.157618e-03 1 1  ON 35
eH1_6                 7.342624e-02 1 1  ON 36
eH1_7                 1.571315e-01 1 1  ON 37
eH1_8                 2.272995e-01 1 1  ON 38
eH1_9                 2.089792e-01 1 1  ON 39
eH2_0                -2.846618e-01 1 1  ON 40
eH2_1                -1.855262e-01 1 1  ON 41
eH2_2                -1.392149e-01 1 1  ON 42
eH2_3                -8.406448e-02 1 1  ON 43
eH2_4                -3.375718e-02 1 1  ON 44
eH2_5                 5.063664e-03 1 1  ON 45
eH2_6                 7.409234e-02 1 1  ON 46
eH2_7                 1.558289e-01 1 1  ON 47
eH2_8                 2.245334e-01 1 1  ON 48
eH2_9                 2.356934e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.428717
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3606e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336074275177
                                         uncertainty =       0.003820596435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336074275177
                                         uncertainty =       0.003820596435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409914839
  error estimate for blocks of size 2^( 2) =       0.000422790759
  error estimate for blocks of size 2^( 3) =       0.000435732577
  error estimate for blocks of size 2^( 4) =       0.000448054772
  error estimate for blocks of size 2^( 5) =       0.000457703678
  error estimate for blocks of size 2^( 6) =       0.000465989860
  error estimate for blocks of size 2^( 7) =       0.000468937181

      target function =                  N/A
              le_mean =     -16.906314891116
             les_mean =     286.159543379931
             stat err =       0.000460171373
             autocorr =       1.260236098712
              std dev =       0.579707124666
             le_variance =       0.336060350388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631489112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314891116       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314953104       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906315258330       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906315336091       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906315392458       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906315618169       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906315679190       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906315647128       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.552799e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314891116       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314908678       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906314998738       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906315014525       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906315028306       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906315073752       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906315104119       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.106452e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314891116       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314895658       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906314919235       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906314922902       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906314926239       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906314936761       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314945065       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.055667e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6369e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.939068e-01 1 1  ON 0
 uu_1                 1.269333e-01 1 1  ON 1
 uu_2                 2.516641e-02 1 1  ON 2
 uu_3                -3.778039e-02 1 1  ON 3
 uu_4                -8.380718e-02 1 1  ON 4
 uu_5                -1.193854e-01 1 1  ON 5
 uu_6                -1.479746e-01 1 1  ON 6
 uu_7                -1.626760e-01 1 1  ON 7
 uu_8                -1.557537e-01 1 1  ON 8
 uu_9                -1.292875e-01 1 1  ON 9
 ud_0                 4.510727e-01 1 1  ON 10
 ud_1                 1.872386e-01 1 1  ON 11
 ud_2                 7.093045e-02 1 1  ON 12
 ud_3                 1.813325e-03 1 1  ON 13
 ud_4                -5.688389e-02 1 1  ON 14
 ud_5                -1.003086e-01 1 1  ON 15
 ud_6                -1.293665e-01 1 1  ON 16
 ud_7                -1.470105e-01 1 1  ON 17
 ud_8                -1.497765e-01 1 1  ON 18
 ud_9                -1.419074e-01 1 1  ON 19
 eO_0                -7.028530e-01 1 1  ON 20
 eO_1                -3.866281e-01 1 1  ON 21
 eO_2                 2.605116e-02 1 1  ON 22
 eO_3                 3.412299e-01 1 1  ON 23
 eO_4                 5.667512e-01 1 1  ON 24
 eO_5                 5.258376e-01 1 1  ON 25
 eO_6                 2.817612e-01 1 1  ON 26
 eO_7                -6.458924e-02 1 1  ON 27
 eO_8                -3.271684e-01 1 1  ON 28
 eO_9                -2.227711e-01 1 1  ON 29
eH1_0                -2.871215e-01 1 1  ON 30
eH1_1                -1.870901e-01 1 1  ON 31
eH1_2                -1.410330e-01 1 1  ON 32
eH1_3                -8.595603e-02 1 1  ON 33
eH1_4                -3.555182e-02 1 1  ON 34
eH1_5                 4.145224e-03 1 1  ON 35
eH1_6                 7.341816e-02 1 1  ON 36
eH1_7                 1.571235e-01 1 1  ON 37
eH1_8                 2.272951e-01 1 1  ON 38
eH1_9                 2.089875e-01 1 1  ON 39
eH2_0                -2.847029e-01 1 1  ON 40
eH2_1                -1.854971e-01 1 1  ON 41
eH2_2                -1.392477e-01 1 1  ON 42
eH2_3                -8.408263e-02 1 1  ON 43
eH2_4                -3.377460e-02 1 1  ON 44
eH2_5                 5.051851e-03 1 1  ON 45
eH2_6                 7.411183e-02 1 1  ON 46
eH2_7                 1.558455e-01 1 1  ON 47
eH2_8                 2.245415e-01 1 1  ON 48
eH2_9                 2.357180e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8145
    reference variance = 0.225429
====================================================
  Execution time = 2.0186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.0000e+06
  Execution time = 2.4760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339876919998
                                         uncertainty =       0.004192323293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339876919998
                                         uncertainty =       0.004192323293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412151461
  error estimate for blocks of size 2^( 2) =       0.000424557234
  error estimate for blocks of size 2^( 3) =       0.000436768334
  error estimate for blocks of size 2^( 4) =       0.000448451446
  error estimate for blocks of size 2^( 5) =       0.000457288760
  error estimate for blocks of size 2^( 6) =       0.000464126824
  error estimate for blocks of size 2^( 7) =       0.000469221267

      target function =                  N/A
              le_mean =     -16.906313954580
             les_mean =     286.163189014199
             stat err =       0.000459772074
             autocorr =       1.244432922955
              std dev =       0.582870185577
             le_variance =       0.339737653234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339847022141
                                         uncertainty =       0.004190745447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339847022141
                                         uncertainty =       0.004190745447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412133340
  error estimate for blocks of size 2^( 2) =       0.000424539923
  error estimate for blocks of size 2^( 3) =       0.000436751792
  error estimate for blocks of size 2^( 4) =       0.000448436286
  error estimate for blocks of size 2^( 5) =       0.000457275404
  error estimate for blocks of size 2^( 6) =       0.000464113174
  error estimate for blocks of size 2^( 7) =       0.000469212880

      target function =                  N/A
              le_mean =     -16.906313419868
             les_mean =     286.163141061391
             stat err =       0.000459759436
             autocorr =       1.244473933620
              std dev =       0.582844559418
             le_variance =       0.339707780443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339862390332
                                         uncertainty =       0.004191366806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339862390332
                                         uncertainty =       0.004191366806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412142657
  error estimate for blocks of size 2^( 2) =       0.000424548668
  error estimate for blocks of size 2^( 3) =       0.000436759912
  error estimate for blocks of size 2^( 4) =       0.000448443740
  error estimate for blocks of size 2^( 5) =       0.000457282037
  error estimate for blocks of size 2^( 6) =       0.000464120111
  error estimate for blocks of size 2^( 7) =       0.000469217869

      target function =                  N/A
              le_mean =     -16.906313620469
             les_mean =     286.163163203307
             stat err =       0.000459765939
             autocorr =       1.244452875427
              std dev =       0.582857735238
             le_variance =       0.339723139526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339875162057
                                         uncertainty =       0.004192198118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339875162057
                                         uncertainty =       0.004192198118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412150396
  error estimate for blocks of size 2^( 2) =       0.000424556191
  error estimate for blocks of size 2^( 3) =       0.000436767298
  error estimate for blocks of size 2^( 4) =       0.000448450500
  error estimate for blocks of size 2^( 5) =       0.000457287940
  error estimate for blocks of size 2^( 6) =       0.000464126009
  error estimate for blocks of size 2^( 7) =       0.000469220892

      target function =                  N/A
              le_mean =     -16.906313907942
             les_mean =     286.163185681339
             stat err =       0.000459771336
             autocorr =       1.244435354915
              std dev =       0.582868679315
             le_variance =       0.339735897327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906313954580        initial  <--
     9.5367e-01     9.5367e+00             1.5528e-04       -16.906313419868
     3.8147e+00     3.8147e+01             4.1065e-05       -16.906313620469
     1.5259e+01     1.5259e+02             1.0557e-05       -16.906313907942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7600
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.939244e-01 1 1  ON 0
 uu_1                 1.269168e-01 1 1  ON 1
 uu_2                 2.516677e-02 1 1  ON 2
 uu_3                -3.778106e-02 1 1  ON 3
 uu_4                -8.378590e-02 1 1  ON 4
 uu_5                -1.193783e-01 1 1  ON 5
 uu_6                -1.479461e-01 1 1  ON 6
 uu_7                -1.626696e-01 1 1  ON 7
 uu_8                -1.557648e-01 1 1  ON 8
 uu_9                -1.293167e-01 1 1  ON 9
 ud_0                 4.510915e-01 1 1  ON 10
 ud_1                 1.872454e-01 1 1  ON 11
 ud_2                 7.094363e-02 1 1  ON 12
 ud_3                 1.795857e-03 1 1  ON 13
 ud_4                -5.687615e-02 1 1  ON 14
 ud_5                -1.003478e-01 1 1  ON 15
 ud_6                -1.293828e-01 1 1  ON 16
 ud_7                -1.469854e-01 1 1  ON 17
 ud_8                -1.497711e-01 1 1  ON 18
 ud_9                -1.419128e-01 1 1  ON 19
 eO_0                -7.028366e-01 1 1  ON 20
 eO_1                -3.866420e-01 1 1  ON 21
 eO_2                 2.604961e-02 1 1  ON 22
 eO_3                 3.411970e-01 1 1  ON 23
 eO_4                 5.667564e-01 1 1  ON 24
 eO_5                 5.258227e-01 1 1  ON 25
 eO_6                 2.817487e-01 1 1  ON 26
 eO_7                -6.457361e-02 1 1  ON 27
 eO_8                -3.271539e-01 1 1  ON 28
 eO_9                -2.227525e-01 1 1  ON 29
eH1_0                -2.871098e-01 1 1  ON 30
eH1_1                -1.870940e-01 1 1  ON 31
eH1_2                -1.410474e-01 1 1  ON 32
eH1_3                -8.594194e-02 1 1  ON 33
eH1_4                -3.557506e-02 1 1  ON 34
eH1_5                 4.157618e-03 1 1  ON 35
eH1_6                 7.342624e-02 1 1  ON 36
eH1_7                 1.571315e-01 1 1  ON 37
eH1_8                 2.272995e-01 1 1  ON 38
eH1_9                 2.089792e-01 1 1  ON 39
eH2_0                -2.846618e-01 1 1  ON 40
eH2_1                -1.855262e-01 1 1  ON 41
eH2_2                -1.392149e-01 1 1  ON 42
eH2_3                -8.406448e-02 1 1  ON 43
eH2_4                -3.375718e-02 1 1  ON 44
eH2_5                 5.063664e-03 1 1  ON 45
eH2_6                 7.409234e-02 1 1  ON 46
eH2_7                 1.558289e-01 1 1  ON 47
eH2_8                 2.245334e-01 1 1  ON 48
eH2_9                 2.356934e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7134e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9872
    reference variance = 0.381592
====================================================
  Execution time = 2.0694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339745977487
                                         uncertainty =       0.003500626719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339745977487
                                         uncertainty =       0.003500626719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412126962
  error estimate for blocks of size 2^( 2) =       0.000425112631
  error estimate for blocks of size 2^( 3) =       0.000437866962
  error estimate for blocks of size 2^( 4) =       0.000451372408
  error estimate for blocks of size 2^( 5) =       0.000463826461
  error estimate for blocks of size 2^( 6) =       0.000473298260
  error estimate for blocks of size 2^( 7) =       0.000481762215

      target function =                  N/A
              le_mean =     -16.904791384288
             les_mean =     286.111668842112
             stat err =       0.000467564836
             autocorr =       1.287127674661
              std dev =       0.582835539130
             le_variance =       0.339697265673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690479138429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904791384288       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904791462025       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904791569257       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904791555719       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904791551864       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904791544580       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904791547551       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.923746e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904791384288       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904791404010       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904791431420       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904791427918       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904791427448       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904791425156       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904791426071       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.912064e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904791384288       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904791389237       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904791396127       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904791395245       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904791395161       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904791394568       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904791394798       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.234720e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6172e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.939267e-01 1 1  ON 0
 uu_1                 1.269191e-01 1 1  ON 1
 uu_2                 2.516352e-02 1 1  ON 2
 uu_3                -3.778200e-02 1 1  ON 3
 uu_4                -8.378717e-02 1 1  ON 4
 uu_5                -1.193788e-01 1 1  ON 5
 uu_6                -1.479468e-01 1 1  ON 6
 uu_7                -1.626713e-01 1 1  ON 7
 uu_8                -1.557637e-01 1 1  ON 8
 uu_9                -1.293151e-01 1 1  ON 9
 ud_0                 4.510928e-01 1 1  ON 10
 ud_1                 1.872469e-01 1 1  ON 11
 ud_2                 7.094304e-02 1 1  ON 12
 ud_3                 1.793690e-03 1 1  ON 13
 ud_4                -5.687585e-02 1 1  ON 14
 ud_5                -1.003461e-01 1 1  ON 15
 ud_6                -1.293795e-01 1 1  ON 16
 ud_7                -1.469883e-01 1 1  ON 17
 ud_8                -1.497739e-01 1 1  ON 18
 ud_9                -1.419119e-01 1 1  ON 19
 eO_0                -7.028374e-01 1 1  ON 20
 eO_1                -3.866453e-01 1 1  ON 21
 eO_2                 2.605452e-02 1 1  ON 22
 eO_3                 3.411989e-01 1 1  ON 23
 eO_4                 5.667565e-01 1 1  ON 24
 eO_5                 5.258221e-01 1 1  ON 25
 eO_6                 2.817501e-01 1 1  ON 26
 eO_7                -6.457425e-02 1 1  ON 27
 eO_8                -3.271548e-01 1 1  ON 28
 eO_9                -2.227540e-01 1 1  ON 29
eH1_0                -2.871128e-01 1 1  ON 30
eH1_1                -1.870914e-01 1 1  ON 31
eH1_2                -1.410485e-01 1 1  ON 32
eH1_3                -8.594447e-02 1 1  ON 33
eH1_4                -3.557131e-02 1 1  ON 34
eH1_5                 4.157197e-03 1 1  ON 35
eH1_6                 7.342379e-02 1 1  ON 36
eH1_7                 1.571319e-01 1 1  ON 37
eH1_8                 2.272994e-01 1 1  ON 38
eH1_9                 2.089808e-01 1 1  ON 39
eH2_0                -2.846645e-01 1 1  ON 40
eH2_1                -1.855235e-01 1 1  ON 41
eH2_2                -1.392160e-01 1 1  ON 42
eH2_3                -8.406521e-02 1 1  ON 43
eH2_4                -3.375728e-02 1 1  ON 44
eH2_5                 5.062014e-03 1 1  ON 45
eH2_6                 7.408993e-02 1 1  ON 46
eH2_7                 1.558295e-01 1 1  ON 47
eH2_8                 2.245343e-01 1 1  ON 48
eH2_9                 2.356959e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8684
    reference variance = 0.368441
====================================================
  Execution time = 2.0110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3323e-01
  Total weights = 2.0000e+06
  Execution time = 1.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333282744812
                                         uncertainty =       0.003420364893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333282744812
                                         uncertainty =       0.003420364893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408182197
  error estimate for blocks of size 2^( 2) =       0.000420996929
  error estimate for blocks of size 2^( 3) =       0.000433790374
  error estimate for blocks of size 2^( 4) =       0.000445797399
  error estimate for blocks of size 2^( 5) =       0.000456282178
  error estimate for blocks of size 2^( 6) =       0.000463748397
  error estimate for blocks of size 2^( 7) =       0.000467299897

      target function =                  N/A
              le_mean =     -16.905801973578
             les_mean =     286.139365615167
             stat err =       0.000458281968
             autocorr =       1.260542290521
              std dev =       0.577256798972
             le_variance =       0.333225411959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333293944229
                                         uncertainty =       0.003420424560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333293944229
                                         uncertainty =       0.003420424560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408189055
  error estimate for blocks of size 2^( 2) =       0.000421003494
  error estimate for blocks of size 2^( 3) =       0.000433796526
  error estimate for blocks of size 2^( 4) =       0.000445803120
  error estimate for blocks of size 2^( 5) =       0.000456287804
  error estimate for blocks of size 2^( 6) =       0.000463753711
  error estimate for blocks of size 2^( 7) =       0.000467304170

      target function =                  N/A
              le_mean =     -16.905801845623
             les_mean =     286.139372486784
             stat err =       0.000458287201
             autocorr =       1.260528720841
              std dev =       0.577266498186
             le_variance =       0.333236609928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333288461903
                                         uncertainty =       0.003420393092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333288461903
                                         uncertainty =       0.003420393092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408185698
  error estimate for blocks of size 2^( 2) =       0.000421000281
  error estimate for blocks of size 2^( 3) =       0.000433793514
  error estimate for blocks of size 2^( 4) =       0.000445800316
  error estimate for blocks of size 2^( 5) =       0.000456285050
  error estimate for blocks of size 2^( 6) =       0.000463751110
  error estimate for blocks of size 2^( 7) =       0.000467302071

      target function =                  N/A
              le_mean =     -16.905801906433
             les_mean =     286.139369061273
             stat err =       0.000458284637
             autocorr =       1.260535348854
              std dev =       0.577261750290
             le_variance =       0.333231128348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333283462716
                                         uncertainty =       0.003420368364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333283462716
                                         uncertainty =       0.003420368364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408182637
  error estimate for blocks of size 2^( 2) =       0.000420997350
  error estimate for blocks of size 2^( 3) =       0.000433790768
  error estimate for blocks of size 2^( 4) =       0.000445797765
  error estimate for blocks of size 2^( 5) =       0.000456282539
  error estimate for blocks of size 2^( 6) =       0.000463748738
  error estimate for blocks of size 2^( 7) =       0.000467300170

      target function =                  N/A
              le_mean =     -16.905801965044
             les_mean =     286.139366044451
             stat err =       0.000458282303
             autocorr =       1.260541418043
              std dev =       0.577257420719
             le_variance =       0.333226129776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905801973578        initial  <--
     9.5367e+00     9.5367e+01             1.9237e-05       -16.905801845623
     3.8147e+01     3.8147e+02             4.9121e-06       -16.905801906433
     1.5259e+02     1.5259e+03             1.2347e-06       -16.905801965044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6791
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.939244e-01 1 1  ON 0
 uu_1                 1.269168e-01 1 1  ON 1
 uu_2                 2.516677e-02 1 1  ON 2
 uu_3                -3.778106e-02 1 1  ON 3
 uu_4                -8.378590e-02 1 1  ON 4
 uu_5                -1.193783e-01 1 1  ON 5
 uu_6                -1.479461e-01 1 1  ON 6
 uu_7                -1.626696e-01 1 1  ON 7
 uu_8                -1.557648e-01 1 1  ON 8
 uu_9                -1.293167e-01 1 1  ON 9
 ud_0                 4.510915e-01 1 1  ON 10
 ud_1                 1.872454e-01 1 1  ON 11
 ud_2                 7.094363e-02 1 1  ON 12
 ud_3                 1.795857e-03 1 1  ON 13
 ud_4                -5.687615e-02 1 1  ON 14
 ud_5                -1.003478e-01 1 1  ON 15
 ud_6                -1.293828e-01 1 1  ON 16
 ud_7                -1.469854e-01 1 1  ON 17
 ud_8                -1.497711e-01 1 1  ON 18
 ud_9                -1.419128e-01 1 1  ON 19
 eO_0                -7.028366e-01 1 1  ON 20
 eO_1                -3.866420e-01 1 1  ON 21
 eO_2                 2.604961e-02 1 1  ON 22
 eO_3                 3.411970e-01 1 1  ON 23
 eO_4                 5.667564e-01 1 1  ON 24
 eO_5                 5.258227e-01 1 1  ON 25
 eO_6                 2.817487e-01 1 1  ON 26
 eO_7                -6.457361e-02 1 1  ON 27
 eO_8                -3.271539e-01 1 1  ON 28
 eO_9                -2.227525e-01 1 1  ON 29
eH1_0                -2.871098e-01 1 1  ON 30
eH1_1                -1.870940e-01 1 1  ON 31
eH1_2                -1.410474e-01 1 1  ON 32
eH1_3                -8.594194e-02 1 1  ON 33
eH1_4                -3.557506e-02 1 1  ON 34
eH1_5                 4.157618e-03 1 1  ON 35
eH1_6                 7.342624e-02 1 1  ON 36
eH1_7                 1.571315e-01 1 1  ON 37
eH1_8                 2.272995e-01 1 1  ON 38
eH1_9                 2.089792e-01 1 1  ON 39
eH2_0                -2.846618e-01 1 1  ON 40
eH2_1                -1.855262e-01 1 1  ON 41
eH2_2                -1.392149e-01 1 1  ON 42
eH2_3                -8.406448e-02 1 1  ON 43
eH2_4                -3.375718e-02 1 1  ON 44
eH2_5                 5.063664e-03 1 1  ON 45
eH2_6                 7.409234e-02 1 1  ON 46
eH2_7                 1.558289e-01 1 1  ON 47
eH2_8                 2.245334e-01 1 1  ON 48
eH2_9                 2.356934e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5856e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.901
    reference variance = 0.448357
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3806e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100867030
                                         uncertainty =       0.004295968372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338100867030
                                         uncertainty =       0.004295968372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411132678
  error estimate for blocks of size 2^( 2) =       0.000423699440
  error estimate for blocks of size 2^( 3) =       0.000436709559
  error estimate for blocks of size 2^( 4) =       0.000449365637
  error estimate for blocks of size 2^( 5) =       0.000459560152
  error estimate for blocks of size 2^( 6) =       0.000465497574
  error estimate for blocks of size 2^( 7) =       0.000470688205

      target function =                  N/A
              le_mean =     -16.905518459263
             les_mean =     286.134614365445
             stat err =       0.000461277892
             autocorr =       1.258813194463
              std dev =       0.581429409306
             le_variance =       0.338060158006


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551845926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905518459263       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905518460702       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905518459842       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905518460300       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905518456281       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905518456495       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905518456652       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.167013e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905518459263       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905518459623       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905518459407       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905518459520       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905518458514       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905518458566       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905518458604       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.429434e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905518459263       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905518459353       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905518459299       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905518459328       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905518459076       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905518459088       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905518459099       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.358105e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413394 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6326e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.939244e-01 1 1  ON 0
 uu_1                 1.269169e-01 1 1  ON 1
 uu_2                 2.516664e-02 1 1  ON 2
 uu_3                -3.778104e-02 1 1  ON 3
 uu_4                -8.378604e-02 1 1  ON 4
 uu_5                -1.193784e-01 1 1  ON 5
 uu_6                -1.479459e-01 1 1  ON 6
 uu_7                -1.626695e-01 1 1  ON 7
 uu_8                -1.557648e-01 1 1  ON 8
 uu_9                -1.293167e-01 1 1  ON 9
 ud_0                 4.510921e-01 1 1  ON 10
 ud_1                 1.872455e-01 1 1  ON 11
 ud_2                 7.094389e-02 1 1  ON 12
 ud_3                 1.795865e-03 1 1  ON 13
 ud_4                -5.687606e-02 1 1  ON 14
 ud_5                -1.003477e-01 1 1  ON 15
 ud_6                -1.293831e-01 1 1  ON 16
 ud_7                -1.469859e-01 1 1  ON 17
 ud_8                -1.497712e-01 1 1  ON 18
 ud_9                -1.419128e-01 1 1  ON 19
 eO_0                -7.028368e-01 1 1  ON 20
 eO_1                -3.866420e-01 1 1  ON 21
 eO_2                 2.604986e-02 1 1  ON 22
 eO_3                 3.411972e-01 1 1  ON 23
 eO_4                 5.667567e-01 1 1  ON 24
 eO_5                 5.258226e-01 1 1  ON 25
 eO_6                 2.817490e-01 1 1  ON 26
 eO_7                -6.457374e-02 1 1  ON 27
 eO_8                -3.271542e-01 1 1  ON 28
 eO_9                -2.227527e-01 1 1  ON 29
eH1_0                -2.871098e-01 1 1  ON 30
eH1_1                -1.870942e-01 1 1  ON 31
eH1_2                -1.410473e-01 1 1  ON 32
eH1_3                -8.594203e-02 1 1  ON 33
eH1_4                -3.557508e-02 1 1  ON 34
eH1_5                 4.157649e-03 1 1  ON 35
eH1_6                 7.342621e-02 1 1  ON 36
eH1_7                 1.571316e-01 1 1  ON 37
eH1_8                 2.272995e-01 1 1  ON 38
eH1_9                 2.089793e-01 1 1  ON 39
eH2_0                -2.846622e-01 1 1  ON 40
eH2_1                -1.855257e-01 1 1  ON 41
eH2_2                -1.392149e-01 1 1  ON 42
eH2_3                -8.406451e-02 1 1  ON 43
eH2_4                -3.375727e-02 1 1  ON 44
eH2_5                 5.063578e-03 1 1  ON 45
eH2_6                 7.409222e-02 1 1  ON 46
eH2_7                 1.558290e-01 1 1  ON 47
eH2_8                 2.245333e-01 1 1  ON 48
eH2_9                 2.356934e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.267534
====================================================
  Execution time = 2.0264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3388e-01
  Total weights = 2.0000e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333626995296
                                         uncertainty =       0.003055345616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333626995296
                                         uncertainty =       0.003055345616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408585074
  error estimate for blocks of size 2^( 2) =       0.000421495940
  error estimate for blocks of size 2^( 3) =       0.000434583429
  error estimate for blocks of size 2^( 4) =       0.000447340338
  error estimate for blocks of size 2^( 5) =       0.000458293670
  error estimate for blocks of size 2^( 6) =       0.000467258656
  error estimate for blocks of size 2^( 7) =       0.000471304187

      target function =                  N/A
              le_mean =     -16.906471915312
             les_mean =     286.162675981153
             stat err =       0.000461049213
             autocorr =       1.273296587759
              std dev =       0.577826552575
             le_variance =       0.333883524860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333628368333
                                         uncertainty =       0.003055363780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333628368333
                                         uncertainty =       0.003055363780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408585916
  error estimate for blocks of size 2^( 2) =       0.000421496740
  error estimate for blocks of size 2^( 3) =       0.000434584189
  error estimate for blocks of size 2^( 4) =       0.000447341081
  error estimate for blocks of size 2^( 5) =       0.000458294394
  error estimate for blocks of size 2^( 6) =       0.000467259362
  error estimate for blocks of size 2^( 7) =       0.000471304875

      target function =                  N/A
              le_mean =     -16.906471916112
             les_mean =     286.162677384587
             stat err =       0.000461049928
             autocorr =       1.273295290885
              std dev =       0.577827743572
             le_variance =       0.333884901241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333627683906
                                         uncertainty =       0.003055354726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333627683906
                                         uncertainty =       0.003055354726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408585496
  error estimate for blocks of size 2^( 2) =       0.000421496341
  error estimate for blocks of size 2^( 3) =       0.000434583810
  error estimate for blocks of size 2^( 4) =       0.000447340711
  error estimate for blocks of size 2^( 5) =       0.000458294033
  error estimate for blocks of size 2^( 6) =       0.000467259010
  error estimate for blocks of size 2^( 7) =       0.000471304532

      target function =                  N/A
              le_mean =     -16.906471915709
             les_mean =     286.162676684877
             stat err =       0.000461049571
             autocorr =       1.273295937435
              std dev =       0.577827149888
             le_variance =       0.333884215147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333627081436
                                         uncertainty =       0.003055346756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333627081436
                                         uncertainty =       0.003055346756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408585127
  error estimate for blocks of size 2^( 2) =       0.000421495990
  error estimate for blocks of size 2^( 3) =       0.000434583476
  error estimate for blocks of size 2^( 4) =       0.000447340385
  error estimate for blocks of size 2^( 5) =       0.000458293715
  error estimate for blocks of size 2^( 6) =       0.000467258700
  error estimate for blocks of size 2^( 7) =       0.000471304230

      target function =                  N/A
              le_mean =     -16.906471915361
             les_mean =     286.162676069172
             stat err =       0.000461049258
             autocorr =       1.273296506414
              std dev =       0.577826627294
             le_variance =       0.333883611210


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906471915312        initial
     9.5367e+01     9.5367e+02             2.1670e-06       -16.906471916112  <--
     3.8147e+02     3.8147e+03             5.4294e-07       -16.906471915709
     1.5259e+03     1.5259e+04             1.3581e-07       -16.906471915361

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9821e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.939243e-01 1 1  ON 0
 uu_1                 1.269171e-01 1 1  ON 1
 uu_2                 2.516624e-02 1 1  ON 2
 uu_3                -3.778099e-02 1 1  ON 3
 uu_4                -8.378647e-02 1 1  ON 4
 uu_5                -1.193787e-01 1 1  ON 5
 uu_6                -1.479454e-01 1 1  ON 6
 uu_7                -1.626691e-01 1 1  ON 7
 uu_8                -1.557648e-01 1 1  ON 8
 uu_9                -1.293167e-01 1 1  ON 9
 ud_0                 4.510937e-01 1 1  ON 10
 ud_1                 1.872456e-01 1 1  ON 11
 ud_2                 7.094467e-02 1 1  ON 12
 ud_3                 1.795893e-03 1 1  ON 13
 ud_4                -5.687581e-02 1 1  ON 14
 ud_5                -1.003474e-01 1 1  ON 15
 ud_6                -1.293840e-01 1 1  ON 16
 ud_7                -1.469873e-01 1 1  ON 17
 ud_8                -1.497717e-01 1 1  ON 18
 ud_9                -1.419128e-01 1 1  ON 19
 eO_0                -7.028375e-01 1 1  ON 20
 eO_1                -3.866418e-01 1 1  ON 21
 eO_2                 2.605059e-02 1 1  ON 22
 eO_3                 3.411976e-01 1 1  ON 23
 eO_4                 5.667574e-01 1 1  ON 24
 eO_5                 5.258225e-01 1 1  ON 25
 eO_6                 2.817496e-01 1 1  ON 26
 eO_7                -6.457413e-02 1 1  ON 27
 eO_8                -3.271549e-01 1 1  ON 28
 eO_9                -2.227533e-01 1 1  ON 29
eH1_0                -2.871100e-01 1 1  ON 30
eH1_1                -1.870950e-01 1 1  ON 31
eH1_2                -1.410471e-01 1 1  ON 32
eH1_3                -8.594233e-02 1 1  ON 33
eH1_4                -3.557514e-02 1 1  ON 34
eH1_5                 4.157744e-03 1 1  ON 35
eH1_6                 7.342611e-02 1 1  ON 36
eH1_7                 1.571318e-01 1 1  ON 37
eH1_8                 2.272996e-01 1 1  ON 38
eH1_9                 2.089798e-01 1 1  ON 39
eH2_0                -2.846634e-01 1 1  ON 40
eH2_1                -1.855241e-01 1 1  ON 41
eH2_2                -1.392149e-01 1 1  ON 42
eH2_3                -8.406459e-02 1 1  ON 43
eH2_4                -3.375752e-02 1 1  ON 44
eH2_5                 5.063318e-03 1 1  ON 45
eH2_6                 7.409185e-02 1 1  ON 46
eH2_7                 1.558294e-01 1 1  ON 47
eH2_8                 2.245331e-01 1 1  ON 48
eH2_9                 2.356935e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.258933
====================================================
  Execution time = 2.0586e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3726e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337307125195
                                         uncertainty =       0.002773322962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337307125195
                                         uncertainty =       0.002773322962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410646030
  error estimate for blocks of size 2^( 2) =       0.000423785302
  error estimate for blocks of size 2^( 3) =       0.000436733083
  error estimate for blocks of size 2^( 4) =       0.000448559183
  error estimate for blocks of size 2^( 5) =       0.000458956971
  error estimate for blocks of size 2^( 6) =       0.000467610820
  error estimate for blocks of size 2^( 7) =       0.000473629725

      target function =                  N/A
              le_mean =     -16.905277240321
             les_mean =     286.125658727052
             stat err =       0.000462189174
             autocorr =       1.266788993834
              std dev =       0.580741184666
             le_variance =       0.337260323567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690527724032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277240321       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277256919       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277260048       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277265017       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277285017       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277273472       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277269485       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277269627       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 8.312017e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277240321       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277244488       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277245278       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277246551       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277251616       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277248745       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277247702       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277247749       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.087073e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277240321       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277241364       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277241562       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277241882       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277243152       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277242436       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277242172       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277242184       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.223428e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6101e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.939241e-01 1 1  ON 0
 uu_1                 1.269178e-01 1 1  ON 1
 uu_2                 2.516515e-02 1 1  ON 2
 uu_3                -3.778024e-02 1 1  ON 3
 uu_4                -8.378665e-02 1 1  ON 4
 uu_5                -1.193785e-01 1 1  ON 5
 uu_6                -1.479451e-01 1 1  ON 6
 uu_7                -1.626698e-01 1 1  ON 7
 uu_8                -1.557644e-01 1 1  ON 8
 uu_9                -1.293167e-01 1 1  ON 9
 ud_0                 4.510929e-01 1 1  ON 10
 ud_1                 1.872466e-01 1 1  ON 11
 ud_2                 7.094541e-02 1 1  ON 12
 ud_3                 1.795719e-03 1 1  ON 13
 ud_4                -5.687539e-02 1 1  ON 14
 ud_5                -1.003479e-01 1 1  ON 15
 ud_6                -1.293846e-01 1 1  ON 16
 ud_7                -1.469890e-01 1 1  ON 17
 ud_8                -1.497709e-01 1 1  ON 18
 ud_9                -1.419120e-01 1 1  ON 19
 eO_0                -7.028384e-01 1 1  ON 20
 eO_1                -3.866404e-01 1 1  ON 21
 eO_2                 2.605073e-02 1 1  ON 22
 eO_3                 3.411979e-01 1 1  ON 23
 eO_4                 5.667586e-01 1 1  ON 24
 eO_5                 5.258226e-01 1 1  ON 25
 eO_6                 2.817489e-01 1 1  ON 26
 eO_7                -6.457420e-02 1 1  ON 27
 eO_8                -3.271551e-01 1 1  ON 28
 eO_9                -2.227542e-01 1 1  ON 29
eH1_0                -2.871095e-01 1 1  ON 30
eH1_1                -1.870971e-01 1 1  ON 31
eH1_2                -1.410478e-01 1 1  ON 32
eH1_3                -8.594254e-02 1 1  ON 33
eH1_4                -3.557586e-02 1 1  ON 34
eH1_5                 4.159486e-03 1 1  ON 35
eH1_6                 7.342664e-02 1 1  ON 36
eH1_7                 1.571318e-01 1 1  ON 37
eH1_8                 2.272992e-01 1 1  ON 38
eH1_9                 2.089807e-01 1 1  ON 39
eH2_0                -2.846630e-01 1 1  ON 40
eH2_1                -1.855237e-01 1 1  ON 41
eH2_2                -1.392155e-01 1 1  ON 42
eH2_3                -8.406605e-02 1 1  ON 43
eH2_4                -3.375810e-02 1 1  ON 44
eH2_5                 5.063406e-03 1 1  ON 45
eH2_6                 7.409154e-02 1 1  ON 46
eH2_7                 1.558296e-01 1 1  ON 47
eH2_8                 2.245334e-01 1 1  ON 48
eH2_9                 2.356943e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.193129
====================================================
  Execution time = 2.0197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4400e-01
  Total weights = 2.0000e+06
  Execution time = 1.8941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101693686
                                         uncertainty =       0.005954798742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101693686
                                         uncertainty =       0.005954798742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414731569
  error estimate for blocks of size 2^( 2) =       0.000427115087
  error estimate for blocks of size 2^( 3) =       0.000439980267
  error estimate for blocks of size 2^( 4) =       0.000452378048
  error estimate for blocks of size 2^( 5) =       0.000463243262
  error estimate for blocks of size 2^( 6) =       0.000470957675
  error estimate for blocks of size 2^( 7) =       0.000476752994

      target function =                  N/A
              le_mean =     -16.906864937580
             les_mean =     286.186086394996
             stat err =       0.000465832995
             autocorr =       1.261613426940
              std dev =       0.586519010285
             le_variance =       0.344004549425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344098777898
                                         uncertainty =       0.005954747465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344098777898
                                         uncertainty =       0.005954747465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414729811
  error estimate for blocks of size 2^( 2) =       0.000427113425
  error estimate for blocks of size 2^( 3) =       0.000439978666
  error estimate for blocks of size 2^( 4) =       0.000452376379
  error estimate for blocks of size 2^( 5) =       0.000463241496
  error estimate for blocks of size 2^( 6) =       0.000470955885
  error estimate for blocks of size 2^( 7) =       0.000476750857

      target function =                  N/A
              le_mean =     -16.906864950915
             les_mean =     286.186083928924
             stat err =       0.000465831154
             autocorr =       1.261614154099
              std dev =       0.586516523595
             le_variance =       0.344001632450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344100201451
                                         uncertainty =       0.005954772661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344100201451
                                         uncertainty =       0.005954772661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414730670
  error estimate for blocks of size 2^( 2) =       0.000427114236
  error estimate for blocks of size 2^( 3) =       0.000439979447
  error estimate for blocks of size 2^( 4) =       0.000452377195
  error estimate for blocks of size 2^( 5) =       0.000463242360
  error estimate for blocks of size 2^( 6) =       0.000470956761
  error estimate for blocks of size 2^( 7) =       0.000476751903

      target function =                  N/A
              le_mean =     -16.906864944247
             les_mean =     286.186085127605
             stat err =       0.000465832055
             autocorr =       1.261613808423
              std dev =       0.586517737660
             le_variance =       0.344003056590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101506012
                                         uncertainty =       0.005954795468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344101506012
                                         uncertainty =       0.005954795468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414731456
  error estimate for blocks of size 2^( 2) =       0.000427114980
  error estimate for blocks of size 2^( 3) =       0.000439980164
  error estimate for blocks of size 2^( 4) =       0.000452377941
  error estimate for blocks of size 2^( 5) =       0.000463243149
  error estimate for blocks of size 2^( 6) =       0.000470957560
  error estimate for blocks of size 2^( 7) =       0.000476752857

      target function =                  N/A
              le_mean =     -16.906864938408
             les_mean =     286.186086235231
             stat err =       0.000465832877
             autocorr =       1.261613475205
              std dev =       0.586518850231
             le_variance =       0.344004361676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906864937580        initial
     2.3842e+01     2.3842e+02             8.3120e-06       -16.906864950915  <--
     9.5367e+01     9.5367e+02             2.0871e-06       -16.906864944247
     3.8147e+02     3.8147e+03             5.2234e-07       -16.906864938408

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.9765e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.939233e-01 1 1  ON 0
 uu_1                 1.269197e-01 1 1  ON 1
 uu_2                 2.516196e-02 1 1  ON 2
 uu_3                -3.777804e-02 1 1  ON 3
 uu_4                -8.378717e-02 1 1  ON 4
 uu_5                -1.193781e-01 1 1  ON 5
 uu_6                -1.479439e-01 1 1  ON 6
 uu_7                -1.626718e-01 1 1  ON 7
 uu_8                -1.557631e-01 1 1  ON 8
 uu_9                -1.293169e-01 1 1  ON 9
 ud_0                 4.510905e-01 1 1  ON 10
 ud_1                 1.872497e-01 1 1  ON 11
 ud_2                 7.094759e-02 1 1  ON 12
 ud_3                 1.795229e-03 1 1  ON 13
 ud_4                -5.687416e-02 1 1  ON 14
 ud_5                -1.003495e-01 1 1  ON 15
 ud_6                -1.293866e-01 1 1  ON 16
 ud_7                -1.469942e-01 1 1  ON 17
 ud_8                -1.497685e-01 1 1  ON 18
 ud_9                -1.419096e-01 1 1  ON 19
 eO_0                -7.028411e-01 1 1  ON 20
 eO_1                -3.866363e-01 1 1  ON 21
 eO_2                 2.605115e-02 1 1  ON 22
 eO_3                 3.411990e-01 1 1  ON 23
 eO_4                 5.667621e-01 1 1  ON 24
 eO_5                 5.258227e-01 1 1  ON 25
 eO_6                 2.817468e-01 1 1  ON 26
 eO_7                -6.457441e-02 1 1  ON 27
 eO_8                -3.271558e-01 1 1  ON 28
 eO_9                -2.227570e-01 1 1  ON 29
eH1_0                -2.871080e-01 1 1  ON 30
eH1_1                -1.871033e-01 1 1  ON 31
eH1_2                -1.410499e-01 1 1  ON 32
eH1_3                -8.594320e-02 1 1  ON 33
eH1_4                -3.557799e-02 1 1  ON 34
eH1_5                 4.164691e-03 1 1  ON 35
eH1_6                 7.342823e-02 1 1  ON 36
eH1_7                 1.571319e-01 1 1  ON 37
eH1_8                 2.272982e-01 1 1  ON 38
eH1_9                 2.089832e-01 1 1  ON 39
eH2_0                -2.846620e-01 1 1  ON 40
eH2_1                -1.855225e-01 1 1  ON 41
eH2_2                -1.392173e-01 1 1  ON 42
eH2_3                -8.407039e-02 1 1  ON 43
eH2_4                -3.375984e-02 1 1  ON 44
eH2_5                 5.063670e-03 1 1  ON 45
eH2_6                 7.409062e-02 1 1  ON 46
eH2_7                 1.558302e-01 1 1  ON 47
eH2_8                 2.245342e-01 1 1  ON 48
eH2_9                 2.356968e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5871e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8576
    reference variance = 0.389263
====================================================
  Execution time = 2.0603e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5090e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350976978160
                                         uncertainty =       0.009388047650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350976978160
                                         uncertainty =       0.009388047650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418867036
  error estimate for blocks of size 2^( 2) =       0.000431692514
  error estimate for blocks of size 2^( 3) =       0.000444678039
  error estimate for blocks of size 2^( 4) =       0.000457221473
  error estimate for blocks of size 2^( 5) =       0.000468762633
  error estimate for blocks of size 2^( 6) =       0.000476741867
  error estimate for blocks of size 2^( 7) =       0.000484156851

      target function =                  N/A
              le_mean =     -16.905241227971
             les_mean =     286.138079987303
             stat err =       0.000471720706
             autocorr =       1.268286919697
              std dev =       0.592367442450
             le_variance =       0.350899186875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690524122797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241227971       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241165522       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241124430       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241156339       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905241144603       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241179278       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905241167629       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241167233       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.583601e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241227971       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241212126       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241201435       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241209484       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905241206748       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241215400       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905241212362       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241212216       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 6.494159e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905241227971       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905241223995       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905241221295       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905241223311       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905241222640       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905241224802       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905241224035       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905241223995       residual = 9.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.625782e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6130e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.939199e-01 1 1  ON 0
 uu_1                 1.269237e-01 1 1  ON 1
 uu_2                 2.515985e-02 1 1  ON 2
 uu_3                -3.777978e-02 1 1  ON 3
 uu_4                -8.378809e-02 1 1  ON 4
 uu_5                -1.193811e-01 1 1  ON 5
 uu_6                -1.479426e-01 1 1  ON 6
 uu_7                -1.626748e-01 1 1  ON 7
 uu_8                -1.557609e-01 1 1  ON 8
 uu_9                -1.293148e-01 1 1  ON 9
 ud_0                 4.510859e-01 1 1  ON 10
 ud_1                 1.872471e-01 1 1  ON 11
 ud_2                 7.094615e-02 1 1  ON 12
 ud_3                 1.791972e-03 1 1  ON 13
 ud_4                -5.687253e-02 1 1  ON 14
 ud_5                -1.003518e-01 1 1  ON 15
 ud_6                -1.293869e-01 1 1  ON 16
 ud_7                -1.469933e-01 1 1  ON 17
 ud_8                -1.497623e-01 1 1  ON 18
 ud_9                -1.419031e-01 1 1  ON 19
 eO_0                -7.028465e-01 1 1  ON 20
 eO_1                -3.866361e-01 1 1  ON 21
 eO_2                 2.605355e-02 1 1  ON 22
 eO_3                 3.412029e-01 1 1  ON 23
 eO_4                 5.667633e-01 1 1  ON 24
 eO_5                 5.258246e-01 1 1  ON 25
 eO_6                 2.817451e-01 1 1  ON 26
 eO_7                -6.457458e-02 1 1  ON 27
 eO_8                -3.271547e-01 1 1  ON 28
 eO_9                -2.227594e-01 1 1  ON 29
eH1_0                -2.871109e-01 1 1  ON 30
eH1_1                -1.871081e-01 1 1  ON 31
eH1_2                -1.410519e-01 1 1  ON 32
eH1_3                -8.594060e-02 1 1  ON 33
eH1_4                -3.557833e-02 1 1  ON 34
eH1_5                 4.164585e-03 1 1  ON 35
eH1_6                 7.342717e-02 1 1  ON 36
eH1_7                 1.571312e-01 1 1  ON 37
eH1_8                 2.272997e-01 1 1  ON 38
eH1_9                 2.089877e-01 1 1  ON 39
eH2_0                -2.846663e-01 1 1  ON 40
eH2_1                -1.855180e-01 1 1  ON 41
eH2_2                -1.392178e-01 1 1  ON 42
eH2_3                -8.407580e-02 1 1  ON 43
eH2_4                -3.376420e-02 1 1  ON 44
eH2_5                 5.061817e-03 1 1  ON 45
eH2_6                 7.409133e-02 1 1  ON 46
eH2_7                 1.558335e-01 1 1  ON 47
eH2_8                 2.245379e-01 1 1  ON 48
eH2_9                 2.356986e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9477
    reference variance = 0.313067
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5155e-01
  Total weights = 2.0000e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351534249449
                                         uncertainty =       0.009226552990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351534249449
                                         uncertainty =       0.009226552990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419254021
  error estimate for blocks of size 2^( 2) =       0.000431268464
  error estimate for blocks of size 2^( 3) =       0.000443828986
  error estimate for blocks of size 2^( 4) =       0.000454932945
  error estimate for blocks of size 2^( 5) =       0.000465158900
  error estimate for blocks of size 2^( 6) =       0.000472826145
  error estimate for blocks of size 2^( 7) =       0.000476494871

      target function =                  N/A
              le_mean =     -16.905919572105
             les_mean =     286.161664270188
             stat err =       0.000467353215
             autocorr =       1.242613300054
              std dev =       0.592914721934
             le_variance =       0.351547867486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351531844502
                                         uncertainty =       0.009228177506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351531844502
                                         uncertainty =       0.009228177506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419252588
  error estimate for blocks of size 2^( 2) =       0.000431267415
  error estimate for blocks of size 2^( 3) =       0.000443827992
  error estimate for blocks of size 2^( 4) =       0.000454932394
  error estimate for blocks of size 2^( 5) =       0.000465158358
  error estimate for blocks of size 2^( 6) =       0.000472825005
  error estimate for blocks of size 2^( 7) =       0.000476492546

      target function =                  N/A
              le_mean =     -16.905919398831
             les_mean =     286.161656008511
             stat err =       0.000467352076
             autocorr =       1.242615734497
              std dev =       0.592912695537
             le_variance =       0.351545464529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351532926616
                                         uncertainty =       0.009227393019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351532926616
                                         uncertainty =       0.009227393019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419253232
  error estimate for blocks of size 2^( 2) =       0.000431267875
  error estimate for blocks of size 2^( 3) =       0.000443828424
  error estimate for blocks of size 2^( 4) =       0.000454932611
  error estimate for blocks of size 2^( 5) =       0.000465158571
  error estimate for blocks of size 2^( 6) =       0.000472825509
  error estimate for blocks of size 2^( 7) =       0.000476493606

      target function =                  N/A
              le_mean =     -16.905919479866
             les_mean =     286.161659829678
             stat err =       0.000467352575
             autocorr =       1.242614564398
              std dev =       0.592913607312
             le_variance =       0.351546545735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351534079477
                                         uncertainty =       0.009226658906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351534079477
                                         uncertainty =       0.009226658906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419253919
  error estimate for blocks of size 2^( 2) =       0.000431268388
  error estimate for blocks of size 2^( 3) =       0.000443828913
  error estimate for blocks of size 2^( 4) =       0.000454932901
  error estimate for blocks of size 2^( 5) =       0.000465158856
  error estimate for blocks of size 2^( 6) =       0.000472826063
  error estimate for blocks of size 2^( 7) =       0.000476494709

      target function =                  N/A
              le_mean =     -16.905919560320
             les_mean =     286.161663701885
             stat err =       0.000467353132
             autocorr =       1.242613459666
              std dev =       0.592914578715
             le_variance =       0.351547697653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905919572105        initial  <--
     5.9605e+00     5.9605e+01             2.5836e-05       -16.905919398831
     2.3842e+01     2.3842e+02             6.4942e-06       -16.905919479866
     9.5367e+01     9.5367e+02             1.6258e-06       -16.905919560320

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8812
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.939233e-01 1 1  ON 0
 uu_1                 1.269197e-01 1 1  ON 1
 uu_2                 2.516196e-02 1 1  ON 2
 uu_3                -3.777804e-02 1 1  ON 3
 uu_4                -8.378717e-02 1 1  ON 4
 uu_5                -1.193781e-01 1 1  ON 5
 uu_6                -1.479439e-01 1 1  ON 6
 uu_7                -1.626718e-01 1 1  ON 7
 uu_8                -1.557631e-01 1 1  ON 8
 uu_9                -1.293169e-01 1 1  ON 9
 ud_0                 4.510905e-01 1 1  ON 10
 ud_1                 1.872497e-01 1 1  ON 11
 ud_2                 7.094759e-02 1 1  ON 12
 ud_3                 1.795229e-03 1 1  ON 13
 ud_4                -5.687416e-02 1 1  ON 14
 ud_5                -1.003495e-01 1 1  ON 15
 ud_6                -1.293866e-01 1 1  ON 16
 ud_7                -1.469942e-01 1 1  ON 17
 ud_8                -1.497685e-01 1 1  ON 18
 ud_9                -1.419096e-01 1 1  ON 19
 eO_0                -7.028411e-01 1 1  ON 20
 eO_1                -3.866363e-01 1 1  ON 21
 eO_2                 2.605115e-02 1 1  ON 22
 eO_3                 3.411990e-01 1 1  ON 23
 eO_4                 5.667621e-01 1 1  ON 24
 eO_5                 5.258227e-01 1 1  ON 25
 eO_6                 2.817468e-01 1 1  ON 26
 eO_7                -6.457441e-02 1 1  ON 27
 eO_8                -3.271558e-01 1 1  ON 28
 eO_9                -2.227570e-01 1 1  ON 29
eH1_0                -2.871080e-01 1 1  ON 30
eH1_1                -1.871033e-01 1 1  ON 31
eH1_2                -1.410499e-01 1 1  ON 32
eH1_3                -8.594320e-02 1 1  ON 33
eH1_4                -3.557799e-02 1 1  ON 34
eH1_5                 4.164691e-03 1 1  ON 35
eH1_6                 7.342823e-02 1 1  ON 36
eH1_7                 1.571319e-01 1 1  ON 37
eH1_8                 2.272982e-01 1 1  ON 38
eH1_9                 2.089832e-01 1 1  ON 39
eH2_0                -2.846620e-01 1 1  ON 40
eH2_1                -1.855225e-01 1 1  ON 41
eH2_2                -1.392173e-01 1 1  ON 42
eH2_3                -8.407039e-02 1 1  ON 43
eH2_4                -3.375984e-02 1 1  ON 44
eH2_5                 5.063670e-03 1 1  ON 45
eH2_6                 7.409062e-02 1 1  ON 46
eH2_7                 1.558302e-01 1 1  ON 47
eH2_8                 2.245342e-01 1 1  ON 48
eH2_9                 2.356968e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8905
    reference variance = 0.380727
====================================================
  Execution time = 2.0828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340928321775
                                         uncertainty =       0.004247093297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340928321775
                                         uncertainty =       0.004247093297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413020804
  error estimate for blocks of size 2^( 2) =       0.000425934274
  error estimate for blocks of size 2^( 3) =       0.000439348878
  error estimate for blocks of size 2^( 4) =       0.000452104233
  error estimate for blocks of size 2^( 5) =       0.000464578512
  error estimate for blocks of size 2^( 6) =       0.000474060639
  error estimate for blocks of size 2^( 7) =       0.000482184608

      target function =                  N/A
              le_mean =     -16.906285287174
             les_mean =     286.163654409946
             stat err =       0.000468231998
             autocorr =       1.285222507528
              std dev =       0.584099622671
             le_variance =       0.341172369204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628528717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906285287174       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906285291707       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906285292602       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906285293227       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906285292060       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906285290791       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906285289641       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.535249e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906285287174       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906285288310       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906285288533       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906285288689       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906285288396       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906285288076       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906285287786       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 6.356907e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906285287174       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906285287459       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906285287514       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906285287553       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906285287480       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906285287400       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906285287327       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.590404e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6312e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.939233e-01 1 1  ON 0
 uu_1                 1.269201e-01 1 1  ON 1
 uu_2                 2.516212e-02 1 1  ON 2
 uu_3                -3.777793e-02 1 1  ON 3
 uu_4                -8.378757e-02 1 1  ON 4
 uu_5                -1.193780e-01 1 1  ON 5
 uu_6                -1.479440e-01 1 1  ON 6
 uu_7                -1.626721e-01 1 1  ON 7
 uu_8                -1.557629e-01 1 1  ON 8
 uu_9                -1.293169e-01 1 1  ON 9
 ud_0                 4.510902e-01 1 1  ON 10
 ud_1                 1.872499e-01 1 1  ON 11
 ud_2                 7.094765e-02 1 1  ON 12
 ud_3                 1.795024e-03 1 1  ON 13
 ud_4                -5.687420e-02 1 1  ON 14
 ud_5                -1.003488e-01 1 1  ON 15
 ud_6                -1.293867e-01 1 1  ON 16
 ud_7                -1.469941e-01 1 1  ON 17
 ud_8                -1.497681e-01 1 1  ON 18
 ud_9                -1.419097e-01 1 1  ON 19
 eO_0                -7.028413e-01 1 1  ON 20
 eO_1                -3.866362e-01 1 1  ON 21
 eO_2                 2.605158e-02 1 1  ON 22
 eO_3                 3.411995e-01 1 1  ON 23
 eO_4                 5.667621e-01 1 1  ON 24
 eO_5                 5.258227e-01 1 1  ON 25
 eO_6                 2.817467e-01 1 1  ON 26
 eO_7                -6.457439e-02 1 1  ON 27
 eO_8                -3.271559e-01 1 1  ON 28
 eO_9                -2.227574e-01 1 1  ON 29
eH1_0                -2.871084e-01 1 1  ON 30
eH1_1                -1.871033e-01 1 1  ON 31
eH1_2                -1.410497e-01 1 1  ON 32
eH1_3                -8.594310e-02 1 1  ON 33
eH1_4                -3.557808e-02 1 1  ON 34
eH1_5                 4.164927e-03 1 1  ON 35
eH1_6                 7.342822e-02 1 1  ON 36
eH1_7                 1.571318e-01 1 1  ON 37
eH1_8                 2.272981e-01 1 1  ON 38
eH1_9                 2.089834e-01 1 1  ON 39
eH2_0                -2.846623e-01 1 1  ON 40
eH2_1                -1.855228e-01 1 1  ON 41
eH2_2                -1.392173e-01 1 1  ON 42
eH2_3                -8.407056e-02 1 1  ON 43
eH2_4                -3.376016e-02 1 1  ON 44
eH2_5                 5.064185e-03 1 1  ON 45
eH2_6                 7.409055e-02 1 1  ON 46
eH2_7                 1.558303e-01 1 1  ON 47
eH2_8                 2.245342e-01 1 1  ON 48
eH2_9                 2.356970e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9569
    reference variance = 0.270799
====================================================
  Execution time = 2.0422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3969e-01
  Total weights = 2.0000e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339732755597
                                         uncertainty =       0.003843573610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339732755597
                                         uncertainty =       0.003843573610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412123943
  error estimate for blocks of size 2^( 2) =       0.000424666409
  error estimate for blocks of size 2^( 3) =       0.000437519834
  error estimate for blocks of size 2^( 4) =       0.000450448153
  error estimate for blocks of size 2^( 5) =       0.000461600461
  error estimate for blocks of size 2^( 6) =       0.000468613377
  error estimate for blocks of size 2^( 7) =       0.000474679501

      target function =                  N/A
              le_mean =     -16.906409595248
             les_mean =     286.166377520953
             stat err =       0.000463835373
             autocorr =       1.266694951231
              std dev =       0.582831269321
             le_variance =       0.339692288498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339731163197
                                         uncertainty =       0.003843577910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339731163197
                                         uncertainty =       0.003843577910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412122977
  error estimate for blocks of size 2^( 2) =       0.000424665476
  error estimate for blocks of size 2^( 3) =       0.000437518930
  error estimate for blocks of size 2^( 4) =       0.000450447293
  error estimate for blocks of size 2^( 5) =       0.000461599643
  error estimate for blocks of size 2^( 6) =       0.000468612545
  error estimate for blocks of size 2^( 7) =       0.000474678680

      target function =                  N/A
              le_mean =     -16.906409599019
             les_mean =     286.166376056460
             stat err =       0.000463834540
             autocorr =       1.266696338502
              std dev =       0.582829903575
             le_variance =       0.339690696501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339731953603
                                         uncertainty =       0.003843575696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339731953603
                                         uncertainty =       0.003843575696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412123456
  error estimate for blocks of size 2^( 2) =       0.000424665939
  error estimate for blocks of size 2^( 3) =       0.000437519379
  error estimate for blocks of size 2^( 4) =       0.000450447720
  error estimate for blocks of size 2^( 5) =       0.000461600049
  error estimate for blocks of size 2^( 6) =       0.000468612958
  error estimate for blocks of size 2^( 7) =       0.000474679088

      target function =                  N/A
              le_mean =     -16.906409597131
             les_mean =     286.166376782836
             stat err =       0.000463834954
             autocorr =       1.266695650215
              std dev =       0.582830581478
             le_variance =       0.339691486706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339732655162
                                         uncertainty =       0.003843573869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339732655162
                                         uncertainty =       0.003843573869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412123882
  error estimate for blocks of size 2^( 2) =       0.000424666350
  error estimate for blocks of size 2^( 3) =       0.000437519777
  error estimate for blocks of size 2^( 4) =       0.000450448099
  error estimate for blocks of size 2^( 5) =       0.000461600410
  error estimate for blocks of size 2^( 6) =       0.000468613325
  error estimate for blocks of size 2^( 7) =       0.000474679449

      target function =                  N/A
              le_mean =     -16.906409595483
             les_mean =     286.166377428482
             stat err =       0.000463835321
             autocorr =       1.266695038774
              std dev =       0.582831183180
             le_variance =       0.339692188088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906409595248        initial
     5.9605e+01     5.9605e+02             2.5352e-06       -16.906409599019  <--
     2.3842e+02     2.3842e+03             6.3569e-07       -16.906409597131
     9.5367e+02     9.5367e+03             1.5904e-07       -16.906409595483

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 3.0000e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.939233e-01 1 1  ON 0
 uu_1                 1.269212e-01 1 1  ON 1
 uu_2                 2.516262e-02 1 1  ON 2
 uu_3                -3.777759e-02 1 1  ON 3
 uu_4                -8.378874e-02 1 1  ON 4
 uu_5                -1.193777e-01 1 1  ON 5
 uu_6                -1.479444e-01 1 1  ON 6
 uu_7                -1.626731e-01 1 1  ON 7
 uu_8                -1.557621e-01 1 1  ON 8
 uu_9                -1.293169e-01 1 1  ON 9
 ud_0                 4.510893e-01 1 1  ON 10
 ud_1                 1.872508e-01 1 1  ON 11
 ud_2                 7.094783e-02 1 1  ON 12
 ud_3                 1.794412e-03 1 1  ON 13
 ud_4                -5.687433e-02 1 1  ON 14
 ud_5                -1.003469e-01 1 1  ON 15
 ud_6                -1.293871e-01 1 1  ON 16
 ud_7                -1.469936e-01 1 1  ON 17
 ud_8                -1.497667e-01 1 1  ON 18
 ud_9                -1.419099e-01 1 1  ON 19
 eO_0                -7.028420e-01 1 1  ON 20
 eO_1                -3.866359e-01 1 1  ON 21
 eO_2                 2.605288e-02 1 1  ON 22
 eO_3                 3.412010e-01 1 1  ON 23
 eO_4                 5.667620e-01 1 1  ON 24
 eO_5                 5.258226e-01 1 1  ON 25
 eO_6                 2.817465e-01 1 1  ON 26
 eO_7                -6.457433e-02 1 1  ON 27
 eO_8                -3.271561e-01 1 1  ON 28
 eO_9                -2.227587e-01 1 1  ON 29
eH1_0                -2.871096e-01 1 1  ON 30
eH1_1                -1.871033e-01 1 1  ON 31
eH1_2                -1.410492e-01 1 1  ON 32
eH1_3                -8.594279e-02 1 1  ON 33
eH1_4                -3.557832e-02 1 1  ON 34
eH1_5                 4.165632e-03 1 1  ON 35
eH1_6                 7.342817e-02 1 1  ON 36
eH1_7                 1.571314e-01 1 1  ON 37
eH1_8                 2.272976e-01 1 1  ON 38
eH1_9                 2.089842e-01 1 1  ON 39
eH2_0                -2.846635e-01 1 1  ON 40
eH2_1                -1.855234e-01 1 1  ON 41
eH2_2                -1.392173e-01 1 1  ON 42
eH2_3                -8.407106e-02 1 1  ON 43
eH2_4                -3.376112e-02 1 1  ON 44
eH2_5                 5.065727e-03 1 1  ON 45
eH2_6                 7.409033e-02 1 1  ON 46
eH2_7                 1.558309e-01 1 1  ON 47
eH2_8                 2.245343e-01 1 1  ON 48
eH2_9                 2.356977e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.0033
    reference variance = 0.222854
====================================================
  Execution time = 2.2488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3669e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336724344610
                                         uncertainty =       0.004456018018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336724344610
                                         uncertainty =       0.004456018018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410300837
  error estimate for blocks of size 2^( 2) =       0.000422706393
  error estimate for blocks of size 2^( 3) =       0.000436047212
  error estimate for blocks of size 2^( 4) =       0.000448239813
  error estimate for blocks of size 2^( 5) =       0.000458215835
  error estimate for blocks of size 2^( 6) =       0.000465541687
  error estimate for blocks of size 2^( 7) =       0.000469647313

      target function =                  N/A
              le_mean =     -16.906440291790
             les_mean =     286.164416725016
             stat err =       0.000460411162
             autocorr =       1.259177289592
              std dev =       0.580253008194
             le_variance =       0.336693553518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644029179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906440291790       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906440375156       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906440346274       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906440372310       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906440350071       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906440360309       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906440352213       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.237434e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906440291790       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906440312777       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906440305613       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906440312221       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906440306400       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906440308958       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906440307021       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.128820e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906440291790       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906440297046       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906440295258       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906440296917       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906440295445       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906440296084       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906440295605       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.844494e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7960e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.939244e-01 1 1  ON 0
 uu_1                 1.269238e-01 1 1  ON 1
 uu_2                 2.516237e-02 1 1  ON 2
 uu_3                -3.777691e-02 1 1  ON 3
 uu_4                -8.378878e-02 1 1  ON 4
 uu_5                -1.193793e-01 1 1  ON 5
 uu_6                -1.479447e-01 1 1  ON 6
 uu_7                -1.626729e-01 1 1  ON 7
 uu_8                -1.557638e-01 1 1  ON 8
 uu_9                -1.293182e-01 1 1  ON 9
 ud_0                 4.510907e-01 1 1  ON 10
 ud_1                 1.872521e-01 1 1  ON 11
 ud_2                 7.094821e-02 1 1  ON 12
 ud_3                 1.795564e-03 1 1  ON 13
 ud_4                -5.687360e-02 1 1  ON 14
 ud_5                -1.003438e-01 1 1  ON 15
 ud_6                -1.293872e-01 1 1  ON 16
 ud_7                -1.469948e-01 1 1  ON 17
 ud_8                -1.497694e-01 1 1  ON 18
 ud_9                -1.419122e-01 1 1  ON 19
 eO_0                -7.028420e-01 1 1  ON 20
 eO_1                -3.866353e-01 1 1  ON 21
 eO_2                 2.605420e-02 1 1  ON 22
 eO_3                 3.412030e-01 1 1  ON 23
 eO_4                 5.667616e-01 1 1  ON 24
 eO_5                 5.258226e-01 1 1  ON 25
 eO_6                 2.817480e-01 1 1  ON 26
 eO_7                -6.457417e-02 1 1  ON 27
 eO_8                -3.271584e-01 1 1  ON 28
 eO_9                -2.227611e-01 1 1  ON 29
eH1_0                -2.871100e-01 1 1  ON 30
eH1_1                -1.871062e-01 1 1  ON 31
eH1_2                -1.410485e-01 1 1  ON 32
eH1_3                -8.594225e-02 1 1  ON 33
eH1_4                -3.557848e-02 1 1  ON 34
eH1_5                 4.166874e-03 1 1  ON 35
eH1_6                 7.342868e-02 1 1  ON 36
eH1_7                 1.571313e-01 1 1  ON 37
eH1_8                 2.272977e-01 1 1  ON 38
eH1_9                 2.089844e-01 1 1  ON 39
eH2_0                -2.846655e-01 1 1  ON 40
eH2_1                -1.855241e-01 1 1  ON 41
eH2_2                -1.392178e-01 1 1  ON 42
eH2_3                -8.407138e-02 1 1  ON 43
eH2_4                -3.376004e-02 1 1  ON 44
eH2_5                 5.067482e-03 1 1  ON 45
eH2_6                 7.408899e-02 1 1  ON 46
eH2_7                 1.558313e-01 1 1  ON 47
eH2_8                 2.245349e-01 1 1  ON 48
eH2_9                 2.356981e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.075
    reference variance = 0.952727
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.0000e+06
  Execution time = 1.8842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337576311091
                                         uncertainty =       0.003941614966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337576311091
                                         uncertainty =       0.003941614966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410871447
  error estimate for blocks of size 2^( 2) =       0.000423123611
  error estimate for blocks of size 2^( 3) =       0.000436051738
  error estimate for blocks of size 2^( 4) =       0.000447218968
  error estimate for blocks of size 2^( 5) =       0.000456228123
  error estimate for blocks of size 2^( 6) =       0.000463162925
  error estimate for blocks of size 2^( 7) =       0.000468579101

      target function =                  N/A
              le_mean =     -16.905597783211
             les_mean =     286.136866930415
             stat err =       0.000458797279
             autocorr =       1.246894602200
              std dev =       0.581059972399
             le_variance =       0.337630691524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337580701423
                                         uncertainty =       0.003941764371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337580701423
                                         uncertainty =       0.003941764371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874120
  error estimate for blocks of size 2^( 2) =       0.000423126059
  error estimate for blocks of size 2^( 3) =       0.000436054052
  error estimate for blocks of size 2^( 4) =       0.000447221102
  error estimate for blocks of size 2^( 5) =       0.000456230241
  error estimate for blocks of size 2^( 6) =       0.000463165068
  error estimate for blocks of size 2^( 7) =       0.000468581134

      target function =                  N/A
              le_mean =     -16.905597895479
             les_mean =     286.136875119014
             stat err =       0.000458799386
             autocorr =       1.246889833243
              std dev =       0.581063752271
             le_variance =       0.337635084204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337578564382
                                         uncertainty =       0.003941690619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337578564382
                                         uncertainty =       0.003941690619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410872819
  error estimate for blocks of size 2^( 2) =       0.000423124868
  error estimate for blocks of size 2^( 3) =       0.000436052927
  error estimate for blocks of size 2^( 4) =       0.000447220065
  error estimate for blocks of size 2^( 5) =       0.000456229212
  error estimate for blocks of size 2^( 6) =       0.000463164025
  error estimate for blocks of size 2^( 7) =       0.000468580145

      target function =                  N/A
              le_mean =     -16.905597840773
             les_mean =     286.136871131161
             stat err =       0.000458798362
             autocorr =       1.246892159484
              std dev =       0.581061912380
             le_variance =       0.337632946019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337576594567
                                         uncertainty =       0.003941624453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337576594567
                                         uncertainty =       0.003941624453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410871619
  error estimate for blocks of size 2^( 2) =       0.000423123769
  error estimate for blocks of size 2^( 3) =       0.000436051887
  error estimate for blocks of size 2^( 4) =       0.000447219106
  error estimate for blocks of size 2^( 5) =       0.000456228260
  error estimate for blocks of size 2^( 6) =       0.000463163063
  error estimate for blocks of size 2^( 7) =       0.000468579232

      target function =                  N/A
              le_mean =     -16.905597790443
             les_mean =     286.136867458556
             stat err =       0.000458797415
             autocorr =       1.246894294965
              std dev =       0.581060216459
             le_variance =       0.337630975152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905597783211        initial
     1.4901e+01     1.4901e+02             1.2374e-05       -16.905597895479  <--
     5.9605e+01     5.9605e+02             3.1288e-06       -16.905597840773
     2.3842e+02     2.3842e+03             7.8445e-07       -16.905597790443

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.9795e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.939277e-01 1 1  ON 0
 uu_1                 1.269314e-01 1 1  ON 1
 uu_2                 2.516175e-02 1 1  ON 2
 uu_3                -3.777495e-02 1 1  ON 3
 uu_4                -8.378889e-02 1 1  ON 4
 uu_5                -1.193838e-01 1 1  ON 5
 uu_6                -1.479455e-01 1 1  ON 6
 uu_7                -1.626721e-01 1 1  ON 7
 uu_8                -1.557690e-01 1 1  ON 8
 uu_9                -1.293224e-01 1 1  ON 9
 ud_0                 4.510950e-01 1 1  ON 10
 ud_1                 1.872561e-01 1 1  ON 11
 ud_2                 7.094941e-02 1 1  ON 12
 ud_3                 1.798955e-03 1 1  ON 13
 ud_4                -5.687133e-02 1 1  ON 14
 ud_5                -1.003346e-01 1 1  ON 15
 ud_6                -1.293876e-01 1 1  ON 16
 ud_7                -1.469981e-01 1 1  ON 17
 ud_8                -1.497774e-01 1 1  ON 18
 ud_9                -1.419191e-01 1 1  ON 19
 eO_0                -7.028421e-01 1 1  ON 20
 eO_1                -3.866334e-01 1 1  ON 21
 eO_2                 2.605807e-02 1 1  ON 22
 eO_3                 3.412089e-01 1 1  ON 23
 eO_4                 5.667605e-01 1 1  ON 24
 eO_5                 5.258229e-01 1 1  ON 25
 eO_6                 2.817526e-01 1 1  ON 26
 eO_7                -6.457370e-02 1 1  ON 27
 eO_8                -3.271652e-01 1 1  ON 28
 eO_9                -2.227682e-01 1 1  ON 29
eH1_0                -2.871111e-01 1 1  ON 30
eH1_1                -1.871146e-01 1 1  ON 31
eH1_2                -1.410465e-01 1 1  ON 32
eH1_3                -8.594065e-02 1 1  ON 33
eH1_4                -3.557892e-02 1 1  ON 34
eH1_5                 4.170583e-03 1 1  ON 35
eH1_6                 7.343021e-02 1 1  ON 36
eH1_7                 1.571312e-01 1 1  ON 37
eH1_8                 2.272977e-01 1 1  ON 38
eH1_9                 2.089848e-01 1 1  ON 39
eH2_0                -2.846715e-01 1 1  ON 40
eH2_1                -1.855263e-01 1 1  ON 41
eH2_2                -1.392192e-01 1 1  ON 42
eH2_3                -8.407231e-02 1 1  ON 43
eH2_4                -3.375680e-02 1 1  ON 44
eH2_5                 5.072738e-03 1 1  ON 45
eH2_6                 7.408502e-02 1 1  ON 46
eH2_7                 1.558324e-01 1 1  ON 47
eH2_8                 2.245369e-01 1 1  ON 48
eH2_9                 2.356990e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7760e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9584
    reference variance = 0.440031
====================================================
  Execution time = 2.0734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6996e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370123102595
                                         uncertainty =       0.032494362449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370123102595
                                         uncertainty =       0.032494362449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430094103
  error estimate for blocks of size 2^( 2) =       0.000441716501
  error estimate for blocks of size 2^( 3) =       0.000453483670
  error estimate for blocks of size 2^( 4) =       0.000464527969
  error estimate for blocks of size 2^( 5) =       0.000473945279
  error estimate for blocks of size 2^( 6) =       0.000480253959
  error estimate for blocks of size 2^( 7) =       0.000483930895

      target function =                  N/A
              le_mean =     -16.906336493614
             les_mean =     286.194175324804
             stat err =       0.000475664526
             autocorr =       1.223135444957
              std dev =       0.608244913251
             le_variance =       0.369961874495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633649361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906336493614       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336546360       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336527981       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906336554700       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906336486263       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906336478718       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906336517505       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906336530014       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 4.507567e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906336493614       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336507230       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336502417       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906336508866       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906336487858       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906336485977       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906336496038       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906336498667       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.182134e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906336493614       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336497046       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336495829       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906336497423       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906336491872       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906336491427       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906336493954       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906336494581       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.992974e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425684 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6182e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.939280e-01 1 1  ON 0
 uu_1                 1.269340e-01 1 1  ON 1
 uu_2                 2.516013e-02 1 1  ON 2
 uu_3                -3.777154e-02 1 1  ON 3
 uu_4                -8.379565e-02 1 1  ON 4
 uu_5                -1.193841e-01 1 1  ON 5
 uu_6                -1.479411e-01 1 1  ON 6
 uu_7                -1.626700e-01 1 1  ON 7
 uu_8                -1.557703e-01 1 1  ON 8
 uu_9                -1.293283e-01 1 1  ON 9
 ud_0                 4.510990e-01 1 1  ON 10
 ud_1                 1.872592e-01 1 1  ON 11
 ud_2                 7.094598e-02 1 1  ON 12
 ud_3                 1.800451e-03 1 1  ON 13
 ud_4                -5.687137e-02 1 1  ON 14
 ud_5                -1.003227e-01 1 1  ON 15
 ud_6                -1.293832e-01 1 1  ON 16
 ud_7                -1.470029e-01 1 1  ON 17
 ud_8                -1.497819e-01 1 1  ON 18
 ud_9                -1.419250e-01 1 1  ON 19
 eO_0                -7.028441e-01 1 1  ON 20
 eO_1                -3.866228e-01 1 1  ON 21
 eO_2                 2.606042e-02 1 1  ON 22
 eO_3                 3.412108e-01 1 1  ON 23
 eO_4                 5.667619e-01 1 1  ON 24
 eO_5                 5.258212e-01 1 1  ON 25
 eO_6                 2.817580e-01 1 1  ON 26
 eO_7                -6.457553e-02 1 1  ON 27
 eO_8                -3.271717e-01 1 1  ON 28
 eO_9                -2.227760e-01 1 1  ON 29
eH1_0                -2.871146e-01 1 1  ON 30
eH1_1                -1.871213e-01 1 1  ON 31
eH1_2                -1.410484e-01 1 1  ON 32
eH1_3                -8.593989e-02 1 1  ON 33
eH1_4                -3.557473e-02 1 1  ON 34
eH1_5                 4.173464e-03 1 1  ON 35
eH1_6                 7.342778e-02 1 1  ON 36
eH1_7                 1.571295e-01 1 1  ON 37
eH1_8                 2.272965e-01 1 1  ON 38
eH1_9                 2.089892e-01 1 1  ON 39
eH2_0                -2.846748e-01 1 1  ON 40
eH2_1                -1.855217e-01 1 1  ON 41
eH2_2                -1.392221e-01 1 1  ON 42
eH2_3                -8.407143e-02 1 1  ON 43
eH2_4                -3.375698e-02 1 1  ON 44
eH2_5                 5.077419e-03 1 1  ON 45
eH2_6                 7.407846e-02 1 1  ON 46
eH2_7                 1.558339e-01 1 1  ON 47
eH2_8                 2.245370e-01 1 1  ON 48
eH2_9                 2.356988e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8394
    reference variance = 0.20316
====================================================
  Execution time = 2.0011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3905e-01
  Total weights = 2.0000e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339041704393
                                         uncertainty =       0.004397185794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339041704393
                                         uncertainty =       0.004397185794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411732097
  error estimate for blocks of size 2^( 2) =       0.000424706945
  error estimate for blocks of size 2^( 3) =       0.000438339967
  error estimate for blocks of size 2^( 4) =       0.000451112018
  error estimate for blocks of size 2^( 5) =       0.000462813748
  error estimate for blocks of size 2^( 6) =       0.000470956366
  error estimate for blocks of size 2^( 7) =       0.000475469746

      target function =                  N/A
              le_mean =     -16.905129741607
             les_mean =     286.122458050308
             stat err =       0.000465087969
             autocorr =       1.275970879394
              std dev =       0.582277115535
             le_variance =       0.339046639276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339061694184
                                         uncertainty =       0.004397440750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339061694184
                                         uncertainty =       0.004397440750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411744230
  error estimate for blocks of size 2^( 2) =       0.000424717918
  error estimate for blocks of size 2^( 3) =       0.000438349677
  error estimate for blocks of size 2^( 4) =       0.000451121125
  error estimate for blocks of size 2^( 5) =       0.000462822957
  error estimate for blocks of size 2^( 6) =       0.000470965595
  error estimate for blocks of size 2^( 7) =       0.000475477932

      target function =                  N/A
              le_mean =     -16.905129714535
             les_mean =     286.122477118185
             stat err =       0.000465096902
             autocorr =       1.275944690222
              std dev =       0.582294274806
             le_variance =       0.339066622472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339052433099
                                         uncertainty =       0.004397325401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339052433099
                                         uncertainty =       0.004397325401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411738609
  error estimate for blocks of size 2^( 2) =       0.000424712841
  error estimate for blocks of size 2^( 3) =       0.000438345184
  error estimate for blocks of size 2^( 4) =       0.000451116917
  error estimate for blocks of size 2^( 5) =       0.000462818706
  error estimate for blocks of size 2^( 6) =       0.000470961327
  error estimate for blocks of size 2^( 7) =       0.000475474143

      target function =                  N/A
              le_mean =     -16.905129727181
             les_mean =     286.122468287553
             stat err =       0.000465092773
             autocorr =       1.275956877134
              std dev =       0.582286324977
             le_variance =       0.339057364255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339043069624
                                         uncertainty =       0.004397203671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339043069624
                                         uncertainty =       0.004397203671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411732926
  error estimate for blocks of size 2^( 2) =       0.000424707695
  error estimate for blocks of size 2^( 3) =       0.000438340631
  error estimate for blocks of size 2^( 4) =       0.000451112641
  error estimate for blocks of size 2^( 5) =       0.000462814379
  error estimate for blocks of size 2^( 6) =       0.000470956997
  error estimate for blocks of size 2^( 7) =       0.000475470305

      target function =                  N/A
              le_mean =     -16.905129739604
             les_mean =     286.122459347337
             stat err =       0.000465088581
             autocorr =       1.275969097951
              std dev =       0.582278287442
             le_variance =       0.339048004027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905129741607        initial  <--
     3.7253e+00     3.7253e+01             4.5076e-05       -16.905129714535
     1.4901e+01     1.4901e+02             1.1821e-05       -16.905129727181
     5.9605e+01     5.9605e+02             2.9930e-06       -16.905129739604

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5529
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.939277e-01 1 1  ON 0
 uu_1                 1.269314e-01 1 1  ON 1
 uu_2                 2.516175e-02 1 1  ON 2
 uu_3                -3.777495e-02 1 1  ON 3
 uu_4                -8.378889e-02 1 1  ON 4
 uu_5                -1.193838e-01 1 1  ON 5
 uu_6                -1.479455e-01 1 1  ON 6
 uu_7                -1.626721e-01 1 1  ON 7
 uu_8                -1.557690e-01 1 1  ON 8
 uu_9                -1.293224e-01 1 1  ON 9
 ud_0                 4.510950e-01 1 1  ON 10
 ud_1                 1.872561e-01 1 1  ON 11
 ud_2                 7.094941e-02 1 1  ON 12
 ud_3                 1.798955e-03 1 1  ON 13
 ud_4                -5.687133e-02 1 1  ON 14
 ud_5                -1.003346e-01 1 1  ON 15
 ud_6                -1.293876e-01 1 1  ON 16
 ud_7                -1.469981e-01 1 1  ON 17
 ud_8                -1.497774e-01 1 1  ON 18
 ud_9                -1.419191e-01 1 1  ON 19
 eO_0                -7.028421e-01 1 1  ON 20
 eO_1                -3.866334e-01 1 1  ON 21
 eO_2                 2.605807e-02 1 1  ON 22
 eO_3                 3.412089e-01 1 1  ON 23
 eO_4                 5.667605e-01 1 1  ON 24
 eO_5                 5.258229e-01 1 1  ON 25
 eO_6                 2.817526e-01 1 1  ON 26
 eO_7                -6.457370e-02 1 1  ON 27
 eO_8                -3.271652e-01 1 1  ON 28
 eO_9                -2.227682e-01 1 1  ON 29
eH1_0                -2.871111e-01 1 1  ON 30
eH1_1                -1.871146e-01 1 1  ON 31
eH1_2                -1.410465e-01 1 1  ON 32
eH1_3                -8.594065e-02 1 1  ON 33
eH1_4                -3.557892e-02 1 1  ON 34
eH1_5                 4.170583e-03 1 1  ON 35
eH1_6                 7.343021e-02 1 1  ON 36
eH1_7                 1.571312e-01 1 1  ON 37
eH1_8                 2.272977e-01 1 1  ON 38
eH1_9                 2.089848e-01 1 1  ON 39
eH2_0                -2.846715e-01 1 1  ON 40
eH2_1                -1.855263e-01 1 1  ON 41
eH2_2                -1.392192e-01 1 1  ON 42
eH2_3                -8.407231e-02 1 1  ON 43
eH2_4                -3.375680e-02 1 1  ON 44
eH2_5                 5.072738e-03 1 1  ON 45
eH2_6                 7.408502e-02 1 1  ON 46
eH2_7                 1.558324e-01 1 1  ON 47
eH2_8                 2.245369e-01 1 1  ON 48
eH2_9                 2.356990e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9373
    reference variance = 0.325077
====================================================
  Execution time = 2.0565e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4583e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344582978916
                                         uncertainty =       0.004428964253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344582978916
                                         uncertainty =       0.004428964253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414988348
  error estimate for blocks of size 2^( 2) =       0.000426843194
  error estimate for blocks of size 2^( 3) =       0.000439217199
  error estimate for blocks of size 2^( 4) =       0.000450964000
  error estimate for blocks of size 2^( 5) =       0.000459362571
  error estimate for blocks of size 2^( 6) =       0.000466222192
  error estimate for blocks of size 2^( 7) =       0.000472524496

      target function =                  N/A
              le_mean =     -16.906099946438
             les_mean =     286.160645884226
             stat err =       0.000462268315
             autocorr =       1.240841895427
              std dev =       0.586882149573
             le_variance =       0.344430657487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609994644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906099946438       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099964882       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099978173       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906099974381       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906099974286       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906099975034       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906099974145       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906099975160       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.910173e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906099946438       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099951062       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099954392       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906099953439       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906099953410       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906099953593       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906099953373       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906099953627       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.480297e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906099946438       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099947595       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099948428       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906099948189       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906099948182       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906099948227       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906099948172       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906099948234       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.702472e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6030e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.939279e-01 1 1  ON 0
 uu_1                 1.269309e-01 1 1  ON 1
 uu_2                 2.516165e-02 1 1  ON 2
 uu_3                -3.777465e-02 1 1  ON 3
 uu_4                -8.378866e-02 1 1  ON 4
 uu_5                -1.193843e-01 1 1  ON 5
 uu_6                -1.479457e-01 1 1  ON 6
 uu_7                -1.626727e-01 1 1  ON 7
 uu_8                -1.557687e-01 1 1  ON 8
 uu_9                -1.293222e-01 1 1  ON 9
 ud_0                 4.510950e-01 1 1  ON 10
 ud_1                 1.872564e-01 1 1  ON 11
 ud_2                 7.094986e-02 1 1  ON 12
 ud_3                 1.798983e-03 1 1  ON 13
 ud_4                -5.687101e-02 1 1  ON 14
 ud_5                -1.003339e-01 1 1  ON 15
 ud_6                -1.293873e-01 1 1  ON 16
 ud_7                -1.469987e-01 1 1  ON 17
 ud_8                -1.497777e-01 1 1  ON 18
 ud_9                -1.419194e-01 1 1  ON 19
 eO_0                -7.028425e-01 1 1  ON 20
 eO_1                -3.866326e-01 1 1  ON 21
 eO_2                 2.605818e-02 1 1  ON 22
 eO_3                 3.412097e-01 1 1  ON 23
 eO_4                 5.667609e-01 1 1  ON 24
 eO_5                 5.258222e-01 1 1  ON 25
 eO_6                 2.817527e-01 1 1  ON 26
 eO_7                -6.457374e-02 1 1  ON 27
 eO_8                -3.271656e-01 1 1  ON 28
 eO_9                -2.227688e-01 1 1  ON 29
eH1_0                -2.871112e-01 1 1  ON 30
eH1_1                -1.871150e-01 1 1  ON 31
eH1_2                -1.410465e-01 1 1  ON 32
eH1_3                -8.594081e-02 1 1  ON 33
eH1_4                -3.557943e-02 1 1  ON 34
eH1_5                 4.170684e-03 1 1  ON 35
eH1_6                 7.343059e-02 1 1  ON 36
eH1_7                 1.571314e-01 1 1  ON 37
eH1_8                 2.272974e-01 1 1  ON 38
eH1_9                 2.089853e-01 1 1  ON 39
eH2_0                -2.846730e-01 1 1  ON 40
eH2_1                -1.855265e-01 1 1  ON 41
eH2_2                -1.392188e-01 1 1  ON 42
eH2_3                -8.407214e-02 1 1  ON 43
eH2_4                -3.375676e-02 1 1  ON 44
eH2_5                 5.072550e-03 1 1  ON 45
eH2_6                 7.408464e-02 1 1  ON 46
eH2_7                 1.558330e-01 1 1  ON 47
eH2_8                 2.245372e-01 1 1  ON 48
eH2_9                 2.356993e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.283059
====================================================
  Execution time = 1.9866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4357e-01
  Total weights = 2.0000e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343548387378
                                         uncertainty =       0.007784841060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343548387378
                                         uncertainty =       0.007784841060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414468494
  error estimate for blocks of size 2^( 2) =       0.000426699995
  error estimate for blocks of size 2^( 3) =       0.000439609602
  error estimate for blocks of size 2^( 4) =       0.000450431402
  error estimate for blocks of size 2^( 5) =       0.000460419556
  error estimate for blocks of size 2^( 6) =       0.000467871859
  error estimate for blocks of size 2^( 7) =       0.000473553479

      target function =                  N/A
              le_mean =     -16.906287108749
             les_mean =     286.166111897123
             stat err =       0.000463069074
             autocorr =       1.248269930613
              std dev =       0.586146965761
             le_variance =       0.343568265471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343546328502
                                         uncertainty =       0.007784739351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343546328502
                                         uncertainty =       0.007784739351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414467252
  error estimate for blocks of size 2^( 2) =       0.000426698849
  error estimate for blocks of size 2^( 3) =       0.000439608541
  error estimate for blocks of size 2^( 4) =       0.000450430395
  error estimate for blocks of size 2^( 5) =       0.000460418605
  error estimate for blocks of size 2^( 6) =       0.000467870915
  error estimate for blocks of size 2^( 7) =       0.000473552557

      target function =                  N/A
              le_mean =     -16.906287110903
             les_mean =     286.166109910383
             stat err =       0.000463068118
             autocorr =       1.248272259594
              std dev =       0.586145208860
             le_variance =       0.343566205870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343547348732
                                         uncertainty =       0.007784789808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343547348732
                                         uncertainty =       0.007784789808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414467868
  error estimate for blocks of size 2^( 2) =       0.000426699417
  error estimate for blocks of size 2^( 3) =       0.000439609067
  error estimate for blocks of size 2^( 4) =       0.000450430894
  error estimate for blocks of size 2^( 5) =       0.000460419076
  error estimate for blocks of size 2^( 6) =       0.000467871383
  error estimate for blocks of size 2^( 7) =       0.000473553014

      target function =                  N/A
              le_mean =     -16.906287109818
             les_mean =     286.166110894277
             stat err =       0.000463068592
             autocorr =       1.248271105437
              std dev =       0.586146079454
             le_variance =       0.343567226459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343548257249
                                         uncertainty =       0.007784834641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343548257249
                                         uncertainty =       0.007784834641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414468416
  error estimate for blocks of size 2^( 2) =       0.000426699923
  error estimate for blocks of size 2^( 3) =       0.000439609535
  error estimate for blocks of size 2^( 4) =       0.000450431339
  error estimate for blocks of size 2^( 5) =       0.000460419496
  error estimate for blocks of size 2^( 6) =       0.000467871800
  error estimate for blocks of size 2^( 7) =       0.000473553421

      target function =                  N/A
              le_mean =     -16.906287108881
             les_mean =     286.166111771422
             stat err =       0.000463069014
             autocorr =       1.248270077799
              std dev =       0.586146854718
             le_variance =       0.343568135296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906287108749        initial
     3.7253e+01     3.7253e+02             5.9102e-06       -16.906287110903  <--
     1.4901e+02     1.4901e+03             1.4803e-06       -16.906287109818
     5.9605e+02     5.9605e+03             3.7025e-07       -16.906287108881

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.9407e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.939286e-01 1 1  ON 0
 uu_1                 1.269297e-01 1 1  ON 1
 uu_2                 2.516138e-02 1 1  ON 2
 uu_3                -3.777375e-02 1 1  ON 3
 uu_4                -8.378796e-02 1 1  ON 4
 uu_5                -1.193859e-01 1 1  ON 5
 uu_6                -1.479464e-01 1 1  ON 6
 uu_7                -1.626745e-01 1 1  ON 7
 uu_8                -1.557677e-01 1 1  ON 8
 uu_9                -1.293216e-01 1 1  ON 9
 ud_0                 4.510950e-01 1 1  ON 10
 ud_1                 1.872572e-01 1 1  ON 11
 ud_2                 7.095120e-02 1 1  ON 12
 ud_3                 1.799077e-03 1 1  ON 13
 ud_4                -5.687008e-02 1 1  ON 14
 ud_5                -1.003320e-01 1 1  ON 15
 ud_6                -1.293862e-01 1 1  ON 16
 ud_7                -1.470003e-01 1 1  ON 17
 ud_8                -1.497784e-01 1 1  ON 18
 ud_9                -1.419201e-01 1 1  ON 19
 eO_0                -7.028436e-01 1 1  ON 20
 eO_1                -3.866299e-01 1 1  ON 21
 eO_2                 2.605852e-02 1 1  ON 22
 eO_3                 3.412119e-01 1 1  ON 23
 eO_4                 5.667622e-01 1 1  ON 24
 eO_5                 5.258202e-01 1 1  ON 25
 eO_6                 2.817530e-01 1 1  ON 26
 eO_7                -6.457386e-02 1 1  ON 27
 eO_8                -3.271667e-01 1 1  ON 28
 eO_9                -2.227706e-01 1 1  ON 29
eH1_0                -2.871117e-01 1 1  ON 30
eH1_1                -1.871163e-01 1 1  ON 31
eH1_2                -1.410466e-01 1 1  ON 32
eH1_3                -8.594130e-02 1 1  ON 33
eH1_4                -3.558098e-02 1 1  ON 34
eH1_5                 4.170987e-03 1 1  ON 35
eH1_6                 7.343175e-02 1 1  ON 36
eH1_7                 1.571318e-01 1 1  ON 37
eH1_8                 2.272965e-01 1 1  ON 38
eH1_9                 2.089868e-01 1 1  ON 39
eH2_0                -2.846774e-01 1 1  ON 40
eH2_1                -1.855271e-01 1 1  ON 41
eH2_2                -1.392174e-01 1 1  ON 42
eH2_3                -8.407161e-02 1 1  ON 43
eH2_4                -3.375662e-02 1 1  ON 44
eH2_5                 5.071987e-03 1 1  ON 45
eH2_6                 7.408348e-02 1 1  ON 46
eH2_7                 1.558347e-01 1 1  ON 47
eH2_8                 2.245382e-01 1 1  ON 48
eH2_9                 2.357002e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.606459
====================================================
  Execution time = 2.0851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4410e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344152803508
                                         uncertainty =       0.004919059955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344152803508
                                         uncertainty =       0.004919059955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414789677
  error estimate for blocks of size 2^( 2) =       0.000426990089
  error estimate for blocks of size 2^( 3) =       0.000439135933
  error estimate for blocks of size 2^( 4) =       0.000451631044
  error estimate for blocks of size 2^( 5) =       0.000461873030
  error estimate for blocks of size 2^( 6) =       0.000469100888
  error estimate for blocks of size 2^( 7) =       0.000477768439

      target function =                  N/A
              le_mean =     -16.906118742326
             les_mean =     286.160951710330
             stat err =       0.000465093350
             autocorr =       1.257257921380
              std dev =       0.586601187133
             le_variance =       0.344100952746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611874233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118742326       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118706318       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118693692       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118721744       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118741297       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118758179       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118756506       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.272486e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118742326       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118733183       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118729810       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118736751       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118741464       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118745746       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118745183       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.728662e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118742326       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118740031       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118739174       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118740904       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118742071       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118743145       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118742994       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.435175e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430505 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6340e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.939284e-01 1 1  ON 0
 uu_1                 1.269319e-01 1 1  ON 1
 uu_2                 2.516013e-02 1 1  ON 2
 uu_3                -3.777327e-02 1 1  ON 3
 uu_4                -8.378844e-02 1 1  ON 4
 uu_5                -1.193842e-01 1 1  ON 5
 uu_6                -1.479445e-01 1 1  ON 6
 uu_7                -1.626770e-01 1 1  ON 7
 uu_8                -1.557682e-01 1 1  ON 8
 uu_9                -1.293229e-01 1 1  ON 9
 ud_0                 4.510936e-01 1 1  ON 10
 ud_1                 1.872581e-01 1 1  ON 11
 ud_2                 7.095121e-02 1 1  ON 12
 ud_3                 1.801762e-03 1 1  ON 13
 ud_4                -5.686994e-02 1 1  ON 14
 ud_5                -1.003311e-01 1 1  ON 15
 ud_6                -1.293846e-01 1 1  ON 16
 ud_7                -1.470014e-01 1 1  ON 17
 ud_8                -1.497782e-01 1 1  ON 18
 ud_9                -1.419218e-01 1 1  ON 19
 eO_0                -7.028444e-01 1 1  ON 20
 eO_1                -3.866288e-01 1 1  ON 21
 eO_2                 2.605925e-02 1 1  ON 22
 eO_3                 3.412139e-01 1 1  ON 23
 eO_4                 5.667627e-01 1 1  ON 24
 eO_5                 5.258201e-01 1 1  ON 25
 eO_6                 2.817547e-01 1 1  ON 26
 eO_7                -6.457406e-02 1 1  ON 27
 eO_8                -3.271683e-01 1 1  ON 28
 eO_9                -2.227733e-01 1 1  ON 29
eH1_0                -2.871135e-01 1 1  ON 30
eH1_1                -1.871184e-01 1 1  ON 31
eH1_2                -1.410431e-01 1 1  ON 32
eH1_3                -8.594046e-02 1 1  ON 33
eH1_4                -3.558053e-02 1 1  ON 34
eH1_5                 4.170703e-03 1 1  ON 35
eH1_6                 7.343023e-02 1 1  ON 36
eH1_7                 1.571311e-01 1 1  ON 37
eH1_8                 2.272966e-01 1 1  ON 38
eH1_9                 2.089880e-01 1 1  ON 39
eH2_0                -2.846831e-01 1 1  ON 40
eH2_1                -1.855297e-01 1 1  ON 41
eH2_2                -1.392162e-01 1 1  ON 42
eH2_3                -8.407374e-02 1 1  ON 43
eH2_4                -3.375524e-02 1 1  ON 44
eH2_5                 5.073149e-03 1 1  ON 45
eH2_6                 7.408494e-02 1 1  ON 46
eH2_7                 1.558363e-01 1 1  ON 47
eH2_8                 2.245387e-01 1 1  ON 48
eH2_9                 2.357015e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8836
    reference variance = 0.251627
====================================================
  Execution time = 2.0689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3781e-01
  Total weights = 2.0000e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895044071
                                         uncertainty =       0.003196045480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895044071
                                         uncertainty =       0.003196045480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410979453
  error estimate for blocks of size 2^( 2) =       0.000423404936
  error estimate for blocks of size 2^( 3) =       0.000436068581
  error estimate for blocks of size 2^( 4) =       0.000447983334
  error estimate for blocks of size 2^( 5) =       0.000458800700
  error estimate for blocks of size 2^( 6) =       0.000466308702
  error estimate for blocks of size 2^( 7) =       0.000471402215

      target function =                  N/A
              le_mean =     -16.905939584376
             les_mean =     286.148601283245
             stat err =       0.000461123738
             autocorr =       1.258910162126
              std dev =       0.581212716290
             le_variance =       0.337808221578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337887802088
                                         uncertainty =       0.003195976702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337887802088
                                         uncertainty =       0.003195976702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410975053
  error estimate for blocks of size 2^( 2) =       0.000423400691
  error estimate for blocks of size 2^( 3) =       0.000436064556
  error estimate for blocks of size 2^( 4) =       0.000447979579
  error estimate for blocks of size 2^( 5) =       0.000458797146
  error estimate for blocks of size 2^( 6) =       0.000466305317
  error estimate for blocks of size 2^( 7) =       0.000471398693

      target function =                  N/A
              le_mean =     -16.905939657685
             les_mean =     286.148596528216
             stat err =       0.000461120183
             autocorr =       1.258917713403
              std dev =       0.581206493273
             le_variance =       0.337800987823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337891412844
                                         uncertainty =       0.003196010984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337891412844
                                         uncertainty =       0.003196010984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410977247
  error estimate for blocks of size 2^( 2) =       0.000423402806
  error estimate for blocks of size 2^( 3) =       0.000436066561
  error estimate for blocks of size 2^( 4) =       0.000447981451
  error estimate for blocks of size 2^( 5) =       0.000458798918
  error estimate for blocks of size 2^( 6) =       0.000466307006
  error estimate for blocks of size 2^( 7) =       0.000471400444

      target function =                  N/A
              le_mean =     -16.905939621261
             les_mean =     286.148598903402
             stat err =       0.000461121955
             autocorr =       1.258913943735
              std dev =       0.581209596085
             le_variance =       0.337804594582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337894589801
                                         uncertainty =       0.003196041166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337894589801
                                         uncertainty =       0.003196041166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410979177
  error estimate for blocks of size 2^( 2) =       0.000423404670
  error estimate for blocks of size 2^( 3) =       0.000436068329
  error estimate for blocks of size 2^( 4) =       0.000447983098
  error estimate for blocks of size 2^( 5) =       0.000458800477
  error estimate for blocks of size 2^( 6) =       0.000466308490
  error estimate for blocks of size 2^( 7) =       0.000471401993

      target function =                  N/A
              le_mean =     -16.905939588970
             les_mean =     286.148600984845
             stat err =       0.000461123515
             autocorr =       1.258910634862
              std dev =       0.581212325953
             le_variance =       0.337807767840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905939584376        initial
     9.3132e+00     9.3132e+01             2.2725e-05       -16.905939657685  <--
     3.7253e+01     3.7253e+02             5.7287e-06       -16.905939621261
     1.4901e+02     1.4901e+03             1.4352e-06       -16.905939588970

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 3.0261e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.939278e-01 1 1  ON 0
 uu_1                 1.269382e-01 1 1  ON 1
 uu_2                 2.515666e-02 1 1  ON 2
 uu_3                -3.777197e-02 1 1  ON 3
 uu_4                -8.378972e-02 1 1  ON 4
 uu_5                -1.193794e-01 1 1  ON 5
 uu_6                -1.479391e-01 1 1  ON 6
 uu_7                -1.626843e-01 1 1  ON 7
 uu_8                -1.557698e-01 1 1  ON 8
 uu_9                -1.293268e-01 1 1  ON 9
 ud_0                 4.510896e-01 1 1  ON 10
 ud_1                 1.872610e-01 1 1  ON 11
 ud_2                 7.095138e-02 1 1  ON 12
 ud_3                 1.809507e-03 1 1  ON 13
 ud_4                -5.686938e-02 1 1  ON 14
 ud_5                -1.003283e-01 1 1  ON 15
 ud_6                -1.293799e-01 1 1  ON 16
 ud_7                -1.470045e-01 1 1  ON 17
 ud_8                -1.497774e-01 1 1  ON 18
 ud_9                -1.419270e-01 1 1  ON 19
 eO_0                -7.028466e-01 1 1  ON 20
 eO_1                -3.866253e-01 1 1  ON 21
 eO_2                 2.606140e-02 1 1  ON 22
 eO_3                 3.412199e-01 1 1  ON 23
 eO_4                 5.667643e-01 1 1  ON 24
 eO_5                 5.258199e-01 1 1  ON 25
 eO_6                 2.817595e-01 1 1  ON 26
 eO_7                -6.457467e-02 1 1  ON 27
 eO_8                -3.271731e-01 1 1  ON 28
 eO_9                -2.227813e-01 1 1  ON 29
eH1_0                -2.871189e-01 1 1  ON 30
eH1_1                -1.871245e-01 1 1  ON 31
eH1_2                -1.410331e-01 1 1  ON 32
eH1_3                -8.593793e-02 1 1  ON 33
eH1_4                -3.557917e-02 1 1  ON 34
eH1_5                 4.169818e-03 1 1  ON 35
eH1_6                 7.342570e-02 1 1  ON 36
eH1_7                 1.571289e-01 1 1  ON 37
eH1_8                 2.272967e-01 1 1  ON 38
eH1_9                 2.089915e-01 1 1  ON 39
eH2_0                -2.847001e-01 1 1  ON 40
eH2_1                -1.855372e-01 1 1  ON 41
eH2_2                -1.392126e-01 1 1  ON 42
eH2_3                -8.407999e-02 1 1  ON 43
eH2_4                -3.375118e-02 1 1  ON 44
eH2_5                 5.076672e-03 1 1  ON 45
eH2_6                 7.408932e-02 1 1  ON 46
eH2_7                 1.558410e-01 1 1  ON 47
eH2_8                 2.245400e-01 1 1  ON 48
eH2_9                 2.357053e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.986
    reference variance = 0.913015
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3212e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331896739802
                                         uncertainty =       0.002814194239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331896739802
                                         uncertainty =       0.002814194239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407506216
  error estimate for blocks of size 2^( 2) =       0.000420173285
  error estimate for blocks of size 2^( 3) =       0.000433386163
  error estimate for blocks of size 2^( 4) =       0.000445975120
  error estimate for blocks of size 2^( 5) =       0.000456450862
  error estimate for blocks of size 2^( 6) =       0.000466107724
  error estimate for blocks of size 2^( 7) =       0.000471859537

      target function =                  N/A
              le_mean =     -16.906116050570
             les_mean =     286.148882381994
             stat err =       0.000460098311
             autocorr =       1.274772838535
              std dev =       0.576300817890
             le_variance =       0.332122632701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611605057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116050570       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116104123       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116228839       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116345290       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116402908       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116452007       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116407588       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116436345       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 6.953648e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116050570       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116064772       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116099129       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116131505       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116146744       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116158154       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116148749       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116156098       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.859724e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906116050570       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116054175       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906116062992       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116071335       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116075209       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116077979       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116075751       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116077639       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.729505e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433091 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6045e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.939355e-01 1 1  ON 0
 uu_1                 1.269365e-01 1 1  ON 1
 uu_2                 2.514990e-02 1 1  ON 2
 uu_3                -3.776728e-02 1 1  ON 3
 uu_4                -8.379230e-02 1 1  ON 4
 uu_5                -1.193980e-01 1 1  ON 5
 uu_6                -1.479311e-01 1 1  ON 6
 uu_7                -1.626795e-01 1 1  ON 7
 uu_8                -1.557710e-01 1 1  ON 8
 uu_9                -1.293259e-01 1 1  ON 9
 ud_0                 4.510970e-01 1 1  ON 10
 ud_1                 1.872669e-01 1 1  ON 11
 ud_2                 7.095662e-02 1 1  ON 12
 ud_3                 1.803624e-03 1 1  ON 13
 ud_4                -5.686249e-02 1 1  ON 14
 ud_5                -1.003309e-01 1 1  ON 15
 ud_6                -1.293803e-01 1 1  ON 16
 ud_7                -1.470144e-01 1 1  ON 17
 ud_8                -1.497777e-01 1 1  ON 18
 ud_9                -1.419267e-01 1 1  ON 19
 eO_0                -7.028497e-01 1 1  ON 20
 eO_1                -3.866315e-01 1 1  ON 21
 eO_2                 2.607027e-02 1 1  ON 22
 eO_3                 3.412284e-01 1 1  ON 23
 eO_4                 5.667788e-01 1 1  ON 24
 eO_5                 5.258189e-01 1 1  ON 25
 eO_6                 2.817555e-01 1 1  ON 26
 eO_7                -6.457238e-02 1 1  ON 27
 eO_8                -3.271781e-01 1 1  ON 28
 eO_9                -2.227923e-01 1 1  ON 29
eH1_0                -2.871208e-01 1 1  ON 30
eH1_1                -1.871373e-01 1 1  ON 31
eH1_2                -1.410333e-01 1 1  ON 32
eH1_3                -8.594009e-02 1 1  ON 33
eH1_4                -3.557681e-02 1 1  ON 34
eH1_5                 4.163549e-03 1 1  ON 35
eH1_6                 7.342152e-02 1 1  ON 36
eH1_7                 1.571326e-01 1 1  ON 37
eH1_8                 2.273006e-01 1 1  ON 38
eH1_9                 2.090020e-01 1 1  ON 39
eH2_0                -2.847123e-01 1 1  ON 40
eH2_1                -1.855364e-01 1 1  ON 41
eH2_2                -1.392204e-01 1 1  ON 42
eH2_3                -8.408318e-02 1 1  ON 43
eH2_4                -3.374495e-02 1 1  ON 44
eH2_5                 5.085672e-03 1 1  ON 45
eH2_6                 7.408463e-02 1 1  ON 46
eH2_7                 1.558425e-01 1 1  ON 47
eH2_8                 2.245440e-01 1 1  ON 48
eH2_9                 2.357079e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9345
    reference variance = 0.292575
====================================================
  Execution time = 2.0268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4083e-01
  Total weights = 2.0000e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340758901278
                                         uncertainty =       0.004684105241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340758901278
                                         uncertainty =       0.004684105241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412812779
  error estimate for blocks of size 2^( 2) =       0.000425420190
  error estimate for blocks of size 2^( 3) =       0.000438081126
  error estimate for blocks of size 2^( 4) =       0.000449522976
  error estimate for blocks of size 2^( 5) =       0.000457806377
  error estimate for blocks of size 2^( 6) =       0.000464782395
  error estimate for blocks of size 2^( 7) =       0.000468714173

      target function =                  N/A
              le_mean =     -16.907245834142
             les_mean =     286.195790307095
             stat err =       0.000460206481
             autocorr =       1.242794131550
              std dev =       0.583805431121
             le_variance =       0.340828781406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340776165036
                                         uncertainty =       0.004684415838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340776165036
                                         uncertainty =       0.004684415838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412823299
  error estimate for blocks of size 2^( 2) =       0.000425430787
  error estimate for blocks of size 2^( 3) =       0.000438091174
  error estimate for blocks of size 2^( 4) =       0.000449533242
  error estimate for blocks of size 2^( 5) =       0.000457816700
  error estimate for blocks of size 2^( 6) =       0.000464791675
  error estimate for blocks of size 2^( 7) =       0.000468723455

      target function =                  N/A
              le_mean =     -16.907245409090
             les_mean =     286.195793305829
             stat err =       0.000460216268
             autocorr =       1.242783652159
              std dev =       0.583820308873
             le_variance =       0.340846153052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340767790479
                                         uncertainty =       0.004684271048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340767790479
                                         uncertainty =       0.004684271048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412818198
  error estimate for blocks of size 2^( 2) =       0.000425425664
  error estimate for blocks of size 2^( 3) =       0.000438086328
  error estimate for blocks of size 2^( 4) =       0.000449528312
  error estimate for blocks of size 2^( 5) =       0.000457811763
  error estimate for blocks of size 2^( 6) =       0.000464787229
  error estimate for blocks of size 2^( 7) =       0.000468718983

      target function =                  N/A
              le_mean =     -16.907245580333
             les_mean =     286.195790672088
             stat err =       0.000460211572
             autocorr =       1.242789005310
              std dev =       0.583813094068
             le_variance =       0.340837728805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340760017168
                                         uncertainty =       0.004684126331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340760017168
                                         uncertainty =       0.004684126331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412813460
  error estimate for blocks of size 2^( 2) =       0.000425420878
  error estimate for blocks of size 2^( 3) =       0.000438081780
  error estimate for blocks of size 2^( 4) =       0.000449523648
  error estimate for blocks of size 2^( 5) =       0.000457807056
  error estimate for blocks of size 2^( 6) =       0.000464783004
  error estimate for blocks of size 2^( 7) =       0.000468714778

      target function =                  N/A
              le_mean =     -16.907245800421
             les_mean =     286.195790290161
             stat err =       0.000460207121
             autocorr =       1.242793496427
              std dev =       0.583806393183
             le_variance =       0.340829904721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907245834142        initial  <--
     2.3283e+00     2.3283e+01             6.9536e-05       -16.907245409090
     9.3132e+00     9.3132e+01             1.8597e-05       -16.907245580333
     3.7253e+01     3.7253e+02             4.7295e-06       -16.907245800421

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8679
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.939278e-01 1 1  ON 0
 uu_1                 1.269382e-01 1 1  ON 1
 uu_2                 2.515666e-02 1 1  ON 2
 uu_3                -3.777197e-02 1 1  ON 3
 uu_4                -8.378972e-02 1 1  ON 4
 uu_5                -1.193794e-01 1 1  ON 5
 uu_6                -1.479391e-01 1 1  ON 6
 uu_7                -1.626843e-01 1 1  ON 7
 uu_8                -1.557698e-01 1 1  ON 8
 uu_9                -1.293268e-01 1 1  ON 9
 ud_0                 4.510896e-01 1 1  ON 10
 ud_1                 1.872610e-01 1 1  ON 11
 ud_2                 7.095138e-02 1 1  ON 12
 ud_3                 1.809507e-03 1 1  ON 13
 ud_4                -5.686938e-02 1 1  ON 14
 ud_5                -1.003283e-01 1 1  ON 15
 ud_6                -1.293799e-01 1 1  ON 16
 ud_7                -1.470045e-01 1 1  ON 17
 ud_8                -1.497774e-01 1 1  ON 18
 ud_9                -1.419270e-01 1 1  ON 19
 eO_0                -7.028466e-01 1 1  ON 20
 eO_1                -3.866253e-01 1 1  ON 21
 eO_2                 2.606140e-02 1 1  ON 22
 eO_3                 3.412199e-01 1 1  ON 23
 eO_4                 5.667643e-01 1 1  ON 24
 eO_5                 5.258199e-01 1 1  ON 25
 eO_6                 2.817595e-01 1 1  ON 26
 eO_7                -6.457467e-02 1 1  ON 27
 eO_8                -3.271731e-01 1 1  ON 28
 eO_9                -2.227813e-01 1 1  ON 29
eH1_0                -2.871189e-01 1 1  ON 30
eH1_1                -1.871245e-01 1 1  ON 31
eH1_2                -1.410331e-01 1 1  ON 32
eH1_3                -8.593793e-02 1 1  ON 33
eH1_4                -3.557917e-02 1 1  ON 34
eH1_5                 4.169818e-03 1 1  ON 35
eH1_6                 7.342570e-02 1 1  ON 36
eH1_7                 1.571289e-01 1 1  ON 37
eH1_8                 2.272967e-01 1 1  ON 38
eH1_9                 2.089915e-01 1 1  ON 39
eH2_0                -2.847001e-01 1 1  ON 40
eH2_1                -1.855372e-01 1 1  ON 41
eH2_2                -1.392126e-01 1 1  ON 42
eH2_3                -8.407999e-02 1 1  ON 43
eH2_4                -3.375118e-02 1 1  ON 44
eH2_5                 5.076672e-03 1 1  ON 45
eH2_6                 7.408932e-02 1 1  ON 46
eH2_7                 1.558410e-01 1 1  ON 47
eH2_8                 2.245400e-01 1 1  ON 48
eH2_9                 2.357053e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9339
    reference variance = 0.211635
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4474e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344782140031
                                         uncertainty =       0.005937066298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344782140031
                                         uncertainty =       0.005937066298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415173744
  error estimate for blocks of size 2^( 2) =       0.000427555311
  error estimate for blocks of size 2^( 3) =       0.000440316009
  error estimate for blocks of size 2^( 4) =       0.000452533777
  error estimate for blocks of size 2^( 5) =       0.000462570911
  error estimate for blocks of size 2^( 6) =       0.000469273891
  error estimate for blocks of size 2^( 7) =       0.000473785408

      target function =                  N/A
              le_mean =     -16.906313388996
             les_mean =     286.168170709348
             stat err =       0.000464540997
             autocorr =       1.251953893986
              std dev =       0.587144338969
             le_variance =       0.344738474784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631338900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313388996       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313362420       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313360210       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313359032       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313362702       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313348559       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313349640       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313349159       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.456525e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313388996       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313382292       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313381701       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313381393       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313382349       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313378792       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313379055       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313378921       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.888158e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313388996       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313387316       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906313387166       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906313387088       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906313387329       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906313386439       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906313386504       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906313386470       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.735763e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6054e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.939283e-01 1 1  ON 0
 uu_1                 1.269375e-01 1 1  ON 1
 uu_2                 2.515582e-02 1 1  ON 2
 uu_3                -3.777195e-02 1 1  ON 3
 uu_4                -8.379125e-02 1 1  ON 4
 uu_5                -1.193794e-01 1 1  ON 5
 uu_6                -1.479375e-01 1 1  ON 6
 uu_7                -1.626842e-01 1 1  ON 7
 uu_8                -1.557692e-01 1 1  ON 8
 uu_9                -1.293269e-01 1 1  ON 9
 ud_0                 4.510884e-01 1 1  ON 10
 ud_1                 1.872619e-01 1 1  ON 11
 ud_2                 7.095327e-02 1 1  ON 12
 ud_3                 1.809902e-03 1 1  ON 13
 ud_4                -5.686955e-02 1 1  ON 14
 ud_5                -1.003277e-01 1 1  ON 15
 ud_6                -1.293804e-01 1 1  ON 16
 ud_7                -1.470043e-01 1 1  ON 17
 ud_8                -1.497777e-01 1 1  ON 18
 ud_9                -1.419274e-01 1 1  ON 19
 eO_0                -7.028464e-01 1 1  ON 20
 eO_1                -3.866254e-01 1 1  ON 21
 eO_2                 2.606052e-02 1 1  ON 22
 eO_3                 3.412205e-01 1 1  ON 23
 eO_4                 5.667659e-01 1 1  ON 24
 eO_5                 5.258198e-01 1 1  ON 25
 eO_6                 2.817603e-01 1 1  ON 26
 eO_7                -6.457434e-02 1 1  ON 27
 eO_8                -3.271741e-01 1 1  ON 28
 eO_9                -2.227825e-01 1 1  ON 29
eH1_0                -2.871195e-01 1 1  ON 30
eH1_1                -1.871256e-01 1 1  ON 31
eH1_2                -1.410326e-01 1 1  ON 32
eH1_3                -8.593759e-02 1 1  ON 33
eH1_4                -3.557844e-02 1 1  ON 34
eH1_5                 4.170308e-03 1 1  ON 35
eH1_6                 7.342466e-02 1 1  ON 36
eH1_7                 1.571288e-01 1 1  ON 37
eH1_8                 2.272967e-01 1 1  ON 38
eH1_9                 2.089920e-01 1 1  ON 39
eH2_0                -2.847004e-01 1 1  ON 40
eH2_1                -1.855387e-01 1 1  ON 41
eH2_2                -1.392132e-01 1 1  ON 42
eH2_3                -8.408117e-02 1 1  ON 43
eH2_4                -3.375081e-02 1 1  ON 44
eH2_5                 5.077822e-03 1 1  ON 45
eH2_6                 7.408910e-02 1 1  ON 46
eH2_7                 1.558418e-01 1 1  ON 47
eH2_8                 2.245405e-01 1 1  ON 48
eH2_9                 2.357056e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9142
    reference variance = 0.200414
====================================================
  Execution time = 2.2136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3235e-01
  Total weights = 2.0000e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108759923
                                         uncertainty =       0.002893867779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108759923
                                         uncertainty =       0.002893867779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407648211
  error estimate for blocks of size 2^( 2) =       0.000420212172
  error estimate for blocks of size 2^( 3) =       0.000433409965
  error estimate for blocks of size 2^( 4) =       0.000445579550
  error estimate for blocks of size 2^( 5) =       0.000456127222
  error estimate for blocks of size 2^( 6) =       0.000465220377
  error estimate for blocks of size 2^( 7) =       0.000470320323

      target function =                  N/A
              le_mean =     -16.905942874196
             les_mean =     286.143258427645
             stat err =       0.000459311868
             autocorr =       1.269533754738
              std dev =       0.576501628995
             le_variance =       0.332354128234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332100348911
                                         uncertainty =       0.002893794125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332100348911
                                         uncertainty =       0.002893794125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407643054
  error estimate for blocks of size 2^( 2) =       0.000420207316
  error estimate for blocks of size 2^( 3) =       0.000433405356
  error estimate for blocks of size 2^( 4) =       0.000445575189
  error estimate for blocks of size 2^( 5) =       0.000456122858
  error estimate for blocks of size 2^( 6) =       0.000465216174
  error estimate for blocks of size 2^( 7) =       0.000470316061

      target function =                  N/A
              le_mean =     -16.905942892978
             les_mean =     286.143250653161
             stat err =       0.000459307571
             autocorr =       1.269542121465
              std dev =       0.576494335350
             le_variance =       0.332345718691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332104493764
                                         uncertainty =       0.002893830491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332104493764
                                         uncertainty =       0.002893830491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407645595
  error estimate for blocks of size 2^( 2) =       0.000420209709
  error estimate for blocks of size 2^( 3) =       0.000433407627
  error estimate for blocks of size 2^( 4) =       0.000445577339
  error estimate for blocks of size 2^( 5) =       0.000456125008
  error estimate for blocks of size 2^( 6) =       0.000465218245
  error estimate for blocks of size 2^( 7) =       0.000470318160

      target function =                  N/A
              le_mean =     -16.905942883672
             les_mean =     286.143254482625
             stat err =       0.000459309688
             autocorr =       1.269537997189
              std dev =       0.576497929590
             le_variance =       0.332349862822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108224680
                                         uncertainty =       0.002893863103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108224680
                                         uncertainty =       0.002893863103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407647883
  error estimate for blocks of size 2^( 2) =       0.000420211863
  error estimate for blocks of size 2^( 3) =       0.000433409671
  error estimate for blocks of size 2^( 4) =       0.000445579273
  error estimate for blocks of size 2^( 5) =       0.000456126944
  error estimate for blocks of size 2^( 6) =       0.000465220110
  error estimate for blocks of size 2^( 7) =       0.000470320051

      target function =                  N/A
              le_mean =     -16.905942875377
             les_mean =     286.143257932429
             stat err =       0.000459311595
             autocorr =       1.269534286931
              std dev =       0.576501164860
             le_variance =       0.332353593085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905942874196        initial
     2.3283e+01     2.3283e+02             7.4565e-06       -16.905942892978  <--
     9.3132e+01     9.3132e+02             1.8882e-06       -16.905942883672
     3.7253e+02     3.7253e+03             4.7358e-07       -16.905942875377

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 3.1727e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.939298e-01 1 1  ON 0
 uu_1                 1.269353e-01 1 1  ON 1
 uu_2                 2.515336e-02 1 1  ON 2
 uu_3                -3.777193e-02 1 1  ON 3
 uu_4                -8.379577e-02 1 1  ON 4
 uu_5                -1.193793e-01 1 1  ON 5
 uu_6                -1.479327e-01 1 1  ON 6
 uu_7                -1.626840e-01 1 1  ON 7
 uu_8                -1.557676e-01 1 1  ON 8
 uu_9                -1.293274e-01 1 1  ON 9
 ud_0                 4.510849e-01 1 1  ON 10
 ud_1                 1.872647e-01 1 1  ON 11
 ud_2                 7.095884e-02 1 1  ON 12
 ud_3                 1.811111e-03 1 1  ON 13
 ud_4                -5.687006e-02 1 1  ON 14
 ud_5                -1.003261e-01 1 1  ON 15
 ud_6                -1.293818e-01 1 1  ON 16
 ud_7                -1.470038e-01 1 1  ON 17
 ud_8                -1.497784e-01 1 1  ON 18
 ud_9                -1.419287e-01 1 1  ON 19
 eO_0                -7.028459e-01 1 1  ON 20
 eO_1                -3.866260e-01 1 1  ON 21
 eO_2                 2.605793e-02 1 1  ON 22
 eO_3                 3.412224e-01 1 1  ON 23
 eO_4                 5.667709e-01 1 1  ON 24
 eO_5                 5.258194e-01 1 1  ON 25
 eO_6                 2.817630e-01 1 1  ON 26
 eO_7                -6.457336e-02 1 1  ON 27
 eO_8                -3.271769e-01 1 1  ON 28
 eO_9                -2.227860e-01 1 1  ON 29
eH1_0                -2.871215e-01 1 1  ON 30
eH1_1                -1.871288e-01 1 1  ON 31
eH1_2                -1.410312e-01 1 1  ON 32
eH1_3                -8.593658e-02 1 1  ON 33
eH1_4                -3.557626e-02 1 1  ON 34
eH1_5                 4.171769e-03 1 1  ON 35
eH1_6                 7.342154e-02 1 1  ON 36
eH1_7                 1.571285e-01 1 1  ON 37
eH1_8                 2.272965e-01 1 1  ON 38
eH1_9                 2.089938e-01 1 1  ON 39
eH2_0                -2.847011e-01 1 1  ON 40
eH2_1                -1.855430e-01 1 1  ON 41
eH2_2                -1.392149e-01 1 1  ON 42
eH2_3                -8.408467e-02 1 1  ON 43
eH2_4                -3.374969e-02 1 1  ON 44
eH2_5                 5.081263e-03 1 1  ON 45
eH2_6                 7.408846e-02 1 1  ON 46
eH2_7                 1.558442e-01 1 1  ON 47
eH2_8                 2.245418e-01 1 1  ON 48
eH2_9                 2.357067e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7787e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.867
    reference variance = 0.281783
====================================================
  Execution time = 2.0478e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334534060255
                                         uncertainty =       0.003467682337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334534060255
                                         uncertainty =       0.003467682337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409054014
  error estimate for blocks of size 2^( 2) =       0.000421767646
  error estimate for blocks of size 2^( 3) =       0.000434662662
  error estimate for blocks of size 2^( 4) =       0.000446858627
  error estimate for blocks of size 2^( 5) =       0.000458278311
  error estimate for blocks of size 2^( 6) =       0.000464951969
  error estimate for blocks of size 2^( 7) =       0.000471022872

      target function =                  N/A
              le_mean =     -16.906067287859
             les_mean =     286.149761346372
             stat err =       0.000460277945
             autocorr =       1.266132083945
              std dev =       0.578489733787
             le_variance =       0.334650372097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606728786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067287859       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067295871       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067257098       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067271196       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067229844       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067237576       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067278527       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.351143e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067287859       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067289944       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067279631       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067282564       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067272075       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067273664       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067283898       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 5.939753e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906067287859       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906067288385       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906067285766       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906067286457       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906067283825       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906067284198       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906067286754       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.488903e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.437953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6045e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.939270e-01 1 1  ON 0
 uu_1                 1.269363e-01 1 1  ON 1
 uu_2                 2.515145e-02 1 1  ON 2
 uu_3                -3.776943e-02 1 1  ON 3
 uu_4                -8.379723e-02 1 1  ON 4
 uu_5                -1.193775e-01 1 1  ON 5
 uu_6                -1.479301e-01 1 1  ON 6
 uu_7                -1.626875e-01 1 1  ON 7
 uu_8                -1.557660e-01 1 1  ON 8
 uu_9                -1.293265e-01 1 1  ON 9
 ud_0                 4.510874e-01 1 1  ON 10
 ud_1                 1.872682e-01 1 1  ON 11
 ud_2                 7.095622e-02 1 1  ON 12
 ud_3                 1.812887e-03 1 1  ON 13
 ud_4                -5.687255e-02 1 1  ON 14
 ud_5                -1.003242e-01 1 1  ON 15
 ud_6                -1.293847e-01 1 1  ON 16
 ud_7                -1.470076e-01 1 1  ON 17
 ud_8                -1.497744e-01 1 1  ON 18
 ud_9                -1.419282e-01 1 1  ON 19
 eO_0                -7.028505e-01 1 1  ON 20
 eO_1                -3.866211e-01 1 1  ON 21
 eO_2                 2.605846e-02 1 1  ON 22
 eO_3                 3.412275e-01 1 1  ON 23
 eO_4                 5.667725e-01 1 1  ON 24
 eO_5                 5.258203e-01 1 1  ON 25
 eO_6                 2.817622e-01 1 1  ON 26
 eO_7                -6.457451e-02 1 1  ON 27
 eO_8                -3.271783e-01 1 1  ON 28
 eO_9                -2.227898e-01 1 1  ON 29
eH1_0                -2.871237e-01 1 1  ON 30
eH1_1                -1.871309e-01 1 1  ON 31
eH1_2                -1.410329e-01 1 1  ON 32
eH1_3                -8.593715e-02 1 1  ON 33
eH1_4                -3.557564e-02 1 1  ON 34
eH1_5                 4.169172e-03 1 1  ON 35
eH1_6                 7.342415e-02 1 1  ON 36
eH1_7                 1.571302e-01 1 1  ON 37
eH1_8                 2.272969e-01 1 1  ON 38
eH1_9                 2.089965e-01 1 1  ON 39
eH2_0                -2.847070e-01 1 1  ON 40
eH2_1                -1.855444e-01 1 1  ON 41
eH2_2                -1.392164e-01 1 1  ON 42
eH2_3                -8.408414e-02 1 1  ON 43
eH2_4                -3.375255e-02 1 1  ON 44
eH2_5                 5.084001e-03 1 1  ON 45
eH2_6                 7.408904e-02 1 1  ON 46
eH2_7                 1.558456e-01 1 1  ON 47
eH2_8                 2.245414e-01 1 1  ON 48
eH2_9                 2.357100e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9532
    reference variance = 0.376511
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3471e-01
  Total weights = 2.0000e+06
  Execution time = 1.8975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334775369947
                                         uncertainty =       0.003356077293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334775369947
                                         uncertainty =       0.003356077293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409090196
  error estimate for blocks of size 2^( 2) =       0.000422033250
  error estimate for blocks of size 2^( 3) =       0.000435259656
  error estimate for blocks of size 2^( 4) =       0.000446842227
  error estimate for blocks of size 2^( 5) =       0.000458195971
  error estimate for blocks of size 2^( 6) =       0.000466453769
  error estimate for blocks of size 2^( 7) =       0.000472404209

      target function =                  N/A
              le_mean =     -16.906104262977
             les_mean =     286.151070760600
             stat err =       0.000460974044
             autocorr =       1.269740001196
              std dev =       0.578540903751
             le_variance =       0.334709577313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334786370113
                                         uncertainty =       0.003356140653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334786370113
                                         uncertainty =       0.003356140653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409096928
  error estimate for blocks of size 2^( 2) =       0.000422039650
  error estimate for blocks of size 2^( 3) =       0.000435265642
  error estimate for blocks of size 2^( 4) =       0.000446847940
  error estimate for blocks of size 2^( 5) =       0.000458201013
  error estimate for blocks of size 2^( 6) =       0.000466458884
  error estimate for blocks of size 2^( 7) =       0.000472409591

      target function =                  N/A
              le_mean =     -16.906104261762
             les_mean =     286.151081734713
             stat err =       0.000460979357
             autocorr =       1.269727482869
              std dev =       0.578550423489
             le_variance =       0.334720592520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334781126008
                                         uncertainty =       0.003356110990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334781126008
                                         uncertainty =       0.003356110990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409093719
  error estimate for blocks of size 2^( 2) =       0.000422036595
  error estimate for blocks of size 2^( 3) =       0.000435262781
  error estimate for blocks of size 2^( 4) =       0.000446845212
  error estimate for blocks of size 2^( 5) =       0.000458198607
  error estimate for blocks of size 2^( 6) =       0.000466456444
  error estimate for blocks of size 2^( 7) =       0.000472407027

      target function =                  N/A
              le_mean =     -16.906104264684
             les_mean =     286.151076582437
             stat err =       0.000460976823
             autocorr =       1.269733440162
              std dev =       0.578545885319
             le_variance =       0.334715341419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334776097730
                                         uncertainty =       0.003356081576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334776097730
                                         uncertainty =       0.003356081576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409090642
  error estimate for blocks of size 2^( 2) =       0.000422033672
  error estimate for blocks of size 2^( 3) =       0.000435260051
  error estimate for blocks of size 2^( 4) =       0.000446842605
  error estimate for blocks of size 2^( 5) =       0.000458196305
  error estimate for blocks of size 2^( 6) =       0.000466454107
  error estimate for blocks of size 2^( 7) =       0.000472404566

      target function =                  N/A
              le_mean =     -16.906104263222
             les_mean =     286.151071497697
             stat err =       0.000460974395
             autocorr =       1.269739170951
              std dev =       0.578541533617
             le_variance =       0.334710306120


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906104262977        initial
     5.8208e+00     5.8208e+01             2.3511e-05       -16.906104261762
     2.3283e+01     2.3283e+02             5.9398e-06       -16.906104264684  <--
     9.3132e+01     9.3132e+02             1.4889e-06       -16.906104263222

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 3.0038e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.939270e-01 1 1  ON 0
 uu_1                 1.269363e-01 1 1  ON 1
 uu_2                 2.515145e-02 1 1  ON 2
 uu_3                -3.776943e-02 1 1  ON 3
 uu_4                -8.379723e-02 1 1  ON 4
 uu_5                -1.193775e-01 1 1  ON 5
 uu_6                -1.479301e-01 1 1  ON 6
 uu_7                -1.626875e-01 1 1  ON 7
 uu_8                -1.557660e-01 1 1  ON 8
 uu_9                -1.293265e-01 1 1  ON 9
 ud_0                 4.510874e-01 1 1  ON 10
 ud_1                 1.872682e-01 1 1  ON 11
 ud_2                 7.095622e-02 1 1  ON 12
 ud_3                 1.812887e-03 1 1  ON 13
 ud_4                -5.687255e-02 1 1  ON 14
 ud_5                -1.003242e-01 1 1  ON 15
 ud_6                -1.293847e-01 1 1  ON 16
 ud_7                -1.470076e-01 1 1  ON 17
 ud_8                -1.497744e-01 1 1  ON 18
 ud_9                -1.419282e-01 1 1  ON 19
 eO_0                -7.028505e-01 1 1  ON 20
 eO_1                -3.866211e-01 1 1  ON 21
 eO_2                 2.605846e-02 1 1  ON 22
 eO_3                 3.412275e-01 1 1  ON 23
 eO_4                 5.667725e-01 1 1  ON 24
 eO_5                 5.258203e-01 1 1  ON 25
 eO_6                 2.817622e-01 1 1  ON 26
 eO_7                -6.457451e-02 1 1  ON 27
 eO_8                -3.271783e-01 1 1  ON 28
 eO_9                -2.227898e-01 1 1  ON 29
eH1_0                -2.871237e-01 1 1  ON 30
eH1_1                -1.871309e-01 1 1  ON 31
eH1_2                -1.410329e-01 1 1  ON 32
eH1_3                -8.593715e-02 1 1  ON 33
eH1_4                -3.557564e-02 1 1  ON 34
eH1_5                 4.169172e-03 1 1  ON 35
eH1_6                 7.342415e-02 1 1  ON 36
eH1_7                 1.571302e-01 1 1  ON 37
eH1_8                 2.272969e-01 1 1  ON 38
eH1_9                 2.089965e-01 1 1  ON 39
eH2_0                -2.847070e-01 1 1  ON 40
eH2_1                -1.855444e-01 1 1  ON 41
eH2_2                -1.392164e-01 1 1  ON 42
eH2_3                -8.408414e-02 1 1  ON 43
eH2_4                -3.375255e-02 1 1  ON 44
eH2_5                 5.084001e-03 1 1  ON 45
eH2_6                 7.408904e-02 1 1  ON 46
eH2_7                 1.558456e-01 1 1  ON 47
eH2_8                 2.245414e-01 1 1  ON 48
eH2_9                 2.357100e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9588
    reference variance = 0.306069
====================================================
  Execution time = 2.0329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356150258737
                                         uncertainty =       0.018442119084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356150258737
                                         uncertainty =       0.018442119084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421981131
  error estimate for blocks of size 2^( 2) =       0.000434221167
  error estimate for blocks of size 2^( 3) =       0.000447282107
  error estimate for blocks of size 2^( 4) =       0.000459348136
  error estimate for blocks of size 2^( 5) =       0.000470577872
  error estimate for blocks of size 2^( 6) =       0.000479376959
  error estimate for blocks of size 2^( 7) =       0.000481856145

      target function =                  N/A
              le_mean =     -16.906114663612
             les_mean =     286.172848991462
             stat err =       0.000472789778
             autocorr =       1.255307409638
              std dev =       0.596771438939
             le_variance =       0.356136150333


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611466361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114663612       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114712087       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114686492       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114716104       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114673610       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114696415       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114698019       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.500032e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114663612       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114675973       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114669088       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114676402       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114665353       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114670767       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114671468       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 6.349774e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114663612       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114666718       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114664964       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114666787       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114663996       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114665328       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114665522       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.593901e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5931e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.939267e-01 1 1  ON 0
 uu_1                 1.269362e-01 1 1  ON 1
 uu_2                 2.515277e-02 1 1  ON 2
 uu_3                -3.777027e-02 1 1  ON 3
 uu_4                -8.379759e-02 1 1  ON 4
 uu_5                -1.193752e-01 1 1  ON 5
 uu_6                -1.479326e-01 1 1  ON 6
 uu_7                -1.626920e-01 1 1  ON 7
 uu_8                -1.557654e-01 1 1  ON 8
 uu_9                -1.293261e-01 1 1  ON 9
 ud_0                 4.510860e-01 1 1  ON 10
 ud_1                 1.872682e-01 1 1  ON 11
 ud_2                 7.096000e-02 1 1  ON 12
 ud_3                 1.813312e-03 1 1  ON 13
 ud_4                -5.687253e-02 1 1  ON 14
 ud_5                -1.003223e-01 1 1  ON 15
 ud_6                -1.293863e-01 1 1  ON 16
 ud_7                -1.470106e-01 1 1  ON 17
 ud_8                -1.497733e-01 1 1  ON 18
 ud_9                -1.419263e-01 1 1  ON 19
 eO_0                -7.028501e-01 1 1  ON 20
 eO_1                -3.866225e-01 1 1  ON 21
 eO_2                 2.605976e-02 1 1  ON 22
 eO_3                 3.412302e-01 1 1  ON 23
 eO_4                 5.667762e-01 1 1  ON 24
 eO_5                 5.258231e-01 1 1  ON 25
 eO_6                 2.817619e-01 1 1  ON 26
 eO_7                -6.457647e-02 1 1  ON 27
 eO_8                -3.271812e-01 1 1  ON 28
 eO_9                -2.227931e-01 1 1  ON 29
eH1_0                -2.871238e-01 1 1  ON 30
eH1_1                -1.871329e-01 1 1  ON 31
eH1_2                -1.410306e-01 1 1  ON 32
eH1_3                -8.594295e-02 1 1  ON 33
eH1_4                -3.557145e-02 1 1  ON 34
eH1_5                 4.168751e-03 1 1  ON 35
eH1_6                 7.342103e-02 1 1  ON 36
eH1_7                 1.571311e-01 1 1  ON 37
eH1_8                 2.272973e-01 1 1  ON 38
eH1_9                 2.089982e-01 1 1  ON 39
eH2_0                -2.847103e-01 1 1  ON 40
eH2_1                -1.855468e-01 1 1  ON 41
eH2_2                -1.392194e-01 1 1  ON 42
eH2_3                -8.408164e-02 1 1  ON 43
eH2_4                -3.375890e-02 1 1  ON 44
eH2_5                 5.083090e-03 1 1  ON 45
eH2_6                 7.409099e-02 1 1  ON 46
eH2_7                 1.558474e-01 1 1  ON 47
eH2_8                 2.245440e-01 1 1  ON 48
eH2_9                 2.357139e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9594
    reference variance = 0.183009
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4540e-01
  Total weights = 2.0000e+06
  Execution time = 1.8911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345419621581
                                         uncertainty =       0.009009708325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345419621581
                                         uncertainty =       0.009009708325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415577036
  error estimate for blocks of size 2^( 2) =       0.000428151921
  error estimate for blocks of size 2^( 3) =       0.000440408121
  error estimate for blocks of size 2^( 4) =       0.000452767755
  error estimate for blocks of size 2^( 5) =       0.000463393204
  error estimate for blocks of size 2^( 6) =       0.000470866352
  error estimate for blocks of size 2^( 7) =       0.000475510680

      target function =                  N/A
              le_mean =     -16.905607909560
             les_mean =     286.144987165025
             stat err =       0.000465634498
             autocorr =       1.255414713037
              std dev =       0.587714680731
             le_variance =       0.345408545947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345405351556
                                         uncertainty =       0.009010727672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345405351556
                                         uncertainty =       0.009010727672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415568452
  error estimate for blocks of size 2^( 2) =       0.000428144008
  error estimate for blocks of size 2^( 3) =       0.000440400756
  error estimate for blocks of size 2^( 4) =       0.000452760512
  error estimate for blocks of size 2^( 5) =       0.000463385837
  error estimate for blocks of size 2^( 6) =       0.000470858721
  error estimate for blocks of size 2^( 7) =       0.000475503505

      target function =                  N/A
              le_mean =     -16.905607963565
             les_mean =     286.144974721388
             stat err =       0.000465627144
             autocorr =       1.255426923966
              std dev =       0.587702540703
             le_variance =       0.345394276348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345412127977
                                         uncertainty =       0.009010233335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345412127977
                                         uncertainty =       0.009010233335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415572528
  error estimate for blocks of size 2^( 2) =       0.000428147765
  error estimate for blocks of size 2^( 3) =       0.000440404254
  error estimate for blocks of size 2^( 4) =       0.000452763956
  error estimate for blocks of size 2^( 5) =       0.000463389344
  error estimate for blocks of size 2^( 6) =       0.000470862361
  error estimate for blocks of size 2^( 7) =       0.000475506934

      target function =                  N/A
              le_mean =     -16.905607938115
             les_mean =     286.144980637236
             stat err =       0.000465630649
             autocorr =       1.255421194147
              std dev =       0.587708305767
             le_variance =       0.345401052667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345418672502
                                         uncertainty =       0.009009774446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345418672502
                                         uncertainty =       0.009009774446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415576465
  error estimate for blocks of size 2^( 2) =       0.000428151395
  error estimate for blocks of size 2^( 3) =       0.000440407631
  error estimate for blocks of size 2^( 4) =       0.000452767274
  error estimate for blocks of size 2^( 5) =       0.000463392715
  error estimate for blocks of size 2^( 6) =       0.000470865847
  error estimate for blocks of size 2^( 7) =       0.000475510206

      target function =                  N/A
              le_mean =     -16.905607913129
             les_mean =     286.144986336664
             stat err =       0.000465634010
             autocorr =       1.255415535844
              std dev =       0.587713873337
             le_variance =       0.345407596913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905607909560        initial
     5.8208e+00     5.8208e+01             2.5000e-05       -16.905607963565  <--
     2.3283e+01     2.3283e+02             6.3498e-06       -16.905607938115
     9.3132e+01     9.3132e+02             1.5939e-06       -16.905607913129

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.9558e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.939258e-01 1 1  ON 0
 uu_1                 1.269362e-01 1 1  ON 1
 uu_2                 2.515630e-02 1 1  ON 2
 uu_3                -3.777251e-02 1 1  ON 3
 uu_4                -8.379864e-02 1 1  ON 4
 uu_5                -1.193687e-01 1 1  ON 5
 uu_6                -1.479399e-01 1 1  ON 6
 uu_7                -1.627052e-01 1 1  ON 7
 uu_8                -1.557639e-01 1 1  ON 8
 uu_9                -1.293249e-01 1 1  ON 9
 ud_0                 4.510817e-01 1 1  ON 10
 ud_1                 1.872685e-01 1 1  ON 11
 ud_2                 7.097062e-02 1 1  ON 12
 ud_3                 1.814862e-03 1 1  ON 13
 ud_4                -5.687251e-02 1 1  ON 14
 ud_5                -1.003169e-01 1 1  ON 15
 ud_6                -1.293910e-01 1 1  ON 16
 ud_7                -1.470195e-01 1 1  ON 17
 ud_8                -1.497704e-01 1 1  ON 18
 ud_9                -1.419206e-01 1 1  ON 19
 eO_0                -7.028490e-01 1 1  ON 20
 eO_1                -3.866263e-01 1 1  ON 21
 eO_2                 2.606376e-02 1 1  ON 22
 eO_3                 3.412381e-01 1 1  ON 23
 eO_4                 5.667872e-01 1 1  ON 24
 eO_5                 5.258312e-01 1 1  ON 25
 eO_6                 2.817611e-01 1 1  ON 26
 eO_7                -6.458230e-02 1 1  ON 27
 eO_8                -3.271899e-01 1 1  ON 28
 eO_9                -2.228030e-01 1 1  ON 29
eH1_0                -2.871241e-01 1 1  ON 30
eH1_1                -1.871387e-01 1 1  ON 31
eH1_2                -1.410243e-01 1 1  ON 32
eH1_3                -8.595957e-02 1 1  ON 33
eH1_4                -3.555929e-02 1 1  ON 34
eH1_5                 4.167630e-03 1 1  ON 35
eH1_6                 7.341178e-02 1 1  ON 36
eH1_7                 1.571336e-01 1 1  ON 37
eH1_8                 2.272984e-01 1 1  ON 38
eH1_9                 2.090033e-01 1 1  ON 39
eH2_0                -2.847202e-01 1 1  ON 40
eH2_1                -1.855536e-01 1 1  ON 41
eH2_2                -1.392282e-01 1 1  ON 42
eH2_3                -8.407468e-02 1 1  ON 43
eH2_4                -3.377755e-02 1 1  ON 44
eH2_5                 5.080275e-03 1 1  ON 45
eH2_6                 7.409677e-02 1 1  ON 46
eH2_7                 1.558528e-01 1 1  ON 47
eH2_8                 2.245514e-01 1 1  ON 48
eH2_9                 2.357254e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8878
    reference variance = 0.14767
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3794e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338090570234
                                         uncertainty =       0.005018530610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338090570234
                                         uncertainty =       0.005018530610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411059702
  error estimate for blocks of size 2^( 2) =       0.000423378324
  error estimate for blocks of size 2^( 3) =       0.000436186267
  error estimate for blocks of size 2^( 4) =       0.000448282038
  error estimate for blocks of size 2^( 5) =       0.000459346514
  error estimate for blocks of size 2^( 6) =       0.000466726899
  error estimate for blocks of size 2^( 7) =       0.000474526925

      target function =                  N/A
              le_mean =     -16.906061143441
             les_mean =     286.152843373316
             stat err =       0.000462220594
             autocorr =       1.264412490911
              std dev =       0.581326204917
             le_variance =       0.337940156524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606114344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061143441       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061049432       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906060785515       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906060844635       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906060552691       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906060933625       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906060970085       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906060992775       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.165947e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061143441       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061118380       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906061050772       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906061062808       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906060969573       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906061067263       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906061081112       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906061082884       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 3.102980e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906061143441       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906061137070       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906061120085       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906061122896       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906061098021       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906061122376       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906061126272       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906061126348       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.972218e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5981e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.939355e-01 1 1  ON 0
 uu_1                 1.269319e-01 1 1  ON 1
 uu_2                 2.513771e-02 1 1  ON 2
 uu_3                -3.778416e-02 1 1  ON 3
 uu_4                -8.381022e-02 1 1  ON 4
 uu_5                -1.193639e-01 1 1  ON 5
 uu_6                -1.479213e-01 1 1  ON 6
 uu_7                -1.626976e-01 1 1  ON 7
 uu_8                -1.557614e-01 1 1  ON 8
 uu_9                -1.293289e-01 1 1  ON 9
 ud_0                 4.510970e-01 1 1  ON 10
 ud_1                 1.872887e-01 1 1  ON 11
 ud_2                 7.097863e-02 1 1  ON 12
 ud_3                 1.821453e-03 1 1  ON 13
 ud_4                -5.687704e-02 1 1  ON 14
 ud_5                -1.003226e-01 1 1  ON 15
 ud_6                -1.294149e-01 1 1  ON 16
 ud_7                -1.470495e-01 1 1  ON 17
 ud_8                -1.497623e-01 1 1  ON 18
 ud_9                -1.419154e-01 1 1  ON 19
 eO_0                -7.028593e-01 1 1  ON 20
 eO_1                -3.866331e-01 1 1  ON 21
 eO_2                 2.607693e-02 1 1  ON 22
 eO_3                 3.412613e-01 1 1  ON 23
 eO_4                 5.668151e-01 1 1  ON 24
 eO_5                 5.258303e-01 1 1  ON 25
 eO_6                 2.817514e-01 1 1  ON 26
 eO_7                -6.458589e-02 1 1  ON 27
 eO_8                -3.272043e-01 1 1  ON 28
 eO_9                -2.228174e-01 1 1  ON 29
eH1_0                -2.871368e-01 1 1  ON 30
eH1_1                -1.871697e-01 1 1  ON 31
eH1_2                -1.410251e-01 1 1  ON 32
eH1_3                -8.594020e-02 1 1  ON 33
eH1_4                -3.556267e-02 1 1  ON 34
eH1_5                 4.155414e-03 1 1  ON 35
eH1_6                 7.340515e-02 1 1  ON 36
eH1_7                 1.571344e-01 1 1  ON 37
eH1_8                 2.273127e-01 1 1  ON 38
eH1_9                 2.090249e-01 1 1  ON 39
eH2_0                -2.847355e-01 1 1  ON 40
eH2_1                -1.855544e-01 1 1  ON 41
eH2_2                -1.392284e-01 1 1  ON 42
eH2_3                -8.407709e-02 1 1  ON 43
eH2_4                -3.378605e-02 1 1  ON 44
eH2_5                 5.091204e-03 1 1  ON 45
eH2_6                 7.410080e-02 1 1  ON 46
eH2_7                 1.558658e-01 1 1  ON 47
eH2_8                 2.245443e-01 1 1  ON 48
eH2_9                 2.357219e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.0032
    reference variance = 0.496555
====================================================
  Execution time = 2.0291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342317740390
                                         uncertainty =       0.005154955401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342317740390
                                         uncertainty =       0.005154955401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413737678
  error estimate for blocks of size 2^( 2) =       0.000426251699
  error estimate for blocks of size 2^( 3) =       0.000439248445
  error estimate for blocks of size 2^( 4) =       0.000450968847
  error estimate for blocks of size 2^( 5) =       0.000461362987
  error estimate for blocks of size 2^( 6) =       0.000469451641
  error estimate for blocks of size 2^( 7) =       0.000475729268

      target function =                  N/A
              le_mean =     -16.906556662735
             les_mean =     286.174015751902
             stat err =       0.000464378186
             autocorr =       1.259776418436
              std dev =       0.585113435862
             le_variance =       0.342357732826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342359635906
                                         uncertainty =       0.005155400016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342359635906
                                         uncertainty =       0.005155400016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413762997
  error estimate for blocks of size 2^( 2) =       0.000426275751
  error estimate for blocks of size 2^( 3) =       0.000439271497
  error estimate for blocks of size 2^( 4) =       0.000450990105
  error estimate for blocks of size 2^( 5) =       0.000461382879
  error estimate for blocks of size 2^( 6) =       0.000469471993
  error estimate for blocks of size 2^( 7) =       0.000475749140

      target function =                  N/A
              le_mean =     -16.906557256007
             les_mean =     286.174077715406
             stat err =       0.000464398529
             autocorr =       1.259732612769
              std dev =       0.585149242484
             le_variance =       0.342399635979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342339935599
                                         uncertainty =       0.005155176198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342339935599
                                         uncertainty =       0.005155176198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413751093
  error estimate for blocks of size 2^( 2) =       0.000426264405
  error estimate for blocks of size 2^( 3) =       0.000439260601
  error estimate for blocks of size 2^( 4) =       0.000450979949
  error estimate for blocks of size 2^( 5) =       0.000461373330
  error estimate for blocks of size 2^( 6) =       0.000469462346
  error estimate for blocks of size 2^( 7) =       0.000475739652

      target function =                  N/A
              le_mean =     -16.906556993274
             les_mean =     286.174049128891
             stat err =       0.000464388819
             autocorr =       1.259752423637
              std dev =       0.585132406615
             le_variance =       0.342379933271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342320557476
                                         uncertainty =       0.005154982863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342320557476
                                         uncertainty =       0.005154982863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413739381
  error estimate for blocks of size 2^( 2) =       0.000426253310
  error estimate for blocks of size 2^( 3) =       0.000439249985
  error estimate for blocks of size 2^( 4) =       0.000450970248
  error estimate for blocks of size 2^( 5) =       0.000461364290
  error estimate for blocks of size 2^( 6) =       0.000469452994
  error estimate for blocks of size 2^( 7) =       0.000475730577

      target function =                  N/A
              le_mean =     -16.906556704542
             les_mean =     286.174019983316
             stat err =       0.000464379527
             autocorr =       1.259773329807
              std dev =       0.585115843760
             le_variance =       0.342360550619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906556662735        initial
     1.4552e+00     1.4552e+01             1.1659e-04       -16.906557256007  <--
     5.8208e+00     5.8208e+01             3.1030e-05       -16.906556993274
     2.3283e+01     2.3283e+02             7.9722e-06       -16.906556704542

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 2.9860e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.939584e-01 1 1  ON 0
 uu_1                 1.269155e-01 1 1  ON 1
 uu_2                 2.509233e-02 1 1  ON 2
 uu_3                -3.782047e-02 1 1  ON 3
 uu_4                -8.383992e-02 1 1  ON 4
 uu_5                -1.193522e-01 1 1  ON 5
 uu_6                -1.478674e-01 1 1  ON 6
 uu_7                -1.626738e-01 1 1  ON 7
 uu_8                -1.557540e-01 1 1  ON 8
 uu_9                -1.293405e-01 1 1  ON 9
 ud_0                 4.511444e-01 1 1  ON 10
 ud_1                 1.873420e-01 1 1  ON 11
 ud_2                 7.100453e-02 1 1  ON 12
 ud_3                 1.838019e-03 1 1  ON 13
 ud_4                -5.688783e-02 1 1  ON 14
 ud_5                -1.003411e-01 1 1  ON 15
 ud_6                -1.294813e-01 1 1  ON 16
 ud_7                -1.471361e-01 1 1  ON 17
 ud_8                -1.497406e-01 1 1  ON 18
 ud_9                -1.419003e-01 1 1  ON 19
 eO_0                -7.028898e-01 1 1  ON 20
 eO_1                -3.866498e-01 1 1  ON 21
 eO_2                 2.611191e-02 1 1  ON 22
 eO_3                 3.413294e-01 1 1  ON 23
 eO_4                 5.668959e-01 1 1  ON 24
 eO_5                 5.258281e-01 1 1  ON 25
 eO_6                 2.817233e-01 1 1  ON 26
 eO_7                -6.459660e-02 1 1  ON 27
 eO_8                -3.272460e-01 1 1  ON 28
 eO_9                -2.228591e-01 1 1  ON 29
eH1_0                -2.871761e-01 1 1  ON 30
eH1_1                -1.872508e-01 1 1  ON 31
eH1_2                -1.410282e-01 1 1  ON 32
eH1_3                -8.589124e-02 1 1  ON 33
eH1_4                -3.556863e-02 1 1  ON 34
eH1_5                 4.119110e-03 1 1  ON 35
eH1_6                 7.338483e-02 1 1  ON 36
eH1_7                 1.571363e-01 1 1  ON 37
eH1_8                 2.273542e-01 1 1  ON 38
eH1_9                 2.090874e-01 1 1  ON 39
eH2_0                -2.847794e-01 1 1  ON 40
eH2_1                -1.855584e-01 1 1  ON 41
eH2_2                -1.392301e-01 1 1  ON 42
eH2_3                -8.408432e-02 1 1  ON 43
eH2_4                -3.381031e-02 1 1  ON 44
eH2_5                 5.123186e-03 1 1  ON 45
eH2_6                 7.411405e-02 1 1  ON 46
eH2_7                 1.559041e-01 1 1  ON 47
eH2_8                 2.245237e-01 1 1  ON 48
eH2_9                 2.357116e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.121676
====================================================
  Execution time = 2.0902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5633e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356322438057
                                         uncertainty =       0.016031597913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356322438057
                                         uncertainty =       0.016031597913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422096805
  error estimate for blocks of size 2^( 2) =       0.000434472841
  error estimate for blocks of size 2^( 3) =       0.000446895806
  error estimate for blocks of size 2^( 4) =       0.000458496167
  error estimate for blocks of size 2^( 5) =       0.000467616605
  error estimate for blocks of size 2^( 6) =       0.000474141821
  error estimate for blocks of size 2^( 7) =       0.000478912697

      target function =                  N/A
              le_mean =     -16.906504967547
             les_mean =     286.186241465078
             stat err =       0.000469791823
             autocorr =       1.238758867934
              std dev =       0.596935026246
             le_variance =       0.356331425560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650496755e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906504967547       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506379361       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906506394587       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906506118123       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906506225403       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906506196602       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906506949444       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906506820236       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906506667934       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 4.198973e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906504967547       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906505382033       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906505395886       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505290532       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906505247476       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906505257800       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906505462309       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906505460245       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.260392e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906504967547       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906505075890       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906505081200       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505051467       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906505031657       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906505029376       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906505082495       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906505085400       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 3.344842e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.445639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6429e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.939611e-01 1 1  ON 0
 uu_1                 1.269003e-01 1 1  ON 1
 uu_2                 2.508976e-02 1 1  ON 2
 uu_3                -3.775262e-02 1 1  ON 3
 uu_4                -8.382302e-02 1 1  ON 4
 uu_5                -1.194000e-01 1 1  ON 5
 uu_6                -1.478241e-01 1 1  ON 6
 uu_7                -1.626519e-01 1 1  ON 7
 uu_8                -1.557946e-01 1 1  ON 8
 uu_9                -1.293652e-01 1 1  ON 9
 ud_0                 4.512429e-01 1 1  ON 10
 ud_1                 1.873859e-01 1 1  ON 11
 ud_2                 7.102237e-02 1 1  ON 12
 ud_3                 1.870944e-03 1 1  ON 13
 ud_4                -5.686212e-02 1 1  ON 14
 ud_5                -1.003280e-01 1 1  ON 15
 ud_6                -1.294720e-01 1 1  ON 16
 ud_7                -1.471466e-01 1 1  ON 17
 ud_8                -1.498391e-01 1 1  ON 18
 ud_9                -1.419491e-01 1 1  ON 19
 eO_0                -7.028795e-01 1 1  ON 20
 eO_1                -3.865459e-01 1 1  ON 21
 eO_2                 2.612487e-02 1 1  ON 22
 eO_3                 3.414062e-01 1 1  ON 23
 eO_4                 5.668613e-01 1 1  ON 24
 eO_5                 5.258162e-01 1 1  ON 25
 eO_6                 2.817590e-01 1 1  ON 26
 eO_7                -6.460961e-02 1 1  ON 27
 eO_8                -3.273179e-01 1 1  ON 28
 eO_9                -2.229431e-01 1 1  ON 29
eH1_0                -2.871167e-01 1 1  ON 30
eH1_1                -1.872348e-01 1 1  ON 31
eH1_2                -1.410575e-01 1 1  ON 32
eH1_3                -8.593170e-02 1 1  ON 33
eH1_4                -3.555253e-02 1 1  ON 34
eH1_5                 4.063670e-03 1 1  ON 35
eH1_6                 7.337457e-02 1 1  ON 36
eH1_7                 1.571202e-01 1 1  ON 37
eH1_8                 2.273644e-01 1 1  ON 38
eH1_9                 2.091231e-01 1 1  ON 39
eH2_0                -2.849054e-01 1 1  ON 40
eH2_1                -1.855183e-01 1 1  ON 41
eH2_2                -1.391689e-01 1 1  ON 42
eH2_3                -8.405491e-02 1 1  ON 43
eH2_4                -3.380124e-02 1 1  ON 44
eH2_5                 5.133684e-03 1 1  ON 45
eH2_6                 7.409053e-02 1 1  ON 46
eH2_7                 1.558701e-01 1 1  ON 47
eH2_8                 2.245087e-01 1 1  ON 48
eH2_9                 2.357265e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9399
    reference variance = 0.256476
====================================================
  Execution time = 2.0168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4435e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344465924398
                                         uncertainty =       0.005110029010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344465924398
                                         uncertainty =       0.005110029010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414909276
  error estimate for blocks of size 2^( 2) =       0.000427728885
  error estimate for blocks of size 2^( 3) =       0.000441024544
  error estimate for blocks of size 2^( 4) =       0.000452814261
  error estimate for blocks of size 2^( 5) =       0.000463325876
  error estimate for blocks of size 2^( 6) =       0.000470830941
  error estimate for blocks of size 2^( 7) =       0.000475285452

      target function =                  N/A
              le_mean =     -16.907215623746
             les_mean =     286.198239390151
             stat err =       0.000465564132
             autocorr =       1.259078303603
              std dev =       0.586770325139
             le_variance =       0.344299414464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344565507640
                                         uncertainty =       0.005113068369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344565507640
                                         uncertainty =       0.005113068369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414969237
  error estimate for blocks of size 2^( 2) =       0.000427785199
  error estimate for blocks of size 2^( 3) =       0.000441078196
  error estimate for blocks of size 2^( 4) =       0.000452864459
  error estimate for blocks of size 2^( 5) =       0.000463374681
  error estimate for blocks of size 2^( 6) =       0.000470886462
  error estimate for blocks of size 2^( 7) =       0.000475338782

      target function =                  N/A
              le_mean =     -16.907215919428
             les_mean =     286.198348908733
             stat err =       0.000465616096
             autocorr =       1.258995465802
              std dev =       0.586855122482
             le_variance =       0.344398934784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344561961027
                                         uncertainty =       0.005112667179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344561961027
                                         uncertainty =       0.005112667179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414967106
  error estimate for blocks of size 2^( 2) =       0.000427783695
  error estimate for blocks of size 2^( 3) =       0.000441077144
  error estimate for blocks of size 2^( 4) =       0.000452863957
  error estimate for blocks of size 2^( 5) =       0.000463374257
  error estimate for blocks of size 2^( 6) =       0.000470883301
  error estimate for blocks of size 2^( 7) =       0.000475334969

      target function =                  N/A
              le_mean =     -16.907215717668
             les_mean =     286.198338550119
             stat err =       0.000465614121
             autocorr =       1.258997712693
              std dev =       0.586852109618
             le_variance =       0.344395398563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344480554791
                                         uncertainty =       0.005110428330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344480554791
                                         uncertainty =       0.005110428330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414918086
  error estimate for blocks of size 2^( 2) =       0.000427737227
  error estimate for blocks of size 2^( 3) =       0.000441032544
  error estimate for blocks of size 2^( 4) =       0.000452821825
  error estimate for blocks of size 2^( 5) =       0.000463333250
  error estimate for blocks of size 2^( 6) =       0.000470838814
  error estimate for blocks of size 2^( 7) =       0.000475292848

      target function =                  N/A
              le_mean =     -16.907215611632
             les_mean =     286.198253602774
             stat err =       0.000465571684
             autocorr =       1.259065679064
              std dev =       0.586782784960
             le_variance =       0.344314036726


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907215623746        initial
     3.6380e-01     3.6380e+00             4.1990e-04       -16.907215919428  <--
     1.4552e+00     1.4552e+01             1.2604e-04       -16.907215717668
     5.8208e+00     5.8208e+01             3.3448e-05       -16.907215611632

*****************************************************************************
Applying the update for shift_i =   3.6380e-01     and shift_s =   3.6380e+00
*****************************************************************************

  Execution time = 2.9739e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.939727e-01 1 1  ON 0
 uu_1                 1.268714e-01 1 1  ON 1
 uu_2                 2.511361e-02 1 1  ON 2
 uu_3                -3.765314e-02 1 1  ON 3
 uu_4                -8.377567e-02 1 1  ON 4
 uu_5                -1.194542e-01 1 1  ON 5
 uu_6                -1.477551e-01 1 1  ON 6
 uu_7                -1.625913e-01 1 1  ON 7
 uu_8                -1.558903e-01 1 1  ON 8
 uu_9                -1.294336e-01 1 1  ON 9
 ud_0                 4.514442e-01 1 1  ON 10
 ud_1                 1.875180e-01 1 1  ON 11
 ud_2                 7.110476e-02 1 1  ON 12
 ud_3                 1.963062e-03 1 1  ON 13
 ud_4                -5.677585e-02 1 1  ON 14
 ud_5                -1.002695e-01 1 1  ON 15
 ud_6                -1.294631e-01 1 1  ON 16
 ud_7                -1.471627e-01 1 1  ON 17
 ud_8                -1.500961e-01 1 1  ON 18
 ud_9                -1.420891e-01 1 1  ON 19
 eO_0                -7.028053e-01 1 1  ON 20
 eO_1                -3.863429e-01 1 1  ON 21
 eO_2                 2.622157e-02 1 1  ON 22
 eO_3                 3.416126e-01 1 1  ON 23
 eO_4                 5.667955e-01 1 1  ON 24
 eO_5                 5.257711e-01 1 1  ON 25
 eO_6                 2.818478e-01 1 1  ON 26
 eO_7                -6.463996e-02 1 1  ON 27
 eO_8                -3.275256e-01 1 1  ON 28
 eO_9                -2.231919e-01 1 1  ON 29
eH1_0                -2.869674e-01 1 1  ON 30
eH1_1                -1.872401e-01 1 1  ON 31
eH1_2                -1.411186e-01 1 1  ON 32
eH1_3                -8.601401e-02 1 1  ON 33
eH1_4                -3.553048e-02 1 1  ON 34
eH1_5                 3.933155e-03 1 1  ON 35
eH1_6                 7.335098e-02 1 1  ON 36
eH1_7                 1.570701e-01 1 1  ON 37
eH1_8                 2.273965e-01 1 1  ON 38
eH1_9                 2.092299e-01 1 1  ON 39
eH2_0                -2.851993e-01 1 1  ON 40
eH2_1                -1.854240e-01 1 1  ON 41
eH2_2                -1.390374e-01 1 1  ON 42
eH2_3                -8.396609e-02 1 1  ON 43
eH2_4                -3.377951e-02 1 1  ON 44
eH2_5                 5.156767e-03 1 1  ON 45
eH2_6                 7.402433e-02 1 1  ON 46
eH2_7                 1.557694e-01 1 1  ON 47
eH2_8                 2.244667e-01 1 1  ON 48
eH2_9                 2.357714e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6179e+01 secs
  Total Execution time = 2.2529e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
