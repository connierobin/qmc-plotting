Rank =    0  Free Memory = 87003 MB
Rank =    1  Free Memory = 87002 MB
Rank =    2  Free Memory = 87002 MB
Rank =    3  Free Memory = 87001 MB
Rank =    4  Free Memory = 87001 MB
Rank =    5  Free Memory = 87001 MB
Rank =    6  Free Memory = 87001 MB
Rank =    7  Free Memory = 87000 MB
Rank =    8  Free Memory = 87000 MB
Rank =    9  Free Memory = 87000 MB
Rank =   10  Free Memory = 86999 MB
Rank =   11  Free Memory = 86999 MB
Rank =   12  Free Memory = 86999 MB
Rank =   13  Free Memory = 86999 MB
Rank =   14  Free Memory = 86998 MB
Rank =   15  Free Memory = 86986 MB
Rank =   16  Free Memory = 86986 MB
Rank =   17  Free Memory = 86986 MB
Rank =   18  Free Memory = 86986 MB
Rank =   19  Free Memory = 86986 MB
Rank =   20  Free Memory = 86986 MB
Rank =   21  Free Memory = 86986 MB
Rank =   22  Free Memory = 86986 MB
Rank =   23  Free Memory = 86986 MB
Rank =   24  Free Memory = 86986 MB
Rank =   25  Free Memory = 86986 MB
Rank =   26  Free Memory = 86986 MB
Rank =   27  Free Memory = 86986 MB
Rank =   28  Free Memory = 86986 MB
Rank =   29  Free Memory = 86986 MB
Rank =   30  Free Memory = 86986 MB
Rank =   31  Free Memory = 86986 MB
Rank =   32  Free Memory = 71727 MB
Rank =   33  Free Memory = 71727 MB
Rank =   34  Free Memory = 71727 MB
Rank =   35  Free Memory = 71727 MB
Rank =   36  Free Memory = 71727 MB
Rank =   37  Free Memory = 71727 MB
Rank =   38  Free Memory = 71727 MB
Rank =   39  Free Memory = 71727 MB
Rank =   40  Free Memory = 71727 MB
Rank =   41  Free Memory = 71727 MB
Rank =   42  Free Memory = 71727 MB
Rank =   43  Free Memory = 71727 MB
Rank =   44  Free Memory = 71726 MB
Rank =   45  Free Memory = 71726 MB
Rank =   46  Free Memory = 71726 MB
Rank =   47  Free Memory = 71726 MB
Rank =   48  Free Memory = 71726 MB
Rank =   49  Free Memory = 71726 MB
Rank =   50  Free Memory = 71726 MB
Rank =   51  Free Memory = 71726 MB
Rank =   52  Free Memory = 71726 MB
Rank =   53  Free Memory = 71726 MB
Rank =   54  Free Memory = 71726 MB
Rank =   55  Free Memory = 71726 MB
Rank =   56  Free Memory = 71726 MB
Rank =   57  Free Memory = 71726 MB
Rank =   58  Free Memory = 71726 MB
Rank =   59  Free Memory = 71726 MB
Rank =   60  Free Memory = 71726 MB
Rank =   61  Free Memory = 71726 MB
Rank =   62  Free Memory = 71726 MB
Rank =   63  Free Memory = 71726 MB
Rank =   64  Free Memory = 76103 MB
Rank =   65  Free Memory = 76103 MB
Rank =   66  Free Memory = 76103 MB
Rank =   67  Free Memory = 76103 MB
Rank =   68  Free Memory = 76103 MB
Rank =   69  Free Memory = 76103 MB
Rank =   70  Free Memory = 76102 MB
Rank =   71  Free Memory = 76102 MB
Rank =   72  Free Memory = 76102 MB
Rank =   73  Free Memory = 76102 MB
Rank =   74  Free Memory = 76102 MB
Rank =   75  Free Memory = 76102 MB
Rank =   76  Free Memory = 76102 MB
Rank =   77  Free Memory = 76102 MB
Rank =   78  Free Memory = 76102 MB
Rank =   79  Free Memory = 76102 MB
Rank =   80  Free Memory = 76102 MB
Rank =   81  Free Memory = 76102 MB
Rank =   82  Free Memory = 76102 MB
Rank =   83  Free Memory = 76102 MB
Rank =   84  Free Memory = 76102 MB
Rank =   85  Free Memory = 76102 MB
Rank =   86  Free Memory = 76102 MB
Rank =   87  Free Memory = 76102 MB
Rank =   88  Free Memory = 76102 MB
Rank =   89  Free Memory = 76102 MB
Rank =   90  Free Memory = 76102 MB
Rank =   91  Free Memory = 76102 MB
Rank =   92  Free Memory = 76102 MB
Rank =   93  Free Memory = 76102 MB
Rank =   94  Free Memory = 76102 MB
Rank =   95  Free Memory = 76102 MB
Rank =   96  Free Memory = 86875 MB
Rank =   97  Free Memory = 86875 MB
Rank =   98  Free Memory = 86875 MB
Rank =   99  Free Memory = 86875 MB
Rank =  100  Free Memory = 86875 MB
Rank =  101  Free Memory = 86875 MB
Rank =  102  Free Memory = 86875 MB
Rank =  103  Free Memory = 86875 MB
Rank =  104  Free Memory = 86875 MB
Rank =  105  Free Memory = 86875 MB
Rank =  106  Free Memory = 86875 MB
Rank =  107  Free Memory = 86875 MB
Rank =  108  Free Memory = 86875 MB
Rank =  109  Free Memory = 86875 MB
Rank =  110  Free Memory = 86875 MB
Rank =  111  Free Memory = 86875 MB
Rank =  112  Free Memory = 86875 MB
Rank =  113  Free Memory = 86875 MB
Rank =  114  Free Memory = 86875 MB
Rank =  115  Free Memory = 86875 MB
Rank =  116  Free Memory = 86875 MB
Rank =  117  Free Memory = 86875 MB
Rank =  118  Free Memory = 86875 MB
Rank =  119  Free Memory = 86875 MB
Rank =  120  Free Memory = 86875 MB
Rank =  121  Free Memory = 86875 MB
Rank =  122  Free Memory = 86875 MB
Rank =  123  Free Memory = 86875 MB
Rank =  124  Free Memory = 86875 MB
Rank =  125  Free Memory = 86875 MB
Rank =  126  Free Memory = 86875 MB
Rank =  127  Free Memory = 86875 MB
  Input file(s): opt_h2o_1b1_lmtt_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmtt_run001a.xml

  Project = H2O
  date    = 2023-03-01 21:45:59 PST
  host    = n0092.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 23

  Range of prime numbers to use as seeds over processors and threads = 97-883


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1 OFF
     uu_1                 1.395499e-01    1         1 OFF
     uu_2                 4.158458e-02    1         1 OFF
     uu_3                -1.946409e-02    1         1 OFF
     uu_4                -6.333239e-02    1         1 OFF
     uu_5                -9.587524e-02    1         1 OFF
     uu_6                -1.205706e-01    1         1 OFF
     uu_7                -1.310580e-01    1         1 OFF
     uu_8                -1.203232e-01    1         1 OFF
     uu_9                -9.277332e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1 OFF
     ud_1                 1.583401e-01    1         1 OFF
     ud_2                 6.092685e-02    1         1 OFF
     ud_3                 2.699750e-03    1         1 OFF
     ud_4                -5.713986e-02    1         1 OFF
     ud_5                -1.014997e-01    1         1 OFF
     ud_6                -1.286687e-01    1         1 OFF
     ud_7                -1.435029e-01    1         1 OFF
     ud_8                -1.424319e-01    1         1 OFF
     ud_9                -1.344547e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1 OFF
     eO_1                -4.137154e-01    1         1 OFF
     eO_2                -3.185752e-02    1         1 OFF
     eO_3                 2.692030e-01    1         1 OFF
     eO_4                 4.916456e-01    1         1 OFF
     eO_5                 4.596091e-01    1         1 OFF
     eO_6                 2.360353e-01    1         1 OFF
     eO_7                -5.591968e-02    1         1 OFF
     eO_8                -1.959242e-01    1         1 OFF
     eO_9                -5.768884e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1 OFF
     eH1_1                -1.274877e-01    1         1 OFF
     eH1_2                -8.838243e-02    1         1 OFF
     eH1_3                -3.738645e-02    1         1 OFF
     eH1_4                 1.159942e-02    1         1 OFF
     eH1_5                 4.473069e-02    1         1 OFF
     eH1_6                 9.476145e-02    1         1 OFF
     eH1_7                 1.381756e-01    1         1 OFF
     eH1_8                 1.456924e-01    1         1 OFF
     eH1_9                 3.283823e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1 OFF
     eH2_1                -1.265485e-01    1         1 OFF
     eH2_2                -8.741031e-02    1         1 OFF
     eH2_3                -3.640778e-02    1         1 OFF
     eH2_4                 1.289653e-02    1         1 OFF
     eH2_5                 4.794967e-02    1         1 OFF
     eH2_6                 1.006131e-01    1         1 OFF
     eH2_7                 1.496008e-01    1         1 OFF
     eH2_8                 1.537439e-01    1         1 OFF
     eH2_9                 1.292423e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.913765e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9871e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8727
    reference variance = 0.266567
====================================================
  Execution time = 1.5116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9489e-01
  Total weights = 1.950644772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377700941762
                                         uncertainty =       0.004260528001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377700941762
                                         uncertainty =       0.004260528001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434576056
  error estimate for blocks of size 2^( 2) =       0.000448928309
  error estimate for blocks of size 2^( 3) =       0.000463272667
  error estimate for blocks of size 2^( 4) =       0.000476689698
  error estimate for blocks of size 2^( 5) =       0.000488254175
  error estimate for blocks of size 2^( 6) =       0.000494624429
  error estimate for blocks of size 2^( 7) =       0.000499156976

      target function =                  N/A
              le_mean =     -16.893628904972
             les_mean =     285.789592145028
             stat err =       0.000489681320
             autocorr =       1.269683527698
              std dev =       0.614583352267
             le_variance =       0.377712696883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.689362890497e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893628905028       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.898657844524       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.898869039224       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.898869195271       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.898869562202       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.898869398767       residual = 4.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 8.197951e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893628905028       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.895719045191       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.895770778902       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.895770837599       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.895770815091       residual = 2.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 3.137779e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893628905028       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894255028802       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894268014069       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894268245045       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894268238394       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 9.550561e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121598 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7869e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 6.947740e-01                 3 1 ON  0
ci_0002 6.946210e-01                 3 1 ON  1
ci_0003 -4.537382e-02                3 1 ON  2
ci_0004 -4.554418e-02                3 1 ON  3
ci_0005 -4.431773e-02                3 1 ON  4
ci_0006 -4.430977e-02                3 1 ON  5
ci_0007 -3.262800e-02                3 1 ON  6
ci_0008 -3.243284e-02                3 1 ON  7
ci_0009 -2.942277e-02                3 1 ON  8
ci_0010 -2.943105e-02                3 1 ON  9
ci_0011 -2.480614e-02                3 1 ON  10
ci_0012 -2.467347e-02                3 1 ON  11
ci_0013 2.430824e-02                 3 1 ON  12
ci_0014 2.437689e-02                 3 1 ON  13
ci_0015 2.427149e-02                 3 1 ON  14
ci_0016 2.416425e-02                 3 1 ON  15
ci_0017 2.218400e-02                 3 1 ON  16
ci_0018 2.203112e-02                 3 1 ON  17
ci_0019 1.846010e-02                 3 1 ON  18
ci_0020 1.828364e-02                 3 1 ON  19
ci_0021 1.833314e-02                 3 1 ON  20
ci_0022 1.852858e-02                 3 1 ON  21
ci_0023 -1.746916e-02                3 1 ON  22
ci_0024 -1.732086e-02                3 1 ON  23
ci_0025 -1.747776e-02                3 1 ON  24
ci_0026 -1.787141e-02                3 1 ON  25
ci_0027 -1.655523e-02                3 1 ON  26
ci_0028 -1.662134e-02                3 1 ON  27
ci_0029 -1.540936e-02                3 1 ON  28
ci_0030 -1.547446e-02                3 1 ON  29
ci_0031 1.677658e-02                 3 1 ON  30
ci_0032 1.697275e-02                 3 1 ON  31
ci_0033 1.525736e-02                 3 1 ON  32
ci_0034 1.522466e-02                 3 1 ON  33
ci_0035 1.437197e-02                 3 1 ON  34
ci_0036 1.410915e-02                 3 1 ON  35
ci_0037 -1.414583e-02                3 1 ON  36
ci_0038 -1.437954e-02                3 1 ON  37
ci_0039 -1.198407e-02                3 1 ON  38
ci_0040 -1.186390e-02                3 1 ON  39
ci_0041 1.358989e-02                 3 1 ON  40
ci_0042 1.344673e-02                 3 1 ON  41
ci_0043 -1.397442e-02                3 1 ON  42
ci_0044 -1.394594e-02                3 1 ON  43
ci_0045 1.333496e-02                 3 1 ON  44
ci_0046 1.331969e-02                 3 1 ON  45
ci_0047 -1.109757e-02                3 1 ON  46
ci_0048 -1.103208e-02                3 1 ON  47
ci_0049 -1.131900e-02                3 1 ON  48
ci_0050 -1.143610e-02                3 1 ON  49
ci_0051 -1.049523e-02                3 1 ON  50
ci_0052 -1.058770e-02                3 1 ON  51
ci_0053 -1.061855e-02                3 1 ON  52
ci_0054 -1.089979e-02                3 1 ON  53
ci_0055 1.135055e-02                 3 1 ON  54
ci_0056 1.153061e-02                 3 1 ON  55
ci_0057 1.078096e-02                 3 1 ON  56
ci_0058 1.095697e-02                 3 1 ON  57
ci_0059 -1.043747e-02                3 1 ON  58
ci_0060 -1.044308e-02                3 1 ON  59
ci_0061 -1.031912e-02                3 1 ON  60
ci_0062 -1.030876e-02                3 1 ON  61
ci_0063 -1.086837e-02                3 1 ON  62
ci_0064 -1.076981e-02                3 1 ON  63
ci_0065 -1.018487e-02                3 1 ON  64
ci_0066 -1.027961e-02                3 1 ON  65
ci_0067 -9.915260e-03                3 1 ON  66
ci_0068 -9.978383e-03                3 1 ON  67
ci_0069 9.316878e-03                 3 1 ON  68
ci_0070 9.055084e-03                 3 1 ON  69
ci_0071 9.681007e-03                 3 1 ON  70
ci_0072 9.431633e-03                 3 1 ON  71
ci_0073 9.023066e-03                 3 1 ON  72
ci_0074 8.769492e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9885
    reference variance = 0.257236
====================================================
  Execution time = 1.4415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6898e+01
  VMC Evar = 3.8125e-01
  Total weights = 1.9510e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0128075
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403010455861
                                         uncertainty =       0.015702936440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403010455861
                                         uncertainty =       0.015702936440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448835839
  error estimate for blocks of size 2^( 2) =       0.000463439156
  error estimate for blocks of size 2^( 3) =       0.000477419295
  error estimate for blocks of size 2^( 4) =       0.000489766164
  error estimate for blocks of size 2^( 5) =       0.000501470068
  error estimate for blocks of size 2^( 6) =       0.000508163631
  error estimate for blocks of size 2^( 7) =       0.000513214633

      target function =                  N/A
              le_mean =     -16.898666714290
             les_mean =     286.524638771523
             stat err =       0.000503153624
             autocorr =       1.256684199071
              std dev =       0.634749731201
             le_variance =       0.402907221259

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00967671
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366343769879
                                         uncertainty =       0.022269634468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366343769879
                                         uncertainty =       0.022269634468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427927911
  error estimate for blocks of size 2^( 2) =       0.000441562631
  error estimate for blocks of size 2^( 3) =       0.000455164837
  error estimate for blocks of size 2^( 4) =       0.000467499939
  error estimate for blocks of size 2^( 5) =       0.000479295193
  error estimate for blocks of size 2^( 6) =       0.000485947342
  error estimate for blocks of size 2^( 7) =       0.000490837458

      target function =                  N/A
              le_mean =     -16.898955069444
             les_mean =     286.118353379574
             stat err =       0.000480894983
             autocorr =       1.262871798718
              std dev =       0.605181455716
             le_variance =       0.366244594343

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0124655
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359792112913
                                         uncertainty =       0.012437563303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359792112913
                                         uncertainty =       0.012437563303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424081933
  error estimate for blocks of size 2^( 2) =       0.000438221039
  error estimate for blocks of size 2^( 3) =       0.000451961997
  error estimate for blocks of size 2^( 4) =       0.000464293219
  error estimate for blocks of size 2^( 5) =       0.000476286847
  error estimate for blocks of size 2^( 6) =       0.000483186801
  error estimate for blocks of size 2^( 7) =       0.000488286573

      target function =                  N/A
              le_mean =     -16.898720386277
             les_mean =     287.168648159344
             stat err =       0.000478013360
             autocorr =       1.270517138063
              std dev =       0.599742421565
             le_variance =       0.359690972225

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0541666
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376680407827
                                         uncertainty =       0.004790782235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376680407827
                                         uncertainty =       0.004790782235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433939771
  error estimate for blocks of size 2^( 2) =       0.000448685353
  error estimate for blocks of size 2^( 3) =       0.000462821184
  error estimate for blocks of size 2^( 4) =       0.000475434428
  error estimate for blocks of size 2^( 5) =       0.000487290938
  error estimate for blocks of size 2^( 6) =       0.000493962892
  error estimate for blocks of size 2^( 7) =       0.000499070704

      target function =                  N/A
              le_mean =     -16.898432463676
             les_mean =     285.975093065077
             stat err =       0.000488939740
             autocorr =       1.269555714928
              std dev =       0.613683508929
             le_variance =       0.376607449131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.898666714290        initial
     2.5000e-01     2.5000e+00             8.1980e-03       -16.898955069444  <--
     1.0000e+00     1.0000e+01             3.1378e-03       -16.898720386277
     4.0000e+00     4.0000e+01             9.5506e-04       -16.898432463676

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4060e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 6.972963e-01 3 1  ON 0
ci_0002                 6.967018e-01 3 1  ON 1
ci_0003                -4.031365e-02 3 1  ON 2
ci_0004                -4.078258e-02 3 1  ON 3
ci_0005                -4.167356e-02 3 1  ON 4
ci_0006                -4.164282e-02 3 1  ON 5
ci_0007                -3.114659e-02 3 1  ON 6
ci_0008                -3.053993e-02 3 1  ON 7
ci_0009                -2.568935e-02 3 1  ON 8
ci_0010                -2.569382e-02 3 1  ON 9
ci_0011                -2.147671e-02 3 1  ON 10
ci_0012                -2.117966e-02 3 1  ON 11
ci_0013                 2.113367e-02 3 1  ON 12
ci_0014                 2.129728e-02 3 1  ON 13
ci_0015                 2.118801e-02 3 1  ON 14
ci_0016                 2.090260e-02 3 1  ON 15
ci_0017                 1.903652e-02 3 1  ON 16
ci_0018                 1.866202e-02 3 1  ON 17
ci_0019                 1.596541e-02 3 1  ON 18
ci_0020                 1.548674e-02 3 1  ON 19
ci_0021                 1.631806e-02 3 1  ON 20
ci_0022                 1.688851e-02 3 1  ON 21
ci_0023                -1.540467e-02 3 1  ON 22
ci_0024                -1.499100e-02 3 1  ON 23
ci_0025                -1.502315e-02 3 1  ON 24
ci_0026                -1.606361e-02 3 1  ON 25
ci_0027                -1.421625e-02 3 1  ON 26
ci_0028                -1.440662e-02 3 1  ON 27
ci_0029                -1.320261e-02 3 1  ON 28
ci_0030                -1.340451e-02 3 1  ON 29
ci_0031                 1.722783e-02 3 1  ON 30
ci_0032                 1.783107e-02 3 1  ON 31
ci_0033                 1.403969e-02 3 1  ON 32
ci_0034                 1.399249e-02 3 1  ON 33
ci_0035                 1.202512e-02 3 1  ON 34
ci_0036                 1.131338e-02 3 1  ON 35
ci_0037                -1.278469e-02 3 1  ON 36
ci_0038                -1.349503e-02 3 1  ON 37
ci_0039                -8.485049e-03 3 1  ON 38
ci_0040                -8.185466e-03 3 1  ON 39
ci_0041                 1.187378e-02 3 1  ON 40
ci_0042                 1.156590e-02 3 1  ON 41
ci_0043                -1.381948e-02 3 1  ON 42
ci_0044                -1.373439e-02 3 1  ON 43
ci_0045                 1.210845e-02 3 1  ON 44
ci_0046                 1.203770e-02 3 1  ON 45
ci_0047                -7.722033e-03 3 1  ON 46
ci_0048                -7.553619e-03 3 1  ON 47
ci_0049                -9.273819e-03 3 1  ON 48
ci_0050                -9.581099e-03 3 1  ON 49
ci_0051                -7.820287e-03 3 1  ON 50
ci_0052                -8.017669e-03 3 1  ON 51
ci_0053                -8.533303e-03 3 1  ON 52
ci_0054                -9.138428e-03 3 1  ON 53
ci_0055                 1.000792e-02 3 1  ON 54
ci_0056                 1.053806e-02 3 1  ON 55
ci_0057                 8.829193e-03 3 1  ON 56
ci_0058                 9.362607e-03 3 1  ON 57
ci_0059                -8.552275e-03 3 1  ON 58
ci_0060                -8.608280e-03 3 1  ON 59
ci_0061                -7.959233e-03 3 1  ON 60
ci_0062                -7.924100e-03 3 1  ON 61
ci_0063                -1.014282e-02 3 1  ON 62
ci_0064                -9.941950e-03 3 1  ON 63
ci_0065                -8.669249e-03 3 1  ON 64
ci_0066                -8.910377e-03 3 1  ON 65
ci_0067                -8.380426e-03 3 1  ON 66
ci_0068                -8.491263e-03 3 1  ON 67
ci_0069                 7.749427e-03 3 1  ON 68
ci_0070                 7.141724e-03 3 1  ON 69
ci_0071                 8.270514e-03 3 1  ON 70
ci_0072                 7.644204e-03 3 1  ON 71
ci_0073                 7.522628e-03 3 1  ON 72
ci_0074                 6.947079e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8903
    reference variance = 0.257434
====================================================
  Execution time = 1.4635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6901e+01
  VMC Evar = 3.4772e-01
  Total weights = 1.950989183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333494387282
                                         uncertainty =       0.002649650427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333494387282
                                         uncertainty =       0.002649650427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408322792
  error estimate for blocks of size 2^( 2) =       0.000422437283
  error estimate for blocks of size 2^( 3) =       0.000437093350
  error estimate for blocks of size 2^( 4) =       0.000451268839
  error estimate for blocks of size 2^( 5) =       0.000463577500
  error estimate for blocks of size 2^( 6) =       0.000473686032
  error estimate for blocks of size 2^( 7) =       0.000483153027

      target function =                  N/A
              le_mean =     -16.900551864321
             les_mean =     285.976370340845
             stat err =       0.000467921349
             autocorr =       1.313222987821
              std dev =       0.577455630710
             le_variance =       0.333455005439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690055186432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.900551864302       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.902555498087       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.902674187756       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.902689352984       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.902691593392       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.902690862705       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.902691118006       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.902690928633       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 7.836272e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.900551864302       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.901814614576       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.901845228831       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.901846729637       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.901846799568       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 4.590769e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.900551864302       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.901061147144       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.901065902360       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.901066307827       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 1.740561e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7254e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 6.992334e-01 3 1  ON 0
ci_0002                 6.978787e-01 3 1  ON 1
ci_0003                -3.572288e-02 3 1  ON 2
ci_0004                -3.627522e-02 3 1  ON 3
ci_0005                -3.877558e-02 3 1  ON 4
ci_0006                -3.943339e-02 3 1  ON 5
ci_0007                -2.869855e-02 3 1  ON 6
ci_0008                -2.921440e-02 3 1  ON 7
ci_0009                -2.279239e-02 3 1  ON 8
ci_0010                -2.236138e-02 3 1  ON 9
ci_0011                -1.880757e-02 3 1  ON 10
ci_0012                -1.817746e-02 3 1  ON 11
ci_0013                 1.845427e-02 3 1  ON 12
ci_0014                 1.877452e-02 3 1  ON 13
ci_0015                 1.799611e-02 3 1  ON 14
ci_0016                 1.791638e-02 3 1  ON 15
ci_0017                 1.576985e-02 3 1  ON 16
ci_0018                 1.636504e-02 3 1  ON 17
ci_0019                 1.392187e-02 3 1  ON 18
ci_0020                 1.346811e-02 3 1  ON 19
ci_0021                 1.386909e-02 3 1  ON 20
ci_0022                 1.515992e-02 3 1  ON 21
ci_0023                -1.332065e-02 3 1  ON 22
ci_0024                -1.295111e-02 3 1  ON 23
ci_0025                -1.389561e-02 3 1  ON 24
ci_0026                -1.377864e-02 3 1  ON 25
ci_0027                -1.251046e-02 3 1  ON 26
ci_0028                -1.271584e-02 3 1  ON 27
ci_0029                -1.174619e-02 3 1  ON 28
ci_0030                -1.211005e-02 3 1  ON 29
ci_0031                 1.807476e-02 3 1  ON 30
ci_0032                 1.860982e-02 3 1  ON 31
ci_0033                 1.262511e-02 3 1  ON 32
ci_0034                 1.298587e-02 3 1  ON 33
ci_0035                 9.720071e-03 3 1  ON 34
ci_0036                 9.758961e-03 3 1  ON 35
ci_0037                -1.167667e-02 3 1  ON 36
ci_0038                -1.260771e-02 3 1  ON 37
ci_0039                -6.070598e-03 3 1  ON 38
ci_0040                -6.024461e-03 3 1  ON 39
ci_0041                 1.069465e-02 3 1  ON 40
ci_0042                 1.018548e-02 3 1  ON 41
ci_0043                -1.348385e-02 3 1  ON 42
ci_0044                -1.380971e-02 3 1  ON 43
ci_0045                 1.072642e-02 3 1  ON 44
ci_0046                 1.087074e-02 3 1  ON 45
ci_0047                -5.158605e-03 3 1  ON 46
ci_0048                -5.025011e-03 3 1  ON 47
ci_0049                -8.113423e-03 3 1  ON 48
ci_0050                -8.289276e-03 3 1  ON 49
ci_0051                -6.133446e-03 3 1  ON 50
ci_0052                -6.244065e-03 3 1  ON 51
ci_0053                -7.426728e-03 3 1  ON 52
ci_0054                -7.272463e-03 3 1  ON 53
ci_0055                 8.893261e-03 3 1  ON 54
ci_0056                 9.248865e-03 3 1  ON 55
ci_0057                 7.472360e-03 3 1  ON 56
ci_0058                 7.920825e-03 3 1  ON 57
ci_0059                -7.073979e-03 3 1  ON 58
ci_0060                -7.424722e-03 3 1  ON 59
ci_0061                -6.268369e-03 3 1  ON 60
ci_0062                -6.002990e-03 3 1  ON 61
ci_0063                -9.589516e-03 3 1  ON 62
ci_0064                -8.876167e-03 3 1  ON 63
ci_0065                -7.466877e-03 3 1  ON 64
ci_0066                -7.824554e-03 3 1  ON 65
ci_0067                -7.389732e-03 3 1  ON 66
ci_0068                -7.169033e-03 3 1  ON 67
ci_0069                 6.420074e-03 3 1  ON 68
ci_0070                 6.259452e-03 3 1  ON 69
ci_0071                 6.709489e-03 3 1  ON 70
ci_0072                 5.995988e-03 3 1  ON 71
ci_0073                 6.081431e-03 3 1  ON 72
ci_0074                 6.169033e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8791
    reference variance = 0.193856
====================================================
  Execution time = 1.4534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.3804e-01
  Total weights = 1.9518e+06
  Execution time = 1.8860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.283127
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409925387293
                                         uncertainty =       0.044851492735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.409925387293
                                         uncertainty =       0.044851492735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000452570105
  error estimate for blocks of size 2^( 2) =       0.000464758862
  error estimate for blocks of size 2^( 3) =       0.000477219037
  error estimate for blocks of size 2^( 4) =       0.000487508743
  error estimate for blocks of size 2^( 5) =       0.000496388261
  error estimate for blocks of size 2^( 6) =       0.000502179026
  error estimate for blocks of size 2^( 7) =       0.000503688579

      target function =                  N/A
              le_mean =     -16.903775454826
             les_mean =     287.138318500790
             stat err =       0.000497441152
             autocorr =       1.208124514392
              std dev =       0.640030779762
             le_variance =       0.409639399043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317332042716
                                         uncertainty =       0.002876696882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317332042716
                                         uncertainty =       0.002876696882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398316925
  error estimate for blocks of size 2^( 2) =       0.000411806982
  error estimate for blocks of size 2^( 3) =       0.000425654127
  error estimate for blocks of size 2^( 4) =       0.000437285300
  error estimate for blocks of size 2^( 5) =       0.000447734506
  error estimate for blocks of size 2^( 6) =       0.000455434517
  error estimate for blocks of size 2^( 7) =       0.000459015854

      target function =                  N/A
              le_mean =     -16.903376713886
             les_mean =     286.699987159509
             stat err =       0.000449867544
             autocorr =       1.275592046838
              std dev =       0.563305197334
             le_variance =       0.317312745343

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.26712
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316777054287
                                         uncertainty =       0.002983008198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316777054287
                                         uncertainty =       0.002983008198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397964867
  error estimate for blocks of size 2^( 2) =       0.000411709383
  error estimate for blocks of size 2^( 3) =       0.000425808942
  error estimate for blocks of size 2^( 4) =       0.000437621017
  error estimate for blocks of size 2^( 5) =       0.000448132218
  error estimate for blocks of size 2^( 6) =       0.000455864925
  error estimate for blocks of size 2^( 7) =       0.000459661564

      target function =                  N/A
              le_mean =     -16.903730738102
             les_mean =     286.115864851962
             stat err =       0.000450319931
             autocorr =       1.280421248045
              std dev =       0.562807311597
             le_variance =       0.316752069987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331067220839
                                         uncertainty =       0.003317564100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331067220839
                                         uncertainty =       0.003317564100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406845564
  error estimate for blocks of size 2^( 2) =       0.000420073279
  error estimate for blocks of size 2^( 3) =       0.000433549995
  error estimate for blocks of size 2^( 4) =       0.000444914823
  error estimate for blocks of size 2^( 5) =       0.000455022785
  error estimate for blocks of size 2^( 6) =       0.000462518706
  error estimate for blocks of size 2^( 7) =       0.000465523327

      target function =                  N/A
              le_mean =     -16.903395628152
             les_mean =     286.153131435051
             stat err =       0.000456994910
             autocorr =       1.261721652739
              std dev =       0.575366514373
             le_variance =       0.331046625861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903775454826        initial  <--
     6.2500e-02     6.2500e-01             7.8363e-03       -16.903376713886
     2.5000e-01     2.5000e+00             4.5908e-03       -16.903730738102
     1.0000e+00     1.0000e+01             1.7406e-03       -16.903395628152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1041
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 6.972963e-01 3 1  ON 0
ci_0002                 6.967018e-01 3 1  ON 1
ci_0003                -4.031365e-02 3 1  ON 2
ci_0004                -4.078258e-02 3 1  ON 3
ci_0005                -4.167356e-02 3 1  ON 4
ci_0006                -4.164282e-02 3 1  ON 5
ci_0007                -3.114659e-02 3 1  ON 6
ci_0008                -3.053993e-02 3 1  ON 7
ci_0009                -2.568935e-02 3 1  ON 8
ci_0010                -2.569382e-02 3 1  ON 9
ci_0011                -2.147671e-02 3 1  ON 10
ci_0012                -2.117966e-02 3 1  ON 11
ci_0013                 2.113367e-02 3 1  ON 12
ci_0014                 2.129728e-02 3 1  ON 13
ci_0015                 2.118801e-02 3 1  ON 14
ci_0016                 2.090260e-02 3 1  ON 15
ci_0017                 1.903652e-02 3 1  ON 16
ci_0018                 1.866202e-02 3 1  ON 17
ci_0019                 1.596541e-02 3 1  ON 18
ci_0020                 1.548674e-02 3 1  ON 19
ci_0021                 1.631806e-02 3 1  ON 20
ci_0022                 1.688851e-02 3 1  ON 21
ci_0023                -1.540467e-02 3 1  ON 22
ci_0024                -1.499100e-02 3 1  ON 23
ci_0025                -1.502315e-02 3 1  ON 24
ci_0026                -1.606361e-02 3 1  ON 25
ci_0027                -1.421625e-02 3 1  ON 26
ci_0028                -1.440662e-02 3 1  ON 27
ci_0029                -1.320261e-02 3 1  ON 28
ci_0030                -1.340451e-02 3 1  ON 29
ci_0031                 1.722783e-02 3 1  ON 30
ci_0032                 1.783107e-02 3 1  ON 31
ci_0033                 1.403969e-02 3 1  ON 32
ci_0034                 1.399249e-02 3 1  ON 33
ci_0035                 1.202512e-02 3 1  ON 34
ci_0036                 1.131338e-02 3 1  ON 35
ci_0037                -1.278469e-02 3 1  ON 36
ci_0038                -1.349503e-02 3 1  ON 37
ci_0039                -8.485049e-03 3 1  ON 38
ci_0040                -8.185466e-03 3 1  ON 39
ci_0041                 1.187378e-02 3 1  ON 40
ci_0042                 1.156590e-02 3 1  ON 41
ci_0043                -1.381948e-02 3 1  ON 42
ci_0044                -1.373439e-02 3 1  ON 43
ci_0045                 1.210845e-02 3 1  ON 44
ci_0046                 1.203770e-02 3 1  ON 45
ci_0047                -7.722033e-03 3 1  ON 46
ci_0048                -7.553619e-03 3 1  ON 47
ci_0049                -9.273819e-03 3 1  ON 48
ci_0050                -9.581099e-03 3 1  ON 49
ci_0051                -7.820287e-03 3 1  ON 50
ci_0052                -8.017669e-03 3 1  ON 51
ci_0053                -8.533303e-03 3 1  ON 52
ci_0054                -9.138428e-03 3 1  ON 53
ci_0055                 1.000792e-02 3 1  ON 54
ci_0056                 1.053806e-02 3 1  ON 55
ci_0057                 8.829193e-03 3 1  ON 56
ci_0058                 9.362607e-03 3 1  ON 57
ci_0059                -8.552275e-03 3 1  ON 58
ci_0060                -8.608280e-03 3 1  ON 59
ci_0061                -7.959233e-03 3 1  ON 60
ci_0062                -7.924100e-03 3 1  ON 61
ci_0063                -1.014282e-02 3 1  ON 62
ci_0064                -9.941950e-03 3 1  ON 63
ci_0065                -8.669249e-03 3 1  ON 64
ci_0066                -8.910377e-03 3 1  ON 65
ci_0067                -8.380426e-03 3 1  ON 66
ci_0068                -8.491263e-03 3 1  ON 67
ci_0069                 7.749427e-03 3 1  ON 68
ci_0070                 7.141724e-03 3 1  ON 69
ci_0071                 8.270514e-03 3 1  ON 70
ci_0072                 7.644204e-03 3 1  ON 71
ci_0073                 7.522628e-03 3 1  ON 72
ci_0074                 6.947079e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9146
    reference variance = 0.204602
====================================================
  Execution time = 1.4678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.4908e-01
  Total weights = 1.950990451e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331416934819
                                         uncertainty =       0.002244908037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331416934819
                                         uncertainty =       0.002244908037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407072815
  error estimate for blocks of size 2^( 2) =       0.000420488337
  error estimate for blocks of size 2^( 3) =       0.000434409027
  error estimate for blocks of size 2^( 4) =       0.000447326318
  error estimate for blocks of size 2^( 5) =       0.000457842603
  error estimate for blocks of size 2^( 6) =       0.000465566436
  error estimate for blocks of size 2^( 7) =       0.000470505604

      target function =                  N/A
              le_mean =     -16.901770409298
             les_mean =     286.018926603492
             stat err =       0.000460310240
             autocorr =       1.278665868361
              std dev =       0.575687895438
             le_variance =       0.331416552953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690177040930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.901770409337       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.902484403101       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.902501737330       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.902501849668       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.902501855147       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 2.568149e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.901770409337       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.901998647703       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.902003154703       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.902003254986       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 7.904291e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.901770409337       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.901831740657       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.901832956155       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.901832995644       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 2.098496e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7285e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 6.975241e-01 3 1  ON 0
ci_0002                 6.970090e-01 3 1  ON 1
ci_0003                -3.962725e-02 3 1  ON 2
ci_0004                -3.999215e-02 3 1  ON 3
ci_0005                -4.134896e-02 3 1  ON 4
ci_0006                -4.138412e-02 3 1  ON 5
ci_0007                -3.082291e-02 3 1  ON 6
ci_0008                -3.017892e-02 3 1  ON 7
ci_0009                -2.515434e-02 3 1  ON 8
ci_0010                -2.506931e-02 3 1  ON 9
ci_0011                -2.097834e-02 3 1  ON 10
ci_0012                -2.063570e-02 3 1  ON 11
ci_0013                 2.072621e-02 3 1  ON 12
ci_0014                 2.080033e-02 3 1  ON 13
ci_0015                 2.068289e-02 3 1  ON 14
ci_0016                 2.049203e-02 3 1  ON 15
ci_0017                 1.853549e-02 3 1  ON 16
ci_0018                 1.816668e-02 3 1  ON 17
ci_0019                 1.553668e-02 3 1  ON 18
ci_0020                 1.513355e-02 3 1  ON 19
ci_0021                 1.605135e-02 3 1  ON 20
ci_0022                 1.662338e-02 3 1  ON 21
ci_0023                -1.497284e-02 3 1  ON 22
ci_0024                -1.456294e-02 3 1  ON 23
ci_0025                -1.477168e-02 3 1  ON 24
ci_0026                -1.566135e-02 3 1  ON 25
ci_0027                -1.399262e-02 3 1  ON 26
ci_0028                -1.410518e-02 3 1  ON 27
ci_0029                -1.298318e-02 3 1  ON 28
ci_0030                -1.305179e-02 3 1  ON 29
ci_0031                 1.731341e-02 3 1  ON 30
ci_0032                 1.791638e-02 3 1  ON 31
ci_0033                 1.380377e-02 3 1  ON 32
ci_0034                 1.379406e-02 3 1  ON 33
ci_0035                 1.177439e-02 3 1  ON 34
ci_0036                 1.088927e-02 3 1  ON 35
ci_0037                -1.264566e-02 3 1  ON 36
ci_0038                -1.331214e-02 3 1  ON 37
ci_0039                -7.932308e-03 3 1  ON 38
ci_0040                -7.639937e-03 3 1  ON 39
ci_0041                 1.165280e-02 3 1  ON 40
ci_0042                 1.138014e-02 3 1  ON 41
ci_0043                -1.383059e-02 3 1  ON 42
ci_0044                -1.365333e-02 3 1  ON 43
ci_0045                 1.189411e-02 3 1  ON 44
ci_0046                 1.186035e-02 3 1  ON 45
ci_0047                -7.152376e-03 3 1  ON 46
ci_0048                -7.039349e-03 3 1  ON 47
ci_0049                -8.944474e-03 3 1  ON 48
ci_0050                -9.301266e-03 3 1  ON 49
ci_0051                -7.529316e-03 3 1  ON 50
ci_0052                -7.633972e-03 3 1  ON 51
ci_0053                -8.235725e-03 3 1  ON 52
ci_0054                -8.797394e-03 3 1  ON 53
ci_0055                 9.804134e-03 3 1  ON 54
ci_0056                 1.033037e-02 3 1  ON 55
ci_0057                 8.573670e-03 3 1  ON 56
ci_0058                 9.169165e-03 3 1  ON 57
ci_0059                -8.236251e-03 3 1  ON 58
ci_0060                -8.338498e-03 3 1  ON 59
ci_0061                -7.680072e-03 3 1  ON 60
ci_0062                -7.517744e-03 3 1  ON 61
ci_0063                -1.007120e-02 3 1  ON 62
ci_0064                -9.909827e-03 3 1  ON 63
ci_0065                -8.495082e-03 3 1  ON 64
ci_0066                -8.679072e-03 3 1  ON 65
ci_0067                -8.076666e-03 3 1  ON 66
ci_0068                -8.286765e-03 3 1  ON 67
ci_0069                 7.378625e-03 3 1  ON 68
ci_0070                 7.029634e-03 3 1  ON 69
ci_0071                 8.021669e-03 3 1  ON 70
ci_0072                 7.398486e-03 3 1  ON 71
ci_0073                 7.240588e-03 3 1  ON 72
ci_0074                 6.734126e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.490199
====================================================
  Execution time = 1.4643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.4124e-01
  Total weights = 1.9511e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333159440056
                                         uncertainty =       0.003693685728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333159440056
                                         uncertainty =       0.003693685728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408120192
  error estimate for blocks of size 2^( 2) =       0.000421495688
  error estimate for blocks of size 2^( 3) =       0.000435203989
  error estimate for blocks of size 2^( 4) =       0.000447210085
  error estimate for blocks of size 2^( 5) =       0.000456989563
  error estimate for blocks of size 2^( 6) =       0.000462907030
  error estimate for blocks of size 2^( 7) =       0.000466506943

      target function =                  N/A
              le_mean =     -16.902454925981
             les_mean =     288.161359291730
             stat err =       0.000458403405
             autocorr =       1.261593681952
              std dev =       0.577169110564
             le_variance =       0.333124182189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322927269034
                                         uncertainty =       0.002865709242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322927269034
                                         uncertainty =       0.002865709242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401810782
  error estimate for blocks of size 2^( 2) =       0.000415162834
  error estimate for blocks of size 2^( 3) =       0.000428919585
  error estimate for blocks of size 2^( 4) =       0.000440992856
  error estimate for blocks of size 2^( 5) =       0.000451005503
  error estimate for blocks of size 2^( 6) =       0.000457121322
  error estimate for blocks of size 2^( 7) =       0.000461031370

      target function =                  N/A
              le_mean =     -16.902535094027
             les_mean =     286.042549874057
             stat err =       0.000452537762
             autocorr =       1.268429917478
              std dev =       0.568246258105
             le_variance =       0.322903809850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325129117707
                                         uncertainty =       0.002796577776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325129117707
                                         uncertainty =       0.002796577776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403179066
  error estimate for blocks of size 2^( 2) =       0.000416525543
  error estimate for blocks of size 2^( 3) =       0.000430275135
  error estimate for blocks of size 2^( 4) =       0.000442322150
  error estimate for blocks of size 2^( 5) =       0.000452290280
  error estimate for blocks of size 2^( 6) =       0.000458340293
  error estimate for blocks of size 2^( 7) =       0.000462170147

      target function =                  N/A
              le_mean =     -16.902446360720
             les_mean =     286.032551592471
             stat err =       0.000453780718
             autocorr =       1.266765205569
              std dev =       0.570181303318
             le_variance =       0.325106718653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329517466894
                                         uncertainty =       0.002740293464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329517466894
                                         uncertainty =       0.002740293464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405891400
  error estimate for blocks of size 2^( 2) =       0.000419245317
  error estimate for blocks of size 2^( 3) =       0.000432980483
  error estimate for blocks of size 2^( 4) =       0.000444997533
  error estimate for blocks of size 2^( 5) =       0.000454885822
  error estimate for blocks of size 2^( 6) =       0.000460823104
  error estimate for blocks of size 2^( 7) =       0.000464570167

      target function =                  N/A
              le_mean =     -16.902411275041
             les_mean =     286.034688910378
             stat err =       0.000456319157
             autocorr =       1.263914519966
              std dev =       0.574017122691
             le_variance =       0.329495657142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.902454925981        initial
     6.2500e-01     6.2500e+00             2.5681e-03       -16.902535094027  <--
     2.5000e+00     2.5000e+01             7.9043e-04       -16.902446360720
     1.0000e+01     1.0000e+02             2.0985e-04       -16.902411275041

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.4244e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 6.980026e-01 3 1  ON 0
ci_0002                 6.977071e-01 3 1  ON 1
ci_0003                -3.808428e-02 3 1  ON 2
ci_0004                -3.821443e-02 3 1  ON 3
ci_0005                -4.054621e-02 3 1  ON 4
ci_0006                -4.073718e-02 3 1  ON 5
ci_0007                -2.996858e-02 3 1  ON 6
ci_0008                -2.923266e-02 3 1  ON 7
ci_0009                -2.404085e-02 3 1  ON 8
ci_0010                -2.376235e-02 3 1  ON 9
ci_0011                -1.991406e-02 3 1  ON 10
ci_0012                -1.946923e-02 3 1  ON 11
ci_0013                 1.985756e-02 3 1  ON 12
ci_0014                 1.974060e-02 3 1  ON 13
ci_0015                 1.959148e-02 3 1  ON 14
ci_0016                 1.961690e-02 3 1  ON 15
ci_0017                 1.749171e-02 3 1  ON 16
ci_0018                 1.713774e-02 3 1  ON 17
ci_0019                 1.464970e-02 3 1  ON 18
ci_0020                 1.441373e-02 3 1  ON 19
ci_0021                 1.530657e-02 3 1  ON 20
ci_0022                 1.587889e-02 3 1  ON 21
ci_0023                -1.409546e-02 3 1  ON 22
ci_0024                -1.369492e-02 3 1  ON 23
ci_0025                -1.420835e-02 3 1  ON 24
ci_0026                -1.477954e-02 3 1  ON 25
ci_0027                -1.355624e-02 3 1  ON 26
ci_0028                -1.350094e-02 3 1  ON 27
ci_0029                -1.257576e-02 3 1  ON 28
ci_0030                -1.234646e-02 3 1  ON 29
ci_0031                 1.752849e-02 3 1  ON 30
ci_0032                 1.812523e-02 3 1  ON 31
ci_0033                 1.321288e-02 3 1  ON 32
ci_0034                 1.330564e-02 3 1  ON 33
ci_0035                 1.122468e-02 3 1  ON 34
ci_0036                 9.948296e-03 3 1  ON 35
ci_0037                -1.232571e-02 3 1  ON 36
ci_0038                -1.287775e-02 3 1  ON 37
ci_0039                -6.893345e-03 3 1  ON 38
ci_0040                -6.618364e-03 3 1  ON 39
ci_0041                 1.114319e-02 3 1  ON 40
ci_0042                 1.094912e-02 3 1  ON 41
ci_0043                -1.389009e-02 3 1  ON 42
ci_0044                -1.347082e-02 3 1  ON 43
ci_0045                 1.138433e-02 3 1  ON 44
ci_0046                 1.143590e-02 3 1  ON 45
ci_0047                -6.067410e-03 3 1  ON 46
ci_0048                -6.058045e-03 3 1  ON 47
ci_0049                -8.229705e-03 3 1  ON 48
ci_0050                -8.693205e-03 3 1  ON 49
ci_0051                -6.961138e-03 3 1  ON 50
ci_0052                -6.888126e-03 3 1  ON 51
ci_0053                -7.635981e-03 3 1  ON 52
ci_0054                -8.105349e-03 3 1  ON 53
ci_0055                 9.314580e-03 3 1  ON 54
ci_0056                 9.838435e-03 3 1  ON 55
ci_0057                 8.000015e-03 3 1  ON 56
ci_0058                 8.726168e-03 3 1  ON 57
ci_0059                -7.599147e-03 3 1  ON 58
ci_0060                -7.796546e-03 3 1  ON 59
ci_0061                -7.044920e-03 3 1  ON 60
ci_0062                -6.603561e-03 3 1  ON 61
ci_0063                -9.932408e-03 3 1  ON 62
ci_0064                -9.848619e-03 3 1  ON 63
ci_0065                -8.110649e-03 3 1  ON 64
ci_0066                -8.175585e-03 3 1  ON 65
ci_0067                -7.491006e-03 3 1  ON 66
ci_0068                -7.887035e-03 3 1  ON 67
ci_0069                 6.660951e-03 3 1  ON 68
ci_0070                 6.818291e-03 3 1  ON 69
ci_0071                 7.438325e-03 3 1  ON 70
ci_0072                 6.833293e-03 3 1  ON 71
ci_0073                 6.691791e-03 3 1  ON 72
ci_0074                 6.319467e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.231602
====================================================
  Execution time = 1.4741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6902e+01
  VMC Evar = 3.4110e-01
  Total weights = 1.951353519e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325280142781
                                         uncertainty =       0.002893607598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325280142781
                                         uncertainty =       0.002893607598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403234285
  error estimate for blocks of size 2^( 2) =       0.000416862742
  error estimate for blocks of size 2^( 3) =       0.000431405422
  error estimate for blocks of size 2^( 4) =       0.000444313852
  error estimate for blocks of size 2^( 5) =       0.000454866965
  error estimate for blocks of size 2^( 6) =       0.000462875951
  error estimate for blocks of size 2^( 7) =       0.000468156697

      target function =                  N/A
              le_mean =     -16.902311995135
             les_mean =     286.029254677886
             stat err =       0.000457553366
             autocorr =       1.287563355480
              std dev =       0.570259394496
             le_variance =       0.325195777011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690231199514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.902311995193       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903110776272       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903146348821       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903148928102       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903149251669       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903149205799       residual = 6.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 3.980487e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.902311995193       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.902679568184       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.902687059131       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.902687452271       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.902687474010       residual = 2.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 1.739006e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.902311995193       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.902428334850       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.902430470830       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.902430628113       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 5.373938e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7403e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 6.986289e-01 3 1  ON 0
ci_0002                 6.982837e-01 3 1  ON 1
ci_0003                -3.643366e-02 3 1  ON 2
ci_0004                -3.647542e-02 3 1  ON 3
ci_0005                -3.956556e-02 3 1  ON 4
ci_0006                -3.986782e-02 3 1  ON 5
ci_0007                -2.906490e-02 3 1  ON 6
ci_0008                -2.846485e-02 3 1  ON 7
ci_0009                -2.288056e-02 3 1  ON 8
ci_0010                -2.251820e-02 3 1  ON 9
ci_0011                -1.851949e-02 3 1  ON 10
ci_0012                -1.841347e-02 3 1  ON 11
ci_0013                 1.854194e-02 3 1  ON 12
ci_0014                 1.867061e-02 3 1  ON 13
ci_0015                 1.863605e-02 3 1  ON 14
ci_0016                 1.833191e-02 3 1  ON 15
ci_0017                 1.629315e-02 3 1  ON 16
ci_0018                 1.600454e-02 3 1  ON 17
ci_0019                 1.360673e-02 3 1  ON 18
ci_0020                 1.343692e-02 3 1  ON 19
ci_0021                 1.431107e-02 3 1  ON 20
ci_0022                 1.474343e-02 3 1  ON 21
ci_0023                -1.353076e-02 3 1  ON 22
ci_0024                -1.280388e-02 3 1  ON 23
ci_0025                -1.349211e-02 3 1  ON 24
ci_0026                -1.390329e-02 3 1  ON 25
ci_0027                -1.280062e-02 3 1  ON 26
ci_0028                -1.252794e-02 3 1  ON 27
ci_0029                -1.178107e-02 3 1  ON 28
ci_0030                -1.147768e-02 3 1  ON 29
ci_0031                 1.816079e-02 3 1  ON 30
ci_0032                 1.791913e-02 3 1  ON 31
ci_0033                 1.292448e-02 3 1  ON 32
ci_0034                 1.319646e-02 3 1  ON 33
ci_0035                 9.933602e-03 3 1  ON 34
ci_0036                 8.785355e-03 3 1  ON 35
ci_0037                -1.187867e-02 3 1  ON 36
ci_0038                -1.242881e-02 3 1  ON 37
ci_0039                -6.014431e-03 3 1  ON 38
ci_0040                -5.608015e-03 3 1  ON 39
ci_0041                 1.017700e-02 3 1  ON 40
ci_0042                 1.053080e-02 3 1  ON 41
ci_0043                -1.382455e-02 3 1  ON 42
ci_0044                -1.332707e-02 3 1  ON 43
ci_0045                 1.067060e-02 3 1  ON 44
ci_0046                 1.102336e-02 3 1  ON 45
ci_0047                -5.194981e-03 3 1  ON 46
ci_0048                -5.205768e-03 3 1  ON 47
ci_0049                -7.782282e-03 3 1  ON 48
ci_0050                -7.967996e-03 3 1  ON 49
ci_0051                -6.049758e-03 3 1  ON 50
ci_0052                -6.038039e-03 3 1  ON 51
ci_0053                -7.258241e-03 3 1  ON 52
ci_0054                -7.565581e-03 3 1  ON 53
ci_0055                 8.423921e-03 3 1  ON 54
ci_0056                 9.871369e-03 3 1  ON 55
ci_0057                 7.354299e-03 3 1  ON 56
ci_0058                 8.061166e-03 3 1  ON 57
ci_0059                -7.547179e-03 3 1  ON 58
ci_0060                -7.282520e-03 3 1  ON 59
ci_0061                -6.171264e-03 3 1  ON 60
ci_0062                -6.030740e-03 3 1  ON 61
ci_0063                -9.530027e-03 3 1  ON 62
ci_0064                -9.461616e-03 3 1  ON 63
ci_0065                -7.541793e-03 3 1  ON 64
ci_0066                -7.688696e-03 3 1  ON 65
ci_0067                -6.862816e-03 3 1  ON 66
ci_0068                -7.282418e-03 3 1  ON 67
ci_0069                 6.033238e-03 3 1  ON 68
ci_0070                 6.270680e-03 3 1  ON 69
ci_0071                 6.924447e-03 3 1  ON 70
ci_0072                 6.453511e-03 3 1  ON 71
ci_0073                 6.293626e-03 3 1  ON 72
ci_0074                 5.846395e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.533729
====================================================
  Execution time = 1.4359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3309e-01
  Total weights = 1.9516e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324617649917
                                         uncertainty =       0.002343038989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324617649917
                                         uncertainty =       0.002343038989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402851598
  error estimate for blocks of size 2^( 2) =       0.000416254923
  error estimate for blocks of size 2^( 3) =       0.000430119157
  error estimate for blocks of size 2^( 4) =       0.000442473256
  error estimate for blocks of size 2^( 5) =       0.000454624395
  error estimate for blocks of size 2^( 6) =       0.000463466770
  error estimate for blocks of size 2^( 7) =       0.000467432542

      target function =                  N/A
              le_mean =     -16.903758196490
             les_mean =     286.175150470700
             stat err =       0.000456999241
             autocorr =       1.286888072771
              std dev =       0.569718193417
             le_variance =       0.324578819910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315726015161
                                         uncertainty =       0.002687863184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315726015161
                                         uncertainty =       0.002687863184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397298626
  error estimate for blocks of size 2^( 2) =       0.000410860830
  error estimate for blocks of size 2^( 3) =       0.000424982927
  error estimate for blocks of size 2^( 4) =       0.000437460500
  error estimate for blocks of size 2^( 5) =       0.000449758670
  error estimate for blocks of size 2^( 6) =       0.000458901784
  error estimate for blocks of size 2^( 7) =       0.000462948359

      target function =                  N/A
              le_mean =     -16.903760527624
             les_mean =     286.164261620951
             stat err =       0.000452267328
             autocorr =       1.295854691997
              std dev =       0.561865104793
             le_variance =       0.315692395984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314997805507
                                         uncertainty =       0.002254591865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314997805507
                                         uncertainty =       0.002254591865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396841507
  error estimate for blocks of size 2^( 2) =       0.000410490642
  error estimate for blocks of size 2^( 3) =       0.000424661419
  error estimate for blocks of size 2^( 4) =       0.000437209255
  error estimate for blocks of size 2^( 5) =       0.000449493947
  error estimate for blocks of size 2^( 6) =       0.000458692634
  error estimate for blocks of size 2^( 7) =       0.000462709019

      target function =                  N/A
              le_mean =     -16.903737111863
             les_mean =     286.108388953085
             stat err =       0.000452026214
             autocorr =       1.297457260627
              std dev =       0.561218641885
             le_variance =       0.314966363999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322375612618
                                         uncertainty =       0.002295169359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322375612618
                                         uncertainty =       0.002295169359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401457545
  error estimate for blocks of size 2^( 2) =       0.000414910241
  error estimate for blocks of size 2^( 3) =       0.000428791713
  error estimate for blocks of size 2^( 4) =       0.000441146147
  error estimate for blocks of size 2^( 5) =       0.000453309671
  error estimate for blocks of size 2^( 6) =       0.000462234853
  error estimate for blocks of size 2^( 7) =       0.000466360643

      target function =                  N/A
              le_mean =     -16.903689802930
             les_mean =     286.116274918705
             stat err =       0.000455762829
             autocorr =       1.288838662799
              std dev =       0.567746704268
             le_variance =       0.322336320207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903758196490        initial
     1.5625e-01     1.5625e+00             3.9805e-03       -16.903760527624  <--
     6.2500e-01     6.2500e+00             1.7390e-03       -16.903737111863
     2.5000e+00     2.5000e+01             5.3739e-04       -16.903689802930

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.3951e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 6.994874e-01 3 1  ON 0
ci_0002                 6.989748e-01 3 1  ON 1
ci_0003                -3.433705e-02 3 1  ON 2
ci_0004                -3.423394e-02 3 1  ON 3
ci_0005                -3.792194e-02 3 1  ON 4
ci_0006                -3.838293e-02 3 1  ON 5
ci_0007                -2.735542e-02 3 1  ON 6
ci_0008                -2.695876e-02 3 1  ON 7
ci_0009                -2.161280e-02 3 1  ON 8
ci_0010                -2.116163e-02 3 1  ON 9
ci_0011                -1.688855e-02 3 1  ON 10
ci_0012                -1.720102e-02 3 1  ON 11
ci_0013                 1.699655e-02 3 1  ON 12
ci_0014                 1.745289e-02 3 1  ON 13
ci_0015                 1.755543e-02 3 1  ON 14
ci_0016                 1.683206e-02 3 1  ON 15
ci_0017                 1.497539e-02 3 1  ON 16
ci_0018                 1.477709e-02 3 1  ON 17
ci_0019                 1.249198e-02 3 1  ON 18
ci_0020                 1.240877e-02 3 1  ON 19
ci_0021                 1.218705e-02 3 1  ON 20
ci_0022                 1.241665e-02 3 1  ON 21
ci_0023                -1.301760e-02 3 1  ON 22
ci_0024                -1.189565e-02 3 1  ON 23
ci_0025                -1.260978e-02 3 1  ON 24
ci_0026                -1.278933e-02 3 1  ON 25
ci_0027                -1.204663e-02 3 1  ON 26
ci_0028                -1.150338e-02 3 1  ON 27
ci_0029                -1.100037e-02 3 1  ON 28
ci_0030                -1.059695e-02 3 1  ON 29
ci_0031                 1.919906e-02 3 1  ON 30
ci_0032                 1.752723e-02 3 1  ON 31
ci_0033                 1.245900e-02 3 1  ON 32
ci_0034                 1.304490e-02 3 1  ON 33
ci_0035                 8.258058e-03 3 1  ON 34
ci_0036                 7.290123e-03 3 1  ON 35
ci_0037                -1.125236e-02 3 1  ON 36
ci_0038                -1.178683e-02 3 1  ON 37
ci_0039                -5.240484e-03 3 1  ON 38
ci_0040                -4.723379e-03 3 1  ON 39
ci_0041                 8.938090e-03 3 1  ON 40
ci_0042                 9.943993e-03 3 1  ON 41
ci_0043                -1.379288e-02 3 1  ON 42
ci_0044                -1.317694e-02 3 1  ON 43
ci_0045                 9.581776e-03 3 1  ON 44
ci_0046                 1.040781e-02 3 1  ON 45
ci_0047                -4.404338e-03 3 1  ON 46
ci_0048                -4.435182e-03 3 1  ON 47
ci_0049                -7.298912e-03 3 1  ON 48
ci_0050                -7.142938e-03 3 1  ON 49
ci_0051                -5.182289e-03 3 1  ON 50
ci_0052                -5.223172e-03 3 1  ON 51
ci_0053                -6.878470e-03 3 1  ON 52
ci_0054                -7.025601e-03 3 1  ON 53
ci_0055                 7.128292e-03 3 1  ON 54
ci_0056                 9.938133e-03 3 1  ON 55
ci_0057                 6.502354e-03 3 1  ON 56
ci_0058                 7.183464e-03 3 1  ON 57
ci_0059                -7.470759e-03 3 1  ON 58
ci_0060                -6.753026e-03 3 1  ON 59
ci_0061                -5.033106e-03 3 1  ON 60
ci_0062                -5.280415e-03 3 1  ON 61
ci_0063                -9.118314e-03 3 1  ON 62
ci_0064                -9.078028e-03 3 1  ON 63
ci_0065                -6.883869e-03 3 1  ON 64
ci_0066                -7.109891e-03 3 1  ON 65
ci_0067                -6.285441e-03 3 1  ON 66
ci_0068                -6.734120e-03 3 1  ON 67
ci_0069                 5.463713e-03 3 1  ON 68
ci_0070                 5.767437e-03 3 1  ON 69
ci_0071                 6.201639e-03 3 1  ON 70
ci_0072                 5.918236e-03 3 1  ON 71
ci_0073                 5.917645e-03 3 1  ON 72
ci_0074                 5.406579e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.257892
====================================================
  Execution time = 1.4677e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2101e-01
  Total weights = 1.951519960e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311129912601
                                         uncertainty =       0.002212626704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311129912601
                                         uncertainty =       0.002212626704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394392198
  error estimate for blocks of size 2^( 2) =       0.000408232809
  error estimate for blocks of size 2^( 3) =       0.000422338869
  error estimate for blocks of size 2^( 4) =       0.000434639955
  error estimate for blocks of size 2^( 5) =       0.000445779956
  error estimate for blocks of size 2^( 6) =       0.000453246985
  error estimate for blocks of size 2^( 7) =       0.000458458332

      target function =                  N/A
              le_mean =     -16.903946802295
             les_mean =     286.064423495140
             stat err =       0.000448031307
             autocorr =       1.290506194991
              std dev =       0.557754795659
             le_variance =       0.311090412081


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690394680229e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903946802302       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904166050907       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904198829124       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904208896609       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904208265285       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904208753350       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904208456195       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904208491098       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 4.000922e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903946802302       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904095477896       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904106011548       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904108096324       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904107878686       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 2.170592e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903946802302       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904011794480       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904013271204       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904013452882       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 9.280638e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7333e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 6.997590e-01 3 1  ON 0
ci_0002                 6.997573e-01 3 1  ON 1
ci_0003                -3.285128e-02 3 1  ON 2
ci_0004                -3.206335e-02 3 1  ON 3
ci_0005                -3.596682e-02 3 1  ON 4
ci_0006                -3.687835e-02 3 1  ON 5
ci_0007                -2.531819e-02 3 1  ON 6
ci_0008                -2.539005e-02 3 1  ON 7
ci_0009                -2.069665e-02 3 1  ON 8
ci_0010                -2.009885e-02 3 1  ON 9
ci_0011                -1.557102e-02 3 1  ON 10
ci_0012                -1.630031e-02 3 1  ON 11
ci_0013                 1.681655e-02 3 1  ON 12
ci_0014                 1.677964e-02 3 1  ON 13
ci_0015                 1.666103e-02 3 1  ON 14
ci_0016                 1.657854e-02 3 1  ON 15
ci_0017                 1.434285e-02 3 1  ON 16
ci_0018                 1.447515e-02 3 1  ON 17
ci_0019                 1.230187e-02 3 1  ON 18
ci_0020                 1.244604e-02 3 1  ON 19
ci_0021                 1.043521e-02 3 1  ON 20
ci_0022                 1.045515e-02 3 1  ON 21
ci_0023                -1.218816e-02 3 1  ON 22
ci_0024                -1.075437e-02 3 1  ON 23
ci_0025                -1.225763e-02 3 1  ON 24
ci_0026                -1.202252e-02 3 1  ON 25
ci_0027                -1.141822e-02 3 1  ON 26
ci_0028                -1.102101e-02 3 1  ON 27
ci_0029                -1.063579e-02 3 1  ON 28
ci_0030                -1.053795e-02 3 1  ON 29
ci_0031                 1.914209e-02 3 1  ON 30
ci_0032                 1.871917e-02 3 1  ON 31
ci_0033                 1.132628e-02 3 1  ON 32
ci_0034                 1.220502e-02 3 1  ON 33
ci_0035                 7.056177e-03 3 1  ON 34
ci_0036                 6.615261e-03 3 1  ON 35
ci_0037                -1.042468e-02 3 1  ON 36
ci_0038                -1.098064e-02 3 1  ON 37
ci_0039                -4.200418e-03 3 1  ON 38
ci_0040                -4.417915e-03 3 1  ON 39
ci_0041                 8.920966e-03 3 1  ON 40
ci_0042                 9.465061e-03 3 1  ON 41
ci_0043                -1.323975e-02 3 1  ON 42
ci_0044                -1.422796e-02 3 1  ON 43
ci_0045                 9.131633e-03 3 1  ON 44
ci_0046                 8.930687e-03 3 1  ON 45
ci_0047                -3.467339e-03 3 1  ON 46
ci_0048                -3.844761e-03 3 1  ON 47
ci_0049                -6.138024e-03 3 1  ON 48
ci_0050                -6.915232e-03 3 1  ON 49
ci_0051                -4.567219e-03 3 1  ON 50
ci_0052                -5.090150e-03 3 1  ON 51
ci_0053                -6.333214e-03 3 1  ON 52
ci_0054                -6.336065e-03 3 1  ON 53
ci_0055                 7.499933e-03 3 1  ON 54
ci_0056                 8.516953e-03 3 1  ON 55
ci_0057                 6.901653e-03 3 1  ON 56
ci_0058                 6.993081e-03 3 1  ON 57
ci_0059                -6.336769e-03 3 1  ON 58
ci_0060                -6.328326e-03 3 1  ON 59
ci_0061                -4.172298e-03 3 1  ON 60
ci_0062                -4.803971e-03 3 1  ON 61
ci_0063                -9.279787e-03 3 1  ON 62
ci_0064                -8.596358e-03 3 1  ON 63
ci_0065                -6.871823e-03 3 1  ON 64
ci_0066                -6.431949e-03 3 1  ON 65
ci_0067                -6.172846e-03 3 1  ON 66
ci_0068                -6.082408e-03 3 1  ON 67
ci_0069                 5.490165e-03 3 1  ON 68
ci_0070                 5.591260e-03 3 1  ON 69
ci_0071                 5.347758e-03 3 1  ON 70
ci_0072                 4.985005e-03 3 1  ON 71
ci_0073                 5.304373e-03 3 1  ON 72
ci_0074                 5.634132e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.242
====================================================
  Execution time = 1.4890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2477e-01
  Total weights = 1.9512e+06
  Execution time = 1.8816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318457191481
                                         uncertainty =       0.003372142543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318457191481
                                         uncertainty =       0.003372142543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399014834
  error estimate for blocks of size 2^( 2) =       0.000412687413
  error estimate for blocks of size 2^( 3) =       0.000426038046
  error estimate for blocks of size 2^( 4) =       0.000438121403
  error estimate for blocks of size 2^( 5) =       0.000446793438
  error estimate for blocks of size 2^( 6) =       0.000452260263
  error estimate for blocks of size 2^( 7) =       0.000456115608

      target function =                  N/A
              le_mean =     -16.904075029326
             les_mean =     286.506713340622
             stat err =       0.000448322678
             autocorr =       1.262418451909
              std dev =       0.564292189255
             le_variance =       0.318425674854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311814838691
                                         uncertainty =       0.002269068413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311814838691
                                         uncertainty =       0.002269068413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394834538
  error estimate for blocks of size 2^( 2) =       0.000408806433
  error estimate for blocks of size 2^( 3) =       0.000422413666
  error estimate for blocks of size 2^( 4) =       0.000434663656
  error estimate for blocks of size 2^( 5) =       0.000443512721
  error estimate for blocks of size 2^( 6) =       0.000448927584
  error estimate for blocks of size 2^( 7) =       0.000452315713

      target function =                  N/A
              le_mean =     -16.903981923804
             les_mean =     286.208823329274
             stat err =       0.000444854918
             autocorr =       1.269423467701
              std dev =       0.558380358052
             le_variance =       0.311788624258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.253903475933
                                         uncertainty =       1.932011228899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.253903475933
                                         uncertainty =       1.932011228899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001060582826
  error estimate for blocks of size 2^( 2) =       0.001066247088
  error estimate for blocks of size 2^( 3) =       0.001071793011
  error estimate for blocks of size 2^( 4) =       0.001076254905
  error estimate for blocks of size 2^( 5) =       0.001079953251
  error estimate for blocks of size 2^( 6) =       0.001083075791
  error estimate for blocks of size 2^( 7) =       0.001085461748

      target function =                  N/A
              le_mean =     -16.903106023492
             les_mean =     361.926545608691
             stat err =       0.001081186424
             autocorr =       1.039230744473
              std dev =       1.499890617205
             le_variance =       2.249671863579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899071106
                                         uncertainty =       0.002719011214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899071106
                                         uncertainty =       0.002719011214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396779999
  error estimate for blocks of size 2^( 2) =       0.000410579460
  error estimate for blocks of size 2^( 3) =       0.000424063941
  error estimate for blocks of size 2^( 4) =       0.000436194835
  error estimate for blocks of size 2^( 5) =       0.000444938657
  error estimate for blocks of size 2^( 6) =       0.000450436420
  error estimate for blocks of size 2^( 7) =       0.000453986950

      target function =                  N/A
              le_mean =     -16.903940930456
             les_mean =     286.674178637614
             stat err =       0.000446389216
             autocorr =       1.265691444454
              std dev =       0.561131655364
             le_variance =       0.314868734651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904075029326        initial  <--
     3.9062e-02     3.9062e-01             4.0009e-03       -16.903981923804
     1.5625e-01     1.5625e+00             2.1706e-03       -16.903106023492
     6.2500e-01     6.2500e+00             9.2806e-04       -16.903940930456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.4981
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 6.994874e-01 3 1  ON 0
ci_0002                 6.989748e-01 3 1  ON 1
ci_0003                -3.433705e-02 3 1  ON 2
ci_0004                -3.423394e-02 3 1  ON 3
ci_0005                -3.792194e-02 3 1  ON 4
ci_0006                -3.838293e-02 3 1  ON 5
ci_0007                -2.735542e-02 3 1  ON 6
ci_0008                -2.695876e-02 3 1  ON 7
ci_0009                -2.161280e-02 3 1  ON 8
ci_0010                -2.116163e-02 3 1  ON 9
ci_0011                -1.688855e-02 3 1  ON 10
ci_0012                -1.720102e-02 3 1  ON 11
ci_0013                 1.699655e-02 3 1  ON 12
ci_0014                 1.745289e-02 3 1  ON 13
ci_0015                 1.755543e-02 3 1  ON 14
ci_0016                 1.683206e-02 3 1  ON 15
ci_0017                 1.497539e-02 3 1  ON 16
ci_0018                 1.477709e-02 3 1  ON 17
ci_0019                 1.249198e-02 3 1  ON 18
ci_0020                 1.240877e-02 3 1  ON 19
ci_0021                 1.218705e-02 3 1  ON 20
ci_0022                 1.241665e-02 3 1  ON 21
ci_0023                -1.301760e-02 3 1  ON 22
ci_0024                -1.189565e-02 3 1  ON 23
ci_0025                -1.260978e-02 3 1  ON 24
ci_0026                -1.278933e-02 3 1  ON 25
ci_0027                -1.204663e-02 3 1  ON 26
ci_0028                -1.150338e-02 3 1  ON 27
ci_0029                -1.100037e-02 3 1  ON 28
ci_0030                -1.059695e-02 3 1  ON 29
ci_0031                 1.919906e-02 3 1  ON 30
ci_0032                 1.752723e-02 3 1  ON 31
ci_0033                 1.245900e-02 3 1  ON 32
ci_0034                 1.304490e-02 3 1  ON 33
ci_0035                 8.258058e-03 3 1  ON 34
ci_0036                 7.290123e-03 3 1  ON 35
ci_0037                -1.125236e-02 3 1  ON 36
ci_0038                -1.178683e-02 3 1  ON 37
ci_0039                -5.240484e-03 3 1  ON 38
ci_0040                -4.723379e-03 3 1  ON 39
ci_0041                 8.938090e-03 3 1  ON 40
ci_0042                 9.943993e-03 3 1  ON 41
ci_0043                -1.379288e-02 3 1  ON 42
ci_0044                -1.317694e-02 3 1  ON 43
ci_0045                 9.581776e-03 3 1  ON 44
ci_0046                 1.040781e-02 3 1  ON 45
ci_0047                -4.404338e-03 3 1  ON 46
ci_0048                -4.435182e-03 3 1  ON 47
ci_0049                -7.298912e-03 3 1  ON 48
ci_0050                -7.142938e-03 3 1  ON 49
ci_0051                -5.182289e-03 3 1  ON 50
ci_0052                -5.223172e-03 3 1  ON 51
ci_0053                -6.878470e-03 3 1  ON 52
ci_0054                -7.025601e-03 3 1  ON 53
ci_0055                 7.128292e-03 3 1  ON 54
ci_0056                 9.938133e-03 3 1  ON 55
ci_0057                 6.502354e-03 3 1  ON 56
ci_0058                 7.183464e-03 3 1  ON 57
ci_0059                -7.470759e-03 3 1  ON 58
ci_0060                -6.753026e-03 3 1  ON 59
ci_0061                -5.033106e-03 3 1  ON 60
ci_0062                -5.280415e-03 3 1  ON 61
ci_0063                -9.118314e-03 3 1  ON 62
ci_0064                -9.078028e-03 3 1  ON 63
ci_0065                -6.883869e-03 3 1  ON 64
ci_0066                -7.109891e-03 3 1  ON 65
ci_0067                -6.285441e-03 3 1  ON 66
ci_0068                -6.734120e-03 3 1  ON 67
ci_0069                 5.463713e-03 3 1  ON 68
ci_0070                 5.767437e-03 3 1  ON 69
ci_0071                 6.201639e-03 3 1  ON 70
ci_0072                 5.918236e-03 3 1  ON 71
ci_0073                 5.917645e-03 3 1  ON 72
ci_0074                 5.406579e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1846e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.403769
====================================================
  Execution time = 1.4681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5212e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2264e-01
  Total weights = 1.951532454e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311253076712
                                         uncertainty =       0.002028720769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311253076712
                                         uncertainty =       0.002028720769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394445810
  error estimate for blocks of size 2^( 2) =       0.000408134508
  error estimate for blocks of size 2^( 3) =       0.000422260727
  error estimate for blocks of size 2^( 4) =       0.000435259434
  error estimate for blocks of size 2^( 5) =       0.000447073138
  error estimate for blocks of size 2^( 6) =       0.000456375960
  error estimate for blocks of size 2^( 7) =       0.000460890483

      target function =                  N/A
              le_mean =     -16.904215513664
             les_mean =     286.075146796335
             stat err =       0.000449899754
             autocorr =       1.300938652795
              std dev =       0.557830613828
             le_variance =       0.311174993724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690421551366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904215513656       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904326625686       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904327500487       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904327445302       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.342033e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904215513656       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904252723092       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904253331548       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904253391075       residual = 5.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 4.260155e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904215513656       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904225678822       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904225922902       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904225945304       residual = 9.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 1.142086e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7285e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 6.996310e-01 3 1  ON 0
ci_0002                 6.990336e-01 3 1  ON 1
ci_0003                -3.403064e-02 3 1  ON 2
ci_0004                -3.385430e-02 3 1  ON 3
ci_0005                -3.765558e-02 3 1  ON 4
ci_0006                -3.812604e-02 3 1  ON 5
ci_0007                -2.720756e-02 3 1  ON 6
ci_0008                -2.660554e-02 3 1  ON 7
ci_0009                -2.130815e-02 3 1  ON 8
ci_0010                -2.112996e-02 3 1  ON 9
ci_0011                -1.656356e-02 3 1  ON 10
ci_0012                -1.698487e-02 3 1  ON 11
ci_0013                 1.693564e-02 3 1  ON 12
ci_0014                 1.722402e-02 3 1  ON 13
ci_0015                 1.718987e-02 3 1  ON 14
ci_0016                 1.659896e-02 3 1  ON 15
ci_0017                 1.474998e-02 3 1  ON 16
ci_0018                 1.465346e-02 3 1  ON 17
ci_0019                 1.241402e-02 3 1  ON 18
ci_0020                 1.232494e-02 3 1  ON 19
ci_0021                 1.198900e-02 3 1  ON 20
ci_0022                 1.212865e-02 3 1  ON 21
ci_0023                -1.277852e-02 3 1  ON 22
ci_0024                -1.173623e-02 3 1  ON 23
ci_0025                -1.252393e-02 3 1  ON 24
ci_0026                -1.271301e-02 3 1  ON 25
ci_0027                -1.194611e-02 3 1  ON 26
ci_0028                -1.141202e-02 3 1  ON 27
ci_0029                -1.079329e-02 3 1  ON 28
ci_0030                -1.059502e-02 3 1  ON 29
ci_0031                 1.914203e-02 3 1  ON 30
ci_0032                 1.783789e-02 3 1  ON 31
ci_0033                 1.238075e-02 3 1  ON 32
ci_0034                 1.294309e-02 3 1  ON 33
ci_0035                 8.069837e-03 3 1  ON 34
ci_0036                 7.108349e-03 3 1  ON 35
ci_0037                -1.133202e-02 3 1  ON 36
ci_0038                -1.168128e-02 3 1  ON 37
ci_0039                -5.115284e-03 3 1  ON 38
ci_0040                -4.578592e-03 3 1  ON 39
ci_0041                 8.895028e-03 3 1  ON 40
ci_0042                 9.821238e-03 3 1  ON 41
ci_0043                -1.380222e-02 3 1  ON 42
ci_0044                -1.323626e-02 3 1  ON 43
ci_0045                 9.421805e-03 3 1  ON 44
ci_0046                 1.019558e-02 3 1  ON 45
ci_0047                -4.276737e-03 3 1  ON 46
ci_0048                -4.211396e-03 3 1  ON 47
ci_0049                -7.239598e-03 3 1  ON 48
ci_0050                -7.143181e-03 3 1  ON 49
ci_0051                -5.099227e-03 3 1  ON 50
ci_0052                -5.060531e-03 3 1  ON 51
ci_0053                -6.834098e-03 3 1  ON 52
ci_0054                -6.966664e-03 3 1  ON 53
ci_0055                 7.056350e-03 3 1  ON 54
ci_0056                 9.512117e-03 3 1  ON 55
ci_0057                 6.508879e-03 3 1  ON 56
ci_0058                 7.025489e-03 3 1  ON 57
ci_0059                -7.193245e-03 3 1  ON 58
ci_0060                -6.630935e-03 3 1  ON 59
ci_0061                -4.893015e-03 3 1  ON 60
ci_0062                -5.242581e-03 3 1  ON 61
ci_0063                -9.033955e-03 3 1  ON 62
ci_0064                -8.965847e-03 3 1  ON 63
ci_0065                -6.784023e-03 3 1  ON 64
ci_0066                -6.984312e-03 3 1  ON 65
ci_0067                -6.250207e-03 3 1  ON 66
ci_0068                -6.587629e-03 3 1  ON 67
ci_0069                 5.506783e-03 3 1  ON 68
ci_0070                 5.667409e-03 3 1  ON 69
ci_0071                 5.998202e-03 3 1  ON 70
ci_0072                 5.764797e-03 3 1  ON 71
ci_0073                 5.886912e-03 3 1  ON 72
ci_0074                 5.406598e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.211536
====================================================
  Execution time = 1.4410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2778e-01
  Total weights = 1.9521e+06
  Execution time = 1.8924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313832036614
                                         uncertainty =       0.002227697962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313832036614
                                         uncertainty =       0.002227697962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396108522
  error estimate for blocks of size 2^( 2) =       0.000409904756
  error estimate for blocks of size 2^( 3) =       0.000423867135
  error estimate for blocks of size 2^( 4) =       0.000437156943
  error estimate for blocks of size 2^( 5) =       0.000448445914
  error estimate for blocks of size 2^( 6) =       0.000457130406
  error estimate for blocks of size 2^( 7) =       0.000461897290

      target function =                  N/A
              le_mean =     -16.903829219950
             les_mean =     286.083443825939
             stat err =       0.000451157638
             autocorr =       1.297263672560
              std dev =       0.560182044074
             le_variance =       0.313803922503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312518673111
                                         uncertainty =       0.002219374414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312518673111
                                         uncertainty =       0.002219374414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395277333
  error estimate for blocks of size 2^( 2) =       0.000409147709
  error estimate for blocks of size 2^( 3) =       0.000423210915
  error estimate for blocks of size 2^( 4) =       0.000436567020
  error estimate for blocks of size 2^( 5) =       0.000447900808
  error estimate for blocks of size 2^( 6) =       0.000456636894
  error estimate for blocks of size 2^( 7) =       0.000461488390

      target function =                  N/A
              le_mean =     -16.903843275274
             les_mean =     286.071559116695
             stat err =       0.000450648278
             autocorr =       1.299785266392
              std dev =       0.559006565882
             le_variance =       0.312488340700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312837163060
                                         uncertainty =       0.002220455902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312837163060
                                         uncertainty =       0.002220455902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395479237
  error estimate for blocks of size 2^( 2) =       0.000409328980
  error estimate for blocks of size 2^( 3) =       0.000423363243
  error estimate for blocks of size 2^( 4) =       0.000436703152
  error estimate for blocks of size 2^( 5) =       0.000448029836
  error estimate for blocks of size 2^( 6) =       0.000456743155
  error estimate for blocks of size 2^( 7) =       0.000461564574

      target function =                  N/A
              le_mean =     -16.903834858886
             les_mean =     286.069056343491
             stat err =       0.000450760179
             autocorr =       1.299103376134
              std dev =       0.559292100177
             le_variance =       0.312807653320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313674471526
                                         uncertainty =       0.002226684526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313674471526
                                         uncertainty =       0.002226684526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396008951
  error estimate for blocks of size 2^( 2) =       0.000409811991
  error estimate for blocks of size 2^( 3) =       0.000423787928
  error estimate for blocks of size 2^( 4) =       0.000437084787
  error estimate for blocks of size 2^( 5) =       0.000448377159
  error estimate for blocks of size 2^( 6) =       0.000457066371
  error estimate for blocks of size 2^( 7) =       0.000461837510

      target function =                  N/A
              le_mean =     -16.903825575962
             les_mean =     286.073000240215
             stat err =       0.000451091457
             autocorr =       1.297535349858
              std dev =       0.560041229745
             le_variance =       0.313646179015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903829219950        initial
     3.9062e-01     3.9062e+00             1.3420e-03       -16.903843275274  <--
     1.5625e+00     1.5625e+01             4.2602e-04       -16.903834858886
     6.2500e+00     6.2500e+01             1.1421e-04       -16.903825575962

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.4051e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 6.999500e-01 3 1  ON 0
ci_0002                 6.991186e-01 3 1  ON 1
ci_0003                -3.343162e-02 3 1  ON 2
ci_0004                -3.309975e-02 3 1  ON 3
ci_0005                -3.704616e-02 3 1  ON 4
ci_0006                -3.752979e-02 3 1  ON 5
ci_0007                -2.684521e-02 3 1  ON 6
ci_0008                -2.574640e-02 3 1  ON 7
ci_0009                -2.076862e-02 3 1  ON 8
ci_0010                -2.108589e-02 3 1  ON 9
ci_0011                -1.595568e-02 3 1  ON 10
ci_0012                -1.657828e-02 3 1  ON 11
ci_0013                 1.684798e-02 3 1  ON 12
ci_0014                 1.679241e-02 3 1  ON 13
ci_0015                 1.650460e-02 3 1  ON 14
ci_0016                 1.615513e-02 3 1  ON 15
ci_0017                 1.435862e-02 3 1  ON 16
ci_0018                 1.443674e-02 3 1  ON 17
ci_0019                 1.230370e-02 3 1  ON 18
ci_0020                 1.219788e-02 3 1  ON 19
ci_0021                 1.147591e-02 3 1  ON 20
ci_0022                 1.139685e-02 3 1  ON 21
ci_0023                -1.236231e-02 3 1  ON 22
ci_0024                -1.145841e-02 3 1  ON 23
ci_0025                -1.235750e-02 3 1  ON 24
ci_0026                -1.256794e-02 3 1  ON 25
ci_0027                -1.178660e-02 3 1  ON 26
ci_0028                -1.126388e-02 3 1  ON 27
ci_0029                -1.043553e-02 3 1  ON 28
ci_0030                -1.063005e-02 3 1  ON 29
ci_0031                 1.899645e-02 3 1  ON 30
ci_0032                 1.853513e-02 3 1  ON 31
ci_0033                 1.219571e-02 3 1  ON 32
ci_0034                 1.271308e-02 3 1  ON 33
ci_0035                 7.705380e-03 3 1  ON 34
ci_0036                 6.751064e-03 3 1  ON 35
ci_0037                -1.150875e-02 3 1  ON 36
ci_0038                -1.146518e-02 3 1  ON 37
ci_0039                -4.921989e-03 3 1  ON 38
ci_0040                -4.357364e-03 3 1  ON 39
ci_0041                 8.797746e-03 3 1  ON 40
ci_0042                 9.576406e-03 3 1  ON 41
ci_0043                -1.384297e-02 3 1  ON 42
ci_0044                -1.339128e-02 3 1  ON 43
ci_0045                 9.091112e-03 3 1  ON 44
ci_0046                 9.725044e-03 3 1  ON 45
ci_0047                -4.075555e-03 3 1  ON 46
ci_0048                -3.857425e-03 3 1  ON 47
ci_0049                -7.135965e-03 3 1  ON 48
ci_0050                -7.153467e-03 3 1  ON 49
ci_0051                -4.964139e-03 3 1  ON 50
ci_0052                -4.796611e-03 3 1  ON 51
ci_0053                -6.752250e-03 3 1  ON 52
ci_0054                -6.866194e-03 3 1  ON 53
ci_0055                 6.907169e-03 3 1  ON 54
ci_0056                 8.596100e-03 3 1  ON 55
ci_0057                 6.526805e-03 3 1  ON 56
ci_0058                 6.707873e-03 3 1  ON 57
ci_0059                -6.732363e-03 3 1  ON 58
ci_0060                -6.419060e-03 3 1  ON 59
ci_0061                -4.611966e-03 3 1  ON 60
ci_0062                -5.171292e-03 3 1  ON 61
ci_0063                -8.884533e-03 3 1  ON 62
ci_0064                -8.776146e-03 3 1  ON 63
ci_0065                -6.598935e-03 3 1  ON 64
ci_0066                -6.752896e-03 3 1  ON 65
ci_0067                -6.189160e-03 3 1  ON 66
ci_0068                -6.346326e-03 3 1  ON 67
ci_0069                 5.575883e-03 3 1  ON 68
ci_0070                 5.510858e-03 3 1  ON 69
ci_0071                 5.607062e-03 3 1  ON 70
ci_0072                 5.452384e-03 3 1  ON 71
ci_0073                 5.839301e-03 3 1  ON 72
ci_0074                 5.403175e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8758
    reference variance = 0.570525
====================================================
  Execution time = 1.6712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2604e-01
  Total weights = 1.951521147e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313531745417
                                         uncertainty =       0.002170885885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313531745417
                                         uncertainty =       0.002170885885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395914637
  error estimate for blocks of size 2^( 2) =       0.000409726235
  error estimate for blocks of size 2^( 3) =       0.000423816941
  error estimate for blocks of size 2^( 4) =       0.000436644275
  error estimate for blocks of size 2^( 5) =       0.000446266979
  error estimate for blocks of size 2^( 6) =       0.000452461342
  error estimate for blocks of size 2^( 7) =       0.000458654781

      target function =                  N/A
              le_mean =     -16.904513724788
             les_mean =     286.088621233942
             stat err =       0.000448506844
             autocorr =       1.283320208278
              std dev =       0.559907849288
             le_variance =       0.313496799694


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690451372479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904513724794       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904577838188       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904596583671       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904596174610       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904596447916       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 2.864747e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904513724794       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904545445064       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904548965084       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904548789389       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 1.089577e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904513724794       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904524224696       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904524381694       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904524464900       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 3.116795e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9392e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.001150e-01 3 1  ON 0
ci_0002                 6.993736e-01 3 1  ON 1
ci_0003                -3.257172e-02 3 1  ON 2
ci_0004                -3.257488e-02 3 1  ON 3
ci_0005                -3.631381e-02 3 1  ON 4
ci_0006                -3.712667e-02 3 1  ON 5
ci_0007                -2.591222e-02 3 1  ON 6
ci_0008                -2.485961e-02 3 1  ON 7
ci_0009                -2.063638e-02 3 1  ON 8
ci_0010                -2.068412e-02 3 1  ON 9
ci_0011                -1.564529e-02 3 1  ON 10
ci_0012                -1.584803e-02 3 1  ON 11
ci_0013                 1.629146e-02 3 1  ON 12
ci_0014                 1.639112e-02 3 1  ON 13
ci_0015                 1.613812e-02 3 1  ON 14
ci_0016                 1.604065e-02 3 1  ON 15
ci_0017                 1.437824e-02 3 1  ON 16
ci_0018                 1.456444e-02 3 1  ON 17
ci_0019                 1.217871e-02 3 1  ON 18
ci_0020                 1.215912e-02 3 1  ON 19
ci_0021                 1.067283e-02 3 1  ON 20
ci_0022                 1.030727e-02 3 1  ON 21
ci_0023                -1.245354e-02 3 1  ON 22
ci_0024                -1.127910e-02 3 1  ON 23
ci_0025                -1.243212e-02 3 1  ON 24
ci_0026                -1.195475e-02 3 1  ON 25
ci_0027                -1.167910e-02 3 1  ON 26
ci_0028                -1.093206e-02 3 1  ON 27
ci_0029                -1.033544e-02 3 1  ON 28
ci_0030                -1.056864e-02 3 1  ON 29
ci_0031                 1.870465e-02 3 1  ON 30
ci_0032                 1.868984e-02 3 1  ON 31
ci_0033                 1.187412e-02 3 1  ON 32
ci_0034                 1.190787e-02 3 1  ON 33
ci_0035                 7.267264e-03 3 1  ON 34
ci_0036                 6.460720e-03 3 1  ON 35
ci_0037                -1.154866e-02 3 1  ON 36
ci_0038                -1.113625e-02 3 1  ON 37
ci_0039                -4.325603e-03 3 1  ON 38
ci_0040                -4.361245e-03 3 1  ON 39
ci_0041                 9.068105e-03 3 1  ON 40
ci_0042                 9.279746e-03 3 1  ON 41
ci_0043                -1.361070e-02 3 1  ON 42
ci_0044                -1.361586e-02 3 1  ON 43
ci_0045                 8.683631e-03 3 1  ON 44
ci_0046                 9.557496e-03 3 1  ON 45
ci_0047                -3.890278e-03 3 1  ON 46
ci_0048                -3.422748e-03 3 1  ON 47
ci_0049                -7.172264e-03 3 1  ON 48
ci_0050                -6.621074e-03 3 1  ON 49
ci_0051                -4.915030e-03 3 1  ON 50
ci_0052                -4.691254e-03 3 1  ON 51
ci_0053                -6.575491e-03 3 1  ON 52
ci_0054                -6.289693e-03 3 1  ON 53
ci_0055                 6.975006e-03 3 1  ON 54
ci_0056                 8.446272e-03 3 1  ON 55
ci_0057                 6.280849e-03 3 1  ON 56
ci_0058                 6.054719e-03 3 1  ON 57
ci_0059                -6.364213e-03 3 1  ON 58
ci_0060                -6.317071e-03 3 1  ON 59
ci_0061                -4.422675e-03 3 1  ON 60
ci_0062                -4.831933e-03 3 1  ON 61
ci_0063                -8.993261e-03 3 1  ON 62
ci_0064                -8.820530e-03 3 1  ON 63
ci_0065                -6.505753e-03 3 1  ON 64
ci_0066                -6.808809e-03 3 1  ON 65
ci_0067                -6.207771e-03 3 1  ON 66
ci_0068                -6.180380e-03 3 1  ON 67
ci_0069                 5.311206e-03 3 1  ON 68
ci_0070                 5.468883e-03 3 1  ON 69
ci_0071                 4.970963e-03 3 1  ON 70
ci_0072                 4.939688e-03 3 1  ON 71
ci_0073                 5.602848e-03 3 1  ON 72
ci_0074                 5.189733e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.225663
====================================================
  Execution time = 1.4530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3010e-01
  Total weights = 1.9516e+06
  Execution time = 1.8880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316841291134
                                         uncertainty =       0.002474755658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316841291134
                                         uncertainty =       0.002474755658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398139182
  error estimate for blocks of size 2^( 2) =       0.000412522172
  error estimate for blocks of size 2^( 3) =       0.000426699771
  error estimate for blocks of size 2^( 4) =       0.000439607238
  error estimate for blocks of size 2^( 5) =       0.000450708480
  error estimate for blocks of size 2^( 6) =       0.000457430315
  error estimate for blocks of size 2^( 7) =       0.000461220593

      target function =                  N/A
              le_mean =     -16.904512129367
             les_mean =     286.097046972032
             stat err =       0.000452241656
             autocorr =       1.290242332221
              std dev =       0.563053830678
             le_variance =       0.317029616241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315253408927
                                         uncertainty =       0.002554663386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315253408927
                                         uncertainty =       0.002554663386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397131708
  error estimate for blocks of size 2^( 2) =       0.000411599585
  error estimate for blocks of size 2^( 3) =       0.000425867319
  error estimate for blocks of size 2^( 4) =       0.000438891900
  error estimate for blocks of size 2^( 5) =       0.000450064134
  error estimate for blocks of size 2^( 6) =       0.000456856480
  error estimate for blocks of size 2^( 7) =       0.000460636693

      target function =                  N/A
              le_mean =     -16.904526556509
             les_mean =     286.092849168602
             stat err =       0.000451612302
             autocorr =       1.293190185151
              std dev =       0.561629047171
             le_variance =       0.315427186626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315167539178
                                         uncertainty =       0.002539973069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315167539178
                                         uncertainty =       0.002539973069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397076813
  error estimate for blocks of size 2^( 2) =       0.000411555651
  error estimate for blocks of size 2^( 3) =       0.000425832904
  error estimate for blocks of size 2^( 4) =       0.000438856777
  error estimate for blocks of size 2^( 5) =       0.000450032752
  error estimate for blocks of size 2^( 6) =       0.000456822162
  error estimate for blocks of size 2^( 7) =       0.000460589055

      target function =                  N/A
              le_mean =     -16.904524193692
             les_mean =     286.092509312428
             stat err =       0.000451575187
             autocorr =       1.293335165351
              std dev =       0.561551413562
             le_variance =       0.315339990073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316465660701
                                         uncertainty =       0.002482066617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316465660701
                                         uncertainty =       0.002482066617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397901432
  error estimate for blocks of size 2^( 2) =       0.000412303779
  error estimate for blocks of size 2^( 3) =       0.000426498696
  error estimate for blocks of size 2^( 4) =       0.000439420304
  error estimate for blocks of size 2^( 5) =       0.000450536142
  error estimate for blocks of size 2^( 6) =       0.000457270030
  error estimate for blocks of size 2^( 7) =       0.000461061226

      target function =                  N/A
              le_mean =     -16.904501749699
             les_mean =     286.103382238847
             stat err =       0.000452071926
             autocorr =       1.290815203194
              std dev =       0.562717600949
             le_variance =       0.316651098417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904512129367        initial
     9.7656e-02     9.7656e-01             2.8647e-03       -16.904526556509  <--
     3.9062e-01     3.9062e+00             1.0896e-03       -16.904524193692
     1.5625e+00     1.5625e+01             3.1168e-04       -16.904501749699

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4116e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.002806e-01 3 1  ON 0
ci_0002                 6.997074e-01 3 1  ON 1
ci_0003                -3.169026e-02 3 1  ON 2
ci_0004                -3.201487e-02 3 1  ON 3
ci_0005                -3.525581e-02 3 1  ON 4
ci_0006                -3.650088e-02 3 1  ON 5
ci_0007                -2.443781e-02 3 1  ON 6
ci_0008                -2.344100e-02 3 1  ON 7
ci_0009                -2.053335e-02 3 1  ON 8
ci_0010                -2.037010e-02 3 1  ON 9
ci_0011                -1.537560e-02 3 1  ON 10
ci_0012                -1.515441e-02 3 1  ON 11
ci_0013                 1.578573e-02 3 1  ON 12
ci_0014                 1.604783e-02 3 1  ON 13
ci_0015                 1.581367e-02 3 1  ON 14
ci_0016                 1.595450e-02 3 1  ON 15
ci_0017                 1.440248e-02 3 1  ON 16
ci_0018                 1.470654e-02 3 1  ON 17
ci_0019                 1.212506e-02 3 1  ON 18
ci_0020                 1.219392e-02 3 1  ON 19
ci_0021                 9.309712e-03 3 1  ON 20
ci_0022                 8.532101e-03 3 1  ON 21
ci_0023                -1.256064e-02 3 1  ON 22
ci_0024                -1.116839e-02 3 1  ON 23
ci_0025                -1.246495e-02 3 1  ON 24
ci_0026                -1.139008e-02 3 1  ON 25
ci_0027                -1.164012e-02 3 1  ON 26
ci_0028                -1.067441e-02 3 1  ON 27
ci_0029                -1.031840e-02 3 1  ON 28
ci_0030                -1.057637e-02 3 1  ON 29
ci_0031                 1.825779e-02 3 1  ON 30
ci_0032                 1.885433e-02 3 1  ON 31
ci_0033                 1.143811e-02 3 1  ON 32
ci_0034                 1.081165e-02 3 1  ON 33
ci_0035                 6.835441e-03 3 1  ON 34
ci_0036                 6.208254e-03 3 1  ON 35
ci_0037                -1.159512e-02 3 1  ON 36
ci_0038                -1.076223e-02 3 1  ON 37
ci_0039                -3.960239e-03 3 1  ON 38
ci_0040                -4.369334e-03 3 1  ON 39
ci_0041                 9.278286e-03 3 1  ON 40
ci_0042                 9.016628e-03 3 1  ON 41
ci_0043                -1.324765e-02 3 1  ON 42
ci_0044                -1.390747e-02 3 1  ON 43
ci_0045                 8.197815e-03 3 1  ON 44
ci_0046                 9.345475e-03 3 1  ON 45
ci_0047                -3.774777e-03 3 1  ON 46
ci_0048                -3.146907e-03 3 1  ON 47
ci_0049                -7.229846e-03 3 1  ON 48
ci_0050                -6.146193e-03 3 1  ON 49
ci_0051                -4.890454e-03 3 1  ON 50
ci_0052                -4.624434e-03 3 1  ON 51
ci_0053                -6.433293e-03 3 1  ON 52
ci_0054                -5.869332e-03 3 1  ON 53
ci_0055                 7.045383e-03 3 1  ON 54
ci_0056                 8.273409e-03 3 1  ON 55
ci_0057                 6.029950e-03 3 1  ON 56
ci_0058                 5.378669e-03 3 1  ON 57
ci_0059                -6.100928e-03 3 1  ON 58
ci_0060                -6.234066e-03 3 1  ON 59
ci_0061                -4.245551e-03 3 1  ON 60
ci_0062                -4.514298e-03 3 1  ON 61
ci_0063                -9.087829e-03 3 1  ON 62
ci_0064                -8.853778e-03 3 1  ON 63
ci_0065                -6.417706e-03 3 1  ON 64
ci_0066                -6.856038e-03 3 1  ON 65
ci_0067                -6.209669e-03 3 1  ON 66
ci_0068                -6.064618e-03 3 1  ON 67
ci_0069                 5.126272e-03 3 1  ON 68
ci_0070                 5.451977e-03 3 1  ON 69
ci_0071                 4.353792e-03 3 1  ON 70
ci_0072                 4.435420e-03 3 1  ON 71
ci_0073                 5.444835e-03 3 1  ON 72
ci_0074                 5.051845e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.995
    reference variance = 0.482443
====================================================
  Execution time = 1.4725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2881e-01
  Total weights = 1.951622218e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313767842921
                                         uncertainty =       0.003168462303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313767842921
                                         uncertainty =       0.003168462303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396108866
  error estimate for blocks of size 2^( 2) =       0.000410712793
  error estimate for blocks of size 2^( 3) =       0.000424700354
  error estimate for blocks of size 2^( 4) =       0.000437463325
  error estimate for blocks of size 2^( 5) =       0.000449480018
  error estimate for blocks of size 2^( 6) =       0.000455920136
  error estimate for blocks of size 2^( 7) =       0.000460039107

      target function =                  N/A
              le_mean =     -16.904490931345
             les_mean =     286.090624855210
             stat err =       0.000450725646
             autocorr =       1.294778306928
              std dev =       0.560182530083
             le_variance =       0.313804467010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690449093135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904490931371       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904525174343       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904533316983       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904534669910       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904534604961       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904534693211       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904534618918       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904534585800       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 2.812301e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904490931371       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904516874478       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904520378348       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904520758268       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904520754059       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.893895e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904490931371       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904504103587       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904504174319       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904504208303       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 8.144763e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7413e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.002968e-01 3 1  ON 0
ci_0002                 7.000359e-01 3 1  ON 1
ci_0003                -3.097170e-02 3 1  ON 2
ci_0004                -3.057415e-02 3 1  ON 3
ci_0005                -3.437280e-02 3 1  ON 4
ci_0006                -3.460699e-02 3 1  ON 5
ci_0007                -2.384538e-02 3 1  ON 6
ci_0008                -2.321713e-02 3 1  ON 7
ci_0009                -2.070987e-02 3 1  ON 8
ci_0010                -2.044860e-02 3 1  ON 9
ci_0011                -1.518520e-02 3 1  ON 10
ci_0012                -1.489268e-02 3 1  ON 11
ci_0013                 1.645955e-02 3 1  ON 12
ci_0014                 1.585941e-02 3 1  ON 13
ci_0015                 1.525720e-02 3 1  ON 14
ci_0016                 1.556995e-02 3 1  ON 15
ci_0017                 1.434391e-02 3 1  ON 16
ci_0018                 1.402024e-02 3 1  ON 17
ci_0019                 1.170755e-02 3 1  ON 18
ci_0020                 1.242655e-02 3 1  ON 19
ci_0021                 8.792717e-03 3 1  ON 20
ci_0022                 7.814265e-03 3 1  ON 21
ci_0023                -1.253485e-02 3 1  ON 22
ci_0024                -1.114634e-02 3 1  ON 23
ci_0025                -1.175730e-02 3 1  ON 24
ci_0026                -1.179980e-02 3 1  ON 25
ci_0027                -1.209425e-02 3 1  ON 26
ci_0028                -1.092866e-02 3 1  ON 27
ci_0029                -1.004692e-02 3 1  ON 28
ci_0030                -9.500900e-03 3 1  ON 29
ci_0031                 1.974801e-02 3 1  ON 30
ci_0032                 1.967967e-02 3 1  ON 31
ci_0033                 1.153249e-02 3 1  ON 32
ci_0034                 8.995108e-03 3 1  ON 33
ci_0035                 6.383093e-03 3 1  ON 34
ci_0036                 6.278807e-03 3 1  ON 35
ci_0037                -1.161383e-02 3 1  ON 36
ci_0038                -1.104758e-02 3 1  ON 37
ci_0039                -4.053953e-03 3 1  ON 38
ci_0040                -4.558432e-03 3 1  ON 39
ci_0041                 8.036416e-03 3 1  ON 40
ci_0042                 8.500926e-03 3 1  ON 41
ci_0043                -1.354654e-02 3 1  ON 42
ci_0044                -1.298962e-02 3 1  ON 43
ci_0045                 8.378407e-03 3 1  ON 44
ci_0046                 8.778056e-03 3 1  ON 45
ci_0047                -3.656500e-03 3 1  ON 46
ci_0048                -3.416115e-03 3 1  ON 47
ci_0049                -7.136044e-03 3 1  ON 48
ci_0050                -6.584139e-03 3 1  ON 49
ci_0051                -5.150746e-03 3 1  ON 50
ci_0052                -4.842547e-03 3 1  ON 51
ci_0053                -6.268121e-03 3 1  ON 52
ci_0054                -6.482453e-03 3 1  ON 53
ci_0055                 6.713049e-03 3 1  ON 54
ci_0056                 7.950870e-03 3 1  ON 55
ci_0057                 4.923872e-03 3 1  ON 56
ci_0058                 5.642196e-03 3 1  ON 57
ci_0059                -5.763209e-03 3 1  ON 58
ci_0060                -6.199756e-03 3 1  ON 59
ci_0061                -4.855443e-03 3 1  ON 60
ci_0062                -4.591494e-03 3 1  ON 61
ci_0063                -9.350455e-03 3 1  ON 62
ci_0064                -8.562066e-03 3 1  ON 63
ci_0065                -6.439807e-03 3 1  ON 64
ci_0066                -6.411960e-03 3 1  ON 65
ci_0067                -5.937144e-03 3 1  ON 66
ci_0068                -6.613966e-03 3 1  ON 67
ci_0069                 5.505381e-03 3 1  ON 68
ci_0070                 5.657121e-03 3 1  ON 69
ci_0071                 4.158152e-03 3 1  ON 70
ci_0072                 4.750032e-03 3 1  ON 71
ci_0073                 4.542268e-03 3 1  ON 72
ci_0074                 4.971090e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8232
    reference variance = 0.231652
====================================================
  Execution time = 1.4382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2478e-01
  Total weights = 1.9518e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315490661080
                                         uncertainty =       0.003064208060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315490661080
                                         uncertainty =       0.003064208060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397174982
  error estimate for blocks of size 2^( 2) =       0.000411361417
  error estimate for blocks of size 2^( 3) =       0.000425800854
  error estimate for blocks of size 2^( 4) =       0.000439180647
  error estimate for blocks of size 2^( 5) =       0.000450668526
  error estimate for blocks of size 2^( 6) =       0.000459433319
  error estimate for blocks of size 2^( 7) =       0.000464870459

      target function =                  N/A
              le_mean =     -16.903992281050
             les_mean =     286.223423375219
             stat err =       0.000453538238
             autocorr =       1.303959331740
              std dev =       0.561690246843
             le_variance =       0.315495933399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313574872430
                                         uncertainty =       0.002664005461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313574872430
                                         uncertainty =       0.002664005461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395969401
  error estimate for blocks of size 2^( 2) =       0.000410199980
  error estimate for blocks of size 2^( 3) =       0.000424728554
  error estimate for blocks of size 2^( 4) =       0.000438173985
  error estimate for blocks of size 2^( 5) =       0.000449601877
  error estimate for blocks of size 2^( 6) =       0.000458314570
  error estimate for blocks of size 2^( 7) =       0.000463764418

      target function =                  N/A
              le_mean =     -16.903979407339
             les_mean =     286.071304781218
             stat err =       0.000452463712
             autocorr =       1.305702559546
              std dev =       0.559985297443
             le_variance =       0.313583533352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060873072
                                         uncertainty =       0.002656518014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060873072
                                         uncertainty =       0.002656518014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396275873
  error estimate for blocks of size 2^( 2) =       0.000410523683
  error estimate for blocks of size 2^( 3) =       0.000425093312
  error estimate for blocks of size 2^( 4) =       0.000438549908
  error estimate for blocks of size 2^( 5) =       0.000449977206
  error estimate for blocks of size 2^( 6) =       0.000458665903
  error estimate for blocks of size 2^( 7) =       0.000464153369

      target function =                  N/A
              le_mean =     -16.904005971245
             les_mean =     286.107167682374
             stat err =       0.000452836597
             autocorr =       1.305833400508
              std dev =       0.560418714068
             le_variance =       0.314069135078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313769676960
                                         uncertainty =       0.002697042056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313769676960
                                         uncertainty =       0.002697042056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396092130
  error estimate for blocks of size 2^( 2) =       0.000410312299
  error estimate for blocks of size 2^( 3) =       0.000424812472
  error estimate for blocks of size 2^( 4) =       0.000438235480
  error estimate for blocks of size 2^( 5) =       0.000449668622
  error estimate for blocks of size 2^( 6) =       0.000458389957
  error estimate for blocks of size 2^( 7) =       0.000463878731

      target function =                  N/A
              le_mean =     -16.903975590516
             les_mean =     286.070373104422
             stat err =       0.000452543197
             autocorr =       1.305352048211
              std dev =       0.560158862372
             le_variance =       0.313777951094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903992281050        initial
     2.4414e-02     2.4414e-01             2.8123e-03       -16.903979407339
     9.7656e-02     9.7656e-01             1.8939e-03       -16.904005971245  <--
     3.9062e-01     3.9062e+00             8.1448e-04       -16.903975590516

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.4018e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.002968e-01 3 1  ON 0
ci_0002                 7.000359e-01 3 1  ON 1
ci_0003                -3.097170e-02 3 1  ON 2
ci_0004                -3.057415e-02 3 1  ON 3
ci_0005                -3.437280e-02 3 1  ON 4
ci_0006                -3.460699e-02 3 1  ON 5
ci_0007                -2.384538e-02 3 1  ON 6
ci_0008                -2.321713e-02 3 1  ON 7
ci_0009                -2.070987e-02 3 1  ON 8
ci_0010                -2.044860e-02 3 1  ON 9
ci_0011                -1.518520e-02 3 1  ON 10
ci_0012                -1.489268e-02 3 1  ON 11
ci_0013                 1.645955e-02 3 1  ON 12
ci_0014                 1.585941e-02 3 1  ON 13
ci_0015                 1.525720e-02 3 1  ON 14
ci_0016                 1.556995e-02 3 1  ON 15
ci_0017                 1.434391e-02 3 1  ON 16
ci_0018                 1.402024e-02 3 1  ON 17
ci_0019                 1.170755e-02 3 1  ON 18
ci_0020                 1.242655e-02 3 1  ON 19
ci_0021                 8.792717e-03 3 1  ON 20
ci_0022                 7.814265e-03 3 1  ON 21
ci_0023                -1.253485e-02 3 1  ON 22
ci_0024                -1.114634e-02 3 1  ON 23
ci_0025                -1.175730e-02 3 1  ON 24
ci_0026                -1.179980e-02 3 1  ON 25
ci_0027                -1.209425e-02 3 1  ON 26
ci_0028                -1.092866e-02 3 1  ON 27
ci_0029                -1.004692e-02 3 1  ON 28
ci_0030                -9.500900e-03 3 1  ON 29
ci_0031                 1.974801e-02 3 1  ON 30
ci_0032                 1.967967e-02 3 1  ON 31
ci_0033                 1.153249e-02 3 1  ON 32
ci_0034                 8.995108e-03 3 1  ON 33
ci_0035                 6.383093e-03 3 1  ON 34
ci_0036                 6.278807e-03 3 1  ON 35
ci_0037                -1.161383e-02 3 1  ON 36
ci_0038                -1.104758e-02 3 1  ON 37
ci_0039                -4.053953e-03 3 1  ON 38
ci_0040                -4.558432e-03 3 1  ON 39
ci_0041                 8.036416e-03 3 1  ON 40
ci_0042                 8.500926e-03 3 1  ON 41
ci_0043                -1.354654e-02 3 1  ON 42
ci_0044                -1.298962e-02 3 1  ON 43
ci_0045                 8.378407e-03 3 1  ON 44
ci_0046                 8.778056e-03 3 1  ON 45
ci_0047                -3.656500e-03 3 1  ON 46
ci_0048                -3.416115e-03 3 1  ON 47
ci_0049                -7.136044e-03 3 1  ON 48
ci_0050                -6.584139e-03 3 1  ON 49
ci_0051                -5.150746e-03 3 1  ON 50
ci_0052                -4.842547e-03 3 1  ON 51
ci_0053                -6.268121e-03 3 1  ON 52
ci_0054                -6.482453e-03 3 1  ON 53
ci_0055                 6.713049e-03 3 1  ON 54
ci_0056                 7.950870e-03 3 1  ON 55
ci_0057                 4.923872e-03 3 1  ON 56
ci_0058                 5.642196e-03 3 1  ON 57
ci_0059                -5.763209e-03 3 1  ON 58
ci_0060                -6.199756e-03 3 1  ON 59
ci_0061                -4.855443e-03 3 1  ON 60
ci_0062                -4.591494e-03 3 1  ON 61
ci_0063                -9.350455e-03 3 1  ON 62
ci_0064                -8.562066e-03 3 1  ON 63
ci_0065                -6.439807e-03 3 1  ON 64
ci_0066                -6.411960e-03 3 1  ON 65
ci_0067                -5.937144e-03 3 1  ON 66
ci_0068                -6.613966e-03 3 1  ON 67
ci_0069                 5.505381e-03 3 1  ON 68
ci_0070                 5.657121e-03 3 1  ON 69
ci_0071                 4.158152e-03 3 1  ON 70
ci_0072                 4.750032e-03 3 1  ON 71
ci_0073                 4.542268e-03 3 1  ON 72
ci_0074                 4.971090e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9001
    reference variance = 0.126908
====================================================
  Execution time = 1.4820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5217e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2384e-01
  Total weights = 1.951738197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313087844124
                                         uncertainty =       0.002510826678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313087844124
                                         uncertainty =       0.002510826678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395667092
  error estimate for blocks of size 2^( 2) =       0.000409608150
  error estimate for blocks of size 2^( 3) =       0.000423965181
  error estimate for blocks of size 2^( 4) =       0.000436846773
  error estimate for blocks of size 2^( 5) =       0.000447391537
  error estimate for blocks of size 2^( 6) =       0.000456581039
  error estimate for blocks of size 2^( 7) =       0.000460485600

      target function =                  N/A
              le_mean =     -16.904246752440
             les_mean =     286.077395851798
             stat err =       0.000450326237
             autocorr =       1.295372400617
              std dev =       0.559557767671
             le_variance =       0.313104895361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690424675244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904246752473       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904262553964       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904264531314       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904265349590       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904265466728       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904265785138       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904265924938       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904265609016       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-02 is 1.345165e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904246752473       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904259093402       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904260445330       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904260811664       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904260763066       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.038193e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904246752473       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904253330754       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904254015047       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904254047842       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 5.538812e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7499e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.002890e-01 3 1  ON 0
ci_0002                 7.001425e-01 3 1  ON 1
ci_0003                -3.062915e-02 3 1  ON 2
ci_0004                -3.074926e-02 3 1  ON 3
ci_0005                -3.360400e-02 3 1  ON 4
ci_0006                -3.452084e-02 3 1  ON 5
ci_0007                -2.361145e-02 3 1  ON 6
ci_0008                -2.291967e-02 3 1  ON 7
ci_0009                -2.019454e-02 3 1  ON 8
ci_0010                -2.022148e-02 3 1  ON 9
ci_0011                -1.565832e-02 3 1  ON 10
ci_0012                -1.528498e-02 3 1  ON 11
ci_0013                 1.595316e-02 3 1  ON 12
ci_0014                 1.591259e-02 3 1  ON 13
ci_0015                 1.565716e-02 3 1  ON 14
ci_0016                 1.573817e-02 3 1  ON 15
ci_0017                 1.330572e-02 3 1  ON 16
ci_0018                 1.401109e-02 3 1  ON 17
ci_0019                 1.171907e-02 3 1  ON 18
ci_0020                 1.177910e-02 3 1  ON 19
ci_0021                 9.064437e-03 3 1  ON 20
ci_0022                 7.412226e-03 3 1  ON 21
ci_0023                -1.243432e-02 3 1  ON 22
ci_0024                -1.145872e-02 3 1  ON 23
ci_0025                -1.171150e-02 3 1  ON 24
ci_0026                -1.228191e-02 3 1  ON 25
ci_0027                -1.183038e-02 3 1  ON 26
ci_0028                -1.137409e-02 3 1  ON 27
ci_0029                -9.530072e-03 3 1  ON 28
ci_0030                -1.016602e-02 3 1  ON 29
ci_0031                 1.970077e-02 3 1  ON 30
ci_0032                 1.992542e-02 3 1  ON 31
ci_0033                 1.207968e-02 3 1  ON 32
ci_0034                 9.498611e-03 3 1  ON 33
ci_0035                 5.955684e-03 3 1  ON 34
ci_0036                 7.025650e-03 3 1  ON 35
ci_0037                -1.143120e-02 3 1  ON 36
ci_0038                -1.080483e-02 3 1  ON 37
ci_0039                -4.179690e-03 3 1  ON 38
ci_0040                -4.111032e-03 3 1  ON 39
ci_0041                 8.172739e-03 3 1  ON 40
ci_0042                 7.762378e-03 3 1  ON 41
ci_0043                -1.385160e-02 3 1  ON 42
ci_0044                -1.368522e-02 3 1  ON 43
ci_0045                 7.616082e-03 3 1  ON 44
ci_0046                 8.020395e-03 3 1  ON 45
ci_0047                -3.477182e-03 3 1  ON 46
ci_0048                -3.364277e-03 3 1  ON 47
ci_0049                -7.381783e-03 3 1  ON 48
ci_0050                -6.159618e-03 3 1  ON 49
ci_0051                -4.854777e-03 3 1  ON 50
ci_0052                -4.770431e-03 3 1  ON 51
ci_0053                -6.914877e-03 3 1  ON 52
ci_0054                -6.510747e-03 3 1  ON 53
ci_0055                 7.106354e-03 3 1  ON 54
ci_0056                 7.610691e-03 3 1  ON 55
ci_0057                 4.808665e-03 3 1  ON 56
ci_0058                 5.423716e-03 3 1  ON 57
ci_0059                -5.827172e-03 3 1  ON 58
ci_0060                -5.346250e-03 3 1  ON 59
ci_0061                -3.850713e-03 3 1  ON 60
ci_0062                -4.061177e-03 3 1  ON 61
ci_0063                -8.597518e-03 3 1  ON 62
ci_0064                -8.810616e-03 3 1  ON 63
ci_0065                -7.057042e-03 3 1  ON 64
ci_0066                -6.582823e-03 3 1  ON 65
ci_0067                -6.347683e-03 3 1  ON 66
ci_0068                -5.946520e-03 3 1  ON 67
ci_0069                 5.292599e-03 3 1  ON 68
ci_0070                 5.418315e-03 3 1  ON 69
ci_0071                 4.423961e-03 3 1  ON 70
ci_0072                 4.774989e-03 3 1  ON 71
ci_0073                 4.964466e-03 3 1  ON 72
ci_0074                 5.386500e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8937
    reference variance = 0.325859
====================================================
  Execution time = 1.4373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3444e-01
  Total weights = 1.9517e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322352739282
                                         uncertainty =       0.003519164125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322352739282
                                         uncertainty =       0.003519164125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401410419
  error estimate for blocks of size 2^( 2) =       0.000415473045
  error estimate for blocks of size 2^( 3) =       0.000429772919
  error estimate for blocks of size 2^( 4) =       0.000443315629
  error estimate for blocks of size 2^( 5) =       0.000455696299
  error estimate for blocks of size 2^( 6) =       0.000461549481
  error estimate for blocks of size 2^( 7) =       0.000468962405

      target function =                  N/A
              le_mean =     -16.904598389651
             les_mean =     286.107080403956
             stat err =       0.000457380953
             autocorr =       1.298311395328
              std dev =       0.567680058891
             le_variance =       0.322260649262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322140019228
                                         uncertainty =       0.003533360589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322140019228
                                         uncertainty =       0.003533360589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401275912
  error estimate for blocks of size 2^( 2) =       0.000415367565
  error estimate for blocks of size 2^( 3) =       0.000429699894
  error estimate for blocks of size 2^( 4) =       0.000443222873
  error estimate for blocks of size 2^( 5) =       0.000455613327
  error estimate for blocks of size 2^( 6) =       0.000461514659
  error estimate for blocks of size 2^( 7) =       0.000468972663

      target function =                  N/A
              le_mean =     -16.904560169497
             les_mean =     286.216566849465
             stat err =       0.000457330880
             autocorr =       1.298897480832
              std dev =       0.567489836348
             le_variance =       0.322044714358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322384570658
                                         uncertainty =       0.003534879410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322384570658
                                         uncertainty =       0.003534879410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401427025
  error estimate for blocks of size 2^( 2) =       0.000415530173
  error estimate for blocks of size 2^( 3) =       0.000429869431
  error estimate for blocks of size 2^( 4) =       0.000443381390
  error estimate for blocks of size 2^( 5) =       0.000455759404
  error estimate for blocks of size 2^( 6) =       0.000461665769
  error estimate for blocks of size 2^( 7) =       0.000469183573

      target function =                  N/A
              le_mean =     -16.904574277125
             les_mean =     286.156271761535
             stat err =       0.000457497534
             autocorr =       1.298865858806
              std dev =       0.567703543171
             le_variance =       0.322287312929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322114929582
                                         uncertainty =       0.003514157425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322114929582
                                         uncertainty =       0.003514157425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401261542
  error estimate for blocks of size 2^( 2) =       0.000415340336
  error estimate for blocks of size 2^( 3) =       0.000429658936
  error estimate for blocks of size 2^( 4) =       0.000443198211
  error estimate for blocks of size 2^( 5) =       0.000455590948
  error estimate for blocks of size 2^( 6) =       0.000461486836
  error estimate for blocks of size 2^( 7) =       0.000468893751

      target function =                  N/A
              le_mean =     -16.904572682416
             les_mean =     286.099681969647
             stat err =       0.000457292436
             autocorr =       1.298772128089
              std dev =       0.567469515278
             le_variance =       0.322021650770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904598389651        initial  <--
     2.4414e-02     2.4414e-01             1.3452e-03       -16.904560169497
     9.7656e-02     9.7656e-01             1.0382e-03       -16.904574277125
     3.9062e-01     3.9062e+00             5.5388e-04       -16.904572682416

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9608
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.002968e-01 3 1  ON 0
ci_0002                 7.000359e-01 3 1  ON 1
ci_0003                -3.097170e-02 3 1  ON 2
ci_0004                -3.057415e-02 3 1  ON 3
ci_0005                -3.437280e-02 3 1  ON 4
ci_0006                -3.460699e-02 3 1  ON 5
ci_0007                -2.384538e-02 3 1  ON 6
ci_0008                -2.321713e-02 3 1  ON 7
ci_0009                -2.070987e-02 3 1  ON 8
ci_0010                -2.044860e-02 3 1  ON 9
ci_0011                -1.518520e-02 3 1  ON 10
ci_0012                -1.489268e-02 3 1  ON 11
ci_0013                 1.645955e-02 3 1  ON 12
ci_0014                 1.585941e-02 3 1  ON 13
ci_0015                 1.525720e-02 3 1  ON 14
ci_0016                 1.556995e-02 3 1  ON 15
ci_0017                 1.434391e-02 3 1  ON 16
ci_0018                 1.402024e-02 3 1  ON 17
ci_0019                 1.170755e-02 3 1  ON 18
ci_0020                 1.242655e-02 3 1  ON 19
ci_0021                 8.792717e-03 3 1  ON 20
ci_0022                 7.814265e-03 3 1  ON 21
ci_0023                -1.253485e-02 3 1  ON 22
ci_0024                -1.114634e-02 3 1  ON 23
ci_0025                -1.175730e-02 3 1  ON 24
ci_0026                -1.179980e-02 3 1  ON 25
ci_0027                -1.209425e-02 3 1  ON 26
ci_0028                -1.092866e-02 3 1  ON 27
ci_0029                -1.004692e-02 3 1  ON 28
ci_0030                -9.500900e-03 3 1  ON 29
ci_0031                 1.974801e-02 3 1  ON 30
ci_0032                 1.967967e-02 3 1  ON 31
ci_0033                 1.153249e-02 3 1  ON 32
ci_0034                 8.995108e-03 3 1  ON 33
ci_0035                 6.383093e-03 3 1  ON 34
ci_0036                 6.278807e-03 3 1  ON 35
ci_0037                -1.161383e-02 3 1  ON 36
ci_0038                -1.104758e-02 3 1  ON 37
ci_0039                -4.053953e-03 3 1  ON 38
ci_0040                -4.558432e-03 3 1  ON 39
ci_0041                 8.036416e-03 3 1  ON 40
ci_0042                 8.500926e-03 3 1  ON 41
ci_0043                -1.354654e-02 3 1  ON 42
ci_0044                -1.298962e-02 3 1  ON 43
ci_0045                 8.378407e-03 3 1  ON 44
ci_0046                 8.778056e-03 3 1  ON 45
ci_0047                -3.656500e-03 3 1  ON 46
ci_0048                -3.416115e-03 3 1  ON 47
ci_0049                -7.136044e-03 3 1  ON 48
ci_0050                -6.584139e-03 3 1  ON 49
ci_0051                -5.150746e-03 3 1  ON 50
ci_0052                -4.842547e-03 3 1  ON 51
ci_0053                -6.268121e-03 3 1  ON 52
ci_0054                -6.482453e-03 3 1  ON 53
ci_0055                 6.713049e-03 3 1  ON 54
ci_0056                 7.950870e-03 3 1  ON 55
ci_0057                 4.923872e-03 3 1  ON 56
ci_0058                 5.642196e-03 3 1  ON 57
ci_0059                -5.763209e-03 3 1  ON 58
ci_0060                -6.199756e-03 3 1  ON 59
ci_0061                -4.855443e-03 3 1  ON 60
ci_0062                -4.591494e-03 3 1  ON 61
ci_0063                -9.350455e-03 3 1  ON 62
ci_0064                -8.562066e-03 3 1  ON 63
ci_0065                -6.439807e-03 3 1  ON 64
ci_0066                -6.411960e-03 3 1  ON 65
ci_0067                -5.937144e-03 3 1  ON 66
ci_0068                -6.613966e-03 3 1  ON 67
ci_0069                 5.505381e-03 3 1  ON 68
ci_0070                 5.657121e-03 3 1  ON 69
ci_0071                 4.158152e-03 3 1  ON 70
ci_0072                 4.750032e-03 3 1  ON 71
ci_0073                 4.542268e-03 3 1  ON 72
ci_0074                 4.971090e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.172416
====================================================
  Execution time = 1.4695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2564e-01
  Total weights = 1.952071290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314536140671
                                         uncertainty =       0.002010824011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314536140671
                                         uncertainty =       0.002010824011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396593200
  error estimate for blocks of size 2^( 2) =       0.000410942381
  error estimate for blocks of size 2^( 3) =       0.000424834695
  error estimate for blocks of size 2^( 4) =       0.000437913330
  error estimate for blocks of size 2^( 5) =       0.000449189435
  error estimate for blocks of size 2^( 6) =       0.000458029441
  error estimate for blocks of size 2^( 7) =       0.000468144328

      target function =                  N/A
              le_mean =     -16.903837617712
             les_mean =     286.065366170999
             stat err =       0.000453319134
             autocorr =       1.306524544011
              std dev =       0.560867482533
             le_variance =       0.314572332962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690383761771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903837617681       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903851709101       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903853225681       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903853018112       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 7.222953e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903837617681       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903843086155       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903843335425       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 2.706020e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903837617681       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903839203795       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903839240321       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 7.795529e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7370e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.002815e-01 3 1  ON 0
ci_0002                 7.000981e-01 3 1  ON 1
ci_0003                -3.080552e-02 3 1  ON 2
ci_0004                -3.052463e-02 3 1  ON 3
ci_0005                -3.439659e-02 3 1  ON 4
ci_0006                -3.454665e-02 3 1  ON 5
ci_0007                -2.368373e-02 3 1  ON 6
ci_0008                -2.313380e-02 3 1  ON 7
ci_0009                -2.050710e-02 3 1  ON 8
ci_0010                -2.028637e-02 3 1  ON 9
ci_0011                -1.526244e-02 3 1  ON 10
ci_0012                -1.498730e-02 3 1  ON 11
ci_0013                 1.629082e-02 3 1  ON 12
ci_0014                 1.580517e-02 3 1  ON 13
ci_0015                 1.540813e-02 3 1  ON 14
ci_0016                 1.560665e-02 3 1  ON 15
ci_0017                 1.431718e-02 3 1  ON 16
ci_0018                 1.396623e-02 3 1  ON 17
ci_0019                 1.166725e-02 3 1  ON 18
ci_0020                 1.238251e-02 3 1  ON 19
ci_0021                 8.702473e-03 3 1  ON 20
ci_0022                 7.837048e-03 3 1  ON 21
ci_0023                -1.255518e-02 3 1  ON 22
ci_0024                -1.126250e-02 3 1  ON 23
ci_0025                -1.165314e-02 3 1  ON 24
ci_0026                -1.153152e-02 3 1  ON 25
ci_0027                -1.186144e-02 3 1  ON 26
ci_0028                -1.096355e-02 3 1  ON 27
ci_0029                -1.011300e-02 3 1  ON 28
ci_0030                -9.695659e-03 3 1  ON 29
ci_0031                 1.959866e-02 3 1  ON 30
ci_0032                 1.957198e-02 3 1  ON 31
ci_0033                 1.163784e-02 3 1  ON 32
ci_0034                 8.995628e-03 3 1  ON 33
ci_0035                 6.498914e-03 3 1  ON 34
ci_0036                 6.272772e-03 3 1  ON 35
ci_0037                -1.151521e-02 3 1  ON 36
ci_0038                -1.112972e-02 3 1  ON 37
ci_0039                -4.119093e-03 3 1  ON 38
ci_0040                -4.358236e-03 3 1  ON 39
ci_0041                 8.157209e-03 3 1  ON 40
ci_0042                 8.327688e-03 3 1  ON 41
ci_0043                -1.371594e-02 3 1  ON 42
ci_0044                -1.312183e-02 3 1  ON 43
ci_0045                 8.527629e-03 3 1  ON 44
ci_0046                 8.739648e-03 3 1  ON 45
ci_0047                -3.523172e-03 3 1  ON 46
ci_0048                -3.263787e-03 3 1  ON 47
ci_0049                -7.124105e-03 3 1  ON 48
ci_0050                -6.543957e-03 3 1  ON 49
ci_0051                -5.041651e-03 3 1  ON 50
ci_0052                -4.779507e-03 3 1  ON 51
ci_0053                -6.264338e-03 3 1  ON 52
ci_0054                -6.462875e-03 3 1  ON 53
ci_0055                 6.708515e-03 3 1  ON 54
ci_0056                 7.761945e-03 3 1  ON 55
ci_0057                 4.845584e-03 3 1  ON 56
ci_0058                 5.645758e-03 3 1  ON 57
ci_0059                -5.818892e-03 3 1  ON 58
ci_0060                -6.153538e-03 3 1  ON 59
ci_0061                -4.584841e-03 3 1  ON 60
ci_0062                -4.405974e-03 3 1  ON 61
ci_0063                -9.423628e-03 3 1  ON 62
ci_0064                -8.576842e-03 3 1  ON 63
ci_0065                -6.353139e-03 3 1  ON 64
ci_0066                -6.355264e-03 3 1  ON 65
ci_0067                -5.757631e-03 3 1  ON 66
ci_0068                -6.523089e-03 3 1  ON 67
ci_0069                 5.472820e-03 3 1  ON 68
ci_0070                 5.563327e-03 3 1  ON 69
ci_0071                 4.251082e-03 3 1  ON 70
ci_0072                 4.564752e-03 3 1  ON 71
ci_0073                 4.637362e-03 3 1  ON 72
ci_0074                 5.112994e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.253211
====================================================
  Execution time = 1.4525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2447e-01
  Total weights = 1.9514e+06
  Execution time = 1.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313036427718
                                         uncertainty =       0.002046555696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313036427718
                                         uncertainty =       0.002046555696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395623118
  error estimate for blocks of size 2^( 2) =       0.000409553295
  error estimate for blocks of size 2^( 3) =       0.000423584648
  error estimate for blocks of size 2^( 4) =       0.000435813223
  error estimate for blocks of size 2^( 5) =       0.000446256841
  error estimate for blocks of size 2^( 6) =       0.000453294103
  error estimate for blocks of size 2^( 7) =       0.000456188905

      target function =                  N/A
              le_mean =     -16.904405747616
             les_mean =     286.084913895924
             stat err =       0.000447888268
             autocorr =       1.281669502045
              std dev =       0.559495579710
             le_variance =       0.313035303715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312535007420
                                         uncertainty =       0.002085205827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312535007420
                                         uncertainty =       0.002085205827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395306401
  error estimate for blocks of size 2^( 2) =       0.000409258860
  error estimate for blocks of size 2^( 3) =       0.000423325746
  error estimate for blocks of size 2^( 4) =       0.000435585324
  error estimate for blocks of size 2^( 5) =       0.000446050880
  error estimate for blocks of size 2^( 6) =       0.000453126797
  error estimate for blocks of size 2^( 7) =       0.000456051467

      target function =                  N/A
              le_mean =     -16.904390903630
             les_mean =     286.123703996418
             stat err =       0.000447703617
             autocorr =       1.282665795216
              std dev =       0.559047672964
             le_variance =       0.312534300646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312626281808
                                         uncertainty =       0.002079855473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312626281808
                                         uncertainty =       0.002079855473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395364087
  error estimate for blocks of size 2^( 2) =       0.000409310330
  error estimate for blocks of size 2^( 3) =       0.000423369908
  error estimate for blocks of size 2^( 4) =       0.000435623402
  error estimate for blocks of size 2^( 5) =       0.000446078944
  error estimate for blocks of size 2^( 6) =       0.000453137998
  error estimate for blocks of size 2^( 7) =       0.000456065176

      target function =                  N/A
              le_mean =     -16.904391053330
             les_mean =     286.083641621130
             stat err =       0.000447726380
             autocorr =       1.282421917003
              std dev =       0.559129254551
             le_variance =       0.312625523294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312970570618
                                         uncertainty =       0.002051016961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312970570618
                                         uncertainty =       0.002051016961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395581538
  error estimate for blocks of size 2^( 2) =       0.000409514959
  error estimate for blocks of size 2^( 3) =       0.000423552037
  error estimate for blocks of size 2^( 4) =       0.000435783956
  error estimate for blocks of size 2^( 5) =       0.000446234621
  error estimate for blocks of size 2^( 6) =       0.000453278080
  error estimate for blocks of size 2^( 7) =       0.000456167218

      target function =                  N/A
              le_mean =     -16.904403357529
             les_mean =     286.097522275698
             stat err =       0.000447865969
             autocorr =       1.281811308256
              std dev =       0.559436775745
             le_variance =       0.312969506056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904405747616        initial  <--
     2.4414e-01     2.4414e+00             7.2230e-04       -16.904390903630
     9.7656e-01     9.7656e+00             2.7060e-04       -16.904391053330
     3.9062e+00     3.9062e+01             7.7955e-05       -16.904403357529

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1318
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.002968e-01 3 1  ON 0
ci_0002                 7.000359e-01 3 1  ON 1
ci_0003                -3.097170e-02 3 1  ON 2
ci_0004                -3.057415e-02 3 1  ON 3
ci_0005                -3.437280e-02 3 1  ON 4
ci_0006                -3.460699e-02 3 1  ON 5
ci_0007                -2.384538e-02 3 1  ON 6
ci_0008                -2.321713e-02 3 1  ON 7
ci_0009                -2.070987e-02 3 1  ON 8
ci_0010                -2.044860e-02 3 1  ON 9
ci_0011                -1.518520e-02 3 1  ON 10
ci_0012                -1.489268e-02 3 1  ON 11
ci_0013                 1.645955e-02 3 1  ON 12
ci_0014                 1.585941e-02 3 1  ON 13
ci_0015                 1.525720e-02 3 1  ON 14
ci_0016                 1.556995e-02 3 1  ON 15
ci_0017                 1.434391e-02 3 1  ON 16
ci_0018                 1.402024e-02 3 1  ON 17
ci_0019                 1.170755e-02 3 1  ON 18
ci_0020                 1.242655e-02 3 1  ON 19
ci_0021                 8.792717e-03 3 1  ON 20
ci_0022                 7.814265e-03 3 1  ON 21
ci_0023                -1.253485e-02 3 1  ON 22
ci_0024                -1.114634e-02 3 1  ON 23
ci_0025                -1.175730e-02 3 1  ON 24
ci_0026                -1.179980e-02 3 1  ON 25
ci_0027                -1.209425e-02 3 1  ON 26
ci_0028                -1.092866e-02 3 1  ON 27
ci_0029                -1.004692e-02 3 1  ON 28
ci_0030                -9.500900e-03 3 1  ON 29
ci_0031                 1.974801e-02 3 1  ON 30
ci_0032                 1.967967e-02 3 1  ON 31
ci_0033                 1.153249e-02 3 1  ON 32
ci_0034                 8.995108e-03 3 1  ON 33
ci_0035                 6.383093e-03 3 1  ON 34
ci_0036                 6.278807e-03 3 1  ON 35
ci_0037                -1.161383e-02 3 1  ON 36
ci_0038                -1.104758e-02 3 1  ON 37
ci_0039                -4.053953e-03 3 1  ON 38
ci_0040                -4.558432e-03 3 1  ON 39
ci_0041                 8.036416e-03 3 1  ON 40
ci_0042                 8.500926e-03 3 1  ON 41
ci_0043                -1.354654e-02 3 1  ON 42
ci_0044                -1.298962e-02 3 1  ON 43
ci_0045                 8.378407e-03 3 1  ON 44
ci_0046                 8.778056e-03 3 1  ON 45
ci_0047                -3.656500e-03 3 1  ON 46
ci_0048                -3.416115e-03 3 1  ON 47
ci_0049                -7.136044e-03 3 1  ON 48
ci_0050                -6.584139e-03 3 1  ON 49
ci_0051                -5.150746e-03 3 1  ON 50
ci_0052                -4.842547e-03 3 1  ON 51
ci_0053                -6.268121e-03 3 1  ON 52
ci_0054                -6.482453e-03 3 1  ON 53
ci_0055                 6.713049e-03 3 1  ON 54
ci_0056                 7.950870e-03 3 1  ON 55
ci_0057                 4.923872e-03 3 1  ON 56
ci_0058                 5.642196e-03 3 1  ON 57
ci_0059                -5.763209e-03 3 1  ON 58
ci_0060                -6.199756e-03 3 1  ON 59
ci_0061                -4.855443e-03 3 1  ON 60
ci_0062                -4.591494e-03 3 1  ON 61
ci_0063                -9.350455e-03 3 1  ON 62
ci_0064                -8.562066e-03 3 1  ON 63
ci_0065                -6.439807e-03 3 1  ON 64
ci_0066                -6.411960e-03 3 1  ON 65
ci_0067                -5.937144e-03 3 1  ON 66
ci_0068                -6.613966e-03 3 1  ON 67
ci_0069                 5.505381e-03 3 1  ON 68
ci_0070                 5.657121e-03 3 1  ON 69
ci_0071                 4.158152e-03 3 1  ON 70
ci_0072                 4.750032e-03 3 1  ON 71
ci_0073                 4.542268e-03 3 1  ON 72
ci_0074                 4.971090e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9312
    reference variance = 0.188776
====================================================
  Execution time = 1.4851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3583e-01
  Total weights = 1.951410225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318863676876
                                         uncertainty =       0.004561632867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318863676876
                                         uncertainty =       0.004561632867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399357506
  error estimate for blocks of size 2^( 2) =       0.000413599396
  error estimate for blocks of size 2^( 3) =       0.000428003793
  error estimate for blocks of size 2^( 4) =       0.000441660164
  error estimate for blocks of size 2^( 5) =       0.000452502002
  error estimate for blocks of size 2^( 6) =       0.000461127344
  error estimate for blocks of size 2^( 7) =       0.000466898071

      target function =                  N/A
              le_mean =     -16.904434632437
             les_mean =     286.095741252103
             stat err =       0.000455546895
             autocorr =       1.301195281851
              std dev =       0.564776800777
             le_variance =       0.318972834696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690443463244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904434632442       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904439964898       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904439641816       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904439631131       residual = 3.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.829968e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904434632442       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904436058100       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904435962919       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904435959825       residual = 3.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 4.858280e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904434632442       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904434995151       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904434970457       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904434969571       residual = 3.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.233657e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7517e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.003074e-01 3 1  ON 0
ci_0002                 7.000318e-01 3 1  ON 1
ci_0003                -3.096212e-02 3 1  ON 2
ci_0004                -3.058378e-02 3 1  ON 3
ci_0005                -3.435824e-02 3 1  ON 4
ci_0006                -3.459667e-02 3 1  ON 5
ci_0007                -2.384152e-02 3 1  ON 6
ci_0008                -2.320256e-02 3 1  ON 7
ci_0009                -2.069127e-02 3 1  ON 8
ci_0010                -2.040470e-02 3 1  ON 9
ci_0011                -1.517382e-02 3 1  ON 10
ci_0012                -1.489387e-02 3 1  ON 11
ci_0013                 1.643576e-02 3 1  ON 12
ci_0014                 1.585769e-02 3 1  ON 13
ci_0015                 1.526424e-02 3 1  ON 14
ci_0016                 1.557579e-02 3 1  ON 15
ci_0017                 1.432352e-02 3 1  ON 16
ci_0018                 1.401586e-02 3 1  ON 17
ci_0019                 1.172225e-02 3 1  ON 18
ci_0020                 1.241476e-02 3 1  ON 19
ci_0021                 8.767849e-03 3 1  ON 20
ci_0022                 7.794900e-03 3 1  ON 21
ci_0023                -1.251154e-02 3 1  ON 22
ci_0024                -1.113122e-02 3 1  ON 23
ci_0025                -1.172964e-02 3 1  ON 24
ci_0026                -1.181053e-02 3 1  ON 25
ci_0027                -1.206189e-02 3 1  ON 26
ci_0028                -1.093812e-02 3 1  ON 27
ci_0029                -1.005016e-02 3 1  ON 28
ci_0030                -9.549483e-03 3 1  ON 29
ci_0031                 1.973088e-02 3 1  ON 30
ci_0032                 1.968929e-02 3 1  ON 31
ci_0033                 1.151938e-02 3 1  ON 32
ci_0034                 8.988754e-03 3 1  ON 33
ci_0035                 6.378133e-03 3 1  ON 34
ci_0036                 6.290073e-03 3 1  ON 35
ci_0037                -1.162413e-02 3 1  ON 36
ci_0038                -1.104026e-02 3 1  ON 37
ci_0039                -4.051725e-03 3 1  ON 38
ci_0040                -4.547704e-03 3 1  ON 39
ci_0041                 8.046751e-03 3 1  ON 40
ci_0042                 8.509940e-03 3 1  ON 41
ci_0043                -1.355048e-02 3 1  ON 42
ci_0044                -1.301946e-02 3 1  ON 43
ci_0045                 8.376238e-03 3 1  ON 44
ci_0046                 8.764513e-03 3 1  ON 45
ci_0047                -3.664070e-03 3 1  ON 46
ci_0048                -3.394055e-03 3 1  ON 47
ci_0049                -7.122861e-03 3 1  ON 48
ci_0050                -6.585782e-03 3 1  ON 49
ci_0051                -5.105743e-03 3 1  ON 50
ci_0052                -4.830188e-03 3 1  ON 51
ci_0053                -6.274261e-03 3 1  ON 52
ci_0054                -6.448612e-03 3 1  ON 53
ci_0055                 6.716917e-03 3 1  ON 54
ci_0056                 7.939539e-03 3 1  ON 55
ci_0057                 4.945679e-03 3 1  ON 56
ci_0058                 5.654099e-03 3 1  ON 57
ci_0059                -5.742681e-03 3 1  ON 58
ci_0060                -6.206652e-03 3 1  ON 59
ci_0061                -4.824171e-03 3 1  ON 60
ci_0062                -4.572385e-03 3 1  ON 61
ci_0063                -9.359332e-03 3 1  ON 62
ci_0064                -8.576140e-03 3 1  ON 63
ci_0065                -6.460516e-03 3 1  ON 64
ci_0066                -6.418084e-03 3 1  ON 65
ci_0067                -5.940066e-03 3 1  ON 66
ci_0068                -6.590494e-03 3 1  ON 67
ci_0069                 5.512568e-03 3 1  ON 68
ci_0070                 5.637344e-03 3 1  ON 69
ci_0071                 4.148864e-03 3 1  ON 70
ci_0072                 4.756587e-03 3 1  ON 71
ci_0073                 4.538915e-03 3 1  ON 72
ci_0074                 4.978437e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.41542
====================================================
  Execution time = 1.4502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2668e-01
  Total weights = 1.9522e+06
  Execution time = 1.8978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312659758875
                                         uncertainty =       0.002228561965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312659758875
                                         uncertainty =       0.002228561965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395375030
  error estimate for blocks of size 2^( 2) =       0.000409561518
  error estimate for blocks of size 2^( 3) =       0.000423476858
  error estimate for blocks of size 2^( 4) =       0.000436486175
  error estimate for blocks of size 2^( 5) =       0.000448255710
  error estimate for blocks of size 2^( 6) =       0.000456020316
  error estimate for blocks of size 2^( 7) =       0.000463507843

      target function =                  N/A
              le_mean =     -16.905060009085
             les_mean =     286.107521995658
             stat err =       0.000451067511
             autocorr =       1.301561273431
              std dev =       0.559144730198
             le_variance =       0.312642829308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312564549514
                                         uncertainty =       0.002235583333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312564549514
                                         uncertainty =       0.002235583333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395314825
  error estimate for blocks of size 2^( 2) =       0.000409506091
  error estimate for blocks of size 2^( 3) =       0.000423426722
  error estimate for blocks of size 2^( 4) =       0.000436441457
  error estimate for blocks of size 2^( 5) =       0.000448213187
  error estimate for blocks of size 2^( 6) =       0.000455982606
  error estimate for blocks of size 2^( 7) =       0.000463474022

      target function =                  N/A
              le_mean =     -16.905060616076
             les_mean =     286.109021384137
             stat err =       0.000451027818
             autocorr =       1.301728622343
              std dev =       0.559059586911
             le_variance =       0.312547621717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312606371262
                                         uncertainty =       0.002232268170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312606371262
                                         uncertainty =       0.002232268170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395341274
  error estimate for blocks of size 2^( 2) =       0.000409530391
  error estimate for blocks of size 2^( 3) =       0.000423448620
  error estimate for blocks of size 2^( 4) =       0.000436460957
  error estimate for blocks of size 2^( 5) =       0.000448231601
  error estimate for blocks of size 2^( 6) =       0.000455999003
  error estimate for blocks of size 2^( 7) =       0.000463488794

      target function =                  N/A
              le_mean =     -16.905060184157
             les_mean =     286.108580138183
             stat err =       0.000451045089
             autocorr =       1.301654136168
              std dev =       0.559096991068
             le_variance =       0.312589445421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312652736356
                                         uncertainty =       0.002229022835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312652736356
                                         uncertainty =       0.002229022835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395370590
  error estimate for blocks of size 2^( 2) =       0.000409557415
  error estimate for blocks of size 2^( 3) =       0.000423473130
  error estimate for blocks of size 2^( 4) =       0.000436482838
  error estimate for blocks of size 2^( 5) =       0.000448252509
  error estimate for blocks of size 2^( 6) =       0.000456017465
  error estimate for blocks of size 2^( 7) =       0.000463505281

      target function =                  N/A
              le_mean =     -16.905060008161
             les_mean =     286.107564210265
             stat err =       0.000451064524
             autocorr =       1.301573264921
              std dev =       0.559138451120
             le_variance =       0.312635807521


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905060009085        initial
     2.4414e+00     2.4414e+01             1.8300e-04       -16.905060616076  <--
     9.7656e+00     9.7656e+01             4.8583e-05       -16.905060184157
     3.9062e+01     3.9062e+02             1.2337e-05       -16.905060008161

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4098e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.003377e-01 3 1  ON 0
ci_0002                 7.000197e-01 3 1  ON 1
ci_0003                -3.093568e-02 3 1  ON 2
ci_0004                -3.060968e-02 3 1  ON 3
ci_0005                -3.431668e-02 3 1  ON 4
ci_0006                -3.456706e-02 3 1  ON 5
ci_0007                -2.382990e-02 3 1  ON 6
ci_0008                -2.316066e-02 3 1  ON 7
ci_0009                -2.064120e-02 3 1  ON 8
ci_0010                -2.028484e-02 3 1  ON 9
ci_0011                -1.514287e-02 3 1  ON 10
ci_0012                -1.489671e-02 3 1  ON 11
ci_0013                 1.637080e-02 3 1  ON 12
ci_0014                 1.585243e-02 3 1  ON 13
ci_0015                 1.528422e-02 3 1  ON 14
ci_0016                 1.559157e-02 3 1  ON 15
ci_0017                 1.426838e-02 3 1  ON 16
ci_0018                 1.400394e-02 3 1  ON 17
ci_0019                 1.176336e-02 3 1  ON 18
ci_0020                 1.238235e-02 3 1  ON 19
ci_0021                 8.695483e-03 3 1  ON 20
ci_0022                 7.739397e-03 3 1  ON 21
ci_0023                -1.244837e-02 3 1  ON 22
ci_0024                -1.109063e-02 3 1  ON 23
ci_0025                -1.165368e-02 3 1  ON 24
ci_0026                -1.184023e-02 3 1  ON 25
ci_0027                -1.197298e-02 3 1  ON 26
ci_0028                -1.096490e-02 3 1  ON 27
ci_0029                -1.005996e-02 3 1  ON 28
ci_0030                -9.683897e-03 3 1  ON 29
ci_0031                 1.968137e-02 3 1  ON 30
ci_0032                 1.971629e-02 3 1  ON 31
ci_0033                 1.148184e-02 3 1  ON 32
ci_0034                 8.970749e-03 3 1  ON 33
ci_0035                 6.364768e-03 3 1  ON 34
ci_0036                 6.321150e-03 3 1  ON 35
ci_0037                -1.165296e-02 3 1  ON 36
ci_0038                -1.101985e-02 3 1  ON 37
ci_0039                -4.045958e-03 3 1  ON 38
ci_0040                -4.519815e-03 3 1  ON 39
ci_0041                 8.074937e-03 3 1  ON 40
ci_0042                 8.534789e-03 3 1  ON 41
ci_0043                -1.356184e-02 3 1  ON 42
ci_0044                -1.310540e-02 3 1  ON 43
ci_0045                 8.370213e-03 3 1  ON 44
ci_0046                 8.725957e-03 3 1  ON 45
ci_0047                -3.683881e-03 3 1  ON 46
ci_0048                -3.336359e-03 3 1  ON 47
ci_0049                -7.086791e-03 3 1  ON 48
ci_0050                -6.590244e-03 3 1  ON 49
ci_0051                -4.987220e-03 3 1  ON 50
ci_0052                -4.797355e-03 3 1  ON 51
ci_0053                -6.290344e-03 3 1  ON 52
ci_0054                -6.358633e-03 3 1  ON 53
ci_0055                 6.727580e-03 3 1  ON 54
ci_0056                 7.907482e-03 3 1  ON 55
ci_0057                 5.006817e-03 3 1  ON 56
ci_0058                 5.687225e-03 3 1  ON 57
ci_0059                -5.688006e-03 3 1  ON 58
ci_0060                -6.224929e-03 3 1  ON 59
ci_0061                -4.737223e-03 3 1  ON 60
ci_0062                -4.519685e-03 3 1  ON 61
ci_0063                -9.382924e-03 3 1  ON 62
ci_0064                -8.613402e-03 3 1  ON 63
ci_0065                -6.516752e-03 3 1  ON 64
ci_0066                -6.434528e-03 3 1  ON 65
ci_0067                -5.947707e-03 3 1  ON 66
ci_0068                -6.528892e-03 3 1  ON 67
ci_0069                 5.531716e-03 3 1  ON 68
ci_0070                 5.585423e-03 3 1  ON 69
ci_0071                 4.123946e-03 3 1  ON 70
ci_0072                 4.773610e-03 3 1  ON 71
ci_0073                 4.530987e-03 3 1  ON 72
ci_0074                 4.997557e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8182
    reference variance = 0.804255
====================================================
  Execution time = 1.4840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3047e-01
  Total weights = 1.951967517e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318485277171
                                         uncertainty =       0.005457769081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318485277171
                                         uncertainty =       0.005457769081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399140914
  error estimate for blocks of size 2^( 2) =       0.000413088673
  error estimate for blocks of size 2^( 3) =       0.000427252355
  error estimate for blocks of size 2^( 4) =       0.000440351226
  error estimate for blocks of size 2^( 5) =       0.000450833884
  error estimate for blocks of size 2^( 6) =       0.000456911171
  error estimate for blocks of size 2^( 7) =       0.000464898240

      target function =                  N/A
              le_mean =     -16.904046546372
             les_mean =     286.077256983119
             stat err =       0.000453248630
             autocorr =       1.289497501422
              std dev =       0.564470494078
             le_variance =       0.318626938685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690404654637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904046546388       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904055657284       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904055665233       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904055681526       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 4.442352e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904046546388       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904049403339       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904049352153       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.421406e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904046546388       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904047309116       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904047292557       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904047297653       residual = 1.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 3.815277e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139222 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7446e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.003612e-01 3 1  ON 0
ci_0002                 7.000138e-01 3 1  ON 1
ci_0003                -3.094680e-02 3 1  ON 2
ci_0004                -3.061954e-02 3 1  ON 3
ci_0005                -3.428732e-02 3 1  ON 4
ci_0006                -3.453960e-02 3 1  ON 5
ci_0007                -2.373506e-02 3 1  ON 6
ci_0008                -2.321122e-02 3 1  ON 7
ci_0009                -2.049906e-02 3 1  ON 8
ci_0010                -2.024042e-02 3 1  ON 9
ci_0011                -1.514748e-02 3 1  ON 10
ci_0012                -1.494546e-02 3 1  ON 11
ci_0013                 1.633643e-02 3 1  ON 12
ci_0014                 1.581643e-02 3 1  ON 13
ci_0015                 1.531663e-02 3 1  ON 14
ci_0016                 1.566693e-02 3 1  ON 15
ci_0017                 1.420196e-02 3 1  ON 16
ci_0018                 1.395845e-02 3 1  ON 17
ci_0019                 1.175744e-02 3 1  ON 18
ci_0020                 1.238501e-02 3 1  ON 19
ci_0021                 8.661338e-03 3 1  ON 20
ci_0022                 7.788406e-03 3 1  ON 21
ci_0023                -1.240381e-02 3 1  ON 22
ci_0024                -1.106184e-02 3 1  ON 23
ci_0025                -1.162583e-02 3 1  ON 24
ci_0026                -1.178130e-02 3 1  ON 25
ci_0027                -1.195580e-02 3 1  ON 26
ci_0028                -1.098700e-02 3 1  ON 27
ci_0029                -1.014401e-02 3 1  ON 28
ci_0030                -9.748346e-03 3 1  ON 29
ci_0031                 1.960429e-02 3 1  ON 30
ci_0032                 1.967714e-02 3 1  ON 31
ci_0033                 1.145062e-02 3 1  ON 32
ci_0034                 9.001237e-03 3 1  ON 33
ci_0035                 6.391699e-03 3 1  ON 34
ci_0036                 6.369270e-03 3 1  ON 35
ci_0037                -1.164643e-02 3 1  ON 36
ci_0038                -1.093144e-02 3 1  ON 37
ci_0039                -4.054918e-03 3 1  ON 38
ci_0040                -4.535660e-03 3 1  ON 39
ci_0041                 8.056136e-03 3 1  ON 40
ci_0042                 8.530141e-03 3 1  ON 41
ci_0043                -1.354115e-02 3 1  ON 42
ci_0044                -1.311537e-02 3 1  ON 43
ci_0045                 8.401307e-03 3 1  ON 44
ci_0046                 8.743034e-03 3 1  ON 45
ci_0047                -3.615367e-03 3 1  ON 46
ci_0048                -3.333291e-03 3 1  ON 47
ci_0049                -7.007045e-03 3 1  ON 48
ci_0050                -6.608459e-03 3 1  ON 49
ci_0051                -4.955155e-03 3 1  ON 50
ci_0052                -4.777617e-03 3 1  ON 51
ci_0053                -6.255768e-03 3 1  ON 52
ci_0054                -6.315443e-03 3 1  ON 53
ci_0055                 6.666522e-03 3 1  ON 54
ci_0056                 7.896187e-03 3 1  ON 55
ci_0057                 5.066189e-03 3 1  ON 56
ci_0058                 5.722334e-03 3 1  ON 57
ci_0059                -5.793519e-03 3 1  ON 58
ci_0060                -6.147293e-03 3 1  ON 59
ci_0061                -4.681994e-03 3 1  ON 60
ci_0062                -4.457745e-03 3 1  ON 61
ci_0063                -9.340204e-03 3 1  ON 62
ci_0064                -8.682509e-03 3 1  ON 63
ci_0065                -6.538486e-03 3 1  ON 64
ci_0066                -6.328705e-03 3 1  ON 65
ci_0067                -5.870750e-03 3 1  ON 66
ci_0068                -6.463364e-03 3 1  ON 67
ci_0069                 5.533438e-03 3 1  ON 68
ci_0070                 5.618066e-03 3 1  ON 69
ci_0071                 4.103417e-03 3 1  ON 70
ci_0072                 4.708615e-03 3 1  ON 71
ci_0073                 4.635023e-03 3 1  ON 72
ci_0074                 5.019323e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.989
    reference variance = 0.212738
====================================================
  Execution time = 1.4383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2091e-01
  Total weights = 1.9515e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310217340000
                                         uncertainty =       0.002241743085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310217340000
                                         uncertainty =       0.002241743085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393821064
  error estimate for blocks of size 2^( 2) =       0.000407295472
  error estimate for blocks of size 2^( 3) =       0.000421041460
  error estimate for blocks of size 2^( 4) =       0.000433552164
  error estimate for blocks of size 2^( 5) =       0.000443907519
  error estimate for blocks of size 2^( 6) =       0.000450394245
  error estimate for blocks of size 2^( 7) =       0.000455849062

      target function =                  N/A
              le_mean =     -16.904096046361
             les_mean =     286.069380288093
             stat err =       0.000445925748
             autocorr =       1.282115690295
              std dev =       0.556947090370
             le_variance =       0.310190061472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310063046304
                                         uncertainty =       0.002246163057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310063046304
                                         uncertainty =       0.002246163057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393723206
  error estimate for blocks of size 2^( 2) =       0.000407203222
  error estimate for blocks of size 2^( 3) =       0.000420951686
  error estimate for blocks of size 2^( 4) =       0.000433471988
  error estimate for blocks of size 2^( 5) =       0.000443838047
  error estimate for blocks of size 2^( 6) =       0.000450348987
  error estimate for blocks of size 2^( 7) =       0.000455830059

      target function =                  N/A
              le_mean =     -16.904092733761
             les_mean =     286.069398762705
             stat err =       0.000445872270
             autocorr =       1.282445452437
              std dev =       0.556808697354
             le_variance =       0.310035925449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310109099837
                                         uncertainty =       0.002243832439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310109099837
                                         uncertainty =       0.002243832439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393752439
  error estimate for blocks of size 2^( 2) =       0.000407230837
  error estimate for blocks of size 2^( 3) =       0.000420978611
  error estimate for blocks of size 2^( 4) =       0.000433495405
  error estimate for blocks of size 2^( 5) =       0.000443858059
  error estimate for blocks of size 2^( 6) =       0.000450360330
  error estimate for blocks of size 2^( 7) =       0.000455831526

      target function =                  N/A
              le_mean =     -16.904092775906
             les_mean =     286.069196234281
             stat err =       0.000445886330
             autocorr =       1.282335902709
              std dev =       0.556850039419
             le_variance =       0.310081966401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310201059125
                                         uncertainty =       0.002241955624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310201059125
                                         uncertainty =       0.002241955624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393810743
  error estimate for blocks of size 2^( 2) =       0.000407285892
  error estimate for blocks of size 2^( 3) =       0.000421032023
  error estimate for blocks of size 2^( 4) =       0.000433543536
  error estimate for blocks of size 2^( 5) =       0.000443900087
  error estimate for blocks of size 2^( 6) =       0.000450388942
  error estimate for blocks of size 2^( 7) =       0.000455846001

      target function =                  N/A
              le_mean =     -16.904095430828
             les_mean =     286.069365215952
             stat err =       0.000445919641
             autocorr =       1.282147780172
              std dev =       0.556932494093
             le_variance =       0.310173802977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904096046361        initial  <--
     6.1035e-01     6.1035e+00             4.4424e-04       -16.904092733761
     2.4414e+00     2.4414e+01             1.4214e-04       -16.904092775906
     9.7656e+00     9.7656e+01             3.8153e-05       -16.904095430828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9939
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.003377e-01 3 1  ON 0
ci_0002                 7.000197e-01 3 1  ON 1
ci_0003                -3.093568e-02 3 1  ON 2
ci_0004                -3.060968e-02 3 1  ON 3
ci_0005                -3.431668e-02 3 1  ON 4
ci_0006                -3.456706e-02 3 1  ON 5
ci_0007                -2.382990e-02 3 1  ON 6
ci_0008                -2.316066e-02 3 1  ON 7
ci_0009                -2.064120e-02 3 1  ON 8
ci_0010                -2.028484e-02 3 1  ON 9
ci_0011                -1.514287e-02 3 1  ON 10
ci_0012                -1.489671e-02 3 1  ON 11
ci_0013                 1.637080e-02 3 1  ON 12
ci_0014                 1.585243e-02 3 1  ON 13
ci_0015                 1.528422e-02 3 1  ON 14
ci_0016                 1.559157e-02 3 1  ON 15
ci_0017                 1.426838e-02 3 1  ON 16
ci_0018                 1.400394e-02 3 1  ON 17
ci_0019                 1.176336e-02 3 1  ON 18
ci_0020                 1.238235e-02 3 1  ON 19
ci_0021                 8.695483e-03 3 1  ON 20
ci_0022                 7.739397e-03 3 1  ON 21
ci_0023                -1.244837e-02 3 1  ON 22
ci_0024                -1.109063e-02 3 1  ON 23
ci_0025                -1.165368e-02 3 1  ON 24
ci_0026                -1.184023e-02 3 1  ON 25
ci_0027                -1.197298e-02 3 1  ON 26
ci_0028                -1.096490e-02 3 1  ON 27
ci_0029                -1.005996e-02 3 1  ON 28
ci_0030                -9.683897e-03 3 1  ON 29
ci_0031                 1.968137e-02 3 1  ON 30
ci_0032                 1.971629e-02 3 1  ON 31
ci_0033                 1.148184e-02 3 1  ON 32
ci_0034                 8.970749e-03 3 1  ON 33
ci_0035                 6.364768e-03 3 1  ON 34
ci_0036                 6.321150e-03 3 1  ON 35
ci_0037                -1.165296e-02 3 1  ON 36
ci_0038                -1.101985e-02 3 1  ON 37
ci_0039                -4.045958e-03 3 1  ON 38
ci_0040                -4.519815e-03 3 1  ON 39
ci_0041                 8.074937e-03 3 1  ON 40
ci_0042                 8.534789e-03 3 1  ON 41
ci_0043                -1.356184e-02 3 1  ON 42
ci_0044                -1.310540e-02 3 1  ON 43
ci_0045                 8.370213e-03 3 1  ON 44
ci_0046                 8.725957e-03 3 1  ON 45
ci_0047                -3.683881e-03 3 1  ON 46
ci_0048                -3.336359e-03 3 1  ON 47
ci_0049                -7.086791e-03 3 1  ON 48
ci_0050                -6.590244e-03 3 1  ON 49
ci_0051                -4.987220e-03 3 1  ON 50
ci_0052                -4.797355e-03 3 1  ON 51
ci_0053                -6.290344e-03 3 1  ON 52
ci_0054                -6.358633e-03 3 1  ON 53
ci_0055                 6.727580e-03 3 1  ON 54
ci_0056                 7.907482e-03 3 1  ON 55
ci_0057                 5.006817e-03 3 1  ON 56
ci_0058                 5.687225e-03 3 1  ON 57
ci_0059                -5.688006e-03 3 1  ON 58
ci_0060                -6.224929e-03 3 1  ON 59
ci_0061                -4.737223e-03 3 1  ON 60
ci_0062                -4.519685e-03 3 1  ON 61
ci_0063                -9.382924e-03 3 1  ON 62
ci_0064                -8.613402e-03 3 1  ON 63
ci_0065                -6.516752e-03 3 1  ON 64
ci_0066                -6.434528e-03 3 1  ON 65
ci_0067                -5.947707e-03 3 1  ON 66
ci_0068                -6.528892e-03 3 1  ON 67
ci_0069                 5.531716e-03 3 1  ON 68
ci_0070                 5.585423e-03 3 1  ON 69
ci_0071                 4.123946e-03 3 1  ON 70
ci_0072                 4.773610e-03 3 1  ON 71
ci_0073                 4.530987e-03 3 1  ON 72
ci_0074                 4.997557e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8851
    reference variance = 0.203745
====================================================
  Execution time = 1.4911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1978e-01
  Total weights = 1.951709431e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308666326636
                                         uncertainty =       0.001606705107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308666326636
                                         uncertainty =       0.001606705107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392858194
  error estimate for blocks of size 2^( 2) =       0.000407422319
  error estimate for blocks of size 2^( 3) =       0.000421560820
  error estimate for blocks of size 2^( 4) =       0.000434727596
  error estimate for blocks of size 2^( 5) =       0.000444688835
  error estimate for blocks of size 2^( 6) =       0.000452292100
  error estimate for blocks of size 2^( 7) =       0.000457986053

      target function =                  N/A
              le_mean =     -16.903583913037
             les_mean =     286.050926268041
             stat err =       0.000447423646
             autocorr =       1.297078419494
              std dev =       0.555585385948
             le_variance =       0.308675121079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690358391304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903583913010       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903585601341       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903585609966       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903585608358       residual = 1.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 8.583611e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903583913010       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903584346447       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903584349477       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903584348985       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 2.199896e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903583913010       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903584022103       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903584022921       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903584022793       residual = 1.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 5.534541e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7584e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.003377e-01 3 1  ON 0
ci_0002                 7.000193e-01 3 1  ON 1
ci_0003                -3.093573e-02 3 1  ON 2
ci_0004                -3.061058e-02 3 1  ON 3
ci_0005                -3.431891e-02 3 1  ON 4
ci_0006                -3.456989e-02 3 1  ON 5
ci_0007                -2.382223e-02 3 1  ON 6
ci_0008                -2.315970e-02 3 1  ON 7
ci_0009                -2.063586e-02 3 1  ON 8
ci_0010                -2.028682e-02 3 1  ON 9
ci_0011                -1.514188e-02 3 1  ON 10
ci_0012                -1.490472e-02 3 1  ON 11
ci_0013                 1.636525e-02 3 1  ON 12
ci_0014                 1.584943e-02 3 1  ON 13
ci_0015                 1.528773e-02 3 1  ON 14
ci_0016                 1.558869e-02 3 1  ON 15
ci_0017                 1.426752e-02 3 1  ON 16
ci_0018                 1.400087e-02 3 1  ON 17
ci_0019                 1.176486e-02 3 1  ON 18
ci_0020                 1.237833e-02 3 1  ON 19
ci_0021                 8.687435e-03 3 1  ON 20
ci_0022                 7.734050e-03 3 1  ON 21
ci_0023                -1.243894e-02 3 1  ON 22
ci_0024                -1.109612e-02 3 1  ON 23
ci_0025                -1.165330e-02 3 1  ON 24
ci_0026                -1.184577e-02 3 1  ON 25
ci_0027                -1.196844e-02 3 1  ON 26
ci_0028                -1.097382e-02 3 1  ON 27
ci_0029                -1.006296e-02 3 1  ON 28
ci_0030                -9.705895e-03 3 1  ON 29
ci_0031                 1.968260e-02 3 1  ON 30
ci_0032                 1.971446e-02 3 1  ON 31
ci_0033                 1.148515e-02 3 1  ON 32
ci_0034                 8.983891e-03 3 1  ON 33
ci_0035                 6.363888e-03 3 1  ON 34
ci_0036                 6.324233e-03 3 1  ON 35
ci_0037                -1.164747e-02 3 1  ON 36
ci_0038                -1.102779e-02 3 1  ON 37
ci_0039                -4.052148e-03 3 1  ON 38
ci_0040                -4.506224e-03 3 1  ON 39
ci_0041                 8.082217e-03 3 1  ON 40
ci_0042                 8.538220e-03 3 1  ON 41
ci_0043                -1.356669e-02 3 1  ON 42
ci_0044                -1.310573e-02 3 1  ON 43
ci_0045                 8.378114e-03 3 1  ON 44
ci_0046                 8.724692e-03 3 1  ON 45
ci_0047                -3.687045e-03 3 1  ON 46
ci_0048                -3.333905e-03 3 1  ON 47
ci_0049                -7.086740e-03 3 1  ON 48
ci_0050                -6.585013e-03 3 1  ON 49
ci_0051                -4.984501e-03 3 1  ON 50
ci_0052                -4.797072e-03 3 1  ON 51
ci_0053                -6.288818e-03 3 1  ON 52
ci_0054                -6.360507e-03 3 1  ON 53
ci_0055                 6.723611e-03 3 1  ON 54
ci_0056                 7.904145e-03 3 1  ON 55
ci_0057                 4.998955e-03 3 1  ON 56
ci_0058                 5.690301e-03 3 1  ON 57
ci_0059                -5.699830e-03 3 1  ON 58
ci_0060                -6.230561e-03 3 1  ON 59
ci_0061                -4.728461e-03 3 1  ON 60
ci_0062                -4.511496e-03 3 1  ON 61
ci_0063                -9.381971e-03 3 1  ON 62
ci_0064                -8.618872e-03 3 1  ON 63
ci_0065                -6.515602e-03 3 1  ON 64
ci_0066                -6.428475e-03 3 1  ON 65
ci_0067                -5.948079e-03 3 1  ON 66
ci_0068                -6.528204e-03 3 1  ON 67
ci_0069                 5.540321e-03 3 1  ON 68
ci_0070                 5.586390e-03 3 1  ON 69
ci_0071                 4.129433e-03 3 1  ON 70
ci_0072                 4.776942e-03 3 1  ON 71
ci_0073                 4.539575e-03 3 1  ON 72
ci_0074                 4.988937e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 1.12717
====================================================
  Execution time = 1.4505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2645e-01
  Total weights = 1.9514e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312552750408
                                         uncertainty =       0.003155473317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312552750408
                                         uncertainty =       0.003155473317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395288322
  error estimate for blocks of size 2^( 2) =       0.000409020188
  error estimate for blocks of size 2^( 3) =       0.000423124565
  error estimate for blocks of size 2^( 4) =       0.000435983217
  error estimate for blocks of size 2^( 5) =       0.000446056257
  error estimate for blocks of size 2^( 6) =       0.000452890928
  error estimate for blocks of size 2^( 7) =       0.000456190818

      target function =                  N/A
              le_mean =     -16.902973039953
             les_mean =     286.037012838015
             stat err =       0.000447780305
             autocorr =       1.283222622342
              std dev =       0.559022106102
             le_variance =       0.312505715111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312503027592
                                         uncertainty =       0.003125163075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312503027592
                                         uncertainty =       0.003125163075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395257131
  error estimate for blocks of size 2^( 2) =       0.000408988988
  error estimate for blocks of size 2^( 3) =       0.000423093806
  error estimate for blocks of size 2^( 4) =       0.000435954657
  error estimate for blocks of size 2^( 5) =       0.000446027419
  error estimate for blocks of size 2^( 6) =       0.000452862680
  error estimate for blocks of size 2^( 7) =       0.000456156572

      target function =                  N/A
              le_mean =     -16.902974456116
             les_mean =     286.036913941097
             stat err =       0.000447750332
             autocorr =       1.283253348549
              std dev =       0.558977994703
             le_variance =       0.312456398562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312527110710
                                         uncertainty =       0.003139893469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312527110710
                                         uncertainty =       0.003139893469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395272238
  error estimate for blocks of size 2^( 2) =       0.000409004084
  error estimate for blocks of size 2^( 3) =       0.000423108679
  error estimate for blocks of size 2^( 4) =       0.000435968469
  error estimate for blocks of size 2^( 5) =       0.000446041361
  error estimate for blocks of size 2^( 6) =       0.000452876313
  error estimate for blocks of size 2^( 7) =       0.000456173106

      target function =                  N/A
              le_mean =     -16.902973743549
             les_mean =     286.036930455505
             stat err =       0.000447764812
             autocorr =       1.283238255842
              std dev =       0.558999359550
             le_variance =       0.312480283978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312549495108
                                         uncertainty =       0.003153501759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312549495108
                                         uncertainty =       0.003153501759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395286280
  error estimate for blocks of size 2^( 2) =       0.000409018143
  error estimate for blocks of size 2^( 3) =       0.000423122547
  error estimate for blocks of size 2^( 4) =       0.000435981344
  error estimate for blocks of size 2^( 5) =       0.000446054365
  error estimate for blocks of size 2^( 6) =       0.000452889071
  error estimate for blocks of size 2^( 7) =       0.000456188572

      target function =                  N/A
              le_mean =     -16.902973126112
             les_mean =     286.036997193833
             stat err =       0.000447778338
             autocorr =       1.283224606923
              std dev =       0.559019218047
             le_variance =       0.312502486146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.902973039953        initial
     6.1035e+00     6.1035e+01             8.5836e-05       -16.902974456116  <--
     2.4414e+01     2.4414e+02             2.1999e-05       -16.902973743549
     9.7656e+01     9.7656e+02             5.5345e-06       -16.902973126112

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.4026e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.003374e-01 3 1  ON 0
ci_0002                 7.000181e-01 3 1  ON 1
ci_0003                -3.093587e-02 3 1  ON 2
ci_0004                -3.061305e-02 3 1  ON 3
ci_0005                -3.432546e-02 3 1  ON 4
ci_0006                -3.457818e-02 3 1  ON 5
ci_0007                -2.379956e-02 3 1  ON 6
ci_0008                -2.315687e-02 3 1  ON 7
ci_0009                -2.062049e-02 3 1  ON 8
ci_0010                -2.029243e-02 3 1  ON 9
ci_0011                -1.513902e-02 3 1  ON 10
ci_0012                -1.492789e-02 3 1  ON 11
ci_0013                 1.634919e-02 3 1  ON 12
ci_0014                 1.584056e-02 3 1  ON 13
ci_0015                 1.529789e-02 3 1  ON 14
ci_0016                 1.558019e-02 3 1  ON 15
ci_0017                 1.426508e-02 3 1  ON 16
ci_0018                 1.399192e-02 3 1  ON 17
ci_0019                 1.176922e-02 3 1  ON 18
ci_0020                 1.236663e-02 3 1  ON 19
ci_0021                 8.663711e-03 3 1  ON 20
ci_0022                 7.718370e-03 3 1  ON 21
ci_0023                -1.241173e-02 3 1  ON 22
ci_0024                -1.111192e-02 3 1  ON 23
ci_0025                -1.165218e-02 3 1  ON 24
ci_0026                -1.186180e-02 3 1  ON 25
ci_0027                -1.195530e-02 3 1  ON 26
ci_0028                -1.099967e-02 3 1  ON 27
ci_0029                -1.007161e-02 3 1  ON 28
ci_0030                -9.769733e-03 3 1  ON 29
ci_0031                 1.968625e-02 3 1  ON 30
ci_0032                 1.970907e-02 3 1  ON 31
ci_0033                 1.149490e-02 3 1  ON 32
ci_0034                 9.022603e-03 3 1  ON 33
ci_0035                 6.361333e-03 3 1  ON 34
ci_0036                 6.333178e-03 3 1  ON 35
ci_0037                -1.163140e-02 3 1  ON 36
ci_0038                -1.105098e-02 3 1  ON 37
ci_0039                -4.069658e-03 3 1  ON 38
ci_0040                -4.467781e-03 3 1  ON 39
ci_0041                 8.103315e-03 3 1  ON 40
ci_0042                 8.548130e-03 3 1  ON 41
ci_0043                -1.358103e-02 3 1  ON 42
ci_0044                -1.310670e-02 3 1  ON 43
ci_0045                 8.401235e-03 3 1  ON 44
ci_0046                 8.720950e-03 3 1  ON 45
ci_0047                -3.696025e-03 3 1  ON 46
ci_0048                -3.326969e-03 3 1  ON 47
ci_0049                -7.086629e-03 3 1  ON 48
ci_0050                -6.569850e-03 3 1  ON 49
ci_0051                -4.976749e-03 3 1  ON 50
ci_0052                -4.796291e-03 3 1  ON 51
ci_0053                -6.284492e-03 3 1  ON 52
ci_0054                -6.365897e-03 3 1  ON 53
ci_0055                 6.712021e-03 3 1  ON 54
ci_0056                 7.894421e-03 3 1  ON 55
ci_0057                 4.976041e-03 3 1  ON 56
ci_0058                 5.699235e-03 3 1  ON 57
ci_0059                -5.733586e-03 3 1  ON 58
ci_0060                -6.246632e-03 3 1  ON 59
ci_0061                -4.703010e-03 3 1  ON 60
ci_0062                -4.487688e-03 3 1  ON 61
ci_0063                -9.379254e-03 3 1  ON 62
ci_0064                -8.634560e-03 3 1  ON 63
ci_0065                -6.512295e-03 3 1  ON 64
ci_0066                -6.410949e-03 3 1  ON 65
ci_0067                -5.949174e-03 3 1  ON 66
ci_0068                -6.526252e-03 3 1  ON 67
ci_0069                 5.564848e-03 3 1  ON 68
ci_0070                 5.589137e-03 3 1  ON 69
ci_0071                 4.145387e-03 3 1  ON 70
ci_0072                 4.786594e-03 3 1  ON 71
ci_0073                 4.563953e-03 3 1  ON 72
ci_0074                 4.964367e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9588
    reference variance = 0.211985
====================================================
  Execution time = 1.4653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2666e-01
  Total weights = 1.951728514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314412853634
                                         uncertainty =       0.002408404650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314412853634
                                         uncertainty =       0.002408404650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396450061
  error estimate for blocks of size 2^( 2) =       0.000410682011
  error estimate for blocks of size 2^( 3) =       0.000424940377
  error estimate for blocks of size 2^( 4) =       0.000438550472
  error estimate for blocks of size 2^( 5) =       0.000450896612
  error estimate for blocks of size 2^( 6) =       0.000460996165
  error estimate for blocks of size 2^( 7) =       0.000468533526

      target function =                  N/A
              le_mean =     -16.903503635113
             les_mean =     286.055097406753
             stat err =       0.000454744194
             autocorr =       1.315701431417
              std dev =       0.560665053197
             le_variance =       0.314345301876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690350363511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903503635105       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903511257605       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903511485138       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903511481801       residual = 2.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.142503e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903503635105       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903505721143       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903505797400       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903505800245       residual = 2.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 5.643855e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903503635105       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903504169257       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903504190026       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903504191061       residual = 3.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 1.430032e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7317e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.003496e-01 3 1  ON 0
ci_0002                 7.000088e-01 3 1  ON 1
ci_0003                -3.090357e-02 3 1  ON 2
ci_0004                -3.061927e-02 3 1  ON 3
ci_0005                -3.431664e-02 3 1  ON 4
ci_0006                -3.456297e-02 3 1  ON 5
ci_0007                -2.377853e-02 3 1  ON 6
ci_0008                -2.318449e-02 3 1  ON 7
ci_0009                -2.061064e-02 3 1  ON 8
ci_0010                -2.028808e-02 3 1  ON 9
ci_0011                -1.511318e-02 3 1  ON 10
ci_0012                -1.494421e-02 3 1  ON 11
ci_0013                 1.635468e-02 3 1  ON 12
ci_0014                 1.584374e-02 3 1  ON 13
ci_0015                 1.532058e-02 3 1  ON 14
ci_0016                 1.560323e-02 3 1  ON 15
ci_0017                 1.423553e-02 3 1  ON 16
ci_0018                 1.399039e-02 3 1  ON 17
ci_0019                 1.176426e-02 3 1  ON 18
ci_0020                 1.232331e-02 3 1  ON 19
ci_0021                 8.616880e-03 3 1  ON 20
ci_0022                 7.704472e-03 3 1  ON 21
ci_0023                -1.237785e-02 3 1  ON 22
ci_0024                -1.112232e-02 3 1  ON 23
ci_0025                -1.165834e-02 3 1  ON 24
ci_0026                -1.183771e-02 3 1  ON 25
ci_0027                -1.193430e-02 3 1  ON 26
ci_0028                -1.103871e-02 3 1  ON 27
ci_0029                -1.010483e-02 3 1  ON 28
ci_0030                -9.783867e-03 3 1  ON 29
ci_0031                 1.965807e-02 3 1  ON 30
ci_0032                 1.968181e-02 3 1  ON 31
ci_0033                 1.146158e-02 3 1  ON 32
ci_0034                 9.079042e-03 3 1  ON 33
ci_0035                 6.359672e-03 3 1  ON 34
ci_0036                 6.359998e-03 3 1  ON 35
ci_0037                -1.163460e-02 3 1  ON 36
ci_0038                -1.109010e-02 3 1  ON 37
ci_0039                -4.065574e-03 3 1  ON 38
ci_0040                -4.470164e-03 3 1  ON 39
ci_0041                 8.114873e-03 3 1  ON 40
ci_0042                 8.577709e-03 3 1  ON 41
ci_0043                -1.360107e-02 3 1  ON 42
ci_0044                -1.312476e-02 3 1  ON 43
ci_0045                 8.422802e-03 3 1  ON 44
ci_0046                 8.744560e-03 3 1  ON 45
ci_0047                -3.669585e-03 3 1  ON 46
ci_0048                -3.344859e-03 3 1  ON 47
ci_0049                -7.083990e-03 3 1  ON 48
ci_0050                -6.562331e-03 3 1  ON 49
ci_0051                -4.974526e-03 3 1  ON 50
ci_0052                -4.796069e-03 3 1  ON 51
ci_0053                -6.321519e-03 3 1  ON 52
ci_0054                -6.333723e-03 3 1  ON 53
ci_0055                 6.713759e-03 3 1  ON 54
ci_0056                 7.841250e-03 3 1  ON 55
ci_0057                 4.984384e-03 3 1  ON 56
ci_0058                 5.669115e-03 3 1  ON 57
ci_0059                -5.728495e-03 3 1  ON 58
ci_0060                -6.239451e-03 3 1  ON 59
ci_0061                -4.699402e-03 3 1  ON 60
ci_0062                -4.487276e-03 3 1  ON 61
ci_0063                -9.364132e-03 3 1  ON 62
ci_0064                -8.680025e-03 3 1  ON 63
ci_0065                -6.524226e-03 3 1  ON 64
ci_0066                -6.397436e-03 3 1  ON 65
ci_0067                -5.973420e-03 3 1  ON 66
ci_0068                -6.487933e-03 3 1  ON 67
ci_0069                 5.575781e-03 3 1  ON 68
ci_0070                 5.562416e-03 3 1  ON 69
ci_0071                 4.167545e-03 3 1  ON 70
ci_0072                 4.772396e-03 3 1  ON 71
ci_0073                 4.598902e-03 3 1  ON 72
ci_0074                 4.973801e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9517
    reference variance = 0.248332
====================================================
  Execution time = 1.6689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2160e-01
  Total weights = 1.9517e+06
  Execution time = 1.8888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310068577864
                                         uncertainty =       0.002066315535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310068577864
                                         uncertainty =       0.002066315535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393734287
  error estimate for blocks of size 2^( 2) =       0.000407705918
  error estimate for blocks of size 2^( 3) =       0.000422395206
  error estimate for blocks of size 2^( 4) =       0.000435525047
  error estimate for blocks of size 2^( 5) =       0.000446973202
  error estimate for blocks of size 2^( 6) =       0.000456876436
  error estimate for blocks of size 2^( 7) =       0.000465248452

      target function =                  N/A
              le_mean =     -16.904533695995
             les_mean =     286.084910874308
             stat err =       0.000451155784
             autocorr =       1.312945164548
              std dev =       0.556824368856
             le_variance =       0.310053377752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309983403323
                                         uncertainty =       0.002068920675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309983403323
                                         uncertainty =       0.002068920675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393679878
  error estimate for blocks of size 2^( 2) =       0.000407651387
  error estimate for blocks of size 2^( 3) =       0.000422342586
  error estimate for blocks of size 2^( 4) =       0.000435473118
  error estimate for blocks of size 2^( 5) =       0.000446922638
  error estimate for blocks of size 2^( 6) =       0.000456823927
  error estimate for blocks of size 2^( 7) =       0.000465193191

      target function =                  N/A
              le_mean =     -16.904535313027
             les_mean =     286.085242141507
             stat err =       0.000451103219
             autocorr =       1.313002085253
              std dev =       0.556747423220
             le_variance =       0.309967693262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310020198659
                                         uncertainty =       0.002067729561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310020198659
                                         uncertainty =       0.002067729561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393703403
  error estimate for blocks of size 2^( 2) =       0.000407674985
  error estimate for blocks of size 2^( 3) =       0.000422365357
  error estimate for blocks of size 2^( 4) =       0.000435495694
  error estimate for blocks of size 2^( 5) =       0.000446944626
  error estimate for blocks of size 2^( 6) =       0.000456846750
  error estimate for blocks of size 2^( 7) =       0.000465217181

      target function =                  N/A
              le_mean =     -16.904534363954
             les_mean =     286.085022191678
             stat err =       0.000451126063
             autocorr =       1.312978151956
              std dev =       0.556780691839
             le_variance =       0.310004738805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310062093386
                                         uncertainty =       0.002066493474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310062093386
                                         uncertainty =       0.002066493474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393730149
  error estimate for blocks of size 2^( 2) =       0.000407701773
  error estimate for blocks of size 2^( 3) =       0.000422391203
  error estimate for blocks of size 2^( 4) =       0.000435521122
  error estimate for blocks of size 2^( 5) =       0.000446969378
  error estimate for blocks of size 2^( 6) =       0.000456872479
  error estimate for blocks of size 2^( 7) =       0.000465244270

      target function =                  N/A
              le_mean =     -16.904533746146
             les_mean =     286.084831437795
             stat err =       0.000451151812
             autocorr =       1.312949643367
              std dev =       0.556818516931
             le_variance =       0.310046860797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904533695995        initial
     1.5259e+00     1.5259e+01             2.1425e-04       -16.904535313027  <--
     6.1035e+00     6.1035e+01             5.6439e-05       -16.904534363954
     2.4414e+01     2.4414e+02             1.4300e-05       -16.904533746146

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.6162e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.003846e-01 3 1  ON 0
ci_0002                 6.999820e-01 3 1  ON 1
ci_0003                -3.081707e-02 3 1  ON 2
ci_0004                -3.063408e-02 3 1  ON 3
ci_0005                -3.429224e-02 3 1  ON 4
ci_0006                -3.452013e-02 3 1  ON 5
ci_0007                -2.371864e-02 3 1  ON 6
ci_0008                -2.326208e-02 3 1  ON 7
ci_0009                -2.058566e-02 3 1  ON 8
ci_0010                -2.027581e-02 3 1  ON 9
ci_0011                -1.504548e-02 3 1  ON 10
ci_0012                -1.498725e-02 3 1  ON 11
ci_0013                 1.637014e-02 3 1  ON 12
ci_0014                 1.585102e-02 3 1  ON 13
ci_0015                 1.538115e-02 3 1  ON 14
ci_0016                 1.566388e-02 3 1  ON 15
ci_0017                 1.415922e-02 3 1  ON 16
ci_0018                 1.398631e-02 3 1  ON 17
ci_0019                 1.175196e-02 3 1  ON 18
ci_0020                 1.220879e-02 3 1  ON 19
ci_0021                 8.483749e-03 3 1  ON 20
ci_0022                 7.665708e-03 3 1  ON 21
ci_0023                -1.229076e-02 3 1  ON 22
ci_0024                -1.114988e-02 3 1  ON 23
ci_0025                -1.167406e-02 3 1  ON 24
ci_0026                -1.177473e-02 3 1  ON 25
ci_0027                -1.187919e-02 3 1  ON 26
ci_0028                -1.114162e-02 3 1  ON 27
ci_0029                -1.019281e-02 3 1  ON 28
ci_0030                -9.820877e-03 3 1  ON 29
ci_0031                 1.957972e-02 3 1  ON 30
ci_0032                 1.960628e-02 3 1  ON 31
ci_0033                 1.136830e-02 3 1  ON 32
ci_0034                 9.236854e-03 3 1  ON 33
ci_0035                 6.355096e-03 3 1  ON 34
ci_0036                 6.431428e-03 3 1  ON 35
ci_0037                -1.164410e-02 3 1  ON 36
ci_0038                -1.119506e-02 3 1  ON 37
ci_0039                -4.055905e-03 3 1  ON 38
ci_0040                -4.475777e-03 3 1  ON 39
ci_0041                 8.144994e-03 3 1  ON 40
ci_0042                 8.655665e-03 3 1  ON 41
ci_0043                -1.365731e-02 3 1  ON 42
ci_0044                -1.317549e-02 3 1  ON 43
ci_0045                 8.481808e-03 3 1  ON 44
ci_0046                 8.809006e-03 3 1  ON 45
ci_0047                -3.605224e-03 3 1  ON 46
ci_0048                -3.388337e-03 3 1  ON 47
ci_0049                -7.077905e-03 3 1  ON 48
ci_0050                -6.542050e-03 3 1  ON 49
ci_0051                -4.969089e-03 3 1  ON 50
ci_0052                -4.795293e-03 3 1  ON 51
ci_0053                -6.414337e-03 3 1  ON 52
ci_0054                -6.253655e-03 3 1  ON 53
ci_0055                 6.718370e-03 3 1  ON 54
ci_0056                 7.696582e-03 3 1  ON 55
ci_0057                 5.007011e-03 3 1  ON 56
ci_0058                 5.588334e-03 3 1  ON 57
ci_0059                -5.715562e-03 3 1  ON 58
ci_0060                -6.221962e-03 3 1  ON 59
ci_0061                -4.690240e-03 3 1  ON 60
ci_0062                -4.485824e-03 3 1  ON 61
ci_0063                -9.325734e-03 3 1  ON 62
ci_0064                -8.794190e-03 3 1  ON 63
ci_0065                -6.554670e-03 3 1  ON 64
ci_0066                -6.362137e-03 3 1  ON 65
ci_0067                -6.033420e-03 3 1  ON 66
ci_0068                -6.393997e-03 3 1  ON 67
ci_0069                 5.603027e-03 3 1  ON 68
ci_0070                 5.496761e-03 3 1  ON 69
ci_0071                 4.227787e-03 3 1  ON 70
ci_0072                 4.732817e-03 3 1  ON 71
ci_0073                 4.684568e-03 3 1  ON 72
ci_0074                 4.996798e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3484e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9905
    reference variance = 0.262657
====================================================
  Execution time = 1.4604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2531e-01
  Total weights = 1.951821067e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312047265305
                                         uncertainty =       0.001671820427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312047265305
                                         uncertainty =       0.001671820427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394980791
  error estimate for blocks of size 2^( 2) =       0.000409349825
  error estimate for blocks of size 2^( 3) =       0.000423579414
  error estimate for blocks of size 2^( 4) =       0.000435530996
  error estimate for blocks of size 2^( 5) =       0.000447098216
  error estimate for blocks of size 2^( 6) =       0.000454749798
  error estimate for blocks of size 2^( 7) =       0.000458722723

      target function =                  N/A
              le_mean =     -16.904187050503
             les_mean =     286.076850866658
             stat err =       0.000449025433
             autocorr =       1.292379115045
              std dev =       0.558587191222
             le_variance =       0.312019650198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690418705050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904187050497       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904199674061       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904199837018       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904199838258       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-01 is 9.136401e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904187050497       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904191317617       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904191564393       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904191555173       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.950361e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904187050497       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904188220248       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904188309351       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904188310336       residual = 2.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 7.961138e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7214e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.003630e-01 3 1  ON 0
ci_0002                 7.000238e-01 3 1  ON 1
ci_0003                -3.076598e-02 3 1  ON 2
ci_0004                -3.053435e-02 3 1  ON 3
ci_0005                -3.429991e-02 3 1  ON 4
ci_0006                -3.451518e-02 3 1  ON 5
ci_0007                -2.371545e-02 3 1  ON 6
ci_0008                -2.328389e-02 3 1  ON 7
ci_0009                -2.055226e-02 3 1  ON 8
ci_0010                -2.025558e-02 3 1  ON 9
ci_0011                -1.498096e-02 3 1  ON 10
ci_0012                -1.514858e-02 3 1  ON 11
ci_0013                 1.625040e-02 3 1  ON 12
ci_0014                 1.576994e-02 3 1  ON 13
ci_0015                 1.552253e-02 3 1  ON 14
ci_0016                 1.569908e-02 3 1  ON 15
ci_0017                 1.413403e-02 3 1  ON 16
ci_0018                 1.390474e-02 3 1  ON 17
ci_0019                 1.173699e-02 3 1  ON 18
ci_0020                 1.213471e-02 3 1  ON 19
ci_0021                 8.500284e-03 3 1  ON 20
ci_0022                 7.647490e-03 3 1  ON 21
ci_0023                -1.213334e-02 3 1  ON 22
ci_0024                -1.115262e-02 3 1  ON 23
ci_0025                -1.159826e-02 3 1  ON 24
ci_0026                -1.171479e-02 3 1  ON 25
ci_0027                -1.177330e-02 3 1  ON 26
ci_0028                -1.107394e-02 3 1  ON 27
ci_0029                -1.030108e-02 3 1  ON 28
ci_0030                -9.960993e-03 3 1  ON 29
ci_0031                 1.970104e-02 3 1  ON 30
ci_0032                 1.938118e-02 3 1  ON 31
ci_0033                 1.151187e-02 3 1  ON 32
ci_0034                 9.329102e-03 3 1  ON 33
ci_0035                 6.380149e-03 3 1  ON 34
ci_0036                 6.421471e-03 3 1  ON 35
ci_0037                -1.134907e-02 3 1  ON 36
ci_0038                -1.127431e-02 3 1  ON 37
ci_0039                -4.145937e-03 3 1  ON 38
ci_0040                -4.460929e-03 3 1  ON 39
ci_0041                 8.162501e-03 3 1  ON 40
ci_0042                 8.537018e-03 3 1  ON 41
ci_0043                -1.368598e-02 3 1  ON 42
ci_0044                -1.318480e-02 3 1  ON 43
ci_0045                 8.502306e-03 3 1  ON 44
ci_0046                 8.868294e-03 3 1  ON 45
ci_0047                -3.620760e-03 3 1  ON 46
ci_0048                -3.366621e-03 3 1  ON 47
ci_0049                -7.088773e-03 3 1  ON 48
ci_0050                -6.563961e-03 3 1  ON 49
ci_0051                -4.963809e-03 3 1  ON 50
ci_0052                -4.760140e-03 3 1  ON 51
ci_0053                -6.374298e-03 3 1  ON 52
ci_0054                -6.238957e-03 3 1  ON 53
ci_0055                 6.813018e-03 3 1  ON 54
ci_0056                 7.590974e-03 3 1  ON 55
ci_0057                 4.939227e-03 3 1  ON 56
ci_0058                 5.554322e-03 3 1  ON 57
ci_0059                -5.825429e-03 3 1  ON 58
ci_0060                -6.179238e-03 3 1  ON 59
ci_0061                -4.613555e-03 3 1  ON 60
ci_0062                -4.458094e-03 3 1  ON 61
ci_0063                -9.287927e-03 3 1  ON 62
ci_0064                -8.693975e-03 3 1  ON 63
ci_0065                -6.635862e-03 3 1  ON 64
ci_0066                -6.439147e-03 3 1  ON 65
ci_0067                -5.927684e-03 3 1  ON 66
ci_0068                -6.252304e-03 3 1  ON 67
ci_0069                 5.589420e-03 3 1  ON 68
ci_0070                 5.395340e-03 3 1  ON 69
ci_0071                 4.295344e-03 3 1  ON 70
ci_0072                 4.653943e-03 3 1  ON 71
ci_0073                 4.784815e-03 3 1  ON 72
ci_0074                 5.058781e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.189836
====================================================
  Execution time = 1.4197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2352e-01
  Total weights = 1.9518e+06
  Execution time = 1.8840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313413105512
                                         uncertainty =       0.002048418998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313413105512
                                         uncertainty =       0.002048418998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395897511
  error estimate for blocks of size 2^( 2) =       0.000410069928
  error estimate for blocks of size 2^( 3) =       0.000424641647
  error estimate for blocks of size 2^( 4) =       0.000437933812
  error estimate for blocks of size 2^( 5) =       0.000449324179
  error estimate for blocks of size 2^( 6) =       0.000458355069
  error estimate for blocks of size 2^( 7) =       0.000464597691

      target function =                  N/A
              le_mean =     -16.904183494415
             les_mean =     286.075532476083
             stat err =       0.000452552688
             autocorr =       1.306690561894
              std dev =       0.559883629658
             le_variance =       0.313469678759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313236453998
                                         uncertainty =       0.002047042458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313236453998
                                         uncertainty =       0.002047042458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395782769
  error estimate for blocks of size 2^( 2) =       0.000409974101
  error estimate for blocks of size 2^( 3) =       0.000424559119
  error estimate for blocks of size 2^( 4) =       0.000437855901
  error estimate for blocks of size 2^( 5) =       0.000449259433
  error estimate for blocks of size 2^( 6) =       0.000458273565
  error estimate for blocks of size 2^( 7) =       0.000464516931

      target function =                  N/A
              le_mean =     -16.904182125192
             les_mean =     286.076026855461
             stat err =       0.000452476457
             autocorr =       1.307007888950
              std dev =       0.559721360303
             le_variance =       0.313288001180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313268312792
                                         uncertainty =       0.002046114859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313268312792
                                         uncertainty =       0.002046114859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395803874
  error estimate for blocks of size 2^( 2) =       0.000409990378
  error estimate for blocks of size 2^( 3) =       0.000424573111
  error estimate for blocks of size 2^( 4) =       0.000437868738
  error estimate for blocks of size 2^( 5) =       0.000449270448
  error estimate for blocks of size 2^( 6) =       0.000458290064
  error estimate for blocks of size 2^( 7) =       0.000464536770

      target function =                  N/A
              le_mean =     -16.904181516028
             les_mean =     286.075951025978
             stat err =       0.000452491505
             autocorr =       1.306955436532
              std dev =       0.559751206363
             le_variance =       0.313321413025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313391623080
                                         uncertainty =       0.002047734693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313391623080
                                         uncertainty =       0.002047734693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395883635
  error estimate for blocks of size 2^( 2) =       0.000410059803
  error estimate for blocks of size 2^( 3) =       0.000424635643
  error estimate for blocks of size 2^( 4) =       0.000437926317
  error estimate for blocks of size 2^( 5) =       0.000449315466
  error estimate for blocks of size 2^( 6) =       0.000458348977
  error estimate for blocks of size 2^( 7) =       0.000464592761

      target function =                  N/A
              le_mean =     -16.904181034209
             les_mean =     286.179561247448
             stat err =       0.000452545880
             autocorr =       1.306742848837
              std dev =       0.559864006065
             le_variance =       0.313447705287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904183494415        initial  <--
     3.8147e-01     3.8147e+00             9.1364e-04       -16.904182125192
     1.5259e+00     1.5259e+01             2.9504e-04       -16.904181516028
     6.1035e+00     6.1035e+01             7.9611e-05       -16.904181034209

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6664
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.003846e-01 3 1  ON 0
ci_0002                 6.999820e-01 3 1  ON 1
ci_0003                -3.081707e-02 3 1  ON 2
ci_0004                -3.063408e-02 3 1  ON 3
ci_0005                -3.429224e-02 3 1  ON 4
ci_0006                -3.452013e-02 3 1  ON 5
ci_0007                -2.371864e-02 3 1  ON 6
ci_0008                -2.326208e-02 3 1  ON 7
ci_0009                -2.058566e-02 3 1  ON 8
ci_0010                -2.027581e-02 3 1  ON 9
ci_0011                -1.504548e-02 3 1  ON 10
ci_0012                -1.498725e-02 3 1  ON 11
ci_0013                 1.637014e-02 3 1  ON 12
ci_0014                 1.585102e-02 3 1  ON 13
ci_0015                 1.538115e-02 3 1  ON 14
ci_0016                 1.566388e-02 3 1  ON 15
ci_0017                 1.415922e-02 3 1  ON 16
ci_0018                 1.398631e-02 3 1  ON 17
ci_0019                 1.175196e-02 3 1  ON 18
ci_0020                 1.220879e-02 3 1  ON 19
ci_0021                 8.483749e-03 3 1  ON 20
ci_0022                 7.665708e-03 3 1  ON 21
ci_0023                -1.229076e-02 3 1  ON 22
ci_0024                -1.114988e-02 3 1  ON 23
ci_0025                -1.167406e-02 3 1  ON 24
ci_0026                -1.177473e-02 3 1  ON 25
ci_0027                -1.187919e-02 3 1  ON 26
ci_0028                -1.114162e-02 3 1  ON 27
ci_0029                -1.019281e-02 3 1  ON 28
ci_0030                -9.820877e-03 3 1  ON 29
ci_0031                 1.957972e-02 3 1  ON 30
ci_0032                 1.960628e-02 3 1  ON 31
ci_0033                 1.136830e-02 3 1  ON 32
ci_0034                 9.236854e-03 3 1  ON 33
ci_0035                 6.355096e-03 3 1  ON 34
ci_0036                 6.431428e-03 3 1  ON 35
ci_0037                -1.164410e-02 3 1  ON 36
ci_0038                -1.119506e-02 3 1  ON 37
ci_0039                -4.055905e-03 3 1  ON 38
ci_0040                -4.475777e-03 3 1  ON 39
ci_0041                 8.144994e-03 3 1  ON 40
ci_0042                 8.655665e-03 3 1  ON 41
ci_0043                -1.365731e-02 3 1  ON 42
ci_0044                -1.317549e-02 3 1  ON 43
ci_0045                 8.481808e-03 3 1  ON 44
ci_0046                 8.809006e-03 3 1  ON 45
ci_0047                -3.605224e-03 3 1  ON 46
ci_0048                -3.388337e-03 3 1  ON 47
ci_0049                -7.077905e-03 3 1  ON 48
ci_0050                -6.542050e-03 3 1  ON 49
ci_0051                -4.969089e-03 3 1  ON 50
ci_0052                -4.795293e-03 3 1  ON 51
ci_0053                -6.414337e-03 3 1  ON 52
ci_0054                -6.253655e-03 3 1  ON 53
ci_0055                 6.718370e-03 3 1  ON 54
ci_0056                 7.696582e-03 3 1  ON 55
ci_0057                 5.007011e-03 3 1  ON 56
ci_0058                 5.588334e-03 3 1  ON 57
ci_0059                -5.715562e-03 3 1  ON 58
ci_0060                -6.221962e-03 3 1  ON 59
ci_0061                -4.690240e-03 3 1  ON 60
ci_0062                -4.485824e-03 3 1  ON 61
ci_0063                -9.325734e-03 3 1  ON 62
ci_0064                -8.794190e-03 3 1  ON 63
ci_0065                -6.554670e-03 3 1  ON 64
ci_0066                -6.362137e-03 3 1  ON 65
ci_0067                -6.033420e-03 3 1  ON 66
ci_0068                -6.393997e-03 3 1  ON 67
ci_0069                 5.603027e-03 3 1  ON 68
ci_0070                 5.496761e-03 3 1  ON 69
ci_0071                 4.227787e-03 3 1  ON 70
ci_0072                 4.732817e-03 3 1  ON 71
ci_0073                 4.684568e-03 3 1  ON 72
ci_0074                 4.996798e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9001
    reference variance = 0.613226
====================================================
  Execution time = 1.4527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2543e-01
  Total weights = 1.951597044e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312239052782
                                         uncertainty =       0.002104863020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312239052782
                                         uncertainty =       0.002104863020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395112879
  error estimate for blocks of size 2^( 2) =       0.000409408286
  error estimate for blocks of size 2^( 3) =       0.000423263025
  error estimate for blocks of size 2^( 4) =       0.000436988841
  error estimate for blocks of size 2^( 5) =       0.000448624888
  error estimate for blocks of size 2^( 6) =       0.000457852502
  error estimate for blocks of size 2^( 7) =       0.000464300367

      target function =                  N/A
              le_mean =     -16.904641432385
             les_mean =     286.092330729321
             stat err =       0.000451941650
             autocorr =       1.308345243536
              std dev =       0.558773992762
             le_variance =       0.312228374988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690464143238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904641432404       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904643166077       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904643088756       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904643083471       residual = 1.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+00 is 1.243553e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904641432404       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904641883990       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904641865494       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904641864259       residual = 2.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 3.233418e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904641432404       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904641546496       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904641541939       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904641541642       residual = 2.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 8.165329e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7146e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.003813e-01 3 1  ON 0
ci_0002                 6.999867e-01 3 1  ON 1
ci_0003                -3.079737e-02 3 1  ON 2
ci_0004                -3.063162e-02 3 1  ON 3
ci_0005                -3.427701e-02 3 1  ON 4
ci_0006                -3.450998e-02 3 1  ON 5
ci_0007                -2.371087e-02 3 1  ON 6
ci_0008                -2.325128e-02 3 1  ON 7
ci_0009                -2.057824e-02 3 1  ON 8
ci_0010                -2.026660e-02 3 1  ON 9
ci_0011                -1.506407e-02 3 1  ON 10
ci_0012                -1.498121e-02 3 1  ON 11
ci_0013                 1.637024e-02 3 1  ON 12
ci_0014                 1.584305e-02 3 1  ON 13
ci_0015                 1.539823e-02 3 1  ON 14
ci_0016                 1.567953e-02 3 1  ON 15
ci_0017                 1.415939e-02 3 1  ON 16
ci_0018                 1.399260e-02 3 1  ON 17
ci_0019                 1.176529e-02 3 1  ON 18
ci_0020                 1.221168e-02 3 1  ON 19
ci_0021                 8.476837e-03 3 1  ON 20
ci_0022                 7.666437e-03 3 1  ON 21
ci_0023                -1.226915e-02 3 1  ON 22
ci_0024                -1.114683e-02 3 1  ON 23
ci_0025                -1.166971e-02 3 1  ON 24
ci_0026                -1.178476e-02 3 1  ON 25
ci_0027                -1.188989e-02 3 1  ON 26
ci_0028                -1.114127e-02 3 1  ON 27
ci_0029                -1.019928e-02 3 1  ON 28
ci_0030                -9.853211e-03 3 1  ON 29
ci_0031                 1.956388e-02 3 1  ON 30
ci_0032                 1.961221e-02 3 1  ON 31
ci_0033                 1.136379e-02 3 1  ON 32
ci_0034                 9.236204e-03 3 1  ON 33
ci_0035                 6.369841e-03 3 1  ON 34
ci_0036                 6.452311e-03 3 1  ON 35
ci_0037                -1.163855e-02 3 1  ON 36
ci_0038                -1.118687e-02 3 1  ON 37
ci_0039                -4.049426e-03 3 1  ON 38
ci_0040                -4.466836e-03 3 1  ON 39
ci_0041                 8.138613e-03 3 1  ON 40
ci_0042                 8.668954e-03 3 1  ON 41
ci_0043                -1.366674e-02 3 1  ON 42
ci_0044                -1.316945e-02 3 1  ON 43
ci_0045                 8.479435e-03 3 1  ON 44
ci_0046                 8.812372e-03 3 1  ON 45
ci_0047                -3.583245e-03 3 1  ON 46
ci_0048                -3.392576e-03 3 1  ON 47
ci_0049                -7.078105e-03 3 1  ON 48
ci_0050                -6.560852e-03 3 1  ON 49
ci_0051                -4.980858e-03 3 1  ON 50
ci_0052                -4.781451e-03 3 1  ON 51
ci_0053                -6.412422e-03 3 1  ON 52
ci_0054                -6.254964e-03 3 1  ON 53
ci_0055                 6.721510e-03 3 1  ON 54
ci_0056                 7.684030e-03 3 1  ON 55
ci_0057                 5.004587e-03 3 1  ON 56
ci_0058                 5.596045e-03 3 1  ON 57
ci_0059                -5.730392e-03 3 1  ON 58
ci_0060                -6.229243e-03 3 1  ON 59
ci_0061                -4.687139e-03 3 1  ON 60
ci_0062                -4.483477e-03 3 1  ON 61
ci_0063                -9.314538e-03 3 1  ON 62
ci_0064                -8.822400e-03 3 1  ON 63
ci_0065                -6.572880e-03 3 1  ON 64
ci_0066                -6.365802e-03 3 1  ON 65
ci_0067                -6.039477e-03 3 1  ON 66
ci_0068                -6.390037e-03 3 1  ON 67
ci_0069                 5.599476e-03 3 1  ON 68
ci_0070                 5.495071e-03 3 1  ON 69
ci_0071                 4.231226e-03 3 1  ON 70
ci_0072                 4.721553e-03 3 1  ON 71
ci_0073                 4.704780e-03 3 1  ON 72
ci_0074                 4.999764e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8466
    reference variance = 0.268892
====================================================
  Execution time = 1.4159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3001e-01
  Total weights = 1.9517e+06
  Execution time = 1.8776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316853669057
                                         uncertainty =       0.002552794230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316853669057
                                         uncertainty =       0.002552794230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398088752
  error estimate for blocks of size 2^( 2) =       0.000412321254
  error estimate for blocks of size 2^( 3) =       0.000426543787
  error estimate for blocks of size 2^( 4) =       0.000440146030
  error estimate for blocks of size 2^( 5) =       0.000452807118
  error estimate for blocks of size 2^( 6) =       0.000463572279
  error estimate for blocks of size 2^( 7) =       0.000466968034

      target function =                  N/A
              le_mean =     -16.903910908732
             les_mean =     286.072215475234
             stat err =       0.000455873365
             autocorr =       1.311380205971
              std dev =       0.562982512078
             le_variance =       0.316949308905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316902546109
                                         uncertainty =       0.002556016729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316902546109
                                         uncertainty =       0.002556016729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398119429
  error estimate for blocks of size 2^( 2) =       0.000412348440
  error estimate for blocks of size 2^( 3) =       0.000426567797
  error estimate for blocks of size 2^( 4) =       0.000440167664
  error estimate for blocks of size 2^( 5) =       0.000452825505
  error estimate for blocks of size 2^( 6) =       0.000463593374
  error estimate for blocks of size 2^( 7) =       0.000466990483

      target function =                  N/A
              le_mean =     -16.903910596791
             les_mean =     286.076640592191
             stat err =       0.000455894256
             autocorr =       1.311298292851
              std dev =       0.563025896279
             le_variance =       0.316998159881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316878690646
                                         uncertainty =       0.002554491053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316878690646
                                         uncertainty =       0.002554491053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398104456
  error estimate for blocks of size 2^( 2) =       0.000412335205
  error estimate for blocks of size 2^( 3) =       0.000426555778
  error estimate for blocks of size 2^( 4) =       0.000440156592
  error estimate for blocks of size 2^( 5) =       0.000452815989
  error estimate for blocks of size 2^( 6) =       0.000463583076
  error estimate for blocks of size 2^( 7) =       0.000466978940

      target function =                  N/A
              le_mean =     -16.903910752980
             les_mean =     286.087125051311
             stat err =       0.000455883649
             autocorr =       1.311335911397
              std dev =       0.563004720988
             le_variance =       0.316974315855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316856747998
                                         uncertainty =       0.002553008403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316856747998
                                         uncertainty =       0.002553008403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398090684
  error estimate for blocks of size 2^( 2) =       0.000412322961
  error estimate for blocks of size 2^( 3) =       0.000426545241
  error estimate for blocks of size 2^( 4) =       0.000440147316
  error estimate for blocks of size 2^( 5) =       0.000452808196
  error estimate for blocks of size 2^( 6) =       0.000463573566
  error estimate for blocks of size 2^( 7) =       0.000466969396

      target function =                  N/A
              le_mean =     -16.903910851625
             les_mean =     286.072212281039
             stat err =       0.000455874618
             autocorr =       1.311374684763
              std dev =       0.562985244989
             le_variance =       0.316952386076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903910908732        initial  <--
     3.8147e+00     3.8147e+01             1.2436e-04       -16.903910596791
     1.5259e+01     1.5259e+02             3.2334e-05       -16.903910752980
     6.1035e+01     6.1035e+02             8.1653e-06       -16.903910851625

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5764
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.003846e-01 3 1  ON 0
ci_0002                 6.999820e-01 3 1  ON 1
ci_0003                -3.081707e-02 3 1  ON 2
ci_0004                -3.063408e-02 3 1  ON 3
ci_0005                -3.429224e-02 3 1  ON 4
ci_0006                -3.452013e-02 3 1  ON 5
ci_0007                -2.371864e-02 3 1  ON 6
ci_0008                -2.326208e-02 3 1  ON 7
ci_0009                -2.058566e-02 3 1  ON 8
ci_0010                -2.027581e-02 3 1  ON 9
ci_0011                -1.504548e-02 3 1  ON 10
ci_0012                -1.498725e-02 3 1  ON 11
ci_0013                 1.637014e-02 3 1  ON 12
ci_0014                 1.585102e-02 3 1  ON 13
ci_0015                 1.538115e-02 3 1  ON 14
ci_0016                 1.566388e-02 3 1  ON 15
ci_0017                 1.415922e-02 3 1  ON 16
ci_0018                 1.398631e-02 3 1  ON 17
ci_0019                 1.175196e-02 3 1  ON 18
ci_0020                 1.220879e-02 3 1  ON 19
ci_0021                 8.483749e-03 3 1  ON 20
ci_0022                 7.665708e-03 3 1  ON 21
ci_0023                -1.229076e-02 3 1  ON 22
ci_0024                -1.114988e-02 3 1  ON 23
ci_0025                -1.167406e-02 3 1  ON 24
ci_0026                -1.177473e-02 3 1  ON 25
ci_0027                -1.187919e-02 3 1  ON 26
ci_0028                -1.114162e-02 3 1  ON 27
ci_0029                -1.019281e-02 3 1  ON 28
ci_0030                -9.820877e-03 3 1  ON 29
ci_0031                 1.957972e-02 3 1  ON 30
ci_0032                 1.960628e-02 3 1  ON 31
ci_0033                 1.136830e-02 3 1  ON 32
ci_0034                 9.236854e-03 3 1  ON 33
ci_0035                 6.355096e-03 3 1  ON 34
ci_0036                 6.431428e-03 3 1  ON 35
ci_0037                -1.164410e-02 3 1  ON 36
ci_0038                -1.119506e-02 3 1  ON 37
ci_0039                -4.055905e-03 3 1  ON 38
ci_0040                -4.475777e-03 3 1  ON 39
ci_0041                 8.144994e-03 3 1  ON 40
ci_0042                 8.655665e-03 3 1  ON 41
ci_0043                -1.365731e-02 3 1  ON 42
ci_0044                -1.317549e-02 3 1  ON 43
ci_0045                 8.481808e-03 3 1  ON 44
ci_0046                 8.809006e-03 3 1  ON 45
ci_0047                -3.605224e-03 3 1  ON 46
ci_0048                -3.388337e-03 3 1  ON 47
ci_0049                -7.077905e-03 3 1  ON 48
ci_0050                -6.542050e-03 3 1  ON 49
ci_0051                -4.969089e-03 3 1  ON 50
ci_0052                -4.795293e-03 3 1  ON 51
ci_0053                -6.414337e-03 3 1  ON 52
ci_0054                -6.253655e-03 3 1  ON 53
ci_0055                 6.718370e-03 3 1  ON 54
ci_0056                 7.696582e-03 3 1  ON 55
ci_0057                 5.007011e-03 3 1  ON 56
ci_0058                 5.588334e-03 3 1  ON 57
ci_0059                -5.715562e-03 3 1  ON 58
ci_0060                -6.221962e-03 3 1  ON 59
ci_0061                -4.690240e-03 3 1  ON 60
ci_0062                -4.485824e-03 3 1  ON 61
ci_0063                -9.325734e-03 3 1  ON 62
ci_0064                -8.794190e-03 3 1  ON 63
ci_0065                -6.554670e-03 3 1  ON 64
ci_0066                -6.362137e-03 3 1  ON 65
ci_0067                -6.033420e-03 3 1  ON 66
ci_0068                -6.393997e-03 3 1  ON 67
ci_0069                 5.603027e-03 3 1  ON 68
ci_0070                 5.496761e-03 3 1  ON 69
ci_0071                 4.227787e-03 3 1  ON 70
ci_0072                 4.732817e-03 3 1  ON 71
ci_0073                 4.684568e-03 3 1  ON 72
ci_0074                 4.996798e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.7788
    reference variance = 0.439676
====================================================
  Execution time = 1.4503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2333e-01
  Total weights = 1.951652549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311939485361
                                         uncertainty =       0.002231332060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311939485361
                                         uncertainty =       0.002231332060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394875745
  error estimate for blocks of size 2^( 2) =       0.000409440522
  error estimate for blocks of size 2^( 3) =       0.000424197107
  error estimate for blocks of size 2^( 4) =       0.000436941607
  error estimate for blocks of size 2^( 5) =       0.000448224210
  error estimate for blocks of size 2^( 6) =       0.000458021271
  error estimate for blocks of size 2^( 7) =       0.000464406101

      target function =                  N/A
              le_mean =     -16.904480339889
             les_mean =     286.084781266029
             stat err =       0.000451898298
             autocorr =       1.309665821551
              std dev =       0.558438634106
             le_variance =       0.311853708063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690448033989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904480339907       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904480620363       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904480622032       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904480623641       residual = 3.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.658897e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904480339907       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904480410333       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904480410785       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904480411187       residual = 3.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 4.163708e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904480339907       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904480357533       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904480357648       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904480357748       residual = 3.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 1.041961e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7183e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.003853e-01 3 1  ON 0
ci_0002                 6.999816e-01 3 1  ON 1
ci_0003                -3.081696e-02 3 1  ON 2
ci_0004                -3.063309e-02 3 1  ON 3
ci_0005                -3.429174e-02 3 1  ON 4
ci_0006                -3.451947e-02 3 1  ON 5
ci_0007                -2.371822e-02 3 1  ON 6
ci_0008                -2.326216e-02 3 1  ON 7
ci_0009                -2.058494e-02 3 1  ON 8
ci_0010                -2.027445e-02 3 1  ON 9
ci_0011                -1.504556e-02 3 1  ON 10
ci_0012                -1.498840e-02 3 1  ON 11
ci_0013                 1.636858e-02 3 1  ON 12
ci_0014                 1.585129e-02 3 1  ON 13
ci_0015                 1.538137e-02 3 1  ON 14
ci_0016                 1.566378e-02 3 1  ON 15
ci_0017                 1.415881e-02 3 1  ON 16
ci_0018                 1.398646e-02 3 1  ON 17
ci_0019                 1.175139e-02 3 1  ON 18
ci_0020                 1.220834e-02 3 1  ON 19
ci_0021                 8.482180e-03 3 1  ON 20
ci_0022                 7.663929e-03 3 1  ON 21
ci_0023                -1.228875e-02 3 1  ON 22
ci_0024                -1.115082e-02 3 1  ON 23
ci_0025                -1.167504e-02 3 1  ON 24
ci_0026                -1.177258e-02 3 1  ON 25
ci_0027                -1.187886e-02 3 1  ON 26
ci_0028                -1.114251e-02 3 1  ON 27
ci_0029                -1.019282e-02 3 1  ON 28
ci_0030                -9.825041e-03 3 1  ON 29
ci_0031                 1.958004e-02 3 1  ON 30
ci_0032                 1.960576e-02 3 1  ON 31
ci_0033                 1.136722e-02 3 1  ON 32
ci_0034                 9.238676e-03 3 1  ON 33
ci_0035                 6.354636e-03 3 1  ON 34
ci_0036                 6.430468e-03 3 1  ON 35
ci_0037                -1.164402e-02 3 1  ON 36
ci_0038                -1.119387e-02 3 1  ON 37
ci_0039                -4.054727e-03 3 1  ON 38
ci_0040                -4.474192e-03 3 1  ON 39
ci_0041                 8.145289e-03 3 1  ON 40
ci_0042                 8.655543e-03 3 1  ON 41
ci_0043                -1.365637e-02 3 1  ON 42
ci_0044                -1.317557e-02 3 1  ON 43
ci_0045                 8.481963e-03 3 1  ON 44
ci_0046                 8.808987e-03 3 1  ON 45
ci_0047                -3.602866e-03 3 1  ON 46
ci_0048                -3.388723e-03 3 1  ON 47
ci_0049                -7.076868e-03 3 1  ON 48
ci_0050                -6.542339e-03 3 1  ON 49
ci_0051                -4.968377e-03 3 1  ON 50
ci_0052                -4.795915e-03 3 1  ON 51
ci_0053                -6.415675e-03 3 1  ON 52
ci_0054                -6.253124e-03 3 1  ON 53
ci_0055                 6.719321e-03 3 1  ON 54
ci_0056                 7.696217e-03 3 1  ON 55
ci_0057                 5.006652e-03 3 1  ON 56
ci_0058                 5.588868e-03 3 1  ON 57
ci_0059                -5.716814e-03 3 1  ON 58
ci_0060                -6.219444e-03 3 1  ON 59
ci_0061                -4.688008e-03 3 1  ON 60
ci_0062                -4.486412e-03 3 1  ON 61
ci_0063                -9.325437e-03 3 1  ON 62
ci_0064                -8.794517e-03 3 1  ON 63
ci_0065                -6.553511e-03 3 1  ON 64
ci_0066                -6.362671e-03 3 1  ON 65
ci_0067                -6.035210e-03 3 1  ON 66
ci_0068                -6.391735e-03 3 1  ON 67
ci_0069                 5.603318e-03 3 1  ON 68
ci_0070                 5.496786e-03 3 1  ON 69
ci_0071                 4.228415e-03 3 1  ON 70
ci_0072                 4.733915e-03 3 1  ON 71
ci_0073                 4.685536e-03 3 1  ON 72
ci_0074                 4.997313e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8641
    reference variance = 0.181473
====================================================
  Execution time = 1.4167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2033e-01
  Total weights = 1.9519e+06
  Execution time = 1.8736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309442114352
                                         uncertainty =       0.001998750383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309442114352
                                         uncertainty =       0.001998750383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393310917
  error estimate for blocks of size 2^( 2) =       0.000407085526
  error estimate for blocks of size 2^( 3) =       0.000421535213
  error estimate for blocks of size 2^( 4) =       0.000434634535
  error estimate for blocks of size 2^( 5) =       0.000444527080
  error estimate for blocks of size 2^( 6) =       0.000452796204
  error estimate for blocks of size 2^( 7) =       0.000454890465

      target function =                  N/A
              le_mean =     -16.904810858894
             les_mean =     286.092954605694
             stat err =       0.000446712071
             autocorr =       1.289981183393
              std dev =       0.556225632352
             le_variance =       0.309386954086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309439499525
                                         uncertainty =       0.001998628271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309439499525
                                         uncertainty =       0.001998628271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393309247
  error estimate for blocks of size 2^( 2) =       0.000407084004
  error estimate for blocks of size 2^( 3) =       0.000421534060
  error estimate for blocks of size 2^( 4) =       0.000434633441
  error estimate for blocks of size 2^( 5) =       0.000444526104
  error estimate for blocks of size 2^( 6) =       0.000452794601
  error estimate for blocks of size 2^( 7) =       0.000454888769

      target function =                  N/A
              le_mean =     -16.904811013758
             les_mean =     286.092968570607
             stat err =       0.000446710729
             autocorr =       1.289984382985
              std dev =       0.556223270856
             le_variance =       0.309384327042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309440793819
                                         uncertainty =       0.001998688836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309440793819
                                         uncertainty =       0.001998688836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393310073
  error estimate for blocks of size 2^( 2) =       0.000407084757
  error estimate for blocks of size 2^( 3) =       0.000421534630
  error estimate for blocks of size 2^( 4) =       0.000434633981
  error estimate for blocks of size 2^( 5) =       0.000444526585
  error estimate for blocks of size 2^( 6) =       0.000452795394
  error estimate for blocks of size 2^( 7) =       0.000454889607

      target function =                  N/A
              le_mean =     -16.904810935542
             les_mean =     286.092959454309
             stat err =       0.000446711392
             autocorr =       1.289982792926
              std dev =       0.556224439783
             le_variance =       0.309385627411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441948386
                                         uncertainty =       0.001998742667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441948386
                                         uncertainty =       0.001998742667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393310811
  error estimate for blocks of size 2^( 2) =       0.000407085429
  error estimate for blocks of size 2^( 3) =       0.000421535140
  error estimate for blocks of size 2^( 4) =       0.000434634466
  error estimate for blocks of size 2^( 5) =       0.000444527018
  error estimate for blocks of size 2^( 6) =       0.000452796102
  error estimate for blocks of size 2^( 7) =       0.000454890358

      target function =                  N/A
              le_mean =     -16.904810868372
             les_mean =     286.092955070165
             stat err =       0.000446711986
             autocorr =       1.289981385113
              std dev =       0.556225482473
             le_variance =       0.309386787352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904810858894        initial
     3.8147e+01     3.8147e+02             1.6589e-05       -16.904811013758  <--
     1.5259e+02     1.5259e+03             4.1637e-06       -16.904810935542
     6.1035e+02     6.1035e+03             1.0420e-06       -16.904810868372

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.3584e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.003873e-01 3 1  ON 0
ci_0002                 6.999804e-01 3 1  ON 1
ci_0003                -3.081663e-02 3 1  ON 2
ci_0004                -3.063014e-02 3 1  ON 3
ci_0005                -3.429024e-02 3 1  ON 4
ci_0006                -3.451751e-02 3 1  ON 5
ci_0007                -2.371696e-02 3 1  ON 6
ci_0008                -2.326238e-02 3 1  ON 7
ci_0009                -2.058279e-02 3 1  ON 8
ci_0010                -2.027040e-02 3 1  ON 9
ci_0011                -1.504582e-02 3 1  ON 10
ci_0012                -1.499183e-02 3 1  ON 11
ci_0013                 1.636393e-02 3 1  ON 12
ci_0014                 1.585208e-02 3 1  ON 13
ci_0015                 1.538204e-02 3 1  ON 14
ci_0016                 1.566349e-02 3 1  ON 15
ci_0017                 1.415757e-02 3 1  ON 16
ci_0018                 1.398690e-02 3 1  ON 17
ci_0019                 1.174969e-02 3 1  ON 18
ci_0020                 1.220701e-02 3 1  ON 19
ci_0021                 8.477485e-03 3 1  ON 20
ci_0022                 7.658610e-03 3 1  ON 21
ci_0023                -1.228276e-02 3 1  ON 22
ci_0024                -1.115364e-02 3 1  ON 23
ci_0025                -1.167799e-02 3 1  ON 24
ci_0026                -1.176614e-02 3 1  ON 25
ci_0027                -1.187789e-02 3 1  ON 26
ci_0028                -1.114514e-02 3 1  ON 27
ci_0029                -1.019286e-02 3 1  ON 28
ci_0030                -9.837466e-03 3 1  ON 29
ci_0031                 1.958097e-02 3 1  ON 30
ci_0032                 1.960421e-02 3 1  ON 31
ci_0033                 1.136397e-02 3 1  ON 32
ci_0034                 9.244127e-03 3 1  ON 33
ci_0035                 6.353263e-03 3 1  ON 34
ci_0036                 6.427601e-03 3 1  ON 35
ci_0037                -1.164379e-02 3 1  ON 36
ci_0038                -1.119032e-02 3 1  ON 37
ci_0039                -4.051227e-03 3 1  ON 38
ci_0040                -4.469485e-03 3 1  ON 39
ci_0041                 8.146170e-03 3 1  ON 40
ci_0042                 8.655179e-03 3 1  ON 41
ci_0043                -1.365357e-02 3 1  ON 42
ci_0044                -1.317582e-02 3 1  ON 43
ci_0045                 8.482428e-03 3 1  ON 44
ci_0046                 8.808927e-03 3 1  ON 45
ci_0047                -3.595855e-03 3 1  ON 46
ci_0048                -3.389868e-03 3 1  ON 47
ci_0049                -7.073774e-03 3 1  ON 48
ci_0050                -6.543204e-03 3 1  ON 49
ci_0051                -4.966257e-03 3 1  ON 50
ci_0052                -4.797767e-03 3 1  ON 51
ci_0053                -6.419658e-03 3 1  ON 52
ci_0054                -6.251546e-03 3 1  ON 53
ci_0055                 6.722162e-03 3 1  ON 54
ci_0056                 7.695128e-03 3 1  ON 55
ci_0057                 5.005585e-03 3 1  ON 56
ci_0058                 5.590463e-03 3 1  ON 57
ci_0059                -5.720541e-03 3 1  ON 58
ci_0060                -6.211949e-03 3 1  ON 59
ci_0061                -4.681349e-03 3 1  ON 60
ci_0062                -4.488167e-03 3 1  ON 61
ci_0063                -9.324551e-03 3 1  ON 62
ci_0064                -8.795493e-03 3 1  ON 63
ci_0065                -6.550054e-03 3 1  ON 64
ci_0066                -6.364261e-03 3 1  ON 65
ci_0067                -6.040536e-03 3 1  ON 66
ci_0068                -6.385011e-03 3 1  ON 67
ci_0069                 5.604185e-03 3 1  ON 68
ci_0070                 5.496859e-03 3 1  ON 69
ci_0071                 4.230295e-03 3 1  ON 70
ci_0072                 4.737188e-03 3 1  ON 71
ci_0073                 4.688416e-03 3 1  ON 72
ci_0074                 4.998846e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.7778
    reference variance = 0.292676
====================================================
  Execution time = 1.4596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2305e-01
  Total weights = 1.951919340e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310937159019
                                         uncertainty =       0.001769817660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310937159019
                                         uncertainty =       0.001769817660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394314751
  error estimate for blocks of size 2^( 2) =       0.000407923159
  error estimate for blocks of size 2^( 3) =       0.000422143828
  error estimate for blocks of size 2^( 4) =       0.000435212436
  error estimate for blocks of size 2^( 5) =       0.000447006718
  error estimate for blocks of size 2^( 6) =       0.000454739525
  error estimate for blocks of size 2^( 7) =       0.000460860909

      target function =                  N/A
              le_mean =     -16.904868204843
             les_mean =     286.097622543977
             stat err =       0.000449454897
             autocorr =       1.299230432020
              std dev =       0.557645269160
             le_variance =       0.310968246217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690486820484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904868204890       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904869096410       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904869106064       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 4.037694e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904868204890       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904868431439       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904868434523       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.026263e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904868204890       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904868261761       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904868262576       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.576425e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7256e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.003875e-01 3 1  ON 0
ci_0002                 6.999808e-01 3 1  ON 1
ci_0003                -3.081512e-02 3 1  ON 2
ci_0004                -3.063094e-02 3 1  ON 3
ci_0005                -3.429326e-02 3 1  ON 4
ci_0006                -3.451687e-02 3 1  ON 5
ci_0007                -2.371745e-02 3 1  ON 6
ci_0008                -2.326067e-02 3 1  ON 7
ci_0009                -2.057881e-02 3 1  ON 8
ci_0010                -2.027055e-02 3 1  ON 9
ci_0011                -1.505115e-02 3 1  ON 10
ci_0012                -1.498984e-02 3 1  ON 11
ci_0013                 1.636024e-02 3 1  ON 12
ci_0014                 1.585059e-02 3 1  ON 13
ci_0015                 1.538221e-02 3 1  ON 14
ci_0016                 1.566164e-02 3 1  ON 15
ci_0017                 1.415551e-02 3 1  ON 16
ci_0018                 1.398522e-02 3 1  ON 17
ci_0019                 1.175124e-02 3 1  ON 18
ci_0020                 1.220547e-02 3 1  ON 19
ci_0021                 8.473217e-03 3 1  ON 20
ci_0022                 7.660774e-03 3 1  ON 21
ci_0023                -1.227594e-02 3 1  ON 22
ci_0024                -1.115771e-02 3 1  ON 23
ci_0025                -1.167948e-02 3 1  ON 24
ci_0026                -1.176359e-02 3 1  ON 25
ci_0027                -1.187287e-02 3 1  ON 26
ci_0028                -1.114626e-02 3 1  ON 27
ci_0029                -1.019983e-02 3 1  ON 28
ci_0030                -9.841438e-03 3 1  ON 29
ci_0031                 1.957484e-02 3 1  ON 30
ci_0032                 1.959913e-02 3 1  ON 31
ci_0033                 1.136287e-02 3 1  ON 32
ci_0034                 9.246661e-03 3 1  ON 33
ci_0035                 6.355804e-03 3 1  ON 34
ci_0036                 6.428714e-03 3 1  ON 35
ci_0037                -1.164031e-02 3 1  ON 36
ci_0038                -1.119248e-02 3 1  ON 37
ci_0039                -4.050053e-03 3 1  ON 38
ci_0040                -4.464295e-03 3 1  ON 39
ci_0041                 8.148470e-03 3 1  ON 40
ci_0042                 8.665441e-03 3 1  ON 41
ci_0043                -1.365407e-02 3 1  ON 42
ci_0044                -1.317644e-02 3 1  ON 43
ci_0045                 8.482487e-03 3 1  ON 44
ci_0046                 8.802934e-03 3 1  ON 45
ci_0047                -3.595427e-03 3 1  ON 46
ci_0048                -3.389569e-03 3 1  ON 47
ci_0049                -7.064689e-03 3 1  ON 48
ci_0050                -6.544028e-03 3 1  ON 49
ci_0051                -4.964860e-03 3 1  ON 50
ci_0052                -4.795353e-03 3 1  ON 51
ci_0053                -6.418005e-03 3 1  ON 52
ci_0054                -6.246755e-03 3 1  ON 53
ci_0055                 6.717774e-03 3 1  ON 54
ci_0056                 7.690595e-03 3 1  ON 55
ci_0057                 5.014516e-03 3 1  ON 56
ci_0058                 5.589742e-03 3 1  ON 57
ci_0059                -5.720584e-03 3 1  ON 58
ci_0060                -6.216426e-03 3 1  ON 59
ci_0061                -4.676692e-03 3 1  ON 60
ci_0062                -4.484328e-03 3 1  ON 61
ci_0063                -9.324062e-03 3 1  ON 62
ci_0064                -8.795772e-03 3 1  ON 63
ci_0065                -6.555323e-03 3 1  ON 64
ci_0066                -6.367797e-03 3 1  ON 65
ci_0067                -6.037875e-03 3 1  ON 66
ci_0068                -6.385903e-03 3 1  ON 67
ci_0069                 5.601927e-03 3 1  ON 68
ci_0070                 5.497194e-03 3 1  ON 69
ci_0071                 4.238078e-03 3 1  ON 70
ci_0072                 4.736016e-03 3 1  ON 71
ci_0073                 4.696822e-03 3 1  ON 72
ci_0074                 5.000545e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.226194
====================================================
  Execution time = 1.4110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2383e-01
  Total weights = 1.9514e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312631635538
                                         uncertainty =       0.001911040934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312631635538
                                         uncertainty =       0.001911040934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395338293
  error estimate for blocks of size 2^( 2) =       0.000409333888
  error estimate for blocks of size 2^( 3) =       0.000423765136
  error estimate for blocks of size 2^( 4) =       0.000437640865
  error estimate for blocks of size 2^( 5) =       0.000449516569
  error estimate for blocks of size 2^( 6) =       0.000459063690
  error estimate for blocks of size 2^( 7) =       0.000463527726

      target function =                  N/A
              le_mean =     -16.904330672522
             les_mean =     286.080245096098
             stat err =       0.000452437213
             autocorr =       1.309721238613
              std dev =       0.559092776256
             le_variance =       0.312584732462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312614087059
                                         uncertainty =       0.001910839561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312614087059
                                         uncertainty =       0.001910839561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395327194
  error estimate for blocks of size 2^( 2) =       0.000409323251
  error estimate for blocks of size 2^( 3) =       0.000423755067
  error estimate for blocks of size 2^( 4) =       0.000437631417
  error estimate for blocks of size 2^( 5) =       0.000449508295
  error estimate for blocks of size 2^( 6) =       0.000459055592
  error estimate for blocks of size 2^( 7) =       0.000463520001

      target function =                  N/A
              le_mean =     -16.904331070389
             les_mean =     286.080203698535
             stat err =       0.000452428826
             autocorr =       1.309746228270
              std dev =       0.559077078819
             le_variance =       0.312567180061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312622645416
                                         uncertainty =       0.001910938873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312622645416
                                         uncertainty =       0.001910938873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395332607
  error estimate for blocks of size 2^( 2) =       0.000409328438
  error estimate for blocks of size 2^( 3) =       0.000423759974
  error estimate for blocks of size 2^( 4) =       0.000437636018
  error estimate for blocks of size 2^( 5) =       0.000449512321
  error estimate for blocks of size 2^( 6) =       0.000459059527
  error estimate for blocks of size 2^( 7) =       0.000463523751

      target function =                  N/A
              le_mean =     -16.904330865960
             les_mean =     286.080215126265
             stat err =       0.000452432904
             autocorr =       1.309733972066
              std dev =       0.559084734309
             le_variance =       0.312575740137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312630499745
                                         uncertainty =       0.001911028062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312630499745
                                         uncertainty =       0.001911028062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395337575
  error estimate for blocks of size 2^( 2) =       0.000409333199
  error estimate for blocks of size 2^( 3) =       0.000423764484
  error estimate for blocks of size 2^( 4) =       0.000437640252
  error estimate for blocks of size 2^( 5) =       0.000449516031
  error estimate for blocks of size 2^( 6) =       0.000459063163
  error estimate for blocks of size 2^( 7) =       0.000463527223

      target function =                  N/A
              le_mean =     -16.904330695924
             les_mean =     286.080239668282
             stat err =       0.000452436667
             autocorr =       1.309722841227
              std dev =       0.559091760258
             le_variance =       0.312583596389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904330672522        initial
     9.5367e+00     9.5367e+01             4.0377e-05       -16.904331070389  <--
     3.8147e+01     3.8147e+02             1.0263e-05       -16.904330865960
     1.5259e+02     1.5259e+03             2.5764e-06       -16.904330695924

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.3591e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.003879e-01 3 1  ON 0
ci_0002                 6.999820e-01 3 1  ON 1
ci_0003                -3.081067e-02 3 1  ON 2
ci_0004                -3.063331e-02 3 1  ON 3
ci_0005                -3.430216e-02 3 1  ON 4
ci_0006                -3.451495e-02 3 1  ON 5
ci_0007                -2.371889e-02 3 1  ON 6
ci_0008                -2.325552e-02 3 1  ON 7
ci_0009                -2.056718e-02 3 1  ON 8
ci_0010                -2.027101e-02 3 1  ON 9
ci_0011                -1.506677e-02 3 1  ON 10
ci_0012                -1.498400e-02 3 1  ON 11
ci_0013                 1.634939e-02 3 1  ON 12
ci_0014                 1.584617e-02 3 1  ON 13
ci_0015                 1.538266e-02 3 1  ON 14
ci_0016                 1.565621e-02 3 1  ON 15
ci_0017                 1.414950e-02 3 1  ON 16
ci_0018                 1.398031e-02 3 1  ON 17
ci_0019                 1.175578e-02 3 1  ON 18
ci_0020                 1.220097e-02 3 1  ON 19
ci_0021                 8.460526e-03 3 1  ON 20
ci_0022                 7.667203e-03 3 1  ON 21
ci_0023                -1.225601e-02 3 1  ON 22
ci_0024                -1.116961e-02 3 1  ON 23
ci_0025                -1.168386e-02 3 1  ON 24
ci_0026                -1.175609e-02 3 1  ON 25
ci_0027                -1.185818e-02 3 1  ON 26
ci_0028                -1.114956e-02 3 1  ON 27
ci_0029                -1.022030e-02 3 1  ON 28
ci_0030                -9.853102e-03 3 1  ON 29
ci_0031                 1.955666e-02 3 1  ON 30
ci_0032                 1.958407e-02 3 1  ON 31
ci_0033                 1.135959e-02 3 1  ON 32
ci_0034                 9.254150e-03 3 1  ON 33
ci_0035                 6.363282e-03 3 1  ON 34
ci_0036                 6.431988e-03 3 1  ON 35
ci_0037                -1.163008e-02 3 1  ON 36
ci_0038                -1.119882e-02 3 1  ON 37
ci_0039                -4.046663e-03 3 1  ON 38
ci_0040                -4.449316e-03 3 1  ON 39
ci_0041                 8.155207e-03 3 1  ON 40
ci_0042                 8.695555e-03 3 1  ON 41
ci_0043                -1.365555e-02 3 1  ON 42
ci_0044                -1.317831e-02 3 1  ON 43
ci_0045                 8.482652e-03 3 1  ON 44
ci_0046                 8.785223e-03 3 1  ON 45
ci_0047                -3.594190e-03 3 1  ON 46
ci_0048                -3.388693e-03 3 1  ON 47
ci_0049                -7.038037e-03 3 1  ON 48
ci_0050                -6.546443e-03 3 1  ON 49
ci_0051                -4.960833e-03 3 1  ON 50
ci_0052                -4.788366e-03 3 1  ON 51
ci_0053                -6.413216e-03 3 1  ON 52
ci_0054                -6.232820e-03 3 1  ON 53
ci_0055                 6.704824e-03 3 1  ON 54
ci_0056                 7.677221e-03 3 1  ON 55
ci_0057                 5.040818e-03 3 1  ON 56
ci_0058                 5.587629e-03 3 1  ON 57
ci_0059                -5.720724e-03 3 1  ON 58
ci_0060                -6.229472e-03 3 1  ON 59
ci_0061                -4.663003e-03 3 1  ON 60
ci_0062                -4.473046e-03 3 1  ON 61
ci_0063                -9.322642e-03 3 1  ON 62
ci_0064                -8.796579e-03 3 1  ON 63
ci_0065                -6.570752e-03 3 1  ON 64
ci_0066                -6.378135e-03 3 1  ON 65
ci_0067                -6.030163e-03 3 1  ON 66
ci_0068                -6.388494e-03 3 1  ON 67
ci_0069                 5.595383e-03 3 1  ON 68
ci_0070                 5.498166e-03 3 1  ON 69
ci_0071                 4.260883e-03 3 1  ON 70
ci_0072                 4.732559e-03 3 1  ON 71
ci_0073                 4.721199e-03 3 1  ON 72
ci_0074                 5.005473e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8806
    reference variance = 0.220736
====================================================
  Execution time = 1.4493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2284e-01
  Total weights = 1.951711597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311388659829
                                         uncertainty =       0.002933472935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311388659829
                                         uncertainty =       0.002933472935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394534939
  error estimate for blocks of size 2^( 2) =       0.000408219998
  error estimate for blocks of size 2^( 3) =       0.000422070882
  error estimate for blocks of size 2^( 4) =       0.000434978269
  error estimate for blocks of size 2^( 5) =       0.000445671628
  error estimate for blocks of size 2^( 6) =       0.000452828826
  error estimate for blocks of size 2^( 7) =       0.000457519528

      target function =                  N/A
              le_mean =     -16.905152139565
             les_mean =     286.107011379888
             stat err =       0.000447749563
             autocorr =       1.287951181890
              std dev =       0.557956661938
             le_variance =       0.311315636601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690515213957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905152139579       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905155285285       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905155250797       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905155250516       residual = 1.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+00 is 1.407437e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905152139579       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905152976647       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905152975666       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905152976078       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 3.776033e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905152139579       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905152352270       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905152352600       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905152352785       residual = 1.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 9.615993e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7116e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.003941e-01 3 1  ON 0
ci_0002                 6.999785e-01 3 1  ON 1
ci_0003                -3.082481e-02 3 1  ON 2
ci_0004                -3.063914e-02 3 1  ON 3
ci_0005                -3.431435e-02 3 1  ON 4
ci_0006                -3.450515e-02 3 1  ON 5
ci_0007                -2.372054e-02 3 1  ON 6
ci_0008                -2.324777e-02 3 1  ON 7
ci_0009                -2.055232e-02 3 1  ON 8
ci_0010                -2.026051e-02 3 1  ON 9
ci_0011                -1.506722e-02 3 1  ON 10
ci_0012                -1.499157e-02 3 1  ON 11
ci_0013                 1.632325e-02 3 1  ON 12
ci_0014                 1.585546e-02 3 1  ON 13
ci_0015                 1.539873e-02 3 1  ON 14
ci_0016                 1.566680e-02 3 1  ON 15
ci_0017                 1.411174e-02 3 1  ON 16
ci_0018                 1.397716e-02 3 1  ON 17
ci_0019                 1.177400e-02 3 1  ON 18
ci_0020                 1.219971e-02 3 1  ON 19
ci_0021                 8.438532e-03 3 1  ON 20
ci_0022                 7.663765e-03 3 1  ON 21
ci_0023                -1.223315e-02 3 1  ON 22
ci_0024                -1.117627e-02 3 1  ON 23
ci_0025                -1.167713e-02 3 1  ON 24
ci_0026                -1.174070e-02 3 1  ON 25
ci_0027                -1.184798e-02 3 1  ON 26
ci_0028                -1.116015e-02 3 1  ON 27
ci_0029                -1.022505e-02 3 1  ON 28
ci_0030                -9.851778e-03 3 1  ON 29
ci_0031                 1.953658e-02 3 1  ON 30
ci_0032                 1.955888e-02 3 1  ON 31
ci_0033                 1.132512e-02 3 1  ON 32
ci_0034                 9.269906e-03 3 1  ON 33
ci_0035                 6.363083e-03 3 1  ON 34
ci_0036                 6.440955e-03 3 1  ON 35
ci_0037                -1.161227e-02 3 1  ON 36
ci_0038                -1.120826e-02 3 1  ON 37
ci_0039                -4.036267e-03 3 1  ON 38
ci_0040                -4.433601e-03 3 1  ON 39
ci_0041                 8.175670e-03 3 1  ON 40
ci_0042                 8.700008e-03 3 1  ON 41
ci_0043                -1.365764e-02 3 1  ON 42
ci_0044                -1.318476e-02 3 1  ON 43
ci_0045                 8.467143e-03 3 1  ON 44
ci_0046                 8.784959e-03 3 1  ON 45
ci_0047                -3.582710e-03 3 1  ON 46
ci_0048                -3.401019e-03 3 1  ON 47
ci_0049                -7.027990e-03 3 1  ON 48
ci_0050                -6.548606e-03 3 1  ON 49
ci_0051                -4.948268e-03 3 1  ON 50
ci_0052                -4.780798e-03 3 1  ON 51
ci_0053                -6.408214e-03 3 1  ON 52
ci_0054                -6.218546e-03 3 1  ON 53
ci_0055                 6.701253e-03 3 1  ON 54
ci_0056                 7.667797e-03 3 1  ON 55
ci_0057                 5.042622e-03 3 1  ON 56
ci_0058                 5.601493e-03 3 1  ON 57
ci_0059                -5.732677e-03 3 1  ON 58
ci_0060                -6.244426e-03 3 1  ON 59
ci_0061                -4.642032e-03 3 1  ON 60
ci_0062                -4.459332e-03 3 1  ON 61
ci_0063                -9.313146e-03 3 1  ON 62
ci_0064                -8.817616e-03 3 1  ON 63
ci_0065                -6.574559e-03 3 1  ON 64
ci_0066                -6.376995e-03 3 1  ON 65
ci_0067                -6.036581e-03 3 1  ON 66
ci_0068                -6.372073e-03 3 1  ON 67
ci_0069                 5.598053e-03 3 1  ON 68
ci_0070                 5.490867e-03 3 1  ON 69
ci_0071                 4.266606e-03 3 1  ON 70
ci_0072                 4.729396e-03 3 1  ON 71
ci_0073                 4.740887e-03 3 1  ON 72
ci_0074                 5.018848e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.167003
====================================================
  Execution time = 1.3932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2225e-01
  Total weights = 1.9514e+06
  Execution time = 1.9079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267088420
                                         uncertainty =       0.001930484252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267088420
                                         uncertainty =       0.001930484252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393240263
  error estimate for blocks of size 2^( 2) =       0.000406974461
  error estimate for blocks of size 2^( 3) =       0.000421085817
  error estimate for blocks of size 2^( 4) =       0.000434264008
  error estimate for blocks of size 2^( 5) =       0.000444310927
  error estimate for blocks of size 2^( 6) =       0.000451313034
  error estimate for blocks of size 2^( 7) =       0.000454502935

      target function =                  N/A
              le_mean =     -16.904694873442
             les_mean =     286.090999896227
             stat err =       0.000446097726
             autocorr =       1.286897816934
              std dev =       0.556125712668
             le_variance =       0.309275808291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309184120622
                                         uncertainty =       0.001926217801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309184120622
                                         uncertainty =       0.001926217801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393187618
  error estimate for blocks of size 2^( 2) =       0.000406923046
  error estimate for blocks of size 2^( 3) =       0.000421039891
  error estimate for blocks of size 2^( 4) =       0.000434220949
  error estimate for blocks of size 2^( 5) =       0.000444271245
  error estimate for blocks of size 2^( 6) =       0.000451280506
  error estimate for blocks of size 2^( 7) =       0.000454475207

      target function =                  N/A
              le_mean =     -16.904692986646
             les_mean =     286.090956367907
             stat err =       0.000446061977
             autocorr =       1.287036142232
              std dev =       0.556051262489
             le_variance =       0.309193006515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309221732700
                                         uncertainty =       0.001928140355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309221732700
                                         uncertainty =       0.001928140355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393211485
  error estimate for blocks of size 2^( 2) =       0.000406946341
  error estimate for blocks of size 2^( 3) =       0.000421060643
  error estimate for blocks of size 2^( 4) =       0.000434240393
  error estimate for blocks of size 2^( 5) =       0.000444289125
  error estimate for blocks of size 2^( 6) =       0.000451295074
  error estimate for blocks of size 2^( 7) =       0.000454487608

      target function =                  N/A
              le_mean =     -16.904693760829
             les_mean =     286.090903321812
             stat err =       0.000446078050
             autocorr =       1.286972652320
              std dev =       0.556085015012
             le_variance =       0.309230543921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309261198459
                                         uncertainty =       0.001930179558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309261198459
                                         uncertainty =       0.001930179558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393236526
  error estimate for blocks of size 2^( 2) =       0.000406970807
  error estimate for blocks of size 2^( 3) =       0.000421082537
  error estimate for blocks of size 2^( 4) =       0.000434260929
  error estimate for blocks of size 2^( 5) =       0.000444308079
  error estimate for blocks of size 2^( 6) =       0.000451310673
  error estimate for blocks of size 2^( 7) =       0.000454500913

      target function =                  N/A
              le_mean =     -16.904694719316
             les_mean =     286.090981096936
             stat err =       0.000446095149
             autocorr =       1.286907404279
              std dev =       0.556120427754
             le_variance =       0.309269930166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904694873442        initial  <--
     2.3842e+00     2.3842e+01             1.4074e-04       -16.904692986646
     9.5367e+00     9.5367e+01             3.7760e-05       -16.904693760829
     3.8147e+01     3.8147e+02             9.6160e-06       -16.904694719316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4139
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.003879e-01 3 1  ON 0
ci_0002                 6.999820e-01 3 1  ON 1
ci_0003                -3.081067e-02 3 1  ON 2
ci_0004                -3.063331e-02 3 1  ON 3
ci_0005                -3.430216e-02 3 1  ON 4
ci_0006                -3.451495e-02 3 1  ON 5
ci_0007                -2.371889e-02 3 1  ON 6
ci_0008                -2.325552e-02 3 1  ON 7
ci_0009                -2.056718e-02 3 1  ON 8
ci_0010                -2.027101e-02 3 1  ON 9
ci_0011                -1.506677e-02 3 1  ON 10
ci_0012                -1.498400e-02 3 1  ON 11
ci_0013                 1.634939e-02 3 1  ON 12
ci_0014                 1.584617e-02 3 1  ON 13
ci_0015                 1.538266e-02 3 1  ON 14
ci_0016                 1.565621e-02 3 1  ON 15
ci_0017                 1.414950e-02 3 1  ON 16
ci_0018                 1.398031e-02 3 1  ON 17
ci_0019                 1.175578e-02 3 1  ON 18
ci_0020                 1.220097e-02 3 1  ON 19
ci_0021                 8.460526e-03 3 1  ON 20
ci_0022                 7.667203e-03 3 1  ON 21
ci_0023                -1.225601e-02 3 1  ON 22
ci_0024                -1.116961e-02 3 1  ON 23
ci_0025                -1.168386e-02 3 1  ON 24
ci_0026                -1.175609e-02 3 1  ON 25
ci_0027                -1.185818e-02 3 1  ON 26
ci_0028                -1.114956e-02 3 1  ON 27
ci_0029                -1.022030e-02 3 1  ON 28
ci_0030                -9.853102e-03 3 1  ON 29
ci_0031                 1.955666e-02 3 1  ON 30
ci_0032                 1.958407e-02 3 1  ON 31
ci_0033                 1.135959e-02 3 1  ON 32
ci_0034                 9.254150e-03 3 1  ON 33
ci_0035                 6.363282e-03 3 1  ON 34
ci_0036                 6.431988e-03 3 1  ON 35
ci_0037                -1.163008e-02 3 1  ON 36
ci_0038                -1.119882e-02 3 1  ON 37
ci_0039                -4.046663e-03 3 1  ON 38
ci_0040                -4.449316e-03 3 1  ON 39
ci_0041                 8.155207e-03 3 1  ON 40
ci_0042                 8.695555e-03 3 1  ON 41
ci_0043                -1.365555e-02 3 1  ON 42
ci_0044                -1.317831e-02 3 1  ON 43
ci_0045                 8.482652e-03 3 1  ON 44
ci_0046                 8.785223e-03 3 1  ON 45
ci_0047                -3.594190e-03 3 1  ON 46
ci_0048                -3.388693e-03 3 1  ON 47
ci_0049                -7.038037e-03 3 1  ON 48
ci_0050                -6.546443e-03 3 1  ON 49
ci_0051                -4.960833e-03 3 1  ON 50
ci_0052                -4.788366e-03 3 1  ON 51
ci_0053                -6.413216e-03 3 1  ON 52
ci_0054                -6.232820e-03 3 1  ON 53
ci_0055                 6.704824e-03 3 1  ON 54
ci_0056                 7.677221e-03 3 1  ON 55
ci_0057                 5.040818e-03 3 1  ON 56
ci_0058                 5.587629e-03 3 1  ON 57
ci_0059                -5.720724e-03 3 1  ON 58
ci_0060                -6.229472e-03 3 1  ON 59
ci_0061                -4.663003e-03 3 1  ON 60
ci_0062                -4.473046e-03 3 1  ON 61
ci_0063                -9.322642e-03 3 1  ON 62
ci_0064                -8.796579e-03 3 1  ON 63
ci_0065                -6.570752e-03 3 1  ON 64
ci_0066                -6.378135e-03 3 1  ON 65
ci_0067                -6.030163e-03 3 1  ON 66
ci_0068                -6.388494e-03 3 1  ON 67
ci_0069                 5.595383e-03 3 1  ON 68
ci_0070                 5.498166e-03 3 1  ON 69
ci_0071                 4.260883e-03 3 1  ON 70
ci_0072                 4.732559e-03 3 1  ON 71
ci_0073                 4.721199e-03 3 1  ON 72
ci_0074                 5.005473e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0535e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.348796
====================================================
  Execution time = 1.4503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2974e-01
  Total weights = 1.951742394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318105215817
                                         uncertainty =       0.002959458576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318105215817
                                         uncertainty =       0.002959458576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398824498
  error estimate for blocks of size 2^( 2) =       0.000413013551
  error estimate for blocks of size 2^( 3) =       0.000427268683
  error estimate for blocks of size 2^( 4) =       0.000440889770
  error estimate for blocks of size 2^( 5) =       0.000452471159
  error estimate for blocks of size 2^( 6) =       0.000461487251
  error estimate for blocks of size 2^( 7) =       0.000466631066

      target function =                  N/A
              le_mean =     -16.903918480586
             les_mean =     286.072199336834
             stat err =       0.000455369812
             autocorr =       1.303661430328
              std dev =       0.564023014565
             le_variance =       0.318121960959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690391848059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903918480562       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903918707599       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903918702854       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903918701977       residual = 1.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 2.095540e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903918480562       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903918537679       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903918536366       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903918536132       residual = 1.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 5.266939e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903918480562       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903918494864       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903918494528       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903918494468       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.318503e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7063e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.003893e-01 3 1  ON 0
ci_0002                 6.999810e-01 3 1  ON 1
ci_0003                -3.081067e-02 3 1  ON 2
ci_0004                -3.063282e-02 3 1  ON 3
ci_0005                -3.430203e-02 3 1  ON 4
ci_0006                -3.451416e-02 3 1  ON 5
ci_0007                -2.371847e-02 3 1  ON 6
ci_0008                -2.325209e-02 3 1  ON 7
ci_0009                -2.056479e-02 3 1  ON 8
ci_0010                -2.026821e-02 3 1  ON 9
ci_0011                -1.506523e-02 3 1  ON 10
ci_0012                -1.498654e-02 3 1  ON 11
ci_0013                 1.634754e-02 3 1  ON 12
ci_0014                 1.584552e-02 3 1  ON 13
ci_0015                 1.538460e-02 3 1  ON 14
ci_0016                 1.565775e-02 3 1  ON 15
ci_0017                 1.414805e-02 3 1  ON 16
ci_0018                 1.397908e-02 3 1  ON 17
ci_0019                 1.175557e-02 3 1  ON 18
ci_0020                 1.219852e-02 3 1  ON 19
ci_0021                 8.460799e-03 3 1  ON 20
ci_0022                 7.667115e-03 3 1  ON 21
ci_0023                -1.225512e-02 3 1  ON 22
ci_0024                -1.116963e-02 3 1  ON 23
ci_0025                -1.168518e-02 3 1  ON 24
ci_0026                -1.175398e-02 3 1  ON 25
ci_0027                -1.185815e-02 3 1  ON 26
ci_0028                -1.114901e-02 3 1  ON 27
ci_0029                -1.022243e-02 3 1  ON 28
ci_0030                -9.854842e-03 3 1  ON 29
ci_0031                 1.955757e-02 3 1  ON 30
ci_0032                 1.958537e-02 3 1  ON 31
ci_0033                 1.135779e-02 3 1  ON 32
ci_0034                 9.256214e-03 3 1  ON 33
ci_0035                 6.365240e-03 3 1  ON 34
ci_0036                 6.434398e-03 3 1  ON 35
ci_0037                -1.162481e-02 3 1  ON 36
ci_0038                -1.119580e-02 3 1  ON 37
ci_0039                -4.047194e-03 3 1  ON 38
ci_0040                -4.449944e-03 3 1  ON 39
ci_0041                 8.155458e-03 3 1  ON 40
ci_0042                 8.694308e-03 3 1  ON 41
ci_0043                -1.365435e-02 3 1  ON 42
ci_0044                -1.317822e-02 3 1  ON 43
ci_0045                 8.486034e-03 3 1  ON 44
ci_0046                 8.785431e-03 3 1  ON 45
ci_0047                -3.594180e-03 3 1  ON 46
ci_0048                -3.392213e-03 3 1  ON 47
ci_0049                -7.036204e-03 3 1  ON 48
ci_0050                -6.545776e-03 3 1  ON 49
ci_0051                -4.959360e-03 3 1  ON 50
ci_0052                -4.788756e-03 3 1  ON 51
ci_0053                -6.414467e-03 3 1  ON 52
ci_0054                -6.230956e-03 3 1  ON 53
ci_0055                 6.705472e-03 3 1  ON 54
ci_0056                 7.676258e-03 3 1  ON 55
ci_0057                 5.042232e-03 3 1  ON 56
ci_0058                 5.587596e-03 3 1  ON 57
ci_0059                -5.722344e-03 3 1  ON 58
ci_0060                -6.228269e-03 3 1  ON 59
ci_0061                -4.659456e-03 3 1  ON 60
ci_0062                -4.470697e-03 3 1  ON 61
ci_0063                -9.322143e-03 3 1  ON 62
ci_0064                -8.794274e-03 3 1  ON 63
ci_0065                -6.570352e-03 3 1  ON 64
ci_0066                -6.378525e-03 3 1  ON 65
ci_0067                -6.031942e-03 3 1  ON 66
ci_0068                -6.388961e-03 3 1  ON 67
ci_0069                 5.595720e-03 3 1  ON 68
ci_0070                 5.497514e-03 3 1  ON 69
ci_0071                 4.262634e-03 3 1  ON 70
ci_0072                 4.729205e-03 3 1  ON 71
ci_0073                 4.723164e-03 3 1  ON 72
ci_0074                 5.005240e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.7885
    reference variance = 1.03648
====================================================
  Execution time = 1.3969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2757e-01
  Total weights = 1.9518e+06
  Execution time = 1.8664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220827530
                                         uncertainty =       0.002316186564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220827530
                                         uncertainty =       0.002316186564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396433359
  error estimate for blocks of size 2^( 2) =       0.000410494225
  error estimate for blocks of size 2^( 3) =       0.000425059312
  error estimate for blocks of size 2^( 4) =       0.000437916516
  error estimate for blocks of size 2^( 5) =       0.000448574794
  error estimate for blocks of size 2^( 6) =       0.000458865839
  error estimate for blocks of size 2^( 7) =       0.000465467962

      target function =                  N/A
              le_mean =     -16.903556065552
             les_mean =     286.057768023048
             stat err =       0.000452706277
             autocorr =       1.304045208931
              std dev =       0.560641433522
             le_variance =       0.314318816982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220488306
                                         uncertainty =       0.002315807237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220488306
                                         uncertainty =       0.002315807237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396433115
  error estimate for blocks of size 2^( 2) =       0.000410494155
  error estimate for blocks of size 2^( 3) =       0.000425059584
  error estimate for blocks of size 2^( 4) =       0.000437916953
  error estimate for blocks of size 2^( 5) =       0.000448575363
  error estimate for blocks of size 2^( 6) =       0.000458866367
  error estimate for blocks of size 2^( 7) =       0.000465469571

      target function =                  N/A
              le_mean =     -16.903556069104
             les_mean =     286.058203584201
             stat err =       0.000452707063
             autocorr =       1.304051341907
              std dev =       0.560641088268
             le_variance =       0.314318429854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220644739
                                         uncertainty =       0.002315995176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220644739
                                         uncertainty =       0.002315995176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396433229
  error estimate for blocks of size 2^( 2) =       0.000410494182
  error estimate for blocks of size 2^( 3) =       0.000425059442
  error estimate for blocks of size 2^( 4) =       0.000437916728
  error estimate for blocks of size 2^( 5) =       0.000448575067
  error estimate for blocks of size 2^( 6) =       0.000458866080
  error estimate for blocks of size 2^( 7) =       0.000465468738

      target function =                  N/A
              le_mean =     -16.903556068675
             les_mean =     286.057809086887
             stat err =       0.000452706654
             autocorr =       1.304048233690
              std dev =       0.560641248986
             le_variance =       0.314318610065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220803142
                                         uncertainty =       0.002316162563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314220803142
                                         uncertainty =       0.002316162563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396433342
  error estimate for blocks of size 2^( 2) =       0.000410494219
  error estimate for blocks of size 2^( 3) =       0.000425059327
  error estimate for blocks of size 2^( 4) =       0.000437916541
  error estimate for blocks of size 2^( 5) =       0.000448574827
  error estimate for blocks of size 2^( 6) =       0.000458865867
  error estimate for blocks of size 2^( 7) =       0.000465468057

      target function =                  N/A
              le_mean =     -16.903556065828
             les_mean =     286.057772257252
             stat err =       0.000452706323
             autocorr =       1.304045585513
              std dev =       0.560641409077
             le_variance =       0.314318789572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903556065552        initial
     2.3842e+01     2.3842e+02             2.0955e-05       -16.903556069104  <--
     9.5367e+01     9.5367e+02             5.2669e-06       -16.903556068675
     3.8147e+02     3.8147e+03             1.3185e-06       -16.903556065828

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.3362e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.003936e-01 3 1  ON 0
ci_0002                 6.999782e-01 3 1  ON 1
ci_0003                -3.081067e-02 3 1  ON 2
ci_0004                -3.063136e-02 3 1  ON 3
ci_0005                -3.430163e-02 3 1  ON 4
ci_0006                -3.451182e-02 3 1  ON 5
ci_0007                -2.371720e-02 3 1  ON 6
ci_0008                -2.324183e-02 3 1  ON 7
ci_0009                -2.055768e-02 3 1  ON 8
ci_0010                -2.025990e-02 3 1  ON 9
ci_0011                -1.506065e-02 3 1  ON 10
ci_0012                -1.499410e-02 3 1  ON 11
ci_0013                 1.634201e-02 3 1  ON 12
ci_0014                 1.584359e-02 3 1  ON 13
ci_0015                 1.539035e-02 3 1  ON 14
ci_0016                 1.566234e-02 3 1  ON 15
ci_0017                 1.414374e-02 3 1  ON 16
ci_0018                 1.397541e-02 3 1  ON 17
ci_0019                 1.175495e-02 3 1  ON 18
ci_0020                 1.219123e-02 3 1  ON 19
ci_0021                 8.461609e-03 3 1  ON 20
ci_0022                 7.666850e-03 3 1  ON 21
ci_0023                -1.225249e-02 3 1  ON 22
ci_0024                -1.116966e-02 3 1  ON 23
ci_0025                -1.168911e-02 3 1  ON 24
ci_0026                -1.174771e-02 3 1  ON 25
ci_0027                -1.185806e-02 3 1  ON 26
ci_0028                -1.114737e-02 3 1  ON 27
ci_0029                -1.022876e-02 3 1  ON 28
ci_0030                -9.860019e-03 3 1  ON 29
ci_0031                 1.956030e-02 3 1  ON 30
ci_0032                 1.958925e-02 3 1  ON 31
ci_0033                 1.135242e-02 3 1  ON 32
ci_0034                 9.262379e-03 3 1  ON 33
ci_0035                 6.371071e-03 3 1  ON 34
ci_0036                 6.441570e-03 3 1  ON 35
ci_0037                -1.160912e-02 3 1  ON 36
ci_0038                -1.118684e-02 3 1  ON 37
ci_0039                -4.048763e-03 3 1  ON 38
ci_0040                -4.451799e-03 3 1  ON 39
ci_0041                 8.156200e-03 3 1  ON 40
ci_0042                 8.690595e-03 3 1  ON 41
ci_0043                -1.365075e-02 3 1  ON 42
ci_0044                -1.317796e-02 3 1  ON 43
ci_0045                 8.496120e-03 3 1  ON 44
ci_0046                 8.786047e-03 3 1  ON 45
ci_0047                -3.594149e-03 3 1  ON 46
ci_0048                -3.402621e-03 3 1  ON 47
ci_0049                -7.030757e-03 3 1  ON 48
ci_0050                -6.543791e-03 3 1  ON 49
ci_0051                -4.955003e-03 3 1  ON 50
ci_0052                -4.789911e-03 3 1  ON 51
ci_0053                -6.418172e-03 3 1  ON 52
ci_0054                -6.225430e-03 3 1  ON 53
ci_0055                 6.707401e-03 3 1  ON 54
ci_0056                 7.673387e-03 3 1  ON 55
ci_0057                 5.046443e-03 3 1  ON 56
ci_0058                 5.587495e-03 3 1  ON 57
ci_0059                -5.727143e-03 3 1  ON 58
ci_0060                -6.224699e-03 3 1  ON 59
ci_0061                -4.648904e-03 3 1  ON 60
ci_0062                -4.463707e-03 3 1  ON 61
ci_0063                -9.320670e-03 3 1  ON 62
ci_0064                -8.787442e-03 3 1  ON 63
ci_0065                -6.569162e-03 3 1  ON 64
ci_0066                -6.379680e-03 3 1  ON 65
ci_0067                -6.037211e-03 3 1  ON 66
ci_0068                -6.390338e-03 3 1  ON 67
ci_0069                 5.596721e-03 3 1  ON 68
ci_0070                 5.495583e-03 3 1  ON 69
ci_0071                 4.267845e-03 3 1  ON 70
ci_0072                 4.719227e-03 3 1  ON 71
ci_0073                 4.728978e-03 3 1  ON 72
ci_0074                 5.004550e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.7926
    reference variance = 0.31306
====================================================
  Execution time = 1.4321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2519e-01
  Total weights = 1.952020351e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312846525648
                                         uncertainty =       0.002729902656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312846525648
                                         uncertainty =       0.002729902656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395464355
  error estimate for blocks of size 2^( 2) =       0.000409527393
  error estimate for blocks of size 2^( 3) =       0.000423764082
  error estimate for blocks of size 2^( 4) =       0.000436437759
  error estimate for blocks of size 2^( 5) =       0.000448209075
  error estimate for blocks of size 2^( 6) =       0.000454993867
  error estimate for blocks of size 2^( 7) =       0.000460947699

      target function =                  N/A
              le_mean =     -16.903847406590
             les_mean =     286.065247231527
             stat err =       0.000450147100
             autocorr =       1.295669463609
              std dev =       0.559271054654
             le_variance =       0.312784112574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690384740659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903847406608       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903848111153       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903848128752       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 6.659667e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903847406608       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903847587427       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903847591045       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.707363e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903847406608       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903847452115       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903847452968       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 4.295823e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6876e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.003970e-01 3 1  ON 0
ci_0002                 6.999763e-01 3 1  ON 1
ci_0003                -3.081240e-02 3 1  ON 2
ci_0004                -3.063745e-02 3 1  ON 3
ci_0005                -3.429566e-02 3 1  ON 4
ci_0006                -3.450847e-02 3 1  ON 5
ci_0007                -2.371497e-02 3 1  ON 6
ci_0008                -2.323532e-02 3 1  ON 7
ci_0009                -2.055115e-02 3 1  ON 8
ci_0010                -2.025650e-02 3 1  ON 9
ci_0011                -1.506025e-02 3 1  ON 10
ci_0012                -1.499217e-02 3 1  ON 11
ci_0013                 1.634516e-02 3 1  ON 12
ci_0014                 1.584299e-02 3 1  ON 13
ci_0015                 1.540097e-02 3 1  ON 14
ci_0016                 1.565241e-02 3 1  ON 15
ci_0017                 1.414207e-02 3 1  ON 16
ci_0018                 1.397447e-02 3 1  ON 17
ci_0019                 1.175197e-02 3 1  ON 18
ci_0020                 1.218893e-02 3 1  ON 19
ci_0021                 8.463238e-03 3 1  ON 20
ci_0022                 7.668352e-03 3 1  ON 21
ci_0023                -1.223913e-02 3 1  ON 22
ci_0024                -1.117372e-02 3 1  ON 23
ci_0025                -1.168592e-02 3 1  ON 24
ci_0026                -1.174748e-02 3 1  ON 25
ci_0027                -1.186308e-02 3 1  ON 26
ci_0028                -1.114883e-02 3 1  ON 27
ci_0029                -1.023122e-02 3 1  ON 28
ci_0030                -9.873462e-03 3 1  ON 29
ci_0031                 1.955909e-02 3 1  ON 30
ci_0032                 1.957905e-02 3 1  ON 31
ci_0033                 1.135239e-02 3 1  ON 32
ci_0034                 9.261475e-03 3 1  ON 33
ci_0035                 6.379945e-03 3 1  ON 34
ci_0036                 6.443628e-03 3 1  ON 35
ci_0037                -1.160352e-02 3 1  ON 36
ci_0038                -1.118012e-02 3 1  ON 37
ci_0039                -4.049997e-03 3 1  ON 38
ci_0040                -4.454427e-03 3 1  ON 39
ci_0041                 8.162682e-03 3 1  ON 40
ci_0042                 8.681166e-03 3 1  ON 41
ci_0043                -1.365014e-02 3 1  ON 42
ci_0044                -1.318350e-02 3 1  ON 43
ci_0045                 8.495148e-03 3 1  ON 44
ci_0046                 8.786794e-03 3 1  ON 45
ci_0047                -3.590789e-03 3 1  ON 46
ci_0048                -3.402764e-03 3 1  ON 47
ci_0049                -7.027908e-03 3 1  ON 48
ci_0050                -6.532941e-03 3 1  ON 49
ci_0051                -4.950791e-03 3 1  ON 50
ci_0052                -4.793036e-03 3 1  ON 51
ci_0053                -6.412607e-03 3 1  ON 52
ci_0054                -6.228487e-03 3 1  ON 53
ci_0055                 6.707331e-03 3 1  ON 54
ci_0056                 7.674022e-03 3 1  ON 55
ci_0057                 5.055843e-03 3 1  ON 56
ci_0058                 5.592601e-03 3 1  ON 57
ci_0059                -5.728862e-03 3 1  ON 58
ci_0060                -6.215752e-03 3 1  ON 59
ci_0061                -4.631831e-03 3 1  ON 60
ci_0062                -4.462309e-03 3 1  ON 61
ci_0063                -9.312207e-03 3 1  ON 62
ci_0064                -8.791580e-03 3 1  ON 63
ci_0065                -6.566631e-03 3 1  ON 64
ci_0066                -6.377880e-03 3 1  ON 65
ci_0067                -6.038178e-03 3 1  ON 66
ci_0068                -6.380324e-03 3 1  ON 67
ci_0069                 5.592668e-03 3 1  ON 68
ci_0070                 5.497776e-03 3 1  ON 69
ci_0071                 4.258216e-03 3 1  ON 70
ci_0072                 4.712096e-03 3 1  ON 71
ci_0073                 4.742186e-03 3 1  ON 72
ci_0074                 5.004861e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9724
    reference variance = 0.313203
====================================================
  Execution time = 1.5029e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2445e-01
  Total weights = 1.9521e+06
  Execution time = 2.1513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312740923656
                                         uncertainty =       0.002473346260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312740923656
                                         uncertainty =       0.002473346260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395412992
  error estimate for blocks of size 2^( 2) =       0.000409019479
  error estimate for blocks of size 2^( 3) =       0.000422826357
  error estimate for blocks of size 2^( 4) =       0.000435389698
  error estimate for blocks of size 2^( 5) =       0.000446436524
  error estimate for blocks of size 2^( 6) =       0.000453698665
  error estimate for blocks of size 2^( 7) =       0.000455073493

      target function =                  N/A
              le_mean =     -16.903467817412
             les_mean =     286.051675275219
             stat err =       0.000447649595
             autocorr =       1.281664993471
              std dev =       0.559198416007
             le_variance =       0.312702868465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312709295849
                                         uncertainty =       0.002471563355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312709295849
                                         uncertainty =       0.002471563355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395393016
  error estimate for blocks of size 2^( 2) =       0.000408999530
  error estimate for blocks of size 2^( 3) =       0.000422806255
  error estimate for blocks of size 2^( 4) =       0.000435369913
  error estimate for blocks of size 2^( 5) =       0.000446417982
  error estimate for blocks of size 2^( 6) =       0.000453681079
  error estimate for blocks of size 2^( 7) =       0.000455059015

      target function =                  N/A
              le_mean =     -16.903468498025
             les_mean =     286.052422157406
             stat err =       0.000447631997
             autocorr =       1.281693726780
              std dev =       0.559170165024
             le_variance =       0.312671273453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312724473048
                                         uncertainty =       0.002472424835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312724473048
                                         uncertainty =       0.002472424835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395402602
  error estimate for blocks of size 2^( 2) =       0.000409009106
  error estimate for blocks of size 2^( 3) =       0.000422815911
  error estimate for blocks of size 2^( 4) =       0.000435379434
  error estimate for blocks of size 2^( 5) =       0.000446426903
  error estimate for blocks of size 2^( 6) =       0.000453689513
  error estimate for blocks of size 2^( 7) =       0.000455065970

      target function =                  N/A
              le_mean =     -16.903468163470
             les_mean =     286.051703864045
             stat err =       0.000447640455
             autocorr =       1.281680014060
              std dev =       0.559183721824
             le_variance =       0.312686434753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312738831957
                                         uncertainty =       0.002473229929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312738831957
                                         uncertainty =       0.002473229929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395411671
  error estimate for blocks of size 2^( 2) =       0.000409018160
  error estimate for blocks of size 2^( 3) =       0.000422825029
  error estimate for blocks of size 2^( 4) =       0.000435388394
  error estimate for blocks of size 2^( 5) =       0.000446435300
  error estimate for blocks of size 2^( 6) =       0.000453697501
  error estimate for blocks of size 2^( 7) =       0.000455072534

      target function =                  N/A
              le_mean =     -16.903467858873
             les_mean =     286.051675351553
             stat err =       0.000447648432
             autocorr =       1.281666899335
              std dev =       0.559196547649
             le_variance =       0.312700778903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903467817412        initial
     5.9605e+00     5.9605e+01             6.6597e-05       -16.903468498025  <--
     2.3842e+01     2.3842e+02             1.7074e-05       -16.903468163470
     9.5367e+01     9.5367e+02             4.2958e-06       -16.903467858873

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.4675e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.004071e-01 3 1  ON 0
ci_0002                 6.999705e-01 3 1  ON 1
ci_0003                -3.081743e-02 3 1  ON 2
ci_0004                -3.065510e-02 3 1  ON 3
ci_0005                -3.427814e-02 3 1  ON 4
ci_0006                -3.449852e-02 3 1  ON 5
ci_0007                -2.370829e-02 3 1  ON 6
ci_0008                -2.321596e-02 3 1  ON 7
ci_0009                -2.053228e-02 3 1  ON 8
ci_0010                -2.024671e-02 3 1  ON 9
ci_0011                -1.505918e-02 3 1  ON 10
ci_0012                -1.498653e-02 3 1  ON 11
ci_0013                 1.635427e-02 3 1  ON 12
ci_0014                 1.584118e-02 3 1  ON 13
ci_0015                 1.543170e-02 3 1  ON 14
ci_0016                 1.562358e-02 3 1  ON 15
ci_0017                 1.413731e-02 3 1  ON 16
ci_0018                 1.397175e-02 3 1  ON 17
ci_0019                 1.174334e-02 3 1  ON 18
ci_0020                 1.218229e-02 3 1  ON 19
ci_0021                 8.467951e-03 3 1  ON 20
ci_0022                 7.672840e-03 3 1  ON 21
ci_0023                -1.220062e-02 3 1  ON 22
ci_0024                -1.118543e-02 3 1  ON 23
ci_0025                -1.167671e-02 3 1  ON 24
ci_0026                -1.174679e-02 3 1  ON 25
ci_0027                -1.187761e-02 3 1  ON 26
ci_0028                -1.115306e-02 3 1  ON 27
ci_0029                -1.023828e-02 3 1  ON 28
ci_0030                -9.912491e-03 3 1  ON 29
ci_0031                 1.955572e-02 3 1  ON 30
ci_0032                 1.954896e-02 3 1  ON 31
ci_0033                 1.135230e-02 3 1  ON 32
ci_0034                 9.258827e-03 3 1  ON 33
ci_0035                 6.405735e-03 3 1  ON 34
ci_0036                 6.449614e-03 3 1  ON 35
ci_0037                -1.158727e-02 3 1  ON 36
ci_0038                -1.116052e-02 3 1  ON 37
ci_0039                -4.053484e-03 3 1  ON 38
ci_0040                -4.461858e-03 3 1  ON 39
ci_0041                 8.181492e-03 3 1  ON 40
ci_0042                 8.653805e-03 3 1  ON 41
ci_0043                -1.364834e-02 3 1  ON 42
ci_0044                -1.319991e-02 3 1  ON 43
ci_0045                 8.492268e-03 3 1  ON 44
ci_0046                 8.788958e-03 3 1  ON 45
ci_0047                -3.581260e-03 3 1  ON 46
ci_0048                -3.403168e-03 3 1  ON 47
ci_0049                -7.019621e-03 3 1  ON 48
ci_0050                -6.501498e-03 3 1  ON 49
ci_0051                -4.938866e-03 3 1  ON 50
ci_0052                -4.801892e-03 3 1  ON 51
ci_0053                -6.396719e-03 3 1  ON 52
ci_0054                -6.237147e-03 3 1  ON 53
ci_0055                 6.707127e-03 3 1  ON 54
ci_0056                 7.675854e-03 3 1  ON 55
ci_0057                 5.083238e-03 3 1  ON 56
ci_0058                 5.607423e-03 3 1  ON 57
ci_0059                -5.733820e-03 3 1  ON 58
ci_0060                -6.190211e-03 3 1  ON 59
ci_0061                -4.582308e-03 3 1  ON 60
ci_0062                -4.458252e-03 3 1  ON 61
ci_0063                -9.287988e-03 3 1  ON 62
ci_0064                -8.803457e-03 3 1  ON 63
ci_0065                -6.559425e-03 3 1  ON 64
ci_0066                -6.372624e-03 3 1  ON 65
ci_0067                -6.040958e-03 3 1  ON 66
ci_0068                -6.351833e-03 3 1  ON 67
ci_0069                 5.581205e-03 3 1  ON 68
ci_0070                 5.503953e-03 3 1  ON 69
ci_0071                 4.230301e-03 3 1  ON 70
ci_0072                 4.691454e-03 3 1  ON 71
ci_0073                 4.779766e-03 3 1  ON 72
ci_0074                 5.005744e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9589
    reference variance = 0.164335
====================================================
  Execution time = 1.4491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2979e-01
  Total weights = 1.951765625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316407180091
                                         uncertainty =       0.003462946141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316407180091
                                         uncertainty =       0.003462946141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397730320
  error estimate for blocks of size 2^( 2) =       0.000411151599
  error estimate for blocks of size 2^( 3) =       0.000425041358
  error estimate for blocks of size 2^( 4) =       0.000437037720
  error estimate for blocks of size 2^( 5) =       0.000447467556
  error estimate for blocks of size 2^( 6) =       0.000455968902
  error estimate for blocks of size 2^( 7) =       0.000460945651

      target function =                  N/A
              le_mean =     -16.904395030196
             les_mean =     286.088360066869
             stat err =       0.000450354957
             autocorr =       1.282131282705
              std dev =       0.562475612113
             le_variance =       0.316378814221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690439503020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904395030199       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904396844672       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904397100609       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904397101793       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.258022e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904395030199       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904395535516       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904395562610       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904395567236       residual = 1.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 5.881288e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904395030199       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904395160233       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904395164114       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904395165586       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.485368e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7093e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.004062e-01 3 1  ON 0
ci_0002                 6.999771e-01 3 1  ON 1
ci_0003                -3.081101e-02 3 1  ON 2
ci_0004                -3.066180e-02 3 1  ON 3
ci_0005                -3.427687e-02 3 1  ON 4
ci_0006                -3.448432e-02 3 1  ON 5
ci_0007                -2.369711e-02 3 1  ON 6
ci_0008                -2.320759e-02 3 1  ON 7
ci_0009                -2.049649e-02 3 1  ON 8
ci_0010                -2.021745e-02 3 1  ON 9
ci_0011                -1.503392e-02 3 1  ON 10
ci_0012                -1.499596e-02 3 1  ON 11
ci_0013                 1.634901e-02 3 1  ON 12
ci_0014                 1.584903e-02 3 1  ON 13
ci_0015                 1.543091e-02 3 1  ON 14
ci_0016                 1.561513e-02 3 1  ON 15
ci_0017                 1.410872e-02 3 1  ON 16
ci_0018                 1.392814e-02 3 1  ON 17
ci_0019                 1.176135e-02 3 1  ON 18
ci_0020                 1.217056e-02 3 1  ON 19
ci_0021                 8.409138e-03 3 1  ON 20
ci_0022                 7.674376e-03 3 1  ON 21
ci_0023                -1.219246e-02 3 1  ON 22
ci_0024                -1.119078e-02 3 1  ON 23
ci_0025                -1.168832e-02 3 1  ON 24
ci_0026                -1.175231e-02 3 1  ON 25
ci_0027                -1.184364e-02 3 1  ON 26
ci_0028                -1.115418e-02 3 1  ON 27
ci_0029                -1.024903e-02 3 1  ON 28
ci_0030                -9.941211e-03 3 1  ON 29
ci_0031                 1.952998e-02 3 1  ON 30
ci_0032                 1.954729e-02 3 1  ON 31
ci_0033                 1.134486e-02 3 1  ON 32
ci_0034                 9.288677e-03 3 1  ON 33
ci_0035                 6.389970e-03 3 1  ON 34
ci_0036                 6.460540e-03 3 1  ON 35
ci_0037                -1.154807e-02 3 1  ON 36
ci_0038                -1.117799e-02 3 1  ON 37
ci_0039                -4.092945e-03 3 1  ON 38
ci_0040                -4.455671e-03 3 1  ON 39
ci_0041                 8.194587e-03 3 1  ON 40
ci_0042                 8.681049e-03 3 1  ON 41
ci_0043                -1.366605e-02 3 1  ON 42
ci_0044                -1.321411e-02 3 1  ON 43
ci_0045                 8.499691e-03 3 1  ON 44
ci_0046                 8.798149e-03 3 1  ON 45
ci_0047                -3.582002e-03 3 1  ON 46
ci_0048                -3.407528e-03 3 1  ON 47
ci_0049                -6.994340e-03 3 1  ON 48
ci_0050                -6.474000e-03 3 1  ON 49
ci_0051                -4.891368e-03 3 1  ON 50
ci_0052                -4.770021e-03 3 1  ON 51
ci_0053                -6.434515e-03 3 1  ON 52
ci_0054                -6.235445e-03 3 1  ON 53
ci_0055                 6.716601e-03 3 1  ON 54
ci_0056                 7.696058e-03 3 1  ON 55
ci_0057                 5.054018e-03 3 1  ON 56
ci_0058                 5.610792e-03 3 1  ON 57
ci_0059                -5.710681e-03 3 1  ON 58
ci_0060                -6.190639e-03 3 1  ON 59
ci_0061                -4.566275e-03 3 1  ON 60
ci_0062                -4.434036e-03 3 1  ON 61
ci_0063                -9.277185e-03 3 1  ON 62
ci_0064                -8.833496e-03 3 1  ON 63
ci_0065                -6.585449e-03 3 1  ON 64
ci_0066                -6.361375e-03 3 1  ON 65
ci_0067                -6.051997e-03 3 1  ON 66
ci_0068                -6.328325e-03 3 1  ON 67
ci_0069                 5.568198e-03 3 1  ON 68
ci_0070                 5.472158e-03 3 1  ON 69
ci_0071                 4.229110e-03 3 1  ON 70
ci_0072                 4.685388e-03 3 1  ON 71
ci_0073                 4.824263e-03 3 1  ON 72
ci_0074                 5.047219e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9021
    reference variance = 0.199284
====================================================
  Execution time = 1.4233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2695e-01
  Total weights = 1.9516e+06
  Execution time = 1.8731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776549456
                                         uncertainty =       0.002227123968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776549456
                                         uncertainty =       0.002227123968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394172439
  error estimate for blocks of size 2^( 2) =       0.000408284415
  error estimate for blocks of size 2^( 3) =       0.000422422218
  error estimate for blocks of size 2^( 4) =       0.000435304781
  error estimate for blocks of size 2^( 5) =       0.000447279473
  error estimate for blocks of size 2^( 6) =       0.000457743024
  error estimate for blocks of size 2^( 7) =       0.000465321759

      target function =                  N/A
              le_mean =     -16.904870879738
             les_mean =     286.101781486660
             stat err =       0.000451412260
             autocorr =       1.311517801135
              std dev =       0.557444009408
             le_variance =       0.310743823625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310571550443
                                         uncertainty =       0.002159299269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310571550443
                                         uncertainty =       0.002159299269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394042652
  error estimate for blocks of size 2^( 2) =       0.000408162391
  error estimate for blocks of size 2^( 3) =       0.000422312501
  error estimate for blocks of size 2^( 4) =       0.000435200413
  error estimate for blocks of size 2^( 5) =       0.000447178492
  error estimate for blocks of size 2^( 6) =       0.000457643553
  error estimate for blocks of size 2^( 7) =       0.000465209844

      target function =                  N/A
              le_mean =     -16.904871246517
             les_mean =     286.101681067739
             stat err =       0.000451308075
             autocorr =       1.311776188851
              std dev =       0.557260461993
             le_variance =       0.310539222501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310664191963
                                         uncertainty =       0.002191381704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310664191963
                                         uncertainty =       0.002191381704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394101305
  error estimate for blocks of size 2^( 2) =       0.000408217499
  error estimate for blocks of size 2^( 3) =       0.000422362019
  error estimate for blocks of size 2^( 4) =       0.000435247337
  error estimate for blocks of size 2^( 5) =       0.000447223527
  error estimate for blocks of size 2^( 6) =       0.000457687938
  error estimate for blocks of size 2^( 7) =       0.000465259540

      target function =                  N/A
              le_mean =     -16.904870899744
             les_mean =     286.102850530059
             stat err =       0.000451354585
             autocorr =       1.311656066532
              std dev =       0.557343410354
             le_variance =       0.310631677065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310761730356
                                         uncertainty =       0.002222469470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310761730356
                                         uncertainty =       0.002222469470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394163058
  error estimate for blocks of size 2^( 2) =       0.000408275579
  error estimate for blocks of size 2^( 3) =       0.000422414285
  error estimate for blocks of size 2^( 4) =       0.000435297221
  error estimate for blocks of size 2^( 5) =       0.000447272153
  error estimate for blocks of size 2^( 6) =       0.000457735722
  error estimate for blocks of size 2^( 7) =       0.000465313614

      target function =                  N/A
              le_mean =     -16.904870812551
             les_mean =     286.101823323584
             stat err =       0.000451404677
             autocorr =       1.311536174501
              std dev =       0.557430741714
             le_variance =       0.310729031808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904870879738        initial
     1.4901e+00     1.4901e+01             2.2580e-04       -16.904871246517  <--
     5.9605e+00     5.9605e+01             5.8813e-05       -16.904870899744
     2.3842e+01     2.3842e+02             1.4854e-05       -16.904870812551

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.3709e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.004017e-01 3 1  ON 0
ci_0002                 6.999963e-01 3 1  ON 1
ci_0003                -3.079375e-02 3 1  ON 2
ci_0004                -3.067871e-02 3 1  ON 3
ci_0005                -3.427247e-02 3 1  ON 4
ci_0006                -3.444495e-02 3 1  ON 5
ci_0007                -2.366517e-02 3 1  ON 6
ci_0008                -2.318437e-02 3 1  ON 7
ci_0009                -2.040509e-02 3 1  ON 8
ci_0010                -2.014212e-02 3 1  ON 9
ci_0011                -1.496719e-02 3 1  ON 10
ci_0012                -1.502110e-02 3 1  ON 11
ci_0013                 1.633620e-02 3 1  ON 12
ci_0014                 1.586914e-02 3 1  ON 13
ci_0015                 1.542982e-02 3 1  ON 14
ci_0016                 1.559323e-02 3 1  ON 15
ci_0017                 1.403466e-02 3 1  ON 16
ci_0018                 1.381531e-02 3 1  ON 17
ci_0019                 1.180913e-02 3 1  ON 18
ci_0020                 1.214033e-02 3 1  ON 19
ci_0021                 8.242149e-03 3 1  ON 20
ci_0022                 7.679172e-03 3 1  ON 21
ci_0023                -1.217289e-02 3 1  ON 22
ci_0024                -1.120635e-02 3 1  ON 23
ci_0025                -1.171837e-02 3 1  ON 24
ci_0026                -1.176678e-02 3 1  ON 25
ci_0027                -1.175470e-02 3 1  ON 26
ci_0028                -1.115784e-02 3 1  ON 27
ci_0029                -1.027819e-02 3 1  ON 28
ci_0030                -1.001694e-02 3 1  ON 29
ci_0031                 1.945837e-02 3 1  ON 30
ci_0032                 1.954242e-02 3 1  ON 31
ci_0033                 1.132433e-02 3 1  ON 32
ci_0034                 9.372668e-03 3 1  ON 33
ci_0035                 6.348632e-03 3 1  ON 34
ci_0036                 6.490026e-03 3 1  ON 35
ci_0037                -1.144163e-02 3 1  ON 36
ci_0038                -1.122503e-02 3 1  ON 37
ci_0039                -4.187620e-03 3 1  ON 38
ci_0040                -4.440961e-03 3 1  ON 39
ci_0041                 8.228188e-03 3 1  ON 40
ci_0042                 8.753128e-03 3 1  ON 41
ci_0043                -1.371557e-02 3 1  ON 42
ci_0044                -1.325470e-02 3 1  ON 43
ci_0045                 8.519451e-03 3 1  ON 44
ci_0046                 8.823119e-03 3 1  ON 45
ci_0047                -3.583835e-03 3 1  ON 46
ci_0048                -3.418204e-03 3 1  ON 47
ci_0049                -6.928222e-03 3 1  ON 48
ci_0050                -6.402547e-03 3 1  ON 49
ci_0051                -4.776262e-03 3 1  ON 50
ci_0052                -4.691763e-03 3 1  ON 51
ci_0053                -6.528188e-03 3 1  ON 52
ci_0054                -6.231562e-03 3 1  ON 53
ci_0055                 6.742205e-03 3 1  ON 54
ci_0056                 7.750999e-03 3 1  ON 55
ci_0057                 4.976967e-03 3 1  ON 56
ci_0058                 5.619733e-03 3 1  ON 57
ci_0059                -5.652661e-03 3 1  ON 58
ci_0060                -6.191203e-03 3 1  ON 59
ci_0061                -4.523791e-03 3 1  ON 60
ci_0062                -4.369640e-03 3 1  ON 61
ci_0063                -9.250621e-03 3 1  ON 62
ci_0064                -8.909117e-03 3 1  ON 63
ci_0065                -6.652769e-03 3 1  ON 64
ci_0066                -6.332321e-03 3 1  ON 65
ci_0067                -6.079207e-03 3 1  ON 66
ci_0068                -6.270934e-03 3 1  ON 67
ci_0069                 5.536938e-03 3 1  ON 68
ci_0070                 5.394635e-03 3 1  ON 69
ci_0071                 4.227590e-03 3 1  ON 70
ci_0072                 4.668156e-03 3 1  ON 71
ci_0073                 4.932806e-03 3 1  ON 72
ci_0074                 5.147925e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.228135
====================================================
  Execution time = 1.4641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2772e-01
  Total weights = 1.951540156e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313441807919
                                         uncertainty =       0.002624584618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313441807919
                                         uncertainty =       0.002624584618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395955646
  error estimate for blocks of size 2^( 2) =       0.000410009566
  error estimate for blocks of size 2^( 3) =       0.000424127954
  error estimate for blocks of size 2^( 4) =       0.000437136137
  error estimate for blocks of size 2^( 5) =       0.000448733597
  error estimate for blocks of size 2^( 6) =       0.000455609157
  error estimate for blocks of size 2^( 7) =       0.000462171007

      target function =                  N/A
              le_mean =     -16.903845482960
             les_mean =     286.067712751925
             stat err =       0.000450912475
             autocorr =       1.296855001053
              std dev =       0.559965844355
             le_variance =       0.313561746844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690384548296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903845482966       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903860882550       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903860078146       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903860236696       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e-01 is 6.894557e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903845482966       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903850754261       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903850532724       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903850552898       residual = 1.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.189080e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903845482966       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903846934794       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903846888185       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903846889710       residual = 1.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 5.866003e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7253e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.003798e-01 3 1  ON 0
ci_0002                 7.000273e-01 3 1  ON 1
ci_0003                -3.086576e-02 3 1  ON 2
ci_0004                -3.077131e-02 3 1  ON 3
ci_0005                -3.423014e-02 3 1  ON 4
ci_0006                -3.443384e-02 3 1  ON 5
ci_0007                -2.353261e-02 3 1  ON 6
ci_0008                -2.326578e-02 3 1  ON 7
ci_0009                -2.037620e-02 3 1  ON 8
ci_0010                -2.008460e-02 3 1  ON 9
ci_0011                -1.491801e-02 3 1  ON 10
ci_0012                -1.493916e-02 3 1  ON 11
ci_0013                 1.621947e-02 3 1  ON 12
ci_0014                 1.588698e-02 3 1  ON 13
ci_0015                 1.550804e-02 3 1  ON 14
ci_0016                 1.556314e-02 3 1  ON 15
ci_0017                 1.397265e-02 3 1  ON 16
ci_0018                 1.385012e-02 3 1  ON 17
ci_0019                 1.193438e-02 3 1  ON 18
ci_0020                 1.212176e-02 3 1  ON 19
ci_0021                 8.162560e-03 3 1  ON 20
ci_0022                 7.527080e-03 3 1  ON 21
ci_0023                -1.198575e-02 3 1  ON 22
ci_0024                -1.124509e-02 3 1  ON 23
ci_0025                -1.172423e-02 3 1  ON 24
ci_0026                -1.163023e-02 3 1  ON 25
ci_0027                -1.168901e-02 3 1  ON 26
ci_0028                -1.121636e-02 3 1  ON 27
ci_0029                -1.044777e-02 3 1  ON 28
ci_0030                -1.018213e-02 3 1  ON 29
ci_0031                 1.938739e-02 3 1  ON 30
ci_0032                 1.949584e-02 3 1  ON 31
ci_0033                 1.120132e-02 3 1  ON 32
ci_0034                 9.470346e-03 3 1  ON 33
ci_0035                 6.476649e-03 3 1  ON 34
ci_0036                 6.435973e-03 3 1  ON 35
ci_0037                -1.134437e-02 3 1  ON 36
ci_0038                -1.128902e-02 3 1  ON 37
ci_0039                -4.068277e-03 3 1  ON 38
ci_0040                -4.429686e-03 3 1  ON 39
ci_0041                 8.286257e-03 3 1  ON 40
ci_0042                 8.752830e-03 3 1  ON 41
ci_0043                -1.371852e-02 3 1  ON 42
ci_0044                -1.324824e-02 3 1  ON 43
ci_0045                 8.454829e-03 3 1  ON 44
ci_0046                 9.042027e-03 3 1  ON 45
ci_0047                -3.543321e-03 3 1  ON 46
ci_0048                -3.397443e-03 3 1  ON 47
ci_0049                -6.768009e-03 3 1  ON 48
ci_0050                -6.334358e-03 3 1  ON 49
ci_0051                -4.897468e-03 3 1  ON 50
ci_0052                -4.702600e-03 3 1  ON 51
ci_0053                -6.444275e-03 3 1  ON 52
ci_0054                -6.154985e-03 3 1  ON 53
ci_0055                 6.813506e-03 3 1  ON 54
ci_0056                 7.719642e-03 3 1  ON 55
ci_0057                 5.177610e-03 3 1  ON 56
ci_0058                 5.664657e-03 3 1  ON 57
ci_0059                -5.794336e-03 3 1  ON 58
ci_0060                -6.222745e-03 3 1  ON 59
ci_0061                -4.329060e-03 3 1  ON 60
ci_0062                -4.326930e-03 3 1  ON 61
ci_0063                -9.146579e-03 3 1  ON 62
ci_0064                -8.798840e-03 3 1  ON 63
ci_0065                -6.719898e-03 3 1  ON 64
ci_0066                -6.400360e-03 3 1  ON 65
ci_0067                -6.215183e-03 3 1  ON 66
ci_0068                -6.325542e-03 3 1  ON 67
ci_0069                 5.472540e-03 3 1  ON 68
ci_0070                 5.366639e-03 3 1  ON 69
ci_0071                 4.224226e-03 3 1  ON 70
ci_0072                 4.656581e-03 3 1  ON 71
ci_0073                 5.001685e-03 3 1  ON 72
ci_0074                 5.074310e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.192331
====================================================
  Execution time = 1.4355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2460e-01
  Total weights = 1.9519e+06
  Execution time = 1.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310678766311
                                         uncertainty =       0.002594603131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310678766311
                                         uncertainty =       0.002594603131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394170777
  error estimate for blocks of size 2^( 2) =       0.000408920157
  error estimate for blocks of size 2^( 3) =       0.000423627619
  error estimate for blocks of size 2^( 4) =       0.000437622650
  error estimate for blocks of size 2^( 5) =       0.000449620688
  error estimate for blocks of size 2^( 6) =       0.000458299067
  error estimate for blocks of size 2^( 7) =       0.000462560895

      target function =                  N/A
              le_mean =     -16.904054414217
             les_mean =     286.073128809744
             stat err =       0.000452025825
             autocorr =       1.315096576585
              std dev =       0.557441659123
             le_variance =       0.310741203326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310714330198
                                         uncertainty =       0.002582049866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310714330198
                                         uncertainty =       0.002582049866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394193332
  error estimate for blocks of size 2^( 2) =       0.000408918647
  error estimate for blocks of size 2^( 3) =       0.000423620358
  error estimate for blocks of size 2^( 4) =       0.000437614832
  error estimate for blocks of size 2^( 5) =       0.000449614012
  error estimate for blocks of size 2^( 6) =       0.000458273720
  error estimate for blocks of size 2^( 7) =       0.000462536732

      target function =                  N/A
              le_mean =     -16.904067154349
             les_mean =     286.719654945688
             stat err =       0.000452009824
             autocorr =       1.314852993709
              std dev =       0.557473556760
             le_variance =       0.310776766486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310658522353
                                         uncertainty =       0.002584595110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310658522353
                                         uncertainty =       0.002584595110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394158052
  error estimate for blocks of size 2^( 2) =       0.000408899082
  error estimate for blocks of size 2^( 3) =       0.000423604506
  error estimate for blocks of size 2^( 4) =       0.000437600807
  error estimate for blocks of size 2^( 5) =       0.000449602950
  error estimate for blocks of size 2^( 6) =       0.000458275662
  error estimate for blocks of size 2^( 7) =       0.000462535784

      target function =                  N/A
              le_mean =     -16.904055781891
             les_mean =     286.071877447691
             stat err =       0.000452003801
             autocorr =       1.315053340468
              std dev =       0.557423662163
             le_variance =       0.310721139139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310670933102
                                         uncertainty =       0.002593008798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310670933102
                                         uncertainty =       0.002593008798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394165830
  error estimate for blocks of size 2^( 2) =       0.000408913938
  error estimate for blocks of size 2^( 3) =       0.000423621098
  error estimate for blocks of size 2^( 4) =       0.000437615965
  error estimate for blocks of size 2^( 5) =       0.000449613683
  error estimate for blocks of size 2^( 6) =       0.000458290507
  error estimate for blocks of size 2^( 7) =       0.000462552049

      target function =                  N/A
              le_mean =     -16.904053616799
             les_mean =     286.071998244186
             stat err =       0.000452018051
             autocorr =       1.315084355149
              std dev =       0.557434662451
             le_variance =       0.310733402902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904054414217        initial
     3.7253e-01     3.7253e+00             6.8946e-04       -16.904067154349  <--
     1.4901e+00     1.4901e+01             2.1891e-04       -16.904055781891
     5.9605e+00     5.9605e+01             5.8660e-05       -16.904053616799

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.3851e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.003134e-01 3 1  ON 0
ci_0002                 7.001162e-01 3 1  ON 1
ci_0003                -3.100673e-02 3 1  ON 2
ci_0004                -3.095831e-02 3 1  ON 3
ci_0005                -3.412818e-02 3 1  ON 4
ci_0006                -3.440057e-02 3 1  ON 5
ci_0007                -2.320640e-02 3 1  ON 6
ci_0008                -2.345868e-02 3 1  ON 7
ci_0009                -2.032728e-02 3 1  ON 8
ci_0010                -1.997719e-02 3 1  ON 9
ci_0011                -1.481709e-02 3 1  ON 10
ci_0012                -1.476896e-02 3 1  ON 11
ci_0013                 1.599601e-02 3 1  ON 12
ci_0014                 1.591671e-02 3 1  ON 13
ci_0015                 1.565125e-02 3 1  ON 14
ci_0016                 1.549730e-02 3 1  ON 15
ci_0017                 1.386199e-02 3 1  ON 16
ci_0018                 1.391386e-02 3 1  ON 17
ci_0019                 1.218022e-02 3 1  ON 18
ci_0020                 1.209001e-02 3 1  ON 19
ci_0021                 7.971892e-03 3 1  ON 20
ci_0022                 7.159635e-03 3 1  ON 21
ci_0023                -1.164898e-02 3 1  ON 22
ci_0024                -1.131642e-02 3 1  ON 23
ci_0025                -1.172509e-02 3 1  ON 24
ci_0026                -1.137513e-02 3 1  ON 25
ci_0027                -1.156652e-02 3 1  ON 26
ci_0028                -1.132758e-02 3 1  ON 27
ci_0029                -1.076947e-02 3 1  ON 28
ci_0030                -1.050257e-02 3 1  ON 29
ci_0031                 1.922211e-02 3 1  ON 30
ci_0032                 1.938529e-02 3 1  ON 31
ci_0033                 1.091354e-02 3 1  ON 32
ci_0034                 9.697836e-03 3 1  ON 33
ci_0035                 6.729433e-03 3 1  ON 34
ci_0036                 6.330504e-03 3 1  ON 35
ci_0037                -1.114657e-02 3 1  ON 36
ci_0038                -1.142799e-02 3 1  ON 37
ci_0039                -3.885498e-03 3 1  ON 38
ci_0040                -4.413018e-03 3 1  ON 39
ci_0041                 8.392889e-03 3 1  ON 40
ci_0042                 8.751481e-03 3 1  ON 41
ci_0043                -1.370617e-02 3 1  ON 42
ci_0044                -1.322652e-02 3 1  ON 43
ci_0045                 8.308152e-03 3 1  ON 44
ci_0046                 9.512574e-03 3 1  ON 45
ci_0047                -3.481000e-03 3 1  ON 46
ci_0048                -3.366416e-03 3 1  ON 47
ci_0049                -6.462268e-03 3 1  ON 48
ci_0050                -6.214103e-03 3 1  ON 49
ci_0051                -5.090725e-03 3 1  ON 50
ci_0052                -4.717882e-03 3 1  ON 51
ci_0053                -6.303624e-03 3 1  ON 52
ci_0054                -6.029773e-03 3 1  ON 53
ci_0055                 6.963857e-03 3 1  ON 54
ci_0056                 7.654228e-03 3 1  ON 55
ci_0057                 5.571529e-03 3 1  ON 56
ci_0058                 5.760371e-03 3 1  ON 57
ci_0059                -6.025424e-03 3 1  ON 58
ci_0060                -6.271579e-03 3 1  ON 59
ci_0061                -3.946460e-03 3 1  ON 60
ci_0062                -4.245498e-03 3 1  ON 61
ci_0063                -8.970875e-03 3 1  ON 62
ci_0064                -8.609438e-03 3 1  ON 63
ci_0065                -6.837646e-03 3 1  ON 64
ci_0066                -6.519856e-03 3 1  ON 65
ci_0067                -6.432964e-03 3 1  ON 66
ci_0068                -6.410918e-03 3 1  ON 67
ci_0069                 5.373123e-03 3 1  ON 68
ci_0070                 5.323330e-03 3 1  ON 69
ci_0071                 4.214615e-03 3 1  ON 70
ci_0072                 4.632118e-03 3 1  ON 71
ci_0073                 5.104380e-03 3 1  ON 72
ci_0074                 4.958631e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9685
    reference variance = 0.281702
====================================================
  Execution time = 1.4600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2590e-01
  Total weights = 1.951892719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312905712260
                                         uncertainty =       0.002083905498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312905712260
                                         uncertainty =       0.002083905498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395529159
  error estimate for blocks of size 2^( 2) =       0.000409292529
  error estimate for blocks of size 2^( 3) =       0.000423127733
  error estimate for blocks of size 2^( 4) =       0.000435694852
  error estimate for blocks of size 2^( 5) =       0.000447069974
  error estimate for blocks of size 2^( 6) =       0.000455500296
  error estimate for blocks of size 2^( 7) =       0.000458086771

      target function =                  N/A
              le_mean =     -16.904270152794
             les_mean =     286.080245683749
             stat err =       0.000449087973
             autocorr =       1.289157080118
              std dev =       0.559362700444
             le_variance =       0.312886630648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690427015279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904270152795       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904293794276       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904295190729       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904294861741       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904294557270       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-02 is 1.483800e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904270152795       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904282875600       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904283189203       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904283045037       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e-01 is 6.197550e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904270152795       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904274621043       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904274702082       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904274667584       residual = 9.50e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.037361e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7203e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.003615e-01 3 1  ON 0
ci_0002                 7.000869e-01 3 1  ON 1
ci_0003                -3.141267e-02 3 1  ON 2
ci_0004                -3.064352e-02 3 1  ON 3
ci_0005                -3.418831e-02 3 1  ON 4
ci_0006                -3.407439e-02 3 1  ON 5
ci_0007                -2.345373e-02 3 1  ON 6
ci_0008                -2.353030e-02 3 1  ON 7
ci_0009                -2.031671e-02 3 1  ON 8
ci_0010                -2.004447e-02 3 1  ON 9
ci_0011                -1.476188e-02 3 1  ON 10
ci_0012                -1.492083e-02 3 1  ON 11
ci_0013                 1.588737e-02 3 1  ON 12
ci_0014                 1.582012e-02 3 1  ON 13
ci_0015                 1.585185e-02 3 1  ON 14
ci_0016                 1.547045e-02 3 1  ON 15
ci_0017                 1.331317e-02 3 1  ON 16
ci_0018                 1.367708e-02 3 1  ON 17
ci_0019                 1.193174e-02 3 1  ON 18
ci_0020                 1.198601e-02 3 1  ON 19
ci_0021                 8.012471e-03 3 1  ON 20
ci_0022                 7.062480e-03 3 1  ON 21
ci_0023                -1.128415e-02 3 1  ON 22
ci_0024                -1.150631e-02 3 1  ON 23
ci_0025                -1.164694e-02 3 1  ON 24
ci_0026                -1.168899e-02 3 1  ON 25
ci_0027                -1.154967e-02 3 1  ON 26
ci_0028                -1.140500e-02 3 1  ON 27
ci_0029                -1.089274e-02 3 1  ON 28
ci_0030                -1.055164e-02 3 1  ON 29
ci_0031                 1.925918e-02 3 1  ON 30
ci_0032                 1.932121e-02 3 1  ON 31
ci_0033                 1.029378e-02 3 1  ON 32
ci_0034                 1.005788e-02 3 1  ON 33
ci_0035                 6.657124e-03 3 1  ON 34
ci_0036                 6.216351e-03 3 1  ON 35
ci_0037                -1.074291e-02 3 1  ON 36
ci_0038                -1.160619e-02 3 1  ON 37
ci_0039                -4.393609e-03 3 1  ON 38
ci_0040                -4.359166e-03 3 1  ON 39
ci_0041                 8.344228e-03 3 1  ON 40
ci_0042                 8.869023e-03 3 1  ON 41
ci_0043                -1.383471e-02 3 1  ON 42
ci_0044                -1.342753e-02 3 1  ON 43
ci_0045                 8.550879e-03 3 1  ON 44
ci_0046                 9.359948e-03 3 1  ON 45
ci_0047                -3.500550e-03 3 1  ON 46
ci_0048                -3.530095e-03 3 1  ON 47
ci_0049                -6.430266e-03 3 1  ON 48
ci_0050                -6.264703e-03 3 1  ON 49
ci_0051                -5.148557e-03 3 1  ON 50
ci_0052                -4.397474e-03 3 1  ON 51
ci_0053                -6.166737e-03 3 1  ON 52
ci_0054                -5.834438e-03 3 1  ON 53
ci_0055                 7.106349e-03 3 1  ON 54
ci_0056                 7.370753e-03 3 1  ON 55
ci_0057                 5.720429e-03 3 1  ON 56
ci_0058                 5.547479e-03 3 1  ON 57
ci_0059                -5.771050e-03 3 1  ON 58
ci_0060                -6.231712e-03 3 1  ON 59
ci_0061                -4.502467e-03 3 1  ON 60
ci_0062                -4.093669e-03 3 1  ON 61
ci_0063                -8.937222e-03 3 1  ON 62
ci_0064                -8.770183e-03 3 1  ON 63
ci_0065                -6.719022e-03 3 1  ON 64
ci_0066                -6.945729e-03 3 1  ON 65
ci_0067                -6.522527e-03 3 1  ON 66
ci_0068                -6.309470e-03 3 1  ON 67
ci_0069                 5.312770e-03 3 1  ON 68
ci_0070                 5.206646e-03 3 1  ON 69
ci_0071                 3.871598e-03 3 1  ON 70
ci_0072                 4.321971e-03 3 1  ON 71
ci_0073                 5.312569e-03 3 1  ON 72
ci_0074                 5.056804e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.238667
====================================================
  Execution time = 1.4363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2299e-01
  Total weights = 1.9518e+06
  Execution time = 1.8682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309169953216
                                         uncertainty =       0.002188050892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309169953216
                                         uncertainty =       0.002188050892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393168707
  error estimate for blocks of size 2^( 2) =       0.000407552624
  error estimate for blocks of size 2^( 3) =       0.000421614901
  error estimate for blocks of size 2^( 4) =       0.000434692104
  error estimate for blocks of size 2^( 5) =       0.000446387037
  error estimate for blocks of size 2^( 6) =       0.000454750180
  error estimate for blocks of size 2^( 7) =       0.000460877383

      target function =                  N/A
              le_mean =     -16.904433129895
             les_mean =     286.094866800025
             stat err =       0.000449176676
             autocorr =       1.305198320055
              std dev =       0.556024517363
             le_variance =       0.309163263909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309167056666
                                         uncertainty =       0.002224680127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309167056666
                                         uncertainty =       0.002224680127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393165425
  error estimate for blocks of size 2^( 2) =       0.000407564078
  error estimate for blocks of size 2^( 3) =       0.000421658572
  error estimate for blocks of size 2^( 4) =       0.000434751263
  error estimate for blocks of size 2^( 5) =       0.000446455398
  error estimate for blocks of size 2^( 6) =       0.000454852810
  error estimate for blocks of size 2^( 7) =       0.000460973189

      target function =                  N/A
              le_mean =     -16.904438725205
             les_mean =     286.084780181981
             stat err =       0.000449258165
             autocorr =       1.305693737067
              std dev =       0.556019875813
             le_variance =       0.309158102299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309147378235
                                         uncertainty =       0.002228414180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309147378235
                                         uncertainty =       0.002228414180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393152696
  error estimate for blocks of size 2^( 2) =       0.000407554341
  error estimate for blocks of size 2^( 3) =       0.000421654257
  error estimate for blocks of size 2^( 4) =       0.000434750496
  error estimate for blocks of size 2^( 5) =       0.000446452799
  error estimate for blocks of size 2^( 6) =       0.000454851865
  error estimate for blocks of size 2^( 7) =       0.000460964025

      target function =                  N/A
              le_mean =     -16.904441246401
             les_mean =     286.083240293762
             stat err =       0.000449254796
             autocorr =       1.305758699516
              std dev =       0.556001875255
             le_variance =       0.309138085287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309098877728
                                         uncertainty =       0.002193632422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309098877728
                                         uncertainty =       0.002193632422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393123306
  error estimate for blocks of size 2^( 2) =       0.000407511804
  error estimate for blocks of size 2^( 3) =       0.000421584711
  error estimate for blocks of size 2^( 4) =       0.000434666222
  error estimate for blocks of size 2^( 5) =       0.000446362237
  error estimate for blocks of size 2^( 6) =       0.000454734181
  error estimate for blocks of size 2^( 7) =       0.000460887584

      target function =                  N/A
              le_mean =     -16.904434297411
             les_mean =     286.083198166134
             stat err =       0.000449162556
             autocorr =       1.305417729707
              std dev =       0.555960310833
             le_variance =       0.309091867222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904433129895        initial
     9.3132e-02     9.3132e-01             1.4838e-03       -16.904438725205
     3.7253e-01     3.7253e+00             6.1976e-04       -16.904441246401  <--
     1.4901e+00     1.4901e+01             2.0374e-04       -16.904434297411

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.3808e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.003615e-01 3 1  ON 0
ci_0002                 7.000869e-01 3 1  ON 1
ci_0003                -3.141267e-02 3 1  ON 2
ci_0004                -3.064352e-02 3 1  ON 3
ci_0005                -3.418831e-02 3 1  ON 4
ci_0006                -3.407439e-02 3 1  ON 5
ci_0007                -2.345373e-02 3 1  ON 6
ci_0008                -2.353030e-02 3 1  ON 7
ci_0009                -2.031671e-02 3 1  ON 8
ci_0010                -2.004447e-02 3 1  ON 9
ci_0011                -1.476188e-02 3 1  ON 10
ci_0012                -1.492083e-02 3 1  ON 11
ci_0013                 1.588737e-02 3 1  ON 12
ci_0014                 1.582012e-02 3 1  ON 13
ci_0015                 1.585185e-02 3 1  ON 14
ci_0016                 1.547045e-02 3 1  ON 15
ci_0017                 1.331317e-02 3 1  ON 16
ci_0018                 1.367708e-02 3 1  ON 17
ci_0019                 1.193174e-02 3 1  ON 18
ci_0020                 1.198601e-02 3 1  ON 19
ci_0021                 8.012471e-03 3 1  ON 20
ci_0022                 7.062480e-03 3 1  ON 21
ci_0023                -1.128415e-02 3 1  ON 22
ci_0024                -1.150631e-02 3 1  ON 23
ci_0025                -1.164694e-02 3 1  ON 24
ci_0026                -1.168899e-02 3 1  ON 25
ci_0027                -1.154967e-02 3 1  ON 26
ci_0028                -1.140500e-02 3 1  ON 27
ci_0029                -1.089274e-02 3 1  ON 28
ci_0030                -1.055164e-02 3 1  ON 29
ci_0031                 1.925918e-02 3 1  ON 30
ci_0032                 1.932121e-02 3 1  ON 31
ci_0033                 1.029378e-02 3 1  ON 32
ci_0034                 1.005788e-02 3 1  ON 33
ci_0035                 6.657124e-03 3 1  ON 34
ci_0036                 6.216351e-03 3 1  ON 35
ci_0037                -1.074291e-02 3 1  ON 36
ci_0038                -1.160619e-02 3 1  ON 37
ci_0039                -4.393609e-03 3 1  ON 38
ci_0040                -4.359166e-03 3 1  ON 39
ci_0041                 8.344228e-03 3 1  ON 40
ci_0042                 8.869023e-03 3 1  ON 41
ci_0043                -1.383471e-02 3 1  ON 42
ci_0044                -1.342753e-02 3 1  ON 43
ci_0045                 8.550879e-03 3 1  ON 44
ci_0046                 9.359948e-03 3 1  ON 45
ci_0047                -3.500550e-03 3 1  ON 46
ci_0048                -3.530095e-03 3 1  ON 47
ci_0049                -6.430266e-03 3 1  ON 48
ci_0050                -6.264703e-03 3 1  ON 49
ci_0051                -5.148557e-03 3 1  ON 50
ci_0052                -4.397474e-03 3 1  ON 51
ci_0053                -6.166737e-03 3 1  ON 52
ci_0054                -5.834438e-03 3 1  ON 53
ci_0055                 7.106349e-03 3 1  ON 54
ci_0056                 7.370753e-03 3 1  ON 55
ci_0057                 5.720429e-03 3 1  ON 56
ci_0058                 5.547479e-03 3 1  ON 57
ci_0059                -5.771050e-03 3 1  ON 58
ci_0060                -6.231712e-03 3 1  ON 59
ci_0061                -4.502467e-03 3 1  ON 60
ci_0062                -4.093669e-03 3 1  ON 61
ci_0063                -8.937222e-03 3 1  ON 62
ci_0064                -8.770183e-03 3 1  ON 63
ci_0065                -6.719022e-03 3 1  ON 64
ci_0066                -6.945729e-03 3 1  ON 65
ci_0067                -6.522527e-03 3 1  ON 66
ci_0068                -6.309470e-03 3 1  ON 67
ci_0069                 5.312770e-03 3 1  ON 68
ci_0070                 5.206646e-03 3 1  ON 69
ci_0071                 3.871598e-03 3 1  ON 70
ci_0072                 4.321971e-03 3 1  ON 71
ci_0073                 5.312569e-03 3 1  ON 72
ci_0074                 5.056804e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1016e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8882
    reference variance = 0.193842
====================================================
  Execution time = 1.4607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2850e-01
  Total weights = 1.951566663e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314478318827
                                         uncertainty =       0.002417882214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314478318827
                                         uncertainty =       0.002417882214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396501748
  error estimate for blocks of size 2^( 2) =       0.000410572684
  error estimate for blocks of size 2^( 3) =       0.000424281653
  error estimate for blocks of size 2^( 4) =       0.000437087834
  error estimate for blocks of size 2^( 5) =       0.000447904148
  error estimate for blocks of size 2^( 6) =       0.000455858864
  error estimate for blocks of size 2^( 7) =       0.000461966088

      target function =                  N/A
              le_mean =     -16.904413876720
             les_mean =     286.087712347323
             stat err =       0.000450704234
             autocorr =       1.292090885826
              std dev =       0.560738149250
             le_variance =       0.314427272024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690441387672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904413876745       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904452269947       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904451634108       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904452649192       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904452621593       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-02 is 1.426370e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904413876745       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904434405047       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904434021779       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904434196758       residual = 9.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e-01 is 5.755914e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904413876745       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904421051299       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904421042668       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 2.093670e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7238e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.004136e-01 3 1  ON 0
ci_0002                 7.000887e-01 3 1  ON 1
ci_0003                -3.114737e-02 3 1  ON 2
ci_0004                -3.022212e-02 3 1  ON 3
ci_0005                -3.420250e-02 3 1  ON 4
ci_0006                -3.408515e-02 3 1  ON 5
ci_0007                -2.290824e-02 3 1  ON 6
ci_0008                -2.365453e-02 3 1  ON 7
ci_0009                -2.010096e-02 3 1  ON 8
ci_0010                -1.981137e-02 3 1  ON 9
ci_0011                -1.504250e-02 3 1  ON 10
ci_0012                -1.492142e-02 3 1  ON 11
ci_0013                 1.612633e-02 3 1  ON 12
ci_0014                 1.577266e-02 3 1  ON 13
ci_0015                 1.551519e-02 3 1  ON 14
ci_0016                 1.524862e-02 3 1  ON 15
ci_0017                 1.332869e-02 3 1  ON 16
ci_0018                 1.395674e-02 3 1  ON 17
ci_0019                 1.172647e-02 3 1  ON 18
ci_0020                 1.212648e-02 3 1  ON 19
ci_0021                 7.858374e-03 3 1  ON 20
ci_0022                 7.050864e-03 3 1  ON 21
ci_0023                -1.151300e-02 3 1  ON 22
ci_0024                -1.147160e-02 3 1  ON 23
ci_0025                -1.172138e-02 3 1  ON 24
ci_0026                -1.155008e-02 3 1  ON 25
ci_0027                -1.149060e-02 3 1  ON 26
ci_0028                -1.087674e-02 3 1  ON 27
ci_0029                -1.081015e-02 3 1  ON 28
ci_0030                -1.093837e-02 3 1  ON 29
ci_0031                 1.918296e-02 3 1  ON 30
ci_0032                 1.904203e-02 3 1  ON 31
ci_0033                 1.071844e-02 3 1  ON 32
ci_0034                 1.017983e-02 3 1  ON 33
ci_0035                 6.304448e-03 3 1  ON 34
ci_0036                 6.791943e-03 3 1  ON 35
ci_0037                -1.124574e-02 3 1  ON 36
ci_0038                -1.187917e-02 3 1  ON 37
ci_0039                -4.265633e-03 3 1  ON 38
ci_0040                -4.489893e-03 3 1  ON 39
ci_0041                 8.472859e-03 3 1  ON 40
ci_0042                 8.988523e-03 3 1  ON 41
ci_0043                -1.411945e-02 3 1  ON 42
ci_0044                -1.333495e-02 3 1  ON 43
ci_0045                 8.501976e-03 3 1  ON 44
ci_0046                 8.942979e-03 3 1  ON 45
ci_0047                -2.966403e-03 3 1  ON 46
ci_0048                -3.048261e-03 3 1  ON 47
ci_0049                -6.467548e-03 3 1  ON 48
ci_0050                -6.566441e-03 3 1  ON 49
ci_0051                -5.050581e-03 3 1  ON 50
ci_0052                -4.322652e-03 3 1  ON 51
ci_0053                -5.995762e-03 3 1  ON 52
ci_0054                -5.955332e-03 3 1  ON 53
ci_0055                 6.589602e-03 3 1  ON 54
ci_0056                 7.458902e-03 3 1  ON 55
ci_0057                 5.445539e-03 3 1  ON 56
ci_0058                 5.178599e-03 3 1  ON 57
ci_0059                -5.918913e-03 3 1  ON 58
ci_0060                -6.267745e-03 3 1  ON 59
ci_0061                -4.301599e-03 3 1  ON 60
ci_0062                -4.121962e-03 3 1  ON 61
ci_0063                -8.997090e-03 3 1  ON 62
ci_0064                -9.176042e-03 3 1  ON 63
ci_0065                -6.843232e-03 3 1  ON 64
ci_0066                -6.623599e-03 3 1  ON 65
ci_0067                -6.272605e-03 3 1  ON 66
ci_0068                -6.163066e-03 3 1  ON 67
ci_0069                 5.302499e-03 3 1  ON 68
ci_0070                 5.411469e-03 3 1  ON 69
ci_0071                 3.801344e-03 3 1  ON 70
ci_0072                 4.418550e-03 3 1  ON 71
ci_0073                 5.445339e-03 3 1  ON 72
ci_0074                 5.297479e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.205669
====================================================
  Execution time = 1.4244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2157e-01
  Total weights = 1.9516e+06
  Execution time = 1.8777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311406801715
                                         uncertainty =       0.002071619916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311406801715
                                         uncertainty =       0.002071619916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394651711
  error estimate for blocks of size 2^( 2) =       0.000408568758
  error estimate for blocks of size 2^( 3) =       0.000422853110
  error estimate for blocks of size 2^( 4) =       0.000435089445
  error estimate for blocks of size 2^( 5) =       0.000445358320
  error estimate for blocks of size 2^( 6) =       0.000453548541
  error estimate for blocks of size 2^( 7) =       0.000459699598

      target function =                  N/A
              le_mean =     -16.904368299032
             les_mean =     286.140251771350
             stat err =       0.000448423976
             autocorr =       1.291069645431
              std dev =       0.558121801708
             le_variance =       0.311499945542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311185762744
                                         uncertainty =       0.002053690804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311185762744
                                         uncertainty =       0.002053690804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394511742
  error estimate for blocks of size 2^( 2) =       0.000408462056
  error estimate for blocks of size 2^( 3) =       0.000422761689
  error estimate for blocks of size 2^( 4) =       0.000435020091
  error estimate for blocks of size 2^( 5) =       0.000445298274
  error estimate for blocks of size 2^( 6) =       0.000453437639
  error estimate for blocks of size 2^( 7) =       0.000459680940

      target function =                  N/A
              le_mean =     -16.904367619142
             les_mean =     286.120376313500
             stat err =       0.000448359236
             autocorr =       1.291612899098
              std dev =       0.557923855868
             le_variance =       0.311279028946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311146440760
                                         uncertainty =       0.002061145645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311146440760
                                         uncertainty =       0.002061145645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394487435
  error estimate for blocks of size 2^( 2) =       0.000408441505
  error estimate for blocks of size 2^( 3) =       0.000422748376
  error estimate for blocks of size 2^( 4) =       0.000435004985
  error estimate for blocks of size 2^( 5) =       0.000445286295
  error estimate for blocks of size 2^( 6) =       0.000453431694
  error estimate for blocks of size 2^( 7) =       0.000459682318

      target function =                  N/A
              le_mean =     -16.904361880691
             les_mean =     286.089661026625
             stat err =       0.000448351323
             autocorr =       1.291726475356
              std dev =       0.557889481078
             le_variance =       0.311240673098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311286596234
                                         uncertainty =       0.002060141282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311286596234
                                         uncertainty =       0.002060141282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394575849
  error estimate for blocks of size 2^( 2) =       0.000408498161
  error estimate for blocks of size 2^( 3) =       0.000422781518
  error estimate for blocks of size 2^( 4) =       0.000435017312
  error estimate for blocks of size 2^( 5) =       0.000445282041
  error estimate for blocks of size 2^( 6) =       0.000453456875
  error estimate for blocks of size 2^( 7) =       0.000459625041

      target function =                  N/A
              le_mean =     -16.904366228925
             les_mean =     286.082660504791
             stat err =       0.000448345317
             autocorr =       1.291113068237
              std dev =       0.558014516780
             le_variance =       0.311380200937


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904368299032        initial  <--
     9.3132e-02     9.3132e-01             1.4264e-03       -16.904367619142
     3.7253e-01     3.7253e+00             5.7559e-04       -16.904361880691
     1.4901e+00     1.4901e+01             2.0937e-04       -16.904366228925

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7334
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.003615e-01 3 1  ON 0
ci_0002                 7.000869e-01 3 1  ON 1
ci_0003                -3.141267e-02 3 1  ON 2
ci_0004                -3.064352e-02 3 1  ON 3
ci_0005                -3.418831e-02 3 1  ON 4
ci_0006                -3.407439e-02 3 1  ON 5
ci_0007                -2.345373e-02 3 1  ON 6
ci_0008                -2.353030e-02 3 1  ON 7
ci_0009                -2.031671e-02 3 1  ON 8
ci_0010                -2.004447e-02 3 1  ON 9
ci_0011                -1.476188e-02 3 1  ON 10
ci_0012                -1.492083e-02 3 1  ON 11
ci_0013                 1.588737e-02 3 1  ON 12
ci_0014                 1.582012e-02 3 1  ON 13
ci_0015                 1.585185e-02 3 1  ON 14
ci_0016                 1.547045e-02 3 1  ON 15
ci_0017                 1.331317e-02 3 1  ON 16
ci_0018                 1.367708e-02 3 1  ON 17
ci_0019                 1.193174e-02 3 1  ON 18
ci_0020                 1.198601e-02 3 1  ON 19
ci_0021                 8.012471e-03 3 1  ON 20
ci_0022                 7.062480e-03 3 1  ON 21
ci_0023                -1.128415e-02 3 1  ON 22
ci_0024                -1.150631e-02 3 1  ON 23
ci_0025                -1.164694e-02 3 1  ON 24
ci_0026                -1.168899e-02 3 1  ON 25
ci_0027                -1.154967e-02 3 1  ON 26
ci_0028                -1.140500e-02 3 1  ON 27
ci_0029                -1.089274e-02 3 1  ON 28
ci_0030                -1.055164e-02 3 1  ON 29
ci_0031                 1.925918e-02 3 1  ON 30
ci_0032                 1.932121e-02 3 1  ON 31
ci_0033                 1.029378e-02 3 1  ON 32
ci_0034                 1.005788e-02 3 1  ON 33
ci_0035                 6.657124e-03 3 1  ON 34
ci_0036                 6.216351e-03 3 1  ON 35
ci_0037                -1.074291e-02 3 1  ON 36
ci_0038                -1.160619e-02 3 1  ON 37
ci_0039                -4.393609e-03 3 1  ON 38
ci_0040                -4.359166e-03 3 1  ON 39
ci_0041                 8.344228e-03 3 1  ON 40
ci_0042                 8.869023e-03 3 1  ON 41
ci_0043                -1.383471e-02 3 1  ON 42
ci_0044                -1.342753e-02 3 1  ON 43
ci_0045                 8.550879e-03 3 1  ON 44
ci_0046                 9.359948e-03 3 1  ON 45
ci_0047                -3.500550e-03 3 1  ON 46
ci_0048                -3.530095e-03 3 1  ON 47
ci_0049                -6.430266e-03 3 1  ON 48
ci_0050                -6.264703e-03 3 1  ON 49
ci_0051                -5.148557e-03 3 1  ON 50
ci_0052                -4.397474e-03 3 1  ON 51
ci_0053                -6.166737e-03 3 1  ON 52
ci_0054                -5.834438e-03 3 1  ON 53
ci_0055                 7.106349e-03 3 1  ON 54
ci_0056                 7.370753e-03 3 1  ON 55
ci_0057                 5.720429e-03 3 1  ON 56
ci_0058                 5.547479e-03 3 1  ON 57
ci_0059                -5.771050e-03 3 1  ON 58
ci_0060                -6.231712e-03 3 1  ON 59
ci_0061                -4.502467e-03 3 1  ON 60
ci_0062                -4.093669e-03 3 1  ON 61
ci_0063                -8.937222e-03 3 1  ON 62
ci_0064                -8.770183e-03 3 1  ON 63
ci_0065                -6.719022e-03 3 1  ON 64
ci_0066                -6.945729e-03 3 1  ON 65
ci_0067                -6.522527e-03 3 1  ON 66
ci_0068                -6.309470e-03 3 1  ON 67
ci_0069                 5.312770e-03 3 1  ON 68
ci_0070                 5.206646e-03 3 1  ON 69
ci_0071                 3.871598e-03 3 1  ON 70
ci_0072                 4.321971e-03 3 1  ON 71
ci_0073                 5.312569e-03 3 1  ON 72
ci_0074                 5.056804e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0977e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8787
    reference variance = 0.21863
====================================================
  Execution time = 1.4592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2395e-01
  Total weights = 1.951716303e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312307685908
                                         uncertainty =       0.001820276794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312307685908
                                         uncertainty =       0.001820276794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395135088
  error estimate for blocks of size 2^( 2) =       0.000409406308
  error estimate for blocks of size 2^( 3) =       0.000423668418
  error estimate for blocks of size 2^( 4) =       0.000436658326
  error estimate for blocks of size 2^( 5) =       0.000448661509
  error estimate for blocks of size 2^( 6) =       0.000457965667
  error estimate for blocks of size 2^( 7) =       0.000464487923

      target function =                  N/A
              le_mean =     -16.904255695170
             les_mean =     286.077806560234
             stat err =       0.000451943356
             autocorr =       1.308208054089
              std dev =       0.558805400697
             le_variance =       0.312263475849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690425569517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255695169       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904260835295       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904260216926       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904260242121       residual = 1.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 3.615344e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255695169       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904257197484       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904257077209       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.051411e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255695169       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904256087325       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904256061297       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 2.739248e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7222e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.003655e-01 3 1  ON 0
ci_0002                 7.000900e-01 3 1  ON 1
ci_0003                -3.138689e-02 3 1  ON 2
ci_0004                -3.062819e-02 3 1  ON 3
ci_0005                -3.420351e-02 3 1  ON 4
ci_0006                -3.408998e-02 3 1  ON 5
ci_0007                -2.344150e-02 3 1  ON 6
ci_0008                -2.350968e-02 3 1  ON 7
ci_0009                -2.029680e-02 3 1  ON 8
ci_0010                -2.002105e-02 3 1  ON 9
ci_0011                -1.475146e-02 3 1  ON 10
ci_0012                -1.492343e-02 3 1  ON 11
ci_0013                 1.588942e-02 3 1  ON 12
ci_0014                 1.580835e-02 3 1  ON 13
ci_0015                 1.586954e-02 3 1  ON 14
ci_0016                 1.544440e-02 3 1  ON 15
ci_0017                 1.330208e-02 3 1  ON 16
ci_0018                 1.371376e-02 3 1  ON 17
ci_0019                 1.195119e-02 3 1  ON 18
ci_0020                 1.200437e-02 3 1  ON 19
ci_0021                 7.979170e-03 3 1  ON 20
ci_0022                 7.065014e-03 3 1  ON 21
ci_0023                -1.129004e-02 3 1  ON 22
ci_0024                -1.151615e-02 3 1  ON 23
ci_0025                -1.157308e-02 3 1  ON 24
ci_0026                -1.158385e-02 3 1  ON 25
ci_0027                -1.158963e-02 3 1  ON 26
ci_0028                -1.138037e-02 3 1  ON 27
ci_0029                -1.090077e-02 3 1  ON 28
ci_0030                -1.059794e-02 3 1  ON 29
ci_0031                 1.922299e-02 3 1  ON 30
ci_0032                 1.925777e-02 3 1  ON 31
ci_0033                 1.032783e-02 3 1  ON 32
ci_0034                 1.004432e-02 3 1  ON 33
ci_0035                 6.670087e-03 3 1  ON 34
ci_0036                 6.272263e-03 3 1  ON 35
ci_0037                -1.082296e-02 3 1  ON 36
ci_0038                -1.155142e-02 3 1  ON 37
ci_0039                -4.408221e-03 3 1  ON 38
ci_0040                -4.322457e-03 3 1  ON 39
ci_0041                 8.302893e-03 3 1  ON 40
ci_0042                 8.868207e-03 3 1  ON 41
ci_0043                -1.383109e-02 3 1  ON 42
ci_0044                -1.344300e-02 3 1  ON 43
ci_0045                 8.515796e-03 3 1  ON 44
ci_0046                 9.311696e-03 3 1  ON 45
ci_0047                -3.471866e-03 3 1  ON 46
ci_0048                -3.509300e-03 3 1  ON 47
ci_0049                -6.447107e-03 3 1  ON 48
ci_0050                -6.281948e-03 3 1  ON 49
ci_0051                -5.057061e-03 3 1  ON 50
ci_0052                -4.431170e-03 3 1  ON 51
ci_0053                -6.162061e-03 3 1  ON 52
ci_0054                -5.893023e-03 3 1  ON 53
ci_0055                 7.109299e-03 3 1  ON 54
ci_0056                 7.287154e-03 3 1  ON 55
ci_0057                 5.698317e-03 3 1  ON 56
ci_0058                 5.538498e-03 3 1  ON 57
ci_0059                -5.802098e-03 3 1  ON 58
ci_0060                -6.193478e-03 3 1  ON 59
ci_0061                -4.456349e-03 3 1  ON 60
ci_0062                -4.103611e-03 3 1  ON 61
ci_0063                -8.906564e-03 3 1  ON 62
ci_0064                -8.805313e-03 3 1  ON 63
ci_0065                -6.761915e-03 3 1  ON 64
ci_0066                -6.929053e-03 3 1  ON 65
ci_0067                -6.486013e-03 3 1  ON 66
ci_0068                -6.303291e-03 3 1  ON 67
ci_0069                 5.363813e-03 3 1  ON 68
ci_0070                 5.230320e-03 3 1  ON 69
ci_0071                 3.930310e-03 3 1  ON 70
ci_0072                 4.352710e-03 3 1  ON 71
ci_0073                 5.319998e-03 3 1  ON 72
ci_0074                 5.100025e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9562
    reference variance = 0.224056
====================================================
  Execution time = 1.4243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2369e-01
  Total weights = 1.9516e+06
  Execution time = 1.9695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311553781936
                                         uncertainty =       0.001840168040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311553781936
                                         uncertainty =       0.001840168040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394655087
  error estimate for blocks of size 2^( 2) =       0.000408605255
  error estimate for blocks of size 2^( 3) =       0.000422988486
  error estimate for blocks of size 2^( 4) =       0.000435841709
  error estimate for blocks of size 2^( 5) =       0.000446417049
  error estimate for blocks of size 2^( 6) =       0.000454340599
  error estimate for blocks of size 2^( 7) =       0.000458143078

      target function =                  N/A
              le_mean =     -16.903881424513
             les_mean =     286.064973693303
             stat err =       0.000448685609
             autocorr =       1.292554518012
              std dev =       0.558126576532
             le_variance =       0.311505275431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311459628375
                                         uncertainty =       0.001848782526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311459628375
                                         uncertainty =       0.001848782526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394595578
  error estimate for blocks of size 2^( 2) =       0.000408547418
  error estimate for blocks of size 2^( 3) =       0.000422931102
  error estimate for blocks of size 2^( 4) =       0.000435783779
  error estimate for blocks of size 2^( 5) =       0.000446364522
  error estimate for blocks of size 2^( 6) =       0.000454294054
  error estimate for blocks of size 2^( 7) =       0.000458074239

      target function =                  N/A
              le_mean =     -16.903882934046
             les_mean =     286.065717412960
             stat err =       0.000448629148
             autocorr =       1.292619030433
              std dev =       0.558042418624
             le_variance =       0.311411340984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311487214088
                                         uncertainty =       0.001843923674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311487214088
                                         uncertainty =       0.001843923674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394613018
  error estimate for blocks of size 2^( 2) =       0.000408564367
  error estimate for blocks of size 2^( 3) =       0.000422948073
  error estimate for blocks of size 2^( 4) =       0.000435801582
  error estimate for blocks of size 2^( 5) =       0.000446379975
  error estimate for blocks of size 2^( 6) =       0.000454308066
  error estimate for blocks of size 2^( 7) =       0.000458097908

      target function =                  N/A
              le_mean =     -16.903881876641
             les_mean =     286.064939242664
             stat err =       0.000448646883
             autocorr =       1.292606970086
              std dev =       0.558067081581
             le_variance =       0.311438867545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311543409469
                                         uncertainty =       0.001840510495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311543409469
                                         uncertainty =       0.001840510495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394648531
  error estimate for blocks of size 2^( 2) =       0.000408598904
  error estimate for blocks of size 2^( 3) =       0.000422982296
  error estimate for blocks of size 2^( 4) =       0.000435835655
  error estimate for blocks of size 2^( 5) =       0.000446411428
  error estimate for blocks of size 2^( 6) =       0.000454335657
  error estimate for blocks of size 2^( 7) =       0.000458136544

      target function =                  N/A
              le_mean =     -16.903881382515
             les_mean =     286.064895960658
             stat err =       0.000448679821
             autocorr =       1.292564114120
              std dev =       0.558117305475
             le_variance =       0.311494926671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903881424513        initial
     9.3132e-01     9.3132e+00             3.6153e-04       -16.903882934046  <--
     3.7253e+00     3.7253e+01             1.0514e-04       -16.903881876641
     1.4901e+01     1.4901e+02             2.7392e-05       -16.903881382515

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.3850e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.003751e-01 3 1  ON 0
ci_0002                 7.000985e-01 3 1  ON 1
ci_0003                -3.132263e-02 3 1  ON 2
ci_0004                -3.058977e-02 3 1  ON 3
ci_0005                -3.424358e-02 3 1  ON 4
ci_0006                -3.412947e-02 3 1  ON 5
ci_0007                -2.340649e-02 3 1  ON 6
ci_0008                -2.345224e-02 3 1  ON 7
ci_0009                -2.024828e-02 3 1  ON 8
ci_0010                -1.996635e-02 3 1  ON 9
ci_0011                -1.472532e-02 3 1  ON 10
ci_0012                -1.493015e-02 3 1  ON 11
ci_0013                 1.589545e-02 3 1  ON 12
ci_0014                 1.577936e-02 3 1  ON 13
ci_0015                 1.591285e-02 3 1  ON 14
ci_0016                 1.538095e-02 3 1  ON 15
ci_0017                 1.327524e-02 3 1  ON 16
ci_0018                 1.380092e-02 3 1  ON 17
ci_0019                 1.199945e-02 3 1  ON 18
ci_0020                 1.204953e-02 3 1  ON 19
ci_0021                 7.883483e-03 3 1  ON 20
ci_0022                 7.074505e-03 3 1  ON 21
ci_0023                -1.130340e-02 3 1  ON 22
ci_0024                -1.154020e-02 3 1  ON 23
ci_0025                -1.139317e-02 3 1  ON 24
ci_0026                -1.132746e-02 3 1  ON 25
ci_0027                -1.168690e-02 3 1  ON 26
ci_0028                -1.132036e-02 3 1  ON 27
ci_0029                -1.092099e-02 3 1  ON 28
ci_0030                -1.071244e-02 3 1  ON 29
ci_0031                 1.912817e-02 3 1  ON 30
ci_0032                 1.908793e-02 3 1  ON 31
ci_0033                 1.042011e-02 3 1  ON 32
ci_0034                 1.000662e-02 3 1  ON 33
ci_0035                 6.703124e-03 3 1  ON 34
ci_0036                 6.413319e-03 3 1  ON 35
ci_0037                -1.102656e-02 3 1  ON 36
ci_0038                -1.141236e-02 3 1  ON 37
ci_0039                -4.439511e-03 3 1  ON 38
ci_0040                -4.244180e-03 3 1  ON 39
ci_0041                 8.203110e-03 3 1  ON 40
ci_0042                 8.864885e-03 3 1  ON 41
ci_0043                -1.382278e-02 3 1  ON 42
ci_0044                -1.348709e-02 3 1  ON 43
ci_0045                 8.424100e-03 3 1  ON 44
ci_0046                 9.187481e-03 3 1  ON 45
ci_0047                -3.409340e-03 3 1  ON 46
ci_0048                -3.465848e-03 3 1  ON 47
ci_0049                -6.487833e-03 3 1  ON 48
ci_0050                -6.325001e-03 3 1  ON 49
ci_0051                -4.853554e-03 3 1  ON 50
ci_0052                -4.505289e-03 3 1  ON 51
ci_0053                -6.151484e-03 3 1  ON 52
ci_0054                -6.026094e-03 3 1  ON 53
ci_0055                 7.119320e-03 3 1  ON 54
ci_0056                 7.075145e-03 3 1  ON 55
ci_0057                 5.642748e-03 3 1  ON 56
ci_0058                 5.516235e-03 3 1  ON 57
ci_0059                -5.868676e-03 3 1  ON 58
ci_0060                -6.108079e-03 3 1  ON 59
ci_0061                -4.340360e-03 3 1  ON 60
ci_0062                -4.128452e-03 3 1  ON 61
ci_0063                -8.836154e-03 3 1  ON 62
ci_0064                -8.887015e-03 3 1  ON 63
ci_0065                -6.864751e-03 3 1  ON 64
ci_0066                -6.889489e-03 3 1  ON 65
ci_0067                -6.407486e-03 3 1  ON 66
ci_0068                -6.290893e-03 3 1  ON 67
ci_0069                 5.477174e-03 3 1  ON 68
ci_0070                 5.283156e-03 3 1  ON 69
ci_0071                 4.077980e-03 3 1  ON 70
ci_0072                 4.432212e-03 3 1  ON 71
ci_0073                 5.336859e-03 3 1  ON 72
ci_0074                 5.194404e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8991
    reference variance = 0.561083
====================================================
  Execution time = 1.4615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2704e-01
  Total weights = 1.951684567e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312820718239
                                         uncertainty =       0.002345172380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312820718239
                                         uncertainty =       0.002345172380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395462359
  error estimate for blocks of size 2^( 2) =       0.000409384315
  error estimate for blocks of size 2^( 3) =       0.000423127867
  error estimate for blocks of size 2^( 4) =       0.000435560173
  error estimate for blocks of size 2^( 5) =       0.000444766724
  error estimate for blocks of size 2^( 6) =       0.000451454334
  error estimate for blocks of size 2^( 7) =       0.000455607618

      target function =                  N/A
              le_mean =     -16.904600583798
             les_mean =     286.092557217646
             stat err =       0.000446847212
             autocorr =       1.276755682792
              std dev =       0.559268232114
             le_variance =       0.312780955452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690460058380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904600583789       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614628947       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904616309906       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904616293338       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e-01 is 1.213019e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904600583789       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904605969269       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904606443979       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904606412279       residual = 3.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 4.639582e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904600583789       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904602137483       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904602253278       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904602255424       residual = 2.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.338503e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7176e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.003625e-01 3 1  ON 0
ci_0002                 7.001110e-01 3 1  ON 1
ci_0003                -3.122477e-02 3 1  ON 2
ci_0004                -3.042121e-02 3 1  ON 3
ci_0005                -3.424384e-02 3 1  ON 4
ci_0006                -3.397594e-02 3 1  ON 5
ci_0007                -2.322836e-02 3 1  ON 6
ci_0008                -2.369231e-02 3 1  ON 7
ci_0009                -2.037919e-02 3 1  ON 8
ci_0010                -1.995462e-02 3 1  ON 9
ci_0011                -1.457587e-02 3 1  ON 10
ci_0012                -1.499511e-02 3 1  ON 11
ci_0013                 1.576347e-02 3 1  ON 12
ci_0014                 1.564458e-02 3 1  ON 13
ci_0015                 1.602847e-02 3 1  ON 14
ci_0016                 1.550319e-02 3 1  ON 15
ci_0017                 1.343115e-02 3 1  ON 16
ci_0018                 1.369508e-02 3 1  ON 17
ci_0019                 1.188554e-02 3 1  ON 18
ci_0020                 1.197659e-02 3 1  ON 19
ci_0021                 7.593859e-03 3 1  ON 20
ci_0022                 7.144194e-03 3 1  ON 21
ci_0023                -1.141346e-02 3 1  ON 22
ci_0024                -1.153663e-02 3 1  ON 23
ci_0025                -1.181955e-02 3 1  ON 24
ci_0026                -1.141642e-02 3 1  ON 25
ci_0027                -1.175283e-02 3 1  ON 26
ci_0028                -1.129079e-02 3 1  ON 27
ci_0029                -1.117396e-02 3 1  ON 28
ci_0030                -1.070048e-02 3 1  ON 29
ci_0031                 1.902079e-02 3 1  ON 30
ci_0032                 1.904253e-02 3 1  ON 31
ci_0033                 1.069444e-02 3 1  ON 32
ci_0034                 9.952256e-03 3 1  ON 33
ci_0035                 7.167082e-03 3 1  ON 34
ci_0036                 6.369216e-03 3 1  ON 35
ci_0037                -1.108986e-02 3 1  ON 36
ci_0038                -1.125170e-02 3 1  ON 37
ci_0039                -4.476790e-03 3 1  ON 38
ci_0040                -4.389025e-03 3 1  ON 39
ci_0041                 7.973260e-03 3 1  ON 40
ci_0042                 8.754264e-03 3 1  ON 41
ci_0043                -1.376669e-02 3 1  ON 42
ci_0044                -1.347399e-02 3 1  ON 43
ci_0045                 8.404417e-03 3 1  ON 44
ci_0046                 9.116137e-03 3 1  ON 45
ci_0047                -3.243081e-03 3 1  ON 46
ci_0048                -3.423215e-03 3 1  ON 47
ci_0049                -6.621224e-03 3 1  ON 48
ci_0050                -6.472901e-03 3 1  ON 49
ci_0051                -4.870668e-03 3 1  ON 50
ci_0052                -4.534048e-03 3 1  ON 51
ci_0053                -6.183806e-03 3 1  ON 52
ci_0054                -6.230421e-03 3 1  ON 53
ci_0055                 7.078660e-03 3 1  ON 54
ci_0056                 7.264064e-03 3 1  ON 55
ci_0057                 5.558992e-03 3 1  ON 56
ci_0058                 5.694217e-03 3 1  ON 57
ci_0059                -5.905045e-03 3 1  ON 58
ci_0060                -6.068566e-03 3 1  ON 59
ci_0061                -4.373251e-03 3 1  ON 60
ci_0062                -3.994279e-03 3 1  ON 61
ci_0063                -8.938371e-03 3 1  ON 62
ci_0064                -8.824610e-03 3 1  ON 63
ci_0065                -6.756493e-03 3 1  ON 64
ci_0066                -6.969185e-03 3 1  ON 65
ci_0067                -6.504999e-03 3 1  ON 66
ci_0068                -6.273880e-03 3 1  ON 67
ci_0069                 5.699930e-03 3 1  ON 68
ci_0070                 5.387109e-03 3 1  ON 69
ci_0071                 4.236026e-03 3 1  ON 70
ci_0072                 4.463168e-03 3 1  ON 71
ci_0073                 5.286099e-03 3 1  ON 72
ci_0074                 5.331795e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.858
    reference variance = 0.201335
====================================================
  Execution time = 1.4443e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3914e-01
  Total weights = 1.9516e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320904949299
                                         uncertainty =       0.003690343842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320904949299
                                         uncertainty =       0.003690343842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400508652
  error estimate for blocks of size 2^( 2) =       0.000415119670
  error estimate for blocks of size 2^( 3) =       0.000429803022
  error estimate for blocks of size 2^( 4) =       0.000443469508
  error estimate for blocks of size 2^( 5) =       0.000455475313
  error estimate for blocks of size 2^( 6) =       0.000466272217
  error estimate for blocks of size 2^( 7) =       0.000473509511

      target function =                  N/A
              le_mean =     -16.903888507858
             les_mean =     286.085660583672
             stat err =       0.000459681637
             autocorr =       1.317317632129
              std dev =       0.566404768089
             le_variance =       0.320814361314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321916469851
                                         uncertainty =       0.003697913837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321916469851
                                         uncertainty =       0.003697913837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401139338
  error estimate for blocks of size 2^( 2) =       0.000415739107
  error estimate for blocks of size 2^( 3) =       0.000430409524
  error estimate for blocks of size 2^( 4) =       0.000444061989
  error estimate for blocks of size 2^( 5) =       0.000456071005
  error estimate for blocks of size 2^( 6) =       0.000466845094
  error estimate for blocks of size 2^( 7) =       0.000474096516

      target function =                  N/A
              le_mean =     -16.903893075742
             les_mean =     286.083509523869
             stat err =       0.000460268651
             autocorr =       1.316534625217
              std dev =       0.567296691965
             le_variance =       0.321825536714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321644538822
                                         uncertainty =       0.003670980599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321644538822
                                         uncertainty =       0.003670980599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400969842
  error estimate for blocks of size 2^( 2) =       0.000415573250
  error estimate for blocks of size 2^( 3) =       0.000430244936
  error estimate for blocks of size 2^( 4) =       0.000443901488
  error estimate for blocks of size 2^( 5) =       0.000455910018
  error estimate for blocks of size 2^( 6) =       0.000466693781
  error estimate for blocks of size 2^( 7) =       0.000473942705

      target function =                  N/A
              le_mean =     -16.903885748351
             les_mean =     286.141431463416
             stat err =       0.000460111998
             autocorr =       1.316751124578
              std dev =       0.567056988643
             le_variance =       0.321553628368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320990306028
                                         uncertainty =       0.003681258266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320990306028
                                         uncertainty =       0.003681258266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400561905
  error estimate for blocks of size 2^( 2) =       0.000415171632
  error estimate for blocks of size 2^( 3) =       0.000429853018
  error estimate for blocks of size 2^( 4) =       0.000443518370
  error estimate for blocks of size 2^( 5) =       0.000455525034
  error estimate for blocks of size 2^( 6) =       0.000466319605
  error estimate for blocks of size 2^( 7) =       0.000473557202

      target function =                  N/A
              le_mean =     -16.903886991256
             les_mean =     286.080397351944
             stat err =       0.000459730053
             autocorr =       1.317244831202
              std dev =       0.566480077919
             le_variance =       0.320899678679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903888507858        initial
     2.3283e-01     2.3283e+00             1.2130e-03       -16.903893075742  <--
     9.3132e-01     9.3132e+00             4.6396e-04       -16.903885748351
     3.7253e+00     3.7253e+01             1.3385e-04       -16.903886991256

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 2.3973e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.003852e-01 3 1  ON 0
ci_0002                 7.000974e-01 3 1  ON 1
ci_0003                -3.104694e-02 3 1  ON 2
ci_0004                -3.015353e-02 3 1  ON 3
ci_0005                -3.424140e-02 3 1  ON 4
ci_0006                -3.368274e-02 3 1  ON 5
ci_0007                -2.283418e-02 3 1  ON 6
ci_0008                -2.421115e-02 3 1  ON 7
ci_0009                -2.056099e-02 3 1  ON 8
ci_0010                -1.994069e-02 3 1  ON 9
ci_0011                -1.433807e-02 3 1  ON 10
ci_0012                -1.510807e-02 3 1  ON 11
ci_0013                 1.555408e-02 3 1  ON 12
ci_0014                 1.543512e-02 3 1  ON 13
ci_0015                 1.620484e-02 3 1  ON 14
ci_0016                 1.569692e-02 3 1  ON 15
ci_0017                 1.364560e-02 3 1  ON 16
ci_0018                 1.353686e-02 3 1  ON 17
ci_0019                 1.170164e-02 3 1  ON 18
ci_0020                 1.185698e-02 3 1  ON 19
ci_0021                 6.939596e-03 3 1  ON 20
ci_0022                 7.273785e-03 3 1  ON 21
ci_0023                -1.157331e-02 3 1  ON 22
ci_0024                -1.153025e-02 3 1  ON 23
ci_0025                -1.246919e-02 3 1  ON 24
ci_0026                -1.155194e-02 3 1  ON 25
ci_0027                -1.186080e-02 3 1  ON 26
ci_0028                -1.124821e-02 3 1  ON 27
ci_0029                -1.157686e-02 3 1  ON 28
ci_0030                -1.068113e-02 3 1  ON 29
ci_0031                 1.880794e-02 3 1  ON 30
ci_0032                 1.897818e-02 3 1  ON 31
ci_0033                 1.123734e-02 3 1  ON 32
ci_0034                 9.839322e-03 3 1  ON 33
ci_0035                 7.916143e-03 3 1  ON 34
ci_0036                 6.297709e-03 3 1  ON 35
ci_0037                -1.120403e-02 3 1  ON 36
ci_0038                -1.097210e-02 3 1  ON 37
ci_0039                -4.525354e-03 3 1  ON 38
ci_0040                -4.561774e-03 3 1  ON 39
ci_0041                 7.607557e-03 3 1  ON 40
ci_0042                 8.587098e-03 3 1  ON 41
ci_0043                -1.362198e-02 3 1  ON 42
ci_0044                -1.347029e-02 3 1  ON 43
ci_0045                 8.362530e-03 3 1  ON 44
ci_0046                 8.981031e-03 3 1  ON 45
ci_0047                -3.041093e-03 3 1  ON 46
ci_0048                -3.370913e-03 3 1  ON 47
ci_0049                -6.810792e-03 3 1  ON 48
ci_0050                -6.709199e-03 3 1  ON 49
ci_0051                -4.886258e-03 3 1  ON 50
ci_0052                -4.570027e-03 3 1  ON 51
ci_0053                -6.226796e-03 3 1  ON 52
ci_0054                -6.492613e-03 3 1  ON 53
ci_0055                 7.004999e-03 3 1  ON 54
ci_0056                 7.607208e-03 3 1  ON 55
ci_0057                 5.407013e-03 3 1  ON 56
ci_0058                 5.991900e-03 3 1  ON 57
ci_0059                -5.938545e-03 3 1  ON 58
ci_0060                -6.017455e-03 3 1  ON 59
ci_0061                -4.422236e-03 3 1  ON 60
ci_0062                -3.773246e-03 3 1  ON 61
ci_0063                -9.074503e-03 3 1  ON 62
ci_0064                -8.748837e-03 3 1  ON 63
ci_0065                -6.601804e-03 3 1  ON 64
ci_0066                -7.095497e-03 3 1  ON 65
ci_0067                -6.626959e-03 3 1  ON 66
ci_0068                -6.249245e-03 3 1  ON 67
ci_0069                 5.971941e-03 3 1  ON 68
ci_0070                 5.513015e-03 3 1  ON 69
ci_0071                 4.489714e-03 3 1  ON 70
ci_0072                 4.513755e-03 3 1  ON 71
ci_0073                 5.219941e-03 3 1  ON 72
ci_0074                 5.500105e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8879
    reference variance = 0.207869
====================================================
  Execution time = 1.4472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2172e-01
  Total weights = 1.951581767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310845183999
                                         uncertainty =       0.002276193539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310845183999
                                         uncertainty =       0.002276193539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394168735
  error estimate for blocks of size 2^( 2) =       0.000408388338
  error estimate for blocks of size 2^( 3) =       0.000422812374
  error estimate for blocks of size 2^( 4) =       0.000435690038
  error estimate for blocks of size 2^( 5) =       0.000447311854
  error estimate for blocks of size 2^( 6) =       0.000456823420
  error estimate for blocks of size 2^( 7) =       0.000462202283

      target function =                  N/A
              le_mean =     -16.903922770838
             les_mean =     286.064321666139
             stat err =       0.000450506899
             autocorr =       1.306286819337
              std dev =       0.557438771086
             le_variance =       0.310737983510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690392277084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903922770847       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903940355294       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903940961184       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903941198237       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903941332638       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-02 is 1.883495e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903922770847       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903933517629       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903933684834       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903933828685       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e-01 is 1.104782e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903922770847       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903926976376       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903927035678       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903927074759       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 4.154770e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7074e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.004917e-01 3 1  ON 0
ci_0002                 7.000955e-01 3 1  ON 1
ci_0003                -3.092022e-02 3 1  ON 2
ci_0004                -3.071447e-02 3 1  ON 3
ci_0005                -3.397552e-02 3 1  ON 4
ci_0006                -3.366857e-02 3 1  ON 5
ci_0007                -2.302962e-02 3 1  ON 6
ci_0008                -2.347544e-02 3 1  ON 7
ci_0009                -2.030476e-02 3 1  ON 8
ci_0010                -1.983066e-02 3 1  ON 9
ci_0011                -1.495787e-02 3 1  ON 10
ci_0012                -1.501732e-02 3 1  ON 11
ci_0013                 1.543521e-02 3 1  ON 12
ci_0014                 1.541012e-02 3 1  ON 13
ci_0015                 1.612325e-02 3 1  ON 14
ci_0016                 1.541141e-02 3 1  ON 15
ci_0017                 1.363467e-02 3 1  ON 16
ci_0018                 1.324841e-02 3 1  ON 17
ci_0019                 1.163429e-02 3 1  ON 18
ci_0020                 1.202735e-02 3 1  ON 19
ci_0021                 7.020639e-03 3 1  ON 20
ci_0022                 7.139489e-03 3 1  ON 21
ci_0023                -1.168080e-02 3 1  ON 22
ci_0024                -1.132372e-02 3 1  ON 23
ci_0025                -1.209844e-02 3 1  ON 24
ci_0026                -1.135691e-02 3 1  ON 25
ci_0027                -1.140921e-02 3 1  ON 26
ci_0028                -1.102467e-02 3 1  ON 27
ci_0029                -1.054297e-02 3 1  ON 28
ci_0030                -1.042669e-02 3 1  ON 29
ci_0031                 1.857061e-02 3 1  ON 30
ci_0032                 1.908698e-02 3 1  ON 31
ci_0033                 1.135425e-02 3 1  ON 32
ci_0034                 9.842463e-03 3 1  ON 33
ci_0035                 6.974066e-03 3 1  ON 34
ci_0036                 6.289648e-03 3 1  ON 35
ci_0037                -1.118251e-02 3 1  ON 36
ci_0038                -1.091945e-02 3 1  ON 37
ci_0039                -4.445164e-03 3 1  ON 38
ci_0040                -4.376231e-03 3 1  ON 39
ci_0041                 8.021352e-03 3 1  ON 40
ci_0042                 8.369208e-03 3 1  ON 41
ci_0043                -1.339311e-02 3 1  ON 42
ci_0044                -1.355537e-02 3 1  ON 43
ci_0045                 8.143738e-03 3 1  ON 44
ci_0046                 8.878533e-03 3 1  ON 45
ci_0047                -3.338602e-03 3 1  ON 46
ci_0048                -3.147736e-03 3 1  ON 47
ci_0049                -6.867989e-03 3 1  ON 48
ci_0050                -6.644419e-03 3 1  ON 49
ci_0051                -4.750527e-03 3 1  ON 50
ci_0052                -4.400689e-03 3 1  ON 51
ci_0053                -6.268049e-03 3 1  ON 52
ci_0054                -6.602304e-03 3 1  ON 53
ci_0055                 6.784095e-03 3 1  ON 54
ci_0056                 7.485163e-03 3 1  ON 55
ci_0057                 6.159489e-03 3 1  ON 56
ci_0058                 4.887118e-03 3 1  ON 57
ci_0059                -6.323415e-03 3 1  ON 58
ci_0060                -6.333008e-03 3 1  ON 59
ci_0061                -4.499511e-03 3 1  ON 60
ci_0062                -3.739259e-03 3 1  ON 61
ci_0063                -9.015617e-03 3 1  ON 62
ci_0064                -9.004567e-03 3 1  ON 63
ci_0065                -6.565291e-03 3 1  ON 64
ci_0066                -6.845829e-03 3 1  ON 65
ci_0067                -6.068660e-03 3 1  ON 66
ci_0068                -6.153973e-03 3 1  ON 67
ci_0069                 5.685656e-03 3 1  ON 68
ci_0070                 5.501126e-03 3 1  ON 69
ci_0071                 4.499355e-03 3 1  ON 70
ci_0072                 4.409325e-03 3 1  ON 71
ci_0073                 5.188674e-03 3 1  ON 72
ci_0074                 5.586988e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8036
    reference variance = 0.26948
====================================================
  Execution time = 1.4148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2450e-01
  Total weights = 1.9520e+06
  Execution time = 1.9084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312453782063
                                         uncertainty =       0.003226896046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312453782063
                                         uncertainty =       0.003226896046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395249800
  error estimate for blocks of size 2^( 2) =       0.000409703383
  error estimate for blocks of size 2^( 3) =       0.000423753843
  error estimate for blocks of size 2^( 4) =       0.000436152513
  error estimate for blocks of size 2^( 5) =       0.000447021009
  error estimate for blocks of size 2^( 6) =       0.000455279307
  error estimate for blocks of size 2^( 7) =       0.000460414559

      target function =                  N/A
              le_mean =     -16.904502279937
             les_mean =     286.100289721037
             stat err =       0.000449716847
             autocorr =       1.294598195532
              std dev =       0.558967627198
             le_variance =       0.312444808255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311515381750
                                         uncertainty =       0.003184470859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311515381750
                                         uncertainty =       0.003184470859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394656756
  error estimate for blocks of size 2^( 2) =       0.000409167661
  error estimate for blocks of size 2^( 3) =       0.000423251526
  error estimate for blocks of size 2^( 4) =       0.000435655769
  error estimate for blocks of size 2^( 5) =       0.000446582950
  error estimate for blocks of size 2^( 6) =       0.000454815922
  error estimate for blocks of size 2^( 7) =       0.000460014789

      target function =                  N/A
              le_mean =     -16.904491839210
             les_mean =     286.086413336053
             stat err =       0.000449267358
             autocorr =       1.295897486830
              std dev =       0.558128936376
             le_variance =       0.311507909620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311398591409
                                         uncertainty =       0.003177093752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311398591409
                                         uncertainty =       0.003177093752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394582925
  error estimate for blocks of size 2^( 2) =       0.000409108917
  error estimate for blocks of size 2^( 3) =       0.000423206584
  error estimate for blocks of size 2^( 4) =       0.000435613574
  error estimate for blocks of size 2^( 5) =       0.000446550035
  error estimate for blocks of size 2^( 6) =       0.000454781385
  error estimate for blocks of size 2^( 7) =       0.000459993367

      target function =                  N/A
              le_mean =     -16.904500339079
             les_mean =     286.087539318182
             stat err =       0.000449234590
             autocorr =       1.296193391327
              std dev =       0.558024523444
             le_variance =       0.311391368765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312108256720
                                         uncertainty =       0.003209520068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312108256720
                                         uncertainty =       0.003209520068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395031522
  error estimate for blocks of size 2^( 2) =       0.000409500088
  error estimate for blocks of size 2^( 3) =       0.000423561536
  error estimate for blocks of size 2^( 4) =       0.000435966974
  error estimate for blocks of size 2^( 5) =       0.000446858988
  error estimate for blocks of size 2^( 6) =       0.000455090952
  error estimate for blocks of size 2^( 7) =       0.000460239009

      target function =                  N/A
              le_mean =     -16.904491449266
             les_mean =     286.103298239556
             stat err =       0.000449538981
             autocorr =       1.295004295689
              std dev =       0.558658936255
             le_variance =       0.312099807057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904502279937        initial  <--
     5.8208e-02     5.8208e-01             1.8835e-03       -16.904491839210
     2.3283e-01     2.3283e+00             1.1048e-03       -16.904500339079
     9.3132e-01     9.3132e+00             4.1548e-04       -16.904491449266

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7701
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.003852e-01 3 1  ON 0
ci_0002                 7.000974e-01 3 1  ON 1
ci_0003                -3.104694e-02 3 1  ON 2
ci_0004                -3.015353e-02 3 1  ON 3
ci_0005                -3.424140e-02 3 1  ON 4
ci_0006                -3.368274e-02 3 1  ON 5
ci_0007                -2.283418e-02 3 1  ON 6
ci_0008                -2.421115e-02 3 1  ON 7
ci_0009                -2.056099e-02 3 1  ON 8
ci_0010                -1.994069e-02 3 1  ON 9
ci_0011                -1.433807e-02 3 1  ON 10
ci_0012                -1.510807e-02 3 1  ON 11
ci_0013                 1.555408e-02 3 1  ON 12
ci_0014                 1.543512e-02 3 1  ON 13
ci_0015                 1.620484e-02 3 1  ON 14
ci_0016                 1.569692e-02 3 1  ON 15
ci_0017                 1.364560e-02 3 1  ON 16
ci_0018                 1.353686e-02 3 1  ON 17
ci_0019                 1.170164e-02 3 1  ON 18
ci_0020                 1.185698e-02 3 1  ON 19
ci_0021                 6.939596e-03 3 1  ON 20
ci_0022                 7.273785e-03 3 1  ON 21
ci_0023                -1.157331e-02 3 1  ON 22
ci_0024                -1.153025e-02 3 1  ON 23
ci_0025                -1.246919e-02 3 1  ON 24
ci_0026                -1.155194e-02 3 1  ON 25
ci_0027                -1.186080e-02 3 1  ON 26
ci_0028                -1.124821e-02 3 1  ON 27
ci_0029                -1.157686e-02 3 1  ON 28
ci_0030                -1.068113e-02 3 1  ON 29
ci_0031                 1.880794e-02 3 1  ON 30
ci_0032                 1.897818e-02 3 1  ON 31
ci_0033                 1.123734e-02 3 1  ON 32
ci_0034                 9.839322e-03 3 1  ON 33
ci_0035                 7.916143e-03 3 1  ON 34
ci_0036                 6.297709e-03 3 1  ON 35
ci_0037                -1.120403e-02 3 1  ON 36
ci_0038                -1.097210e-02 3 1  ON 37
ci_0039                -4.525354e-03 3 1  ON 38
ci_0040                -4.561774e-03 3 1  ON 39
ci_0041                 7.607557e-03 3 1  ON 40
ci_0042                 8.587098e-03 3 1  ON 41
ci_0043                -1.362198e-02 3 1  ON 42
ci_0044                -1.347029e-02 3 1  ON 43
ci_0045                 8.362530e-03 3 1  ON 44
ci_0046                 8.981031e-03 3 1  ON 45
ci_0047                -3.041093e-03 3 1  ON 46
ci_0048                -3.370913e-03 3 1  ON 47
ci_0049                -6.810792e-03 3 1  ON 48
ci_0050                -6.709199e-03 3 1  ON 49
ci_0051                -4.886258e-03 3 1  ON 50
ci_0052                -4.570027e-03 3 1  ON 51
ci_0053                -6.226796e-03 3 1  ON 52
ci_0054                -6.492613e-03 3 1  ON 53
ci_0055                 7.004999e-03 3 1  ON 54
ci_0056                 7.607208e-03 3 1  ON 55
ci_0057                 5.407013e-03 3 1  ON 56
ci_0058                 5.991900e-03 3 1  ON 57
ci_0059                -5.938545e-03 3 1  ON 58
ci_0060                -6.017455e-03 3 1  ON 59
ci_0061                -4.422236e-03 3 1  ON 60
ci_0062                -3.773246e-03 3 1  ON 61
ci_0063                -9.074503e-03 3 1  ON 62
ci_0064                -8.748837e-03 3 1  ON 63
ci_0065                -6.601804e-03 3 1  ON 64
ci_0066                -7.095497e-03 3 1  ON 65
ci_0067                -6.626959e-03 3 1  ON 66
ci_0068                -6.249245e-03 3 1  ON 67
ci_0069                 5.971941e-03 3 1  ON 68
ci_0070                 5.513015e-03 3 1  ON 69
ci_0071                 4.489714e-03 3 1  ON 70
ci_0072                 4.513755e-03 3 1  ON 71
ci_0073                 5.219941e-03 3 1  ON 72
ci_0074                 5.500105e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9825
    reference variance = 0.546144
====================================================
  Execution time = 1.6648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2364e-01
  Total weights = 1.951669440e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311923195953
                                         uncertainty =       0.002353442766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311923195953
                                         uncertainty =       0.002353442766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394905194
  error estimate for blocks of size 2^( 2) =       0.000408852226
  error estimate for blocks of size 2^( 3) =       0.000423673206
  error estimate for blocks of size 2^( 4) =       0.000436972054
  error estimate for blocks of size 2^( 5) =       0.000447858562
  error estimate for blocks of size 2^( 6) =       0.000456984104
  error estimate for blocks of size 2^( 7) =       0.000461866340

      target function =                  N/A
              le_mean =     -16.904055690153
             les_mean =     286.070736889606
             stat err =       0.000450920265
             autocorr =       1.303808520233
              std dev =       0.558480281114
             le_variance =       0.311900224394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690405569015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904055690128       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904061256701       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904061908194       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904061910121       residual = 3.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-01 is 5.857402e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904055690128       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904057405353       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904057591687       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904057594419       residual = 1.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 1.816614e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904055690128       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904056145399       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904056193935       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904056194207       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 4.830893e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160838 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9282e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.003570e-01 3 1  ON 0
ci_0002                 7.001348e-01 3 1  ON 1
ci_0003                -3.101921e-02 3 1  ON 2
ci_0004                -3.013676e-02 3 1  ON 3
ci_0005                -3.422890e-02 3 1  ON 4
ci_0006                -3.369766e-02 3 1  ON 5
ci_0007                -2.289489e-02 3 1  ON 6
ci_0008                -2.409681e-02 3 1  ON 7
ci_0009                -2.059922e-02 3 1  ON 8
ci_0010                -1.990224e-02 3 1  ON 9
ci_0011                -1.445399e-02 3 1  ON 10
ci_0012                -1.507938e-02 3 1  ON 11
ci_0013                 1.555558e-02 3 1  ON 12
ci_0014                 1.551853e-02 3 1  ON 13
ci_0015                 1.617129e-02 3 1  ON 14
ci_0016                 1.567364e-02 3 1  ON 15
ci_0017                 1.370163e-02 3 1  ON 16
ci_0018                 1.355944e-02 3 1  ON 17
ci_0019                 1.170688e-02 3 1  ON 18
ci_0020                 1.176792e-02 3 1  ON 19
ci_0021                 6.979341e-03 3 1  ON 20
ci_0022                 7.287327e-03 3 1  ON 21
ci_0023                -1.157422e-02 3 1  ON 22
ci_0024                -1.151391e-02 3 1  ON 23
ci_0025                -1.240085e-02 3 1  ON 24
ci_0026                -1.153329e-02 3 1  ON 25
ci_0027                -1.190107e-02 3 1  ON 26
ci_0028                -1.129259e-02 3 1  ON 27
ci_0029                -1.139520e-02 3 1  ON 28
ci_0030                -1.073013e-02 3 1  ON 29
ci_0031                 1.880449e-02 3 1  ON 30
ci_0032                 1.895658e-02 3 1  ON 31
ci_0033                 1.112942e-02 3 1  ON 32
ci_0034                 9.866927e-03 3 1  ON 33
ci_0035                 7.789846e-03 3 1  ON 34
ci_0036                 6.369188e-03 3 1  ON 35
ci_0037                -1.111483e-02 3 1  ON 36
ci_0038                -1.096498e-02 3 1  ON 37
ci_0039                -4.513033e-03 3 1  ON 38
ci_0040                -4.566709e-03 3 1  ON 39
ci_0041                 7.686409e-03 3 1  ON 40
ci_0042                 8.483532e-03 3 1  ON 41
ci_0043                -1.361487e-02 3 1  ON 42
ci_0044                -1.354650e-02 3 1  ON 43
ci_0045                 8.406753e-03 3 1  ON 44
ci_0046                 9.003681e-03 3 1  ON 45
ci_0047                -3.088382e-03 3 1  ON 46
ci_0048                -3.374754e-03 3 1  ON 47
ci_0049                -6.773230e-03 3 1  ON 48
ci_0050                -6.626178e-03 3 1  ON 49
ci_0051                -4.873216e-03 3 1  ON 50
ci_0052                -4.562513e-03 3 1  ON 51
ci_0053                -6.203596e-03 3 1  ON 52
ci_0054                -6.458939e-03 3 1  ON 53
ci_0055                 7.038294e-03 3 1  ON 54
ci_0056                 7.603574e-03 3 1  ON 55
ci_0057                 5.386141e-03 3 1  ON 56
ci_0058                 5.897011e-03 3 1  ON 57
ci_0059                -5.898652e-03 3 1  ON 58
ci_0060                -6.006164e-03 3 1  ON 59
ci_0061                -4.450966e-03 3 1  ON 60
ci_0062                -3.733796e-03 3 1  ON 61
ci_0063                -9.029912e-03 3 1  ON 62
ci_0064                -8.814117e-03 3 1  ON 63
ci_0065                -6.521453e-03 3 1  ON 64
ci_0066                -7.153222e-03 3 1  ON 65
ci_0067                -6.528840e-03 3 1  ON 66
ci_0068                -6.241514e-03 3 1  ON 67
ci_0069                 5.986572e-03 3 1  ON 68
ci_0070                 5.500600e-03 3 1  ON 69
ci_0071                 4.530243e-03 3 1  ON 70
ci_0072                 4.481209e-03 3 1  ON 71
ci_0073                 5.272022e-03 3 1  ON 72
ci_0074                 5.506572e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.252747
====================================================
  Execution time = 1.4102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2671e-01
  Total weights = 1.9512e+06
  Execution time = 1.9089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314086394454
                                         uncertainty =       0.003189655275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314086394454
                                         uncertainty =       0.003189655275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396246949
  error estimate for blocks of size 2^( 2) =       0.000412176493
  error estimate for blocks of size 2^( 3) =       0.000429267429
  error estimate for blocks of size 2^( 4) =       0.000448363900
  error estimate for blocks of size 2^( 5) =       0.000470168787
  error estimate for blocks of size 2^( 6) =       0.000498039913
  error estimate for blocks of size 2^( 7) =       0.000538401646

      target function =                  N/A
              le_mean =     -16.904695479141
             les_mean =     286.095533501515
             stat err =       0.000488743561
             autocorr =       1.521353839744
              std dev =       0.560377809812
             le_variance =       0.314023289730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313862107224
                                         uncertainty =       0.003181295556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313862107224
                                         uncertainty =       0.003181295556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396105481
  error estimate for blocks of size 2^( 2) =       0.000412040469
  error estimate for blocks of size 2^( 3) =       0.000429135290
  error estimate for blocks of size 2^( 4) =       0.000448233447
  error estimate for blocks of size 2^( 5) =       0.000470044508
  error estimate for blocks of size 2^( 6) =       0.000497911285
  error estimate for blocks of size 2^( 7) =       0.000538272719

      target function =                  N/A
              le_mean =     -16.904693515412
             les_mean =     286.098962631008
             stat err =       0.000488615490
             autocorr =       1.521642945975
              std dev =       0.560177743859
             le_variance =       0.313799104715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313928762153
                                         uncertainty =       0.003184205455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313928762153
                                         uncertainty =       0.003184205455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396147535
  error estimate for blocks of size 2^( 2) =       0.000412080999
  error estimate for blocks of size 2^( 3) =       0.000429176045
  error estimate for blocks of size 2^( 4) =       0.000448275507
  error estimate for blocks of size 2^( 5) =       0.000470083799
  error estimate for blocks of size 2^( 6) =       0.000497954454
  error estimate for blocks of size 2^( 7) =       0.000538318233

      target function =                  N/A
              le_mean =     -16.904692047376
             les_mean =     286.095635020089
             stat err =       0.000488657998
             autocorr =       1.521584608977
              std dev =       0.560237217058
             le_variance =       0.313865739377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314063377996
                                         uncertainty =       0.003188894006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314063377996
                                         uncertainty =       0.003188894006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396232435
  error estimate for blocks of size 2^( 2) =       0.000412162452
  error estimate for blocks of size 2^( 3) =       0.000429253953
  error estimate for blocks of size 2^( 4) =       0.000448351247
  error estimate for blocks of size 2^( 5) =       0.000470157113
  error estimate for blocks of size 2^( 6) =       0.000498028222
  error estimate for blocks of size 2^( 7) =       0.000538390335

      target function =                  N/A
              le_mean =     -16.904694695033
             les_mean =     286.097719367333
             stat err =       0.000488731729
             autocorr =       1.521391628487
              std dev =       0.560357284080
             le_variance =       0.314000285822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904695479141        initial  <--
     5.8208e-01     5.8208e+00             5.8574e-04       -16.904693515412
     2.3283e+00     2.3283e+01             1.8166e-04       -16.904692047376
     9.3132e+00     9.3132e+01             4.8309e-05       -16.904694695033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7308
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.003852e-01 3 1  ON 0
ci_0002                 7.000974e-01 3 1  ON 1
ci_0003                -3.104694e-02 3 1  ON 2
ci_0004                -3.015353e-02 3 1  ON 3
ci_0005                -3.424140e-02 3 1  ON 4
ci_0006                -3.368274e-02 3 1  ON 5
ci_0007                -2.283418e-02 3 1  ON 6
ci_0008                -2.421115e-02 3 1  ON 7
ci_0009                -2.056099e-02 3 1  ON 8
ci_0010                -1.994069e-02 3 1  ON 9
ci_0011                -1.433807e-02 3 1  ON 10
ci_0012                -1.510807e-02 3 1  ON 11
ci_0013                 1.555408e-02 3 1  ON 12
ci_0014                 1.543512e-02 3 1  ON 13
ci_0015                 1.620484e-02 3 1  ON 14
ci_0016                 1.569692e-02 3 1  ON 15
ci_0017                 1.364560e-02 3 1  ON 16
ci_0018                 1.353686e-02 3 1  ON 17
ci_0019                 1.170164e-02 3 1  ON 18
ci_0020                 1.185698e-02 3 1  ON 19
ci_0021                 6.939596e-03 3 1  ON 20
ci_0022                 7.273785e-03 3 1  ON 21
ci_0023                -1.157331e-02 3 1  ON 22
ci_0024                -1.153025e-02 3 1  ON 23
ci_0025                -1.246919e-02 3 1  ON 24
ci_0026                -1.155194e-02 3 1  ON 25
ci_0027                -1.186080e-02 3 1  ON 26
ci_0028                -1.124821e-02 3 1  ON 27
ci_0029                -1.157686e-02 3 1  ON 28
ci_0030                -1.068113e-02 3 1  ON 29
ci_0031                 1.880794e-02 3 1  ON 30
ci_0032                 1.897818e-02 3 1  ON 31
ci_0033                 1.123734e-02 3 1  ON 32
ci_0034                 9.839322e-03 3 1  ON 33
ci_0035                 7.916143e-03 3 1  ON 34
ci_0036                 6.297709e-03 3 1  ON 35
ci_0037                -1.120403e-02 3 1  ON 36
ci_0038                -1.097210e-02 3 1  ON 37
ci_0039                -4.525354e-03 3 1  ON 38
ci_0040                -4.561774e-03 3 1  ON 39
ci_0041                 7.607557e-03 3 1  ON 40
ci_0042                 8.587098e-03 3 1  ON 41
ci_0043                -1.362198e-02 3 1  ON 42
ci_0044                -1.347029e-02 3 1  ON 43
ci_0045                 8.362530e-03 3 1  ON 44
ci_0046                 8.981031e-03 3 1  ON 45
ci_0047                -3.041093e-03 3 1  ON 46
ci_0048                -3.370913e-03 3 1  ON 47
ci_0049                -6.810792e-03 3 1  ON 48
ci_0050                -6.709199e-03 3 1  ON 49
ci_0051                -4.886258e-03 3 1  ON 50
ci_0052                -4.570027e-03 3 1  ON 51
ci_0053                -6.226796e-03 3 1  ON 52
ci_0054                -6.492613e-03 3 1  ON 53
ci_0055                 7.004999e-03 3 1  ON 54
ci_0056                 7.607208e-03 3 1  ON 55
ci_0057                 5.407013e-03 3 1  ON 56
ci_0058                 5.991900e-03 3 1  ON 57
ci_0059                -5.938545e-03 3 1  ON 58
ci_0060                -6.017455e-03 3 1  ON 59
ci_0061                -4.422236e-03 3 1  ON 60
ci_0062                -3.773246e-03 3 1  ON 61
ci_0063                -9.074503e-03 3 1  ON 62
ci_0064                -8.748837e-03 3 1  ON 63
ci_0065                -6.601804e-03 3 1  ON 64
ci_0066                -7.095497e-03 3 1  ON 65
ci_0067                -6.626959e-03 3 1  ON 66
ci_0068                -6.249245e-03 3 1  ON 67
ci_0069                 5.971941e-03 3 1  ON 68
ci_0070                 5.513015e-03 3 1  ON 69
ci_0071                 4.489714e-03 3 1  ON 70
ci_0072                 4.513755e-03 3 1  ON 71
ci_0073                 5.219941e-03 3 1  ON 72
ci_0074                 5.500105e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8724
    reference variance = 0.329767
====================================================
  Execution time = 1.4653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2598e-01
  Total weights = 1.951988178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313665271261
                                         uncertainty =       0.002305262907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313665271261
                                         uncertainty =       0.002305262907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395995172
  error estimate for blocks of size 2^( 2) =       0.000410058715
  error estimate for blocks of size 2^( 3) =       0.000424816365
  error estimate for blocks of size 2^( 4) =       0.000438238122
  error estimate for blocks of size 2^( 5) =       0.000450253789
  error estimate for blocks of size 2^( 6) =       0.000459965827
  error estimate for blocks of size 2^( 7) =       0.000466674526

      target function =                  N/A
              le_mean =     -16.904192741469
             les_mean =     286.077715362464
             stat err =       0.000453783066
             autocorr =       1.313157406359
              std dev =       0.560021743260
             le_variance =       0.313624352924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690419274147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904192741488       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904193293670       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904193347312       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904193349388       residual = 3.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 7.420873e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904192741488       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904192883268       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904192894563       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904192895659       residual = 4.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 1.905190e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904192741488       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904192777174       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904192779856       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904192780167       residual = 4.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+01 is 4.795263e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7254e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.003885e-01 3 1  ON 0
ci_0002                 7.000950e-01 3 1  ON 1
ci_0003                -3.103799e-02 3 1  ON 2
ci_0004                -3.014489e-02 3 1  ON 3
ci_0005                -3.423253e-02 3 1  ON 4
ci_0006                -3.368971e-02 3 1  ON 5
ci_0007                -2.282810e-02 3 1  ON 6
ci_0008                -2.421028e-02 3 1  ON 7
ci_0009                -2.055463e-02 3 1  ON 8
ci_0010                -1.995154e-02 3 1  ON 9
ci_0011                -1.434766e-02 3 1  ON 10
ci_0012                -1.512421e-02 3 1  ON 11
ci_0013                 1.554907e-02 3 1  ON 12
ci_0014                 1.544650e-02 3 1  ON 13
ci_0015                 1.619541e-02 3 1  ON 14
ci_0016                 1.569868e-02 3 1  ON 15
ci_0017                 1.365422e-02 3 1  ON 16
ci_0018                 1.354167e-02 3 1  ON 17
ci_0019                 1.168259e-02 3 1  ON 18
ci_0020                 1.185609e-02 3 1  ON 19
ci_0021                 6.941835e-03 3 1  ON 20
ci_0022                 7.273604e-03 3 1  ON 21
ci_0023                -1.157713e-02 3 1  ON 22
ci_0024                -1.153886e-02 3 1  ON 23
ci_0025                -1.245873e-02 3 1  ON 24
ci_0026                -1.155132e-02 3 1  ON 25
ci_0027                -1.185605e-02 3 1  ON 26
ci_0028                -1.125396e-02 3 1  ON 27
ci_0029                -1.157087e-02 3 1  ON 28
ci_0030                -1.069666e-02 3 1  ON 29
ci_0031                 1.880805e-02 3 1  ON 30
ci_0032                 1.897276e-02 3 1  ON 31
ci_0033                 1.123861e-02 3 1  ON 32
ci_0034                 9.830000e-03 3 1  ON 33
ci_0035                 7.903167e-03 3 1  ON 34
ci_0036                 6.301889e-03 3 1  ON 35
ci_0037                -1.120583e-02 3 1  ON 36
ci_0038                -1.098529e-02 3 1  ON 37
ci_0039                -4.523819e-03 3 1  ON 38
ci_0040                -4.556962e-03 3 1  ON 39
ci_0041                 7.620440e-03 3 1  ON 40
ci_0042                 8.580993e-03 3 1  ON 41
ci_0043                -1.362132e-02 3 1  ON 42
ci_0044                -1.347201e-02 3 1  ON 43
ci_0045                 8.344638e-03 3 1  ON 44
ci_0046                 8.981581e-03 3 1  ON 45
ci_0047                -3.044081e-03 3 1  ON 46
ci_0048                -3.365278e-03 3 1  ON 47
ci_0049                -6.803633e-03 3 1  ON 48
ci_0050                -6.716384e-03 3 1  ON 49
ci_0051                -4.883438e-03 3 1  ON 50
ci_0052                -4.572404e-03 3 1  ON 51
ci_0053                -6.223047e-03 3 1  ON 52
ci_0054                -6.497630e-03 3 1  ON 53
ci_0055                 7.007562e-03 3 1  ON 54
ci_0056                 7.590882e-03 3 1  ON 55
ci_0057                 5.411804e-03 3 1  ON 56
ci_0058                 5.990678e-03 3 1  ON 57
ci_0059                -5.941448e-03 3 1  ON 58
ci_0060                -6.023841e-03 3 1  ON 59
ci_0061                -4.415122e-03 3 1  ON 60
ci_0062                -3.775264e-03 3 1  ON 61
ci_0063                -9.074533e-03 3 1  ON 62
ci_0064                -8.745631e-03 3 1  ON 63
ci_0065                -6.594372e-03 3 1  ON 64
ci_0066                -7.100204e-03 3 1  ON 65
ci_0067                -6.623608e-03 3 1  ON 66
ci_0068                -6.246854e-03 3 1  ON 67
ci_0069                 5.969924e-03 3 1  ON 68
ci_0070                 5.499884e-03 3 1  ON 69
ci_0071                 4.490097e-03 3 1  ON 70
ci_0072                 4.518888e-03 3 1  ON 71
ci_0073                 5.230588e-03 3 1  ON 72
ci_0074                 5.487404e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9642
    reference variance = 0.287095
====================================================
  Execution time = 1.4041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2425e-01
  Total weights = 1.9519e+06
  Execution time = 1.9052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311880994020
                                         uncertainty =       0.003448201035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311880994020
                                         uncertainty =       0.003448201035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394868950
  error estimate for blocks of size 2^( 2) =       0.000408817749
  error estimate for blocks of size 2^( 3) =       0.000422857586
  error estimate for blocks of size 2^( 4) =       0.000435990810
  error estimate for blocks of size 2^( 5) =       0.000446619447
  error estimate for blocks of size 2^( 6) =       0.000454090249
  error estimate for blocks of size 2^( 7) =       0.000457472092

      target function =                  N/A
              le_mean =     -16.903674204980
             les_mean =     286.058487399607
             stat err =       0.000448543149
             autocorr =       1.290335025586
              std dev =       0.558429024470
             le_variance =       0.311842975371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311853889499
                                         uncertainty =       0.003447223090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311853889499
                                         uncertainty =       0.003447223090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394851744
  error estimate for blocks of size 2^( 2) =       0.000408801103
  error estimate for blocks of size 2^( 3) =       0.000422841541
  error estimate for blocks of size 2^( 4) =       0.000435974268
  error estimate for blocks of size 2^( 5) =       0.000446604083
  error estimate for blocks of size 2^( 6) =       0.000454074491
  error estimate for blocks of size 2^( 7) =       0.000457456666

      target function =                  N/A
              le_mean =     -16.903675231187
             les_mean =     286.058483428669
             stat err =       0.000448527377
             autocorr =       1.290356728886
              std dev =       0.558404692004
             le_variance =       0.311815800052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311866769918
                                         uncertainty =       0.003447691742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311866769918
                                         uncertainty =       0.003447691742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394859922
  error estimate for blocks of size 2^( 2) =       0.000408809009
  error estimate for blocks of size 2^( 3) =       0.000422849159
  error estimate for blocks of size 2^( 4) =       0.000435982136
  error estimate for blocks of size 2^( 5) =       0.000446611386
  error estimate for blocks of size 2^( 6) =       0.000454081972
  error estimate for blocks of size 2^( 7) =       0.000457463985

      target function =                  N/A
              le_mean =     -16.903674705589
             les_mean =     286.058458867228
             stat err =       0.000448534870
             autocorr =       1.290346394522
              std dev =       0.558416256403
             le_variance =       0.311828715415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311879173309
                                         uncertainty =       0.003448136469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311879173309
                                         uncertainty =       0.003448136469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394867794
  error estimate for blocks of size 2^( 2) =       0.000408816630
  error estimate for blocks of size 2^( 3) =       0.000422856506
  error estimate for blocks of size 2^( 4) =       0.000435989701
  error estimate for blocks of size 2^( 5) =       0.000446618418
  error estimate for blocks of size 2^( 6) =       0.000454089191
  error estimate for blocks of size 2^( 7) =       0.000457471056

      target function =                  N/A
              le_mean =     -16.903674264878
             les_mean =     286.058478557676
             stat err =       0.000448542092
             autocorr =       1.290336492415
              std dev =       0.558427390236
             le_variance =       0.311841150165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903674204980        initial
     5.8208e+00     5.8208e+01             7.4209e-05       -16.903675231187  <--
     2.3283e+01     2.3283e+02             1.9052e-05       -16.903674705589
     9.3132e+01     9.3132e+02             4.7953e-06       -16.903674264878

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.3640e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.003982e-01 3 1  ON 0
ci_0002                 7.000881e-01 3 1  ON 1
ci_0003                -3.101211e-02 3 1  ON 2
ci_0004                -3.011959e-02 3 1  ON 3
ci_0005                -3.420640e-02 3 1  ON 4
ci_0006                -3.371014e-02 3 1  ON 5
ci_0007                -2.281006e-02 3 1  ON 6
ci_0008                -2.420771e-02 3 1  ON 7
ci_0009                -2.053638e-02 3 1  ON 8
ci_0010                -1.998267e-02 3 1  ON 9
ci_0011                -1.437566e-02 3 1  ON 10
ci_0012                -1.517084e-02 3 1  ON 11
ci_0013                 1.553463e-02 3 1  ON 12
ci_0014                 1.547927e-02 3 1  ON 13
ci_0015                 1.616824e-02 3 1  ON 14
ci_0016                 1.570368e-02 3 1  ON 15
ci_0017                 1.367911e-02 3 1  ON 16
ci_0018                 1.355547e-02 3 1  ON 17
ci_0019                 1.162743e-02 3 1  ON 18
ci_0020                 1.185341e-02 3 1  ON 19
ci_0021                 6.948421e-03 3 1  ON 20
ci_0022                 7.273204e-03 3 1  ON 21
ci_0023                -1.158819e-02 3 1  ON 22
ci_0024                -1.156353e-02 3 1  ON 23
ci_0025                -1.242848e-02 3 1  ON 24
ci_0026                -1.154949e-02 3 1  ON 25
ci_0027                -1.184248e-02 3 1  ON 26
ci_0028                -1.127054e-02 3 1  ON 27
ci_0029                -1.155353e-02 3 1  ON 28
ci_0030                -1.074154e-02 3 1  ON 29
ci_0031                 1.880836e-02 3 1  ON 30
ci_0032                 1.895679e-02 3 1  ON 31
ci_0033                 1.124234e-02 3 1  ON 32
ci_0034                 9.802587e-03 3 1  ON 33
ci_0035                 7.865579e-03 3 1  ON 34
ci_0036                 6.313963e-03 3 1  ON 35
ci_0037                -1.121105e-02 3 1  ON 36
ci_0038                -1.102385e-02 3 1  ON 37
ci_0039                -4.519491e-03 3 1  ON 38
ci_0040                -4.543406e-03 3 1  ON 39
ci_0041                 7.657775e-03 3 1  ON 40
ci_0042                 8.563233e-03 3 1  ON 41
ci_0043                -1.361958e-02 3 1  ON 42
ci_0044                -1.347705e-02 3 1  ON 43
ci_0045                 8.292297e-03 3 1  ON 44
ci_0046                 8.983127e-03 3 1  ON 45
ci_0047                -3.052547e-03 3 1  ON 46
ci_0048                -3.349327e-03 3 1  ON 47
ci_0049                -6.782991e-03 3 1  ON 48
ci_0050                -6.737149e-03 3 1  ON 49
ci_0051                -4.875435e-03 3 1  ON 50
ci_0052                -4.579199e-03 3 1  ON 51
ci_0053                -6.212424e-03 3 1  ON 52
ci_0054                -6.512002e-03 3 1  ON 53
ci_0055                 7.014997e-03 3 1  ON 54
ci_0056                 7.543205e-03 3 1  ON 55
ci_0057                 5.425775e-03 3 1  ON 56
ci_0058                 5.987114e-03 3 1  ON 57
ci_0059                -5.949742e-03 3 1  ON 58
ci_0060                -6.042001e-03 3 1  ON 59
ci_0061                -4.394476e-03 3 1  ON 60
ci_0062                -3.781180e-03 3 1  ON 61
ci_0063                -9.074669e-03 3 1  ON 62
ci_0064                -8.736501e-03 3 1  ON 63
ci_0065                -6.572915e-03 3 1  ON 64
ci_0066                -7.113736e-03 3 1  ON 65
ci_0067                -6.614183e-03 3 1  ON 66
ci_0068                -6.240069e-03 3 1  ON 67
ci_0069                 5.964202e-03 3 1  ON 68
ci_0070                 5.462571e-03 3 1  ON 69
ci_0071                 4.491097e-03 3 1  ON 70
ci_0072                 4.533712e-03 3 1  ON 71
ci_0073                 5.260750e-03 3 1  ON 72
ci_0074                 5.451401e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8918
    reference variance = 0.175355
====================================================
  Execution time = 1.4371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3490e-01
  Total weights = 1.951796305e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319144716307
                                         uncertainty =       0.003230598388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319144716307
                                         uncertainty =       0.003230598388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399491634
  error estimate for blocks of size 2^( 2) =       0.000413672387
  error estimate for blocks of size 2^( 3) =       0.000428002207
  error estimate for blocks of size 2^( 4) =       0.000440917547
  error estimate for blocks of size 2^( 5) =       0.000451903371
  error estimate for blocks of size 2^( 6) =       0.000460116917
  error estimate for blocks of size 2^( 7) =       0.000465033466

      target function =                  N/A
              le_mean =     -16.904023770706
             les_mean =     286.080923188668
             stat err =       0.000454492825
             autocorr =       1.294311130593
              std dev =       0.564966486465
             le_variance =       0.319187130828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690402377071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904023770703       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904027492706       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904027413482       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904027439183       residual = 2.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+00 is 2.975338e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904023770703       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904024805963       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904024791040       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904024799564       residual = 2.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 7.863806e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904023770703       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904024037014       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904024033807       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904024036171       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 1.994457e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6969e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.003991e-01 3 1  ON 0
ci_0002                 7.000899e-01 3 1  ON 1
ci_0003                -3.102243e-02 3 1  ON 2
ci_0004                -3.017535e-02 3 1  ON 3
ci_0005                -3.418101e-02 3 1  ON 4
ci_0006                -3.370349e-02 3 1  ON 5
ci_0007                -2.279666e-02 3 1  ON 6
ci_0008                -2.418016e-02 3 1  ON 7
ci_0009                -2.051018e-02 3 1  ON 8
ci_0010                -1.998643e-02 3 1  ON 9
ci_0011                -1.437411e-02 3 1  ON 10
ci_0012                -1.519850e-02 3 1  ON 11
ci_0013                 1.553093e-02 3 1  ON 12
ci_0014                 1.547614e-02 3 1  ON 13
ci_0015                 1.615765e-02 3 1  ON 14
ci_0016                 1.567762e-02 3 1  ON 15
ci_0017                 1.368199e-02 3 1  ON 16
ci_0018                 1.362551e-02 3 1  ON 17
ci_0019                 1.165284e-02 3 1  ON 18
ci_0020                 1.188411e-02 3 1  ON 19
ci_0021                 6.952045e-03 3 1  ON 20
ci_0022                 7.280303e-03 3 1  ON 21
ci_0023                -1.158930e-02 3 1  ON 22
ci_0024                -1.155093e-02 3 1  ON 23
ci_0025                -1.238659e-02 3 1  ON 24
ci_0026                -1.158402e-02 3 1  ON 25
ci_0027                -1.181901e-02 3 1  ON 26
ci_0028                -1.123591e-02 3 1  ON 27
ci_0029                -1.152011e-02 3 1  ON 28
ci_0030                -1.076086e-02 3 1  ON 29
ci_0031                 1.881358e-02 3 1  ON 30
ci_0032                 1.896045e-02 3 1  ON 31
ci_0033                 1.116370e-02 3 1  ON 32
ci_0034                 9.822912e-03 3 1  ON 33
ci_0035                 7.835279e-03 3 1  ON 34
ci_0036                 6.297674e-03 3 1  ON 35
ci_0037                -1.120297e-02 3 1  ON 36
ci_0038                -1.104750e-02 3 1  ON 37
ci_0039                -4.520820e-03 3 1  ON 38
ci_0040                -4.558580e-03 3 1  ON 39
ci_0041                 7.681975e-03 3 1  ON 40
ci_0042                 8.549646e-03 3 1  ON 41
ci_0043                -1.362268e-02 3 1  ON 42
ci_0044                -1.347263e-02 3 1  ON 43
ci_0045                 8.282851e-03 3 1  ON 44
ci_0046                 8.945543e-03 3 1  ON 45
ci_0047                -3.114248e-03 3 1  ON 46
ci_0048                -3.343726e-03 3 1  ON 47
ci_0049                -6.757252e-03 3 1  ON 48
ci_0050                -6.744574e-03 3 1  ON 49
ci_0051                -4.853927e-03 3 1  ON 50
ci_0052                -4.600365e-03 3 1  ON 51
ci_0053                -6.195546e-03 3 1  ON 52
ci_0054                -6.487134e-03 3 1  ON 53
ci_0055                 7.024412e-03 3 1  ON 54
ci_0056                 7.514896e-03 3 1  ON 55
ci_0057                 5.469890e-03 3 1  ON 56
ci_0058                 5.952595e-03 3 1  ON 57
ci_0059                -5.930422e-03 3 1  ON 58
ci_0060                -6.035053e-03 3 1  ON 59
ci_0061                -4.381461e-03 3 1  ON 60
ci_0062                -3.737472e-03 3 1  ON 61
ci_0063                -9.101933e-03 3 1  ON 62
ci_0064                -8.707459e-03 3 1  ON 63
ci_0065                -6.570937e-03 3 1  ON 64
ci_0066                -7.110017e-03 3 1  ON 65
ci_0067                -6.584991e-03 3 1  ON 66
ci_0068                -6.255438e-03 3 1  ON 67
ci_0069                 5.923624e-03 3 1  ON 68
ci_0070                 5.468801e-03 3 1  ON 69
ci_0071                 4.504180e-03 3 1  ON 70
ci_0072                 4.554406e-03 3 1  ON 71
ci_0073                 5.314642e-03 3 1  ON 72
ci_0074                 5.433949e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9499
    reference variance = 0.148295
====================================================
  Execution time = 1.4188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2818e-01
  Total weights = 1.9519e+06
  Execution time = 1.9079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316115095391
                                         uncertainty =       0.002655798618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316115095391
                                         uncertainty =       0.002655798618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397538836
  error estimate for blocks of size 2^( 2) =       0.000411236413
  error estimate for blocks of size 2^( 3) =       0.000425130207
  error estimate for blocks of size 2^( 4) =       0.000437875036
  error estimate for blocks of size 2^( 5) =       0.000448816728
  error estimate for blocks of size 2^( 6) =       0.000456284287
  error estimate for blocks of size 2^( 7) =       0.000462885262

      target function =                  N/A
              le_mean =     -16.904228556293
             les_mean =     286.082438239776
             stat err =       0.000451465328
             autocorr =       1.289702917729
              std dev =       0.562204813159
             le_variance =       0.316074251940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316033764983
                                         uncertainty =       0.002651795417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316033764983
                                         uncertainty =       0.002651795417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397487828
  error estimate for blocks of size 2^( 2) =       0.000411184162
  error estimate for blocks of size 2^( 3) =       0.000425073754
  error estimate for blocks of size 2^( 4) =       0.000437813307
  error estimate for blocks of size 2^( 5) =       0.000448754501
  error estimate for blocks of size 2^( 6) =       0.000456213675
  error estimate for blocks of size 2^( 7) =       0.000462807394

      target function =                  N/A
              le_mean =     -16.904231143455
             les_mean =     286.084929155537
             stat err =       0.000451397219
             autocorr =       1.289644740449
              std dev =       0.562132676575
             le_variance =       0.315993146073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316065445713
                                         uncertainty =       0.002653396694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316065445713
                                         uncertainty =       0.002653396694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397507698
  error estimate for blocks of size 2^( 2) =       0.000411204373
  error estimate for blocks of size 2^( 3) =       0.000425095914
  error estimate for blocks of size 2^( 4) =       0.000437837839
  error estimate for blocks of size 2^( 5) =       0.000448779455
  error estimate for blocks of size 2^( 6) =       0.000456243268
  error estimate for blocks of size 2^( 7) =       0.000462839534

      target function =                  N/A
              le_mean =     -16.904229941670
             les_mean =     286.081175385954
             stat err =       0.000451425024
             autocorr =       1.289674676986
              std dev =       0.562160777608
             le_variance =       0.316024739880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316108196995
                                         uncertainty =       0.002655465819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316108196995
                                         uncertainty =       0.002655465819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397534509
  error estimate for blocks of size 2^( 2) =       0.000411231926
  error estimate for blocks of size 2^( 3) =       0.000425125497
  error estimate for blocks of size 2^( 4) =       0.000437869992
  error estimate for blocks of size 2^( 5) =       0.000448811732
  error estimate for blocks of size 2^( 6) =       0.000456278812
  error estimate for blocks of size 2^( 7) =       0.000462879032

      target function =                  N/A
              le_mean =     -16.904228702010
             les_mean =     286.081163102660
             stat err =       0.000451459892
             autocorr =       1.289699932228
              std dev =       0.562198694583
             le_variance =       0.316067372191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904228556293        initial
     1.4552e+00     1.4552e+01             2.9753e-04       -16.904231143455  <--
     5.8208e+00     5.8208e+01             7.8638e-05       -16.904229941670
     2.3283e+01     2.3283e+02             1.9945e-05       -16.904228702010

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 2.3863e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.003992e-01 3 1  ON 0
ci_0002                 7.000976e-01 3 1  ON 1
ci_0003                -3.104967e-02 3 1  ON 2
ci_0004                -3.032389e-02 3 1  ON 3
ci_0005                -3.410991e-02 3 1  ON 4
ci_0006                -3.368477e-02 3 1  ON 5
ci_0007                -2.275890e-02 3 1  ON 6
ci_0008                -2.410220e-02 3 1  ON 7
ci_0009                -2.044347e-02 3 1  ON 8
ci_0010                -1.999599e-02 3 1  ON 9
ci_0011                -1.437016e-02 3 1  ON 10
ci_0012                -1.526979e-02 3 1  ON 11
ci_0013                 1.552232e-02 3 1  ON 12
ci_0014                 1.546807e-02 3 1  ON 13
ci_0015                 1.613099e-02 3 1  ON 14
ci_0016                 1.560849e-02 3 1  ON 15
ci_0017                 1.368980e-02 3 1  ON 16
ci_0018                 1.380570e-02 3 1  ON 17
ci_0019                 1.171989e-02 3 1  ON 18
ci_0020                 1.196373e-02 3 1  ON 19
ci_0021                 6.962235e-03 3 1  ON 20
ci_0022                 7.301494e-03 3 1  ON 21
ci_0023                -1.159275e-02 3 1  ON 22
ci_0024                -1.151692e-02 3 1  ON 23
ci_0025                -1.227746e-02 3 1  ON 24
ci_0026                -1.167342e-02 3 1  ON 25
ci_0027                -1.175818e-02 3 1  ON 26
ci_0028                -1.114572e-02 3 1  ON 27
ci_0029                -1.143209e-02 3 1  ON 28
ci_0030                -1.081108e-02 3 1  ON 29
ci_0031                 1.882811e-02 3 1  ON 30
ci_0032                 1.897033e-02 3 1  ON 31
ci_0033                 1.094480e-02 3 1  ON 32
ci_0034                 9.880015e-03 3 1  ON 33
ci_0035                 7.756050e-03 3 1  ON 34
ci_0036                 6.254840e-03 3 1  ON 35
ci_0037                -1.117987e-02 3 1  ON 36
ci_0038                -1.111150e-02 3 1  ON 37
ci_0039                -4.523422e-03 3 1  ON 38
ci_0040                -4.594710e-03 3 1  ON 39
ci_0041                 7.745966e-03 3 1  ON 40
ci_0042                 8.513699e-03 3 1  ON 41
ci_0043                -1.363135e-02 3 1  ON 42
ci_0044                -1.346033e-02 3 1  ON 43
ci_0045                 8.257191e-03 3 1  ON 44
ci_0046                 8.842692e-03 3 1  ON 45
ci_0047                -3.262463e-03 3 1  ON 46
ci_0048                -3.330103e-03 3 1  ON 47
ci_0049                -6.690837e-03 3 1  ON 48
ci_0050                -6.763710e-03 3 1  ON 49
ci_0051                -4.800815e-03 3 1  ON 50
ci_0052                -4.651523e-03 3 1  ON 51
ci_0053                -6.154815e-03 3 1  ON 52
ci_0054                -6.426027e-03 3 1  ON 53
ci_0055                 7.050754e-03 3 1  ON 54
ci_0056                 7.437909e-03 3 1  ON 55
ci_0057                 5.587746e-03 3 1  ON 56
ci_0058                 5.861099e-03 3 1  ON 57
ci_0059                -5.883775e-03 3 1  ON 58
ci_0060                -6.017465e-03 3 1  ON 59
ci_0061                -4.346884e-03 3 1  ON 60
ci_0062                -3.622995e-03 3 1  ON 61
ci_0063                -9.169956e-03 3 1  ON 62
ci_0064                -8.633616e-03 3 1  ON 63
ci_0065                -6.565809e-03 3 1  ON 64
ci_0066                -7.099660e-03 3 1  ON 65
ci_0067                -6.514771e-03 3 1  ON 66
ci_0068                -6.292978e-03 3 1  ON 67
ci_0069                 5.824558e-03 3 1  ON 68
ci_0070                 5.484486e-03 3 1  ON 69
ci_0071                 4.536610e-03 3 1  ON 70
ci_0072                 4.608278e-03 3 1  ON 71
ci_0073                 5.445092e-03 3 1  ON 72
ci_0074                 5.391633e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.199637
====================================================
  Execution time = 1.4459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2692e-01
  Total weights = 1.951756659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314370853660
                                         uncertainty =       0.002273205508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314370853660
                                         uncertainty =       0.002273205508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396437775
  error estimate for blocks of size 2^( 2) =       0.000410649487
  error estimate for blocks of size 2^( 3) =       0.000424596528
  error estimate for blocks of size 2^( 4) =       0.000437486576
  error estimate for blocks of size 2^( 5) =       0.000449601786
  error estimate for blocks of size 2^( 6) =       0.000457599370
  error estimate for blocks of size 2^( 7) =       0.000461484502

      target function =                  N/A
              le_mean =     -16.904929823228
             les_mean =     286.103568029966
             stat err =       0.000451543058
             autocorr =       1.297323484501
              std dev =       0.560647678403
             le_variance =       0.314325819299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690492982323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904929823271       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904937631890       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904937429279       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904937617428       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e-01 is 5.556593e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904929823271       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904932518099       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904932505850       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+00 is 1.805578e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904929823271       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904930567789       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904930574011       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 4.868997e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7064e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.004039e-01 3 1  ON 0
ci_0002                 7.000925e-01 3 1  ON 1
ci_0003                -3.109626e-02 3 1  ON 2
ci_0004                -3.039078e-02 3 1  ON 3
ci_0005                -3.406584e-02 3 1  ON 4
ci_0006                -3.382260e-02 3 1  ON 5
ci_0007                -2.281898e-02 3 1  ON 6
ci_0008                -2.399634e-02 3 1  ON 7
ci_0009                -2.045408e-02 3 1  ON 8
ci_0010                -1.997909e-02 3 1  ON 9
ci_0011                -1.443465e-02 3 1  ON 10
ci_0012                -1.515654e-02 3 1  ON 11
ci_0013                 1.547858e-02 3 1  ON 12
ci_0014                 1.557243e-02 3 1  ON 13
ci_0015                 1.614621e-02 3 1  ON 14
ci_0016                 1.568445e-02 3 1  ON 15
ci_0017                 1.375178e-02 3 1  ON 16
ci_0018                 1.378383e-02 3 1  ON 17
ci_0019                 1.169685e-02 3 1  ON 18
ci_0020                 1.188766e-02 3 1  ON 19
ci_0021                 6.880962e-03 3 1  ON 20
ci_0022                 7.312251e-03 3 1  ON 21
ci_0023                -1.157430e-02 3 1  ON 22
ci_0024                -1.146287e-02 3 1  ON 23
ci_0025                -1.217903e-02 3 1  ON 24
ci_0026                -1.159823e-02 3 1  ON 25
ci_0027                -1.177859e-02 3 1  ON 26
ci_0028                -1.115198e-02 3 1  ON 27
ci_0029                -1.136159e-02 3 1  ON 28
ci_0030                -1.078428e-02 3 1  ON 29
ci_0031                 1.877400e-02 3 1  ON 30
ci_0032                 1.896668e-02 3 1  ON 31
ci_0033                 1.084782e-02 3 1  ON 32
ci_0034                 1.003420e-02 3 1  ON 33
ci_0035                 7.638512e-03 3 1  ON 34
ci_0036                 6.332146e-03 3 1  ON 35
ci_0037                -1.113117e-02 3 1  ON 36
ci_0038                -1.129206e-02 3 1  ON 37
ci_0039                -4.438403e-03 3 1  ON 38
ci_0040                -4.508321e-03 3 1  ON 39
ci_0041                 7.799579e-03 3 1  ON 40
ci_0042                 8.494709e-03 3 1  ON 41
ci_0043                -1.363013e-02 3 1  ON 42
ci_0044                -1.354919e-02 3 1  ON 43
ci_0045                 8.212933e-03 3 1  ON 44
ci_0046                 8.755727e-03 3 1  ON 45
ci_0047                -3.241224e-03 3 1  ON 46
ci_0048                -3.353466e-03 3 1  ON 47
ci_0049                -6.821210e-03 3 1  ON 48
ci_0050                -6.670101e-03 3 1  ON 49
ci_0051                -4.796864e-03 3 1  ON 50
ci_0052                -4.715200e-03 3 1  ON 51
ci_0053                -6.170986e-03 3 1  ON 52
ci_0054                -6.447384e-03 3 1  ON 53
ci_0055                 7.093508e-03 3 1  ON 54
ci_0056                 7.436501e-03 3 1  ON 55
ci_0057                 5.497543e-03 3 1  ON 56
ci_0058                 5.891871e-03 3 1  ON 57
ci_0059                -5.821904e-03 3 1  ON 58
ci_0060                -5.942914e-03 3 1  ON 59
ci_0061                -4.451735e-03 3 1  ON 60
ci_0062                -3.547219e-03 3 1  ON 61
ci_0063                -9.232860e-03 3 1  ON 62
ci_0064                -8.511476e-03 3 1  ON 63
ci_0065                -6.520991e-03 3 1  ON 64
ci_0066                -7.077913e-03 3 1  ON 65
ci_0067                -6.454734e-03 3 1  ON 66
ci_0068                -6.307123e-03 3 1  ON 67
ci_0069                 5.696960e-03 3 1  ON 68
ci_0070                 5.535075e-03 3 1  ON 69
ci_0071                 4.544021e-03 3 1  ON 70
ci_0072                 4.672562e-03 3 1  ON 71
ci_0073                 5.481335e-03 3 1  ON 72
ci_0074                 5.279463e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9699
    reference variance = 0.287426
====================================================
  Execution time = 1.4148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1970e-01
  Total weights = 1.9515e+06
  Execution time = 1.8996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309168668333
                                         uncertainty =       0.002093879501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309168668333
                                         uncertainty =       0.002093879501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393187236
  error estimate for blocks of size 2^( 2) =       0.000407296045
  error estimate for blocks of size 2^( 3) =       0.000422227521
  error estimate for blocks of size 2^( 4) =       0.000435790475
  error estimate for blocks of size 2^( 5) =       0.000447158692
  error estimate for blocks of size 2^( 6) =       0.000455526737
  error estimate for blocks of size 2^( 7) =       0.000461176244

      target function =                  N/A
              le_mean =     -16.904132549534
             les_mean =     286.073754152095
             stat err =       0.000449913037
             autocorr =       1.309357778214
              std dev =       0.556050722296
             le_variance =       0.309192405766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308927029515
                                         uncertainty =       0.002084042064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308927029515
                                         uncertainty =       0.002084042064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393032098
  error estimate for blocks of size 2^( 2) =       0.000407151741
  error estimate for blocks of size 2^( 3) =       0.000422084228
  error estimate for blocks of size 2^( 4) =       0.000435657965
  error estimate for blocks of size 2^( 5) =       0.000447014205
  error estimate for blocks of size 2^( 6) =       0.000455369946
  error estimate for blocks of size 2^( 7) =       0.000460985927

      target function =                  N/A
              le_mean =     -16.904127490805
             les_mean =     286.071514270125
             stat err =       0.000449757011
             autocorr =       1.309482940429
              std dev =       0.555831323442
             le_variance =       0.308948460120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308981019761
                                         uncertainty =       0.002086714101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308981019761
                                         uncertainty =       0.002086714101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393066988
  error estimate for blocks of size 2^( 2) =       0.000407184006
  error estimate for blocks of size 2^( 3) =       0.000422115875
  error estimate for blocks of size 2^( 4) =       0.000435688574
  error estimate for blocks of size 2^( 5) =       0.000447050863
  error estimate for blocks of size 2^( 6) =       0.000455412095
  error estimate for blocks of size 2^( 7) =       0.000461038445

      target function =                  N/A
              le_mean =     -16.904127625195
             les_mean =     286.069401360478
             stat err =       0.000449797494
             autocorr =       1.309486186917
              std dev =       0.555880665666
             le_variance =       0.309003314461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309142542718
                                         uncertainty =       0.002092602274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309142542718
                                         uncertainty =       0.002092602274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393170501
  error estimate for blocks of size 2^( 2) =       0.000407281287
  error estimate for blocks of size 2^( 3) =       0.000422212463
  error estimate for blocks of size 2^( 4) =       0.000435781286
  error estimate for blocks of size 2^( 5) =       0.000447147458
  error estimate for blocks of size 2^( 6) =       0.000455523454
  error estimate for blocks of size 2^( 7) =       0.000461175814

      target function =                  N/A
              le_mean =     -16.904133156690
             les_mean =     286.094662369366
             stat err =       0.000449907003
             autocorr =       1.309434122468
              std dev =       0.556027055154
             le_variance =       0.309166086063


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904132549534        initial
     3.6380e-01     3.6380e+00             5.5566e-04       -16.904127490805
     1.4552e+00     1.4552e+01             1.8056e-04       -16.904127625195
     5.8208e+00     5.8208e+01             4.8690e-05       -16.904133156690  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.3751e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.004010e-01 3 1  ON 0
ci_0002                 7.000958e-01 3 1  ON 1
ci_0003                -3.106244e-02 3 1  ON 2
ci_0004                -3.034203e-02 3 1  ON 3
ci_0005                -3.409843e-02 3 1  ON 4
ci_0006                -3.372114e-02 3 1  ON 5
ci_0007                -2.277490e-02 3 1  ON 6
ci_0008                -2.407459e-02 3 1  ON 7
ci_0009                -2.044635e-02 3 1  ON 8
ci_0010                -1.999123e-02 3 1  ON 9
ci_0011                -1.438792e-02 3 1  ON 10
ci_0012                -1.523861e-02 3 1  ON 11
ci_0013                 1.551027e-02 3 1  ON 12
ci_0014                 1.549665e-02 3 1  ON 13
ci_0015                 1.613522e-02 3 1  ON 14
ci_0016                 1.562935e-02 3 1  ON 15
ci_0017                 1.370708e-02 3 1  ON 16
ci_0018                 1.379946e-02 3 1  ON 17
ci_0019                 1.171372e-02 3 1  ON 18
ci_0020                 1.194285e-02 3 1  ON 19
ci_0021                 6.940911e-03 3 1  ON 20
ci_0022                 7.304059e-03 3 1  ON 21
ci_0023                -1.158761e-02 3 1  ON 22
ci_0024                -1.150184e-02 3 1  ON 23
ci_0025                -1.225032e-02 3 1  ON 24
ci_0026                -1.165272e-02 3 1  ON 25
ci_0027                -1.176379e-02 3 1  ON 26
ci_0028                -1.114754e-02 3 1  ON 27
ci_0029                -1.141276e-02 3 1  ON 28
ci_0030                -1.080375e-02 3 1  ON 29
ci_0031                 1.881376e-02 3 1  ON 30
ci_0032                 1.896945e-02 3 1  ON 31
ci_0033                 1.091917e-02 3 1  ON 32
ci_0034                 9.920801e-03 3 1  ON 33
ci_0035                 7.723884e-03 3 1  ON 34
ci_0036                 6.276010e-03 3 1  ON 35
ci_0037                -1.116681e-02 3 1  ON 36
ci_0038                -1.116019e-02 3 1  ON 37
ci_0039                -4.498140e-03 3 1  ON 38
ci_0040                -4.569152e-03 3 1  ON 39
ci_0041                 7.760858e-03 3 1  ON 40
ci_0042                 8.508437e-03 3 1  ON 41
ci_0043                -1.363104e-02 3 1  ON 42
ci_0044                -1.348353e-02 3 1  ON 43
ci_0045                 8.245358e-03 3 1  ON 44
ci_0046                 8.819330e-03 3 1  ON 45
ci_0047                -3.256164e-03 3 1  ON 46
ci_0048                -3.336988e-03 3 1  ON 47
ci_0049                -6.726758e-03 3 1  ON 48
ci_0050                -6.737941e-03 3 1  ON 49
ci_0051                -4.799534e-03 3 1  ON 50
ci_0052                -4.670132e-03 3 1  ON 51
ci_0053                -6.159544e-03 3 1  ON 52
ci_0054                -6.432282e-03 3 1  ON 53
ci_0055                 7.061991e-03 3 1  ON 54
ci_0056                 7.437550e-03 3 1  ON 55
ci_0057                 5.562971e-03 3 1  ON 56
ci_0058                 5.869492e-03 3 1  ON 57
ci_0059                -5.865907e-03 3 1  ON 58
ci_0060                -5.995895e-03 3 1  ON 59
ci_0061                -4.375527e-03 3 1  ON 60
ci_0062                -3.602353e-03 3 1  ON 61
ci_0063                -9.187939e-03 3 1  ON 62
ci_0064                -8.598989e-03 3 1  ON 63
ci_0065                -6.553291e-03 3 1  ON 64
ci_0066                -7.093611e-03 3 1  ON 65
ci_0067                -6.497335e-03 3 1  ON 66
ci_0068                -6.297042e-03 3 1  ON 67
ci_0069                 5.787208e-03 3 1  ON 68
ci_0070                 5.499256e-03 3 1  ON 69
ci_0071                 4.538566e-03 3 1  ON 70
ci_0072                 4.625786e-03 3 1  ON 71
ci_0073                 5.455765e-03 3 1  ON 72
ci_0074                 5.358844e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9671
    reference variance = 0.152794
====================================================
  Execution time = 1.4374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2297e-01
  Total weights = 1.951786665e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312686533895
                                         uncertainty =       0.002364515564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312686533895
                                         uncertainty =       0.002364515564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395415639
  error estimate for blocks of size 2^( 2) =       0.000409507148
  error estimate for blocks of size 2^( 3) =       0.000423133345
  error estimate for blocks of size 2^( 4) =       0.000436020477
  error estimate for blocks of size 2^( 5) =       0.000448197090
  error estimate for blocks of size 2^( 6) =       0.000457230668
  error estimate for blocks of size 2^( 7) =       0.000461214759

      target function =                  N/A
              le_mean =     -16.904423837456
             les_mean =     286.082512956570
             stat err =       0.000450665749
             autocorr =       1.298976873715
              std dev =       0.559202160123
             le_variance =       0.312707055886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690442383746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904423837503       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904426383425       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904426310744       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904426326631       residual = 1.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+00 is 1.868786e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904423837503       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904424552146       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904424525893       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 5.073836e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904423837503       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904424021823       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904424014731       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 1.299857e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6992e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.004042e-01 3 1  ON 0
ci_0002                 7.000944e-01 3 1  ON 1
ci_0003                -3.102980e-02 3 1  ON 2
ci_0004                -3.035161e-02 3 1  ON 3
ci_0005                -3.410326e-02 3 1  ON 4
ci_0006                -3.371278e-02 3 1  ON 5
ci_0007                -2.279228e-02 3 1  ON 6
ci_0008                -2.406983e-02 3 1  ON 7
ci_0009                -2.043920e-02 3 1  ON 8
ci_0010                -2.000892e-02 3 1  ON 9
ci_0011                -1.443378e-02 3 1  ON 10
ci_0012                -1.524686e-02 3 1  ON 11
ci_0013                 1.549544e-02 3 1  ON 12
ci_0014                 1.550865e-02 3 1  ON 13
ci_0015                 1.612564e-02 3 1  ON 14
ci_0016                 1.561733e-02 3 1  ON 15
ci_0017                 1.371529e-02 3 1  ON 16
ci_0018                 1.380682e-02 3 1  ON 17
ci_0019                 1.171736e-02 3 1  ON 18
ci_0020                 1.193608e-02 3 1  ON 19
ci_0021                 6.925696e-03 3 1  ON 20
ci_0022                 7.307775e-03 3 1  ON 21
ci_0023                -1.158886e-02 3 1  ON 22
ci_0024                -1.150093e-02 3 1  ON 23
ci_0025                -1.221459e-02 3 1  ON 24
ci_0026                -1.166533e-02 3 1  ON 25
ci_0027                -1.174300e-02 3 1  ON 26
ci_0028                -1.113025e-02 3 1  ON 27
ci_0029                -1.140223e-02 3 1  ON 28
ci_0030                -1.081297e-02 3 1  ON 29
ci_0031                 1.880518e-02 3 1  ON 30
ci_0032                 1.898507e-02 3 1  ON 31
ci_0033                 1.092706e-02 3 1  ON 32
ci_0034                 9.921904e-03 3 1  ON 33
ci_0035                 7.673145e-03 3 1  ON 34
ci_0036                 6.303559e-03 3 1  ON 35
ci_0037                -1.116582e-02 3 1  ON 36
ci_0038                -1.116790e-02 3 1  ON 37
ci_0039                -4.494085e-03 3 1  ON 38
ci_0040                -4.528995e-03 3 1  ON 39
ci_0041                 7.768612e-03 3 1  ON 40
ci_0042                 8.540823e-03 3 1  ON 41
ci_0043                -1.363032e-02 3 1  ON 42
ci_0044                -1.350058e-02 3 1  ON 43
ci_0045                 8.267527e-03 3 1  ON 44
ci_0046                 8.818902e-03 3 1  ON 45
ci_0047                -3.272707e-03 3 1  ON 46
ci_0048                -3.365606e-03 3 1  ON 47
ci_0049                -6.683536e-03 3 1  ON 48
ci_0050                -6.713893e-03 3 1  ON 49
ci_0051                -4.824228e-03 3 1  ON 50
ci_0052                -4.659051e-03 3 1  ON 51
ci_0053                -6.188927e-03 3 1  ON 52
ci_0054                -6.427303e-03 3 1  ON 53
ci_0055                 7.069758e-03 3 1  ON 54
ci_0056                 7.420325e-03 3 1  ON 55
ci_0057                 5.522704e-03 3 1  ON 56
ci_0058                 5.858601e-03 3 1  ON 57
ci_0059                -5.880482e-03 3 1  ON 58
ci_0060                -6.038702e-03 3 1  ON 59
ci_0061                -4.352818e-03 3 1  ON 60
ci_0062                -3.577207e-03 3 1  ON 61
ci_0063                -9.174507e-03 3 1  ON 62
ci_0064                -8.633560e-03 3 1  ON 63
ci_0065                -6.549319e-03 3 1  ON 64
ci_0066                -7.056021e-03 3 1  ON 65
ci_0067                -6.454921e-03 3 1  ON 66
ci_0068                -6.249154e-03 3 1  ON 67
ci_0069                 5.790834e-03 3 1  ON 68
ci_0070                 5.467954e-03 3 1  ON 69
ci_0071                 4.529102e-03 3 1  ON 70
ci_0072                 4.592084e-03 3 1  ON 71
ci_0073                 5.440508e-03 3 1  ON 72
ci_0074                 5.380686e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9001
    reference variance = 0.206588
====================================================
  Execution time = 1.4155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2656e-01
  Total weights = 1.9516e+06
  Execution time = 1.8943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312903314949
                                         uncertainty =       0.002027368316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312903314949
                                         uncertainty =       0.002027368316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395529243
  error estimate for blocks of size 2^( 2) =       0.000409702855
  error estimate for blocks of size 2^( 3) =       0.000424340266
  error estimate for blocks of size 2^( 4) =       0.000438514386
  error estimate for blocks of size 2^( 5) =       0.000451257621
  error estimate for blocks of size 2^( 6) =       0.000461627278
  error estimate for blocks of size 2^( 7) =       0.000470245920

      target function =                  N/A
              le_mean =     -16.904733008492
             les_mean =     286.096574996856
             stat err =       0.000455411301
             autocorr =       1.325715737444
              std dev =       0.559362819421
             le_variance =       0.312886763750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312814164566
                                         uncertainty =       0.002030447043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312814164566
                                         uncertainty =       0.002030447043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395473082
  error estimate for blocks of size 2^( 2) =       0.000409642119
  error estimate for blocks of size 2^( 3) =       0.000424282116
  error estimate for blocks of size 2^( 4) =       0.000438455739
  error estimate for blocks of size 2^( 5) =       0.000451202410
  error estimate for blocks of size 2^( 6) =       0.000461572333
  error estimate for blocks of size 2^( 7) =       0.000470178129

      target function =                  N/A
              le_mean =     -16.904734513342
             les_mean =     286.097067617320
             stat err =       0.000455352153
             autocorr =       1.325747848500
              std dev =       0.559283396556
             le_variance =       0.312797917663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312849748576
                                         uncertainty =       0.002028745417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312849748576
                                         uncertainty =       0.002028745417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395495494
  error estimate for blocks of size 2^( 2) =       0.000409666572
  error estimate for blocks of size 2^( 3) =       0.000424305695
  error estimate for blocks of size 2^( 4) =       0.000438479566
  error estimate for blocks of size 2^( 5) =       0.000451223600
  error estimate for blocks of size 2^( 6) =       0.000461593217
  error estimate for blocks of size 2^( 7) =       0.000470204959

      target function =                  N/A
              le_mean =     -16.904733927694
             les_mean =     286.103388727349
             stat err =       0.000455375335
             autocorr =       1.325732576201
              std dev =       0.559315091941
             le_variance =       0.312833372073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312896026186
                                         uncertainty =       0.002027522099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312896026186
                                         uncertainty =       0.002027522099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395524650
  error estimate for blocks of size 2^( 2) =       0.000409697937
  error estimate for blocks of size 2^( 3) =       0.000424335582
  error estimate for blocks of size 2^( 4) =       0.000438509703
  error estimate for blocks of size 2^( 5) =       0.000451253206
  error estimate for blocks of size 2^( 6) =       0.000461622914
  error estimate for blocks of size 2^( 7) =       0.000470240607

      target function =                  N/A
              le_mean =     -16.904733075932
             les_mean =     286.096569598775
             stat err =       0.000455406607
             autocorr =       1.325719195444
              std dev =       0.559356324590
             le_variance =       0.312879497859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904733008492        initial
     1.4552e+00     1.4552e+01             1.8688e-04       -16.904734513342  <--
     5.8208e+00     5.8208e+01             5.0738e-05       -16.904733927694
     2.3283e+01     2.3283e+02             1.2999e-05       -16.904733075932

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 2.3712e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.004125e-01 3 1  ON 0
ci_0002                 7.000907e-01 3 1  ON 1
ci_0003                -3.094283e-02 3 1  ON 2
ci_0004                -3.037688e-02 3 1  ON 3
ci_0005                -3.411678e-02 3 1  ON 4
ci_0006                -3.368934e-02 3 1  ON 5
ci_0007                -2.284117e-02 3 1  ON 6
ci_0008                -2.405710e-02 3 1  ON 7
ci_0009                -2.042100e-02 3 1  ON 8
ci_0010                -2.005447e-02 3 1  ON 9
ci_0011                -1.455335e-02 3 1  ON 10
ci_0012                -1.526753e-02 3 1  ON 11
ci_0013                 1.545751e-02 3 1  ON 12
ci_0014                 1.553999e-02 3 1  ON 13
ci_0015                 1.610124e-02 3 1  ON 14
ci_0016                 1.558663e-02 3 1  ON 15
ci_0017                 1.373580e-02 3 1  ON 16
ci_0018                 1.382586e-02 3 1  ON 17
ci_0019                 1.172656e-02 3 1  ON 18
ci_0020                 1.191928e-02 3 1  ON 19
ci_0021                 6.884363e-03 3 1  ON 20
ci_0022                 7.319354e-03 3 1  ON 21
ci_0023                -1.159225e-02 3 1  ON 22
ci_0024                -1.149998e-02 3 1  ON 23
ci_0025                -1.212279e-02 3 1  ON 24
ci_0026                -1.169978e-02 3 1  ON 25
ci_0027                -1.168879e-02 3 1  ON 26
ci_0028                -1.108538e-02 3 1  ON 27
ci_0029                -1.137463e-02 3 1  ON 28
ci_0030                -1.083620e-02 3 1  ON 29
ci_0031                 1.878154e-02 3 1  ON 30
ci_0032                 1.902912e-02 3 1  ON 31
ci_0033                 1.094890e-02 3 1  ON 32
ci_0034                 9.925149e-03 3 1  ON 33
ci_0035                 7.537005e-03 3 1  ON 34
ci_0036                 6.377038e-03 3 1  ON 35
ci_0037                -1.116304e-02 3 1  ON 36
ci_0038                -1.118763e-02 3 1  ON 37
ci_0039                -4.483781e-03 3 1  ON 38
ci_0040                -4.433970e-03 3 1  ON 39
ci_0041                 7.788612e-03 3 1  ON 40
ci_0042                 8.625390e-03 3 1  ON 41
ci_0043                -1.362770e-02 3 1  ON 42
ci_0044                -1.354871e-02 3 1  ON 43
ci_0045                 8.328178e-03 3 1  ON 44
ci_0046                 8.818057e-03 3 1  ON 45
ci_0047                -3.312303e-03 3 1  ON 46
ci_0048                -3.434034e-03 3 1  ON 47
ci_0049                -6.569207e-03 3 1  ON 48
ci_0050                -6.650744e-03 3 1  ON 49
ci_0051                -4.885618e-03 3 1  ON 50
ci_0052                -4.634339e-03 3 1  ON 51
ci_0053                -6.261279e-03 3 1  ON 52
ci_0054                -6.415700e-03 3 1  ON 53
ci_0055                 7.090803e-03 3 1  ON 54
ci_0056                 7.373499e-03 3 1  ON 55
ci_0057                 5.414116e-03 3 1  ON 56
ci_0058                 5.830010e-03 3 1  ON 57
ci_0059                -5.916852e-03 3 1  ON 58
ci_0060                -6.144663e-03 3 1  ON 59
ci_0061                -4.292299e-03 3 1  ON 60
ci_0062                -3.511234e-03 3 1  ON 61
ci_0063                -9.141712e-03 3 1  ON 62
ci_0064                -8.719367e-03 3 1  ON 63
ci_0065                -6.538714e-03 3 1  ON 64
ci_0066                -6.959128e-03 3 1  ON 65
ci_0067                -6.350870e-03 3 1  ON 66
ci_0068                -6.131860e-03 3 1  ON 67
ci_0069                 5.798726e-03 3 1  ON 68
ci_0070                 5.391737e-03 3 1  ON 69
ci_0071                 4.501576e-03 3 1  ON 70
ci_0072                 4.501544e-03 3 1  ON 71
ci_0073                 5.404029e-03 3 1  ON 72
ci_0074                 5.432872e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9584
    reference variance = 0.222223
====================================================
  Execution time = 1.4399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2440e-01
  Total weights = 1.951992139e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313649972169
                                         uncertainty =       0.002335535591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313649972169
                                         uncertainty =       0.002335535591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396046063
  error estimate for blocks of size 2^( 2) =       0.000410083180
  error estimate for blocks of size 2^( 3) =       0.000424459897
  error estimate for blocks of size 2^( 4) =       0.000437448029
  error estimate for blocks of size 2^( 5) =       0.000448185744
  error estimate for blocks of size 2^( 6) =       0.000456623984
  error estimate for blocks of size 2^( 7) =       0.000460549363

      target function =                  N/A
              le_mean =     -16.903688695178
             les_mean =     286.059092552163
             stat err =       0.000450701780
             autocorr =       1.295051820064
              std dev =       0.560093713116
             le_variance =       0.313704967472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690368869518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903688695173       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903692928404       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903694122831       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903693998602       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e-01 is 1.074266e-03

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903688695173       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903690174181       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903690391632       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903690375800       residual = 2.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+00 is 3.292654e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903688695173       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903689105726       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903689145930       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903689144505       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 8.720446e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7000e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.004487e-01 3 1  ON 0
ci_0002                 7.000801e-01 3 1  ON 1
ci_0003                -3.100007e-02 3 1  ON 2
ci_0004                -3.047697e-02 3 1  ON 3
ci_0005                -3.414291e-02 3 1  ON 4
ci_0006                -3.363555e-02 3 1  ON 5
ci_0007                -2.274480e-02 3 1  ON 6
ci_0008                -2.406433e-02 3 1  ON 7
ci_0009                -2.041475e-02 3 1  ON 8
ci_0010                -1.997612e-02 3 1  ON 9
ci_0011                -1.457986e-02 3 1  ON 10
ci_0012                -1.523626e-02 3 1  ON 11
ci_0013                 1.544646e-02 3 1  ON 12
ci_0014                 1.550861e-02 3 1  ON 13
ci_0015                 1.599176e-02 3 1  ON 14
ci_0016                 1.552432e-02 3 1  ON 15
ci_0017                 1.379456e-02 3 1  ON 16
ci_0018                 1.386757e-02 3 1  ON 17
ci_0019                 1.181696e-02 3 1  ON 18
ci_0020                 1.189053e-02 3 1  ON 19
ci_0021                 6.897583e-03 3 1  ON 20
ci_0022                 7.365217e-03 3 1  ON 21
ci_0023                -1.155325e-02 3 1  ON 22
ci_0024                -1.141218e-02 3 1  ON 23
ci_0025                -1.198482e-02 3 1  ON 24
ci_0026                -1.174738e-02 3 1  ON 25
ci_0027                -1.146648e-02 3 1  ON 26
ci_0028                -1.108363e-02 3 1  ON 27
ci_0029                -1.125681e-02 3 1  ON 28
ci_0030                -1.072834e-02 3 1  ON 29
ci_0031                 1.876215e-02 3 1  ON 30
ci_0032                 1.887754e-02 3 1  ON 31
ci_0033                 1.088883e-02 3 1  ON 32
ci_0034                 1.025441e-02 3 1  ON 33
ci_0035                 7.478541e-03 3 1  ON 34
ci_0036                 6.320994e-03 3 1  ON 35
ci_0037                -1.106314e-02 3 1  ON 36
ci_0038                -1.115190e-02 3 1  ON 37
ci_0039                -4.438122e-03 3 1  ON 38
ci_0040                -4.371788e-03 3 1  ON 39
ci_0041                 7.871688e-03 3 1  ON 40
ci_0042                 8.534407e-03 3 1  ON 41
ci_0043                -1.366240e-02 3 1  ON 42
ci_0044                -1.354026e-02 3 1  ON 43
ci_0045                 8.382355e-03 3 1  ON 44
ci_0046                 8.760830e-03 3 1  ON 45
ci_0047                -3.416753e-03 3 1  ON 46
ci_0048                -3.397695e-03 3 1  ON 47
ci_0049                -6.569436e-03 3 1  ON 48
ci_0050                -6.709133e-03 3 1  ON 49
ci_0051                -4.989356e-03 3 1  ON 50
ci_0052                -4.700790e-03 3 1  ON 51
ci_0053                -6.241599e-03 3 1  ON 52
ci_0054                -6.274960e-03 3 1  ON 53
ci_0055                 7.001080e-03 3 1  ON 54
ci_0056                 7.343931e-03 3 1  ON 55
ci_0057                 5.440831e-03 3 1  ON 56
ci_0058                 5.765694e-03 3 1  ON 57
ci_0059                -5.930817e-03 3 1  ON 58
ci_0060                -6.091730e-03 3 1  ON 59
ci_0061                -4.264988e-03 3 1  ON 60
ci_0062                -3.493065e-03 3 1  ON 61
ci_0063                -9.033295e-03 3 1  ON 62
ci_0064                -8.593995e-03 3 1  ON 63
ci_0065                -6.598598e-03 3 1  ON 64
ci_0066                -6.846583e-03 3 1  ON 65
ci_0067                -6.268088e-03 3 1  ON 66
ci_0068                -6.098107e-03 3 1  ON 67
ci_0069                 5.781676e-03 3 1  ON 68
ci_0070                 5.408705e-03 3 1  ON 69
ci_0071                 4.465336e-03 3 1  ON 70
ci_0072                 4.474692e-03 3 1  ON 71
ci_0073                 5.195204e-03 3 1  ON 72
ci_0074                 5.349463e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.926
    reference variance = 0.367795
====================================================
  Execution time = 1.4092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2134e-01
  Total weights = 1.9515e+06
  Execution time = 1.9061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311710219904
                                         uncertainty =       0.002341715167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311710219904
                                         uncertainty =       0.002341715167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394795835
  error estimate for blocks of size 2^( 2) =       0.000408850251
  error estimate for blocks of size 2^( 3) =       0.000422848365
  error estimate for blocks of size 2^( 4) =       0.000434907841
  error estimate for blocks of size 2^( 5) =       0.000445792262
  error estimate for blocks of size 2^( 6) =       0.000453259042
  error estimate for blocks of size 2^( 7) =       0.000457331916

      target function =                  N/A
              le_mean =     -16.903781775678
             les_mean =     286.059775438963
             stat err =       0.000447822765
             autocorr =       1.286670102141
              std dev =       0.558325624286
             le_variance =       0.311727502734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311498400302
                                         uncertainty =       0.002346534026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311498400302
                                         uncertainty =       0.002346534026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394661401
  error estimate for blocks of size 2^( 2) =       0.000408716303
  error estimate for blocks of size 2^( 3) =       0.000422726818
  error estimate for blocks of size 2^( 4) =       0.000434787995
  error estimate for blocks of size 2^( 5) =       0.000445664814
  error estimate for blocks of size 2^( 6) =       0.000453122590
  error estimate for blocks of size 2^( 7) =       0.000457201441

      target function =                  N/A
              le_mean =     -16.903784022140
             les_mean =     286.059500879407
             stat err =       0.000447694210
             autocorr =       1.286807695160
              std dev =       0.558135505526
             le_variance =       0.311515242529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311548331362
                                         uncertainty =       0.002344943372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311548331362
                                         uncertainty =       0.002344943372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394693130
  error estimate for blocks of size 2^( 2) =       0.000408749010
  error estimate for blocks of size 2^( 3) =       0.000422756322
  error estimate for blocks of size 2^( 4) =       0.000434818144
  error estimate for blocks of size 2^( 5) =       0.000445695991
  error estimate for blocks of size 2^( 6) =       0.000453156395
  error estimate for blocks of size 2^( 7) =       0.000457233426

      target function =                  N/A
              le_mean =     -16.903781046175
             les_mean =     286.059137331978
             stat err =       0.000447725989
             autocorr =       1.286783476197
              std dev =       0.558180376801
             le_variance =       0.311565333046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311683228634
                                         uncertainty =       0.002342132535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311683228634
                                         uncertainty =       0.002342132535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394778720
  error estimate for blocks of size 2^( 2) =       0.000408833341
  error estimate for blocks of size 2^( 3) =       0.000422832679
  error estimate for blocks of size 2^( 4) =       0.000434892701
  error estimate for blocks of size 2^( 5) =       0.000445776324
  error estimate for blocks of size 2^( 6) =       0.000453242440
  error estimate for blocks of size 2^( 7) =       0.000457315675

      target function =                  N/A
              le_mean =     -16.903781008127
             les_mean =     286.059590107594
             stat err =       0.000447806785
             autocorr =       1.286689830302
              std dev =       0.558301420530
             le_variance =       0.311700476166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903781775678        initial
     3.6380e-01     3.6380e+00             1.0743e-03       -16.903784022140  <--
     1.4552e+00     1.4552e+01             3.2927e-04       -16.903781046175
     5.8208e+00     5.8208e+01             8.7204e-05       -16.903781008127

*****************************************************************************
Applying the update for shift_i =   3.6380e-01     and shift_s =   3.6380e+00
*****************************************************************************

  Execution time = 2.3709e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.005452e-01 3 1  ON 0
ci_0002                 7.000290e-01 3 1  ON 1
ci_0003                -3.112619e-02 3 1  ON 2
ci_0004                -3.068357e-02 3 1  ON 3
ci_0005                -3.419716e-02 3 1  ON 4
ci_0006                -3.351540e-02 3 1  ON 5
ci_0007                -2.251445e-02 3 1  ON 6
ci_0008                -2.407906e-02 3 1  ON 7
ci_0009                -2.041295e-02 3 1  ON 8
ci_0010                -1.984134e-02 3 1  ON 9
ci_0011                -1.463337e-02 3 1  ON 10
ci_0012                -1.517898e-02 3 1  ON 11
ci_0013                 1.543661e-02 3 1  ON 12
ci_0014                 1.545227e-02 3 1  ON 13
ci_0015                 1.579024e-02 3 1  ON 14
ci_0016                 1.540441e-02 3 1  ON 15
ci_0017                 1.390304e-02 3 1  ON 16
ci_0018                 1.395034e-02 3 1  ON 17
ci_0019                 1.199250e-02 3 1  ON 18
ci_0020                 1.184074e-02 3 1  ON 19
ci_0021                 6.935678e-03 3 1  ON 20
ci_0022                 7.470391e-03 3 1  ON 21
ci_0023                -1.148532e-02 3 1  ON 22
ci_0024                -1.125274e-02 3 1  ON 23
ci_0025                -1.172550e-02 3 1  ON 24
ci_0026                -1.183283e-02 3 1  ON 25
ci_0027                -1.104871e-02 3 1  ON 26
ci_0028                -1.108755e-02 3 1  ON 27
ci_0029                -1.103324e-02 3 1  ON 28
ci_0030                -1.052892e-02 3 1  ON 29
ci_0031                 1.873124e-02 3 1  ON 30
ci_0032                 1.852994e-02 3 1  ON 31
ci_0033                 1.075131e-02 3 1  ON 32
ci_0034                 1.099941e-02 3 1  ON 33
ci_0035                 7.364593e-03 3 1  ON 34
ci_0036                 6.206800e-03 3 1  ON 35
ci_0037                -1.085464e-02 3 1  ON 36
ci_0038                -1.107968e-02 3 1  ON 37
ci_0039                -4.369065e-03 3 1  ON 38
ci_0040                -4.279138e-03 3 1  ON 39
ci_0041                 8.030469e-03 3 1  ON 40
ci_0042                 8.363057e-03 3 1  ON 41
ci_0043                -1.374413e-02 3 1  ON 42
ci_0044                -1.352850e-02 3 1  ON 43
ci_0045                 8.498473e-03 3 1  ON 44
ci_0046                 8.644083e-03 3 1  ON 45
ci_0047                -3.574944e-03 3 1  ON 46
ci_0048                -3.343417e-03 3 1  ON 47
ci_0049                -6.569532e-03 3 1  ON 48
ci_0050                -6.820051e-03 3 1  ON 49
ci_0051                -5.150195e-03 3 1  ON 50
ci_0052                -4.803309e-03 3 1  ON 51
ci_0053                -6.211590e-03 3 1  ON 52
ci_0054                -6.045446e-03 3 1  ON 53
ci_0055                 6.817755e-03 3 1  ON 54
ci_0056                 7.278324e-03 3 1  ON 55
ci_0057                 5.494385e-03 3 1  ON 56
ci_0058                 5.641172e-03 3 1  ON 57
ci_0059                -5.961042e-03 3 1  ON 58
ci_0060                -6.008289e-03 3 1  ON 59
ci_0061                -4.210212e-03 3 1  ON 60
ci_0062                -3.453252e-03 3 1  ON 61
ci_0063                -8.852239e-03 3 1  ON 62
ci_0064                -8.380068e-03 3 1  ON 63
ci_0065                -6.705151e-03 3 1  ON 64
ci_0066                -6.643976e-03 3 1  ON 65
ci_0067                -6.138288e-03 3 1  ON 66
ci_0068                -6.047130e-03 3 1  ON 67
ci_0069                 5.754727e-03 3 1  ON 68
ci_0070                 5.438156e-03 3 1  ON 69
ci_0071                 4.393123e-03 3 1  ON 70
ci_0072                 4.415526e-03 3 1  ON 71
ci_0073                 4.876358e-03 3 1  ON 72
ci_0074                 5.222703e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.738
    reference variance = 14.5273
====================================================
  Execution time = 1.4531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3137e-01
  Total weights = 1.951812542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312761042224
                                         uncertainty =       0.002814533723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312761042224
                                         uncertainty =       0.002814533723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395616140
  error estimate for blocks of size 2^( 2) =       0.000408900707
  error estimate for blocks of size 2^( 3) =       0.000422921530
  error estimate for blocks of size 2^( 4) =       0.000435416467
  error estimate for blocks of size 2^( 5) =       0.000445410185
  error estimate for blocks of size 2^( 6) =       0.000454161701
  error estimate for blocks of size 2^( 7) =       0.000457464347

      target function =                  N/A
              le_mean =     -16.904827917172
             les_mean =     286.104577194509
             stat err =       0.000448113175
             autocorr =       1.283002265667
              std dev =       0.559485710655
             le_variance =       0.313024260427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690482791717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904827917214       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904845229514       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904845929683       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904845871222       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904845798866       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904845722227       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e-02 is 1.308977e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904827917214       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904837329027       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904837554671       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904837620934       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e-01 is 6.664976e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904827917214       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904831248348       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904831350639       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904831385068       residual = 8.31e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+00 is 2.247590e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7149e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.007150e-01 3 1  ON 0
ci_0002                 6.998718e-01 3 1  ON 1
ci_0003                -3.077100e-02 3 1  ON 2
ci_0004                -3.046080e-02 3 1  ON 3
ci_0005                -3.447011e-02 3 1  ON 4
ci_0006                -3.357151e-02 3 1  ON 5
ci_0007                -2.264249e-02 3 1  ON 6
ci_0008                -2.370224e-02 3 1  ON 7
ci_0009                -2.033150e-02 3 1  ON 8
ci_0010                -1.975812e-02 3 1  ON 9
ci_0011                -1.468983e-02 3 1  ON 10
ci_0012                -1.498071e-02 3 1  ON 11
ci_0013                 1.509842e-02 3 1  ON 12
ci_0014                 1.572263e-02 3 1  ON 13
ci_0015                 1.587849e-02 3 1  ON 14
ci_0016                 1.576074e-02 3 1  ON 15
ci_0017                 1.414972e-02 3 1  ON 16
ci_0018                 1.396880e-02 3 1  ON 17
ci_0019                 1.187113e-02 3 1  ON 18
ci_0020                 1.163010e-02 3 1  ON 19
ci_0021                 6.641524e-03 3 1  ON 20
ci_0022                 7.321697e-03 3 1  ON 21
ci_0023                -1.134939e-02 3 1  ON 22
ci_0024                -1.112339e-02 3 1  ON 23
ci_0025                -1.173682e-02 3 1  ON 24
ci_0026                -1.178419e-02 3 1  ON 25
ci_0027                -1.160090e-02 3 1  ON 26
ci_0028                -1.120902e-02 3 1  ON 27
ci_0029                -1.085694e-02 3 1  ON 28
ci_0030                -1.065148e-02 3 1  ON 29
ci_0031                 1.911010e-02 3 1  ON 30
ci_0032                 1.866212e-02 3 1  ON 31
ci_0033                 1.106450e-02 3 1  ON 32
ci_0034                 1.108549e-02 3 1  ON 33
ci_0035                 6.947308e-03 3 1  ON 34
ci_0036                 6.375108e-03 3 1  ON 35
ci_0037                -1.100385e-02 3 1  ON 36
ci_0038                -1.089283e-02 3 1  ON 37
ci_0039                -4.083263e-03 3 1  ON 38
ci_0040                -4.216857e-03 3 1  ON 39
ci_0041                 8.536357e-03 3 1  ON 40
ci_0042                 8.541369e-03 3 1  ON 41
ci_0043                -1.398559e-02 3 1  ON 42
ci_0044                -1.334627e-02 3 1  ON 43
ci_0045                 8.094813e-03 3 1  ON 44
ci_0046                 8.123012e-03 3 1  ON 45
ci_0047                -3.031008e-03 3 1  ON 46
ci_0048                -3.323385e-03 3 1  ON 47
ci_0049                -6.559802e-03 3 1  ON 48
ci_0050                -6.530084e-03 3 1  ON 49
ci_0051                -4.887117e-03 3 1  ON 50
ci_0052                -4.637655e-03 3 1  ON 51
ci_0053                -6.227636e-03 3 1  ON 52
ci_0054                -6.054059e-03 3 1  ON 53
ci_0055                 6.800297e-03 3 1  ON 54
ci_0056                 7.320833e-03 3 1  ON 55
ci_0057                 4.827887e-03 3 1  ON 56
ci_0058                 6.052906e-03 3 1  ON 57
ci_0059                -6.477003e-03 3 1  ON 58
ci_0060                -6.368944e-03 3 1  ON 59
ci_0061                -4.002547e-03 3 1  ON 60
ci_0062                -3.560832e-03 3 1  ON 61
ci_0063                -8.963235e-03 3 1  ON 62
ci_0064                -8.542013e-03 3 1  ON 63
ci_0065                -6.445291e-03 3 1  ON 64
ci_0066                -6.309354e-03 3 1  ON 65
ci_0067                -6.146256e-03 3 1  ON 66
ci_0068                -6.328398e-03 3 1  ON 67
ci_0069                 5.460707e-03 3 1  ON 68
ci_0070                 5.191455e-03 3 1  ON 69
ci_0071                 4.364764e-03 3 1  ON 70
ci_0072                 4.565679e-03 3 1  ON 71
ci_0073                 5.014608e-03 3 1  ON 72
ci_0074                 5.136876e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.903
    reference variance = 0.240958
====================================================
  Execution time = 1.4007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2816e-01
  Total weights = 1.9514e+06
  Execution time = 1.9104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884673048
                                         uncertainty =       0.002320467085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314884673048
                                         uncertainty =       0.002320467085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396754830
  error estimate for blocks of size 2^( 2) =       0.000411129989
  error estimate for blocks of size 2^( 3) =       0.000425564707
  error estimate for blocks of size 2^( 4) =       0.000438759998
  error estimate for blocks of size 2^( 5) =       0.000450638981
  error estimate for blocks of size 2^( 6) =       0.000457777645
  error estimate for blocks of size 2^( 7) =       0.000462992412

      target function =                  N/A
              le_mean =     -16.904163876989
             les_mean =     286.079574192929
             stat err =       0.000452542259
             autocorr =       1.300989632544
              std dev =       0.561096061712
             le_variance =       0.314828790468

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0136851
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314794249438
                                         uncertainty =       0.002323447978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314794249438
                                         uncertainty =       0.002323447978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396697893
  error estimate for blocks of size 2^( 2) =       0.000411091377
  error estimate for blocks of size 2^( 3) =       0.000425562047
  error estimate for blocks of size 2^( 4) =       0.000438787979
  error estimate for blocks of size 2^( 5) =       0.000450663373
  error estimate for blocks of size 2^( 6) =       0.000457807846
  error estimate for blocks of size 2^( 7) =       0.000463109947

      target function =                  N/A
              le_mean =     -16.904142418551
             les_mean =     286.122307247189
             stat err =       0.000452592286
             autocorr =       1.301650856433
              std dev =       0.561015539877
             le_variance =       0.314738435984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314780492893
                                         uncertainty =       0.002323820040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314780492893
                                         uncertainty =       0.002323820040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396689523
  error estimate for blocks of size 2^( 2) =       0.000411080576
  error estimate for blocks of size 2^( 3) =       0.000425549794
  error estimate for blocks of size 2^( 4) =       0.000438769350
  error estimate for blocks of size 2^( 5) =       0.000450637681
  error estimate for blocks of size 2^( 6) =       0.000457811893
  error estimate for blocks of size 2^( 7) =       0.000463117498

      target function =                  N/A
              le_mean =     -16.904145843931
             les_mean =     286.110216413282
             stat err =       0.000452584105
             autocorr =       1.301658726358
              std dev =       0.561003703468
             le_variance =       0.314725155305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314902963086
                                         uncertainty =       0.002318644933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314902963086
                                         uncertainty =       0.002318644933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396766512
  error estimate for blocks of size 2^( 2) =       0.000411140279
  error estimate for blocks of size 2^( 3) =       0.000425584370
  error estimate for blocks of size 2^( 4) =       0.000438793589
  error estimate for blocks of size 2^( 5) =       0.000450664848
  error estimate for blocks of size 2^( 6) =       0.000457798466
  error estimate for blocks of size 2^( 7) =       0.000463049038

      target function =                  N/A
              le_mean =     -16.904147811957
             les_mean =     286.128174377255
             stat err =       0.000452576486
             autocorr =       1.301109812528
              std dev =       0.561112582309
             le_variance =       0.314847330026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904163876989        initial  <--
     9.0949e-02     9.0949e-01             1.3090e-03       -16.904142418551
     3.6380e-01     3.6380e+00             6.6650e-04       -16.904145843931
     1.4552e+00     1.4552e+01             2.2476e-04       -16.904147811957

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6533
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.005452e-01 3 1  ON 0
ci_0002                 7.000290e-01 3 1  ON 1
ci_0003                -3.112619e-02 3 1  ON 2
ci_0004                -3.068357e-02 3 1  ON 3
ci_0005                -3.419716e-02 3 1  ON 4
ci_0006                -3.351540e-02 3 1  ON 5
ci_0007                -2.251445e-02 3 1  ON 6
ci_0008                -2.407906e-02 3 1  ON 7
ci_0009                -2.041295e-02 3 1  ON 8
ci_0010                -1.984134e-02 3 1  ON 9
ci_0011                -1.463337e-02 3 1  ON 10
ci_0012                -1.517898e-02 3 1  ON 11
ci_0013                 1.543661e-02 3 1  ON 12
ci_0014                 1.545227e-02 3 1  ON 13
ci_0015                 1.579024e-02 3 1  ON 14
ci_0016                 1.540441e-02 3 1  ON 15
ci_0017                 1.390304e-02 3 1  ON 16
ci_0018                 1.395034e-02 3 1  ON 17
ci_0019                 1.199250e-02 3 1  ON 18
ci_0020                 1.184074e-02 3 1  ON 19
ci_0021                 6.935678e-03 3 1  ON 20
ci_0022                 7.470391e-03 3 1  ON 21
ci_0023                -1.148532e-02 3 1  ON 22
ci_0024                -1.125274e-02 3 1  ON 23
ci_0025                -1.172550e-02 3 1  ON 24
ci_0026                -1.183283e-02 3 1  ON 25
ci_0027                -1.104871e-02 3 1  ON 26
ci_0028                -1.108755e-02 3 1  ON 27
ci_0029                -1.103324e-02 3 1  ON 28
ci_0030                -1.052892e-02 3 1  ON 29
ci_0031                 1.873124e-02 3 1  ON 30
ci_0032                 1.852994e-02 3 1  ON 31
ci_0033                 1.075131e-02 3 1  ON 32
ci_0034                 1.099941e-02 3 1  ON 33
ci_0035                 7.364593e-03 3 1  ON 34
ci_0036                 6.206800e-03 3 1  ON 35
ci_0037                -1.085464e-02 3 1  ON 36
ci_0038                -1.107968e-02 3 1  ON 37
ci_0039                -4.369065e-03 3 1  ON 38
ci_0040                -4.279138e-03 3 1  ON 39
ci_0041                 8.030469e-03 3 1  ON 40
ci_0042                 8.363057e-03 3 1  ON 41
ci_0043                -1.374413e-02 3 1  ON 42
ci_0044                -1.352850e-02 3 1  ON 43
ci_0045                 8.498473e-03 3 1  ON 44
ci_0046                 8.644083e-03 3 1  ON 45
ci_0047                -3.574944e-03 3 1  ON 46
ci_0048                -3.343417e-03 3 1  ON 47
ci_0049                -6.569532e-03 3 1  ON 48
ci_0050                -6.820051e-03 3 1  ON 49
ci_0051                -5.150195e-03 3 1  ON 50
ci_0052                -4.803309e-03 3 1  ON 51
ci_0053                -6.211590e-03 3 1  ON 52
ci_0054                -6.045446e-03 3 1  ON 53
ci_0055                 6.817755e-03 3 1  ON 54
ci_0056                 7.278324e-03 3 1  ON 55
ci_0057                 5.494385e-03 3 1  ON 56
ci_0058                 5.641172e-03 3 1  ON 57
ci_0059                -5.961042e-03 3 1  ON 58
ci_0060                -6.008289e-03 3 1  ON 59
ci_0061                -4.210212e-03 3 1  ON 60
ci_0062                -3.453252e-03 3 1  ON 61
ci_0063                -8.852239e-03 3 1  ON 62
ci_0064                -8.380068e-03 3 1  ON 63
ci_0065                -6.705151e-03 3 1  ON 64
ci_0066                -6.643976e-03 3 1  ON 65
ci_0067                -6.138288e-03 3 1  ON 66
ci_0068                -6.047130e-03 3 1  ON 67
ci_0069                 5.754727e-03 3 1  ON 68
ci_0070                 5.438156e-03 3 1  ON 69
ci_0071                 4.393123e-03 3 1  ON 70
ci_0072                 4.415526e-03 3 1  ON 71
ci_0073                 4.876358e-03 3 1  ON 72
ci_0074                 5.222703e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0812e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.235085
====================================================
  Execution time = 1.5918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3393e-01
  Total weights = 1.951614598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319681041461
                                         uncertainty =       0.005500618715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319681041461
                                         uncertainty =       0.005500618715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399797988
  error estimate for blocks of size 2^( 2) =       0.000413929684
  error estimate for blocks of size 2^( 3) =       0.000427126157
  error estimate for blocks of size 2^( 4) =       0.000439917374
  error estimate for blocks of size 2^( 5) =       0.000451120411
  error estimate for blocks of size 2^( 6) =       0.000460321498
  error estimate for blocks of size 2^( 7) =       0.000466285269

      target function =                  N/A
              le_mean =     -16.904224568507
             les_mean =     286.086735032349
             stat err =       0.000454411138
             autocorr =       1.291863796785
              std dev =       0.565399736244
             le_variance =       0.319676861745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690422456851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904224568518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904221570680       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904221786684       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904221785290       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e-01 is 4.121048e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904224568518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904223704658       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904223677824       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904223680598       residual = 1.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+00 is 1.126692e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904224568518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904224343985       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904224329925       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904224330502       residual = 1.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+01 is 2.883856e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8781e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.005577e-01 3 1  ON 0
ci_0002                 7.000162e-01 3 1  ON 1
ci_0003                -3.105849e-02 3 1  ON 2
ci_0004                -3.074338e-02 3 1  ON 3
ci_0005                -3.417822e-02 3 1  ON 4
ci_0006                -3.353090e-02 3 1  ON 5
ci_0007                -2.254091e-02 3 1  ON 6
ci_0008                -2.399401e-02 3 1  ON 7
ci_0009                -2.041944e-02 3 1  ON 8
ci_0010                -1.986912e-02 3 1  ON 9
ci_0011                -1.464926e-02 3 1  ON 10
ci_0012                -1.518675e-02 3 1  ON 11
ci_0013                 1.548801e-02 3 1  ON 12
ci_0014                 1.542764e-02 3 1  ON 13
ci_0015                 1.573187e-02 3 1  ON 14
ci_0016                 1.538414e-02 3 1  ON 15
ci_0017                 1.383631e-02 3 1  ON 16
ci_0018                 1.396852e-02 3 1  ON 17
ci_0019                 1.200177e-02 3 1  ON 18
ci_0020                 1.186847e-02 3 1  ON 19
ci_0021                 6.938678e-03 3 1  ON 20
ci_0022                 7.459850e-03 3 1  ON 21
ci_0023                -1.152150e-02 3 1  ON 22
ci_0024                -1.126770e-02 3 1  ON 23
ci_0025                -1.174331e-02 3 1  ON 24
ci_0026                -1.173216e-02 3 1  ON 25
ci_0027                -1.111646e-02 3 1  ON 26
ci_0028                -1.111881e-02 3 1  ON 27
ci_0029                -1.096260e-02 3 1  ON 28
ci_0030                -1.050996e-02 3 1  ON 29
ci_0031                 1.884391e-02 3 1  ON 30
ci_0032                 1.853915e-02 3 1  ON 31
ci_0033                 1.071131e-02 3 1  ON 32
ci_0034                 1.100929e-02 3 1  ON 33
ci_0035                 7.374660e-03 3 1  ON 34
ci_0036                 6.229565e-03 3 1  ON 35
ci_0037                -1.091652e-02 3 1  ON 36
ci_0038                -1.107796e-02 3 1  ON 37
ci_0039                -4.362829e-03 3 1  ON 38
ci_0040                -4.221996e-03 3 1  ON 39
ci_0041                 8.016316e-03 3 1  ON 40
ci_0042                 8.346901e-03 3 1  ON 41
ci_0043                -1.377578e-02 3 1  ON 42
ci_0044                -1.348946e-02 3 1  ON 43
ci_0045                 8.471249e-03 3 1  ON 44
ci_0046                 8.611159e-03 3 1  ON 45
ci_0047                -3.600261e-03 3 1  ON 46
ci_0048                -3.320371e-03 3 1  ON 47
ci_0049                -6.590404e-03 3 1  ON 48
ci_0050                -6.834251e-03 3 1  ON 49
ci_0051                -5.129546e-03 3 1  ON 50
ci_0052                -4.787869e-03 3 1  ON 51
ci_0053                -6.214345e-03 3 1  ON 52
ci_0054                -5.994371e-03 3 1  ON 53
ci_0055                 6.821511e-03 3 1  ON 54
ci_0056                 7.289894e-03 3 1  ON 55
ci_0057                 5.532533e-03 3 1  ON 56
ci_0058                 5.658013e-03 3 1  ON 57
ci_0059                -5.966039e-03 3 1  ON 58
ci_0060                -5.971239e-03 3 1  ON 59
ci_0061                -4.205993e-03 3 1  ON 60
ci_0062                -3.477056e-03 3 1  ON 61
ci_0063                -8.808651e-03 3 1  ON 62
ci_0064                -8.415781e-03 3 1  ON 63
ci_0065                -6.744352e-03 3 1  ON 64
ci_0066                -6.604854e-03 3 1  ON 65
ci_0067                -6.127345e-03 3 1  ON 66
ci_0068                -6.107188e-03 3 1  ON 67
ci_0069                 5.738322e-03 3 1  ON 68
ci_0070                 5.424004e-03 3 1  ON 69
ci_0071                 4.429804e-03 3 1  ON 70
ci_0072                 4.436329e-03 3 1  ON 71
ci_0073                 4.901095e-03 3 1  ON 72
ci_0074                 5.266820e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9333
    reference variance = 0.372387
====================================================
  Execution time = 1.4032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2085e-01
  Total weights = 1.9517e+06
  Execution time = 1.9000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309277324336
                                         uncertainty =       0.001963316173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309277324336
                                         uncertainty =       0.001963316173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393266808
  error estimate for blocks of size 2^( 2) =       0.000407513748
  error estimate for blocks of size 2^( 3) =       0.000421519608
  error estimate for blocks of size 2^( 4) =       0.000435079979
  error estimate for blocks of size 2^( 5) =       0.000446649632
  error estimate for blocks of size 2^( 6) =       0.000455023926
  error estimate for blocks of size 2^( 7) =       0.000460157358

      target function =                  N/A
              le_mean =     -16.904131857714
             les_mean =     286.070639151878
             stat err =       0.000449227724
             autocorr =       1.304843766540
              std dev =       0.556163253017
             le_variance =       0.309317564007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309239327585
                                         uncertainty =       0.001966783102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309239327585
                                         uncertainty =       0.001966783102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393242811
  error estimate for blocks of size 2^( 2) =       0.000407493553
  error estimate for blocks of size 2^( 3) =       0.000421503447
  error estimate for blocks of size 2^( 4) =       0.000435062734
  error estimate for blocks of size 2^( 5) =       0.000446640253
  error estimate for blocks of size 2^( 6) =       0.000455002669
  error estimate for blocks of size 2^( 7) =       0.000460139878

      target function =                  N/A
              le_mean =     -16.904135091411
             les_mean =     286.070780026322
             stat err =       0.000449211384
             autocorr =       1.304908089234
              std dev =       0.556129316266
             le_variance =       0.309279816411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309248115186
                                         uncertainty =       0.001965068580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309248115186
                                         uncertainty =       0.001965068580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393248325
  error estimate for blocks of size 2^( 2) =       0.000407497609
  error estimate for blocks of size 2^( 3) =       0.000421505834
  error estimate for blocks of size 2^( 4) =       0.000435065564
  error estimate for blocks of size 2^( 5) =       0.000446639968
  error estimate for blocks of size 2^( 6) =       0.000455007057
  error estimate for blocks of size 2^( 7) =       0.000460143091

      target function =                  N/A
              le_mean =     -16.904133321610
             les_mean =     286.070578545525
             stat err =       0.000449213920
             autocorr =       1.304886227719
              std dev =       0.556137115130
             le_variance =       0.309288490825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309272666386
                                         uncertainty =       0.001963518557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309272666386
                                         uncertainty =       0.001963518557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393263858
  error estimate for blocks of size 2^( 2) =       0.000407511105
  error estimate for blocks of size 2^( 3) =       0.000421517280
  error estimate for blocks of size 2^( 4) =       0.000435077581
  error estimate for blocks of size 2^( 5) =       0.000446647863
  error estimate for blocks of size 2^( 6) =       0.000455021247
  error estimate for blocks of size 2^( 7) =       0.000460155061

      target function =                  N/A
              le_mean =     -16.904131967529
             les_mean =     286.070745996016
             stat err =       0.000449225438
             autocorr =       1.304850064034
              std dev =       0.556159081503
             le_variance =       0.309312923938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904131857714        initial
     9.0949e-01     9.0949e+00             4.1210e-04       -16.904135091411  <--
     3.6380e+00     3.6380e+01             1.1267e-04       -16.904133321610
     1.4552e+01     1.4552e+02             2.8839e-05       -16.904131967529

*****************************************************************************
Applying the update for shift_i =   9.0949e-01     and shift_s =   9.0949e+00
*****************************************************************************

  Execution time = 2.3610e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.005945e-01 3 1  ON 0
ci_0002                 6.999789e-01 3 1  ON 1
ci_0003                -3.089002e-02 3 1  ON 2
ci_0004                -3.089242e-02 3 1  ON 3
ci_0005                -3.412928e-02 3 1  ON 4
ci_0006                -3.357041e-02 3 1  ON 5
ci_0007                -2.261613e-02 3 1  ON 6
ci_0008                -2.375791e-02 3 1  ON 7
ci_0009                -2.043546e-02 3 1  ON 8
ci_0010                -1.993505e-02 3 1  ON 9
ci_0011                -1.469026e-02 3 1  ON 10
ci_0012                -1.520508e-02 3 1  ON 11
ci_0013                 1.561320e-02 3 1  ON 12
ci_0014                 1.536575e-02 3 1  ON 13
ci_0015                 1.559144e-02 3 1  ON 14
ci_0016                 1.533281e-02 3 1  ON 15
ci_0017                 1.367803e-02 3 1  ON 16
ci_0018                 1.401147e-02 3 1  ON 17
ci_0019                 1.202547e-02 3 1  ON 18
ci_0020                 1.193403e-02 3 1  ON 19
ci_0021                 6.946391e-03 3 1  ON 20
ci_0022                 7.431845e-03 3 1  ON 21
ci_0023                -1.160714e-02 3 1  ON 22
ci_0024                -1.130228e-02 3 1  ON 23
ci_0025                -1.178799e-02 3 1  ON 24
ci_0026                -1.148843e-02 3 1  ON 25
ci_0027                -1.128164e-02 3 1  ON 26
ci_0028                -1.119490e-02 3 1  ON 27
ci_0029                -1.079203e-02 3 1  ON 28
ci_0030                -1.046345e-02 3 1  ON 29
ci_0031                 1.914335e-02 3 1  ON 30
ci_0032                 1.855816e-02 3 1  ON 31
ci_0033                 1.060428e-02 3 1  ON 32
ci_0034                 1.103541e-02 3 1  ON 33
ci_0035                 7.399535e-03 3 1  ON 34
ci_0036                 6.285489e-03 3 1  ON 35
ci_0037                -1.107510e-02 3 1  ON 36
ci_0038                -1.107146e-02 3 1  ON 37
ci_0039                -4.349763e-03 3 1  ON 38
ci_0040                -4.100106e-03 3 1  ON 39
ci_0041                 7.980936e-03 3 1  ON 40
ci_0042                 8.306038e-03 3 1  ON 41
ci_0043                -1.386428e-02 3 1  ON 42
ci_0044                -1.338183e-02 3 1  ON 43
ci_0045                 8.401343e-03 3 1  ON 44
ci_0046                 8.526067e-03 3 1  ON 45
ci_0047                -3.654833e-03 3 1  ON 46
ci_0048                -3.270641e-03 3 1  ON 47
ci_0049                -6.640826e-03 3 1  ON 48
ci_0050                -6.867900e-03 3 1  ON 49
ci_0051                -5.084542e-03 3 1  ON 50
ci_0052                -4.752741e-03 3 1  ON 51
ci_0053                -6.220426e-03 3 1  ON 52
ci_0054                -5.878656e-03 3 1  ON 53
ci_0055                 6.831242e-03 3 1  ON 54
ci_0056                 7.320344e-03 3 1  ON 55
ci_0057                 5.627027e-03 3 1  ON 56
ci_0058                 5.700895e-03 3 1  ON 57
ci_0059                -5.976977e-03 3 1  ON 58
ci_0060                -5.887658e-03 3 1  ON 59
ci_0061                -4.194460e-03 3 1  ON 60
ci_0062                -3.535810e-03 3 1  ON 61
ci_0063                -8.708702e-03 3 1  ON 62
ci_0064                -8.497068e-03 3 1  ON 63
ci_0065                -6.837407e-03 3 1  ON 64
ci_0066                -6.511826e-03 3 1  ON 65
ci_0067                -6.103920e-03 3 1  ON 66
ci_0068                -6.239868e-03 3 1  ON 67
ci_0069                 5.702013e-03 3 1  ON 68
ci_0070                 5.392949e-03 3 1  ON 69
ci_0071                 4.518502e-03 3 1  ON 70
ci_0072                 4.488553e-03 3 1  ON 71
ci_0073                 4.955953e-03 3 1  ON 72
ci_0074                 5.363119e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2397e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.891
    reference variance = 0.162101
====================================================
  Execution time = 1.4549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2544e-01
  Total weights = 1.951775798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313394372248
                                         uncertainty =       0.002456071238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313394372248
                                         uncertainty =       0.002456071238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395877765
  error estimate for blocks of size 2^( 2) =       0.000409911826
  error estimate for blocks of size 2^( 3) =       0.000424029043
  error estimate for blocks of size 2^( 4) =       0.000436866619
  error estimate for blocks of size 2^( 5) =       0.000447262036
  error estimate for blocks of size 2^( 6) =       0.000454236161
  error estimate for blocks of size 2^( 7) =       0.000458149835

      target function =                  N/A
              le_mean =     -16.904263092808
             les_mean =     286.079548899539
             stat err =       0.000449128663
             autocorr =       1.287120846808
              std dev =       0.559855704405
             le_variance =       0.313438409755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690426309281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263092825       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904272866994       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904274913731       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904274584456       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e-01 is 8.749650e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263092825       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904266914470       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904267089712       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904267045379       residual = 1.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e-01 is 3.424324e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904263092825       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904264205054       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904264174814       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904264175176       residual = 1.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+00 is 9.970815e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7140e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.006157e-01 3 1  ON 0
ci_0002                 7.000036e-01 3 1  ON 1
ci_0003                -3.063934e-02 3 1  ON 2
ci_0004                -3.075837e-02 3 1  ON 3
ci_0005                -3.398644e-02 3 1  ON 4
ci_0006                -3.356868e-02 3 1  ON 5
ci_0007                -2.258302e-02 3 1  ON 6
ci_0008                -2.358068e-02 3 1  ON 7
ci_0009                -2.029883e-02 3 1  ON 8
ci_0010                -1.987458e-02 3 1  ON 9
ci_0011                -1.475148e-02 3 1  ON 10
ci_0012                -1.536138e-02 3 1  ON 11
ci_0013                 1.563880e-02 3 1  ON 12
ci_0014                 1.536259e-02 3 1  ON 13
ci_0015                 1.572939e-02 3 1  ON 14
ci_0016                 1.551920e-02 3 1  ON 15
ci_0017                 1.363101e-02 3 1  ON 16
ci_0018                 1.372810e-02 3 1  ON 17
ci_0019                 1.205504e-02 3 1  ON 18
ci_0020                 1.193119e-02 3 1  ON 19
ci_0021                 6.825962e-03 3 1  ON 20
ci_0022                 7.478976e-03 3 1  ON 21
ci_0023                -1.163698e-02 3 1  ON 22
ci_0024                -1.134141e-02 3 1  ON 23
ci_0025                -1.172444e-02 3 1  ON 24
ci_0026                -1.161919e-02 3 1  ON 25
ci_0027                -1.119528e-02 3 1  ON 26
ci_0028                -1.110801e-02 3 1  ON 27
ci_0029                -1.044960e-02 3 1  ON 28
ci_0030                -1.053420e-02 3 1  ON 29
ci_0031                 1.896306e-02 3 1  ON 30
ci_0032                 1.857218e-02 3 1  ON 31
ci_0033                 1.069166e-02 3 1  ON 32
ci_0034                 1.088003e-02 3 1  ON 33
ci_0035                 7.263937e-03 3 1  ON 34
ci_0036                 6.402058e-03 3 1  ON 35
ci_0037                -1.118715e-02 3 1  ON 36
ci_0038                -1.100290e-02 3 1  ON 37
ci_0039                -4.262162e-03 3 1  ON 38
ci_0040                -4.136629e-03 3 1  ON 39
ci_0041                 8.040809e-03 3 1  ON 40
ci_0042                 8.540207e-03 3 1  ON 41
ci_0043                -1.388386e-02 3 1  ON 42
ci_0044                -1.336146e-02 3 1  ON 43
ci_0045                 8.450004e-03 3 1  ON 44
ci_0046                 8.375146e-03 3 1  ON 45
ci_0047                -3.544115e-03 3 1  ON 46
ci_0048                -3.307000e-03 3 1  ON 47
ci_0049                -6.453624e-03 3 1  ON 48
ci_0050                -6.965733e-03 3 1  ON 49
ci_0051                -5.051437e-03 3 1  ON 50
ci_0052                -4.786325e-03 3 1  ON 51
ci_0053                -6.305911e-03 3 1  ON 52
ci_0054                -5.977457e-03 3 1  ON 53
ci_0055                 7.001564e-03 3 1  ON 54
ci_0056                 7.159846e-03 3 1  ON 55
ci_0057                 5.466819e-03 3 1  ON 56
ci_0058                 5.732512e-03 3 1  ON 57
ci_0059                -5.948610e-03 3 1  ON 58
ci_0060                -5.717784e-03 3 1  ON 59
ci_0061                -4.138977e-03 3 1  ON 60
ci_0062                -3.536042e-03 3 1  ON 61
ci_0063                -8.605796e-03 3 1  ON 62
ci_0064                -8.506609e-03 3 1  ON 63
ci_0065                -6.632586e-03 3 1  ON 64
ci_0066                -6.670632e-03 3 1  ON 65
ci_0067                -6.147760e-03 3 1  ON 66
ci_0068                -6.018731e-03 3 1  ON 67
ci_0069                 5.602780e-03 3 1  ON 68
ci_0070                 5.307256e-03 3 1  ON 69
ci_0071                 4.582184e-03 3 1  ON 70
ci_0072                 4.478641e-03 3 1  ON 71
ci_0073                 5.052999e-03 3 1  ON 72
ci_0074                 5.386905e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9902
    reference variance = 0.371064
====================================================
  Execution time = 1.4112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2523e-01
  Total weights = 1.9516e+06
  Execution time = 1.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261191273
                                         uncertainty =       0.001920004167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261191273
                                         uncertainty =       0.001920004167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395159955
  error estimate for blocks of size 2^( 2) =       0.000409265799
  error estimate for blocks of size 2^( 3) =       0.000423416538
  error estimate for blocks of size 2^( 4) =       0.000436608818
  error estimate for blocks of size 2^( 5) =       0.000447468000
  error estimate for blocks of size 2^( 6) =       0.000455900404
  error estimate for blocks of size 2^( 7) =       0.000462209692

      target function =                  N/A
              le_mean =     -16.904582214842
             les_mean =     286.090692209468
             stat err =       0.000450546728
             autocorr =       1.299971485636
              std dev =       0.558840567587
             le_variance =       0.312302779981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312137782365
                                         uncertainty =       0.001911422211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312137782365
                                         uncertainty =       0.001911422211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395080284
  error estimate for blocks of size 2^( 2) =       0.000409203319
  error estimate for blocks of size 2^( 3) =       0.000423374107
  error estimate for blocks of size 2^( 4) =       0.000436576794
  error estimate for blocks of size 2^( 5) =       0.000447448674
  error estimate for blocks of size 2^( 6) =       0.000455918941
  error estimate for blocks of size 2^( 7) =       0.000462188595

      target function =                  N/A
              le_mean =     -16.904588018731
             les_mean =     286.101459834798
             stat err =       0.000450533251
             autocorr =       1.300418030919
              std dev =       0.558727896528
             le_variance =       0.312176862358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312134463136
                                         uncertainty =       0.001912886461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312134463136
                                         uncertainty =       0.001912886461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395078479
  error estimate for blocks of size 2^( 2) =       0.000409199392
  error estimate for blocks of size 2^( 3) =       0.000423365617
  error estimate for blocks of size 2^( 4) =       0.000436567632
  error estimate for blocks of size 2^( 5) =       0.000447436404
  error estimate for blocks of size 2^( 6) =       0.000455897016
  error estimate for blocks of size 2^( 7) =       0.000462171392

      target function =                  N/A
              le_mean =     -16.904582482564
             les_mean =     286.090482749004
             stat err =       0.000450518111
             autocorr =       1.300342516280
              std dev =       0.558725343161
             le_variance =       0.312174009091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312237861285
                                         uncertainty =       0.001918633793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312237861285
                                         uncertainty =       0.001918633793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395144995
  error estimate for blocks of size 2^( 2) =       0.000409252074
  error estimate for blocks of size 2^( 3) =       0.000423405388
  error estimate for blocks of size 2^( 4) =       0.000436599885
  error estimate for blocks of size 2^( 5) =       0.000447461730
  error estimate for blocks of size 2^( 6) =       0.000455899846
  error estimate for blocks of size 2^( 7) =       0.000462200222

      target function =                  N/A
              le_mean =     -16.904582440339
             les_mean =     286.136091674020
             stat err =       0.000450540421
             autocorr =       1.300033519323
              std dev =       0.558819410904
             le_variance =       0.312279134003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904582214842        initial
     2.2737e-01     2.2737e+00             8.7497e-04       -16.904588018731  <--
     9.0949e-01     9.0949e+00             3.4243e-04       -16.904582482564
     3.6380e+00     3.6380e+01             9.9708e-05       -16.904582440339

*****************************************************************************
Applying the update for shift_i =   2.2737e-01     and shift_s =   2.2737e+00
*****************************************************************************

  Execution time = 2.3664e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.006033e-01 3 1  ON 0
ci_0002                 7.000945e-01 3 1  ON 1
ci_0003                -3.022838e-02 3 1  ON 2
ci_0004                -3.053596e-02 3 1  ON 3
ci_0005                -3.369108e-02 3 1  ON 4
ci_0006                -3.357809e-02 3 1  ON 5
ci_0007                -2.249030e-02 3 1  ON 6
ci_0008                -2.320621e-02 3 1  ON 7
ci_0009                -2.010804e-02 3 1  ON 8
ci_0010                -1.979155e-02 3 1  ON 9
ci_0011                -1.485793e-02 3 1  ON 10
ci_0012                -1.560895e-02 3 1  ON 11
ci_0013                 1.570014e-02 3 1  ON 12
ci_0014                 1.535400e-02 3 1  ON 13
ci_0015                 1.596420e-02 3 1  ON 14
ci_0016                 1.581793e-02 3 1  ON 15
ci_0017                 1.356503e-02 3 1  ON 16
ci_0018                 1.330940e-02 3 1  ON 17
ci_0019                 1.210285e-02 3 1  ON 18
ci_0020                 1.192856e-02 3 1  ON 19
ci_0021                 6.559249e-03 3 1  ON 20
ci_0022                 7.580242e-03 3 1  ON 21
ci_0023                -1.168623e-02 3 1  ON 22
ci_0024                -1.141313e-02 3 1  ON 23
ci_0025                -1.162084e-02 3 1  ON 24
ci_0026                -1.181940e-02 3 1  ON 25
ci_0027                -1.106596e-02 3 1  ON 26
ci_0028                -1.097407e-02 3 1  ON 27
ci_0029                -9.917063e-03 3 1  ON 28
ci_0030                -1.064355e-02 3 1  ON 29
ci_0031                 1.857999e-02 3 1  ON 30
ci_0032                 1.862019e-02 3 1  ON 31
ci_0033                 1.086487e-02 3 1  ON 32
ci_0034                 1.057057e-02 3 1  ON 33
ci_0035                 7.054347e-03 3 1  ON 34
ci_0036                 6.590530e-03 3 1  ON 35
ci_0037                -1.138797e-02 3 1  ON 36
ci_0038                -1.088526e-02 3 1  ON 37
ci_0039                -4.160477e-03 3 1  ON 38
ci_0040                -4.180166e-03 3 1  ON 39
ci_0041                 8.138107e-03 3 1  ON 40
ci_0042                 8.899799e-03 3 1  ON 41
ci_0043                -1.393549e-02 3 1  ON 42
ci_0044                -1.332214e-02 3 1  ON 43
ci_0045                 8.554270e-03 3 1  ON 44
ci_0046                 8.087484e-03 3 1  ON 45
ci_0047                -3.412538e-03 3 1  ON 46
ci_0048                -3.352668e-03 3 1  ON 47
ci_0049                -6.169473e-03 3 1  ON 48
ci_0050                -7.116352e-03 3 1  ON 49
ci_0051                -5.010909e-03 3 1  ON 50
ci_0052                -4.828360e-03 3 1  ON 51
ci_0053                -6.418976e-03 3 1  ON 52
ci_0054                -6.110387e-03 3 1  ON 53
ci_0055                 7.303357e-03 3 1  ON 54
ci_0056                 6.877047e-03 3 1  ON 55
ci_0057                 5.191082e-03 3 1  ON 56
ci_0058                 5.783624e-03 3 1  ON 57
ci_0059                -5.911096e-03 3 1  ON 58
ci_0060                -5.510731e-03 3 1  ON 59
ci_0061                -4.048792e-03 3 1  ON 60
ci_0062                -3.533903e-03 3 1  ON 61
ci_0063                -8.475012e-03 3 1  ON 62
ci_0064                -8.530582e-03 3 1  ON 63
ci_0065                -6.343518e-03 3 1  ON 64
ci_0066                -6.895887e-03 3 1  ON 65
ci_0067                -6.204465e-03 3 1  ON 66
ci_0068                -5.746494e-03 3 1  ON 67
ci_0069                 5.483912e-03 3 1  ON 68
ci_0070                 5.203436e-03 3 1  ON 69
ci_0071                 4.680791e-03 3 1  ON 70
ci_0072                 4.453604e-03 3 1  ON 71
ci_0073                 5.171527e-03 3 1  ON 72
ci_0074                 5.416465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0810e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8801
    reference variance = 0.154432
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2675e-01
  Total weights = 1.951821321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311998364931
                                         uncertainty =       0.001896413279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311998364931
                                         uncertainty =       0.001896413279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394913977
  error estimate for blocks of size 2^( 2) =       0.000409060907
  error estimate for blocks of size 2^( 3) =       0.000423517325
  error estimate for blocks of size 2^( 4) =       0.000435747115
  error estimate for blocks of size 2^( 5) =       0.000447346675
  error estimate for blocks of size 2^( 6) =       0.000455623314
  error estimate for blocks of size 2^( 7) =       0.000459641879

      target function =                  N/A
              le_mean =     -16.904406758658
             les_mean =     286.085717197815
             stat err =       0.000449589746
             autocorr =       1.296067990735
              std dev =       0.558492702279
             le_variance =       0.311914098499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690440675866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-02, overlap shift 5.6843e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904406758679       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904419011536       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904419551232       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904419345649       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904419732700       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904420072911       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904419891323       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e-02 is 1.405280e-03

solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904406758679       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904414425135       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904414462079       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904414476808       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e-01 is 9.439124e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904406758679       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904409828634       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904409774288       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904409801372       residual = 1.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e-01 is 4.071554e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7090e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.007973e-01 3 1  ON 0
ci_0002                 6.999123e-01 3 1  ON 1
ci_0003                -3.052693e-02 3 1  ON 2
ci_0004                -3.056483e-02 3 1  ON 3
ci_0005                -3.393687e-02 3 1  ON 4
ci_0006                -3.373226e-02 3 1  ON 5
ci_0007                -2.204683e-02 3 1  ON 6
ci_0008                -2.314767e-02 3 1  ON 7
ci_0009                -1.943581e-02 3 1  ON 8
ci_0010                -2.004451e-02 3 1  ON 9
ci_0011                -1.510794e-02 3 1  ON 10
ci_0012                -1.541108e-02 3 1  ON 11
ci_0013                 1.545577e-02 3 1  ON 12
ci_0014                 1.524454e-02 3 1  ON 13
ci_0015                 1.533638e-02 3 1  ON 14
ci_0016                 1.551619e-02 3 1  ON 15
ci_0017                 1.323763e-02 3 1  ON 16
ci_0018                 1.377354e-02 3 1  ON 17
ci_0019                 1.208873e-02 3 1  ON 18
ci_0020                 1.172632e-02 3 1  ON 19
ci_0021                 6.711528e-03 3 1  ON 20
ci_0022                 7.460165e-03 3 1  ON 21
ci_0023                -1.176328e-02 3 1  ON 22
ci_0024                -1.112759e-02 3 1  ON 23
ci_0025                -1.084482e-02 3 1  ON 24
ci_0026                -1.157980e-02 3 1  ON 25
ci_0027                -1.106146e-02 3 1  ON 26
ci_0028                -1.147054e-02 3 1  ON 27
ci_0029                -1.034513e-02 3 1  ON 28
ci_0030                -1.079623e-02 3 1  ON 29
ci_0031                 1.810594e-02 3 1  ON 30
ci_0032                 1.878275e-02 3 1  ON 31
ci_0033                 1.055476e-02 3 1  ON 32
ci_0034                 1.061737e-02 3 1  ON 33
ci_0035                 7.142989e-03 3 1  ON 34
ci_0036                 7.226375e-03 3 1  ON 35
ci_0037                -1.114870e-02 3 1  ON 36
ci_0038                -1.134818e-02 3 1  ON 37
ci_0039                -4.272361e-03 3 1  ON 38
ci_0040                -4.152392e-03 3 1  ON 39
ci_0041                 8.470671e-03 3 1  ON 40
ci_0042                 8.714397e-03 3 1  ON 41
ci_0043                -1.438920e-02 3 1  ON 42
ci_0044                -1.339365e-02 3 1  ON 43
ci_0045                 8.661511e-03 3 1  ON 44
ci_0046                 8.531634e-03 3 1  ON 45
ci_0047                -3.395164e-03 3 1  ON 46
ci_0048                -3.518205e-03 3 1  ON 47
ci_0049                -6.274678e-03 3 1  ON 48
ci_0050                -6.438437e-03 3 1  ON 49
ci_0051                -5.043887e-03 3 1  ON 50
ci_0052                -4.636836e-03 3 1  ON 51
ci_0053                -6.516870e-03 3 1  ON 52
ci_0054                -6.468637e-03 3 1  ON 53
ci_0055                 7.222907e-03 3 1  ON 54
ci_0056                 7.090569e-03 3 1  ON 55
ci_0057                 5.342750e-03 3 1  ON 56
ci_0058                 5.673320e-03 3 1  ON 57
ci_0059                -5.913647e-03 3 1  ON 58
ci_0060                -5.493203e-03 3 1  ON 59
ci_0061                -3.919138e-03 3 1  ON 60
ci_0062                -3.620854e-03 3 1  ON 61
ci_0063                -8.405555e-03 3 1  ON 62
ci_0064                -9.474494e-03 3 1  ON 63
ci_0065                -6.643786e-03 3 1  ON 64
ci_0066                -6.430533e-03 3 1  ON 65
ci_0067                -5.909019e-03 3 1  ON 66
ci_0068                -5.637242e-03 3 1  ON 67
ci_0069                 5.600553e-03 3 1  ON 68
ci_0070                 5.113695e-03 3 1  ON 69
ci_0071                 4.395109e-03 3 1  ON 70
ci_0072                 4.445346e-03 3 1  ON 71
ci_0073                 4.752223e-03 3 1  ON 72
ci_0074                 5.498462e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8895
    reference variance = 0.238248
====================================================
  Execution time = 1.4123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2313e-01
  Total weights = 1.9518e+06
  Execution time = 1.9082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311317868241
                                         uncertainty =       0.002068454721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311317868241
                                         uncertainty =       0.002068454721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394529892
  error estimate for blocks of size 2^( 2) =       0.000409280272
  error estimate for blocks of size 2^( 3) =       0.000423722844
  error estimate for blocks of size 2^( 4) =       0.000437070948
  error estimate for blocks of size 2^( 5) =       0.000448119434
  error estimate for blocks of size 2^( 6) =       0.000456099671
  error estimate for blocks of size 2^( 7) =       0.000460786914

      target function =                  N/A
              le_mean =     -16.903991970764
             les_mean =     286.068359060965
             stat err =       0.000450519242
             autocorr =       1.303967783293
              std dev =       0.557949524059
             le_variance =       0.311307671397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311002073776
                                         uncertainty =       0.002112559717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311002073776
                                         uncertainty =       0.002112559717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394330536
  error estimate for blocks of size 2^( 2) =       0.000409087041
  error estimate for blocks of size 2^( 3) =       0.000423529568
  error estimate for blocks of size 2^( 4) =       0.000436885719
  error estimate for blocks of size 2^( 5) =       0.000447953320
  error estimate for blocks of size 2^( 6) =       0.000455883669
  error estimate for blocks of size 2^( 7) =       0.000460598246

      target function =                  N/A
              le_mean =     -16.903959188949
             les_mean =     286.113147631387
             stat err =       0.000450330238
             autocorr =       1.304191608421
              std dev =       0.557667591774
             le_variance =       0.310993142915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310986280237
                                         uncertainty =       0.002124628338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310986280237
                                         uncertainty =       0.002124628338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394320643
  error estimate for blocks of size 2^( 2) =       0.000409080786
  error estimate for blocks of size 2^( 3) =       0.000423525921
  error estimate for blocks of size 2^( 4) =       0.000436884837
  error estimate for blocks of size 2^( 5) =       0.000447957425
  error estimate for blocks of size 2^( 6) =       0.000455880938
  error estimate for blocks of size 2^( 7) =       0.000460582191

      target function =                  N/A
              le_mean =     -16.903961145525
             les_mean =     286.075540927241
             stat err =       0.000450326348
             autocorr =       1.304234512397
              std dev =       0.557653601270
             le_variance =       0.310977539009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311177442756
                                         uncertainty =       0.002077245449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311177442756
                                         uncertainty =       0.002077245449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394441102
  error estimate for blocks of size 2^( 2) =       0.000409190983
  error estimate for blocks of size 2^( 3) =       0.000423630427
  error estimate for blocks of size 2^( 4) =       0.000436976070
  error estimate for blocks of size 2^( 5) =       0.000448030435
  error estimate for blocks of size 2^( 6) =       0.000456002795
  error estimate for blocks of size 2^( 7) =       0.000460703132

      target function =                  N/A
              le_mean =     -16.903979264778
             les_mean =     286.077769058172
             stat err =       0.000450428108
             autocorr =       1.304027173652
              std dev =       0.557823956074
             le_variance =       0.311167565970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903991970764        initial  <--
     5.6843e-02     5.6843e-01             1.4053e-03       -16.903959188949
     2.2737e-01     2.2737e+00             9.4391e-04       -16.903961145525
     9.0949e-01     9.0949e+00             4.0716e-04       -16.903979264778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7557
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.006033e-01 3 1  ON 0
ci_0002                 7.000945e-01 3 1  ON 1
ci_0003                -3.022838e-02 3 1  ON 2
ci_0004                -3.053596e-02 3 1  ON 3
ci_0005                -3.369108e-02 3 1  ON 4
ci_0006                -3.357809e-02 3 1  ON 5
ci_0007                -2.249030e-02 3 1  ON 6
ci_0008                -2.320621e-02 3 1  ON 7
ci_0009                -2.010804e-02 3 1  ON 8
ci_0010                -1.979155e-02 3 1  ON 9
ci_0011                -1.485793e-02 3 1  ON 10
ci_0012                -1.560895e-02 3 1  ON 11
ci_0013                 1.570014e-02 3 1  ON 12
ci_0014                 1.535400e-02 3 1  ON 13
ci_0015                 1.596420e-02 3 1  ON 14
ci_0016                 1.581793e-02 3 1  ON 15
ci_0017                 1.356503e-02 3 1  ON 16
ci_0018                 1.330940e-02 3 1  ON 17
ci_0019                 1.210285e-02 3 1  ON 18
ci_0020                 1.192856e-02 3 1  ON 19
ci_0021                 6.559249e-03 3 1  ON 20
ci_0022                 7.580242e-03 3 1  ON 21
ci_0023                -1.168623e-02 3 1  ON 22
ci_0024                -1.141313e-02 3 1  ON 23
ci_0025                -1.162084e-02 3 1  ON 24
ci_0026                -1.181940e-02 3 1  ON 25
ci_0027                -1.106596e-02 3 1  ON 26
ci_0028                -1.097407e-02 3 1  ON 27
ci_0029                -9.917063e-03 3 1  ON 28
ci_0030                -1.064355e-02 3 1  ON 29
ci_0031                 1.857999e-02 3 1  ON 30
ci_0032                 1.862019e-02 3 1  ON 31
ci_0033                 1.086487e-02 3 1  ON 32
ci_0034                 1.057057e-02 3 1  ON 33
ci_0035                 7.054347e-03 3 1  ON 34
ci_0036                 6.590530e-03 3 1  ON 35
ci_0037                -1.138797e-02 3 1  ON 36
ci_0038                -1.088526e-02 3 1  ON 37
ci_0039                -4.160477e-03 3 1  ON 38
ci_0040                -4.180166e-03 3 1  ON 39
ci_0041                 8.138107e-03 3 1  ON 40
ci_0042                 8.899799e-03 3 1  ON 41
ci_0043                -1.393549e-02 3 1  ON 42
ci_0044                -1.332214e-02 3 1  ON 43
ci_0045                 8.554270e-03 3 1  ON 44
ci_0046                 8.087484e-03 3 1  ON 45
ci_0047                -3.412538e-03 3 1  ON 46
ci_0048                -3.352668e-03 3 1  ON 47
ci_0049                -6.169473e-03 3 1  ON 48
ci_0050                -7.116352e-03 3 1  ON 49
ci_0051                -5.010909e-03 3 1  ON 50
ci_0052                -4.828360e-03 3 1  ON 51
ci_0053                -6.418976e-03 3 1  ON 52
ci_0054                -6.110387e-03 3 1  ON 53
ci_0055                 7.303357e-03 3 1  ON 54
ci_0056                 6.877047e-03 3 1  ON 55
ci_0057                 5.191082e-03 3 1  ON 56
ci_0058                 5.783624e-03 3 1  ON 57
ci_0059                -5.911096e-03 3 1  ON 58
ci_0060                -5.510731e-03 3 1  ON 59
ci_0061                -4.048792e-03 3 1  ON 60
ci_0062                -3.533903e-03 3 1  ON 61
ci_0063                -8.475012e-03 3 1  ON 62
ci_0064                -8.530582e-03 3 1  ON 63
ci_0065                -6.343518e-03 3 1  ON 64
ci_0066                -6.895887e-03 3 1  ON 65
ci_0067                -6.204465e-03 3 1  ON 66
ci_0068                -5.746494e-03 3 1  ON 67
ci_0069                 5.483912e-03 3 1  ON 68
ci_0070                 5.203436e-03 3 1  ON 69
ci_0071                 4.680791e-03 3 1  ON 70
ci_0072                 4.453604e-03 3 1  ON 71
ci_0073                 5.171527e-03 3 1  ON 72
ci_0074                 5.416465e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9684
    reference variance = 0.287174
====================================================
  Execution time = 1.4664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2849e-01
  Total weights = 1.951700960e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313705258428
                                         uncertainty =       0.002246693327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313705258428
                                         uncertainty =       0.002246693327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396032615
  error estimate for blocks of size 2^( 2) =       0.000409995549
  error estimate for blocks of size 2^( 3) =       0.000423567754
  error estimate for blocks of size 2^( 4) =       0.000436732462
  error estimate for blocks of size 2^( 5) =       0.000447110023
  error estimate for blocks of size 2^( 6) =       0.000453700867
  error estimate for blocks of size 2^( 7) =       0.000458892281

      target function =                  N/A
              le_mean =     -16.904953467112
             les_mean =     286.105940429162
             stat err =       0.000449108908
             autocorr =       1.286001370624
              std dev =       0.560074695728
             le_variance =       0.313683664795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690495346711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904953467089       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904954664227       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904954476878       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904954495423       residual = 3.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e-01 is 4.657214e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904953467089       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904953838531       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904953758243       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904953757585       residual = 1.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+00 is 1.429190e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904953467089       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904953565906       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904953542835       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904953541467       residual = 1.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+00 is 3.789326e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7273e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.006363e-01 3 1  ON 0
ci_0002                 7.000440e-01 3 1  ON 1
ci_0003                -3.017978e-02 3 1  ON 2
ci_0004                -3.065251e-02 3 1  ON 3
ci_0005                -3.375443e-02 3 1  ON 4
ci_0006                -3.357037e-02 3 1  ON 5
ci_0007                -2.249522e-02 3 1  ON 6
ci_0008                -2.320409e-02 3 1  ON 7
ci_0009                -2.012245e-02 3 1  ON 8
ci_0010                -1.980796e-02 3 1  ON 9
ci_0011                -1.491484e-02 3 1  ON 10
ci_0012                -1.556316e-02 3 1  ON 11
ci_0013                 1.575365e-02 3 1  ON 12
ci_0014                 1.547139e-02 3 1  ON 13
ci_0015                 1.601750e-02 3 1  ON 14
ci_0016                 1.579978e-02 3 1  ON 15
ci_0017                 1.358985e-02 3 1  ON 16
ci_0018                 1.338735e-02 3 1  ON 17
ci_0019                 1.205888e-02 3 1  ON 18
ci_0020                 1.194707e-02 3 1  ON 19
ci_0021                 6.608116e-03 3 1  ON 20
ci_0022                 7.548819e-03 3 1  ON 21
ci_0023                -1.176809e-02 3 1  ON 22
ci_0024                -1.141933e-02 3 1  ON 23
ci_0025                -1.168496e-02 3 1  ON 24
ci_0026                -1.187524e-02 3 1  ON 25
ci_0027                -1.107028e-02 3 1  ON 26
ci_0028                -1.094305e-02 3 1  ON 27
ci_0029                -1.002273e-02 3 1  ON 28
ci_0030                -1.064735e-02 3 1  ON 29
ci_0031                 1.865951e-02 3 1  ON 30
ci_0032                 1.864042e-02 3 1  ON 31
ci_0033                 1.089674e-02 3 1  ON 32
ci_0034                 1.051493e-02 3 1  ON 33
ci_0035                 7.080402e-03 3 1  ON 34
ci_0036                 6.733449e-03 3 1  ON 35
ci_0037                -1.140716e-02 3 1  ON 36
ci_0038                -1.085730e-02 3 1  ON 37
ci_0039                -4.174781e-03 3 1  ON 38
ci_0040                -4.196355e-03 3 1  ON 39
ci_0041                 8.228820e-03 3 1  ON 40
ci_0042                 8.813871e-03 3 1  ON 41
ci_0043                -1.397625e-02 3 1  ON 42
ci_0044                -1.330494e-02 3 1  ON 43
ci_0045                 8.477162e-03 3 1  ON 44
ci_0046                 8.136157e-03 3 1  ON 45
ci_0047                -3.373550e-03 3 1  ON 46
ci_0048                -3.365329e-03 3 1  ON 47
ci_0049                -6.107725e-03 3 1  ON 48
ci_0050                -7.021172e-03 3 1  ON 49
ci_0051                -4.982350e-03 3 1  ON 50
ci_0052                -4.839552e-03 3 1  ON 51
ci_0053                -6.338806e-03 3 1  ON 52
ci_0054                -6.117047e-03 3 1  ON 53
ci_0055                 7.301906e-03 3 1  ON 54
ci_0056                 6.851683e-03 3 1  ON 55
ci_0057                 5.209551e-03 3 1  ON 56
ci_0058                 5.750557e-03 3 1  ON 57
ci_0059                -5.966566e-03 3 1  ON 58
ci_0060                -5.489739e-03 3 1  ON 59
ci_0061                -4.012922e-03 3 1  ON 60
ci_0062                -3.497509e-03 3 1  ON 61
ci_0063                -8.493928e-03 3 1  ON 62
ci_0064                -8.529480e-03 3 1  ON 63
ci_0065                -6.289567e-03 3 1  ON 64
ci_0066                -6.927312e-03 3 1  ON 65
ci_0067                -6.132774e-03 3 1  ON 66
ci_0068                -5.749442e-03 3 1  ON 67
ci_0069                 5.457729e-03 3 1  ON 68
ci_0070                 5.210551e-03 3 1  ON 69
ci_0071                 4.584314e-03 3 1  ON 70
ci_0072                 4.518474e-03 3 1  ON 71
ci_0073                 5.142784e-03 3 1  ON 72
ci_0074                 5.408807e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.0251
    reference variance = 0.316251
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3075e-01
  Total weights = 1.9516e+06
  Execution time = 1.9079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315075450069
                                         uncertainty =       0.002449979307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315075450069
                                         uncertainty =       0.002449979307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396911987
  error estimate for blocks of size 2^( 2) =       0.000410629555
  error estimate for blocks of size 2^( 3) =       0.000424998478
  error estimate for blocks of size 2^( 4) =       0.000438088418
  error estimate for blocks of size 2^( 5) =       0.000447924215
  error estimate for blocks of size 2^( 6) =       0.000456241868
  error estimate for blocks of size 2^( 7) =       0.000460089625

      target function =                  N/A
              le_mean =     -16.904371508939
             les_mean =     286.096932936988
             stat err =       0.000450586031
             autocorr =       1.288745068639
              std dev =       0.561318315772
             le_variance =       0.315078251621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315162302359
                                         uncertainty =       0.002455483413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315162302359
                                         uncertainty =       0.002455483413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396966288
  error estimate for blocks of size 2^( 2) =       0.000410673171
  error estimate for blocks of size 2^( 3) =       0.000425033375
  error estimate for blocks of size 2^( 4) =       0.000438110500
  error estimate for blocks of size 2^( 5) =       0.000447944678
  error estimate for blocks of size 2^( 6) =       0.000456264738
  error estimate for blocks of size 2^( 7) =       0.000460110591

      target function =                  N/A
              le_mean =     -16.904370719543
             les_mean =     286.089042508101
             stat err =       0.000450607627
             autocorr =       1.288516021766
              std dev =       0.561395108797
             le_variance =       0.315164468181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315116262684
                                         uncertainty =       0.002453250233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315116262684
                                         uncertainty =       0.002453250233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396937442
  error estimate for blocks of size 2^( 2) =       0.000410648103
  error estimate for blocks of size 2^( 3) =       0.000425011165
  error estimate for blocks of size 2^( 4) =       0.000438093237
  error estimate for blocks of size 2^( 5) =       0.000447927320
  error estimate for blocks of size 2^( 6) =       0.000456245573
  error estimate for blocks of size 2^( 7) =       0.000460090995

      target function =                  N/A
              le_mean =     -16.904370452563
             les_mean =     286.088668373950
             stat err =       0.000450589281
             autocorr =       1.288598376836
              std dev =       0.561354313596
             le_variance =       0.315118665392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315077991349
                                         uncertainty =       0.002450484879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315077991349
                                         uncertainty =       0.002450484879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396913557
  error estimate for blocks of size 2^( 2) =       0.000410629863
  error estimate for blocks of size 2^( 3) =       0.000424997625
  error estimate for blocks of size 2^( 4) =       0.000438086497
  error estimate for blocks of size 2^( 5) =       0.000447920497
  error estimate for blocks of size 2^( 6) =       0.000456235246
  error estimate for blocks of size 2^( 7) =       0.000460079960

      target function =                  N/A
              le_mean =     -16.904371820819
             les_mean =     286.088459281687
             stat err =       0.000450580550
             autocorr =       1.288703520836
              std dev =       0.561320535982
             le_variance =       0.315080744116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904371508939        initial
     5.6843e-01     5.6843e+00             4.6572e-04       -16.904370719543
     2.2737e+00     2.2737e+01             1.4292e-04       -16.904370452563
     9.0949e+00     9.0949e+01             3.7893e-05       -16.904371820819  <--

*****************************************************************************
Applying the update for shift_i =   9.0949e+00     and shift_s =   9.0949e+01
*****************************************************************************

  Execution time = 2.3743e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.006115e-01 3 1  ON 0
ci_0002                 7.000817e-01 3 1  ON 1
ci_0003                -3.021560e-02 3 1  ON 2
ci_0004                -3.056690e-02 3 1  ON 3
ci_0005                -3.370758e-02 3 1  ON 4
ci_0006                -3.357614e-02 3 1  ON 5
ci_0007                -2.249153e-02 3 1  ON 6
ci_0008                -2.320565e-02 3 1  ON 7
ci_0009                -2.011203e-02 3 1  ON 8
ci_0010                -1.979605e-02 3 1  ON 9
ci_0011                -1.487320e-02 3 1  ON 10
ci_0012                -1.559693e-02 3 1  ON 11
ci_0013                 1.571462e-02 3 1  ON 12
ci_0014                 1.538541e-02 3 1  ON 13
ci_0015                 1.597845e-02 3 1  ON 14
ci_0016                 1.581320e-02 3 1  ON 15
ci_0017                 1.357185e-02 3 1  ON 16
ci_0018                 1.333042e-02 3 1  ON 17
ci_0019                 1.209119e-02 3 1  ON 18
ci_0020                 1.193353e-02 3 1  ON 19
ci_0021                 6.571697e-03 3 1  ON 20
ci_0022                 7.572123e-03 3 1  ON 21
ci_0023                -1.170828e-02 3 1  ON 22
ci_0024                -1.141492e-02 3 1  ON 23
ci_0025                -1.163786e-02 3 1  ON 24
ci_0026                -1.183435e-02 3 1  ON 25
ci_0027                -1.106712e-02 3 1  ON 26
ci_0028                -1.096602e-02 3 1  ON 27
ci_0029                -9.945384e-03 3 1  ON 28
ci_0030                -1.064475e-02 3 1  ON 29
ci_0031                 1.860056e-02 3 1  ON 30
ci_0032                 1.862559e-02 3 1  ON 31
ci_0033                 1.087311e-02 3 1  ON 32
ci_0034                 1.055620e-02 3 1  ON 33
ci_0035                 7.061169e-03 3 1  ON 34
ci_0036                 6.628424e-03 3 1  ON 35
ci_0037                -1.139297e-02 3 1  ON 36
ci_0038                -1.087793e-02 3 1  ON 37
ci_0039                -4.164448e-03 3 1  ON 38
ci_0040                -4.184745e-03 3 1  ON 39
ci_0041                 8.162316e-03 3 1  ON 40
ci_0042                 8.876974e-03 3 1  ON 41
ci_0043                -1.394595e-02 3 1  ON 42
ci_0044                -1.331775e-02 3 1  ON 43
ci_0045                 8.534112e-03 3 1  ON 44
ci_0046                 8.100259e-03 3 1  ON 45
ci_0047                -3.401700e-03 3 1  ON 46
ci_0048                -3.356190e-03 3 1  ON 47
ci_0049                -6.153002e-03 3 1  ON 48
ci_0050                -7.090895e-03 3 1  ON 49
ci_0051                -5.002994e-03 3 1  ON 50
ci_0052                -4.831532e-03 3 1  ON 51
ci_0053                -6.397044e-03 3 1  ON 52
ci_0054                -6.112184e-03 3 1  ON 53
ci_0055                 7.302994e-03 3 1  ON 54
ci_0056                 6.870422e-03 3 1  ON 55
ci_0057                 5.196025e-03 3 1  ON 56
ci_0058                 5.774927e-03 3 1  ON 57
ci_0059                -5.926298e-03 3 1  ON 58
ci_0060                -5.505014e-03 3 1  ON 59
ci_0061                -4.039214e-03 3 1  ON 60
ci_0062                -3.524222e-03 3 1  ON 61
ci_0063                -8.480089e-03 3 1  ON 62
ci_0064                -8.530365e-03 3 1  ON 63
ci_0065                -6.329058e-03 3 1  ON 64
ci_0066                -6.904342e-03 3 1  ON 65
ci_0067                -6.184733e-03 3 1  ON 66
ci_0068                -5.747258e-03 3 1  ON 67
ci_0069                 5.476690e-03 3 1  ON 68
ci_0070                 5.205378e-03 3 1  ON 69
ci_0071                 4.655272e-03 3 1  ON 70
ci_0072                 4.470963e-03 3 1  ON 71
ci_0073                 5.163634e-03 3 1  ON 72
ci_0074                 5.414306e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9427
    reference variance = 0.257967
====================================================
  Execution time = 1.4625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2847e-01
  Total weights = 1.951588061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315695604403
                                         uncertainty =       0.002045989810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315695604403
                                         uncertainty =       0.002045989810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397313239
  error estimate for blocks of size 2^( 2) =       0.000411222029
  error estimate for blocks of size 2^( 3) =       0.000425336474
  error estimate for blocks of size 2^( 4) =       0.000438865764
  error estimate for blocks of size 2^( 5) =       0.000450182714
  error estimate for blocks of size 2^( 6) =       0.000455968374
  error estimate for blocks of size 2^( 7) =       0.000460025152

      target function =                  N/A
              le_mean =     -16.904145886423
             les_mean =     286.078618886714
             stat err =       0.000451260501
             autocorr =       1.289996610860
              std dev =       0.561885771024
             le_variance =       0.315715619679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690414588642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904145886440       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904146764051       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904146584584       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+00 is 1.352956e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904145886440       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904146122305       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904146070056       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+00 is 3.745035e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904145886440       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904145946533       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904145932976       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.6380e+01 is 9.617541e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7256e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.006206e-01 3 1  ON 0
ci_0002                 7.000715e-01 3 1  ON 1
ci_0003                -3.021764e-02 3 1  ON 2
ci_0004                -3.056504e-02 3 1  ON 3
ci_0005                -3.370455e-02 3 1  ON 4
ci_0006                -3.359004e-02 3 1  ON 5
ci_0007                -2.249438e-02 3 1  ON 6
ci_0008                -2.320347e-02 3 1  ON 7
ci_0009                -2.010709e-02 3 1  ON 8
ci_0010                -1.978854e-02 3 1  ON 9
ci_0011                -1.487556e-02 3 1  ON 10
ci_0012                -1.560687e-02 3 1  ON 11
ci_0013                 1.568446e-02 3 1  ON 12
ci_0014                 1.539509e-02 3 1  ON 13
ci_0015                 1.598714e-02 3 1  ON 14
ci_0016                 1.580398e-02 3 1  ON 15
ci_0017                 1.357684e-02 3 1  ON 16
ci_0018                 1.334778e-02 3 1  ON 17
ci_0019                 1.211851e-02 3 1  ON 18
ci_0020                 1.192539e-02 3 1  ON 19
ci_0021                 6.555990e-03 3 1  ON 20
ci_0022                 7.569238e-03 3 1  ON 21
ci_0023                -1.169763e-02 3 1  ON 22
ci_0024                -1.140585e-02 3 1  ON 23
ci_0025                -1.164503e-02 3 1  ON 24
ci_0026                -1.183030e-02 3 1  ON 25
ci_0027                -1.108148e-02 3 1  ON 26
ci_0028                -1.095347e-02 3 1  ON 27
ci_0029                -9.938741e-03 3 1  ON 28
ci_0030                -1.064609e-02 3 1  ON 29
ci_0031                 1.860050e-02 3 1  ON 30
ci_0032                 1.864728e-02 3 1  ON 31
ci_0033                 1.088728e-02 3 1  ON 32
ci_0034                 1.056288e-02 3 1  ON 33
ci_0035                 7.029267e-03 3 1  ON 34
ci_0036                 6.648412e-03 3 1  ON 35
ci_0037                -1.139218e-02 3 1  ON 36
ci_0038                -1.086709e-02 3 1  ON 37
ci_0039                -4.184634e-03 3 1  ON 38
ci_0040                -4.174189e-03 3 1  ON 39
ci_0041                 8.183899e-03 3 1  ON 40
ci_0042                 8.856545e-03 3 1  ON 41
ci_0043                -1.395857e-02 3 1  ON 42
ci_0044                -1.332244e-02 3 1  ON 43
ci_0045                 8.531420e-03 3 1  ON 44
ci_0046                 8.123368e-03 3 1  ON 45
ci_0047                -3.381397e-03 3 1  ON 46
ci_0048                -3.345152e-03 3 1  ON 47
ci_0049                -6.144327e-03 3 1  ON 48
ci_0050                -7.074291e-03 3 1  ON 49
ci_0051                -4.986688e-03 3 1  ON 50
ci_0052                -4.837639e-03 3 1  ON 51
ci_0053                -6.399047e-03 3 1  ON 52
ci_0054                -6.115642e-03 3 1  ON 53
ci_0055                 7.303707e-03 3 1  ON 54
ci_0056                 6.844086e-03 3 1  ON 55
ci_0057                 5.196167e-03 3 1  ON 56
ci_0058                 5.772753e-03 3 1  ON 57
ci_0059                -5.924740e-03 3 1  ON 58
ci_0060                -5.524981e-03 3 1  ON 59
ci_0061                -4.028788e-03 3 1  ON 60
ci_0062                -3.517583e-03 3 1  ON 61
ci_0063                -8.482252e-03 3 1  ON 62
ci_0064                -8.531249e-03 3 1  ON 63
ci_0065                -6.326016e-03 3 1  ON 64
ci_0066                -6.898606e-03 3 1  ON 65
ci_0067                -6.191221e-03 3 1  ON 66
ci_0068                -5.784708e-03 3 1  ON 67
ci_0069                 5.484434e-03 3 1  ON 68
ci_0070                 5.217316e-03 3 1  ON 69
ci_0071                 4.632526e-03 3 1  ON 70
ci_0072                 4.460065e-03 3 1  ON 71
ci_0073                 5.180144e-03 3 1  ON 72
ci_0074                 5.407306e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9246
    reference variance = 0.56159
====================================================
  Execution time = 1.3982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1884e-01
  Total weights = 1.9516e+06
  Execution time = 1.8673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308963036462
                                         uncertainty =       0.001778062453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308963036462
                                         uncertainty =       0.001778062453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393044519
  error estimate for blocks of size 2^( 2) =       0.000407003919
  error estimate for blocks of size 2^( 3) =       0.000421448897
  error estimate for blocks of size 2^( 4) =       0.000434214271
  error estimate for blocks of size 2^( 5) =       0.000446454582
  error estimate for blocks of size 2^( 6) =       0.000455058020
  error estimate for blocks of size 2^( 7) =       0.000458869778

      target function =                  N/A
              le_mean =     -16.904134762290
             les_mean =     286.068632539475
             stat err =       0.000448649163
             autocorr =       1.302957451461
              std dev =       0.555848889717
             le_variance =       0.308967988200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308983474036
                                         uncertainty =       0.001780473953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308983474036
                                         uncertainty =       0.001780473953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393057540
  error estimate for blocks of size 2^( 2) =       0.000407015738
  error estimate for blocks of size 2^( 3) =       0.000421460307
  error estimate for blocks of size 2^( 4) =       0.000434224243
  error estimate for blocks of size 2^( 5) =       0.000446465619
  error estimate for blocks of size 2^( 6) =       0.000455071018
  error estimate for blocks of size 2^( 7) =       0.000458884114

      target function =                  N/A
              le_mean =     -16.904135804656
             les_mean =     286.068674498974
             stat err =       0.000448661249
             autocorr =       1.302941322001
              std dev =       0.555867304124
             le_variance =       0.308988459795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308973580420
                                         uncertainty =       0.001779284455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308973580420
                                         uncertainty =       0.001779284455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393051238
  error estimate for blocks of size 2^( 2) =       0.000407009981
  error estimate for blocks of size 2^( 3) =       0.000421454758
  error estimate for blocks of size 2^( 4) =       0.000434219368
  error estimate for blocks of size 2^( 5) =       0.000446460219
  error estimate for blocks of size 2^( 6) =       0.000455064865
  error estimate for blocks of size 2^( 7) =       0.000458877428

      target function =                  N/A
              le_mean =     -16.904135248106
             les_mean =     286.068629463664
             stat err =       0.000448655470
             autocorr =       1.302949541323
              std dev =       0.555858391168
             le_variance =       0.308978551032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308964290220
                                         uncertainty =       0.001778213582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308964290220
                                         uncertainty =       0.001778213582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393045318
  error estimate for blocks of size 2^( 2) =       0.000407004633
  error estimate for blocks of size 2^( 3) =       0.000421449588
  error estimate for blocks of size 2^( 4) =       0.000434214865
  error estimate for blocks of size 2^( 5) =       0.000446455247
  error estimate for blocks of size 2^( 6) =       0.000455058848
  error estimate for blocks of size 2^( 7) =       0.000458870713

      target function =                  N/A
              le_mean =     -16.904134810527
             les_mean =     286.068626882505
             stat err =       0.000448649918
             autocorr =       1.302956542070
              std dev =       0.555850019702
             le_variance =       0.308969244403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904134762290        initial
     2.2737e+00     2.2737e+01             1.3530e-04       -16.904135804656  <--
     9.0949e+00     9.0949e+01             3.7450e-05       -16.904135248106
     3.6380e+01     3.6380e+02             9.6175e-06       -16.904134810527

*****************************************************************************
Applying the update for shift_i =   2.2737e+00     and shift_s =   2.2737e+01
*****************************************************************************

  Execution time = 2.3420e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.006477e-01 3 1  ON 0
ci_0002                 7.000411e-01 3 1  ON 1
ci_0003                -3.022328e-02 3 1  ON 2
ci_0004                -3.055972e-02 3 1  ON 3
ci_0005                -3.369529e-02 3 1  ON 4
ci_0006                -3.362933e-02 3 1  ON 5
ci_0007                -2.250264e-02 3 1  ON 6
ci_0008                -2.319765e-02 3 1  ON 7
ci_0009                -2.009412e-02 3 1  ON 8
ci_0010                -1.976809e-02 3 1  ON 9
ci_0011                -1.488203e-02 3 1  ON 10
ci_0012                -1.563380e-02 3 1  ON 11
ci_0013                 1.560165e-02 3 1  ON 12
ci_0014                 1.542176e-02 3 1  ON 13
ci_0015                 1.601065e-02 3 1  ON 14
ci_0016                 1.577882e-02 3 1  ON 15
ci_0017                 1.359050e-02 3 1  ON 16
ci_0018                 1.339511e-02 3 1  ON 17
ci_0019                 1.219337e-02 3 1  ON 18
ci_0020                 1.190270e-02 3 1  ON 19
ci_0021                 6.510667e-03 3 1  ON 20
ci_0022                 7.561361e-03 3 1  ON 21
ci_0023                -1.166884e-02 3 1  ON 22
ci_0024                -1.138071e-02 3 1  ON 23
ci_0025                -1.166492e-02 3 1  ON 24
ci_0026                -1.181931e-02 3 1  ON 25
ci_0027                -1.112098e-02 3 1  ON 26
ci_0028                -1.091916e-02 3 1  ON 27
ci_0029                -9.920726e-03 3 1  ON 28
ci_0030                -1.064947e-02 3 1  ON 29
ci_0031                 1.860075e-02 3 1  ON 30
ci_0032                 1.870877e-02 3 1  ON 31
ci_0033                 1.092768e-02 3 1  ON 32
ci_0034                 1.058173e-02 3 1  ON 33
ci_0035                 6.941205e-03 3 1  ON 34
ci_0036                 6.703651e-03 3 1  ON 35
ci_0037                -1.138985e-02 3 1  ON 36
ci_0038                -1.083690e-02 3 1  ON 37
ci_0039                -4.236471e-03 3 1  ON 38
ci_0040                -4.147038e-03 3 1  ON 39
ci_0041                 8.242836e-03 3 1  ON 40
ci_0042                 8.800642e-03 3 1  ON 41
ci_0043                -1.399405e-02 3 1  ON 42
ci_0044                -1.333584e-02 3 1  ON 43
ci_0045                 8.524315e-03 3 1  ON 44
ci_0046                 8.188572e-03 3 1  ON 45
ci_0047                -3.328993e-03 3 1  ON 46
ci_0048                -3.316612e-03 3 1  ON 47
ci_0049                -6.120668e-03 3 1  ON 48
ci_0050                -7.028502e-03 3 1  ON 49
ci_0051                -4.944233e-03 3 1  ON 50
ci_0052                -4.853378e-03 3 1  ON 51
ci_0053                -6.404072e-03 3 1  ON 52
ci_0054                -6.124857e-03 3 1  ON 53
ci_0055                 7.305490e-03 3 1  ON 54
ci_0056                 6.770320e-03 3 1  ON 55
ci_0057                 5.196756e-03 3 1  ON 56
ci_0058                 5.766643e-03 3 1  ON 57
ci_0059                -5.920877e-03 3 1  ON 58
ci_0060                -5.577392e-03 3 1  ON 59
ci_0061                -4.000128e-03 3 1  ON 60
ci_0062                -3.499191e-03 3 1  ON 61
ci_0063                -8.488025e-03 3 1  ON 62
ci_0064                -8.533734e-03 3 1  ON 63
ci_0065                -6.317740e-03 3 1  ON 64
ci_0066                -6.882923e-03 3 1  ON 65
ci_0067                -6.208181e-03 3 1  ON 66
ci_0068                -5.882554e-03 3 1  ON 67
ci_0069                 5.504817e-03 3 1  ON 68
ci_0070                 5.248526e-03 3 1  ON 69
ci_0071                 4.570118e-03 3 1  ON 70
ci_0072                 4.430660e-03 3 1  ON 71
ci_0073                 5.223478e-03 3 1  ON 72
ci_0074                 5.388835e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.284775
====================================================
  Execution time = 1.4624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3300e-01
  Total weights = 1.951963808e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314101602321
                                         uncertainty =       0.002638054465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314101602321
                                         uncertainty =       0.002638054465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396260783
  error estimate for blocks of size 2^( 2) =       0.000409648188
  error estimate for blocks of size 2^( 3) =       0.000423766658
  error estimate for blocks of size 2^( 4) =       0.000435633953
  error estimate for blocks of size 2^( 5) =       0.000445153463
  error estimate for blocks of size 2^( 6) =       0.000451413954
  error estimate for blocks of size 2^( 7) =       0.000454387476

      target function =                  N/A
              le_mean =     -16.903768349352
             les_mean =     286.070383697288
             stat err =       0.000446647211
             autocorr =       1.270477759182
              std dev =       0.560397373645
             le_variance =       0.314045216388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690376834935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903768349336       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903770610688       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903770740755       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903770682780       residual = 4.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e-01 is 5.080982e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903768349336       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903769065127       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903769077254       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+00 is 1.587078e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903768349336       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903768541038       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903768542064       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903768540301       residual = 1.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.0949e+00 is 4.225147e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7220e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.006454e-01 3 1  ON 0
ci_0002                 7.000373e-01 3 1  ON 1
ci_0003                -3.030699e-02 3 1  ON 2
ci_0004                -3.052740e-02 3 1  ON 3
ci_0005                -3.369646e-02 3 1  ON 4
ci_0006                -3.367309e-02 3 1  ON 5
ci_0007                -2.253970e-02 3 1  ON 6
ci_0008                -2.310367e-02 3 1  ON 7
ci_0009                -2.011328e-02 3 1  ON 8
ci_0010                -1.975876e-02 3 1  ON 9
ci_0011                -1.491582e-02 3 1  ON 10
ci_0012                -1.567437e-02 3 1  ON 11
ci_0013                 1.566611e-02 3 1  ON 12
ci_0014                 1.544535e-02 3 1  ON 13
ci_0015                 1.596841e-02 3 1  ON 14
ci_0016                 1.585213e-02 3 1  ON 15
ci_0017                 1.365230e-02 3 1  ON 16
ci_0018                 1.337473e-02 3 1  ON 17
ci_0019                 1.203466e-02 3 1  ON 18
ci_0020                 1.190965e-02 3 1  ON 19
ci_0021                 6.597953e-03 3 1  ON 20
ci_0022                 7.600962e-03 3 1  ON 21
ci_0023                -1.155447e-02 3 1  ON 22
ci_0024                -1.141357e-02 3 1  ON 23
ci_0025                -1.162201e-02 3 1  ON 24
ci_0026                -1.188042e-02 3 1  ON 25
ci_0027                -1.127916e-02 3 1  ON 26
ci_0028                -1.092544e-02 3 1  ON 27
ci_0029                -1.003152e-02 3 1  ON 28
ci_0030                -1.068549e-02 3 1  ON 29
ci_0031                 1.860139e-02 3 1  ON 30
ci_0032                 1.879461e-02 3 1  ON 31
ci_0033                 1.084021e-02 3 1  ON 32
ci_0034                 1.057309e-02 3 1  ON 33
ci_0035                 6.883140e-03 3 1  ON 34
ci_0036                 6.711617e-03 3 1  ON 35
ci_0037                -1.140721e-02 3 1  ON 36
ci_0038                -1.079538e-02 3 1  ON 37
ci_0039                -4.214257e-03 3 1  ON 38
ci_0040                -4.055740e-03 3 1  ON 39
ci_0041                 8.290273e-03 3 1  ON 40
ci_0042                 8.862624e-03 3 1  ON 41
ci_0043                -1.404746e-02 3 1  ON 42
ci_0044                -1.329979e-02 3 1  ON 43
ci_0045                 8.437472e-03 3 1  ON 44
ci_0046                 8.211738e-03 3 1  ON 45
ci_0047                -3.322587e-03 3 1  ON 46
ci_0048                -3.330606e-03 3 1  ON 47
ci_0049                -6.176873e-03 3 1  ON 48
ci_0050                -6.936963e-03 3 1  ON 49
ci_0051                -4.880008e-03 3 1  ON 50
ci_0052                -4.783693e-03 3 1  ON 51
ci_0053                -6.293973e-03 3 1  ON 52
ci_0054                -6.002997e-03 3 1  ON 53
ci_0055                 7.279415e-03 3 1  ON 54
ci_0056                 6.792682e-03 3 1  ON 55
ci_0057                 5.224755e-03 3 1  ON 56
ci_0058                 5.750956e-03 3 1  ON 57
ci_0059                -5.828322e-03 3 1  ON 58
ci_0060                -5.623505e-03 3 1  ON 59
ci_0061                -4.016670e-03 3 1  ON 60
ci_0062                -3.557275e-03 3 1  ON 61
ci_0063                -8.555466e-03 3 1  ON 62
ci_0064                -8.552868e-03 3 1  ON 63
ci_0065                -6.351810e-03 3 1  ON 64
ci_0066                -6.783237e-03 3 1  ON 65
ci_0067                -6.155776e-03 3 1  ON 66
ci_0068                -5.834229e-03 3 1  ON 67
ci_0069                 5.487595e-03 3 1  ON 68
ci_0070                 5.278643e-03 3 1  ON 69
ci_0071                 4.581783e-03 3 1  ON 70
ci_0072                 4.522321e-03 3 1  ON 71
ci_0073                 5.200476e-03 3 1  ON 72
ci_0074                 5.282384e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9562
    reference variance = 0.290798
====================================================
  Execution time = 1.3975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2046e-01
  Total weights = 1.9516e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310711814784
                                         uncertainty =       0.002004365165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310711814784
                                         uncertainty =       0.002004365165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394084070
  error estimate for blocks of size 2^( 2) =       0.000407946417
  error estimate for blocks of size 2^( 3) =       0.000422527238
  error estimate for blocks of size 2^( 4) =       0.000435557327
  error estimate for blocks of size 2^( 5) =       0.000446391521
  error estimate for blocks of size 2^( 6) =       0.000454787909
  error estimate for blocks of size 2^( 7) =       0.000457673213

      target function =                  N/A
              le_mean =     -16.904588953693
             les_mean =     286.085843083458
             stat err =       0.000448602493
             autocorr =       1.295822767272
              std dev =       0.557319035876
             le_variance =       0.310604507749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310523516844
                                         uncertainty =       0.002005284967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310523516844
                                         uncertainty =       0.002005284967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393964421
  error estimate for blocks of size 2^( 2) =       0.000407832787
  error estimate for blocks of size 2^( 3) =       0.000422414298
  error estimate for blocks of size 2^( 4) =       0.000435461820
  error estimate for blocks of size 2^( 5) =       0.000446295942
  error estimate for blocks of size 2^( 6) =       0.000454721150
  error estimate for blocks of size 2^( 7) =       0.000457581945

      target function =                  N/A
              le_mean =     -16.904593880290
             les_mean =     286.137008181524
             stat err =       0.000448515214
             autocorr =       1.296105500655
              std dev =       0.557149827431
             le_variance =       0.310415930206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310558513356
                                         uncertainty =       0.002004346543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310558513356
                                         uncertainty =       0.002004346543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393986722
  error estimate for blocks of size 2^( 2) =       0.000407853855
  error estimate for blocks of size 2^( 3) =       0.000422435993
  error estimate for blocks of size 2^( 4) =       0.000435474397
  error estimate for blocks of size 2^( 5) =       0.000446311481
  error estimate for blocks of size 2^( 6) =       0.000454729517
  error estimate for blocks of size 2^( 7) =       0.000457594344

      target function =                  N/A
              le_mean =     -16.904593135247
             les_mean =     286.090532569582
             stat err =       0.000448527434
             autocorr =       1.296029396195
              std dev =       0.557181366067
             le_variance =       0.310451074692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310688288477
                                         uncertainty =       0.002004306077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310688288477
                                         uncertainty =       0.002004306077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394069135
  error estimate for blocks of size 2^( 2) =       0.000407932161
  error estimate for blocks of size 2^( 3) =       0.000422513178
  error estimate for blocks of size 2^( 4) =       0.000435544219
  error estimate for blocks of size 2^( 5) =       0.000446378681
  error estimate for blocks of size 2^( 6) =       0.000454778203
  error estimate for blocks of size 2^( 7) =       0.000457660563

      target function =                  N/A
              le_mean =     -16.904589225166
             les_mean =     286.085672215986
             stat err =       0.000448590417
             autocorr =       1.295851218778
              std dev =       0.557297915108
             le_variance =       0.310580966183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904588953693        initial
     5.6843e-01     5.6843e+00             5.0810e-04       -16.904593880290  <--
     2.2737e+00     2.2737e+01             1.5871e-04       -16.904593135247
     9.0949e+00     9.0949e+01             4.2251e-05       -16.904589225166

*****************************************************************************
Applying the update for shift_i =   5.6843e-01     and shift_s =   5.6843e+00
*****************************************************************************

  Execution time = 2.3421e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.006416e-01 3 1  ON 0
ci_0002                 7.000254e-01 3 1  ON 1
ci_0003                -3.049340e-02 3 1  ON 2
ci_0004                -3.045384e-02 3 1  ON 3
ci_0005                -3.370283e-02 3 1  ON 4
ci_0006                -3.378724e-02 3 1  ON 5
ci_0007                -2.263304e-02 3 1  ON 6
ci_0008                -2.285724e-02 3 1  ON 7
ci_0009                -2.015121e-02 3 1  ON 8
ci_0010                -1.973771e-02 3 1  ON 9
ci_0011                -1.499524e-02 3 1  ON 10
ci_0012                -1.576430e-02 3 1  ON 11
ci_0013                 1.579938e-02 3 1  ON 12
ci_0014                 1.549509e-02 3 1  ON 13
ci_0015                 1.587076e-02 3 1  ON 14
ci_0016                 1.601246e-02 3 1  ON 15
ci_0017                 1.378607e-02 3 1  ON 16
ci_0018                 1.333056e-02 3 1  ON 17
ci_0019                 1.168527e-02 3 1  ON 18
ci_0020                 1.192694e-02 3 1  ON 19
ci_0021                 6.834594e-03 3 1  ON 20
ci_0022                 7.705219e-03 3 1  ON 21
ci_0023                -1.131168e-02 3 1  ON 22
ci_0024                -1.148154e-02 3 1  ON 23
ci_0025                -1.152897e-02 3 1  ON 24
ci_0026                -1.201285e-02 3 1  ON 25
ci_0027                -1.162548e-02 3 1  ON 26
ci_0028                -1.093542e-02 3 1  ON 27
ci_0029                -1.027093e-02 3 1  ON 28
ci_0030                -1.076311e-02 3 1  ON 29
ci_0031                 1.860361e-02 3 1  ON 30
ci_0032                 1.900503e-02 3 1  ON 31
ci_0033                 1.062091e-02 3 1  ON 32
ci_0034                 1.055148e-02 3 1  ON 33
ci_0035                 6.752362e-03 3 1  ON 34
ci_0036                 6.732241e-03 3 1  ON 35
ci_0037                -1.144768e-02 3 1  ON 36
ci_0038                -1.070153e-02 3 1  ON 37
ci_0039                -4.174414e-03 3 1  ON 38
ci_0040                -3.891354e-03 3 1  ON 39
ci_0041                 8.392058e-03 3 1  ON 40
ci_0042                 8.995823e-03 3 1  ON 41
ci_0043                -1.419524e-02 3 1  ON 42
ci_0044                -1.321175e-02 3 1  ON 43
ci_0045                 8.229129e-03 3 1  ON 44
ci_0046                 8.265919e-03 3 1  ON 45
ci_0047                -3.310284e-03 3 1  ON 46
ci_0048                -3.357389e-03 3 1  ON 47
ci_0049                -6.302668e-03 3 1  ON 48
ci_0050                -6.737450e-03 3 1  ON 49
ci_0051                -4.756234e-03 3 1  ON 50
ci_0052                -4.652890e-03 3 1  ON 51
ci_0053                -6.080111e-03 3 1  ON 52
ci_0054                -5.769327e-03 3 1  ON 53
ci_0055                 7.219356e-03 3 1  ON 54
ci_0056                 6.848214e-03 3 1  ON 55
ci_0057                 5.284407e-03 3 1  ON 56
ci_0058                 5.715621e-03 3 1  ON 57
ci_0059                -5.651269e-03 3 1  ON 58
ci_0060                -5.712697e-03 3 1  ON 59
ci_0061                -4.053445e-03 3 1  ON 60
ci_0062                -3.688166e-03 3 1  ON 61
ci_0063                -8.685947e-03 3 1  ON 62
ci_0064                -8.593063e-03 3 1  ON 63
ci_0065                -6.421373e-03 3 1  ON 64
ci_0066                -6.571921e-03 3 1  ON 65
ci_0067                -6.062155e-03 3 1  ON 66
ci_0068                -5.746830e-03 3 1  ON 67
ci_0069                 5.456448e-03 3 1  ON 68
ci_0070                 5.336009e-03 3 1  ON 69
ci_0071                 4.605109e-03 3 1  ON 70
ci_0072                 4.716565e-03 3 1  ON 71
ci_0073                 5.154722e-03 3 1  ON 72
ci_0074                 5.082637e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.556617
====================================================
  Execution time = 1.4464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2247e-01
  Total weights = 1.951660435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312239029583
                                         uncertainty =       0.002046726339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312239029583
                                         uncertainty =       0.002046726339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395070065
  error estimate for blocks of size 2^( 2) =       0.000408743909
  error estimate for blocks of size 2^( 3) =       0.000423087198
  error estimate for blocks of size 2^( 4) =       0.000436177108
  error estimate for blocks of size 2^( 5) =       0.000446696797
  error estimate for blocks of size 2^( 6) =       0.000450868140
  error estimate for blocks of size 2^( 7) =       0.000455015063

      target function =                  N/A
              le_mean =     -16.903814676377
             les_mean =     286.061420680948
             stat err =       0.000447189277
             autocorr =       1.281251879497
              std dev =       0.558713443486
             le_variance =       0.312160711932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690381467638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-01, overlap shift 1.4211e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903814676374       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903820364957       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903818091394       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903818330482       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903818342016       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e-01 is 7.116214e-04

solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903814676374       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903817290131       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903816635221       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903816697006       residual = 3.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e-01 is 3.228521e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903814676374       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903815502962       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903815378174       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+00 is 1.013989e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7082e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.006952e-01 3 1  ON 0
ci_0002                 6.999877e-01 3 1  ON 1
ci_0003                -3.061148e-02 3 1  ON 2
ci_0004                -3.026771e-02 3 1  ON 3
ci_0005                -3.375143e-02 3 1  ON 4
ci_0006                -3.386953e-02 3 1  ON 5
ci_0007                -2.257159e-02 3 1  ON 6
ci_0008                -2.303071e-02 3 1  ON 7
ci_0009                -2.006989e-02 3 1  ON 8
ci_0010                -1.983047e-02 3 1  ON 9
ci_0011                -1.504893e-02 3 1  ON 10
ci_0012                -1.561966e-02 3 1  ON 11
ci_0013                 1.612223e-02 3 1  ON 12
ci_0014                 1.530443e-02 3 1  ON 13
ci_0015                 1.613481e-02 3 1  ON 14
ci_0016                 1.570611e-02 3 1  ON 15
ci_0017                 1.384108e-02 3 1  ON 16
ci_0018                 1.336261e-02 3 1  ON 17
ci_0019                 1.158801e-02 3 1  ON 18
ci_0020                 1.196580e-02 3 1  ON 19
ci_0021                 6.918774e-03 3 1  ON 20
ci_0022                 7.642288e-03 3 1  ON 21
ci_0023                -1.138161e-02 3 1  ON 22
ci_0024                -1.129558e-02 3 1  ON 23
ci_0025                -1.139655e-02 3 1  ON 24
ci_0026                -1.199631e-02 3 1  ON 25
ci_0027                -1.155031e-02 3 1  ON 26
ci_0028                -1.096109e-02 3 1  ON 27
ci_0029                -1.034967e-02 3 1  ON 28
ci_0030                -1.064844e-02 3 1  ON 29
ci_0031                 1.847365e-02 3 1  ON 30
ci_0032                 1.910333e-02 3 1  ON 31
ci_0033                 1.038903e-02 3 1  ON 32
ci_0034                 1.032766e-02 3 1  ON 33
ci_0035                 6.562523e-03 3 1  ON 34
ci_0036                 6.649697e-03 3 1  ON 35
ci_0037                -1.114049e-02 3 1  ON 36
ci_0038                -1.076135e-02 3 1  ON 37
ci_0039                -4.127268e-03 3 1  ON 38
ci_0040                -4.021530e-03 3 1  ON 39
ci_0041                 8.421819e-03 3 1  ON 40
ci_0042                 9.101202e-03 3 1  ON 41
ci_0043                -1.407676e-02 3 1  ON 42
ci_0044                -1.320012e-02 3 1  ON 43
ci_0045                 8.466313e-03 3 1  ON 44
ci_0046                 8.132543e-03 3 1  ON 45
ci_0047                -3.390674e-03 3 1  ON 46
ci_0048                -3.260793e-03 3 1  ON 47
ci_0049                -6.173983e-03 3 1  ON 48
ci_0050                -6.693629e-03 3 1  ON 49
ci_0051                -4.798902e-03 3 1  ON 50
ci_0052                -4.742178e-03 3 1  ON 51
ci_0053                -5.937368e-03 3 1  ON 52
ci_0054                -5.815055e-03 3 1  ON 53
ci_0055                 7.060552e-03 3 1  ON 54
ci_0056                 6.968104e-03 3 1  ON 55
ci_0057                 5.218139e-03 3 1  ON 56
ci_0058                 5.671088e-03 3 1  ON 57
ci_0059                -5.873504e-03 3 1  ON 58
ci_0060                -5.861558e-03 3 1  ON 59
ci_0061                -4.095750e-03 3 1  ON 60
ci_0062                -3.705954e-03 3 1  ON 61
ci_0063                -8.415071e-03 3 1  ON 62
ci_0064                -8.669068e-03 3 1  ON 63
ci_0065                -6.502368e-03 3 1  ON 64
ci_0066                -6.362303e-03 3 1  ON 65
ci_0067                -6.089977e-03 3 1  ON 66
ci_0068                -5.698881e-03 3 1  ON 67
ci_0069                 5.334236e-03 3 1  ON 68
ci_0070                 5.464540e-03 3 1  ON 69
ci_0071                 4.544063e-03 3 1  ON 70
ci_0072                 4.633922e-03 3 1  ON 71
ci_0073                 5.032819e-03 3 1  ON 72
ci_0074                 5.182997e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8634
    reference variance = 0.407757
====================================================
  Execution time = 1.4246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2807e-01
  Total weights = 1.9520e+06
  Execution time = 1.8681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312609112757
                                         uncertainty =       0.002188692240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312609112757
                                         uncertainty =       0.002188692240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395339115
  error estimate for blocks of size 2^( 2) =       0.000409265599
  error estimate for blocks of size 2^( 3) =       0.000423170895
  error estimate for blocks of size 2^( 4) =       0.000436686281
  error estimate for blocks of size 2^( 5) =       0.000449057794
  error estimate for blocks of size 2^( 6) =       0.000456072164
  error estimate for blocks of size 2^( 7) =       0.000463663001

      target function =                  N/A
              le_mean =     -16.905273207308
             les_mean =     286.116755961286
             stat err =       0.000451369810
             autocorr =       1.303543246793
              std dev =       0.559093938382
             le_variance =       0.312586031936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312462410055
                                         uncertainty =       0.002174088422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312462410055
                                         uncertainty =       0.002174088422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395246865
  error estimate for blocks of size 2^( 2) =       0.000409187214
  error estimate for blocks of size 2^( 3) =       0.000423101219
  error estimate for blocks of size 2^( 4) =       0.000436624349
  error estimate for blocks of size 2^( 5) =       0.000449008352
  error estimate for blocks of size 2^( 6) =       0.000456028590
  error estimate for blocks of size 2^( 7) =       0.000463650918

      target function =                  N/A
              le_mean =     -16.905256123888
             les_mean =     286.117751150889
             stat err =       0.000451328052
             autocorr =       1.303910515434
              std dev =       0.558963477361
             le_variance =       0.312440169024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312488400952
                                         uncertainty =       0.002176919337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312488400952
                                         uncertainty =       0.002176919337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395263307
  error estimate for blocks of size 2^( 2) =       0.000409201452
  error estimate for blocks of size 2^( 3) =       0.000423114214
  error estimate for blocks of size 2^( 4) =       0.000436635289
  error estimate for blocks of size 2^( 5) =       0.000449016839
  error estimate for blocks of size 2^( 6) =       0.000456037647
  error estimate for blocks of size 2^( 7) =       0.000463655819

      target function =                  N/A
              le_mean =     -16.905256244104
             les_mean =     286.115994412694
             stat err =       0.000451336399
             autocorr =       1.303850263376
              std dev =       0.558986729251
             le_variance =       0.312466163478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312581538324
                                         uncertainty =       0.002186680609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312581538324
                                         uncertainty =       0.002186680609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395321767
  error estimate for blocks of size 2^( 2) =       0.000409250468
  error estimate for blocks of size 2^( 3) =       0.000423157432
  error estimate for blocks of size 2^( 4) =       0.000436674078
  error estimate for blocks of size 2^( 5) =       0.000449047409
  error estimate for blocks of size 2^( 6) =       0.000456062621
  error estimate for blocks of size 2^( 7) =       0.000463660476

      target function =                  N/A
              le_mean =     -16.905269403176
             les_mean =     286.124308187667
             stat err =       0.000451361146
             autocorr =       1.303607606502
              std dev =       0.559069404956
             le_variance =       0.312558599558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905273207308        initial  <--
     1.4211e-01     1.4211e+00             7.1162e-04       -16.905256123888
     5.6843e-01     5.6843e+00             3.2285e-04       -16.905256244104
     2.2737e+00     2.2737e+01             1.0140e-04       -16.905269403176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6706
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.006416e-01 3 1  ON 0
ci_0002                 7.000254e-01 3 1  ON 1
ci_0003                -3.049340e-02 3 1  ON 2
ci_0004                -3.045384e-02 3 1  ON 3
ci_0005                -3.370283e-02 3 1  ON 4
ci_0006                -3.378724e-02 3 1  ON 5
ci_0007                -2.263304e-02 3 1  ON 6
ci_0008                -2.285724e-02 3 1  ON 7
ci_0009                -2.015121e-02 3 1  ON 8
ci_0010                -1.973771e-02 3 1  ON 9
ci_0011                -1.499524e-02 3 1  ON 10
ci_0012                -1.576430e-02 3 1  ON 11
ci_0013                 1.579938e-02 3 1  ON 12
ci_0014                 1.549509e-02 3 1  ON 13
ci_0015                 1.587076e-02 3 1  ON 14
ci_0016                 1.601246e-02 3 1  ON 15
ci_0017                 1.378607e-02 3 1  ON 16
ci_0018                 1.333056e-02 3 1  ON 17
ci_0019                 1.168527e-02 3 1  ON 18
ci_0020                 1.192694e-02 3 1  ON 19
ci_0021                 6.834594e-03 3 1  ON 20
ci_0022                 7.705219e-03 3 1  ON 21
ci_0023                -1.131168e-02 3 1  ON 22
ci_0024                -1.148154e-02 3 1  ON 23
ci_0025                -1.152897e-02 3 1  ON 24
ci_0026                -1.201285e-02 3 1  ON 25
ci_0027                -1.162548e-02 3 1  ON 26
ci_0028                -1.093542e-02 3 1  ON 27
ci_0029                -1.027093e-02 3 1  ON 28
ci_0030                -1.076311e-02 3 1  ON 29
ci_0031                 1.860361e-02 3 1  ON 30
ci_0032                 1.900503e-02 3 1  ON 31
ci_0033                 1.062091e-02 3 1  ON 32
ci_0034                 1.055148e-02 3 1  ON 33
ci_0035                 6.752362e-03 3 1  ON 34
ci_0036                 6.732241e-03 3 1  ON 35
ci_0037                -1.144768e-02 3 1  ON 36
ci_0038                -1.070153e-02 3 1  ON 37
ci_0039                -4.174414e-03 3 1  ON 38
ci_0040                -3.891354e-03 3 1  ON 39
ci_0041                 8.392058e-03 3 1  ON 40
ci_0042                 8.995823e-03 3 1  ON 41
ci_0043                -1.419524e-02 3 1  ON 42
ci_0044                -1.321175e-02 3 1  ON 43
ci_0045                 8.229129e-03 3 1  ON 44
ci_0046                 8.265919e-03 3 1  ON 45
ci_0047                -3.310284e-03 3 1  ON 46
ci_0048                -3.357389e-03 3 1  ON 47
ci_0049                -6.302668e-03 3 1  ON 48
ci_0050                -6.737450e-03 3 1  ON 49
ci_0051                -4.756234e-03 3 1  ON 50
ci_0052                -4.652890e-03 3 1  ON 51
ci_0053                -6.080111e-03 3 1  ON 52
ci_0054                -5.769327e-03 3 1  ON 53
ci_0055                 7.219356e-03 3 1  ON 54
ci_0056                 6.848214e-03 3 1  ON 55
ci_0057                 5.284407e-03 3 1  ON 56
ci_0058                 5.715621e-03 3 1  ON 57
ci_0059                -5.651269e-03 3 1  ON 58
ci_0060                -5.712697e-03 3 1  ON 59
ci_0061                -4.053445e-03 3 1  ON 60
ci_0062                -3.688166e-03 3 1  ON 61
ci_0063                -8.685947e-03 3 1  ON 62
ci_0064                -8.593063e-03 3 1  ON 63
ci_0065                -6.421373e-03 3 1  ON 64
ci_0066                -6.571921e-03 3 1  ON 65
ci_0067                -6.062155e-03 3 1  ON 66
ci_0068                -5.746830e-03 3 1  ON 67
ci_0069                 5.456448e-03 3 1  ON 68
ci_0070                 5.336009e-03 3 1  ON 69
ci_0071                 4.605109e-03 3 1  ON 70
ci_0072                 4.716565e-03 3 1  ON 71
ci_0073                 5.154722e-03 3 1  ON 72
ci_0074                 5.082637e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0759e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8741
    reference variance = 0.199852
====================================================
  Execution time = 1.4359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2857e-01
  Total weights = 1.951918142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314650790570
                                         uncertainty =       0.005595442382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314650790570
                                         uncertainty =       0.005595442382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396652603
  error estimate for blocks of size 2^( 2) =       0.000410870615
  error estimate for blocks of size 2^( 3) =       0.000424915852
  error estimate for blocks of size 2^( 4) =       0.000437459724
  error estimate for blocks of size 2^( 5) =       0.000448255943
  error estimate for blocks of size 2^( 6) =       0.000455636105
  error estimate for blocks of size 2^( 7) =       0.000461522614

      target function =                  N/A
              le_mean =     -16.903912837418
             les_mean =     286.070838878283
             stat err =       0.000450718597
             autocorr =       1.291190548731
              std dev =       0.560951490016
             le_variance =       0.314666574152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690391283742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903912837414       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903913637249       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903913602316       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903913576887       residual = 1.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 2.161140e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903912837414       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903913059326       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903913057141       residual = 8.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 5.899959e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903912837414       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903912894458       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903912894467       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2737e+01 is 1.508692e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6966e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.006325e-01 3 1  ON 0
ci_0002                 7.000298e-01 3 1  ON 1
ci_0003                -3.050137e-02 3 1  ON 2
ci_0004                -3.044774e-02 3 1  ON 3
ci_0005                -3.368425e-02 3 1  ON 4
ci_0006                -3.381652e-02 3 1  ON 5
ci_0007                -2.264805e-02 3 1  ON 6
ci_0008                -2.287524e-02 3 1  ON 7
ci_0009                -2.016336e-02 3 1  ON 8
ci_0010                -1.972411e-02 3 1  ON 9
ci_0011                -1.501052e-02 3 1  ON 10
ci_0012                -1.577006e-02 3 1  ON 11
ci_0013                 1.581361e-02 3 1  ON 12
ci_0014                 1.553630e-02 3 1  ON 13
ci_0015                 1.586857e-02 3 1  ON 14
ci_0016                 1.598084e-02 3 1  ON 15
ci_0017                 1.378510e-02 3 1  ON 16
ci_0018                 1.338533e-02 3 1  ON 17
ci_0019                 1.165551e-02 3 1  ON 18
ci_0020                 1.191036e-02 3 1  ON 19
ci_0021                 6.874172e-03 3 1  ON 20
ci_0022                 7.730221e-03 3 1  ON 21
ci_0023                -1.135659e-02 3 1  ON 22
ci_0024                -1.145910e-02 3 1  ON 23
ci_0025                -1.155215e-02 3 1  ON 24
ci_0026                -1.203735e-02 3 1  ON 25
ci_0027                -1.158241e-02 3 1  ON 26
ci_0028                -1.091378e-02 3 1  ON 27
ci_0029                -1.032851e-02 3 1  ON 28
ci_0030                -1.076688e-02 3 1  ON 29
ci_0031                 1.857813e-02 3 1  ON 30
ci_0032                 1.898727e-02 3 1  ON 31
ci_0033                 1.060271e-02 3 1  ON 32
ci_0034                 1.053518e-02 3 1  ON 33
ci_0035                 6.766122e-03 3 1  ON 34
ci_0036                 6.726581e-03 3 1  ON 35
ci_0037                -1.149221e-02 3 1  ON 36
ci_0038                -1.076053e-02 3 1  ON 37
ci_0039                -4.176269e-03 3 1  ON 38
ci_0040                -3.882657e-03 3 1  ON 39
ci_0041                 8.368061e-03 3 1  ON 40
ci_0042                 8.982622e-03 3 1  ON 41
ci_0043                -1.420445e-02 3 1  ON 42
ci_0044                -1.322098e-02 3 1  ON 43
ci_0045                 8.218657e-03 3 1  ON 44
ci_0046                 8.301161e-03 3 1  ON 45
ci_0047                -3.285936e-03 3 1  ON 46
ci_0048                -3.384762e-03 3 1  ON 47
ci_0049                -6.321666e-03 3 1  ON 48
ci_0050                -6.737748e-03 3 1  ON 49
ci_0051                -4.770406e-03 3 1  ON 50
ci_0052                -4.648720e-03 3 1  ON 51
ci_0053                -6.053510e-03 3 1  ON 52
ci_0054                -5.774735e-03 3 1  ON 53
ci_0055                 7.222881e-03 3 1  ON 54
ci_0056                 6.837071e-03 3 1  ON 55
ci_0057                 5.281236e-03 3 1  ON 56
ci_0058                 5.684252e-03 3 1  ON 57
ci_0059                -5.690903e-03 3 1  ON 58
ci_0060                -5.668301e-03 3 1  ON 59
ci_0061                -4.057463e-03 3 1  ON 60
ci_0062                -3.699551e-03 3 1  ON 61
ci_0063                -8.709949e-03 3 1  ON 62
ci_0064                -8.619451e-03 3 1  ON 63
ci_0065                -6.404847e-03 3 1  ON 64
ci_0066                -6.577904e-03 3 1  ON 65
ci_0067                -6.053259e-03 3 1  ON 66
ci_0068                -5.767684e-03 3 1  ON 67
ci_0069                 5.431660e-03 3 1  ON 68
ci_0070                 5.327886e-03 3 1  ON 69
ci_0071                 4.584673e-03 3 1  ON 70
ci_0072                 4.672059e-03 3 1  ON 71
ci_0073                 5.170928e-03 3 1  ON 72
ci_0074                 5.118349e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9738
    reference variance = 0.336748
====================================================
  Execution time = 1.6686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2339e-01
  Total weights = 1.9517e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311975706135
                                         uncertainty =       0.002453893733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311975706135
                                         uncertainty =       0.002453893733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394961663
  error estimate for blocks of size 2^( 2) =       0.000408955227
  error estimate for blocks of size 2^( 3) =       0.000423146251
  error estimate for blocks of size 2^( 4) =       0.000435720831
  error estimate for blocks of size 2^( 5) =       0.000445571995
  error estimate for blocks of size 2^( 6) =       0.000454174703
  error estimate for blocks of size 2^( 7) =       0.000455994926

      target function =                  N/A
              le_mean =     -16.904996071505
             les_mean =     286.102374764062
             stat err =       0.000447865614
             autocorr =       1.285835922941
              std dev =       0.558560139733
             le_variance =       0.311989429698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312108642976
                                         uncertainty =       0.002481452838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312108642976
                                         uncertainty =       0.002481452838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395045693
  error estimate for blocks of size 2^( 2) =       0.000409035538
  error estimate for blocks of size 2^( 3) =       0.000423219495
  error estimate for blocks of size 2^( 4) =       0.000435791102
  error estimate for blocks of size 2^( 5) =       0.000445644229
  error estimate for blocks of size 2^( 6) =       0.000454247594
  error estimate for blocks of size 2^( 7) =       0.000456059061

      target function =                  N/A
              le_mean =     -16.904997325055
             les_mean =     286.108008112793
             stat err =       0.000447935497
             autocorr =       1.285690091054
              std dev =       0.558678976421
             le_variance =       0.312122198694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312047158015
                                         uncertainty =       0.002468951971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312047158015
                                         uncertainty =       0.002468951971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395006836
  error estimate for blocks of size 2^( 2) =       0.000408998315
  error estimate for blocks of size 2^( 3) =       0.000423185447
  error estimate for blocks of size 2^( 4) =       0.000435758375
  error estimate for blocks of size 2^( 5) =       0.000445610645
  error estimate for blocks of size 2^( 6) =       0.000454213376
  error estimate for blocks of size 2^( 7) =       0.000456029255

      target function =                  N/A
              le_mean =     -16.904996566256
             les_mean =     286.102317156346
             stat err =       0.000447902913
             autocorr =       1.285755972462
              std dev =       0.558624024386
             le_variance =       0.312060800621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311984515270
                                         uncertainty =       0.002455778394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311984515270
                                         uncertainty =       0.002455778394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394967232
  error estimate for blocks of size 2^( 2) =       0.000408960520
  error estimate for blocks of size 2^( 3) =       0.000423151086
  error estimate for blocks of size 2^( 4) =       0.000435725267
  error estimate for blocks of size 2^( 5) =       0.000445576875
  error estimate for blocks of size 2^( 6) =       0.000454179768
  error estimate for blocks of size 2^( 7) =       0.000455999520

      target function =                  N/A
              le_mean =     -16.904996198354
             les_mean =     286.103503337731
             stat err =       0.000447870357
             autocorr =       1.285826894104
              std dev =       0.558568016712
             le_variance =       0.311998229294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904996071505        initial
     1.4211e+00     1.4211e+01             2.1611e-04       -16.904997325055  <--
     5.6843e+00     5.6843e+01             5.9000e-05       -16.904996566256
     2.2737e+01     2.2737e+02             1.5087e-05       -16.904996198354

*****************************************************************************
Applying the update for shift_i =   1.4211e+00     and shift_s =   1.4211e+01
*****************************************************************************

  Execution time = 2.6227e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.006046e-01 3 1  ON 0
ci_0002                 7.000450e-01 3 1  ON 1
ci_0003                -3.052255e-02 3 1  ON 2
ci_0004                -3.043205e-02 3 1  ON 3
ci_0005                -3.363270e-02 3 1  ON 4
ci_0006                -3.389841e-02 3 1  ON 5
ci_0007                -2.268940e-02 3 1  ON 6
ci_0008                -2.292615e-02 3 1  ON 7
ci_0009                -2.019305e-02 3 1  ON 8
ci_0010                -1.968972e-02 3 1  ON 9
ci_0011                -1.505053e-02 3 1  ON 10
ci_0012                -1.578519e-02 3 1  ON 11
ci_0013                 1.585033e-02 3 1  ON 12
ci_0014                 1.564418e-02 3 1  ON 13
ci_0015                 1.586214e-02 3 1  ON 14
ci_0016                 1.589951e-02 3 1  ON 15
ci_0017                 1.378159e-02 3 1  ON 16
ci_0018                 1.352594e-02 3 1  ON 17
ci_0019                 1.157904e-02 3 1  ON 18
ci_0020                 1.186703e-02 3 1  ON 19
ci_0021                 6.988273e-03 3 1  ON 20
ci_0022                 7.801718e-03 3 1  ON 21
ci_0023                -1.147189e-02 3 1  ON 22
ci_0024                -1.140203e-02 3 1  ON 23
ci_0025                -1.161272e-02 3 1  ON 24
ci_0026                -1.210057e-02 3 1  ON 25
ci_0027                -1.147108e-02 3 1  ON 26
ci_0028                -1.085824e-02 3 1  ON 27
ci_0029                -1.047925e-02 3 1  ON 28
ci_0030                -1.077566e-02 3 1  ON 29
ci_0031                 1.850785e-02 3 1  ON 30
ci_0032                 1.894154e-02 3 1  ON 31
ci_0033                 1.055218e-02 3 1  ON 32
ci_0034                 1.048990e-02 3 1  ON 33
ci_0035                 6.803196e-03 3 1  ON 34
ci_0036                 6.711173e-03 3 1  ON 35
ci_0037                -1.161110e-02 3 1  ON 36
ci_0038                -1.091764e-02 3 1  ON 37
ci_0039                -4.180819e-03 3 1  ON 38
ci_0040                -3.861966e-03 3 1  ON 39
ci_0041                 8.305964e-03 3 1  ON 40
ci_0042                 8.947510e-03 3 1  ON 41
ci_0043                -1.423142e-02 3 1  ON 42
ci_0044                -1.324738e-02 3 1  ON 43
ci_0045                 8.189596e-03 3 1  ON 44
ci_0046                 8.397109e-03 3 1  ON 45
ci_0047                -3.228058e-03 3 1  ON 46
ci_0048                -3.450484e-03 3 1  ON 47
ci_0049                -6.372413e-03 3 1  ON 48
ci_0050                -6.737975e-03 3 1  ON 49
ci_0051                -4.806554e-03 3 1  ON 50
ci_0052                -4.638400e-03 3 1  ON 51
ci_0053                -5.987815e-03 3 1  ON 52
ci_0054                -5.787673e-03 3 1  ON 53
ci_0055                 7.230892e-03 3 1  ON 54
ci_0056                 6.806959e-03 3 1  ON 55
ci_0057                 5.273422e-03 3 1  ON 56
ci_0058                 5.599999e-03 3 1  ON 57
ci_0059                -5.787598e-03 3 1  ON 58
ci_0060                -5.559667e-03 3 1  ON 59
ci_0061                -4.068487e-03 3 1  ON 60
ci_0062                -3.729983e-03 3 1  ON 61
ci_0063                -8.770229e-03 3 1  ON 62
ci_0064                -8.684139e-03 3 1  ON 63
ci_0065                -6.361939e-03 3 1  ON 64
ci_0066                -6.592524e-03 3 1  ON 65
ci_0067                -6.030007e-03 3 1  ON 66
ci_0068                -5.818376e-03 3 1  ON 67
ci_0069                 5.370359e-03 3 1  ON 68
ci_0070                 5.308654e-03 3 1  ON 69
ci_0071                 4.527975e-03 3 1  ON 70
ci_0072                 4.556555e-03 3 1  ON 71
ci_0073                 5.208451e-03 3 1  ON 72
ci_0074                 5.203812e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.406413
====================================================
  Execution time = 1.4415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2094e-01
  Total weights = 1.951678154e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311892729078
                                         uncertainty =       0.001993298971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311892729078
                                         uncertainty =       0.001993298971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394855019
  error estimate for blocks of size 2^( 2) =       0.000408681045
  error estimate for blocks of size 2^( 3) =       0.000422889677
  error estimate for blocks of size 2^( 4) =       0.000435710503
  error estimate for blocks of size 2^( 5) =       0.000447644977
  error estimate for blocks of size 2^( 6) =       0.000456362883
  error estimate for blocks of size 2^( 7) =       0.000461609673

      target function =                  N/A
              le_mean =     -16.904668318855
             les_mean =     286.088750351917
             stat err =       0.000450332009
             autocorr =       1.300739439153
              std dev =       0.558409323306
             le_variance =       0.311820972355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690466831885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904668318906       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904672056951       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904670957919       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904671030009       residual = 6.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 4.721122e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904668318906       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904669631146       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904669290812       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 1.662896e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904668318906       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904668683843       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904668599274       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.6843e+00 is 4.682384e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6996e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.005866e-01 3 1  ON 0
ci_0002                 7.000620e-01 3 1  ON 1
ci_0003                -3.047468e-02 3 1  ON 2
ci_0004                -3.050327e-02 3 1  ON 3
ci_0005                -3.352415e-02 3 1  ON 4
ci_0006                -3.386361e-02 3 1  ON 5
ci_0007                -2.271618e-02 3 1  ON 6
ci_0008                -2.298337e-02 3 1  ON 7
ci_0009                -2.013784e-02 3 1  ON 8
ci_0010                -1.985601e-02 3 1  ON 9
ci_0011                -1.504567e-02 3 1  ON 10
ci_0012                -1.565104e-02 3 1  ON 11
ci_0013                 1.574562e-02 3 1  ON 12
ci_0014                 1.580873e-02 3 1  ON 13
ci_0015                 1.572023e-02 3 1  ON 14
ci_0016                 1.578938e-02 3 1  ON 15
ci_0017                 1.387275e-02 3 1  ON 16
ci_0018                 1.361299e-02 3 1  ON 17
ci_0019                 1.167295e-02 3 1  ON 18
ci_0020                 1.180828e-02 3 1  ON 19
ci_0021                 6.940646e-03 3 1  ON 20
ci_0022                 7.835275e-03 3 1  ON 21
ci_0023                -1.152012e-02 3 1  ON 22
ci_0024                -1.147921e-02 3 1  ON 23
ci_0025                -1.157566e-02 3 1  ON 24
ci_0026                -1.205782e-02 3 1  ON 25
ci_0027                -1.142890e-02 3 1  ON 26
ci_0028                -1.092204e-02 3 1  ON 27
ci_0029                -1.045156e-02 3 1  ON 28
ci_0030                -1.077405e-02 3 1  ON 29
ci_0031                 1.847788e-02 3 1  ON 30
ci_0032                 1.903898e-02 3 1  ON 31
ci_0033                 1.043834e-02 3 1  ON 32
ci_0034                 1.045665e-02 3 1  ON 33
ci_0035                 6.786357e-03 3 1  ON 34
ci_0036                 6.752224e-03 3 1  ON 35
ci_0037                -1.156685e-02 3 1  ON 36
ci_0038                -1.087945e-02 3 1  ON 37
ci_0039                -4.110116e-03 3 1  ON 38
ci_0040                -3.933525e-03 3 1  ON 39
ci_0041                 8.365358e-03 3 1  ON 40
ci_0042                 8.843159e-03 3 1  ON 41
ci_0043                -1.429462e-02 3 1  ON 42
ci_0044                -1.325926e-02 3 1  ON 43
ci_0045                 8.177048e-03 3 1  ON 44
ci_0046                 8.471594e-03 3 1  ON 45
ci_0047                -3.203876e-03 3 1  ON 46
ci_0048                -3.451671e-03 3 1  ON 47
ci_0049                -6.436723e-03 3 1  ON 48
ci_0050                -6.725945e-03 3 1  ON 49
ci_0051                -4.737074e-03 3 1  ON 50
ci_0052                -4.656254e-03 3 1  ON 51
ci_0053                -6.051877e-03 3 1  ON 52
ci_0054                -5.906462e-03 3 1  ON 53
ci_0055                 7.178197e-03 3 1  ON 54
ci_0056                 6.825663e-03 3 1  ON 55
ci_0057                 5.232932e-03 3 1  ON 56
ci_0058                 5.655283e-03 3 1  ON 57
ci_0059                -5.882036e-03 3 1  ON 58
ci_0060                -5.541002e-03 3 1  ON 59
ci_0061                -4.022817e-03 3 1  ON 60
ci_0062                -3.733786e-03 3 1  ON 61
ci_0063                -8.782792e-03 3 1  ON 62
ci_0064                -8.711753e-03 3 1  ON 63
ci_0065                -6.429785e-03 3 1  ON 64
ci_0066                -6.568393e-03 3 1  ON 65
ci_0067                -6.047373e-03 3 1  ON 66
ci_0068                -5.912585e-03 3 1  ON 67
ci_0069                 5.414731e-03 3 1  ON 68
ci_0070                 5.390660e-03 3 1  ON 69
ci_0071                 4.525532e-03 3 1  ON 70
ci_0072                 4.500416e-03 3 1  ON 71
ci_0073                 5.207358e-03 3 1  ON 72
ci_0074                 5.193419e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.177249
====================================================
  Execution time = 1.4655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2731e-01
  Total weights = 1.9519e+06
  Execution time = 1.8947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314356535547
                                         uncertainty =       0.002791420236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314356535547
                                         uncertainty =       0.002791420236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396610199
  error estimate for blocks of size 2^( 2) =       0.000410606609
  error estimate for blocks of size 2^( 3) =       0.000425012595
  error estimate for blocks of size 2^( 4) =       0.000439334461
  error estimate for blocks of size 2^( 5) =       0.000450356474
  error estimate for blocks of size 2^( 6) =       0.000458752054
  error estimate for blocks of size 2^( 7) =       0.000461356379

      target function =                  N/A
              le_mean =     -16.904477431168
             les_mean =     286.089043151451
             stat err =       0.000452449842
             autocorr =       1.301406961852
              std dev =       0.560891522600
             le_variance =       0.314599300124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314411485183
                                         uncertainty =       0.002775565562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314411485183
                                         uncertainty =       0.002775565562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396640553
  error estimate for blocks of size 2^( 2) =       0.000410618149
  error estimate for blocks of size 2^( 3) =       0.000425006269
  error estimate for blocks of size 2^( 4) =       0.000439307167
  error estimate for blocks of size 2^( 5) =       0.000450314938
  error estimate for blocks of size 2^( 6) =       0.000458694041
  error estimate for blocks of size 2^( 7) =       0.000461304011

      target function =                  N/A
              le_mean =     -16.904480752281
             les_mean =     286.091620428232
             stat err =       0.000452405039
             autocorr =       1.300950094754
              std dev =       0.560934449772
             le_variance =       0.314647456941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314390586663
                                         uncertainty =       0.002777341006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314390586663
                                         uncertainty =       0.002777341006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396628628
  error estimate for blocks of size 2^( 2) =       0.000410611375
  error estimate for blocks of size 2^( 3) =       0.000425004449
  error estimate for blocks of size 2^( 4) =       0.000439311999
  error estimate for blocks of size 2^( 5) =       0.000450323309
  error estimate for blocks of size 2^( 6) =       0.000458706840
  error estimate for blocks of size 2^( 7) =       0.000461314177

      target function =                  N/A
              le_mean =     -16.904479308105
             les_mean =     286.089006183836
             stat err =       0.000452414081
             autocorr =       1.301080330708
              std dev =       0.560917585551
             le_variance =       0.314628537781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314359862152
                                         uncertainty =       0.002788858593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314359862152
                                         uncertainty =       0.002788858593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396611860
  error estimate for blocks of size 2^( 2) =       0.000410606544
  error estimate for blocks of size 2^( 3) =       0.000425011494
  error estimate for blocks of size 2^( 4) =       0.000439330010
  error estimate for blocks of size 2^( 5) =       0.000450350661
  error estimate for blocks of size 2^( 6) =       0.000458742999
  error estimate for blocks of size 2^( 7) =       0.000461341926

      target function =                  N/A
              le_mean =     -16.904478389676
             les_mean =     286.097418975572
             stat err =       0.000452441399
             autocorr =       1.301347488415
              std dev =       0.560893872054
             le_variance =       0.314601935708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904477431168        initial
     3.5527e-01     3.5527e+00             4.7211e-04       -16.904480752281  <--
     1.4211e+00     1.4211e+01             1.6629e-04       -16.904479308105
     5.6843e+00     5.6843e+01             4.6824e-05       -16.904478389676

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 2.4242e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.005107e-01 3 1  ON 0
ci_0002                 7.001391e-01 3 1  ON 1
ci_0003                -3.038066e-02 3 1  ON 2
ci_0004                -3.064909e-02 3 1  ON 3
ci_0005                -3.326639e-02 3 1  ON 4
ci_0006                -3.379238e-02 3 1  ON 5
ci_0007                -2.277840e-02 3 1  ON 6
ci_0008                -2.312066e-02 3 1  ON 7
ci_0009                -2.004051e-02 3 1  ON 8
ci_0010                -2.014616e-02 3 1  ON 9
ci_0011                -1.503309e-02 3 1  ON 10
ci_0012                -1.539869e-02 3 1  ON 11
ci_0013                 1.555039e-02 3 1  ON 12
ci_0014                 1.611629e-02 3 1  ON 13
ci_0015                 1.545122e-02 3 1  ON 14
ci_0016                 1.558195e-02 3 1  ON 15
ci_0017                 1.403328e-02 3 1  ON 16
ci_0018                 1.377209e-02 3 1  ON 17
ci_0019                 1.184888e-02 3 1  ON 18
ci_0020                 1.170016e-02 3 1  ON 19
ci_0021                 6.821935e-03 3 1  ON 20
ci_0022                 7.910522e-03 3 1  ON 21
ci_0023                -1.160403e-02 3 1  ON 22
ci_0024                -1.160999e-02 3 1  ON 23
ci_0025                -1.150291e-02 3 1  ON 24
ci_0026                -1.198353e-02 3 1  ON 25
ci_0027                -1.135473e-02 3 1  ON 26
ci_0028                -1.103025e-02 3 1  ON 27
ci_0029                -1.040593e-02 3 1  ON 28
ci_0030                -1.076729e-02 3 1  ON 29
ci_0031                 1.841137e-02 3 1  ON 30
ci_0032                 1.925628e-02 3 1  ON 31
ci_0033                 1.017988e-02 3 1  ON 32
ci_0034                 1.038326e-02 3 1  ON 33
ci_0035                 6.752548e-03 3 1  ON 34
ci_0036                 6.834621e-03 3 1  ON 35
ci_0037                -1.147065e-02 3 1  ON 36
ci_0038                -1.079973e-02 3 1  ON 37
ci_0039                -4.002321e-03 3 1  ON 38
ci_0040                -4.041280e-03 3 1  ON 39
ci_0041                 8.477402e-03 3 1  ON 40
ci_0042                 8.650461e-03 3 1  ON 41
ci_0043                -1.444401e-02 3 1  ON 42
ci_0044                -1.329286e-02 3 1  ON 43
ci_0045                 8.150582e-03 3 1  ON 44
ci_0046                 8.632987e-03 3 1  ON 45
ci_0047                -3.167893e-03 3 1  ON 46
ci_0048                -3.451967e-03 3 1  ON 47
ci_0049                -6.562100e-03 3 1  ON 48
ci_0050                -6.703729e-03 3 1  ON 49
ci_0051                -4.627011e-03 3 1  ON 50
ci_0052                -4.686164e-03 3 1  ON 51
ci_0053                -6.154306e-03 3 1  ON 52
ci_0054                -6.095763e-03 3 1  ON 53
ci_0055                 7.067764e-03 3 1  ON 54
ci_0056                 6.862462e-03 3 1  ON 55
ci_0057                 5.154842e-03 3 1  ON 56
ci_0058                 5.766476e-03 3 1  ON 57
ci_0059                -6.029858e-03 3 1  ON 58
ci_0060                -5.512236e-03 3 1  ON 59
ci_0061                -3.932043e-03 3 1  ON 60
ci_0062                -3.743270e-03 3 1  ON 61
ci_0063                -8.802572e-03 3 1  ON 62
ci_0064                -8.757238e-03 3 1  ON 63
ci_0065                -6.550939e-03 3 1  ON 64
ci_0066                -6.529417e-03 3 1  ON 65
ci_0067                -6.072862e-03 3 1  ON 66
ci_0068                -6.054317e-03 3 1  ON 67
ci_0069                 5.483732e-03 3 1  ON 68
ci_0070                 5.513284e-03 3 1  ON 69
ci_0071                 4.531236e-03 3 1  ON 70
ci_0072                 4.410741e-03 3 1  ON 71
ci_0073                 5.206355e-03 3 1  ON 72
ci_0074                 5.176214e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.274657
====================================================
  Execution time = 1.4555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2779e-01
  Total weights = 1.951979976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315519132095
                                         uncertainty =       0.002763538403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315519132095
                                         uncertainty =       0.002763538403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397119930
  error estimate for blocks of size 2^( 2) =       0.000411258814
  error estimate for blocks of size 2^( 3) =       0.000425153736
  error estimate for blocks of size 2^( 4) =       0.000438135847
  error estimate for blocks of size 2^( 5) =       0.000448677947
  error estimate for blocks of size 2^( 6) =       0.000456230800
  error estimate for blocks of size 2^( 7) =       0.000460031974

      target function =                  N/A
              le_mean =     -16.904078582348
             les_mean =     286.075659662289
             stat err =       0.000450769142
             autocorr =       1.288442346633
              std dev =       0.561612390541
             le_variance =       0.315408477209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690407858235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904078582346       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904086665791       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904093920071       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904093992699       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904093694453       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904093764790       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 2.326613e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904078582346       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904082707791       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904084595089       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904084518136       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 9.968241e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904078582346       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904079976750       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904080214107       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 3.023757e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7136e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.003902e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036110e-02 3 1  ON 2
ci_0004                -3.057657e-02 3 1  ON 3
ci_0005                -3.343518e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263781e-02 3 1  ON 6
ci_0008                -2.270230e-02 3 1  ON 7
ci_0009                -1.989354e-02 3 1  ON 8
ci_0010                -2.012063e-02 3 1  ON 9
ci_0011                -1.499527e-02 3 1  ON 10
ci_0012                -1.519736e-02 3 1  ON 11
ci_0013                 1.561174e-02 3 1  ON 12
ci_0014                 1.627062e-02 3 1  ON 13
ci_0015                 1.538671e-02 3 1  ON 14
ci_0016                 1.557529e-02 3 1  ON 15
ci_0017                 1.439480e-02 3 1  ON 16
ci_0018                 1.386910e-02 3 1  ON 17
ci_0019                 1.190227e-02 3 1  ON 18
ci_0020                 1.146386e-02 3 1  ON 19
ci_0021                 6.815046e-03 3 1  ON 20
ci_0022                 7.916191e-03 3 1  ON 21
ci_0023                -1.164959e-02 3 1  ON 22
ci_0024                -1.179405e-02 3 1  ON 23
ci_0025                -1.139451e-02 3 1  ON 24
ci_0026                -1.203352e-02 3 1  ON 25
ci_0027                -1.115001e-02 3 1  ON 26
ci_0028                -1.143306e-02 3 1  ON 27
ci_0029                -1.054902e-02 3 1  ON 28
ci_0030                -1.097535e-02 3 1  ON 29
ci_0031                 1.829726e-02 3 1  ON 30
ci_0032                 1.900608e-02 3 1  ON 31
ci_0033                 1.117670e-02 3 1  ON 32
ci_0034                 1.065193e-02 3 1  ON 33
ci_0035                 6.829981e-03 3 1  ON 34
ci_0036                 7.070437e-03 3 1  ON 35
ci_0037                -1.152535e-02 3 1  ON 36
ci_0038                -1.113699e-02 3 1  ON 37
ci_0039                -3.692891e-03 3 1  ON 38
ci_0040                -4.067089e-03 3 1  ON 39
ci_0041                 8.804894e-03 3 1  ON 40
ci_0042                 8.216503e-03 3 1  ON 41
ci_0043                -1.420831e-02 3 1  ON 42
ci_0044                -1.387037e-02 3 1  ON 43
ci_0045                 8.401454e-03 3 1  ON 44
ci_0046                 8.738036e-03 3 1  ON 45
ci_0047                -3.167060e-03 3 1  ON 46
ci_0048                -3.491699e-03 3 1  ON 47
ci_0049                -6.629919e-03 3 1  ON 48
ci_0050                -6.535264e-03 3 1  ON 49
ci_0051                -4.574446e-03 3 1  ON 50
ci_0052                -4.624278e-03 3 1  ON 51
ci_0053                -6.326125e-03 3 1  ON 52
ci_0054                -6.009334e-03 3 1  ON 53
ci_0055                 6.953133e-03 3 1  ON 54
ci_0056                 7.232862e-03 3 1  ON 55
ci_0057                 5.185336e-03 3 1  ON 56
ci_0058                 5.230956e-03 3 1  ON 57
ci_0059                -6.110037e-03 3 1  ON 58
ci_0060                -5.548769e-03 3 1  ON 59
ci_0061                -3.811343e-03 3 1  ON 60
ci_0062                -3.521121e-03 3 1  ON 61
ci_0063                -9.213628e-03 3 1  ON 62
ci_0064                -8.804845e-03 3 1  ON 63
ci_0065                -6.439473e-03 3 1  ON 64
ci_0066                -6.796849e-03 3 1  ON 65
ci_0067                -5.950049e-03 3 1  ON 66
ci_0068                -6.180314e-03 3 1  ON 67
ci_0069                 5.703287e-03 3 1  ON 68
ci_0070                 5.654883e-03 3 1  ON 69
ci_0071                 4.683744e-03 3 1  ON 70
ci_0072                 4.547349e-03 3 1  ON 71
ci_0073                 5.234197e-03 3 1  ON 72
ci_0074                 5.104595e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9669
    reference variance = 0.243921
====================================================
  Execution time = 1.4229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2304e-01
  Total weights = 1.9518e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044997298
                                         uncertainty =       0.002368684455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044997298
                                         uncertainty =       0.002368684455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394969374
  error estimate for blocks of size 2^( 2) =       0.000409383406
  error estimate for blocks of size 2^( 3) =       0.000423116296
  error estimate for blocks of size 2^( 4) =       0.000436741628
  error estimate for blocks of size 2^( 5) =       0.000447618398
  error estimate for blocks of size 2^( 6) =       0.000456539352
  error estimate for blocks of size 2^( 7) =       0.000460676063

      target function =                  N/A
              le_mean =     -16.905093857858
             les_mean =     286.105979429037
             stat err =       0.000450393860
             autocorr =       1.300343466252
              std dev =       0.558571045432
             le_variance =       0.312001612795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312344182080
                                         uncertainty =       0.002432314012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312344182080
                                         uncertainty =       0.002432314012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395158429
  error estimate for blocks of size 2^( 2) =       0.000409554803
  error estimate for blocks of size 2^( 3) =       0.000423270851
  error estimate for blocks of size 2^( 4) =       0.000436884137
  error estimate for blocks of size 2^( 5) =       0.000447753449
  error estimate for blocks of size 2^( 6) =       0.000456645423
  error estimate for blocks of size 2^( 7) =       0.000460739494

      target function =                  N/A
              le_mean =     -16.905105697346
             les_mean =     286.108216607632
             stat err =       0.000450505626
             autocorr =       1.299744344393
              std dev =       0.558838410034
             le_variance =       0.312300368530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312313079111
                                         uncertainty =       0.002408998605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312313079111
                                         uncertainty =       0.002408998605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395138702
  error estimate for blocks of size 2^( 2) =       0.000409535091
  error estimate for blocks of size 2^( 3) =       0.000423245718
  error estimate for blocks of size 2^( 4) =       0.000436858217
  error estimate for blocks of size 2^( 5) =       0.000447727495
  error estimate for blocks of size 2^( 6) =       0.000456619444
  error estimate for blocks of size 2^( 7) =       0.000460742791

      target function =                  N/A
              le_mean =     -16.905106175802
             les_mean =     286.126085423644
             stat err =       0.000450486987
             autocorr =       1.299766572629
              std dev =       0.558810510725
             le_variance =       0.312269186897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312058720908
                                         uncertainty =       0.002373916503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312058720908
                                         uncertainty =       0.002373916503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394978018
  error estimate for blocks of size 2^( 2) =       0.000409388809
  error estimate for blocks of size 2^( 3) =       0.000423118781
  error estimate for blocks of size 2^( 4) =       0.000436744676
  error estimate for blocks of size 2^( 5) =       0.000447624009
  error estimate for blocks of size 2^( 6) =       0.000456543557
  error estimate for blocks of size 2^( 7) =       0.000460669672

      target function =                  N/A
              le_mean =     -16.905093129035
             les_mean =     286.106916865740
             stat err =       0.000450395478
             autocorr =       1.300295897171
              std dev =       0.558583269494
             le_variance =       0.312015268958


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905093857858        initial
     8.8818e-02     8.8818e-01             2.3266e-03       -16.905105697346
     3.5527e-01     3.5527e+00             9.9682e-04       -16.905106175802  <--
     1.4211e+00     1.4211e+01             3.0238e-04       -16.905093129035

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 2.3791e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.003902e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036110e-02 3 1  ON 2
ci_0004                -3.057657e-02 3 1  ON 3
ci_0005                -3.343518e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263781e-02 3 1  ON 6
ci_0008                -2.270230e-02 3 1  ON 7
ci_0009                -1.989354e-02 3 1  ON 8
ci_0010                -2.012063e-02 3 1  ON 9
ci_0011                -1.499527e-02 3 1  ON 10
ci_0012                -1.519736e-02 3 1  ON 11
ci_0013                 1.561174e-02 3 1  ON 12
ci_0014                 1.627062e-02 3 1  ON 13
ci_0015                 1.538671e-02 3 1  ON 14
ci_0016                 1.557529e-02 3 1  ON 15
ci_0017                 1.439480e-02 3 1  ON 16
ci_0018                 1.386910e-02 3 1  ON 17
ci_0019                 1.190227e-02 3 1  ON 18
ci_0020                 1.146386e-02 3 1  ON 19
ci_0021                 6.815046e-03 3 1  ON 20
ci_0022                 7.916191e-03 3 1  ON 21
ci_0023                -1.164959e-02 3 1  ON 22
ci_0024                -1.179405e-02 3 1  ON 23
ci_0025                -1.139451e-02 3 1  ON 24
ci_0026                -1.203352e-02 3 1  ON 25
ci_0027                -1.115001e-02 3 1  ON 26
ci_0028                -1.143306e-02 3 1  ON 27
ci_0029                -1.054902e-02 3 1  ON 28
ci_0030                -1.097535e-02 3 1  ON 29
ci_0031                 1.829726e-02 3 1  ON 30
ci_0032                 1.900608e-02 3 1  ON 31
ci_0033                 1.117670e-02 3 1  ON 32
ci_0034                 1.065193e-02 3 1  ON 33
ci_0035                 6.829981e-03 3 1  ON 34
ci_0036                 7.070437e-03 3 1  ON 35
ci_0037                -1.152535e-02 3 1  ON 36
ci_0038                -1.113699e-02 3 1  ON 37
ci_0039                -3.692891e-03 3 1  ON 38
ci_0040                -4.067089e-03 3 1  ON 39
ci_0041                 8.804894e-03 3 1  ON 40
ci_0042                 8.216503e-03 3 1  ON 41
ci_0043                -1.420831e-02 3 1  ON 42
ci_0044                -1.387037e-02 3 1  ON 43
ci_0045                 8.401454e-03 3 1  ON 44
ci_0046                 8.738036e-03 3 1  ON 45
ci_0047                -3.167060e-03 3 1  ON 46
ci_0048                -3.491699e-03 3 1  ON 47
ci_0049                -6.629919e-03 3 1  ON 48
ci_0050                -6.535264e-03 3 1  ON 49
ci_0051                -4.574446e-03 3 1  ON 50
ci_0052                -4.624278e-03 3 1  ON 51
ci_0053                -6.326125e-03 3 1  ON 52
ci_0054                -6.009334e-03 3 1  ON 53
ci_0055                 6.953133e-03 3 1  ON 54
ci_0056                 7.232862e-03 3 1  ON 55
ci_0057                 5.185336e-03 3 1  ON 56
ci_0058                 5.230956e-03 3 1  ON 57
ci_0059                -6.110037e-03 3 1  ON 58
ci_0060                -5.548769e-03 3 1  ON 59
ci_0061                -3.811343e-03 3 1  ON 60
ci_0062                -3.521121e-03 3 1  ON 61
ci_0063                -9.213628e-03 3 1  ON 62
ci_0064                -8.804845e-03 3 1  ON 63
ci_0065                -6.439473e-03 3 1  ON 64
ci_0066                -6.796849e-03 3 1  ON 65
ci_0067                -5.950049e-03 3 1  ON 66
ci_0068                -6.180314e-03 3 1  ON 67
ci_0069                 5.703287e-03 3 1  ON 68
ci_0070                 5.654883e-03 3 1  ON 69
ci_0071                 4.683744e-03 3 1  ON 70
ci_0072                 4.547349e-03 3 1  ON 71
ci_0073                 5.234197e-03 3 1  ON 72
ci_0074                 5.104595e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9778
    reference variance = 0.607765
====================================================
  Execution time = 1.4920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2036e-01
  Total weights = 1.951456551e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310234425893
                                         uncertainty =       0.002612637315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310234425893
                                         uncertainty =       0.002612637315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393856268
  error estimate for blocks of size 2^( 2) =       0.000407830466
  error estimate for blocks of size 2^( 3) =       0.000422675153
  error estimate for blocks of size 2^( 4) =       0.000435486072
  error estimate for blocks of size 2^( 5) =       0.000446287620
  error estimate for blocks of size 2^( 6) =       0.000456657323
  error estimate for blocks of size 2^( 7) =       0.000460846666

      target function =                  N/A
              le_mean =     -16.904744143237
             les_mean =     286.090730502510
             stat err =       0.000449819420
             autocorr =       1.304370232715
              std dev =       0.556996876512
             le_variance =       0.310245520444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690474414324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904744143268       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904758934363       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904759788060       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904759936954       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904760126588       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904759982331       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-02 is 1.059539e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904744143268       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904752057724       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904751843702       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904751937141       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e-01 is 5.326267e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904744143268       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904746910876       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904746704743       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+00 is 1.785846e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7524e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.002751e-01 3 1  ON 0
ci_0002                 7.003667e-01 3 1  ON 1
ci_0003                -3.061973e-02 3 1  ON 2
ci_0004                -3.004394e-02 3 1  ON 3
ci_0005                -3.330921e-02 3 1  ON 4
ci_0006                -3.419930e-02 3 1  ON 5
ci_0007                -2.251478e-02 3 1  ON 6
ci_0008                -2.248075e-02 3 1  ON 7
ci_0009                -2.009800e-02 3 1  ON 8
ci_0010                -2.018790e-02 3 1  ON 9
ci_0011                -1.502257e-02 3 1  ON 10
ci_0012                -1.540805e-02 3 1  ON 11
ci_0013                 1.564985e-02 3 1  ON 12
ci_0014                 1.615965e-02 3 1  ON 13
ci_0015                 1.539747e-02 3 1  ON 14
ci_0016                 1.541122e-02 3 1  ON 15
ci_0017                 1.414171e-02 3 1  ON 16
ci_0018                 1.394768e-02 3 1  ON 17
ci_0019                 1.169317e-02 3 1  ON 18
ci_0020                 1.169052e-02 3 1  ON 19
ci_0021                 6.887466e-03 3 1  ON 20
ci_0022                 7.644912e-03 3 1  ON 21
ci_0023                -1.164690e-02 3 1  ON 22
ci_0024                -1.170013e-02 3 1  ON 23
ci_0025                -1.122041e-02 3 1  ON 24
ci_0026                -1.226017e-02 3 1  ON 25
ci_0027                -1.143580e-02 3 1  ON 26
ci_0028                -1.145122e-02 3 1  ON 27
ci_0029                -1.054165e-02 3 1  ON 28
ci_0030                -1.103938e-02 3 1  ON 29
ci_0031                 1.821520e-02 3 1  ON 30
ci_0032                 1.902119e-02 3 1  ON 31
ci_0033                 1.098333e-02 3 1  ON 32
ci_0034                 1.020109e-02 3 1  ON 33
ci_0035                 7.002593e-03 3 1  ON 34
ci_0036                 6.798773e-03 3 1  ON 35
ci_0037                -1.159933e-02 3 1  ON 36
ci_0038                -1.099874e-02 3 1  ON 37
ci_0039                -3.895386e-03 3 1  ON 38
ci_0040                -4.244255e-03 3 1  ON 39
ci_0041                 8.872524e-03 3 1  ON 40
ci_0042                 8.415325e-03 3 1  ON 41
ci_0043                -1.399780e-02 3 1  ON 42
ci_0044                -1.375583e-02 3 1  ON 43
ci_0045                 8.470312e-03 3 1  ON 44
ci_0046                 8.273851e-03 3 1  ON 45
ci_0047                -3.093619e-03 3 1  ON 46
ci_0048                -3.353363e-03 3 1  ON 47
ci_0049                -6.991672e-03 3 1  ON 48
ci_0050                -6.149129e-03 3 1  ON 49
ci_0051                -4.724337e-03 3 1  ON 50
ci_0052                -4.608444e-03 3 1  ON 51
ci_0053                -6.515189e-03 3 1  ON 52
ci_0054                -5.898233e-03 3 1  ON 53
ci_0055                 6.788492e-03 3 1  ON 54
ci_0056                 7.347503e-03 3 1  ON 55
ci_0057                 4.956706e-03 3 1  ON 56
ci_0058                 5.345046e-03 3 1  ON 57
ci_0059                -5.935324e-03 3 1  ON 58
ci_0060                -5.848816e-03 3 1  ON 59
ci_0061                -3.799981e-03 3 1  ON 60
ci_0062                -3.890913e-03 3 1  ON 61
ci_0063                -9.266429e-03 3 1  ON 62
ci_0064                -8.683953e-03 3 1  ON 63
ci_0065                -6.225868e-03 3 1  ON 64
ci_0066                -6.934520e-03 3 1  ON 65
ci_0067                -6.197844e-03 3 1  ON 66
ci_0068                -6.050704e-03 3 1  ON 67
ci_0069                 5.782499e-03 3 1  ON 68
ci_0070                 5.777841e-03 3 1  ON 69
ci_0071                 4.319658e-03 3 1  ON 70
ci_0072                 4.343499e-03 3 1  ON 71
ci_0073                 5.426905e-03 3 1  ON 72
ci_0074                 5.176303e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.1914
====================================================
  Execution time = 1.4005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2326e-01
  Total weights = 1.9514e+06
  Execution time = 1.8953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310609528627
                                         uncertainty =       0.001893575380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310609528627
                                         uncertainty =       0.001893575380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394072428
  error estimate for blocks of size 2^( 2) =       0.000407814779
  error estimate for blocks of size 2^( 3) =       0.000421956149
  error estimate for blocks of size 2^( 4) =       0.000434882207
  error estimate for blocks of size 2^( 5) =       0.000444588267
  error estimate for blocks of size 2^( 6) =       0.000451610134
  error estimate for blocks of size 2^( 7) =       0.000457685603

      target function =                  N/A
              le_mean =     -16.904521289178
             les_mean =     286.088775619696
             stat err =       0.000447191553
             autocorr =       1.287760451684
              std dev =       0.557302572381
             le_variance =       0.310586157183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310907288269
                                         uncertainty =       0.001914645183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310907288269
                                         uncertainty =       0.001914645183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394261558
  error estimate for blocks of size 2^( 2) =       0.000408004354
  error estimate for blocks of size 2^( 3) =       0.000422157115
  error estimate for blocks of size 2^( 4) =       0.000435103986
  error estimate for blocks of size 2^( 5) =       0.000444782918
  error estimate for blocks of size 2^( 6) =       0.000451825935
  error estimate for blocks of size 2^( 7) =       0.000457878757

      target function =                  N/A
              le_mean =     -16.904513084186
             les_mean =     286.098560112941
             stat err =       0.000447397899
             autocorr =       1.287712801882
              std dev =       0.557570042084
             le_variance =       0.310884351829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310957625959
                                         uncertainty =       0.001912461500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310957625959
                                         uncertainty =       0.001912461500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394293656
  error estimate for blocks of size 2^( 2) =       0.000408033742
  error estimate for blocks of size 2^( 3) =       0.000422180815
  error estimate for blocks of size 2^( 4) =       0.000435124777
  error estimate for blocks of size 2^( 5) =       0.000444794899
  error estimate for blocks of size 2^( 6) =       0.000451837732
  error estimate for blocks of size 2^( 7) =       0.000457883651

      target function =                  N/A
              le_mean =     -16.904513251994
             les_mean =     286.096190082673
             stat err =       0.000447410265
             autocorr =       1.287574326273
              std dev =       0.557615435831
             le_variance =       0.310934974277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310637697682
                                         uncertainty =       0.001896129759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310637697682
                                         uncertainty =       0.001896129759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394090367
  error estimate for blocks of size 2^( 2) =       0.000407834311
  error estimate for blocks of size 2^( 3) =       0.000421977419
  error estimate for blocks of size 2^( 4) =       0.000434907601
  error estimate for blocks of size 2^( 5) =       0.000444608414
  error estimate for blocks of size 2^( 6) =       0.000451637740
  error estimate for blocks of size 2^( 7) =       0.000457711428

      target function =                  N/A
              le_mean =     -16.904515287035
             les_mean =     286.086200804712
             stat err =       0.000447216296
             autocorr =       1.287785708176
              std dev =       0.557327942516
             le_variance =       0.310614435509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904521289178        initial  <--
     8.8818e-02     8.8818e-01             1.0595e-03       -16.904513084186
     3.5527e-01     3.5527e+00             5.3263e-04       -16.904513251994
     1.4211e+00     1.4211e+01             1.7858e-04       -16.904515287035

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6202
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.003902e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036110e-02 3 1  ON 2
ci_0004                -3.057657e-02 3 1  ON 3
ci_0005                -3.343518e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263781e-02 3 1  ON 6
ci_0008                -2.270230e-02 3 1  ON 7
ci_0009                -1.989354e-02 3 1  ON 8
ci_0010                -2.012063e-02 3 1  ON 9
ci_0011                -1.499527e-02 3 1  ON 10
ci_0012                -1.519736e-02 3 1  ON 11
ci_0013                 1.561174e-02 3 1  ON 12
ci_0014                 1.627062e-02 3 1  ON 13
ci_0015                 1.538671e-02 3 1  ON 14
ci_0016                 1.557529e-02 3 1  ON 15
ci_0017                 1.439480e-02 3 1  ON 16
ci_0018                 1.386910e-02 3 1  ON 17
ci_0019                 1.190227e-02 3 1  ON 18
ci_0020                 1.146386e-02 3 1  ON 19
ci_0021                 6.815046e-03 3 1  ON 20
ci_0022                 7.916191e-03 3 1  ON 21
ci_0023                -1.164959e-02 3 1  ON 22
ci_0024                -1.179405e-02 3 1  ON 23
ci_0025                -1.139451e-02 3 1  ON 24
ci_0026                -1.203352e-02 3 1  ON 25
ci_0027                -1.115001e-02 3 1  ON 26
ci_0028                -1.143306e-02 3 1  ON 27
ci_0029                -1.054902e-02 3 1  ON 28
ci_0030                -1.097535e-02 3 1  ON 29
ci_0031                 1.829726e-02 3 1  ON 30
ci_0032                 1.900608e-02 3 1  ON 31
ci_0033                 1.117670e-02 3 1  ON 32
ci_0034                 1.065193e-02 3 1  ON 33
ci_0035                 6.829981e-03 3 1  ON 34
ci_0036                 7.070437e-03 3 1  ON 35
ci_0037                -1.152535e-02 3 1  ON 36
ci_0038                -1.113699e-02 3 1  ON 37
ci_0039                -3.692891e-03 3 1  ON 38
ci_0040                -4.067089e-03 3 1  ON 39
ci_0041                 8.804894e-03 3 1  ON 40
ci_0042                 8.216503e-03 3 1  ON 41
ci_0043                -1.420831e-02 3 1  ON 42
ci_0044                -1.387037e-02 3 1  ON 43
ci_0045                 8.401454e-03 3 1  ON 44
ci_0046                 8.738036e-03 3 1  ON 45
ci_0047                -3.167060e-03 3 1  ON 46
ci_0048                -3.491699e-03 3 1  ON 47
ci_0049                -6.629919e-03 3 1  ON 48
ci_0050                -6.535264e-03 3 1  ON 49
ci_0051                -4.574446e-03 3 1  ON 50
ci_0052                -4.624278e-03 3 1  ON 51
ci_0053                -6.326125e-03 3 1  ON 52
ci_0054                -6.009334e-03 3 1  ON 53
ci_0055                 6.953133e-03 3 1  ON 54
ci_0056                 7.232862e-03 3 1  ON 55
ci_0057                 5.185336e-03 3 1  ON 56
ci_0058                 5.230956e-03 3 1  ON 57
ci_0059                -6.110037e-03 3 1  ON 58
ci_0060                -5.548769e-03 3 1  ON 59
ci_0061                -3.811343e-03 3 1  ON 60
ci_0062                -3.521121e-03 3 1  ON 61
ci_0063                -9.213628e-03 3 1  ON 62
ci_0064                -8.804845e-03 3 1  ON 63
ci_0065                -6.439473e-03 3 1  ON 64
ci_0066                -6.796849e-03 3 1  ON 65
ci_0067                -5.950049e-03 3 1  ON 66
ci_0068                -6.180314e-03 3 1  ON 67
ci_0069                 5.703287e-03 3 1  ON 68
ci_0070                 5.654883e-03 3 1  ON 69
ci_0071                 4.683744e-03 3 1  ON 70
ci_0072                 4.547349e-03 3 1  ON 71
ci_0073                 5.234197e-03 3 1  ON 72
ci_0074                 5.104595e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8857
    reference variance = 0.220529
====================================================
  Execution time = 1.4518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2408e-01
  Total weights = 1.951773588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312631723317
                                         uncertainty =       0.001824015605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312631723317
                                         uncertainty =       0.001824015605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395362695
  error estimate for blocks of size 2^( 2) =       0.000409426462
  error estimate for blocks of size 2^( 3) =       0.000423567201
  error estimate for blocks of size 2^( 4) =       0.000436848096
  error estimate for blocks of size 2^( 5) =       0.000448620458
  error estimate for blocks of size 2^( 6) =       0.000457628279
  error estimate for blocks of size 2^( 7) =       0.000463730563

      target function =                  N/A
              le_mean =     -16.904047362266
             les_mean =     286.070895993121
             stat err =       0.000451706849
             autocorr =       1.305334975292
              std dev =       0.559127285237
             le_variance =       0.312623321096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690404736227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904047362314       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904049282135       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904049757057       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904049739893       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e-01 is 4.146069e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904047362314       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904047926118       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904048006805       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904047999223       residual = 1.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+00 is 1.132281e-04

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904047362314       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904047509702       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904047526319       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904047524201       residual = 1.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+01 is 2.897458e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7106e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.003514e-01 3 1  ON 0
ci_0002                 7.002679e-01 3 1  ON 1
ci_0003                -3.039073e-02 3 1  ON 2
ci_0004                -3.053882e-02 3 1  ON 3
ci_0005                -3.341443e-02 3 1  ON 4
ci_0006                -3.394960e-02 3 1  ON 5
ci_0007                -2.261022e-02 3 1  ON 6
ci_0008                -2.266906e-02 3 1  ON 7
ci_0009                -1.989834e-02 3 1  ON 8
ci_0010                -2.006119e-02 3 1  ON 9
ci_0011                -1.502000e-02 3 1  ON 10
ci_0012                -1.518558e-02 3 1  ON 11
ci_0013                 1.563741e-02 3 1  ON 12
ci_0014                 1.623588e-02 3 1  ON 13
ci_0015                 1.538093e-02 3 1  ON 14
ci_0016                 1.558628e-02 3 1  ON 15
ci_0017                 1.438302e-02 3 1  ON 16
ci_0018                 1.384003e-02 3 1  ON 17
ci_0019                 1.194353e-02 3 1  ON 18
ci_0020                 1.150926e-02 3 1  ON 19
ci_0021                 6.839210e-03 3 1  ON 20
ci_0022                 7.903475e-03 3 1  ON 21
ci_0023                -1.165427e-02 3 1  ON 22
ci_0024                -1.177029e-02 3 1  ON 23
ci_0025                -1.144975e-02 3 1  ON 24
ci_0026                -1.198286e-02 3 1  ON 25
ci_0027                -1.118199e-02 3 1  ON 26
ci_0028                -1.139409e-02 3 1  ON 27
ci_0029                -1.051534e-02 3 1  ON 28
ci_0030                -1.097870e-02 3 1  ON 29
ci_0031                 1.829553e-02 3 1  ON 30
ci_0032                 1.902712e-02 3 1  ON 31
ci_0033                 1.106348e-02 3 1  ON 32
ci_0034                 1.059068e-02 3 1  ON 33
ci_0035                 6.836240e-03 3 1  ON 34
ci_0036                 7.071189e-03 3 1  ON 35
ci_0037                -1.151964e-02 3 1  ON 36
ci_0038                -1.113668e-02 3 1  ON 37
ci_0039                -3.679350e-03 3 1  ON 38
ci_0040                -4.045276e-03 3 1  ON 39
ci_0041                 8.797893e-03 3 1  ON 40
ci_0042                 8.261010e-03 3 1  ON 41
ci_0043                -1.420098e-02 3 1  ON 42
ci_0044                -1.388678e-02 3 1  ON 43
ci_0045                 8.435662e-03 3 1  ON 44
ci_0046                 8.751060e-03 3 1  ON 45
ci_0047                -3.197434e-03 3 1  ON 46
ci_0048                -3.425983e-03 3 1  ON 47
ci_0049                -6.591769e-03 3 1  ON 48
ci_0050                -6.634144e-03 3 1  ON 49
ci_0051                -4.608498e-03 3 1  ON 50
ci_0052                -4.621356e-03 3 1  ON 51
ci_0053                -6.309509e-03 3 1  ON 52
ci_0054                -5.996872e-03 3 1  ON 53
ci_0055                 6.968054e-03 3 1  ON 54
ci_0056                 7.234266e-03 3 1  ON 55
ci_0057                 5.175090e-03 3 1  ON 56
ci_0058                 5.235079e-03 3 1  ON 57
ci_0059                -6.107433e-03 3 1  ON 58
ci_0060                -5.648433e-03 3 1  ON 59
ci_0061                -3.846843e-03 3 1  ON 60
ci_0062                -3.453796e-03 3 1  ON 61
ci_0063                -9.218364e-03 3 1  ON 62
ci_0064                -8.817937e-03 3 1  ON 63
ci_0065                -6.454488e-03 3 1  ON 64
ci_0066                -6.748170e-03 3 1  ON 65
ci_0067                -5.944339e-03 3 1  ON 66
ci_0068                -6.122086e-03 3 1  ON 67
ci_0069                 5.645861e-03 3 1  ON 68
ci_0070                 5.650573e-03 3 1  ON 69
ci_0071                 4.669266e-03 3 1  ON 70
ci_0072                 4.528730e-03 3 1  ON 71
ci_0073                 5.230687e-03 3 1  ON 72
ci_0074                 5.125092e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9311
    reference variance = 0.427398
====================================================
  Execution time = 1.4025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2762e-01
  Total weights = 1.9519e+06
  Execution time = 1.8940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311776260204
                                         uncertainty =       0.002320085399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311776260204
                                         uncertainty =       0.002320085399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394820097
  error estimate for blocks of size 2^( 2) =       0.000409137166
  error estimate for blocks of size 2^( 3) =       0.000423156612
  error estimate for blocks of size 2^( 4) =       0.000436373519
  error estimate for blocks of size 2^( 5) =       0.000447509148
  error estimate for blocks of size 2^( 6) =       0.000455242793
  error estimate for blocks of size 2^( 7) =       0.000457271014

      target function =                  N/A
              le_mean =     -16.904571642040
             les_mean =     286.092074087823
             stat err =       0.000449099118
             autocorr =       1.293855877398
              std dev =       0.558359936121
             le_variance =       0.311765818265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311766620655
                                         uncertainty =       0.002332381932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311766620655
                                         uncertainty =       0.002332381932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394814313
  error estimate for blocks of size 2^( 2) =       0.000409132258
  error estimate for blocks of size 2^( 3) =       0.000423155500
  error estimate for blocks of size 2^( 4) =       0.000436373629
  error estimate for blocks of size 2^( 5) =       0.000447520775
  error estimate for blocks of size 2^( 6) =       0.000455259114
  error estimate for blocks of size 2^( 7) =       0.000457297549

      target function =                  N/A
              le_mean =     -16.904570498133
             les_mean =     286.092661660423
             stat err =       0.000449112767
             autocorr =       1.293972433765
              std dev =       0.558351756048
             le_variance =       0.311756683482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311766263847
                                         uncertainty =       0.002327426129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311766263847
                                         uncertainty =       0.002327426129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394813956
  error estimate for blocks of size 2^( 2) =       0.000409131649
  error estimate for blocks of size 2^( 3) =       0.000423153523
  error estimate for blocks of size 2^( 4) =       0.000436371358
  error estimate for blocks of size 2^( 5) =       0.000447514075
  error estimate for blocks of size 2^( 6) =       0.000455250077
  error estimate for blocks of size 2^( 7) =       0.000457284969

      target function =                  N/A
              le_mean =     -16.904570461898
             les_mean =     286.092263883895
             stat err =       0.000449105120
             autocorr =       1.293930711505
              std dev =       0.558351250610
             le_variance =       0.311756119057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311774231438
                                         uncertainty =       0.002321032649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311774231438
                                         uncertainty =       0.002321032649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394818837
  error estimate for blocks of size 2^( 2) =       0.000409135993
  error estimate for blocks of size 2^( 3) =       0.000423155771
  error estimate for blocks of size 2^( 4) =       0.000436372811
  error estimate for blocks of size 2^( 5) =       0.000447509393
  error estimate for blocks of size 2^( 6) =       0.000455243324
  error estimate for blocks of size 2^( 7) =       0.000457272463

      target function =                  N/A
              le_mean =     -16.904571396896
             les_mean =     286.092084785786
             stat err =       0.000449099498
             autocorr =       1.293866319350
              std dev =       0.558358154614
             le_variance =       0.311763828824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904571642040        initial  <--
     8.8818e-01     8.8818e+00             4.1461e-04       -16.904570498133
     3.5527e+00     3.5527e+01             1.1323e-04       -16.904570461898
     1.4211e+01     1.4211e+02             2.8975e-05       -16.904571396896

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6313
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.003902e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036110e-02 3 1  ON 2
ci_0004                -3.057657e-02 3 1  ON 3
ci_0005                -3.343518e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263781e-02 3 1  ON 6
ci_0008                -2.270230e-02 3 1  ON 7
ci_0009                -1.989354e-02 3 1  ON 8
ci_0010                -2.012063e-02 3 1  ON 9
ci_0011                -1.499527e-02 3 1  ON 10
ci_0012                -1.519736e-02 3 1  ON 11
ci_0013                 1.561174e-02 3 1  ON 12
ci_0014                 1.627062e-02 3 1  ON 13
ci_0015                 1.538671e-02 3 1  ON 14
ci_0016                 1.557529e-02 3 1  ON 15
ci_0017                 1.439480e-02 3 1  ON 16
ci_0018                 1.386910e-02 3 1  ON 17
ci_0019                 1.190227e-02 3 1  ON 18
ci_0020                 1.146386e-02 3 1  ON 19
ci_0021                 6.815046e-03 3 1  ON 20
ci_0022                 7.916191e-03 3 1  ON 21
ci_0023                -1.164959e-02 3 1  ON 22
ci_0024                -1.179405e-02 3 1  ON 23
ci_0025                -1.139451e-02 3 1  ON 24
ci_0026                -1.203352e-02 3 1  ON 25
ci_0027                -1.115001e-02 3 1  ON 26
ci_0028                -1.143306e-02 3 1  ON 27
ci_0029                -1.054902e-02 3 1  ON 28
ci_0030                -1.097535e-02 3 1  ON 29
ci_0031                 1.829726e-02 3 1  ON 30
ci_0032                 1.900608e-02 3 1  ON 31
ci_0033                 1.117670e-02 3 1  ON 32
ci_0034                 1.065193e-02 3 1  ON 33
ci_0035                 6.829981e-03 3 1  ON 34
ci_0036                 7.070437e-03 3 1  ON 35
ci_0037                -1.152535e-02 3 1  ON 36
ci_0038                -1.113699e-02 3 1  ON 37
ci_0039                -3.692891e-03 3 1  ON 38
ci_0040                -4.067089e-03 3 1  ON 39
ci_0041                 8.804894e-03 3 1  ON 40
ci_0042                 8.216503e-03 3 1  ON 41
ci_0043                -1.420831e-02 3 1  ON 42
ci_0044                -1.387037e-02 3 1  ON 43
ci_0045                 8.401454e-03 3 1  ON 44
ci_0046                 8.738036e-03 3 1  ON 45
ci_0047                -3.167060e-03 3 1  ON 46
ci_0048                -3.491699e-03 3 1  ON 47
ci_0049                -6.629919e-03 3 1  ON 48
ci_0050                -6.535264e-03 3 1  ON 49
ci_0051                -4.574446e-03 3 1  ON 50
ci_0052                -4.624278e-03 3 1  ON 51
ci_0053                -6.326125e-03 3 1  ON 52
ci_0054                -6.009334e-03 3 1  ON 53
ci_0055                 6.953133e-03 3 1  ON 54
ci_0056                 7.232862e-03 3 1  ON 55
ci_0057                 5.185336e-03 3 1  ON 56
ci_0058                 5.230956e-03 3 1  ON 57
ci_0059                -6.110037e-03 3 1  ON 58
ci_0060                -5.548769e-03 3 1  ON 59
ci_0061                -3.811343e-03 3 1  ON 60
ci_0062                -3.521121e-03 3 1  ON 61
ci_0063                -9.213628e-03 3 1  ON 62
ci_0064                -8.804845e-03 3 1  ON 63
ci_0065                -6.439473e-03 3 1  ON 64
ci_0066                -6.796849e-03 3 1  ON 65
ci_0067                -5.950049e-03 3 1  ON 66
ci_0068                -6.180314e-03 3 1  ON 67
ci_0069                 5.703287e-03 3 1  ON 68
ci_0070                 5.654883e-03 3 1  ON 69
ci_0071                 4.683744e-03 3 1  ON 70
ci_0072                 4.547349e-03 3 1  ON 71
ci_0073                 5.234197e-03 3 1  ON 72
ci_0074                 5.104595e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9308
    reference variance = 0.135782
====================================================
  Execution time = 1.4484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2350e-01
  Total weights = 1.951775496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312250579500
                                         uncertainty =       0.002086902778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312250579500
                                         uncertainty =       0.002086902778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395106896
  error estimate for blocks of size 2^( 2) =       0.000409019579
  error estimate for blocks of size 2^( 3) =       0.000423679884
  error estimate for blocks of size 2^( 4) =       0.000436920593
  error estimate for blocks of size 2^( 5) =       0.000449983748
  error estimate for blocks of size 2^( 6) =       0.000459934677
  error estimate for blocks of size 2^( 7) =       0.000470266774

      target function =                  N/A
              le_mean =     -16.904420560644
             les_mean =     286.082937296009
             stat err =       0.000454276448
             autocorr =       1.321938418943
              std dev =       0.558765530450
             le_variance =       0.312218918019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690442056064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904420560672       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904421036422       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904421034488       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+00 is 2.876140e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904420560672       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904420681846       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904420681428       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+01 is 7.325999e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904420560672       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904420591108       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904420591009       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+02 is 1.840203e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7113e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.003903e-01 3 1  ON 0
ci_0002                 7.002227e-01 3 1  ON 1
ci_0003                -3.036195e-02 3 1  ON 2
ci_0004                -3.057614e-02 3 1  ON 3
ci_0005                -3.343563e-02 3 1  ON 4
ci_0006                -3.394396e-02 3 1  ON 5
ci_0007                -2.263816e-02 3 1  ON 6
ci_0008                -2.270334e-02 3 1  ON 7
ci_0009                -1.989407e-02 3 1  ON 8
ci_0010                -2.012114e-02 3 1  ON 9
ci_0011                -1.499810e-02 3 1  ON 10
ci_0012                -1.520146e-02 3 1  ON 11
ci_0013                 1.561436e-02 3 1  ON 12
ci_0014                 1.626413e-02 3 1  ON 13
ci_0015                 1.539304e-02 3 1  ON 14
ci_0016                 1.557408e-02 3 1  ON 15
ci_0017                 1.439409e-02 3 1  ON 16
ci_0018                 1.386524e-02 3 1  ON 17
ci_0019                 1.190195e-02 3 1  ON 18
ci_0020                 1.146746e-02 3 1  ON 19
ci_0021                 6.818421e-03 3 1  ON 20
ci_0022                 7.917992e-03 3 1  ON 21
ci_0023                -1.164643e-02 3 1  ON 22
ci_0024                -1.178954e-02 3 1  ON 23
ci_0025                -1.139563e-02 3 1  ON 24
ci_0026                -1.203041e-02 3 1  ON 25
ci_0027                -1.115734e-02 3 1  ON 26
ci_0028                -1.143478e-02 3 1  ON 27
ci_0029                -1.054230e-02 3 1  ON 28
ci_0030                -1.097295e-02 3 1  ON 29
ci_0031                 1.829811e-02 3 1  ON 30
ci_0032                 1.900443e-02 3 1  ON 31
ci_0033                 1.117428e-02 3 1  ON 32
ci_0034                 1.065280e-02 3 1  ON 33
ci_0035                 6.832227e-03 3 1  ON 34
ci_0036                 7.072377e-03 3 1  ON 35
ci_0037                -1.152841e-02 3 1  ON 36
ci_0038                -1.113379e-02 3 1  ON 37
ci_0039                -3.699923e-03 3 1  ON 38
ci_0040                -4.069108e-03 3 1  ON 39
ci_0041                 8.803170e-03 3 1  ON 40
ci_0042                 8.212002e-03 3 1  ON 41
ci_0043                -1.420417e-02 3 1  ON 42
ci_0044                -1.387249e-02 3 1  ON 43
ci_0045                 8.404801e-03 3 1  ON 44
ci_0046                 8.743876e-03 3 1  ON 45
ci_0047                -3.169504e-03 3 1  ON 46
ci_0048                -3.486815e-03 3 1  ON 47
ci_0049                -6.629231e-03 3 1  ON 48
ci_0050                -6.536175e-03 3 1  ON 49
ci_0051                -4.578699e-03 3 1  ON 50
ci_0052                -4.622531e-03 3 1  ON 51
ci_0053                -6.326093e-03 3 1  ON 52
ci_0054                -6.010797e-03 3 1  ON 53
ci_0055                 6.949634e-03 3 1  ON 54
ci_0056                 7.235734e-03 3 1  ON 55
ci_0057                 5.179302e-03 3 1  ON 56
ci_0058                 5.233075e-03 3 1  ON 57
ci_0059                -6.108613e-03 3 1  ON 58
ci_0060                -5.555284e-03 3 1  ON 59
ci_0061                -3.811097e-03 3 1  ON 60
ci_0062                -3.522847e-03 3 1  ON 61
ci_0063                -9.209095e-03 3 1  ON 62
ci_0064                -8.809396e-03 3 1  ON 63
ci_0065                -6.441504e-03 3 1  ON 64
ci_0066                -6.794668e-03 3 1  ON 65
ci_0067                -5.949702e-03 3 1  ON 66
ci_0068                -6.181180e-03 3 1  ON 67
ci_0069                 5.708890e-03 3 1  ON 68
ci_0070                 5.654749e-03 3 1  ON 69
ci_0071                 4.677957e-03 3 1  ON 70
ci_0072                 4.545062e-03 3 1  ON 71
ci_0073                 5.235066e-03 3 1  ON 72
ci_0074                 5.103179e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8344
    reference variance = 0.376012
====================================================
  Execution time = 1.4029e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2477e-01
  Total weights = 1.9517e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276252134
                                         uncertainty =       0.001812092476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276252134
                                         uncertainty =       0.001812092476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393890788
  error estimate for blocks of size 2^( 2) =       0.000408119886
  error estimate for blocks of size 2^( 3) =       0.000422561248
  error estimate for blocks of size 2^( 4) =       0.000435541454
  error estimate for blocks of size 2^( 5) =       0.000445878261
  error estimate for blocks of size 2^( 6) =       0.000454538407
  error estimate for blocks of size 2^( 7) =       0.000457579750

      target function =                  N/A
              le_mean =     -16.903763013208
             les_mean =     286.061967934710
             stat err =       0.000448384468
             autocorr =       1.295834303118
              std dev =       0.557045694570
             le_variance =       0.310299905839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310285161669
                                         uncertainty =       0.001812233769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310285161669
                                         uncertainty =       0.001812233769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393896444
  error estimate for blocks of size 2^( 2) =       0.000408124882
  error estimate for blocks of size 2^( 3) =       0.000422565596
  error estimate for blocks of size 2^( 4) =       0.000435545597
  error estimate for blocks of size 2^( 5) =       0.000445881643
  error estimate for blocks of size 2^( 6) =       0.000454541930
  error estimate for blocks of size 2^( 7) =       0.000457583279

      target function =                  N/A
              le_mean =     -16.903762899764
             les_mean =     286.061992144853
             stat err =       0.000448388112
             autocorr =       1.295818155202
              std dev =       0.557053692675
             le_variance =       0.310308816522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310280757975
                                         uncertainty =       0.001812162081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310280757975
                                         uncertainty =       0.001812162081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393893648
  error estimate for blocks of size 2^( 2) =       0.000408122409
  error estimate for blocks of size 2^( 3) =       0.000422563442
  error estimate for blocks of size 2^( 4) =       0.000435543545
  error estimate for blocks of size 2^( 5) =       0.000445879963
  error estimate for blocks of size 2^( 6) =       0.000454540183
  error estimate for blocks of size 2^( 7) =       0.000457581530

      target function =                  N/A
              le_mean =     -16.903762946190
             les_mean =     286.061978341595
             stat err =       0.000448386305
             autocorr =       1.295826103556
              std dev =       0.557049739630
             le_variance =       0.310304412422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276811550
                                         uncertainty =       0.001812101045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276811550
                                         uncertainty =       0.001812101045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393891143
  error estimate for blocks of size 2^( 2) =       0.000408120199
  error estimate for blocks of size 2^( 3) =       0.000422561519
  error estimate for blocks of size 2^( 4) =       0.000435541713
  error estimate for blocks of size 2^( 5) =       0.000445878471
  error estimate for blocks of size 2^( 6) =       0.000454538626
  error estimate for blocks of size 2^( 7) =       0.000457579970

      target function =                  N/A
              le_mean =     -16.903763003891
             les_mean =     286.061969074231
             stat err =       0.000448384695
             autocorr =       1.295833277878
              std dev =       0.557046196791
             le_variance =       0.310300465359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903763013208        initial  <--
     8.8818e+00     8.8818e+01             2.8761e-05       -16.903762899764
     3.5527e+01     3.5527e+02             7.3260e-06       -16.903762946190
     1.4211e+02     1.4211e+03             1.8402e-06       -16.903763003891

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5762
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.003902e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036110e-02 3 1  ON 2
ci_0004                -3.057657e-02 3 1  ON 3
ci_0005                -3.343518e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263781e-02 3 1  ON 6
ci_0008                -2.270230e-02 3 1  ON 7
ci_0009                -1.989354e-02 3 1  ON 8
ci_0010                -2.012063e-02 3 1  ON 9
ci_0011                -1.499527e-02 3 1  ON 10
ci_0012                -1.519736e-02 3 1  ON 11
ci_0013                 1.561174e-02 3 1  ON 12
ci_0014                 1.627062e-02 3 1  ON 13
ci_0015                 1.538671e-02 3 1  ON 14
ci_0016                 1.557529e-02 3 1  ON 15
ci_0017                 1.439480e-02 3 1  ON 16
ci_0018                 1.386910e-02 3 1  ON 17
ci_0019                 1.190227e-02 3 1  ON 18
ci_0020                 1.146386e-02 3 1  ON 19
ci_0021                 6.815046e-03 3 1  ON 20
ci_0022                 7.916191e-03 3 1  ON 21
ci_0023                -1.164959e-02 3 1  ON 22
ci_0024                -1.179405e-02 3 1  ON 23
ci_0025                -1.139451e-02 3 1  ON 24
ci_0026                -1.203352e-02 3 1  ON 25
ci_0027                -1.115001e-02 3 1  ON 26
ci_0028                -1.143306e-02 3 1  ON 27
ci_0029                -1.054902e-02 3 1  ON 28
ci_0030                -1.097535e-02 3 1  ON 29
ci_0031                 1.829726e-02 3 1  ON 30
ci_0032                 1.900608e-02 3 1  ON 31
ci_0033                 1.117670e-02 3 1  ON 32
ci_0034                 1.065193e-02 3 1  ON 33
ci_0035                 6.829981e-03 3 1  ON 34
ci_0036                 7.070437e-03 3 1  ON 35
ci_0037                -1.152535e-02 3 1  ON 36
ci_0038                -1.113699e-02 3 1  ON 37
ci_0039                -3.692891e-03 3 1  ON 38
ci_0040                -4.067089e-03 3 1  ON 39
ci_0041                 8.804894e-03 3 1  ON 40
ci_0042                 8.216503e-03 3 1  ON 41
ci_0043                -1.420831e-02 3 1  ON 42
ci_0044                -1.387037e-02 3 1  ON 43
ci_0045                 8.401454e-03 3 1  ON 44
ci_0046                 8.738036e-03 3 1  ON 45
ci_0047                -3.167060e-03 3 1  ON 46
ci_0048                -3.491699e-03 3 1  ON 47
ci_0049                -6.629919e-03 3 1  ON 48
ci_0050                -6.535264e-03 3 1  ON 49
ci_0051                -4.574446e-03 3 1  ON 50
ci_0052                -4.624278e-03 3 1  ON 51
ci_0053                -6.326125e-03 3 1  ON 52
ci_0054                -6.009334e-03 3 1  ON 53
ci_0055                 6.953133e-03 3 1  ON 54
ci_0056                 7.232862e-03 3 1  ON 55
ci_0057                 5.185336e-03 3 1  ON 56
ci_0058                 5.230956e-03 3 1  ON 57
ci_0059                -6.110037e-03 3 1  ON 58
ci_0060                -5.548769e-03 3 1  ON 59
ci_0061                -3.811343e-03 3 1  ON 60
ci_0062                -3.521121e-03 3 1  ON 61
ci_0063                -9.213628e-03 3 1  ON 62
ci_0064                -8.804845e-03 3 1  ON 63
ci_0065                -6.439473e-03 3 1  ON 64
ci_0066                -6.796849e-03 3 1  ON 65
ci_0067                -5.950049e-03 3 1  ON 66
ci_0068                -6.180314e-03 3 1  ON 67
ci_0069                 5.703287e-03 3 1  ON 68
ci_0070                 5.654883e-03 3 1  ON 69
ci_0071                 4.683744e-03 3 1  ON 70
ci_0072                 4.547349e-03 3 1  ON 71
ci_0073                 5.234197e-03 3 1  ON 72
ci_0074                 5.104595e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9968
    reference variance = 0.510087
====================================================
  Execution time = 1.4400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4118e-01
  Total weights = 1.951450912e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324968486672
                                         uncertainty =       0.009916649949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324968486672
                                         uncertainty =       0.009916649949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403109631
  error estimate for blocks of size 2^( 2) =       0.000416627684
  error estimate for blocks of size 2^( 3) =       0.000429923861
  error estimate for blocks of size 2^( 4) =       0.000442373990
  error estimate for blocks of size 2^( 5) =       0.000452610621
  error estimate for blocks of size 2^( 6) =       0.000459425486
  error estimate for blocks of size 2^( 7) =       0.000462837539

      target function =                  N/A
              le_mean =     -16.904614749319
             les_mean =     286.107181981559
             stat err =       0.000454311909
             autocorr =       1.270170127802
              std dev =       0.570083106791
             le_variance =       0.324994748648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690461474932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904614749324       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614832394       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904614832766       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904614832404       residual = 7.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+01 is 6.220996e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904614749324       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614770131       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904614770230       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904614770140       residual = 7.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+02 is 1.558014e-06

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904614749324       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614754528       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904614754554       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904614754531       residual = 7.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4211e+03 is 3.896767e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6982e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.003901e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036183e-02 3 1  ON 2
ci_0004                -3.057633e-02 3 1  ON 3
ci_0005                -3.343511e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263764e-02 3 1  ON 6
ci_0008                -2.270248e-02 3 1  ON 7
ci_0009                -1.989359e-02 3 1  ON 8
ci_0010                -2.012029e-02 3 1  ON 9
ci_0011                -1.499562e-02 3 1  ON 10
ci_0012                -1.519761e-02 3 1  ON 11
ci_0013                 1.561105e-02 3 1  ON 12
ci_0014                 1.627070e-02 3 1  ON 13
ci_0015                 1.538662e-02 3 1  ON 14
ci_0016                 1.557589e-02 3 1  ON 15
ci_0017                 1.439455e-02 3 1  ON 16
ci_0018                 1.386959e-02 3 1  ON 17
ci_0019                 1.190261e-02 3 1  ON 18
ci_0020                 1.146368e-02 3 1  ON 19
ci_0021                 6.814547e-03 3 1  ON 20
ci_0022                 7.916160e-03 3 1  ON 21
ci_0023                -1.164954e-02 3 1  ON 22
ci_0024                -1.179417e-02 3 1  ON 23
ci_0025                -1.139465e-02 3 1  ON 24
ci_0026                -1.203308e-02 3 1  ON 25
ci_0027                -1.115018e-02 3 1  ON 26
ci_0028                -1.143319e-02 3 1  ON 27
ci_0029                -1.055058e-02 3 1  ON 28
ci_0030                -1.097545e-02 3 1  ON 29
ci_0031                 1.829744e-02 3 1  ON 30
ci_0032                 1.900576e-02 3 1  ON 31
ci_0033                 1.117656e-02 3 1  ON 32
ci_0034                 1.065207e-02 3 1  ON 33
ci_0035                 6.830651e-03 3 1  ON 34
ci_0036                 7.070667e-03 3 1  ON 35
ci_0037                -1.152651e-02 3 1  ON 36
ci_0038                -1.113704e-02 3 1  ON 37
ci_0039                -3.693632e-03 3 1  ON 38
ci_0040                -4.067174e-03 3 1  ON 39
ci_0041                 8.804655e-03 3 1  ON 40
ci_0042                 8.216834e-03 3 1  ON 41
ci_0043                -1.420825e-02 3 1  ON 42
ci_0044                -1.387031e-02 3 1  ON 43
ci_0045                 8.401814e-03 3 1  ON 44
ci_0046                 8.738107e-03 3 1  ON 45
ci_0047                -3.167186e-03 3 1  ON 46
ci_0048                -3.492243e-03 3 1  ON 47
ci_0049                -6.629882e-03 3 1  ON 48
ci_0050                -6.535275e-03 3 1  ON 49
ci_0051                -4.574485e-03 3 1  ON 50
ci_0052                -4.624314e-03 3 1  ON 51
ci_0053                -6.325691e-03 3 1  ON 52
ci_0054                -6.009899e-03 3 1  ON 53
ci_0055                 6.953508e-03 3 1  ON 54
ci_0056                 7.232843e-03 3 1  ON 55
ci_0057                 5.184986e-03 3 1  ON 56
ci_0058                 5.231009e-03 3 1  ON 57
ci_0059                -6.110312e-03 3 1  ON 58
ci_0060                -5.549128e-03 3 1  ON 59
ci_0061                -3.811043e-03 3 1  ON 60
ci_0062                -3.521636e-03 3 1  ON 61
ci_0063                -9.212986e-03 3 1  ON 62
ci_0064                -8.804910e-03 3 1  ON 63
ci_0065                -6.439603e-03 3 1  ON 64
ci_0066                -6.797196e-03 3 1  ON 65
ci_0067                -5.949653e-03 3 1  ON 66
ci_0068                -6.180303e-03 3 1  ON 67
ci_0069                 5.703516e-03 3 1  ON 68
ci_0070                 5.653960e-03 3 1  ON 69
ci_0071                 4.683892e-03 3 1  ON 70
ci_0072                 4.547237e-03 3 1  ON 71
ci_0073                 5.233986e-03 3 1  ON 72
ci_0074                 5.104580e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9043
    reference variance = 0.270591
====================================================
  Execution time = 1.4224e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2016e-01
  Total weights = 1.9519e+06
  Execution time = 1.8942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003816966
                                         uncertainty =       0.002222656484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003816966
                                         uncertainty =       0.002222656484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393063945
  error estimate for blocks of size 2^( 2) =       0.000407171507
  error estimate for blocks of size 2^( 3) =       0.000421230959
  error estimate for blocks of size 2^( 4) =       0.000433928831
  error estimate for blocks of size 2^( 5) =       0.000445009110
  error estimate for blocks of size 2^( 6) =       0.000452664145
  error estimate for blocks of size 2^( 7) =       0.000456289362

      target function =                  N/A
              le_mean =     -16.903972072140
             les_mean =     286.064430244662
             stat err =       0.000446972862
             autocorr =       1.293111262140
              std dev =       0.555876361876
             le_variance =       0.308998529693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003584948
                                         uncertainty =       0.002222653639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003584948
                                         uncertainty =       0.002222653639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393063799
  error estimate for blocks of size 2^( 2) =       0.000407171224
  error estimate for blocks of size 2^( 3) =       0.000421230562
  error estimate for blocks of size 2^( 4) =       0.000433928362
  error estimate for blocks of size 2^( 5) =       0.000445008534
  error estimate for blocks of size 2^( 6) =       0.000452663461
  error estimate for blocks of size 2^( 7) =       0.000456288483

      target function =                  N/A
              le_mean =     -16.903972152910
             les_mean =     286.064430889209
             stat err =       0.000446972210
             autocorr =       1.293108451789
              std dev =       0.555876155055
             le_variance =       0.308998299759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003699834
                                         uncertainty =       0.002222655019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003699834
                                         uncertainty =       0.002222655019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393063871
  error estimate for blocks of size 2^( 2) =       0.000407171365
  error estimate for blocks of size 2^( 3) =       0.000421230759
  error estimate for blocks of size 2^( 4) =       0.000433928595
  error estimate for blocks of size 2^( 5) =       0.000445008821
  error estimate for blocks of size 2^( 6) =       0.000452663802
  error estimate for blocks of size 2^( 7) =       0.000456288921

      target function =                  N/A
              le_mean =     -16.903972112511
             les_mean =     286.064430549646
             stat err =       0.000446972535
             autocorr =       1.293109854611
              std dev =       0.555876257456
             le_variance =       0.308998413603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003802230
                                         uncertainty =       0.002222656298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309003802230
                                         uncertainty =       0.002222656298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393063936
  error estimate for blocks of size 2^( 2) =       0.000407171489
  error estimate for blocks of size 2^( 3) =       0.000421230934
  error estimate for blocks of size 2^( 4) =       0.000433928801
  error estimate for blocks of size 2^( 5) =       0.000445009074
  error estimate for blocks of size 2^( 6) =       0.000452664102
  error estimate for blocks of size 2^( 7) =       0.000456289307

      target function =                  N/A
              le_mean =     -16.903972077178
             les_mean =     286.064430280929
             stat err =       0.000446972821
             autocorr =       1.293111086164
              std dev =       0.555876348739
             le_variance =       0.308998515087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903972072140        initial
     8.8818e+01     8.8818e+02             6.2210e-06       -16.903972152910  <--
     3.5527e+02     3.5527e+03             1.5580e-06       -16.903972112511
     1.4211e+03     1.4211e+04             3.8968e-07       -16.903972077178

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 2.3823e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071355e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067425e-03 3 1  ON 39
ci_0041                 8.803937e-03 3 1  ON 40
ci_0042                 8.217826e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402893e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629771e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324394e-03 3 1  ON 52
ci_0054                -6.011589e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232785e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211063e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798232e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8987
    reference variance = 0.605399
====================================================
  Execution time = 1.4346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3380e-01
  Total weights = 1.951587007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310938204053
                                         uncertainty =       0.001846367739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310938204053
                                         uncertainty =       0.001846367739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394294942
  error estimate for blocks of size 2^( 2) =       0.000408208692
  error estimate for blocks of size 2^( 3) =       0.000422487586
  error estimate for blocks of size 2^( 4) =       0.000435979248
  error estimate for blocks of size 2^( 5) =       0.000447994436
  error estimate for blocks of size 2^( 6) =       0.000456139602
  error estimate for blocks of size 2^( 7) =       0.000458142996

      target function =                  N/A
              le_mean =     -16.904729398263
             les_mean =     286.103672396123
             stat err =       0.000449564071
             autocorr =       1.299992292906
              std dev =       0.557617254626
             le_variance =       0.310937002656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690472939826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904729398278       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904729476702       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904729489791       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904729488561       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+01 is 1.583428e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904729398278       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904729418029       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904729421421       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904729421113       residual = 1.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+01 is 3.999106e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904729398278       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904729403225       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904729404081       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904729404004       residual = 1.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+02 is 1.002343e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6956e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.003887e-01 3 1  ON 0
ci_0002                 7.002243e-01 3 1  ON 1
ci_0003                -3.036673e-02 3 1  ON 2
ci_0004                -3.057778e-02 3 1  ON 3
ci_0005                -3.343482e-02 3 1  ON 4
ci_0006                -3.394201e-02 3 1  ON 5
ci_0007                -2.263779e-02 3 1  ON 6
ci_0008                -2.270152e-02 3 1  ON 7
ci_0009                -1.989420e-02 3 1  ON 8
ci_0010                -2.011664e-02 3 1  ON 9
ci_0011                -1.499699e-02 3 1  ON 10
ci_0012                -1.519723e-02 3 1  ON 11
ci_0013                 1.560985e-02 3 1  ON 12
ci_0014                 1.627038e-02 3 1  ON 13
ci_0015                 1.538802e-02 3 1  ON 14
ci_0016                 1.557512e-02 3 1  ON 15
ci_0017                 1.439295e-02 3 1  ON 16
ci_0018                 1.386859e-02 3 1  ON 17
ci_0019                 1.190429e-02 3 1  ON 18
ci_0020                 1.146526e-02 3 1  ON 19
ci_0021                 6.814543e-03 3 1  ON 20
ci_0022                 7.918422e-03 3 1  ON 21
ci_0023                -1.164959e-02 3 1  ON 22
ci_0024                -1.179330e-02 3 1  ON 23
ci_0025                -1.139529e-02 3 1  ON 24
ci_0026                -1.202891e-02 3 1  ON 25
ci_0027                -1.115039e-02 3 1  ON 26
ci_0028                -1.143229e-02 3 1  ON 27
ci_0029                -1.055543e-02 3 1  ON 28
ci_0030                -1.097389e-02 3 1  ON 29
ci_0031                 1.829803e-02 3 1  ON 30
ci_0032                 1.900507e-02 3 1  ON 31
ci_0033                 1.117816e-02 3 1  ON 32
ci_0034                 1.065188e-02 3 1  ON 33
ci_0035                 6.831557e-03 3 1  ON 34
ci_0036                 7.069293e-03 3 1  ON 35
ci_0037                -1.152645e-02 3 1  ON 36
ci_0038                -1.113698e-02 3 1  ON 37
ci_0039                -3.698116e-03 3 1  ON 38
ci_0040                -4.070444e-03 3 1  ON 39
ci_0041                 8.802513e-03 3 1  ON 40
ci_0042                 8.217291e-03 3 1  ON 41
ci_0043                -1.420640e-02 3 1  ON 42
ci_0044                -1.386824e-02 3 1  ON 43
ci_0045                 8.405637e-03 3 1  ON 44
ci_0046                 8.737615e-03 3 1  ON 45
ci_0047                -3.167965e-03 3 1  ON 46
ci_0048                -3.496520e-03 3 1  ON 47
ci_0049                -6.627096e-03 3 1  ON 48
ci_0050                -6.535120e-03 3 1  ON 49
ci_0051                -4.574394e-03 3 1  ON 50
ci_0052                -4.624320e-03 3 1  ON 51
ci_0053                -6.324680e-03 3 1  ON 52
ci_0054                -6.010570e-03 3 1  ON 53
ci_0055                 6.956699e-03 3 1  ON 54
ci_0056                 7.234305e-03 3 1  ON 55
ci_0057                 5.185135e-03 3 1  ON 56
ci_0058                 5.229809e-03 3 1  ON 57
ci_0059                -6.108971e-03 3 1  ON 58
ci_0060                -5.554199e-03 3 1  ON 59
ci_0061                -3.813039e-03 3 1  ON 60
ci_0062                -3.522343e-03 3 1  ON 61
ci_0063                -9.211458e-03 3 1  ON 62
ci_0064                -8.806271e-03 3 1  ON 63
ci_0065                -6.440313e-03 3 1  ON 64
ci_0066                -6.798998e-03 3 1  ON 65
ci_0067                -5.947942e-03 3 1  ON 66
ci_0068                -6.179647e-03 3 1  ON 67
ci_0069                 5.702625e-03 3 1  ON 68
ci_0070                 5.651229e-03 3 1  ON 69
ci_0071                 4.683098e-03 3 1  ON 70
ci_0072                 4.545176e-03 3 1  ON 71
ci_0073                 5.232758e-03 3 1  ON 72
ci_0074                 5.106519e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.0156
    reference variance = 0.57237
====================================================
  Execution time = 1.4644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2815e-01
  Total weights = 1.9516e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316428591006
                                         uncertainty =       0.002389718991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316428591006
                                         uncertainty =       0.002389718991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397749817
  error estimate for blocks of size 2^( 2) =       0.000411485986
  error estimate for blocks of size 2^( 3) =       0.000425381671
  error estimate for blocks of size 2^( 4) =       0.000437638152
  error estimate for blocks of size 2^( 5) =       0.000448142309
  error estimate for blocks of size 2^( 6) =       0.000455919104
  error estimate for blocks of size 2^( 7) =       0.000457772655

      target function =                  N/A
              le_mean =     -16.904005977124
             les_mean =     286.073568643772
             stat err =       0.000449868055
             autocorr =       1.279234998613
              std dev =       0.562503186132
             le_variance =       0.316409834409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423278406
                                         uncertainty =       0.002389504602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423278406
                                         uncertainty =       0.002389504602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397746475
  error estimate for blocks of size 2^( 2) =       0.000411482718
  error estimate for blocks of size 2^( 3) =       0.000425378392
  error estimate for blocks of size 2^( 4) =       0.000437635101
  error estimate for blocks of size 2^( 5) =       0.000448139110
  error estimate for blocks of size 2^( 6) =       0.000455916200
  error estimate for blocks of size 2^( 7) =       0.000457769466

      target function =                  N/A
              le_mean =     -16.904005883135
             les_mean =     286.073558964810
             stat err =       0.000449864969
             autocorr =       1.279238944456
              std dev =       0.562498460009
             le_variance =       0.316404517513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316425899503
                                         uncertainty =       0.002389610559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316425899503
                                         uncertainty =       0.002389610559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397748124
  error estimate for blocks of size 2^( 2) =       0.000411484331
  error estimate for blocks of size 2^( 3) =       0.000425380010
  error estimate for blocks of size 2^( 4) =       0.000437636606
  error estimate for blocks of size 2^( 5) =       0.000448140688
  error estimate for blocks of size 2^( 6) =       0.000455917633
  error estimate for blocks of size 2^( 7) =       0.000457771042

      target function =                  N/A
              le_mean =     -16.904005927962
             les_mean =     286.073569310714
             stat err =       0.000449866492
             autocorr =       1.279237001191
              std dev =       0.562500791831
             le_variance =       0.316407140810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316428252435
                                         uncertainty =       0.002389705372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316428252435
                                         uncertainty =       0.002389705372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397749604
  error estimate for blocks of size 2^( 2) =       0.000411485778
  error estimate for blocks of size 2^( 3) =       0.000425381462
  error estimate for blocks of size 2^( 4) =       0.000437637958
  error estimate for blocks of size 2^( 5) =       0.000448142105
  error estimate for blocks of size 2^( 6) =       0.000455918919
  error estimate for blocks of size 2^( 7) =       0.000457772452

      target function =                  N/A
              le_mean =     -16.904005970817
             les_mean =     286.073568005951
             stat err =       0.000449867858
             autocorr =       1.279235249824
              std dev =       0.562502884951
             le_variance =       0.316409495578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904005977124        initial  <--
     2.2204e+01     2.2204e+02             1.5834e-05       -16.904005883135
     8.8818e+01     8.8818e+02             3.9991e-06       -16.904005927962
     3.5527e+02     3.5527e+03             1.0023e-06       -16.904005970817

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8736
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071355e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067425e-03 3 1  ON 39
ci_0041                 8.803937e-03 3 1  ON 40
ci_0042                 8.217826e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402893e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629771e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324394e-03 3 1  ON 52
ci_0054                -6.011589e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232785e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211063e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798232e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9115
    reference variance = 0.212138
====================================================
  Execution time = 1.4919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2616e-01
  Total weights = 1.951894975e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314315341646
                                         uncertainty =       0.002511536213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314315341646
                                         uncertainty =       0.002511536213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396442498
  error estimate for blocks of size 2^( 2) =       0.000410577123
  error estimate for blocks of size 2^( 3) =       0.000425096740
  error estimate for blocks of size 2^( 4) =       0.000438099694
  error estimate for blocks of size 2^( 5) =       0.000449347112
  error estimate for blocks of size 2^( 6) =       0.000458129152
  error estimate for blocks of size 2^( 7) =       0.000462757340

      target function =                  N/A
              le_mean =     -16.904162427443
             les_mean =     286.076868617185
             stat err =       0.000452083325
             autocorr =       1.300398823443
              std dev =       0.560654357686
             le_variance =       0.314333308792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690416242744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904162427463       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904162470180       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904162470651       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904162470837       residual = 2.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+02 is 1.669643e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904162427463       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904162438151       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904162438268       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904162438315       residual = 2.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+02 is 4.178927e-07

solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904162427463       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904162430135       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904162430165       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904162430176       residual = 2.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+03 is 1.045033e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7532e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.003898e-01 3 1  ON 0
ci_0002                 7.002232e-01 3 1  ON 1
ci_0003                -3.036417e-02 3 1  ON 2
ci_0004                -3.057556e-02 3 1  ON 3
ci_0005                -3.343496e-02 3 1  ON 4
ci_0006                -3.394228e-02 3 1  ON 5
ci_0007                -2.263706e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989383e-02 3 1  ON 8
ci_0010                -2.011905e-02 3 1  ON 9
ci_0011                -1.499691e-02 3 1  ON 10
ci_0012                -1.519846e-02 3 1  ON 11
ci_0013                 1.560927e-02 3 1  ON 12
ci_0014                 1.627083e-02 3 1  ON 13
ci_0015                 1.538653e-02 3 1  ON 14
ci_0016                 1.557763e-02 3 1  ON 15
ci_0017                 1.439353e-02 3 1  ON 16
ci_0018                 1.387130e-02 3 1  ON 17
ci_0019                 1.190382e-02 3 1  ON 18
ci_0020                 1.146314e-02 3 1  ON 19
ci_0021                 6.813000e-03 3 1  ON 20
ci_0022                 7.916058e-03 3 1  ON 21
ci_0023                -1.164926e-02 3 1  ON 22
ci_0024                -1.179437e-02 3 1  ON 23
ci_0025                -1.139501e-02 3 1  ON 24
ci_0026                -1.203159e-02 3 1  ON 25
ci_0027                -1.115080e-02 3 1  ON 26
ci_0028                -1.143342e-02 3 1  ON 27
ci_0029                -1.055541e-02 3 1  ON 28
ci_0030                -1.097581e-02 3 1  ON 29
ci_0031                 1.829806e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117590e-02 3 1  ON 32
ci_0034                 1.065238e-02 3 1  ON 33
ci_0035                 6.832792e-03 3 1  ON 34
ci_0036                 7.071015e-03 3 1  ON 35
ci_0037                -1.152985e-02 3 1  ON 36
ci_0038                -1.113708e-02 3 1  ON 37
ci_0039                -3.696131e-03 3 1  ON 38
ci_0040                -4.067372e-03 3 1  ON 39
ci_0041                 8.803890e-03 3 1  ON 40
ci_0042                 8.217515e-03 3 1  ON 41
ci_0043                -1.420797e-02 3 1  ON 42
ci_0044                -1.387006e-02 3 1  ON 43
ci_0045                 8.402788e-03 3 1  ON 44
ci_0046                 8.738150e-03 3 1  ON 45
ci_0047                -3.167688e-03 3 1  ON 46
ci_0048                -3.493924e-03 3 1  ON 47
ci_0049                -6.629968e-03 3 1  ON 48
ci_0050                -6.535398e-03 3 1  ON 49
ci_0051                -4.574587e-03 3 1  ON 50
ci_0052                -4.624279e-03 3 1  ON 51
ci_0053                -6.324064e-03 3 1  ON 52
ci_0054                -6.011497e-03 3 1  ON 53
ci_0055                 6.954539e-03 3 1  ON 54
ci_0056                 7.232692e-03 3 1  ON 55
ci_0057                 5.183927e-03 3 1  ON 56
ci_0058                 5.231101e-03 3 1  ON 57
ci_0059                -6.111124e-03 3 1  ON 58
ci_0060                -5.550362e-03 3 1  ON 59
ci_0061                -3.810205e-03 3 1  ON 60
ci_0062                -3.523287e-03 3 1  ON 61
ci_0063                -9.210832e-03 3 1  ON 62
ci_0064                -8.805127e-03 3 1  ON 63
ci_0065                -6.440083e-03 3 1  ON 64
ci_0066                -6.798209e-03 3 1  ON 65
ci_0067                -5.948433e-03 3 1  ON 66
ci_0068                -6.179991e-03 3 1  ON 67
ci_0069                 5.703845e-03 3 1  ON 68
ci_0070                 5.650959e-03 3 1  ON 69
ci_0071                 4.684344e-03 3 1  ON 70
ci_0072                 4.546791e-03 3 1  ON 71
ci_0073                 5.233773e-03 3 1  ON 72
ci_0074                 5.104744e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.263445
====================================================
  Execution time = 1.4218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1904e-01
  Total weights = 1.9518e+06
  Execution time = 1.8948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921873608
                                         uncertainty =       0.001958518955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921873608
                                         uncertainty =       0.001958518955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391978063
  error estimate for blocks of size 2^( 2) =       0.000406170988
  error estimate for blocks of size 2^( 3) =       0.000420970589
  error estimate for blocks of size 2^( 4) =       0.000434191005
  error estimate for blocks of size 2^( 5) =       0.000444572242
  error estimate for blocks of size 2^( 6) =       0.000451386800
  error estimate for blocks of size 2^( 7) =       0.000456815809

      target function =                  N/A
              le_mean =     -16.903970016018
             les_mean =     286.063247268444
             stat err =       0.000446741464
             autocorr =       1.298939730661
              std dev =       0.554340693545
             le_variance =       0.307293604519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921259073
                                         uncertainty =       0.001958521726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921259073
                                         uncertainty =       0.001958521726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391977602
  error estimate for blocks of size 2^( 2) =       0.000406170561
  error estimate for blocks of size 2^( 3) =       0.000420970176
  error estimate for blocks of size 2^( 4) =       0.000434190605
  error estimate for blocks of size 2^( 5) =       0.000444571876
  error estimate for blocks of size 2^( 6) =       0.000451386479
  error estimate for blocks of size 2^( 7) =       0.000456815540

      target function =                  N/A
              le_mean =     -16.903970015501
             les_mean =     286.063247180457
             stat err =       0.000446741125
             autocorr =       1.298940812068
              std dev =       0.554340041580
             le_variance =       0.307292881699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921565924
                                         uncertainty =       0.001958520344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921565924
                                         uncertainty =       0.001958520344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391977833
  error estimate for blocks of size 2^( 2) =       0.000406170774
  error estimate for blocks of size 2^( 3) =       0.000420970382
  error estimate for blocks of size 2^( 4) =       0.000434190805
  error estimate for blocks of size 2^( 5) =       0.000444572059
  error estimate for blocks of size 2^( 6) =       0.000451386639
  error estimate for blocks of size 2^( 7) =       0.000456815675

      target function =                  N/A
              le_mean =     -16.903970015739
             les_mean =     286.063247217475
             stat err =       0.000446741294
             autocorr =       1.298940271825
              std dev =       0.554340367137
             le_variance =       0.307293242638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921835123
                                         uncertainty =       0.001958519129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306921835123
                                         uncertainty =       0.001958519129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391978035
  error estimate for blocks of size 2^( 2) =       0.000406170961
  error estimate for blocks of size 2^( 3) =       0.000420970563
  error estimate for blocks of size 2^( 4) =       0.000434190980
  error estimate for blocks of size 2^( 5) =       0.000444572219
  error estimate for blocks of size 2^( 6) =       0.000451386780
  error estimate for blocks of size 2^( 7) =       0.000456815793

      target function =                  N/A
              le_mean =     -16.903970015981
             les_mean =     286.063247261289
             stat err =       0.000446741443
             autocorr =       1.298939798322
              std dev =       0.554340652720
             le_variance =       0.307293559258


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903970016018        initial  <--
     2.2204e+02     2.2204e+03             1.6696e-06       -16.903970015501
     8.8818e+02     8.8818e+03             4.1789e-07       -16.903970015739
     3.5527e+03     3.5527e+04             1.0450e-07       -16.903970015981

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8059
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071355e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067425e-03 3 1  ON 39
ci_0041                 8.803937e-03 3 1  ON 40
ci_0042                 8.217826e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402893e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629771e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324394e-03 3 1  ON 52
ci_0054                -6.011589e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232785e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211063e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798232e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.86
    reference variance = 0.205545
====================================================
  Execution time = 1.4999e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2088e-01
  Total weights = 1.951467797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310616218688
                                         uncertainty =       0.001794758124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310616218688
                                         uncertainty =       0.001794758124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394106742
  error estimate for blocks of size 2^( 2) =       0.000408063640
  error estimate for blocks of size 2^( 3) =       0.000422358722
  error estimate for blocks of size 2^( 4) =       0.000435493062
  error estimate for blocks of size 2^( 5) =       0.000446276836
  error estimate for blocks of size 2^( 6) =       0.000452939814
  error estimate for blocks of size 2^( 7) =       0.000457747749

      target function =                  N/A
              le_mean =     -16.905058840910
             les_mean =     286.101889788064
             stat err =       0.000448114365
             autocorr =       1.292855546832
              std dev =       0.557351100017
             le_variance =       0.310640248690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690505884091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905058840955       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905058841220       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905058841258       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+03 is 1.484327e-07

solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905058840955       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905058841021       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905058841031       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+03 is 3.711188e-08

solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905058840955       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905058840972       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905058840974       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+04 is 9.278201e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7607e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036398e-02 3 1  ON 2
ci_0004                -3.057564e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394212e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270302e-02 3 1  ON 7
ci_0009                -1.989372e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499668e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627093e-02 3 1  ON 13
ci_0015                 1.538637e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439379e-02 3 1  ON 16
ci_0018                 1.387103e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146314e-02 3 1  ON 19
ci_0021                 6.813069e-03 3 1  ON 20
ci_0022                 7.916069e-03 3 1  ON 21
ci_0023                -1.164943e-02 3 1  ON 22
ci_0024                -1.179450e-02 3 1  ON 23
ci_0025                -1.139506e-02 3 1  ON 24
ci_0026                -1.203178e-02 3 1  ON 25
ci_0027                -1.115069e-02 3 1  ON 26
ci_0028                -1.143355e-02 3 1  ON 27
ci_0029                -1.055525e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900484e-02 3 1  ON 31
ci_0033                 1.117612e-02 3 1  ON 32
ci_0034                 1.065249e-02 3 1  ON 33
ci_0035                 6.832654e-03 3 1  ON 34
ci_0036                 7.071369e-03 3 1  ON 35
ci_0037                -1.152996e-02 3 1  ON 36
ci_0038                -1.113720e-02 3 1  ON 37
ci_0039                -3.695858e-03 3 1  ON 38
ci_0040                -4.067413e-03 3 1  ON 39
ci_0041                 8.803929e-03 3 1  ON 40
ci_0042                 8.217844e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387011e-02 3 1  ON 43
ci_0045                 8.402895e-03 3 1  ON 44
ci_0046                 8.738320e-03 3 1  ON 45
ci_0047                -3.167574e-03 3 1  ON 46
ci_0048                -3.493866e-03 3 1  ON 47
ci_0049                -6.629778e-03 3 1  ON 48
ci_0050                -6.535310e-03 3 1  ON 49
ci_0051                -4.574608e-03 3 1  ON 50
ci_0052                -4.624393e-03 3 1  ON 51
ci_0053                -6.324396e-03 3 1  ON 52
ci_0054                -6.011587e-03 3 1  ON 53
ci_0055                 6.954620e-03 3 1  ON 54
ci_0056                 7.232770e-03 3 1  ON 55
ci_0057                 5.183955e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111153e-03 3 1  ON 58
ci_0060                -5.550237e-03 3 1  ON 59
ci_0061                -3.810146e-03 3 1  ON 60
ci_0062                -3.523166e-03 3 1  ON 61
ci_0063                -9.211050e-03 3 1  ON 62
ci_0064                -8.805123e-03 3 1  ON 63
ci_0065                -6.439983e-03 3 1  ON 64
ci_0066                -6.798224e-03 3 1  ON 65
ci_0067                -5.948478e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704196e-03 3 1  ON 68
ci_0070                 5.651208e-03 3 1  ON 69
ci_0071                 4.684321e-03 3 1  ON 70
ci_0072                 4.546896e-03 3 1  ON 71
ci_0073                 5.233378e-03 3 1  ON 72
ci_0074                 5.104554e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.7617
    reference variance = 0.629488
====================================================
  Execution time = 1.4095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3030e-01
  Total weights = 1.9515e+06
  Execution time = 1.9090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263919123
                                         uncertainty =       0.002867275409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263919123
                                         uncertainty =       0.002867275409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397031444
  error estimate for blocks of size 2^( 2) =       0.000411581151
  error estimate for blocks of size 2^( 3) =       0.000426657413
  error estimate for blocks of size 2^( 4) =       0.000440656863
  error estimate for blocks of size 2^( 5) =       0.000453026771
  error estimate for blocks of size 2^( 6) =       0.000462398136
  error estimate for blocks of size 2^( 7) =       0.000469106459

      target function =                  N/A
              le_mean =     -16.903601731235
             les_mean =     286.062053943581
             stat err =       0.000456297057
             autocorr =       1.320825754561
              std dev =       0.561487253097
             le_variance =       0.315267935390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263944540
                                         uncertainty =       0.002867265905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263944540
                                         uncertainty =       0.002867265905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397031460
  error estimate for blocks of size 2^( 2) =       0.000411581166
  error estimate for blocks of size 2^( 3) =       0.000426657428
  error estimate for blocks of size 2^( 4) =       0.000440656877
  error estimate for blocks of size 2^( 5) =       0.000453026789
  error estimate for blocks of size 2^( 6) =       0.000462398156
  error estimate for blocks of size 2^( 7) =       0.000469106482

      target function =                  N/A
              le_mean =     -16.903601729135
             les_mean =     286.062053586546
             stat err =       0.000456297076
             autocorr =       1.320825758042
              std dev =       0.561487275494
             le_variance =       0.315267960542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263931832
                                         uncertainty =       0.002867270657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263931832
                                         uncertainty =       0.002867270657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397031452
  error estimate for blocks of size 2^( 2) =       0.000411581159
  error estimate for blocks of size 2^( 3) =       0.000426657421
  error estimate for blocks of size 2^( 4) =       0.000440656870
  error estimate for blocks of size 2^( 5) =       0.000453026780
  error estimate for blocks of size 2^( 6) =       0.000462398146
  error estimate for blocks of size 2^( 7) =       0.000469106470

      target function =                  N/A
              le_mean =     -16.903601730184
             les_mean =     286.062053764675
             stat err =       0.000456297067
             autocorr =       1.320825756294
              std dev =       0.561487264295
             le_variance =       0.315267947966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263920712
                                         uncertainty =       0.002867274814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315263920712
                                         uncertainty =       0.002867274814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397031445
  error estimate for blocks of size 2^( 2) =       0.000411581152
  error estimate for blocks of size 2^( 3) =       0.000426657414
  error estimate for blocks of size 2^( 4) =       0.000440656864
  error estimate for blocks of size 2^( 5) =       0.000453026772
  error estimate for blocks of size 2^( 6) =       0.000462398137
  error estimate for blocks of size 2^( 7) =       0.000469106460

      target function =                  N/A
              le_mean =     -16.903601731103
             les_mean =     286.062053921177
             stat err =       0.000456297058
             autocorr =       1.320825754771
              std dev =       0.561487254496
             le_variance =       0.315267936962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903601731235        initial  <--
     2.2204e+03     2.2204e+04             1.4843e-07       -16.903601729135
     8.8818e+03     8.8818e+04             3.7112e-08       -16.903601730184
     3.5527e+04     3.5527e+05             9.2782e-09       -16.903601731103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7083
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071355e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067425e-03 3 1  ON 39
ci_0041                 8.803937e-03 3 1  ON 40
ci_0042                 8.217826e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402893e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629771e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324394e-03 3 1  ON 52
ci_0054                -6.011589e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232785e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211063e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798232e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1321e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.7848
    reference variance = 0.508934
====================================================
  Execution time = 1.4466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2898e-01
  Total weights = 1.952165360e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316659067074
                                         uncertainty =       0.002976043579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316659067074
                                         uncertainty =       0.002976043579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397844997
  error estimate for blocks of size 2^( 2) =       0.000411748031
  error estimate for blocks of size 2^( 3) =       0.000426230799
  error estimate for blocks of size 2^( 4) =       0.000438645733
  error estimate for blocks of size 2^( 5) =       0.000449052064
  error estimate for blocks of size 2^( 6) =       0.000455975483
  error estimate for blocks of size 2^( 7) =       0.000461418591

      target function =                  N/A
              le_mean =     -16.904690107388
             les_mean =     286.097531291895
             stat err =       0.000451272968
             autocorr =       1.286621596397
              std dev =       0.562637790061
             le_variance =       0.316561282805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690469010739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904690107422       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904690107520       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904690107510       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+04 is 1.847743e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904690107422       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904690107446       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904690107444       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+04 is 4.619416e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904690107422       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904690107428       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904690107427       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+05 is 1.154858e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191155 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7079e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190366e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813051e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071357e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695848e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803937e-03 3 1  ON 40
ci_0042                 8.217828e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738319e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493872e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624422e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011589e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183937e-03 3 1  ON 56
ci_0058                 5.231167e-03 3 1  ON 57
ci_0059                -6.111136e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810144e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211064e-03 3 1  ON 62
ci_0064                -8.805099e-03 3 1  ON 63
ci_0065                -6.439990e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180269e-03 3 1  ON 67
ci_0069                 5.704203e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684333e-03 3 1  ON 70
ci_0072                 4.546900e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.885
    reference variance = 0.126134
====================================================
  Execution time = 1.4286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2346e-01
  Total weights = 1.9520e+06
  Execution time = 1.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601943582
                                         uncertainty =       0.001802454905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601943582
                                         uncertainty =       0.001802454905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393454304
  error estimate for blocks of size 2^( 2) =       0.000407235088
  error estimate for blocks of size 2^( 3) =       0.000421139565
  error estimate for blocks of size 2^( 4) =       0.000434373430
  error estimate for blocks of size 2^( 5) =       0.000444337133
  error estimate for blocks of size 2^( 6) =       0.000451865671
  error estimate for blocks of size 2^( 7) =       0.000454617328

      target function =                  N/A
              le_mean =     -16.904689740698
             les_mean =     286.091995635216
             stat err =       0.000446298391
             autocorr =       1.286654790419
              std dev =       0.556428412624
             le_variance =       0.309612578375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601937685
                                         uncertainty =       0.001802455598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601937685
                                         uncertainty =       0.001802455598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393454300
  error estimate for blocks of size 2^( 2) =       0.000407235084
  error estimate for blocks of size 2^( 3) =       0.000421139561
  error estimate for blocks of size 2^( 4) =       0.000434373427
  error estimate for blocks of size 2^( 5) =       0.000444337129
  error estimate for blocks of size 2^( 6) =       0.000451865667
  error estimate for blocks of size 2^( 7) =       0.000454617324

      target function =                  N/A
              le_mean =     -16.904689740600
             les_mean =     286.091995594435
             stat err =       0.000446298387
             autocorr =       1.286654792012
              std dev =       0.556428407343
             le_variance =       0.309612572499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601940634
                                         uncertainty =       0.001802455252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601940634
                                         uncertainty =       0.001802455252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393454302
  error estimate for blocks of size 2^( 2) =       0.000407235086
  error estimate for blocks of size 2^( 3) =       0.000421139563
  error estimate for blocks of size 2^( 4) =       0.000434373428
  error estimate for blocks of size 2^( 5) =       0.000444337131
  error estimate for blocks of size 2^( 6) =       0.000451865669
  error estimate for blocks of size 2^( 7) =       0.000454617326

      target function =                  N/A
              le_mean =     -16.904689740649
             les_mean =     286.091995614824
             stat err =       0.000446298389
             autocorr =       1.286654791217
              std dev =       0.556428409984
             le_variance =       0.309612575437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601943214
                                         uncertainty =       0.001802454948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309601943214
                                         uncertainty =       0.001802454948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393454304
  error estimate for blocks of size 2^( 2) =       0.000407235087
  error estimate for blocks of size 2^( 3) =       0.000421139565
  error estimate for blocks of size 2^( 4) =       0.000434373430
  error estimate for blocks of size 2^( 5) =       0.000444337133
  error estimate for blocks of size 2^( 6) =       0.000451865671
  error estimate for blocks of size 2^( 7) =       0.000454617328

      target function =                  N/A
              le_mean =     -16.904689740692
             les_mean =     286.091995632667
             stat err =       0.000446298390
             autocorr =       1.286654790512
              std dev =       0.556428412294
             le_variance =       0.309612578008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904689740698        initial  <--
     2.2204e+04     2.2204e+05             1.8477e-08       -16.904689740600
     8.8818e+04     8.8818e+05             4.6194e-09       -16.904689740649
     3.5527e+05     3.5527e+06             1.1549e-09       -16.904689740692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8419
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071355e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067425e-03 3 1  ON 39
ci_0041                 8.803937e-03 3 1  ON 40
ci_0042                 8.217826e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402893e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629771e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324394e-03 3 1  ON 52
ci_0054                -6.011589e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232785e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211063e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798232e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9
    reference variance = 0.264506
====================================================
  Execution time = 1.4473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2386e-01
  Total weights = 1.951911316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312778203547
                                         uncertainty =       0.001805937072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312778203547
                                         uncertainty =       0.001805937072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395427900
  error estimate for blocks of size 2^( 2) =       0.000409669040
  error estimate for blocks of size 2^( 3) =       0.000423805398
  error estimate for blocks of size 2^( 4) =       0.000437295544
  error estimate for blocks of size 2^( 5) =       0.000447447180
  error estimate for blocks of size 2^( 6) =       0.000453908688
  error estimate for blocks of size 2^( 7) =       0.000460497302

      target function =                  N/A
              le_mean =     -16.904662489288
             les_mean =     286.091474498826
             stat err =       0.000449787178
             autocorr =       1.293836877561
              std dev =       0.559219499421
             le_variance =       0.312726448533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690466248929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904662489311       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904662489321       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904662489320       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904662489320       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 1.710792e-09

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904662489311       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904662489313       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904662489313       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904662489313       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 4.276983e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904662489311       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904662489311       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904662489311       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904662489311       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.5527e+06 is 1.069247e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7067e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067425e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217826e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402893e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167564e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629771e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324394e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232785e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550200e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211063e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798232e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.435247
====================================================
  Execution time = 1.4250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2046e-01
  Total weights = 1.9514e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053657256
                                         uncertainty =       0.001832669933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053657256
                                         uncertainty =       0.001832669933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393093677
  error estimate for blocks of size 2^( 2) =       0.000406760452
  error estimate for blocks of size 2^( 3) =       0.000421114831
  error estimate for blocks of size 2^( 4) =       0.000433162266
  error estimate for blocks of size 2^( 5) =       0.000443361221
  error estimate for blocks of size 2^( 6) =       0.000450793413
  error estimate for blocks of size 2^( 7) =       0.000456327514

      target function =                  N/A
              le_mean =     -16.903860917081
             les_mean =     286.060974316908
             stat err =       0.000445911104
             autocorr =       1.286780461976
              std dev =       0.555918408743
             le_variance =       0.309045277179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053656557
                                         uncertainty =       0.001832669932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053656557
                                         uncertainty =       0.001832669932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393093676
  error estimate for blocks of size 2^( 2) =       0.000406760452
  error estimate for blocks of size 2^( 3) =       0.000421114830
  error estimate for blocks of size 2^( 4) =       0.000433162265
  error estimate for blocks of size 2^( 5) =       0.000443361221
  error estimate for blocks of size 2^( 6) =       0.000450793413
  error estimate for blocks of size 2^( 7) =       0.000456327514

      target function =                  N/A
              le_mean =     -16.903860917090
             les_mean =     286.060974310780
             stat err =       0.000445911103
             autocorr =       1.286780463009
              std dev =       0.555918408114
             le_variance =       0.309045276480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053656907
                                         uncertainty =       0.001832669933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053656907
                                         uncertainty =       0.001832669933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393093676
  error estimate for blocks of size 2^( 2) =       0.000406760452
  error estimate for blocks of size 2^( 3) =       0.000421114831
  error estimate for blocks of size 2^( 4) =       0.000433162265
  error estimate for blocks of size 2^( 5) =       0.000443361221
  error estimate for blocks of size 2^( 6) =       0.000450793413
  error estimate for blocks of size 2^( 7) =       0.000456327514

      target function =                  N/A
              le_mean =     -16.903860917085
             les_mean =     286.060974313844
             stat err =       0.000445911103
             autocorr =       1.286780462495
              std dev =       0.555918408428
             le_variance =       0.309045276829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053657212
                                         uncertainty =       0.001832669933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309053657212
                                         uncertainty =       0.001832669933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393093677
  error estimate for blocks of size 2^( 2) =       0.000406760452
  error estimate for blocks of size 2^( 3) =       0.000421114831
  error estimate for blocks of size 2^( 4) =       0.000433162265
  error estimate for blocks of size 2^( 5) =       0.000443361221
  error estimate for blocks of size 2^( 6) =       0.000450793413
  error estimate for blocks of size 2^( 7) =       0.000456327514

      target function =                  N/A
              le_mean =     -16.903860917082
             les_mean =     286.060974316525
             stat err =       0.000445911104
             autocorr =       1.286780462043
              std dev =       0.555918408703
             le_variance =       0.309045277135


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903860917081        initial
     2.2204e+05     2.2204e+06             1.7108e-09       -16.903860917090  <--
     8.8818e+05     8.8818e+06             4.2770e-10       -16.903860917085
     3.5527e+06     3.5527e+07             1.0692e-10       -16.903860917082

*****************************************************************************
Applying the update for shift_i =   2.2204e+05     and shift_s =   2.2204e+06
*****************************************************************************

  Execution time = 2.4028e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8587
    reference variance = 0.284762
====================================================
  Execution time = 1.4422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2311e-01
  Total weights = 1.952049714e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310841642299
                                         uncertainty =       0.001916909458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310841642299
                                         uncertainty =       0.001916909458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394293804
  error estimate for blocks of size 2^( 2) =       0.000408544619
  error estimate for blocks of size 2^( 3) =       0.000422880722
  error estimate for blocks of size 2^( 4) =       0.000435765783
  error estimate for blocks of size 2^( 5) =       0.000447093359
  error estimate for blocks of size 2^( 6) =       0.000455522026
  error estimate for blocks of size 2^( 7) =       0.000460468067

      target function =                  N/A
              le_mean =     -16.903961987185
             les_mean =     286.067037085811
             stat err =       0.000449712309
             autocorr =       1.300857257853
              std dev =       0.557615644697
             le_variance =       0.310935207211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690396198719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903961987198       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903961987296       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903961987287       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+04 is 7.846976e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903961987198       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903961987223       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903961987221       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+05 is 1.961750e-09

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903961987198       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903961987205       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903961987204       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+05 is 4.904381e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7009e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439380e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055525e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071357e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695845e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493870e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954631e-03 3 1  ON 54
ci_0056                 7.232783e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231165e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550202e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805103e-03 3 1  ON 63
ci_0065                -6.439992e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651201e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546901e-03 3 1  ON 71
ci_0073                 5.233355e-03 3 1  ON 72
ci_0074                 5.104537e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9841
    reference variance = 0.447513
====================================================
  Execution time = 1.4416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2194e-01
  Total weights = 1.9516e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140708478
                                         uncertainty =       0.002338865653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140708478
                                         uncertainty =       0.002338865653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394461688
  error estimate for blocks of size 2^( 2) =       0.000408235249
  error estimate for blocks of size 2^( 3) =       0.000421882039
  error estimate for blocks of size 2^( 4) =       0.000434175559
  error estimate for blocks of size 2^( 5) =       0.000444163214
  error estimate for blocks of size 2^( 6) =       0.000452134976
  error estimate for blocks of size 2^( 7) =       0.000453898224

      target function =                  N/A
              le_mean =     -16.904042519863
             les_mean =     286.068588745165
             stat err =       0.000446092993
             autocorr =       1.278913422607
              std dev =       0.557853069604
             le_variance =       0.311200047266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140709183
                                         uncertainty =       0.002338865958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140709183
                                         uncertainty =       0.002338865958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394461689
  error estimate for blocks of size 2^( 2) =       0.000408235250
  error estimate for blocks of size 2^( 3) =       0.000421882040
  error estimate for blocks of size 2^( 4) =       0.000434175560
  error estimate for blocks of size 2^( 5) =       0.000444163215
  error estimate for blocks of size 2^( 6) =       0.000452134976
  error estimate for blocks of size 2^( 7) =       0.000453898225

      target function =                  N/A
              le_mean =     -16.904042519843
             les_mean =     286.068588743236
             stat err =       0.000446092994
             autocorr =       1.278913422527
              std dev =       0.557853070216
             le_variance =       0.311200047949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140708830
                                         uncertainty =       0.002338865806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140708830
                                         uncertainty =       0.002338865806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394461689
  error estimate for blocks of size 2^( 2) =       0.000408235249
  error estimate for blocks of size 2^( 3) =       0.000421882039
  error estimate for blocks of size 2^( 4) =       0.000434175560
  error estimate for blocks of size 2^( 5) =       0.000444163215
  error estimate for blocks of size 2^( 6) =       0.000452134976
  error estimate for blocks of size 2^( 7) =       0.000453898225

      target function =                  N/A
              le_mean =     -16.904042519853
             les_mean =     286.068588744200
             stat err =       0.000446092994
             autocorr =       1.278913422569
              std dev =       0.557853069910
             le_variance =       0.311200047608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140708522
                                         uncertainty =       0.002338865672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311140708522
                                         uncertainty =       0.002338865672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394461688
  error estimate for blocks of size 2^( 2) =       0.000408235249
  error estimate for blocks of size 2^( 3) =       0.000421882039
  error estimate for blocks of size 2^( 4) =       0.000434175559
  error estimate for blocks of size 2^( 5) =       0.000444163214
  error estimate for blocks of size 2^( 6) =       0.000452134976
  error estimate for blocks of size 2^( 7) =       0.000453898224

      target function =                  N/A
              le_mean =     -16.904042519862
             les_mean =     286.068588745045
             stat err =       0.000446092993
             autocorr =       1.278913422603
              std dev =       0.557853069642
             le_variance =       0.311200047309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904042519863        initial  <--
     5.5511e+04     5.5511e+05             7.8470e-09       -16.904042519843
     2.2204e+05     2.2204e+06             1.9618e-09       -16.904042519853
     8.8818e+05     8.8818e+06             4.9044e-10       -16.904042519862

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9687
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9638
    reference variance = 0.206588
====================================================
  Execution time = 1.4628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2026e-01
  Total weights = 1.952171747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309751642771
                                         uncertainty =       0.002170517852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309751642771
                                         uncertainty =       0.002170517852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393543793
  error estimate for blocks of size 2^( 2) =       0.000408039836
  error estimate for blocks of size 2^( 3) =       0.000422882159
  error estimate for blocks of size 2^( 4) =       0.000436283752
  error estimate for blocks of size 2^( 5) =       0.000447163790
  error estimate for blocks of size 2^( 6) =       0.000455688922
  error estimate for blocks of size 2^( 7) =       0.000461537966

      target function =                  N/A
              le_mean =     -16.904442546459
             les_mean =     286.080441462319
             stat err =       0.000450168608
             autocorr =       1.308471531066
              std dev =       0.556554969686
             le_variance =       0.309753434282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690444254646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+05, overlap shift 5.5511e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904442546511       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904442546508       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904442546509       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904442546509       residual = 1.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+05 is 6.458704e-10

solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904442546511       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904442546510       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904442546510       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904442546580       residual = 1.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+06 is 1.614676e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904442546511       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904442546511       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904442546511       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904442546606       residual = 1.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+06 is 4.036691e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7230e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738322e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439992e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.162426
====================================================
  Execution time = 1.4372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2043e-01
  Total weights = 1.9517e+06
  Execution time = 1.8930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971482
                                         uncertainty =       0.001953690206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971482
                                         uncertainty =       0.001953690206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393558715
  error estimate for blocks of size 2^( 2) =       0.000407165201
  error estimate for blocks of size 2^( 3) =       0.000421859130
  error estimate for blocks of size 2^( 4) =       0.000434038502
  error estimate for blocks of size 2^( 5) =       0.000445065494
  error estimate for blocks of size 2^( 6) =       0.000452125372
  error estimate for blocks of size 2^( 7) =       0.000456398977

      target function =                  N/A
              le_mean =     -16.904911863274
             les_mean =     286.096478370341
             stat err =       0.000446907086
             autocorr =       1.289482387970
              std dev =       0.556576071887
             le_variance =       0.309776923797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971180
                                         uncertainty =       0.001953690181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971180
                                         uncertainty =       0.001953690181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393558714
  error estimate for blocks of size 2^( 2) =       0.000407165200
  error estimate for blocks of size 2^( 3) =       0.000421859129
  error estimate for blocks of size 2^( 4) =       0.000434038501
  error estimate for blocks of size 2^( 5) =       0.000445065494
  error estimate for blocks of size 2^( 6) =       0.000452125372
  error estimate for blocks of size 2^( 7) =       0.000456398977

      target function =                  N/A
              le_mean =     -16.904911863263
             les_mean =     286.096478369711
             stat err =       0.000446907086
             autocorr =       1.289482388215
              std dev =       0.556576071616
             le_variance =       0.309776923495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971331
                                         uncertainty =       0.001953690193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971331
                                         uncertainty =       0.001953690193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393558715
  error estimate for blocks of size 2^( 2) =       0.000407165200
  error estimate for blocks of size 2^( 3) =       0.000421859129
  error estimate for blocks of size 2^( 4) =       0.000434038502
  error estimate for blocks of size 2^( 5) =       0.000445065494
  error estimate for blocks of size 2^( 6) =       0.000452125372
  error estimate for blocks of size 2^( 7) =       0.000456398977

      target function =                  N/A
              le_mean =     -16.904911863268
             les_mean =     286.096478370026
             stat err =       0.000446907086
             autocorr =       1.289482388091
              std dev =       0.556576071751
             le_variance =       0.309776923646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971464
                                         uncertainty =       0.001953690204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309800971464
                                         uncertainty =       0.001953690204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393558715
  error estimate for blocks of size 2^( 2) =       0.000407165201
  error estimate for blocks of size 2^( 3) =       0.000421859129
  error estimate for blocks of size 2^( 4) =       0.000434038502
  error estimate for blocks of size 2^( 5) =       0.000445065494
  error estimate for blocks of size 2^( 6) =       0.000452125372
  error estimate for blocks of size 2^( 7) =       0.000456398977

      target function =                  N/A
              le_mean =     -16.904911863273
             les_mean =     286.096478370302
             stat err =       0.000446907086
             autocorr =       1.289482387991
              std dev =       0.556576071870
             le_variance =       0.309776923778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904911863274        initial  <--
     5.5511e+05     5.5511e+06             6.4587e-10       -16.904911863263
     2.2204e+06     2.2204e+07             1.6147e-10       -16.904911863268
     8.8818e+06     8.8818e+07             4.0367e-11       -16.904911863273

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9600
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8608
    reference variance = 0.231389
====================================================
  Execution time = 1.4537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2634e-01
  Total weights = 1.951567153e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315297024833
                                         uncertainty =       0.003043809212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315297024833
                                         uncertainty =       0.003043809212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397042869
  error estimate for blocks of size 2^( 2) =       0.000411211651
  error estimate for blocks of size 2^( 3) =       0.000425222596
  error estimate for blocks of size 2^( 4) =       0.000438461855
  error estimate for blocks of size 2^( 5) =       0.000449333488
  error estimate for blocks of size 2^( 6) =       0.000458330525
  error estimate for blocks of size 2^( 7) =       0.000464579606

      target function =                  N/A
              le_mean =     -16.904183684064
             les_mean =     286.077765554680
             stat err =       0.000452676368
             autocorr =       1.299872770571
              std dev =       0.561503409514
             le_variance =       0.315286078896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690418368406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904183684084       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904183684084       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904183684084       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904183684084       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+06 is 4.741779e-11

solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904183684084       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904183684084       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904183684084       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904183683726       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+07 is 1.185445e-11

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904183684084       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904183684084       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904183684084       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904183684084       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+07 is 2.963613e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7152e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.289617
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5738e-01
  Total weights = 1.9518e+06
  Execution time = 1.9246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063514
                                         uncertainty =       0.016068606367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063514
                                         uncertainty =       0.016068606367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407658277
  error estimate for blocks of size 2^( 2) =       0.000421312916
  error estimate for blocks of size 2^( 3) =       0.000434838549
  error estimate for blocks of size 2^( 4) =       0.000447320538
  error estimate for blocks of size 2^( 5) =       0.000457797347
  error estimate for blocks of size 2^( 6) =       0.000466362462
  error estimate for blocks of size 2^( 7) =       0.000472494147

      target function =                  N/A
              le_mean =     -16.904958345195
             les_mean =     286.134994022045
             stat err =       0.000460993623
             autocorr =       1.278784331624
              std dev =       0.576515864646
             le_variance =       0.332370542188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063885
                                         uncertainty =       0.016068606629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063885
                                         uncertainty =       0.016068606629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407658278
  error estimate for blocks of size 2^( 2) =       0.000421312916
  error estimate for blocks of size 2^( 3) =       0.000434838549
  error estimate for blocks of size 2^( 4) =       0.000447320538
  error estimate for blocks of size 2^( 5) =       0.000457797347
  error estimate for blocks of size 2^( 6) =       0.000466362462
  error estimate for blocks of size 2^( 7) =       0.000472494148

      target function =                  N/A
              le_mean =     -16.904958345194
             les_mean =     286.134994022540
             stat err =       0.000460993624
             autocorr =       1.278784331322
              std dev =       0.576515864967
             le_variance =       0.332370542559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063699
                                         uncertainty =       0.016068606498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063699
                                         uncertainty =       0.016068606498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407658277
  error estimate for blocks of size 2^( 2) =       0.000421312916
  error estimate for blocks of size 2^( 3) =       0.000434838549
  error estimate for blocks of size 2^( 4) =       0.000447320538
  error estimate for blocks of size 2^( 5) =       0.000457797347
  error estimate for blocks of size 2^( 6) =       0.000466362462
  error estimate for blocks of size 2^( 7) =       0.000472494147

      target function =                  N/A
              le_mean =     -16.904958345194
             les_mean =     286.134994022293
             stat err =       0.000460993624
             autocorr =       1.278784331473
              std dev =       0.576515864806
             le_variance =       0.332370542373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063537
                                         uncertainty =       0.016068606384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332293063537
                                         uncertainty =       0.016068606384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407658277
  error estimate for blocks of size 2^( 2) =       0.000421312916
  error estimate for blocks of size 2^( 3) =       0.000434838549
  error estimate for blocks of size 2^( 4) =       0.000447320538
  error estimate for blocks of size 2^( 5) =       0.000457797347
  error estimate for blocks of size 2^( 6) =       0.000466362462
  error estimate for blocks of size 2^( 7) =       0.000472494147

      target function =                  N/A
              le_mean =     -16.904958345195
             les_mean =     286.134994022076
             stat err =       0.000460993623
             autocorr =       1.278784331612
              std dev =       0.576515864666
             le_variance =       0.332370542211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904958345195        initial  <--
     5.5511e+06     5.5511e+07             4.7418e-11       -16.904958345194
     2.2204e+07     2.2204e+08             1.1854e-11       -16.904958345194
     8.8818e+07     8.8818e+08             2.9636e-12       -16.904958345195

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8256
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.416019
====================================================
  Execution time = 1.6921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1908e-01
  Total weights = 1.951358894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308604389197
                                         uncertainty =       0.001620487558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308604389197
                                         uncertainty =       0.001620487558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392800938
  error estimate for blocks of size 2^( 2) =       0.000406977667
  error estimate for blocks of size 2^( 3) =       0.000421065124
  error estimate for blocks of size 2^( 4) =       0.000434244477
  error estimate for blocks of size 2^( 5) =       0.000445008806
  error estimate for blocks of size 2^( 6) =       0.000454069246
  error estimate for blocks of size 2^( 7) =       0.000460561695

      target function =                  N/A
              le_mean =     -16.904285952087
             les_mean =     286.073968333749
             stat err =       0.000448471056
             autocorr =       1.303538328694
              std dev =       0.555504414264
             le_variance =       0.308585154267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690428595209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904285952082       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904285952082       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904285952082       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+07 is 4.965513e-12

solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904285952082       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904285952082       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904285952082       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+08 is 1.241378e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904285952082       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904285952082       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904285952082       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+08 is 3.103358e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9496e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.233068
====================================================
  Execution time = 1.4166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2522e-01
  Total weights = 1.9517e+06
  Execution time = 1.8918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806614
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806614
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395320782
  error estimate for blocks of size 2^( 2) =       0.000409236158
  error estimate for blocks of size 2^( 3) =       0.000423488979
  error estimate for blocks of size 2^( 4) =       0.000436089307
  error estimate for blocks of size 2^( 5) =       0.000448979806
  error estimate for blocks of size 2^( 6) =       0.000458274089
  error estimate for blocks of size 2^( 7) =       0.000465382763

      target function =                  N/A
              le_mean =     -16.904288512394
             les_mean =     286.080189543742
             stat err =       0.000452181491
             autocorr =       1.308357032643
              std dev =       0.559068010760
             le_variance =       0.312557040655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806613
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806613
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395320782
  error estimate for blocks of size 2^( 2) =       0.000409236158
  error estimate for blocks of size 2^( 3) =       0.000423488979
  error estimate for blocks of size 2^( 4) =       0.000436089307
  error estimate for blocks of size 2^( 5) =       0.000448979806
  error estimate for blocks of size 2^( 6) =       0.000458274089
  error estimate for blocks of size 2^( 7) =       0.000465382763

      target function =                  N/A
              le_mean =     -16.904288512394
             les_mean =     286.080189543751
             stat err =       0.000452181491
             autocorr =       1.308357032645
              std dev =       0.559068010759
             le_variance =       0.312557040654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806614
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806614
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395320782
  error estimate for blocks of size 2^( 2) =       0.000409236158
  error estimate for blocks of size 2^( 3) =       0.000423488979
  error estimate for blocks of size 2^( 4) =       0.000436089307
  error estimate for blocks of size 2^( 5) =       0.000448979806
  error estimate for blocks of size 2^( 6) =       0.000458274089
  error estimate for blocks of size 2^( 7) =       0.000465382763

      target function =                  N/A
              le_mean =     -16.904288512394
             les_mean =     286.080189543747
             stat err =       0.000452181491
             autocorr =       1.308357032642
              std dev =       0.559068010760
             le_variance =       0.312557040655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806614
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312636806614
                                         uncertainty =       0.002588957379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395320782
  error estimate for blocks of size 2^( 2) =       0.000409236158
  error estimate for blocks of size 2^( 3) =       0.000423488979
  error estimate for blocks of size 2^( 4) =       0.000436089307
  error estimate for blocks of size 2^( 5) =       0.000448979806
  error estimate for blocks of size 2^( 6) =       0.000458274089
  error estimate for blocks of size 2^( 7) =       0.000465382763

      target function =                  N/A
              le_mean =     -16.904288512394
             les_mean =     286.080189543743
             stat err =       0.000452181491
             autocorr =       1.308357032637
              std dev =       0.559068010760
             le_variance =       0.312557040655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904288512394        initial  <--
     5.5511e+07     5.5511e+08             4.9655e-12       -16.904288512394
     2.2204e+08     2.2204e+09             1.2414e-12       -16.904288512394
     8.8818e+08     8.8818e+09             3.1034e-13       -16.904288512394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7419
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3243e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.861
    reference variance = 0.190486
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2584e-01
  Total weights = 1.951491438e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313019319415
                                         uncertainty =       0.003003934373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313019319415
                                         uncertainty =       0.003003934373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395559706
  error estimate for blocks of size 2^( 2) =       0.000409780504
  error estimate for blocks of size 2^( 3) =       0.000423619948
  error estimate for blocks of size 2^( 4) =       0.000436626504
  error estimate for blocks of size 2^( 5) =       0.000446159346
  error estimate for blocks of size 2^( 6) =       0.000453983038
  error estimate for blocks of size 2^( 7) =       0.000458205552

      target function =                  N/A
              le_mean =     -16.904428778597
             les_mean =     286.085556659358
             stat err =       0.000448743610
             autocorr =       1.286981975917
              std dev =       0.559405900476
             le_variance =       0.312934961488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690442877860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904428778627       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904428778627       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904428778627       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904428778627       residual = 2.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+08 is 6.229020e-13

solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904428778627       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904428778627       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904428778627       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904429777289       residual = 2.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+09 is 1.557601e-13

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904428778627       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904428778627       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904428778627       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904428778627       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+09 is 3.893213e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7049e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.6991
    reference variance = 6.04257
====================================================
  Execution time = 1.4147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2518e-01
  Total weights = 1.9514e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395889169
  error estimate for blocks of size 2^( 2) =       0.000410053604
  error estimate for blocks of size 2^( 3) =       0.000424705696
  error estimate for blocks of size 2^( 4) =       0.000438098344
  error estimate for blocks of size 2^( 5) =       0.000449400051
  error estimate for blocks of size 2^( 6) =       0.000457846240
  error estimate for blocks of size 2^( 7) =       0.000461957179

      target function =                  N/A
              le_mean =     -16.904201135828
             les_mean =     286.077192984272
             stat err =       0.000451825454
             autocorr =       1.302549231428
              std dev =       0.559871831393
             le_variance =       0.313456467587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395889169
  error estimate for blocks of size 2^( 2) =       0.000410053604
  error estimate for blocks of size 2^( 3) =       0.000424705696
  error estimate for blocks of size 2^( 4) =       0.000438098344
  error estimate for blocks of size 2^( 5) =       0.000449400051
  error estimate for blocks of size 2^( 6) =       0.000457846240
  error estimate for blocks of size 2^( 7) =       0.000461957179

      target function =                  N/A
              le_mean =     -16.904201135828
             les_mean =     286.077192984275
             stat err =       0.000451825454
             autocorr =       1.302549231427
              std dev =       0.559871831393
             le_variance =       0.313456467588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395889169
  error estimate for blocks of size 2^( 2) =       0.000410053604
  error estimate for blocks of size 2^( 3) =       0.000424705696
  error estimate for blocks of size 2^( 4) =       0.000438098344
  error estimate for blocks of size 2^( 5) =       0.000449400051
  error estimate for blocks of size 2^( 6) =       0.000457846240
  error estimate for blocks of size 2^( 7) =       0.000461957179

      target function =                  N/A
              le_mean =     -16.904201135828
             les_mean =     286.077192984273
             stat err =       0.000451825454
             autocorr =       1.302549231428
              std dev =       0.559871831393
             le_variance =       0.313456467587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153084035
                                         uncertainty =       0.002390252367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395889169
  error estimate for blocks of size 2^( 2) =       0.000410053604
  error estimate for blocks of size 2^( 3) =       0.000424705696
  error estimate for blocks of size 2^( 4) =       0.000438098344
  error estimate for blocks of size 2^( 5) =       0.000449400051
  error estimate for blocks of size 2^( 6) =       0.000457846240
  error estimate for blocks of size 2^( 7) =       0.000461957179

      target function =                  N/A
              le_mean =     -16.904201135828
             les_mean =     286.077192984272
             stat err =       0.000451825454
             autocorr =       1.302549231432
              std dev =       0.559871831393
             le_variance =       0.313456467588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904201135828        initial  <--
     5.5511e+08     5.5511e+09             6.2290e-13       -16.904201135828
     2.2204e+09     2.2204e+10             1.5576e-13       -16.904201135828
     8.8818e+09     8.8818e+10             3.8932e-14       -16.904201135828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7447
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.408085
====================================================
  Execution time = 1.4517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2489e-01
  Total weights = 1.951986976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312925124634
                                         uncertainty =       0.002359671704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312925124634
                                         uncertainty =       0.002359671704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395658436
  error estimate for blocks of size 2^( 2) =       0.000410107379
  error estimate for blocks of size 2^( 3) =       0.000424585265
  error estimate for blocks of size 2^( 4) =       0.000437713212
  error estimate for blocks of size 2^( 5) =       0.000449478272
  error estimate for blocks of size 2^( 6) =       0.000457540709
  error estimate for blocks of size 2^( 7) =       0.000465164543

      target function =                  N/A
              le_mean =     -16.904106298083
             les_mean =     286.073698256270
             stat err =       0.000452474184
             autocorr =       1.307816319130
              std dev =       0.559545525625
             le_variance =       0.313091195247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690410629808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+09, overlap shift 5.5511e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904106298113       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904106298113       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904106298113       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904106785531       residual = 1.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.5511e+09 is 6.691567e-14

solving harmonic davidson linear method for identity shift 2.2204e+10, overlap shift 2.2204e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904106298113       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904106298113       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904106298113       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904106298113       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.2204e+10 is 1.680623e-14

solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904106298113       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904106298113       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904106298113       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904106298113       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 8.8818e+10 is 4.218191e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7125e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8362
    reference variance = 0.221017
====================================================
  Execution time = 1.4192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2628e-01
  Total weights = 1.9517e+06
  Execution time = 1.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144635
  error estimate for blocks of size 2^( 2) =       0.000407553740
  error estimate for blocks of size 2^( 3) =       0.000421797888
  error estimate for blocks of size 2^( 4) =       0.000435496543
  error estimate for blocks of size 2^( 5) =       0.000447123127
  error estimate for blocks of size 2^( 6) =       0.000455864624
  error estimate for blocks of size 2^( 7) =       0.000461185631

      target function =                  N/A
              le_mean =     -16.903619762991
             les_mean =     286.058639147308
             stat err =       0.000449917481
             autocorr =       1.309667431758
              std dev =       0.555990475354
             le_variance =       0.309125408685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144635
  error estimate for blocks of size 2^( 2) =       0.000407553740
  error estimate for blocks of size 2^( 3) =       0.000421797888
  error estimate for blocks of size 2^( 4) =       0.000435496543
  error estimate for blocks of size 2^( 5) =       0.000447123127
  error estimate for blocks of size 2^( 6) =       0.000455864624
  error estimate for blocks of size 2^( 7) =       0.000461185631

      target function =                  N/A
              le_mean =     -16.903619762991
             les_mean =     286.058639147308
             stat err =       0.000449917481
             autocorr =       1.309667431763
              std dev =       0.555990475354
             le_variance =       0.309125408685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144635
  error estimate for blocks of size 2^( 2) =       0.000407553740
  error estimate for blocks of size 2^( 3) =       0.000421797888
  error estimate for blocks of size 2^( 4) =       0.000435496543
  error estimate for blocks of size 2^( 5) =       0.000447123127
  error estimate for blocks of size 2^( 6) =       0.000455864624
  error estimate for blocks of size 2^( 7) =       0.000461185631

      target function =                  N/A
              le_mean =     -16.903619762991
             les_mean =     286.058639147308
             stat err =       0.000449917481
             autocorr =       1.309667431763
              std dev =       0.555990475354
             le_variance =       0.309125408685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309151141233
                                         uncertainty =       0.001844742121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144635
  error estimate for blocks of size 2^( 2) =       0.000407553740
  error estimate for blocks of size 2^( 3) =       0.000421797888
  error estimate for blocks of size 2^( 4) =       0.000435496543
  error estimate for blocks of size 2^( 5) =       0.000447123127
  error estimate for blocks of size 2^( 6) =       0.000455864624
  error estimate for blocks of size 2^( 7) =       0.000461185631

      target function =                  N/A
              le_mean =     -16.903619762991
             les_mean =     286.058639147308
             stat err =       0.000449917481
             autocorr =       1.309667431760
              std dev =       0.555990475354
             le_variance =       0.309125408685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903619762991        initial
     5.5511e+09     5.5511e+10             6.6916e-14       -16.903619762991
     2.2204e+10     2.2204e+11             1.6806e-14       -16.903619762991  <--
     8.8818e+10     8.8818e+11             4.2182e-15       -16.903619762991

*****************************************************************************
Applying the update for shift_i =   2.2204e+10     and shift_s =   2.2204e+11
*****************************************************************************

  Execution time = 2.3668e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.003899e-01 3 1  ON 0
ci_0002                 7.002231e-01 3 1  ON 1
ci_0003                -3.036399e-02 3 1  ON 2
ci_0004                -3.057563e-02 3 1  ON 3
ci_0005                -3.343488e-02 3 1  ON 4
ci_0006                -3.394211e-02 3 1  ON 5
ci_0007                -2.263712e-02 3 1  ON 6
ci_0008                -2.270301e-02 3 1  ON 7
ci_0009                -1.989374e-02 3 1  ON 8
ci_0010                -2.011928e-02 3 1  ON 9
ci_0011                -1.499666e-02 3 1  ON 10
ci_0012                -1.519838e-02 3 1  ON 11
ci_0013                 1.560901e-02 3 1  ON 12
ci_0014                 1.627094e-02 3 1  ON 13
ci_0015                 1.538636e-02 3 1  ON 14
ci_0016                 1.557767e-02 3 1  ON 15
ci_0017                 1.439381e-02 3 1  ON 16
ci_0018                 1.387104e-02 3 1  ON 17
ci_0019                 1.190365e-02 3 1  ON 18
ci_0020                 1.146311e-02 3 1  ON 19
ci_0021                 6.813052e-03 3 1  ON 20
ci_0022                 7.916066e-03 3 1  ON 21
ci_0023                -1.164940e-02 3 1  ON 22
ci_0024                -1.179453e-02 3 1  ON 23
ci_0025                -1.139505e-02 3 1  ON 24
ci_0026                -1.203177e-02 3 1  ON 25
ci_0027                -1.115068e-02 3 1  ON 26
ci_0028                -1.143356e-02 3 1  ON 27
ci_0029                -1.055524e-02 3 1  ON 28
ci_0030                -1.097578e-02 3 1  ON 29
ci_0031                 1.829796e-02 3 1  ON 30
ci_0032                 1.900483e-02 3 1  ON 31
ci_0033                 1.117614e-02 3 1  ON 32
ci_0034                 1.065248e-02 3 1  ON 33
ci_0035                 6.832655e-03 3 1  ON 34
ci_0036                 7.071356e-03 3 1  ON 35
ci_0037                -1.152997e-02 3 1  ON 36
ci_0038                -1.113719e-02 3 1  ON 37
ci_0039                -3.695844e-03 3 1  ON 38
ci_0040                -4.067426e-03 3 1  ON 39
ci_0041                 8.803936e-03 3 1  ON 40
ci_0042                 8.217827e-03 3 1  ON 41
ci_0043                -1.420807e-02 3 1  ON 42
ci_0044                -1.387012e-02 3 1  ON 43
ci_0045                 8.402894e-03 3 1  ON 44
ci_0046                 8.738321e-03 3 1  ON 45
ci_0047                -3.167565e-03 3 1  ON 46
ci_0048                -3.493871e-03 3 1  ON 47
ci_0049                -6.629770e-03 3 1  ON 48
ci_0050                -6.535307e-03 3 1  ON 49
ci_0051                -4.574599e-03 3 1  ON 50
ci_0052                -4.624423e-03 3 1  ON 51
ci_0053                -6.324393e-03 3 1  ON 52
ci_0054                -6.011590e-03 3 1  ON 53
ci_0055                 6.954630e-03 3 1  ON 54
ci_0056                 7.232784e-03 3 1  ON 55
ci_0057                 5.183938e-03 3 1  ON 56
ci_0058                 5.231166e-03 3 1  ON 57
ci_0059                -6.111134e-03 3 1  ON 58
ci_0060                -5.550201e-03 3 1  ON 59
ci_0061                -3.810143e-03 3 1  ON 60
ci_0062                -3.523176e-03 3 1  ON 61
ci_0063                -9.211061e-03 3 1  ON 62
ci_0064                -8.805102e-03 3 1  ON 63
ci_0065                -6.439991e-03 3 1  ON 64
ci_0066                -6.798231e-03 3 1  ON 65
ci_0067                -5.948473e-03 3 1  ON 66
ci_0068                -6.180270e-03 3 1  ON 67
ci_0069                 5.704202e-03 3 1  ON 68
ci_0070                 5.651202e-03 3 1  ON 69
ci_0071                 4.684335e-03 3 1  ON 70
ci_0072                 4.546902e-03 3 1  ON 71
ci_0073                 5.233356e-03 3 1  ON 72
ci_0074                 5.104536e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0798e+01 secs
  Total Execution time = 2.4790e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
