Rank =    0  Free Memory = 88193 MB
Rank =    1  Free Memory = 88193 MB
Rank =    2  Free Memory = 88193 MB
Rank =    3  Free Memory = 88193 MB
Rank =    4  Free Memory = 88192 MB
Rank =    5  Free Memory = 88192 MB
Rank =    6  Free Memory = 88192 MB
Rank =    7  Free Memory = 88191 MB
Rank =    8  Free Memory = 88190 MB
Rank =    9  Free Memory = 88190 MB
Rank =   10  Free Memory = 88190 MB
Rank =   11  Free Memory = 88190 MB
Rank =   12  Free Memory = 88190 MB
Rank =   13  Free Memory = 88190 MB
Rank =   14  Free Memory = 88189 MB
Rank =   15  Free Memory = 88174 MB
Rank =   16  Free Memory = 88174 MB
Rank =   17  Free Memory = 88174 MB
Rank =   18  Free Memory = 88174 MB
Rank =   19  Free Memory = 88174 MB
Rank =   20  Free Memory = 88174 MB
Rank =   21  Free Memory = 88174 MB
Rank =   22  Free Memory = 88174 MB
Rank =   23  Free Memory = 88174 MB
Rank =   24  Free Memory = 88174 MB
Rank =   25  Free Memory = 88174 MB
Rank =   26  Free Memory = 88174 MB
Rank =   27  Free Memory = 88174 MB
Rank =   28  Free Memory = 88174 MB
Rank =   29  Free Memory = 88174 MB
Rank =   30  Free Memory = 88174 MB
Rank =   31  Free Memory = 88174 MB
Rank =   32  Free Memory = 89275 MB
Rank =   33  Free Memory = 89275 MB
Rank =   34  Free Memory = 89275 MB
Rank =   35  Free Memory = 89275 MB
Rank =   36  Free Memory = 89275 MB
Rank =   37  Free Memory = 89275 MB
Rank =   38  Free Memory = 89275 MB
Rank =   39  Free Memory = 89275 MB
Rank =   40  Free Memory = 89275 MB
Rank =   41  Free Memory = 89274 MB
Rank =   42  Free Memory = 89274 MB
Rank =   43  Free Memory = 89274 MB
Rank =   44  Free Memory = 89274 MB
Rank =   45  Free Memory = 89274 MB
Rank =   46  Free Memory = 89274 MB
Rank =   47  Free Memory = 89274 MB
Rank =   48  Free Memory = 89274 MB
Rank =   49  Free Memory = 89274 MB
Rank =   50  Free Memory = 89274 MB
Rank =   51  Free Memory = 89274 MB
Rank =   52  Free Memory = 89274 MB
Rank =   53  Free Memory = 89274 MB
Rank =   54  Free Memory = 89274 MB
Rank =   55  Free Memory = 89274 MB
Rank =   56  Free Memory = 89274 MB
Rank =   57  Free Memory = 89274 MB
Rank =   58  Free Memory = 89274 MB
Rank =   59  Free Memory = 89274 MB
Rank =   60  Free Memory = 89274 MB
Rank =   61  Free Memory = 89274 MB
Rank =   62  Free Memory = 89274 MB
Rank =   63  Free Memory = 89275 MB
Rank =   64  Free Memory = 84989 MB
Rank =   65  Free Memory = 84989 MB
Rank =   66  Free Memory = 84989 MB
Rank =   67  Free Memory = 84989 MB
Rank =   68  Free Memory = 84989 MB
Rank =   69  Free Memory = 84989 MB
Rank =   70  Free Memory = 84989 MB
Rank =   71  Free Memory = 84989 MB
Rank =   72  Free Memory = 84989 MB
Rank =   73  Free Memory = 84989 MB
Rank =   74  Free Memory = 84989 MB
Rank =   75  Free Memory = 84989 MB
Rank =   76  Free Memory = 84989 MB
Rank =   77  Free Memory = 84989 MB
Rank =   78  Free Memory = 84989 MB
Rank =   79  Free Memory = 84989 MB
Rank =   80  Free Memory = 84989 MB
Rank =   81  Free Memory = 84989 MB
Rank =   82  Free Memory = 84989 MB
Rank =   83  Free Memory = 84989 MB
Rank =   84  Free Memory = 84988 MB
Rank =   85  Free Memory = 84988 MB
Rank =   86  Free Memory = 84988 MB
Rank =   87  Free Memory = 84988 MB
Rank =   88  Free Memory = 84988 MB
Rank =   89  Free Memory = 84988 MB
Rank =   90  Free Memory = 84988 MB
Rank =   91  Free Memory = 84988 MB
Rank =   92  Free Memory = 84988 MB
Rank =   93  Free Memory = 84988 MB
Rank =   94  Free Memory = 84988 MB
Rank =   95  Free Memory = 84988 MB
Rank =   96  Free Memory = 83398 MB
Rank =   97  Free Memory = 83398 MB
Rank =   98  Free Memory = 83398 MB
Rank =   99  Free Memory = 83398 MB
Rank =  100  Free Memory = 83398 MB
Rank =  101  Free Memory = 83398 MB
Rank =  102  Free Memory = 83398 MB
Rank =  103  Free Memory = 83398 MB
Rank =  104  Free Memory = 83398 MB
Rank =  105  Free Memory = 83398 MB
Rank =  106  Free Memory = 83398 MB
Rank =  107  Free Memory = 83398 MB
Rank =  108  Free Memory = 83398 MB
Rank =  109  Free Memory = 83397 MB
Rank =  110  Free Memory = 83397 MB
Rank =  111  Free Memory = 83397 MB
Rank =  112  Free Memory = 83397 MB
Rank =  113  Free Memory = 83397 MB
Rank =  114  Free Memory = 83397 MB
Rank =  115  Free Memory = 83397 MB
Rank =  116  Free Memory = 83397 MB
Rank =  117  Free Memory = 83397 MB
Rank =  118  Free Memory = 83397 MB
Rank =  119  Free Memory = 83397 MB
Rank =  120  Free Memory = 83397 MB
Rank =  121  Free Memory = 83397 MB
Rank =  122  Free Memory = 83397 MB
Rank =  123  Free Memory = 83397 MB
Rank =  124  Free Memory = 83397 MB
Rank =  125  Free Memory = 83397 MB
Rank =  126  Free Memory = 83397 MB
Rank =  127  Free Memory = 83397 MB
  Input file(s): opt_h2o_1b1_lmtt_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmtt_run001f.xml

  Project = H2O
  date    = 2023-03-06 14:48:33 PST
  host    = n0017.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 449

  Range of prime numbers to use as seeds over processors and threads = 3187-4229


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.942481e-01    1         1  ON     0
     uu_1                 1.270412e-01    1         1  ON     1
     uu_2                 2.528026e-02    1         1  ON     2
     uu_3                -3.753264e-02    1         1  ON     3
     uu_4                -8.372467e-02    1         1  ON     4
     uu_5                -1.196959e-01    1         1  ON     5
     uu_6                -1.485198e-01    1         1  ON     6
     uu_7                -1.637823e-01    1         1  ON     7
     uu_8                -1.562092e-01    1         1  ON     8
     uu_9                -1.292149e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.555331e-01    1         1  ON     0
     ud_1                 1.901366e-01    1         1  ON     1
     ud_2                 7.057246e-02    1         1  ON     2
     ud_3                -3.332269e-04    1         1  ON     3
     ud_4                -5.810219e-02    1         1  ON     4
     ud_5                -1.007342e-01    1         1  ON     5
     ud_6                -1.296202e-01    1         1  ON     6
     ud_7                -1.478016e-01    1         1  ON     7
     ud_8                -1.501945e-01    1         1  ON     8
     ud_9                -1.418084e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.054643e-01    1         1  ON     0
     eO_1                -3.855099e-01    1         1  ON     1
     eO_2                 2.827987e-02    1         1  ON     2
     eO_3                 3.439425e-01    1         1  ON     3
     eO_4                 5.684037e-01    1         1  ON     4
     eO_5                 5.255973e-01    1         1  ON     5
     eO_6                 2.820607e-01    1         1  ON     6
     eO_7                -6.503643e-02    1         1  ON     7
     eO_8                -3.287143e-01    1         1  ON     8
     eO_9                -2.252435e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.921668e-01    1         1  ON     0
     eH1_1                -1.886546e-01    1         1  ON     1
     eH1_2                -1.402081e-01    1         1  ON     2
     eH1_3                -8.504652e-02    1         1  ON     3
     eH1_4                -3.489092e-02    1         1  ON     4
     eH1_5                 4.648488e-03    1         1  ON     5
     eH1_6                 7.311275e-02    1         1  ON     6
     eH1_7                 1.571238e-01    1         1  ON     7
     eH1_8                 2.279282e-01    1         1  ON     8
     eH1_9                 2.110868e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.902169e-01    1         1  ON     0
     eH2_1                -1.870564e-01    1         1  ON     1
     eH2_2                -1.384916e-01    1         1  ON     2
     eH2_3                -8.317207e-02    1         1  ON     3
     eH2_4                -3.312963e-02    1         1  ON     4
     eH2_5                 5.737123e-03    1         1  ON     5
     eH2_6                 7.505429e-02    1         1  ON     6
     eH2_7                 1.571223e-01    1         1  ON     7
     eH2_8                 2.244125e-01    1         1  ON     8
     eH2_9                 2.362982e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.931960e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9034e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8473
    reference variance = 0.239748
====================================================
  Execution time = 2.1384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3765e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337797580310
                                         uncertainty =       0.004093958831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337797580310
                                         uncertainty =       0.004093958831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410885106
  error estimate for blocks of size 2^( 2) =       0.000423408066
  error estimate for blocks of size 2^( 3) =       0.000436114676
  error estimate for blocks of size 2^( 4) =       0.000447596804
  error estimate for blocks of size 2^( 5) =       0.000457750043
  error estimate for blocks of size 2^( 6) =       0.000466988753
  error estimate for blocks of size 2^( 7) =       0.000473799854

      target function =                  N/A
              le_mean =     -16.905776158349
             les_mean =     286.142920488096
             stat err =       0.000461533864
             autocorr =       1.261729755112
              std dev =       0.581079289521
             le_variance =       0.337653140710


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690577615835e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905776158349       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905777583216       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905777310036       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905777408604       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905777399012       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905776573570       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905776749127       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905776933054       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905777046629       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.155864e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905776158349       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776681690       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776643771       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905776677674       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905776797486       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905776551447       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905776576886       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905776618248       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.318793e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905776158349       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776306569       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776303781       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905776321947       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905776369220       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905776321290       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905776328256       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 3.604487e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6902e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.943404e-01                 1 1 ON  0
uu_1  1.270734e-01                 1 1 ON  1
uu_2  2.527546e-02                 1 1 ON  2
uu_3  -3.761295e-02                1 1 ON  3
uu_4  -8.378531e-02                1 1 ON  4
uu_5  -1.197401e-01                1 1 ON  5
uu_6  -1.485007e-01                1 1 ON  6
uu_7  -1.638155e-01                1 1 ON  7
uu_8  -1.561867e-01                1 1 ON  8
uu_9  -1.291838e-01                1 1 ON  9
ud_0  4.555728e-01                 1 1 ON  10
ud_1  1.902343e-01                 1 1 ON  11
ud_2  7.052784e-02                 1 1 ON  12
ud_3  -3.509358e-04                1 1 ON  13
ud_4  -5.822273e-02                1 1 ON  14
ud_5  -1.007356e-01                1 1 ON  15
ud_6  -1.296052e-01                1 1 ON  16
ud_7  -1.478159e-01                1 1 ON  17
ud_8  -1.500992e-01                1 1 ON  18
ud_9  -1.417902e-01                1 1 ON  19
eO_0  -7.054939e-01                1 1 ON  20
eO_1  -3.855512e-01                1 1 ON  21
eO_2  2.835996e-02                 1 1 ON  22
eO_3  3.440013e-01                 1 1 ON  23
eO_4  5.684945e-01                 1 1 ON  24
eO_5  5.256356e-01                 1 1 ON  25
eO_6  2.820030e-01                 1 1 ON  26
eO_7  -6.503820e-02                1 1 ON  27
eO_8  -3.287420e-01                1 1 ON  28
eO_9  -2.253308e-01                1 1 ON  29
eH1_0 -2.922693e-01                1 1 ON  30
eH1_1 -1.887865e-01                1 1 ON  31
eH1_2 -1.402839e-01                1 1 ON  32
eH1_3 -8.503923e-02                1 1 ON  33
eH1_4 -3.485266e-02                1 1 ON  34
eH1_5 4.683742e-03                 1 1 ON  35
eH1_6 7.308865e-02                 1 1 ON  36
eH1_7 1.571392e-01                 1 1 ON  37
eH1_8 2.279750e-01                 1 1 ON  38
eH1_9 2.111878e-01                 1 1 ON  39
eH2_0 -2.902428e-01                1 1 ON  40
eH2_1 -1.870957e-01                1 1 ON  41
eH2_2 -1.385713e-01                1 1 ON  42
eH2_3 -8.315324e-02                1 1 ON  43
eH2_4 -3.315135e-02                1 1 ON  44
eH2_5 5.719888e-03                 1 1 ON  45
eH2_6 7.508862e-02                 1 1 ON  46
eH2_7 1.571506e-01                 1 1 ON  47
eH2_8 2.244085e-01                 1 1 ON  48
eH2_9 2.363511e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9459
    reference variance = 0.236924
====================================================
  Execution time = 2.0766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.0000e+06
  Execution time = 1.9021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336663045763
                                         uncertainty =       0.003142258363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336663045763
                                         uncertainty =       0.003142258363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410293648
  error estimate for blocks of size 2^( 2) =       0.000423077564
  error estimate for blocks of size 2^( 3) =       0.000435534161
  error estimate for blocks of size 2^( 4) =       0.000447357516
  error estimate for blocks of size 2^( 5) =       0.000458142705
  error estimate for blocks of size 2^( 6) =       0.000467372630
  error estimate for blocks of size 2^( 7) =       0.000470403575

      target function =                  N/A
              le_mean =     -16.906669765133
             les_mean =     286.172164134471
             stat err =       0.000460819107
             autocorr =       1.261453853307
              std dev =       0.580242841889
             le_variance =       0.336681755564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336949398872
                                         uncertainty =       0.003143905117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336949398872
                                         uncertainty =       0.003143905117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410468167
  error estimate for blocks of size 2^( 2) =       0.000423240610
  error estimate for blocks of size 2^( 3) =       0.000435685235
  error estimate for blocks of size 2^( 4) =       0.000447502441
  error estimate for blocks of size 2^( 5) =       0.000458286399
  error estimate for blocks of size 2^( 6) =       0.000467514239
  error estimate for blocks of size 2^( 7) =       0.000470540037

      target function =                  N/A
              le_mean =     -16.906671167500
             les_mean =     286.172498029812
             stat err =       0.000460960779
             autocorr =       1.261156508250
              std dev =       0.580489648766
             le_variance =       0.336968232324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843865076
                                         uncertainty =       0.003143094705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843865076
                                         uncertainty =       0.003143094705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410403827
  error estimate for blocks of size 2^( 2) =       0.000423179193
  error estimate for blocks of size 2^( 3) =       0.000435627357
  error estimate for blocks of size 2^( 4) =       0.000447446990
  error estimate for blocks of size 2^( 5) =       0.000458230760
  error estimate for blocks of size 2^( 6) =       0.000467460700
  error estimate for blocks of size 2^( 7) =       0.000470487227

      target function =                  N/A
              le_mean =     -16.906670710987
             les_mean =     286.172376964236
             stat err =       0.000460906419
             autocorr =       1.261254443073
              std dev =       0.580398658614
             le_variance =       0.336862602920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336685612258
                                         uncertainty =       0.003142341605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336685612258
                                         uncertainty =       0.003142341605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410307396
  error estimate for blocks of size 2^( 2) =       0.000423090040
  error estimate for blocks of size 2^( 3) =       0.000435545445
  error estimate for blocks of size 2^( 4) =       0.000447368363
  error estimate for blocks of size 2^( 5) =       0.000458153285
  error estimate for blocks of size 2^( 6) =       0.000467383352
  error estimate for blocks of size 2^( 7) =       0.000470413582

      target function =                  N/A
              le_mean =     -16.906669838562
             les_mean =     286.172189180383
             stat err =       0.000460829646
             autocorr =       1.261427018079
              std dev =       0.580262284312
             le_variance =       0.336704318595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906669765133        initial
     2.5000e-01     2.5000e+00             4.1559e-04       -16.906671167500  <--
     1.0000e+00     1.0000e+01             1.3188e-04       -16.906670710987
     4.0000e+00     4.0000e+01             3.6045e-05       -16.906669838562

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0387e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.945214e-01 1 1  ON 0
 uu_1                 1.271225e-01 1 1  ON 1
 uu_2                 2.526344e-02 1 1  ON 2
 uu_3                -3.774991e-02 1 1  ON 3
 uu_4                -8.393392e-02 1 1  ON 4
 uu_5                -1.198464e-01 1 1  ON 5
 uu_6                -1.484784e-01 1 1  ON 6
 uu_7                -1.638920e-01 1 1  ON 7
 uu_8                -1.561232e-01 1 1  ON 8
 uu_9                -1.290947e-01 1 1  ON 9
 ud_0                 4.556822e-01 1 1  ON 10
 ud_1                 1.903467e-01 1 1  ON 11
 ud_2                 7.047946e-02 1 1  ON 12
 ud_3                -4.326754e-04 1 1  ON 13
 ud_4                -5.842268e-02 1 1  ON 14
 ud_5                -1.007938e-01 1 1  ON 15
 ud_6                -1.295570e-01 1 1  ON 16
 ud_7                -1.478304e-01 1 1  ON 17
 ud_8                -1.498408e-01 1 1  ON 18
 ud_9                -1.417310e-01 1 1  ON 19
 eO_0                -7.055965e-01 1 1  ON 20
 eO_1                -3.855476e-01 1 1  ON 21
 eO_2                 2.851623e-02 1 1  ON 22
 eO_3                 3.441256e-01 1 1  ON 23
 eO_4                 5.687022e-01 1 1  ON 24
 eO_5                 5.257631e-01 1 1  ON 25
 eO_6                 2.818707e-01 1 1  ON 26
 eO_7                -6.503896e-02 1 1  ON 27
 eO_8                -3.288183e-01 1 1  ON 28
 eO_9                -2.255750e-01 1 1  ON 29
eH1_0                -2.925823e-01 1 1  ON 30
eH1_1                -1.890631e-01 1 1  ON 31
eH1_2                -1.404716e-01 1 1  ON 32
eH1_3                -8.507144e-02 1 1  ON 33
eH1_4                -3.479025e-02 1 1  ON 34
eH1_5                 4.772143e-03 1 1  ON 35
eH1_6                 7.302734e-02 1 1  ON 36
eH1_7                 1.571869e-01 1 1  ON 37
eH1_8                 2.281071e-01 1 1  ON 38
eH1_9                 2.114729e-01 1 1  ON 39
eH2_0                -2.903425e-01 1 1  ON 40
eH2_1                -1.872177e-01 1 1  ON 41
eH2_2                -1.387259e-01 1 1  ON 42
eH2_3                -8.316222e-02 1 1  ON 43
eH2_4                -3.318559e-02 1 1  ON 44
eH2_5                 5.667825e-03 1 1  ON 45
eH2_6                 7.517788e-02 1 1  ON 46
eH2_7                 1.572373e-01 1 1  ON 47
eH2_8                 2.244023e-01 1 1  ON 48
eH2_9                 2.365014e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9575
    reference variance = 0.599282
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3741e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337395868731
                                         uncertainty =       0.003946655125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337395868731
                                         uncertainty =       0.003946655125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410738630
  error estimate for blocks of size 2^( 2) =       0.000423404188
  error estimate for blocks of size 2^( 3) =       0.000436106524
  error estimate for blocks of size 2^( 4) =       0.000447508327
  error estimate for blocks of size 2^( 5) =       0.000458110002
  error estimate for blocks of size 2^( 6) =       0.000464759503
  error estimate for blocks of size 2^( 7) =       0.000468623138

      target function =                  N/A
              le_mean =     -16.907356126899
             les_mean =     286.196103478216
             stat err =       0.000459750243
             autocorr =       1.252889682226
              std dev =       0.580872141798
             le_variance =       0.337412445117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690735612690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907356126899       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907357410418       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907356166186       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907355186696       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907356620438       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907355867026       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907358071919       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907357909284       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907358711412       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907359333578       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907358653073       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907358589636       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907358645828       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.079591e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907356126899       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907356907777       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907356299976       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907355008575       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907355930008       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907355874577       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907356209898       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907356381766       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907356489589       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.377196e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907356126899       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907356431164       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907356244529       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907355592512       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907355765219       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907355907198       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907355930473       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907355989885       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.679278e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6029e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.943210e-01 1 1  ON 0
 uu_1                 1.272336e-01 1 1  ON 1
 uu_2                 2.535200e-02 1 1  ON 2
 uu_3                -3.754798e-02 1 1  ON 3
 uu_4                -8.373610e-02 1 1  ON 4
 uu_5                -1.197658e-01 1 1  ON 5
 uu_6                -1.485216e-01 1 1  ON 6
 uu_7                -1.640237e-01 1 1  ON 7
 uu_8                -1.563450e-01 1 1  ON 8
 uu_9                -1.292353e-01 1 1  ON 9
 ud_0                 4.557151e-01 1 1  ON 10
 ud_1                 1.904712e-01 1 1  ON 11
 ud_2                 7.058043e-02 1 1  ON 12
 ud_3                -3.683473e-04 1 1  ON 13
 ud_4                -5.822215e-02 1 1  ON 14
 ud_5                -1.008219e-01 1 1  ON 15
 ud_6                -1.293888e-01 1 1  ON 16
 ud_7                -1.477253e-01 1 1  ON 17
 ud_8                -1.499133e-01 1 1  ON 18
 ud_9                -1.418689e-01 1 1  ON 19
 eO_0                -7.057476e-01 1 1  ON 20
 eO_1                -3.852767e-01 1 1  ON 21
 eO_2                 2.887257e-02 1 1  ON 22
 eO_3                 3.441245e-01 1 1  ON 23
 eO_4                 5.688516e-01 1 1  ON 24
 eO_5                 5.259400e-01 1 1  ON 25
 eO_6                 2.819763e-01 1 1  ON 26
 eO_7                -6.508278e-02 1 1  ON 27
 eO_8                -3.290188e-01 1 1  ON 28
 eO_9                -2.260739e-01 1 1  ON 29
eH1_0                -2.929092e-01 1 1  ON 30
eH1_1                -1.890246e-01 1 1  ON 31
eH1_2                -1.406884e-01 1 1  ON 32
eH1_3                -8.534460e-02 1 1  ON 33
eH1_4                -3.490709e-02 1 1  ON 34
eH1_5                 4.676988e-03 1 1  ON 35
eH1_6                 7.366506e-02 1 1  ON 36
eH1_7                 1.574002e-01 1 1  ON 37
eH1_8                 2.280892e-01 1 1  ON 38
eH1_9                 2.116312e-01 1 1  ON 39
eH2_0                -2.903890e-01 1 1  ON 40
eH2_1                -1.869404e-01 1 1  ON 41
eH2_2                -1.388860e-01 1 1  ON 42
eH2_3                -8.335603e-02 1 1  ON 43
eH2_4                -3.334610e-02 1 1  ON 44
eH2_5                 5.878644e-03 1 1  ON 45
eH2_6                 7.519681e-02 1 1  ON 46
eH2_7                 1.573112e-01 1 1  ON 47
eH2_8                 2.243457e-01 1 1  ON 48
eH2_9                 2.363867e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9679
    reference variance = 0.256386
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4003e-01
  Total weights = 2.0000e+06
  Execution time = 1.8989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340082632249
                                         uncertainty =       0.005500720069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340082632249
                                         uncertainty =       0.005500720069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384839
  error estimate for blocks of size 2^( 2) =       0.000425150035
  error estimate for blocks of size 2^( 3) =       0.000437631537
  error estimate for blocks of size 2^( 4) =       0.000450469095
  error estimate for blocks of size 2^( 5) =       0.000461108659
  error estimate for blocks of size 2^( 6) =       0.000471816006
  error estimate for blocks of size 2^( 7) =       0.000479260239

      target function =                  N/A
              le_mean =     -16.905873112280
             les_mean =     286.148668029910
             stat err =       0.000465663500
             autocorr =       1.275084639460
              std dev =       0.583200232729
             le_variance =       0.340122511455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339997456278
                                         uncertainty =       0.005496283389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339997456278
                                         uncertainty =       0.005496283389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412333195
  error estimate for blocks of size 2^( 2) =       0.000425100646
  error estimate for blocks of size 2^( 3) =       0.000437582488
  error estimate for blocks of size 2^( 4) =       0.000450415070
  error estimate for blocks of size 2^( 5) =       0.000461058294
  error estimate for blocks of size 2^( 6) =       0.000471766382
  error estimate for blocks of size 2^( 7) =       0.000479209849

      target function =                  N/A
              le_mean =     -16.905871628291
             les_mean =     286.148532669292
             stat err =       0.000465612399
             autocorr =       1.275124161163
              std dev =       0.583127196293
             le_variance =       0.340037327057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339899182723
                                         uncertainty =       0.005494065686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339899182723
                                         uncertainty =       0.005494065686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412273587
  error estimate for blocks of size 2^( 2) =       0.000425044552
  error estimate for blocks of size 2^( 3) =       0.000437529797
  error estimate for blocks of size 2^( 4) =       0.000450363298
  error estimate for blocks of size 2^( 5) =       0.000461008201
  error estimate for blocks of size 2^( 6) =       0.000471716535
  error estimate for blocks of size 2^( 7) =       0.000479163381

      target function =                  N/A
              le_mean =     -16.905871508365
             les_mean =     286.148430308017
             stat err =       0.000465562854
             autocorr =       1.275221483229
              std dev =       0.583042897764
             le_variance =       0.339939020633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340028815895
                                         uncertainty =       0.005499259227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340028815895
                                         uncertainty =       0.005499259227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412352215
  error estimate for blocks of size 2^( 2) =       0.000425119085
  error estimate for blocks of size 2^( 3) =       0.000437601753
  error estimate for blocks of size 2^( 4) =       0.000450438520
  error estimate for blocks of size 2^( 5) =       0.000461079570
  error estimate for blocks of size 2^( 6) =       0.000471787193
  error estimate for blocks of size 2^( 7) =       0.000479232378

      target function =                  N/A
              le_mean =     -16.905872386145
             les_mean =     286.148589665592
             stat err =       0.000465634415
             autocorr =       1.275127109286
              std dev =       0.583154095421
             le_variance =       0.340068699006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905873112280        initial  <--
     6.2500e-02     6.2500e-01             2.0796e-03       -16.905871628291
     2.5000e-01     2.5000e+00             6.3772e-04       -16.905871508365
     1.0000e+00     1.0000e+01             1.6793e-04       -16.905872386145

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6216
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.945214e-01 1 1  ON 0
 uu_1                 1.271225e-01 1 1  ON 1
 uu_2                 2.526344e-02 1 1  ON 2
 uu_3                -3.774991e-02 1 1  ON 3
 uu_4                -8.393392e-02 1 1  ON 4
 uu_5                -1.198464e-01 1 1  ON 5
 uu_6                -1.484784e-01 1 1  ON 6
 uu_7                -1.638920e-01 1 1  ON 7
 uu_8                -1.561232e-01 1 1  ON 8
 uu_9                -1.290947e-01 1 1  ON 9
 ud_0                 4.556822e-01 1 1  ON 10
 ud_1                 1.903467e-01 1 1  ON 11
 ud_2                 7.047946e-02 1 1  ON 12
 ud_3                -4.326754e-04 1 1  ON 13
 ud_4                -5.842268e-02 1 1  ON 14
 ud_5                -1.007938e-01 1 1  ON 15
 ud_6                -1.295570e-01 1 1  ON 16
 ud_7                -1.478304e-01 1 1  ON 17
 ud_8                -1.498408e-01 1 1  ON 18
 ud_9                -1.417310e-01 1 1  ON 19
 eO_0                -7.055965e-01 1 1  ON 20
 eO_1                -3.855476e-01 1 1  ON 21
 eO_2                 2.851623e-02 1 1  ON 22
 eO_3                 3.441256e-01 1 1  ON 23
 eO_4                 5.687022e-01 1 1  ON 24
 eO_5                 5.257631e-01 1 1  ON 25
 eO_6                 2.818707e-01 1 1  ON 26
 eO_7                -6.503896e-02 1 1  ON 27
 eO_8                -3.288183e-01 1 1  ON 28
 eO_9                -2.255750e-01 1 1  ON 29
eH1_0                -2.925823e-01 1 1  ON 30
eH1_1                -1.890631e-01 1 1  ON 31
eH1_2                -1.404716e-01 1 1  ON 32
eH1_3                -8.507144e-02 1 1  ON 33
eH1_4                -3.479025e-02 1 1  ON 34
eH1_5                 4.772143e-03 1 1  ON 35
eH1_6                 7.302734e-02 1 1  ON 36
eH1_7                 1.571869e-01 1 1  ON 37
eH1_8                 2.281071e-01 1 1  ON 38
eH1_9                 2.114729e-01 1 1  ON 39
eH2_0                -2.903425e-01 1 1  ON 40
eH2_1                -1.872177e-01 1 1  ON 41
eH2_2                -1.387259e-01 1 1  ON 42
eH2_3                -8.316222e-02 1 1  ON 43
eH2_4                -3.318559e-02 1 1  ON 44
eH2_5                 5.667825e-03 1 1  ON 45
eH2_6                 7.517788e-02 1 1  ON 46
eH2_7                 1.572373e-01 1 1  ON 47
eH2_8                 2.244023e-01 1 1  ON 48
eH2_9                 2.365014e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.263441
====================================================
  Execution time = 2.0626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340772800696
                                         uncertainty =       0.003748398668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340772800696
                                         uncertainty =       0.003748398668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412766553
  error estimate for blocks of size 2^( 2) =       0.000425335382
  error estimate for blocks of size 2^( 3) =       0.000438530967
  error estimate for blocks of size 2^( 4) =       0.000450721210
  error estimate for blocks of size 2^( 5) =       0.000461076048
  error estimate for blocks of size 2^( 6) =       0.000466351211
  error estimate for blocks of size 2^( 7) =       0.000468891887

      target function =                  N/A
              le_mean =     -16.906729086885
             les_mean =     286.178240702241
             stat err =       0.000461760089
             autocorr =       1.251479639465
              std dev =       0.583740057989
             le_variance =       0.340752455301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690672908688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906729086885       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906728933349       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906729173899       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906728572157       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906728747223       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906729047236       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906729283242       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906729135932       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.082046e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906729086885       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906729036934       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906729109395       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906728919131       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906728913241       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906729026245       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906729070853       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.129862e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906729086885       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906729073380       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906729092562       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906729041794       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906729034162       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906729064906       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906729074807       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.091637e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012712 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6225e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.944845e-01 1 1  ON 0
 uu_1                 1.271417e-01 1 1  ON 1
 uu_2                 2.528223e-02 1 1  ON 2
 uu_3                -3.774285e-02 1 1  ON 3
 uu_4                -8.391474e-02 1 1  ON 4
 uu_5                -1.198570e-01 1 1  ON 5
 uu_6                -1.485032e-01 1 1  ON 6
 uu_7                -1.639197e-01 1 1  ON 7
 uu_8                -1.561148e-01 1 1  ON 8
 uu_9                -1.290847e-01 1 1  ON 9
 ud_0                 4.556395e-01 1 1  ON 10
 ud_1                 1.903295e-01 1 1  ON 11
 ud_2                 7.048142e-02 1 1  ON 12
 ud_3                -4.334609e-04 1 1  ON 13
 ud_4                -5.841460e-02 1 1  ON 14
 ud_5                -1.008190e-01 1 1  ON 15
 ud_6                -1.294921e-01 1 1  ON 16
 ud_7                -1.478069e-01 1 1  ON 17
 ud_8                -1.498323e-01 1 1  ON 18
 ud_9                -1.417225e-01 1 1  ON 19
 eO_0                -7.056130e-01 1 1  ON 20
 eO_1                -3.855107e-01 1 1  ON 21
 eO_2                 2.853144e-02 1 1  ON 22
 eO_3                 3.441509e-01 1 1  ON 23
 eO_4                 5.686744e-01 1 1  ON 24
 eO_5                 5.257585e-01 1 1  ON 25
 eO_6                 2.818928e-01 1 1  ON 26
 eO_7                -6.503331e-02 1 1  ON 27
 eO_8                -3.288323e-01 1 1  ON 28
 eO_9                -2.256066e-01 1 1  ON 29
eH1_0                -2.926075e-01 1 1  ON 30
eH1_1                -1.890407e-01 1 1  ON 31
eH1_2                -1.404905e-01 1 1  ON 32
eH1_3                -8.504456e-02 1 1  ON 33
eH1_4                -3.481403e-02 1 1  ON 34
eH1_5                 4.759590e-03 1 1  ON 35
eH1_6                 7.304814e-02 1 1  ON 36
eH1_7                 1.571524e-01 1 1  ON 37
eH1_8                 2.281031e-01 1 1  ON 38
eH1_9                 2.115050e-01 1 1  ON 39
eH2_0                -2.904238e-01 1 1  ON 40
eH2_1                -1.872236e-01 1 1  ON 41
eH2_2                -1.387356e-01 1 1  ON 42
eH2_3                -8.314971e-02 1 1  ON 43
eH2_4                -3.317743e-02 1 1  ON 44
eH2_5                 5.672976e-03 1 1  ON 45
eH2_6                 7.517803e-02 1 1  ON 46
eH2_7                 1.572638e-01 1 1  ON 47
eH2_8                 2.244179e-01 1 1  ON 48
eH2_9                 2.365171e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.229944
====================================================
  Execution time = 2.1945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330571239335
                                         uncertainty =       0.002887257576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330571239335
                                         uncertainty =       0.002887257576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406506801
  error estimate for blocks of size 2^( 2) =       0.000419317390
  error estimate for blocks of size 2^( 3) =       0.000432612400
  error estimate for blocks of size 2^( 4) =       0.000444784064
  error estimate for blocks of size 2^( 5) =       0.000454935112
  error estimate for blocks of size 2^( 6) =       0.000459771311
  error estimate for blocks of size 2^( 7) =       0.000467093782

      target function =                  N/A
              le_mean =     -16.907270390807
             les_mean =     286.186287461118
             stat err =       0.000456646067
             autocorr =       1.261896721429
              std dev =       0.574887431158
             le_variance =       0.330495558504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330440861122
                                         uncertainty =       0.002885971364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330440861122
                                         uncertainty =       0.002885971364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406426666
  error estimate for blocks of size 2^( 2) =       0.000419241020
  error estimate for blocks of size 2^( 3) =       0.000432540029
  error estimate for blocks of size 2^( 4) =       0.000444713848
  error estimate for blocks of size 2^( 5) =       0.000454868326
  error estimate for blocks of size 2^( 6) =       0.000459706628
  error estimate for blocks of size 2^( 7) =       0.000467027057

      target function =                  N/A
              le_mean =     -16.907271271335
             les_mean =     286.186186947115
             stat err =       0.000456578965
             autocorr =       1.262023404564
              std dev =       0.574774103281
             le_variance =       0.330365269803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330477805016
                                         uncertainty =       0.002886256243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330477805016
                                         uncertainty =       0.002886256243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406449374
  error estimate for blocks of size 2^( 2) =       0.000419262669
  error estimate for blocks of size 2^( 3) =       0.000432560618
  error estimate for blocks of size 2^( 4) =       0.000444733626
  error estimate for blocks of size 2^( 5) =       0.000454887171
  error estimate for blocks of size 2^( 6) =       0.000459724901
  error estimate for blocks of size 2^( 7) =       0.000467045345

      target function =                  N/A
              le_mean =     -16.907271044024
             les_mean =     286.186216177368
             stat err =       0.000456597761
             autocorr =       1.261986292966
              std dev =       0.574806216446
             le_variance =       0.330402186465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330558266248
                                         uncertainty =       0.002887116117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330558266248
                                         uncertainty =       0.002887116117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406498828
  error estimate for blocks of size 2^( 2) =       0.000419309791
  error estimate for blocks of size 2^( 3) =       0.000432605206
  error estimate for blocks of size 2^( 4) =       0.000444777045
  error estimate for blocks of size 2^( 5) =       0.000454928442
  error estimate for blocks of size 2^( 6) =       0.000459764862
  error estimate for blocks of size 2^( 7) =       0.000467087029

      target function =                  N/A
              le_mean =     -16.907270475204
             les_mean =     286.186277350343
             stat err =       0.000456639345
             autocorr =       1.261909067695
              std dev =       0.574876155242
             le_variance =       0.330482593866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907270390807        initial
     6.2500e-01     6.2500e+00             3.0820e-04       -16.907271271335  <--
     2.5000e+00     2.5000e+01             8.1299e-05       -16.907271044024
     1.0000e+01     1.0000e+02             2.0916e-05       -16.907270475204

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.1546e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.944172e-01 1 1  ON 0
 uu_1                 1.271870e-01 1 1  ON 1
 uu_2                 2.531643e-02 1 1  ON 2
 uu_3                -3.771397e-02 1 1  ON 3
 uu_4                -8.387984e-02 1 1  ON 4
 uu_5                -1.198771e-01 1 1  ON 5
 uu_6                -1.485766e-01 1 1  ON 6
 uu_7                -1.640084e-01 1 1  ON 7
 uu_8                -1.560937e-01 1 1  ON 8
 uu_9                -1.290544e-01 1 1  ON 9
 ud_0                 4.555581e-01 1 1  ON 10
 ud_1                 1.902985e-01 1 1  ON 11
 ud_2                 7.047009e-02 1 1  ON 12
 ud_3                -4.425073e-04 1 1  ON 13
 ud_4                -5.840899e-02 1 1  ON 14
 ud_5                -1.008572e-01 1 1  ON 15
 ud_6                -1.293601e-01 1 1  ON 16
 ud_7                -1.477418e-01 1 1  ON 17
 ud_8                -1.497982e-01 1 1  ON 18
 ud_9                -1.416947e-01 1 1  ON 19
 eO_0                -7.056111e-01 1 1  ON 20
 eO_1                -3.854473e-01 1 1  ON 21
 eO_2                 2.859368e-02 1 1  ON 22
 eO_3                 3.442170e-01 1 1  ON 23
 eO_4                 5.685963e-01 1 1  ON 24
 eO_5                 5.257403e-01 1 1  ON 25
 eO_6                 2.819539e-01 1 1  ON 26
 eO_7                -6.501472e-02 1 1  ON 27
 eO_8                -3.288764e-01 1 1  ON 28
 eO_9                -2.257068e-01 1 1  ON 29
eH1_0                -2.926732e-01 1 1  ON 30
eH1_1                -1.889891e-01 1 1  ON 31
eH1_2                -1.405263e-01 1 1  ON 32
eH1_3                -8.499324e-02 1 1  ON 33
eH1_4                -3.487181e-02 1 1  ON 34
eH1_5                 4.721141e-03 1 1  ON 35
eH1_6                 7.310879e-02 1 1  ON 36
eH1_7                 1.570441e-01 1 1  ON 37
eH1_8                 2.280913e-01 1 1  ON 38
eH1_9                 2.116067e-01 1 1  ON 39
eH2_0                -2.906507e-01 1 1  ON 40
eH2_1                -1.872415e-01 1 1  ON 41
eH2_2                -1.387738e-01 1 1  ON 42
eH2_3                -8.311362e-02 1 1  ON 43
eH2_4                -3.315972e-02 1 1  ON 44
eH2_5                 5.684496e-03 1 1  ON 45
eH2_6                 7.517582e-02 1 1  ON 46
eH2_7                 1.573434e-01 1 1  ON 47
eH2_8                 2.244667e-01 1 1  ON 48
eH2_9                 2.365670e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8905
    reference variance = 0.217747
====================================================
  Execution time = 2.0772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344422742028
                                         uncertainty =       0.003931118789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344422742028
                                         uncertainty =       0.003931118789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414963738
  error estimate for blocks of size 2^( 2) =       0.000427650320
  error estimate for blocks of size 2^( 3) =       0.000441320245
  error estimate for blocks of size 2^( 4) =       0.000454153887
  error estimate for blocks of size 2^( 5) =       0.000463611562
  error estimate for blocks of size 2^( 6) =       0.000470937304
  error estimate for blocks of size 2^( 7) =       0.000477735568

      target function =                  N/A
              le_mean =     -16.906270902860
             les_mean =     286.166385477128
             stat err =       0.000466609580
             autocorr =       1.264407338391
              std dev =       0.586847346794
             le_variance =       0.344389808439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627090286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906270902860       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273867730       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906275612151       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906275391705       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274460587       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906275750900       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906275737650       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906276334522       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906276224874       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906276111318       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 7.897273e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906270902860       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272017886       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272592017       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272895296       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272401918       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272354422       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272634641       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272687031       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.365965e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906270902860       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906271221832       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906271384402       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271514115       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906271363299       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906271362843       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906271399036       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 5.997057e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6347e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.943947e-01 1 1  ON 0
 uu_1                 1.270614e-01 1 1  ON 1
 uu_2                 2.519799e-02 1 1  ON 2
 uu_3                -3.783888e-02 1 1  ON 3
 uu_4                -8.388752e-02 1 1  ON 4
 uu_5                -1.198614e-01 1 1  ON 5
 uu_6                -1.485370e-01 1 1  ON 6
 uu_7                -1.638992e-01 1 1  ON 7
 uu_8                -1.561274e-01 1 1  ON 8
 uu_9                -1.290042e-01 1 1  ON 9
 ud_0                 4.555289e-01 1 1  ON 10
 ud_1                 1.903053e-01 1 1  ON 11
 ud_2                 7.046165e-02 1 1  ON 12
 ud_3                -5.189629e-04 1 1  ON 13
 ud_4                -5.839038e-02 1 1  ON 14
 ud_5                -1.007647e-01 1 1  ON 15
 ud_6                -1.295166e-01 1 1  ON 16
 ud_7                -1.478387e-01 1 1  ON 17
 ud_8                -1.496858e-01 1 1  ON 18
 ud_9                -1.415384e-01 1 1  ON 19
 eO_0                -7.055676e-01 1 1  ON 20
 eO_1                -3.854572e-01 1 1  ON 21
 eO_2                 2.863961e-02 1 1  ON 22
 eO_3                 3.442809e-01 1 1  ON 23
 eO_4                 5.686403e-01 1 1  ON 24
 eO_5                 5.257449e-01 1 1  ON 25
 eO_6                 2.820206e-01 1 1  ON 26
 eO_7                -6.499772e-02 1 1  ON 27
 eO_8                -3.289622e-01 1 1  ON 28
 eO_9                -2.258541e-01 1 1  ON 29
eH1_0                -2.927748e-01 1 1  ON 30
eH1_1                -1.889550e-01 1 1  ON 31
eH1_2                -1.406246e-01 1 1  ON 32
eH1_3                -8.502408e-02 1 1  ON 33
eH1_4                -3.496828e-02 1 1  ON 34
eH1_5                 4.574565e-03 1 1  ON 35
eH1_6                 7.315333e-02 1 1  ON 36
eH1_7                 1.571028e-01 1 1  ON 37
eH1_8                 2.281593e-01 1 1  ON 38
eH1_9                 2.117420e-01 1 1  ON 39
eH2_0                -2.908873e-01 1 1  ON 40
eH2_1                -1.873272e-01 1 1  ON 41
eH2_2                -1.387665e-01 1 1  ON 42
eH2_3                -8.321705e-02 1 1  ON 43
eH2_4                -3.318154e-02 1 1  ON 44
eH2_5                 5.778387e-03 1 1  ON 45
eH2_6                 7.516324e-02 1 1  ON 46
eH2_7                 1.574312e-01 1 1  ON 47
eH2_8                 2.245904e-01 1 1  ON 48
eH2_9                 2.366497e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9522
    reference variance = 0.208562
====================================================
  Execution time = 2.0119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4287e-01
  Total weights = 2.0000e+06
  Execution time = 1.8941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342898809640
                                         uncertainty =       0.004456190833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342898809640
                                         uncertainty =       0.004456190833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414052959
  error estimate for blocks of size 2^( 2) =       0.000426311928
  error estimate for blocks of size 2^( 3) =       0.000439180453
  error estimate for blocks of size 2^( 4) =       0.000450469978
  error estimate for blocks of size 2^( 5) =       0.000460200754
  error estimate for blocks of size 2^( 6) =       0.000467871069
  error estimate for blocks of size 2^( 7) =       0.000470866069

      target function =                  N/A
              le_mean =     -16.906576550950
             les_mean =     286.175210208099
             stat err =       0.000462351968
             autocorr =       1.246905769251
              std dev =       0.585559310757
             le_variance =       0.342879706415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342854982644
                                         uncertainty =       0.004458807066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342854982644
                                         uncertainty =       0.004458807066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414026588
  error estimate for blocks of size 2^( 2) =       0.000426291391
  error estimate for blocks of size 2^( 3) =       0.000439167112
  error estimate for blocks of size 2^( 4) =       0.000450463903
  error estimate for blocks of size 2^( 5) =       0.000460191482
  error estimate for blocks of size 2^( 6) =       0.000467860060
  error estimate for blocks of size 2^( 7) =       0.000470851646

      target function =                  N/A
              le_mean =     -16.906576339039
             les_mean =     286.175159368093
             stat err =       0.000462341773
             autocorr =       1.247009619898
              std dev =       0.585522016445
             le_variance =       0.342836031742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342875641469
                                         uncertainty =       0.004459817393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342875641469
                                         uncertainty =       0.004459817393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414039072
  error estimate for blocks of size 2^( 2) =       0.000426301779
  error estimate for blocks of size 2^( 3) =       0.000439175183
  error estimate for blocks of size 2^( 4) =       0.000450470438
  error estimate for blocks of size 2^( 5) =       0.000460198424
  error estimate for blocks of size 2^( 6) =       0.000467868102
  error estimate for blocks of size 2^( 7) =       0.000470860912

      target function =                  N/A
              le_mean =     -16.906576038906
             les_mean =     286.175169894679
             stat err =       0.000462349469
             autocorr =       1.246975936376
              std dev =       0.585539671424
             le_variance =       0.342856706812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342893221958
                                         uncertainty =       0.004456809246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342893221958
                                         uncertainty =       0.004456809246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414049603
  error estimate for blocks of size 2^( 2) =       0.000426309184
  error estimate for blocks of size 2^( 3) =       0.000439178461
  error estimate for blocks of size 2^( 4) =       0.000450468919
  error estimate for blocks of size 2^( 5) =       0.000460199351
  error estimate for blocks of size 2^( 6) =       0.000467869618
  error estimate for blocks of size 2^( 7) =       0.000470864574

      target function =                  N/A
              le_mean =     -16.906576480985
             les_mean =     286.175202283748
             stat err =       0.000462350616
             autocorr =       1.246918690789
              std dev =       0.585554564327
             le_variance =       0.342874147805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906576550950        initial  <--
     1.5625e-01     1.5625e+00             7.8973e-04       -16.906576339039
     6.2500e-01     6.2500e+00             2.3660e-04       -16.906576038906
     2.5000e+00     2.5000e+01             5.9971e-05       -16.906576480985

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7296
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.944172e-01 1 1  ON 0
 uu_1                 1.271870e-01 1 1  ON 1
 uu_2                 2.531643e-02 1 1  ON 2
 uu_3                -3.771397e-02 1 1  ON 3
 uu_4                -8.387984e-02 1 1  ON 4
 uu_5                -1.198771e-01 1 1  ON 5
 uu_6                -1.485766e-01 1 1  ON 6
 uu_7                -1.640084e-01 1 1  ON 7
 uu_8                -1.560937e-01 1 1  ON 8
 uu_9                -1.290544e-01 1 1  ON 9
 ud_0                 4.555581e-01 1 1  ON 10
 ud_1                 1.902985e-01 1 1  ON 11
 ud_2                 7.047009e-02 1 1  ON 12
 ud_3                -4.425073e-04 1 1  ON 13
 ud_4                -5.840899e-02 1 1  ON 14
 ud_5                -1.008572e-01 1 1  ON 15
 ud_6                -1.293601e-01 1 1  ON 16
 ud_7                -1.477418e-01 1 1  ON 17
 ud_8                -1.497982e-01 1 1  ON 18
 ud_9                -1.416947e-01 1 1  ON 19
 eO_0                -7.056111e-01 1 1  ON 20
 eO_1                -3.854473e-01 1 1  ON 21
 eO_2                 2.859368e-02 1 1  ON 22
 eO_3                 3.442170e-01 1 1  ON 23
 eO_4                 5.685963e-01 1 1  ON 24
 eO_5                 5.257403e-01 1 1  ON 25
 eO_6                 2.819539e-01 1 1  ON 26
 eO_7                -6.501472e-02 1 1  ON 27
 eO_8                -3.288764e-01 1 1  ON 28
 eO_9                -2.257068e-01 1 1  ON 29
eH1_0                -2.926732e-01 1 1  ON 30
eH1_1                -1.889891e-01 1 1  ON 31
eH1_2                -1.405263e-01 1 1  ON 32
eH1_3                -8.499324e-02 1 1  ON 33
eH1_4                -3.487181e-02 1 1  ON 34
eH1_5                 4.721141e-03 1 1  ON 35
eH1_6                 7.310879e-02 1 1  ON 36
eH1_7                 1.570441e-01 1 1  ON 37
eH1_8                 2.280913e-01 1 1  ON 38
eH1_9                 2.116067e-01 1 1  ON 39
eH2_0                -2.906507e-01 1 1  ON 40
eH2_1                -1.872415e-01 1 1  ON 41
eH2_2                -1.387738e-01 1 1  ON 42
eH2_3                -8.311362e-02 1 1  ON 43
eH2_4                -3.315972e-02 1 1  ON 44
eH2_5                 5.684496e-03 1 1  ON 45
eH2_6                 7.517582e-02 1 1  ON 46
eH2_7                 1.573434e-01 1 1  ON 47
eH2_8                 2.244667e-01 1 1  ON 48
eH2_9                 2.365670e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8917
    reference variance = 0.183089
====================================================
  Execution time = 2.0587e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3478e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334846194564
                                         uncertainty =       0.002977112040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334846194564
                                         uncertainty =       0.002977112040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409130786
  error estimate for blocks of size 2^( 2) =       0.000421198886
  error estimate for blocks of size 2^( 3) =       0.000433207920
  error estimate for blocks of size 2^( 4) =       0.000444769907
  error estimate for blocks of size 2^( 5) =       0.000454018062
  error estimate for blocks of size 2^( 6) =       0.000460534313
  error estimate for blocks of size 2^( 7) =       0.000463616418

      target function =                  N/A
              le_mean =     -16.906494400011
             les_mean =     286.164328730109
             stat err =       0.000455734675
             autocorr =       1.240794406474
              std dev =       0.578598306166
             le_variance =       0.334775999898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649440001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494400011       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494418312       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494985234       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906495555130       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906495577260       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906495643717       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906495773092       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906495732682       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.180176e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494400011       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494404893       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494559808       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906494722640       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906494730216       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906494746345       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906494787963       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.190888e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494400011       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494401252       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494440957       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906494483150       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906494485200       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906494489291       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906494500503       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.172381e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018131 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.944150e-01 1 1  ON 0
 uu_1                 1.271751e-01 1 1  ON 1
 uu_2                 2.530605e-02 1 1  ON 2
 uu_3                -3.771995e-02 1 1  ON 3
 uu_4                -8.386921e-02 1 1  ON 4
 uu_5                -1.198575e-01 1 1  ON 5
 uu_6                -1.485655e-01 1 1  ON 6
 uu_7                -1.640163e-01 1 1  ON 7
 uu_8                -1.561079e-01 1 1  ON 8
 uu_9                -1.290548e-01 1 1  ON 9
 ud_0                 4.555900e-01 1 1  ON 10
 ud_1                 1.903059e-01 1 1  ON 11
 ud_2                 7.048904e-02 1 1  ON 12
 ud_3                -4.359237e-04 1 1  ON 13
 ud_4                -5.839378e-02 1 1  ON 14
 ud_5                -1.008817e-01 1 1  ON 15
 ud_6                -1.293742e-01 1 1  ON 16
 ud_7                -1.477407e-01 1 1  ON 17
 ud_8                -1.498175e-01 1 1  ON 18
 ud_9                -1.417042e-01 1 1  ON 19
 eO_0                -7.056049e-01 1 1  ON 20
 eO_1                -3.854436e-01 1 1  ON 21
 eO_2                 2.860883e-02 1 1  ON 22
 eO_3                 3.442156e-01 1 1  ON 23
 eO_4                 5.686005e-01 1 1  ON 24
 eO_5                 5.257495e-01 1 1  ON 25
 eO_6                 2.819530e-01 1 1  ON 26
 eO_7                -6.501853e-02 1 1  ON 27
 eO_8                -3.288906e-01 1 1  ON 28
 eO_9                -2.257209e-01 1 1  ON 29
eH1_0                -2.926955e-01 1 1  ON 30
eH1_1                -1.889828e-01 1 1  ON 31
eH1_2                -1.405337e-01 1 1  ON 32
eH1_3                -8.501141e-02 1 1  ON 33
eH1_4                -3.487565e-02 1 1  ON 34
eH1_5                 4.724583e-03 1 1  ON 35
eH1_6                 7.312093e-02 1 1  ON 36
eH1_7                 1.570621e-01 1 1  ON 37
eH1_8                 2.280945e-01 1 1  ON 38
eH1_9                 2.116104e-01 1 1  ON 39
eH2_0                -2.906507e-01 1 1  ON 40
eH2_1                -1.872359e-01 1 1  ON 41
eH2_2                -1.387799e-01 1 1  ON 42
eH2_3                -8.312205e-02 1 1  ON 43
eH2_4                -3.315492e-02 1 1  ON 44
eH2_5                 5.680755e-03 1 1  ON 45
eH2_6                 7.516492e-02 1 1  ON 46
eH2_7                 1.573455e-01 1 1  ON 47
eH2_8                 2.244725e-01 1 1  ON 48
eH2_9                 2.365716e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9026
    reference variance = 0.196427
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4213e-01
  Total weights = 2.0000e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342093691460
                                         uncertainty =       0.005320830336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342093691460
                                         uncertainty =       0.005320830336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413590315
  error estimate for blocks of size 2^( 2) =       0.000425974476
  error estimate for blocks of size 2^( 3) =       0.000439108975
  error estimate for blocks of size 2^( 4) =       0.000451899723
  error estimate for blocks of size 2^( 5) =       0.000462921782
  error estimate for blocks of size 2^( 6) =       0.000471477036
  error estimate for blocks of size 2^( 7) =       0.000476493309

      target function =                  N/A
              le_mean =     -16.905810392073
             les_mean =     286.148538738351
             stat err =       0.000465697962
             autocorr =       1.267850234906
              std dev =       0.584905032200
             le_variance =       0.342113896693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342147199765
                                         uncertainty =       0.005321923720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342147199765
                                         uncertainty =       0.005321923720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413622659
  error estimate for blocks of size 2^( 2) =       0.000426006267
  error estimate for blocks of size 2^( 3) =       0.000439140209
  error estimate for blocks of size 2^( 4) =       0.000451930490
  error estimate for blocks of size 2^( 5) =       0.000462952088
  error estimate for blocks of size 2^( 6) =       0.000471508331
  error estimate for blocks of size 2^( 7) =       0.000476523707

      target function =                  N/A
              le_mean =     -16.905810518821
             les_mean =     286.148596534596
             stat err =       0.000465728654
             autocorr =       1.267819051348
              std dev =       0.584950773480
             le_variance =       0.342167407395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342124830200
                                         uncertainty =       0.005321454654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342124830200
                                         uncertainty =       0.005321454654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413609137
  error estimate for blocks of size 2^( 2) =       0.000425992985
  error estimate for blocks of size 2^( 3) =       0.000439127187
  error estimate for blocks of size 2^( 4) =       0.000451917697
  error estimate for blocks of size 2^( 5) =       0.000462939511
  error estimate for blocks of size 2^( 6) =       0.000471495315
  error estimate for blocks of size 2^( 7) =       0.000476511117

      target function =                  N/A
              le_mean =     -16.905810443928
             les_mean =     286.148571631425
             stat err =       0.000465715910
             autocorr =       1.267832562038
              std dev =       0.584931651117
             le_variance =       0.342145036478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342097716779
                                         uncertainty =       0.005320910917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342097716779
                                         uncertainty =       0.005320910917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413592748
  error estimate for blocks of size 2^( 2) =       0.000425976869
  error estimate for blocks of size 2^( 3) =       0.000439111330
  error estimate for blocks of size 2^( 4) =       0.000451902048
  error estimate for blocks of size 2^( 5) =       0.000462924077
  error estimate for blocks of size 2^( 6) =       0.000471479401
  error estimate for blocks of size 2^( 7) =       0.000476495613

      target function =                  N/A
              le_mean =     -16.905810397482
             les_mean =     286.148542946697
             stat err =       0.000465700285
             autocorr =       1.267847962205
              std dev =       0.584908473297
             le_variance =       0.342117922134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905810392073        initial
     1.5625e+00     1.5625e+01             1.1802e-04       -16.905810518821  <--
     6.2500e+00     6.2500e+01             3.1909e-05       -16.905810443928
     2.5000e+01     2.5000e+02             8.1724e-06       -16.905810397482

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9863e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.944037e-01 1 1  ON 0
 uu_1                 1.271406e-01 1 1  ON 1
 uu_2                 2.528189e-02 1 1  ON 2
 uu_3                -3.773499e-02 1 1  ON 3
 uu_4                -8.383912e-02 1 1  ON 4
 uu_5                -1.198081e-01 1 1  ON 5
 uu_6                -1.485360e-01 1 1  ON 6
 uu_7                -1.640368e-01 1 1  ON 7
 uu_8                -1.561491e-01 1 1  ON 8
 uu_9                -1.290549e-01 1 1  ON 9
 ud_0                 4.556761e-01 1 1  ON 10
 ud_1                 1.903354e-01 1 1  ON 11
 ud_2                 7.053922e-02 1 1  ON 12
 ud_3                -4.128880e-04 1 1  ON 13
 ud_4                -5.835466e-02 1 1  ON 14
 ud_5                -1.009373e-01 1 1  ON 15
 ud_6                -1.294171e-01 1 1  ON 16
 ud_7                -1.477400e-01 1 1  ON 17
 ud_8                -1.498750e-01 1 1  ON 18
 ud_9                -1.417332e-01 1 1  ON 19
 eO_0                -7.055873e-01 1 1  ON 20
 eO_1                -3.854293e-01 1 1  ON 21
 eO_2                 2.865110e-02 1 1  ON 22
 eO_3                 3.442160e-01 1 1  ON 23
 eO_4                 5.686162e-01 1 1  ON 24
 eO_5                 5.257768e-01 1 1  ON 25
 eO_6                 2.819488e-01 1 1  ON 26
 eO_7                -6.502948e-02 1 1  ON 27
 eO_8                -3.289348e-01 1 1  ON 28
 eO_9                -2.257660e-01 1 1  ON 29
eH1_0                -2.927617e-01 1 1  ON 30
eH1_1                -1.889672e-01 1 1  ON 31
eH1_2                -1.405584e-01 1 1  ON 32
eH1_3                -8.506407e-02 1 1  ON 33
eH1_4                -3.489090e-02 1 1  ON 34
eH1_5                 4.735238e-03 1 1  ON 35
eH1_6                 7.315735e-02 1 1  ON 36
eH1_7                 1.571189e-01 1 1  ON 37
eH1_8                 2.281057e-01 1 1  ON 38
eH1_9                 2.116229e-01 1 1  ON 39
eH2_0                -2.906520e-01 1 1  ON 40
eH2_1                -1.872265e-01 1 1  ON 41
eH2_2                -1.388008e-01 1 1  ON 42
eH2_3                -8.314242e-02 1 1  ON 43
eH2_4                -3.314217e-02 1 1  ON 44
eH2_5                 5.672205e-03 1 1  ON 45
eH2_6                 7.513254e-02 1 1  ON 46
eH2_7                 1.573529e-01 1 1  ON 47
eH2_8                 2.244912e-01 1 1  ON 48
eH2_9                 2.365868e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.22629
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334922784247
                                         uncertainty =       0.002791210062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334922784247
                                         uncertainty =       0.002791210062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409251141
  error estimate for blocks of size 2^( 2) =       0.000422378075
  error estimate for blocks of size 2^( 3) =       0.000435325707
  error estimate for blocks of size 2^( 4) =       0.000447222129
  error estimate for blocks of size 2^( 5) =       0.000457412273
  error estimate for blocks of size 2^( 6) =       0.000465963576
  error estimate for blocks of size 2^( 7) =       0.000470477637

      target function =                  N/A
              le_mean =     -16.906940586010
             les_mean =     286.179612803999
             stat err =       0.000460268904
             autocorr =       1.264862949966
              std dev =       0.578768513854
             le_variance =       0.334972992629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690694058601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906940586010       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906940160808       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906940376995       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906940775213       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906941205514       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906941987978       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906942077942       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906941802271       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906941828801       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.679175e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906940586010       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906940453024       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906940485895       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906940560893       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906940705345       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906940881788       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906940963106       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906940900649       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.354779e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906940586010       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906940550537       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906940555226       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906940569432       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906940603153       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906940643975       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906940668694       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906940660611       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.872131e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6361e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.942788e-01 1 1  ON 0
 uu_1                 1.271376e-01 1 1  ON 1
 uu_2                 2.531205e-02 1 1  ON 2
 uu_3                -3.767317e-02 1 1  ON 3
 uu_4                -8.379447e-02 1 1  ON 4
 uu_5                -1.197431e-01 1 1  ON 5
 uu_6                -1.485279e-01 1 1  ON 6
 uu_7                -1.640560e-01 1 1  ON 7
 uu_8                -1.561572e-01 1 1  ON 8
 uu_9                -1.291162e-01 1 1  ON 9
 ud_0                 4.557307e-01 1 1  ON 10
 ud_1                 1.903590e-01 1 1  ON 11
 ud_2                 7.057092e-02 1 1  ON 12
 ud_3                -4.109541e-04 1 1  ON 13
 ud_4                -5.829623e-02 1 1  ON 14
 ud_5                -1.009703e-01 1 1  ON 15
 ud_6                -1.294125e-01 1 1  ON 16
 ud_7                -1.476923e-01 1 1  ON 17
 ud_8                -1.499148e-01 1 1  ON 18
 ud_9                -1.418088e-01 1 1  ON 19
 eO_0                -7.056065e-01 1 1  ON 20
 eO_1                -3.852938e-01 1 1  ON 21
 eO_2                 2.866458e-02 1 1  ON 22
 eO_3                 3.441836e-01 1 1  ON 23
 eO_4                 5.686273e-01 1 1  ON 24
 eO_5                 5.257976e-01 1 1  ON 25
 eO_6                 2.819817e-01 1 1  ON 26
 eO_7                -6.504797e-02 1 1  ON 27
 eO_8                -3.289837e-01 1 1  ON 28
 eO_9                -2.258418e-01 1 1  ON 29
eH1_0                -2.928294e-01 1 1  ON 30
eH1_1                -1.889345e-01 1 1  ON 31
eH1_2                -1.405361e-01 1 1  ON 32
eH1_3                -8.508395e-02 1 1  ON 33
eH1_4                -3.490386e-02 1 1  ON 34
eH1_5                 4.663814e-03 1 1  ON 35
eH1_6                 7.318988e-02 1 1  ON 36
eH1_7                 1.571375e-01 1 1  ON 37
eH1_8                 2.281067e-01 1 1  ON 38
eH1_9                 2.116567e-01 1 1  ON 39
eH2_0                -2.907274e-01 1 1  ON 40
eH2_1                -1.872021e-01 1 1  ON 41
eH2_2                -1.388271e-01 1 1  ON 42
eH2_3                -8.318726e-02 1 1  ON 43
eH2_4                -3.317099e-02 1 1  ON 44
eH2_5                 5.696103e-03 1 1  ON 45
eH2_6                 7.513617e-02 1 1  ON 46
eH2_7                 1.574060e-01 1 1  ON 47
eH2_8                 2.245100e-01 1 1  ON 48
eH2_9                 2.366059e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9677
    reference variance = 0.249668
====================================================
  Execution time = 2.0299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3568e-01
  Total weights = 2.0000e+06
  Execution time = 1.9023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335803873333
                                         uncertainty =       0.002396719857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335803873333
                                         uncertainty =       0.002396719857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409699725
  error estimate for blocks of size 2^( 2) =       0.000422423853
  error estimate for blocks of size 2^( 3) =       0.000436085586
  error estimate for blocks of size 2^( 4) =       0.000448328552
  error estimate for blocks of size 2^( 5) =       0.000459026797
  error estimate for blocks of size 2^( 6) =       0.000467603415
  error estimate for blocks of size 2^( 7) =       0.000475005689

      target function =                  N/A
              le_mean =     -16.907162433460
             les_mean =     286.187849112375
             stat err =       0.000462491113
             autocorr =       1.274311023925
              std dev =       0.579402907149
             le_variance =       0.335707728813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335724825202
                                         uncertainty =       0.002396137523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335724825202
                                         uncertainty =       0.002396137523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409651555
  error estimate for blocks of size 2^( 2) =       0.000422376993
  error estimate for blocks of size 2^( 3) =       0.000436039210
  error estimate for blocks of size 2^( 4) =       0.000448282952
  error estimate for blocks of size 2^( 5) =       0.000458984493
  error estimate for blocks of size 2^( 6) =       0.000467560185
  error estimate for blocks of size 2^( 7) =       0.000474964357

      target function =                  N/A
              le_mean =     -16.907163554219
             les_mean =     286.187808073832
             stat err =       0.000462447997
             autocorr =       1.274373084110
              std dev =       0.579334784494
             le_variance =       0.335628792524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335755849498
                                         uncertainty =       0.002396364937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335755849498
                                         uncertainty =       0.002396364937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409670473
  error estimate for blocks of size 2^( 2) =       0.000422395629
  error estimate for blocks of size 2^( 3) =       0.000436057618
  error estimate for blocks of size 2^( 4) =       0.000448301148
  error estimate for blocks of size 2^( 5) =       0.000459002220
  error estimate for blocks of size 2^( 6) =       0.000467577631
  error estimate for blocks of size 2^( 7) =       0.000474980197

      target function =                  N/A
              le_mean =     -16.907163212388
             les_mean =     286.187827516112
             stat err =       0.000462465299
             autocorr =       1.274350738791
              std dev =       0.579361539630
             le_variance =       0.335659793602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335796738650
                                         uncertainty =       0.002396667373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335796738650
                                         uncertainty =       0.002396667373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409695379
  error estimate for blocks of size 2^( 2) =       0.000422419668
  error estimate for blocks of size 2^( 3) =       0.000436081445
  error estimate for blocks of size 2^( 4) =       0.000448324493
  error estimate for blocks of size 2^( 5) =       0.000459023167
  error estimate for blocks of size 2^( 6) =       0.000467599612
  error estimate for blocks of size 2^( 7) =       0.000475001889

      target function =                  N/A
              le_mean =     -16.907162521802
             les_mean =     286.187844977796
             stat err =       0.000462487290
             autocorr =       1.274316991202
              std dev =       0.579396761301
             le_variance =       0.335700607006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907162433460        initial
     3.9062e-01     3.9062e+00             3.6792e-04       -16.907163554219  <--
     1.5625e+00     1.5625e+01             1.3548e-04       -16.907163212388
     6.2500e+00     6.2500e+01             3.8721e-05       -16.907162521802

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9905e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.940429e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536714e-02 1 1  ON 2
 uu_3                -3.754568e-02 1 1  ON 3
 uu_4                -8.367330e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.484999e-01 1 1  ON 6
 uu_7                -1.640994e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558633e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.064989e-02 1 1  ON 12
 ud_3                -3.572706e-04 1 1  ON 13
 ud_4                -5.819390e-02 1 1  ON 14
 ud_5                -1.010009e-01 1 1  ON 15
 ud_6                -1.294213e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055375e-01 1 1  ON 20
 eO_1                -3.850613e-01 1 1  ON 21
 eO_2                 2.874534e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509954e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260675e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512719e-02 1 1  ON 33
eH1_4                -3.494106e-02 1 1  ON 34
eH1_5                 4.465068e-03 1 1  ON 35
eH1_6                 7.327486e-02 1 1  ON 36
eH1_7                 1.571888e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909214e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330050e-02 1 1  ON 43
eH2_4                -3.324834e-02 1 1  ON 44
eH2_5                 5.756695e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245676e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9636
    reference variance = 0.270827
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343454117064
                                         uncertainty =       0.006956601179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343454117064
                                         uncertainty =       0.006956601179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414353019
  error estimate for blocks of size 2^( 2) =       0.000426796818
  error estimate for blocks of size 2^( 3) =       0.000439439794
  error estimate for blocks of size 2^( 4) =       0.000451600696
  error estimate for blocks of size 2^( 5) =       0.000461769189
  error estimate for blocks of size 2^( 6) =       0.000469817762
  error estimate for blocks of size 2^( 7) =       0.000476127167

      target function =                  N/A
              le_mean =     -16.905937195037
             les_mean =     286.154089119739
             stat err =       0.000464828704
             autocorr =       1.258475778414
              std dev =       0.585983659246
             le_variance =       0.343376848903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593719504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905937195037       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942115796       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943857885       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943489113       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905944224675       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905944718902       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905945400250       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905944588102       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905945235502       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905945344922       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905945215647       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905945512848       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.048115e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905937195037       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905939582075       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940497487       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940382002       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941198139       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941210143       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941028723       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905940962318       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905941081529       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.105761e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905937195037       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905937975212       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905938347409       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905938455342       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905938492898       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905938693084       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905938579414       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905938565431       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.149634e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6132e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.943402e-01 1 1  ON 0
 uu_1                 1.270897e-01 1 1  ON 1
 uu_2                 2.523672e-02 1 1  ON 2
 uu_3                -3.756070e-02 1 1  ON 3
 uu_4                -8.350869e-02 1 1  ON 4
 uu_5                -1.197775e-01 1 1  ON 5
 uu_6                -1.485810e-01 1 1  ON 6
 uu_7                -1.639671e-01 1 1  ON 7
 uu_8                -1.562430e-01 1 1  ON 8
 uu_9                -1.294597e-01 1 1  ON 9
 ud_0                 4.560238e-01 1 1  ON 10
 ud_1                 1.904636e-01 1 1  ON 11
 ud_2                 7.075700e-02 1 1  ON 12
 ud_3                -2.264932e-04 1 1  ON 13
 ud_4                -5.821295e-02 1 1  ON 14
 ud_5                -1.009088e-01 1 1  ON 15
 ud_6                -1.295430e-01 1 1  ON 16
 ud_7                -1.478687e-01 1 1  ON 17
 ud_8                -1.500050e-01 1 1  ON 18
 ud_9                -1.419591e-01 1 1  ON 19
 eO_0                -7.052269e-01 1 1  ON 20
 eO_1                -3.851437e-01 1 1  ON 21
 eO_2                 2.878243e-02 1 1  ON 22
 eO_3                 3.439940e-01 1 1  ON 23
 eO_4                 5.689323e-01 1 1  ON 24
 eO_5                 5.260162e-01 1 1  ON 25
 eO_6                 2.819733e-01 1 1  ON 26
 eO_7                -6.514819e-02 1 1  ON 27
 eO_8                -3.292850e-01 1 1  ON 28
 eO_9                -2.262813e-01 1 1  ON 29
eH1_0                -2.930846e-01 1 1  ON 30
eH1_1                -1.890918e-01 1 1  ON 31
eH1_2                -1.403255e-01 1 1  ON 32
eH1_3                -8.489820e-02 1 1  ON 33
eH1_4                -3.484234e-02 1 1  ON 34
eH1_5                 4.225909e-03 1 1  ON 35
eH1_6                 7.320488e-02 1 1  ON 36
eH1_7                 1.571595e-01 1 1  ON 37
eH1_8                 2.280204e-01 1 1  ON 38
eH1_9                 2.118902e-01 1 1  ON 39
eH2_0                -2.910324e-01 1 1  ON 40
eH2_1                -1.873168e-01 1 1  ON 41
eH2_2                -1.389200e-01 1 1  ON 42
eH2_3                -8.331410e-02 1 1  ON 43
eH2_4                -3.315962e-02 1 1  ON 44
eH2_5                 5.579129e-03 1 1  ON 45
eH2_6                 7.511135e-02 1 1  ON 46
eH2_7                 1.576973e-01 1 1  ON 47
eH2_8                 2.246167e-01 1 1  ON 48
eH2_9                 2.367343e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9358
    reference variance = 0.1823
====================================================
  Execution time = 2.0452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3162e-01
  Total weights = 2.0000e+06
  Execution time = 1.8978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331508296304
                                         uncertainty =       0.003002796147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331508296304
                                         uncertainty =       0.003002796147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407125692
  error estimate for blocks of size 2^( 2) =       0.000420007566
  error estimate for blocks of size 2^( 3) =       0.000432842210
  error estimate for blocks of size 2^( 4) =       0.000445709464
  error estimate for blocks of size 2^( 5) =       0.000455712524
  error estimate for blocks of size 2^( 6) =       0.000463145057
  error estimate for blocks of size 2^( 7) =       0.000466313270

      target function =                  N/A
              le_mean =     -16.906346541173
             les_mean =     286.156055861988
             stat err =       0.000457720079
             autocorr =       1.263987878242
              std dev =       0.575762674647
             le_variance =       0.331502657516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331654679454
                                         uncertainty =       0.003005239680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331654679454
                                         uncertainty =       0.003005239680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407215549
  error estimate for blocks of size 2^( 2) =       0.000420095732
  error estimate for blocks of size 2^( 3) =       0.000432931549
  error estimate for blocks of size 2^( 4) =       0.000445795245
  error estimate for blocks of size 2^( 5) =       0.000455795382
  error estimate for blocks of size 2^( 6) =       0.000463222309
  error estimate for blocks of size 2^( 7) =       0.000466379225

      target function =                  N/A
              le_mean =     -16.906344802402
             les_mean =     286.156143418486
             stat err =       0.000457798041
             autocorr =       1.263860537772
              std dev =       0.575889752139
             le_variance =       0.331649006619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331759407801
                                         uncertainty =       0.003006141731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331759407801
                                         uncertainty =       0.003006141731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407279790
  error estimate for blocks of size 2^( 2) =       0.000420156646
  error estimate for blocks of size 2^( 3) =       0.000432992113
  error estimate for blocks of size 2^( 4) =       0.000445856560
  error estimate for blocks of size 2^( 5) =       0.000455858112
  error estimate for blocks of size 2^( 6) =       0.000463280104
  error estimate for blocks of size 2^( 7) =       0.000466440829

      target function =                  N/A
              le_mean =     -16.906344253573
             les_mean =     286.156229508720
             stat err =       0.000457858901
             autocorr =       1.263797825448
              std dev =       0.575980602344
             le_variance =       0.331753654276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331566454333
                                         uncertainty =       0.003003522763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331566454333
                                         uncertainty =       0.003003522763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407161386
  error estimate for blocks of size 2^( 2) =       0.000420041649
  error estimate for blocks of size 2^( 3) =       0.000432876147
  error estimate for blocks of size 2^( 4) =       0.000445742744
  error estimate for blocks of size 2^( 5) =       0.000455745516
  error estimate for blocks of size 2^( 6) =       0.000463175711
  error estimate for blocks of size 2^( 7) =       0.000466342729

      target function =                  N/A
              le_mean =     -16.906345774909
             les_mean =     286.156088083898
             stat err =       0.000457751675
             autocorr =       1.263940748097
              std dev =       0.575813154486
             le_variance =       0.331560788880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906346541173        initial  <--
     9.7656e-02     9.7656e-01             1.0481e-03       -16.906344802402
     3.9062e-01     3.9062e+00             3.1058e-04       -16.906344253573
     1.5625e+00     1.5625e+01             1.1496e-04       -16.906345774909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0598
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.940429e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536714e-02 1 1  ON 2
 uu_3                -3.754568e-02 1 1  ON 3
 uu_4                -8.367330e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.484999e-01 1 1  ON 6
 uu_7                -1.640994e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558633e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.064989e-02 1 1  ON 12
 ud_3                -3.572706e-04 1 1  ON 13
 ud_4                -5.819390e-02 1 1  ON 14
 ud_5                -1.010009e-01 1 1  ON 15
 ud_6                -1.294213e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055375e-01 1 1  ON 20
 eO_1                -3.850613e-01 1 1  ON 21
 eO_2                 2.874534e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509954e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260675e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512719e-02 1 1  ON 33
eH1_4                -3.494106e-02 1 1  ON 34
eH1_5                 4.465068e-03 1 1  ON 35
eH1_6                 7.327486e-02 1 1  ON 36
eH1_7                 1.571888e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909214e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330050e-02 1 1  ON 43
eH2_4                -3.324834e-02 1 1  ON 44
eH2_5                 5.756695e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245676e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.236785
====================================================
  Execution time = 2.0595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7825e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378193933819
                                         uncertainty =       0.035134171321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378193933819
                                         uncertainty =       0.035134171321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434885805
  error estimate for blocks of size 2^( 2) =       0.000446925193
  error estimate for blocks of size 2^( 3) =       0.000458347791
  error estimate for blocks of size 2^( 4) =       0.000469628855
  error estimate for blocks of size 2^( 5) =       0.000480460701
  error estimate for blocks of size 2^( 6) =       0.000489070212
  error estimate for blocks of size 2^( 7) =       0.000493161011

      target function =                  N/A
              le_mean =     -16.907271665059
             les_mean =     286.234086293151
             stat err =       0.000483080195
             autocorr =       1.233922837796
              std dev =       0.615021403011
             le_variance =       0.378251326162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690727166506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907271665059       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907272200751       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907272355019       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907272559642       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907272849471       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907272882222       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907272835721       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907272755866       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.397181e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907271665059       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907271815423       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907271866660       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907271925609       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907272012915       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907272035420       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907272004367       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907271989858       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.057855e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907271665059       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907271703840       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907271717806       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907271733279       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907271756381       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907271763466       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907271754482       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.006772e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6152e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.940484e-01 1 1  ON 0
 uu_1                 1.271366e-01 1 1  ON 1
 uu_2                 2.533711e-02 1 1  ON 2
 uu_3                -3.752701e-02 1 1  ON 3
 uu_4                -8.368410e-02 1 1  ON 4
 uu_5                -1.195990e-01 1 1  ON 5
 uu_6                -1.484797e-01 1 1  ON 6
 uu_7                -1.640933e-01 1 1  ON 7
 uu_8                -1.561917e-01 1 1  ON 8
 uu_9                -1.293087e-01 1 1  ON 9
 ud_0                 4.558634e-01 1 1  ON 10
 ud_1                 1.904726e-01 1 1  ON 11
 ud_2                 7.066495e-02 1 1  ON 12
 ud_3                -3.499183e-04 1 1  ON 13
 ud_4                -5.819421e-02 1 1  ON 14
 ud_5                -1.009812e-01 1 1  ON 15
 ud_6                -1.294395e-01 1 1  ON 16
 ud_7                -1.475918e-01 1 1  ON 17
 ud_8                -1.500237e-01 1 1  ON 18
 ud_9                -1.420306e-01 1 1  ON 19
 eO_0                -7.055220e-01 1 1  ON 20
 eO_1                -3.850608e-01 1 1  ON 21
 eO_2                 2.872460e-02 1 1  ON 22
 eO_3                 3.441486e-01 1 1  ON 23
 eO_4                 5.686802e-01 1 1  ON 24
 eO_5                 5.258459e-01 1 1  ON 25
 eO_6                 2.820764e-01 1 1  ON 26
 eO_7                -6.510388e-02 1 1  ON 27
 eO_8                -3.291482e-01 1 1  ON 28
 eO_9                -2.260952e-01 1 1  ON 29
eH1_0                -2.930033e-01 1 1  ON 30
eH1_1                -1.888848e-01 1 1  ON 31
eH1_2                -1.405190e-01 1 1  ON 32
eH1_3                -8.513599e-02 1 1  ON 33
eH1_4                -3.493541e-02 1 1  ON 34
eH1_5                 4.490116e-03 1 1  ON 35
eH1_6                 7.326751e-02 1 1  ON 36
eH1_7                 1.571756e-01 1 1  ON 37
eH1_8                 2.281279e-01 1 1  ON 38
eH1_9                 2.117767e-01 1 1  ON 39
eH2_0                -2.909568e-01 1 1  ON 40
eH2_1                -1.871609e-01 1 1  ON 41
eH2_2                -1.389170e-01 1 1  ON 42
eH2_3                -8.334108e-02 1 1  ON 43
eH2_4                -3.323673e-02 1 1  ON 44
eH2_5                 5.753599e-03 1 1  ON 45
eH2_6                 7.516780e-02 1 1  ON 46
eH2_7                 1.575938e-01 1 1  ON 47
eH2_8                 2.245723e-01 1 1  ON 48
eH2_9                 2.366647e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9546
    reference variance = 0.289079
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4730e-01
  Total weights = 2.0000e+06
  Execution time = 1.9039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347441729215
                                         uncertainty =       0.009047574356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347441729215
                                         uncertainty =       0.009047574356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416717160
  error estimate for blocks of size 2^( 2) =       0.000429115172
  error estimate for blocks of size 2^( 3) =       0.000442251676
  error estimate for blocks of size 2^( 4) =       0.000454675522
  error estimate for blocks of size 2^( 5) =       0.000466158636
  error estimate for blocks of size 2^( 6) =       0.000474673500
  error estimate for blocks of size 2^( 7) =       0.000480089267

      target function =                  N/A
              le_mean =     -16.906152238475
             les_mean =     286.165289719740
             stat err =       0.000468899231
             autocorr =       1.266124090421
              std dev =       0.589327059378
             le_variance =       0.347306382916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347430203601
                                         uncertainty =       0.009048198437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347430203601
                                         uncertainty =       0.009048198437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416710254
  error estimate for blocks of size 2^( 2) =       0.000429110357
  error estimate for blocks of size 2^( 3) =       0.000442248014
  error estimate for blocks of size 2^( 4) =       0.000454673597
  error estimate for blocks of size 2^( 5) =       0.000466152127
  error estimate for blocks of size 2^( 6) =       0.000474662650
  error estimate for blocks of size 2^( 7) =       0.000480077950

      target function =                  N/A
              le_mean =     -16.906151595288
             les_mean =     286.165256460831
             stat err =       0.000468891581
             autocorr =       1.266124741822
              std dev =       0.589317292829
             le_variance =       0.347294871627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347434698458
                                         uncertainty =       0.009047699294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347434698458
                                         uncertainty =       0.009047699294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416712948
  error estimate for blocks of size 2^( 2) =       0.000429112147
  error estimate for blocks of size 2^( 3) =       0.000442249334
  error estimate for blocks of size 2^( 4) =       0.000454674322
  error estimate for blocks of size 2^( 5) =       0.000466154730
  error estimate for blocks of size 2^( 6) =       0.000474667051
  error estimate for blocks of size 2^( 7) =       0.000480082383

      target function =                  N/A
              le_mean =     -16.906151783198
             les_mean =     286.165267305264
             stat err =       0.000468894621
             autocorr =       1.266124788470
              std dev =       0.589321102953
             le_variance =       0.347299362386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347440688344
                                         uncertainty =       0.009047569533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347440688344
                                         uncertainty =       0.009047569533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416716536
  error estimate for blocks of size 2^( 2) =       0.000429114706
  error estimate for blocks of size 2^( 3) =       0.000442251297
  error estimate for blocks of size 2^( 4) =       0.000454675302
  error estimate for blocks of size 2^( 5) =       0.000466158051
  error estimate for blocks of size 2^( 6) =       0.000474672578
  error estimate for blocks of size 2^( 7) =       0.000480088280

      target function =                  N/A
              le_mean =     -16.906152167053
             les_mean =     286.165286265381
             stat err =       0.000468898553
             autocorr =       1.266124215671
              std dev =       0.589326177492
             le_variance =       0.347305343478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906152238475        initial  <--
     9.7656e-01     9.7656e+00             1.3972e-04       -16.906151595288
     3.9062e+00     3.9062e+01             4.0579e-05       -16.906151783198
     1.5625e+01     1.5625e+02             1.0068e-05       -16.906152167053

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.9275
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.940429e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536714e-02 1 1  ON 2
 uu_3                -3.754568e-02 1 1  ON 3
 uu_4                -8.367330e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.484999e-01 1 1  ON 6
 uu_7                -1.640994e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558633e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.064989e-02 1 1  ON 12
 ud_3                -3.572706e-04 1 1  ON 13
 ud_4                -5.819390e-02 1 1  ON 14
 ud_5                -1.010009e-01 1 1  ON 15
 ud_6                -1.294213e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055375e-01 1 1  ON 20
 eO_1                -3.850613e-01 1 1  ON 21
 eO_2                 2.874534e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509954e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260675e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512719e-02 1 1  ON 33
eH1_4                -3.494106e-02 1 1  ON 34
eH1_5                 4.465068e-03 1 1  ON 35
eH1_6                 7.327486e-02 1 1  ON 36
eH1_7                 1.571888e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909214e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330050e-02 1 1  ON 43
eH2_4                -3.324834e-02 1 1  ON 44
eH2_5                 5.756695e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245676e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9088e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9872
    reference variance = 0.352986
====================================================
  Execution time = 2.0962e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362475488958
                                         uncertainty =       0.019159894592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362475488958
                                         uncertainty =       0.019159894592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425692345
  error estimate for blocks of size 2^( 2) =       0.000437701365
  error estimate for blocks of size 2^( 3) =       0.000449843762
  error estimate for blocks of size 2^( 4) =       0.000461024843
  error estimate for blocks of size 2^( 5) =       0.000470317533
  error estimate for blocks of size 2^( 6) =       0.000479094212
  error estimate for blocks of size 2^( 7) =       0.000483613216

      target function =                  N/A
              le_mean =     -16.906325422186
             les_mean =     286.186267044362
             stat err =       0.000473512451
             autocorr =       1.237288926034
              std dev =       0.602019887312
             le_variance =       0.362427944719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632542219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325422186       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325433386       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906325409254       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906325435960       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906325427038       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906325404847       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325412457       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906325413761       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.726324e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325422186       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325425025       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906325418838       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906325425700       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906325423386       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906325417694       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325419575       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 7.331405e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325422186       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325422898       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906325421342       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906325423069       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906325422485       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906325421053       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325421521       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.847741e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029376 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6589e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.940482e-01 1 1  ON 0
 uu_1                 1.271343e-01 1 1  ON 1
 uu_2                 2.536673e-02 1 1  ON 2
 uu_3                -3.754697e-02 1 1  ON 3
 uu_4                -8.367227e-02 1 1  ON 4
 uu_5                -1.196069e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640991e-01 1 1  ON 7
 uu_8                -1.561844e-01 1 1  ON 8
 uu_9                -1.292984e-01 1 1  ON 9
 ud_0                 4.558669e-01 1 1  ON 10
 ud_1                 1.904557e-01 1 1  ON 11
 ud_2                 7.065147e-02 1 1  ON 12
 ud_3                -3.560887e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.009983e-01 1 1  ON 15
 ud_6                -1.294238e-01 1 1  ON 16
 ud_7                -1.475784e-01 1 1  ON 17
 ud_8                -1.500154e-01 1 1  ON 18
 ud_9                -1.420279e-01 1 1  ON 19
 eO_0                -7.055320e-01 1 1  ON 20
 eO_1                -3.850687e-01 1 1  ON 21
 eO_2                 2.874952e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686554e-01 1 1  ON 24
 eO_5                 5.258504e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.510065e-02 1 1  ON 27
 eO_8                -3.291301e-01 1 1  ON 28
 eO_9                -2.260703e-01 1 1  ON 29
eH1_0                -2.929927e-01 1 1  ON 30
eH1_1                -1.888794e-01 1 1  ON 31
eH1_2                -1.404864e-01 1 1  ON 32
eH1_3                -8.512920e-02 1 1  ON 33
eH1_4                -3.494058e-02 1 1  ON 34
eH1_5                 4.465907e-03 1 1  ON 35
eH1_6                 7.327630e-02 1 1  ON 36
eH1_7                 1.571880e-01 1 1  ON 37
eH1_8                 2.281117e-01 1 1  ON 38
eH1_9                 2.117599e-01 1 1  ON 39
eH2_0                -2.909252e-01 1 1  ON 40
eH2_1                -1.871889e-01 1 1  ON 41
eH2_2                -1.388982e-01 1 1  ON 42
eH2_3                -8.330214e-02 1 1  ON 43
eH2_4                -3.324619e-02 1 1  ON 44
eH2_5                 5.755692e-03 1 1  ON 45
eH2_6                 7.515163e-02 1 1  ON 46
eH2_7                 1.575641e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.381908
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514312249
                                         uncertainty =       0.003987887195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514312249
                                         uncertainty =       0.003987887195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411420973
  error estimate for blocks of size 2^( 2) =       0.000424004369
  error estimate for blocks of size 2^( 3) =       0.000436421716
  error estimate for blocks of size 2^( 4) =       0.000447906813
  error estimate for blocks of size 2^( 5) =       0.000457135411
  error estimate for blocks of size 2^( 6) =       0.000462912282
  error estimate for blocks of size 2^( 7) =       0.000466872596

      target function =                  N/A
              le_mean =     -16.906429327512
             les_mean =     286.165886870759
             stat err =       0.000458706775
             autocorr =       1.243075354708
              std dev =       0.581837119697
             le_variance =       0.338534433857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338519812360
                                         uncertainty =       0.003988072183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338519812360
                                         uncertainty =       0.003988072183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411424313
  error estimate for blocks of size 2^( 2) =       0.000424007572
  error estimate for blocks of size 2^( 3) =       0.000436424838
  error estimate for blocks of size 2^( 4) =       0.000447909865
  error estimate for blocks of size 2^( 5) =       0.000457138601
  error estimate for blocks of size 2^( 6) =       0.000462915232
  error estimate for blocks of size 2^( 7) =       0.000466874861

      target function =                  N/A
              le_mean =     -16.906429140415
             les_mean =     286.165886040918
             stat err =       0.000458709640
             autocorr =       1.243070696510
              std dev =       0.581841843031
             le_variance =       0.338539930302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338517089554
                                         uncertainty =       0.003987984042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338517089554
                                         uncertainty =       0.003987984042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411422659
  error estimate for blocks of size 2^( 2) =       0.000424005985
  error estimate for blocks of size 2^( 3) =       0.000436423287
  error estimate for blocks of size 2^( 4) =       0.000447908353
  error estimate for blocks of size 2^( 5) =       0.000457137033
  error estimate for blocks of size 2^( 6) =       0.000462913775
  error estimate for blocks of size 2^( 7) =       0.000466873732

      target function =                  N/A
              le_mean =     -16.906429225328
             les_mean =     286.165886190788
             stat err =       0.000458708223
             autocorr =       1.243073011531
              std dev =       0.581839504544
             le_variance =       0.338537209047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514661827
                                         uncertainty =       0.003987899396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514661827
                                         uncertainty =       0.003987899396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411421185
  error estimate for blocks of size 2^( 2) =       0.000424004572
  error estimate for blocks of size 2^( 3) =       0.000436421913
  error estimate for blocks of size 2^( 4) =       0.000447907007
  error estimate for blocks of size 2^( 5) =       0.000457135615
  error estimate for blocks of size 2^( 6) =       0.000462912470
  error estimate for blocks of size 2^( 7) =       0.000466872739

      target function =                  N/A
              le_mean =     -16.906429314563
             les_mean =     286.165886782234
             stat err =       0.000458706957
             autocorr =       1.243075059428
              std dev =       0.581837419878
             le_variance =       0.338534783170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906429327512        initial  <--
     9.7656e+00     9.7656e+01             2.7263e-05       -16.906429140415
     3.9062e+01     3.9062e+02             7.3314e-06       -16.906429225328
     1.5625e+02     1.5625e+03             1.8477e-06       -16.906429314563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0257
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.940429e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536714e-02 1 1  ON 2
 uu_3                -3.754568e-02 1 1  ON 3
 uu_4                -8.367330e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.484999e-01 1 1  ON 6
 uu_7                -1.640994e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558633e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.064989e-02 1 1  ON 12
 ud_3                -3.572706e-04 1 1  ON 13
 ud_4                -5.819390e-02 1 1  ON 14
 ud_5                -1.010009e-01 1 1  ON 15
 ud_6                -1.294213e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055375e-01 1 1  ON 20
 eO_1                -3.850613e-01 1 1  ON 21
 eO_2                 2.874534e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509954e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260675e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512719e-02 1 1  ON 33
eH1_4                -3.494106e-02 1 1  ON 34
eH1_5                 4.465068e-03 1 1  ON 35
eH1_6                 7.327486e-02 1 1  ON 36
eH1_7                 1.571888e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909214e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330050e-02 1 1  ON 43
eH2_4                -3.324834e-02 1 1  ON 44
eH2_5                 5.756695e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245676e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.324905
====================================================
  Execution time = 2.0841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3660e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336556913630
                                         uncertainty =       0.003277446057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336556913630
                                         uncertainty =       0.003277446057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410242087
  error estimate for blocks of size 2^( 2) =       0.000423205133
  error estimate for blocks of size 2^( 3) =       0.000436606661
  error estimate for blocks of size 2^( 4) =       0.000448994152
  error estimate for blocks of size 2^( 5) =       0.000460078134
  error estimate for blocks of size 2^( 6) =       0.000466327523
  error estimate for blocks of size 2^( 7) =       0.000470748579

      target function =                  N/A
              le_mean =     -16.907137007117
             les_mean =     286.187878748203
             stat err =       0.000461537097
             autocorr =       1.265705896502
              std dev =       0.580169922589
             le_variance =       0.336597139077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690713700712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907137007117       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907137015728       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907137022029       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907137021073       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907137013733       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907137013461       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907137016602       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.182972e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907137007117       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907137009274       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907137010854       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907137010616       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907137008777       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907137008708       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907137009493       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.459922e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907137007117       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907137007656       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907137008052       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907137007993       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907137007532       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907137007514       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907137007712       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.365136e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6404e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.940434e-01 1 1  ON 0
 uu_1                 1.271354e-01 1 1  ON 1
 uu_2                 2.536704e-02 1 1  ON 2
 uu_3                -3.754578e-02 1 1  ON 3
 uu_4                -8.367329e-02 1 1  ON 4
 uu_5                -1.196078e-01 1 1  ON 5
 uu_6                -1.484996e-01 1 1  ON 6
 uu_7                -1.640995e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292971e-01 1 1  ON 9
 ud_0                 4.558634e-01 1 1  ON 10
 ud_1                 1.904537e-01 1 1  ON 11
 ud_2                 7.065037e-02 1 1  ON 12
 ud_3                -3.571232e-04 1 1  ON 13
 ud_4                -5.819398e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294210e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500143e-01 1 1  ON 18
 ud_9                -1.420272e-01 1 1  ON 19
 eO_0                -7.055372e-01 1 1  ON 20
 eO_1                -3.850615e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441144e-01 1 1  ON 23
 eO_4                 5.686544e-01 1 1  ON 24
 eO_5                 5.258463e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.509972e-02 1 1  ON 27
 eO_8                -3.291272e-01 1 1  ON 28
 eO_9                -2.260678e-01 1 1  ON 29
eH1_0                -2.929916e-01 1 1  ON 30
eH1_1                -1.888770e-01 1 1  ON 31
eH1_2                -1.404864e-01 1 1  ON 32
eH1_3                -8.512717e-02 1 1  ON 33
eH1_4                -3.494102e-02 1 1  ON 34
eH1_5                 4.465122e-03 1 1  ON 35
eH1_6                 7.327480e-02 1 1  ON 36
eH1_7                 1.571887e-01 1 1  ON 37
eH1_8                 2.281112e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909217e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389011e-01 1 1  ON 42
eH2_3                -8.330048e-02 1 1  ON 43
eH2_4                -3.324819e-02 1 1  ON 44
eH2_5                 5.756840e-03 1 1  ON 45
eH2_6                 7.515037e-02 1 1  ON 46
eH2_7                 1.575633e-01 1 1  ON 47
eH2_8                 2.245676e-01 1 1  ON 48
eH2_9                 2.366634e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8916
    reference variance = 0.395505
====================================================
  Execution time = 2.2306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3871e-01
  Total weights = 2.0000e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717662025
                                         uncertainty =       0.004198788468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717662025
                                         uncertainty =       0.004198788468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411529232
  error estimate for blocks of size 2^( 2) =       0.000423871169
  error estimate for blocks of size 2^( 3) =       0.000436403703
  error estimate for blocks of size 2^( 4) =       0.000447537642
  error estimate for blocks of size 2^( 5) =       0.000456692794
  error estimate for blocks of size 2^( 6) =       0.000463842294
  error estimate for blocks of size 2^( 7) =       0.000467958588

      target function =                  N/A
              le_mean =     -16.906584609669
             les_mean =     286.171315612686
             stat err =       0.000459007830
             autocorr =       1.244052783802
              std dev =       0.581990221690
             le_variance =       0.338712618142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717295554
                                         uncertainty =       0.004198779831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717295554
                                         uncertainty =       0.004198779831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411529010
  error estimate for blocks of size 2^( 2) =       0.000423870961
  error estimate for blocks of size 2^( 3) =       0.000436403483
  error estimate for blocks of size 2^( 4) =       0.000447537417
  error estimate for blocks of size 2^( 5) =       0.000456692563
  error estimate for blocks of size 2^( 6) =       0.000463842068
  error estimate for blocks of size 2^( 7) =       0.000467958413

      target function =                  N/A
              le_mean =     -16.906584608212
             les_mean =     286.171315196834
             stat err =       0.000459007615
             autocorr =       1.244052967052
              std dev =       0.581989906745
             le_variance =       0.338712251553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717477944
                                         uncertainty =       0.004198784145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717477944
                                         uncertainty =       0.004198784145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411529120
  error estimate for blocks of size 2^( 2) =       0.000423871065
  error estimate for blocks of size 2^( 3) =       0.000436403593
  error estimate for blocks of size 2^( 4) =       0.000447537529
  error estimate for blocks of size 2^( 5) =       0.000456692678
  error estimate for blocks of size 2^( 6) =       0.000463842181
  error estimate for blocks of size 2^( 7) =       0.000467958500

      target function =                  N/A
              le_mean =     -16.906584608934
             les_mean =     286.171315403680
             stat err =       0.000459007722
             autocorr =       1.244052876304
              std dev =       0.581990063491
             le_variance =       0.338712434002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717638986
                                         uncertainty =       0.004198787927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338717638986
                                         uncertainty =       0.004198787927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411529218
  error estimate for blocks of size 2^( 2) =       0.000423871156
  error estimate for blocks of size 2^( 3) =       0.000436403689
  error estimate for blocks of size 2^( 4) =       0.000447537628
  error estimate for blocks of size 2^( 5) =       0.000456692780
  error estimate for blocks of size 2^( 6) =       0.000463842280
  error estimate for blocks of size 2^( 7) =       0.000467958577

      target function =                  N/A
              le_mean =     -16.906584609577
             les_mean =     286.171315586513
             stat err =       0.000459007816
             autocorr =       1.244052795395
              std dev =       0.581990201890
             le_variance =       0.338712595096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906584609669        initial  <--
     9.7656e+01     9.7656e+02             2.1830e-06       -16.906584608212
     3.9062e+02     3.9062e+03             5.4599e-07       -16.906584608934
     1.5625e+03     1.5625e+04             1.3651e-07       -16.906584609577

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9177
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.940429e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536714e-02 1 1  ON 2
 uu_3                -3.754568e-02 1 1  ON 3
 uu_4                -8.367330e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.484999e-01 1 1  ON 6
 uu_7                -1.640994e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558633e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.064989e-02 1 1  ON 12
 ud_3                -3.572706e-04 1 1  ON 13
 ud_4                -5.819390e-02 1 1  ON 14
 ud_5                -1.010009e-01 1 1  ON 15
 ud_6                -1.294213e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055375e-01 1 1  ON 20
 eO_1                -3.850613e-01 1 1  ON 21
 eO_2                 2.874534e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509954e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260675e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512719e-02 1 1  ON 33
eH1_4                -3.494106e-02 1 1  ON 34
eH1_5                 4.465068e-03 1 1  ON 35
eH1_6                 7.327486e-02 1 1  ON 36
eH1_7                 1.571888e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909214e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330050e-02 1 1  ON 43
eH2_4                -3.324834e-02 1 1  ON 44
eH2_5                 5.756695e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245676e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.95
    reference variance = 0.28468
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4302e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343009655866
                                         uncertainty =       0.004733080377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343009655866
                                         uncertainty =       0.004733080377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414136191
  error estimate for blocks of size 2^( 2) =       0.000427036695
  error estimate for blocks of size 2^( 3) =       0.000440121949
  error estimate for blocks of size 2^( 4) =       0.000452897954
  error estimate for blocks of size 2^( 5) =       0.000462974754
  error estimate for blocks of size 2^( 6) =       0.000471981830
  error estimate for blocks of size 2^( 7) =       0.000478070337

      target function =                  N/A
              le_mean =     -16.905756856829
             les_mean =     286.147632300908
             stat err =       0.000466481219
             autocorr =       1.268767237498
              std dev =       0.585677018665
             le_variance =       0.343017570193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575685683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905756856829       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905756857373       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905756857560       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905756858053       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756857965       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756857933       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756857901       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.060487e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905756856829       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905756856965       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905756857012       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905756857135       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756857115       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756857107       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756857097       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.151837e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905756856829       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905756856863       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905756856875       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905756856906       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905756856903       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756856899       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756856897       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.287998e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6385e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.940430e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536712e-02 1 1  ON 2
 uu_3                -3.754568e-02 1 1  ON 3
 uu_4                -8.367333e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.485000e-01 1 1  ON 6
 uu_7                -1.640994e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558634e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.064988e-02 1 1  ON 12
 ud_3                -3.572722e-04 1 1  ON 13
 ud_4                -5.819391e-02 1 1  ON 14
 ud_5                -1.010009e-01 1 1  ON 15
 ud_6                -1.294214e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055374e-01 1 1  ON 20
 eO_1                -3.850614e-01 1 1  ON 21
 eO_2                 2.874536e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509954e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260676e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512718e-02 1 1  ON 33
eH1_4                -3.494111e-02 1 1  ON 34
eH1_5                 4.465075e-03 1 1  ON 35
eH1_6                 7.327488e-02 1 1  ON 36
eH1_7                 1.571889e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909214e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330052e-02 1 1  ON 43
eH2_4                -3.324833e-02 1 1  ON 44
eH2_5                 5.756704e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245677e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.25218
====================================================
  Execution time = 2.0191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2959e-01
  Total weights = 2.0000e+06
  Execution time = 1.8980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673510586
                                         uncertainty =       0.002386080799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673510586
                                         uncertainty =       0.002386080799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405946632
  error estimate for blocks of size 2^( 2) =       0.000418997293
  error estimate for blocks of size 2^( 3) =       0.000432104970
  error estimate for blocks of size 2^( 4) =       0.000444574491
  error estimate for blocks of size 2^( 5) =       0.000455720684
  error estimate for blocks of size 2^( 6) =       0.000463915015
  error estimate for blocks of size 2^( 7) =       0.000466774680

      target function =                  N/A
              le_mean =     -16.906257414074
             les_mean =     286.151124921819
             stat err =       0.000457746218
             autocorr =       1.271486180779
              std dev =       0.574095232227
             le_variance =       0.329585335666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673678452
                                         uncertainty =       0.002386081338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673678452
                                         uncertainty =       0.002386081338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405946735
  error estimate for blocks of size 2^( 2) =       0.000418997393
  error estimate for blocks of size 2^( 3) =       0.000432105067
  error estimate for blocks of size 2^( 4) =       0.000444574585
  error estimate for blocks of size 2^( 5) =       0.000455720777
  error estimate for blocks of size 2^( 6) =       0.000463915106
  error estimate for blocks of size 2^( 7) =       0.000466774774

      target function =                  N/A
              le_mean =     -16.906257414471
             les_mean =     286.151125103059
             stat err =       0.000457746311
             autocorr =       1.271486049472
              std dev =       0.574095378405
             le_variance =       0.329585503506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673594544
                                         uncertainty =       0.002386081069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673594544
                                         uncertainty =       0.002386081069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405946683
  error estimate for blocks of size 2^( 2) =       0.000418997343
  error estimate for blocks of size 2^( 3) =       0.000432105019
  error estimate for blocks of size 2^( 4) =       0.000444574538
  error estimate for blocks of size 2^( 5) =       0.000455720731
  error estimate for blocks of size 2^( 6) =       0.000463915061
  error estimate for blocks of size 2^( 7) =       0.000466774727

      target function =                  N/A
              le_mean =     -16.906257414272
             les_mean =     286.151125012459
             stat err =       0.000457746264
             autocorr =       1.271486115114
              std dev =       0.574095305338
             le_variance =       0.329585419611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673521082
                                         uncertainty =       0.002386080833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329673521082
                                         uncertainty =       0.002386080833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405946638
  error estimate for blocks of size 2^( 2) =       0.000418997299
  error estimate for blocks of size 2^( 3) =       0.000432104976
  error estimate for blocks of size 2^( 4) =       0.000444574497
  error estimate for blocks of size 2^( 5) =       0.000455720690
  error estimate for blocks of size 2^( 6) =       0.000463915021
  error estimate for blocks of size 2^( 7) =       0.000466774686

      target function =                  N/A
              le_mean =     -16.906257414099
             les_mean =     286.151124933150
             stat err =       0.000457746224
             autocorr =       1.271486172567
              std dev =       0.574095241367
             le_variance =       0.329585346160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906257414074        initial
     9.7656e+02     9.7656e+03             2.0605e-07       -16.906257414471  <--
     3.9062e+03     3.9062e+04             5.1518e-08       -16.906257414272
     1.5625e+04     1.5625e+05             1.2880e-08       -16.906257414099

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 2.9806e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.940431e-01 1 1  ON 0
 uu_1                 1.271354e-01 1 1  ON 1
 uu_2                 2.536707e-02 1 1  ON 2
 uu_3                -3.754571e-02 1 1  ON 3
 uu_4                -8.367340e-02 1 1  ON 4
 uu_5                -1.196076e-01 1 1  ON 5
 uu_6                -1.485001e-01 1 1  ON 6
 uu_7                -1.640993e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292968e-01 1 1  ON 9
 ud_0                 4.558635e-01 1 1  ON 10
 ud_1                 1.904534e-01 1 1  ON 11
 ud_2                 7.064985e-02 1 1  ON 12
 ud_3                -3.572769e-04 1 1  ON 13
 ud_4                -5.819394e-02 1 1  ON 14
 ud_5                -1.010008e-01 1 1  ON 15
 ud_6                -1.294214e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500137e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055374e-01 1 1  ON 20
 eO_1                -3.850615e-01 1 1  ON 21
 eO_2                 2.874541e-02 1 1  ON 22
 eO_3                 3.441144e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509952e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260676e-01 1 1  ON 29
eH1_0                -2.929919e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404862e-01 1 1  ON 32
eH1_3                -8.512714e-02 1 1  ON 33
eH1_4                -3.494126e-02 1 1  ON 34
eH1_5                 4.465095e-03 1 1  ON 35
eH1_6                 7.327495e-02 1 1  ON 36
eH1_7                 1.571889e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117579e-01 1 1  ON 39
eH2_0                -2.909215e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330058e-02 1 1  ON 43
eH2_4                -3.324830e-02 1 1  ON 44
eH2_5                 5.756730e-03 1 1  ON 45
eH2_6                 7.515050e-02 1 1  ON 46
eH2_7                 1.575634e-01 1 1  ON 47
eH2_8                 2.245677e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.22258
====================================================
  Execution time = 2.1034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339905803830
                                         uncertainty =       0.004054198569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339905803830
                                         uncertainty =       0.004054198569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412209066
  error estimate for blocks of size 2^( 2) =       0.000424555904
  error estimate for blocks of size 2^( 3) =       0.000437835965
  error estimate for blocks of size 2^( 4) =       0.000450014732
  error estimate for blocks of size 2^( 5) =       0.000460637569
  error estimate for blocks of size 2^( 6) =       0.000467733980
  error estimate for blocks of size 2^( 7) =       0.000470851666

      target function =                  N/A
              le_mean =     -16.906947619810
             les_mean =     286.184710277904
             stat err =       0.000462309487
             autocorr =       1.257854858629
              std dev =       0.582951652205
             le_variance =       0.339832628809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690694761981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906947619810       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906947620708       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906947621661       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906947621745       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906947622624       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906947622059       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906947621636       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906947621666       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 6.315455e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906947619810       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906947620035       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906947620273       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906947620294       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906947620515       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906947620372       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906947620267       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906947620277       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 1.579339e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906947619810       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906947619867       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906947619926       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906947619931       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906947619986       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906947619951       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906947619928       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906947619927       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 3.948644e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036520 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6629e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.940432e-01 1 1  ON 0
 uu_1                 1.271354e-01 1 1  ON 1
 uu_2                 2.536703e-02 1 1  ON 2
 uu_3                -3.754561e-02 1 1  ON 3
 uu_4                -8.367350e-02 1 1  ON 4
 uu_5                -1.196076e-01 1 1  ON 5
 uu_6                -1.485001e-01 1 1  ON 6
 uu_7                -1.640992e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558635e-01 1 1  ON 10
 ud_1                 1.904533e-01 1 1  ON 11
 ud_2                 7.064988e-02 1 1  ON 12
 ud_3                -3.572574e-04 1 1  ON 13
 ud_4                -5.819392e-02 1 1  ON 14
 ud_5                -1.010008e-01 1 1  ON 15
 ud_6                -1.294215e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500137e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055372e-01 1 1  ON 20
 eO_1                -3.850615e-01 1 1  ON 21
 eO_2                 2.874532e-02 1 1  ON 22
 eO_3                 3.441144e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509949e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260677e-01 1 1  ON 29
eH1_0                -2.929921e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404863e-01 1 1  ON 32
eH1_3                -8.512723e-02 1 1  ON 33
eH1_4                -3.494119e-02 1 1  ON 34
eH1_5                 4.465158e-03 1 1  ON 35
eH1_6                 7.327499e-02 1 1  ON 36
eH1_7                 1.571888e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117580e-01 1 1  ON 39
eH2_0                -2.909217e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389011e-01 1 1  ON 42
eH2_3                -8.330059e-02 1 1  ON 43
eH2_4                -3.324836e-02 1 1  ON 44
eH2_5                 5.756710e-03 1 1  ON 45
eH2_6                 7.515052e-02 1 1  ON 46
eH2_7                 1.575636e-01 1 1  ON 47
eH2_8                 2.245678e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9735
    reference variance = 0.546247
====================================================
  Execution time = 2.0161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4861e-01
  Total weights = 2.0000e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348610901914
                                         uncertainty =       0.007835022916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348610901914
                                         uncertainty =       0.007835022916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417499084
  error estimate for blocks of size 2^( 2) =       0.000429968848
  error estimate for blocks of size 2^( 3) =       0.000442261997
  error estimate for blocks of size 2^( 4) =       0.000454549804
  error estimate for blocks of size 2^( 5) =       0.000464991900
  error estimate for blocks of size 2^( 6) =       0.000475337524
  error estimate for blocks of size 2^( 7) =       0.000483849772

      target function =                  N/A
              le_mean =     -16.906286023659
             les_mean =     286.171117910384
             stat err =       0.000469682250
             autocorr =       1.265602258465
              std dev =       0.590432867426
             le_variance =       0.348610970937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348611234680
                                         uncertainty =       0.007835011834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348611234680
                                         uncertainty =       0.007835011834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417499284
  error estimate for blocks of size 2^( 2) =       0.000429969042
  error estimate for blocks of size 2^( 3) =       0.000442262190
  error estimate for blocks of size 2^( 4) =       0.000454549990
  error estimate for blocks of size 2^( 5) =       0.000464992089
  error estimate for blocks of size 2^( 6) =       0.000475337704
  error estimate for blocks of size 2^( 7) =       0.000483849951

      target function =                  N/A
              le_mean =     -16.906286023685
             les_mean =     286.171118244150
             stat err =       0.000469682434
             autocorr =       1.265602039885
              std dev =       0.590433149324
             le_variance =       0.348611303820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348611068681
                                         uncertainty =       0.007835017366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348611068681
                                         uncertainty =       0.007835017366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417499184
  error estimate for blocks of size 2^( 2) =       0.000429968945
  error estimate for blocks of size 2^( 3) =       0.000442262094
  error estimate for blocks of size 2^( 4) =       0.000454549897
  error estimate for blocks of size 2^( 5) =       0.000464991995
  error estimate for blocks of size 2^( 6) =       0.000475337615
  error estimate for blocks of size 2^( 7) =       0.000483849862

      target function =                  N/A
              le_mean =     -16.906286023672
             les_mean =     286.171118077677
             stat err =       0.000469682342
             autocorr =       1.265602148864
              std dev =       0.590433008700
             le_variance =       0.348611137763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348610922771
                                         uncertainty =       0.007835022222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348610922771
                                         uncertainty =       0.007835022222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417499097
  error estimate for blocks of size 2^( 2) =       0.000429968860
  error estimate for blocks of size 2^( 3) =       0.000442262009
  error estimate for blocks of size 2^( 4) =       0.000454549816
  error estimate for blocks of size 2^( 5) =       0.000464991912
  error estimate for blocks of size 2^( 6) =       0.000475337536
  error estimate for blocks of size 2^( 7) =       0.000483849783

      target function =                  N/A
              le_mean =     -16.906286023660
             les_mean =     286.171117931307
             stat err =       0.000469682262
             autocorr =       1.265602244762
              std dev =       0.590432885095
             le_variance =       0.348610991802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906286023659        initial
     2.4414e+02     2.4414e+03             6.3155e-07       -16.906286023685  <--
     9.7656e+02     9.7656e+03             1.5793e-07       -16.906286023672
     3.9062e+03     3.9062e+04             3.9486e-08       -16.906286023660

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9783e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.940436e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536692e-02 1 1  ON 2
 uu_3                -3.754533e-02 1 1  ON 3
 uu_4                -8.367380e-02 1 1  ON 4
 uu_5                -1.196076e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292971e-01 1 1  ON 9
 ud_0                 4.558638e-01 1 1  ON 10
 ud_1                 1.904530e-01 1 1  ON 11
 ud_2                 7.065000e-02 1 1  ON 12
 ud_3                -3.571990e-04 1 1  ON 13
 ud_4                -5.819386e-02 1 1  ON 14
 ud_5                -1.010008e-01 1 1  ON 15
 ud_6                -1.294216e-01 1 1  ON 16
 ud_7                -1.475761e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055368e-01 1 1  ON 20
 eO_1                -3.850614e-01 1 1  ON 21
 eO_2                 2.874504e-02 1 1  ON 22
 eO_3                 3.441146e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.509937e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260680e-01 1 1  ON 29
eH1_0                -2.929924e-01 1 1  ON 30
eH1_1                -1.888770e-01 1 1  ON 31
eH1_2                -1.404864e-01 1 1  ON 32
eH1_3                -8.512749e-02 1 1  ON 33
eH1_4                -3.494099e-02 1 1  ON 34
eH1_5                 4.465347e-03 1 1  ON 35
eH1_6                 7.327510e-02 1 1  ON 36
eH1_7                 1.571886e-01 1 1  ON 37
eH1_8                 2.281114e-01 1 1  ON 38
eH1_9                 2.117583e-01 1 1  ON 39
eH2_0                -2.909221e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389011e-01 1 1  ON 42
eH2_3                -8.330063e-02 1 1  ON 43
eH2_4                -3.324854e-02 1 1  ON 44
eH2_5                 5.756651e-03 1 1  ON 45
eH2_6                 7.515057e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245680e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8641
    reference variance = 0.209006
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341830054701
                                         uncertainty =       0.005585405504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341830054701
                                         uncertainty =       0.005585405504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413495508
  error estimate for blocks of size 2^( 2) =       0.000426313381
  error estimate for blocks of size 2^( 3) =       0.000438630260
  error estimate for blocks of size 2^( 4) =       0.000451029170
  error estimate for blocks of size 2^( 5) =       0.000459629024
  error estimate for blocks of size 2^( 6) =       0.000467068353
  error estimate for blocks of size 2^( 7) =       0.000470604879

      target function =                  N/A
              le_mean =     -16.906471897219
             les_mean =     286.170748910735
             stat err =       0.000462082857
             autocorr =       1.248815041069
              std dev =       0.584770955371
             le_variance =       0.341957070245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647189722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471897219       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471910165       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906471916682       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471917195       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471921298       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906471914229       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906471913971       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906471911608       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 2.923914e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471897219       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471900464       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906471902090       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471902226       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471903273       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906471901514       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906471901436       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906471900842       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 7.337766e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471897219       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471898031       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906471898437       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471898472       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471898736       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906471898296       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906471898275       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906471898125       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 1.836201e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6212e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.940443e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536644e-02 1 1  ON 2
 uu_3                -3.754512e-02 1 1  ON 3
 uu_4                -8.367395e-02 1 1  ON 4
 uu_5                -1.196079e-01 1 1  ON 5
 uu_6                -1.484999e-01 1 1  ON 6
 uu_7                -1.640987e-01 1 1  ON 7
 uu_8                -1.561818e-01 1 1  ON 8
 uu_9                -1.292973e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904535e-01 1 1  ON 11
 ud_2                 7.065019e-02 1 1  ON 12
 ud_3                -3.570743e-04 1 1  ON 13
 ud_4                -5.819339e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294221e-01 1 1  ON 16
 ud_7                -1.475761e-01 1 1  ON 17
 ud_8                -1.500142e-01 1 1  ON 18
 ud_9                -1.420275e-01 1 1  ON 19
 eO_0                -7.055364e-01 1 1  ON 20
 eO_1                -3.850619e-01 1 1  ON 21
 eO_2                 2.874553e-02 1 1  ON 22
 eO_3                 3.441149e-01 1 1  ON 23
 eO_4                 5.686545e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.509956e-02 1 1  ON 27
 eO_8                -3.291278e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929928e-01 1 1  ON 30
eH1_1                -1.888775e-01 1 1  ON 31
eH1_2                -1.404860e-01 1 1  ON 32
eH1_3                -8.512756e-02 1 1  ON 33
eH1_4                -3.494115e-02 1 1  ON 34
eH1_5                 4.465006e-03 1 1  ON 35
eH1_6                 7.327516e-02 1 1  ON 36
eH1_7                 1.571887e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117587e-01 1 1  ON 39
eH2_0                -2.909224e-01 1 1  ON 40
eH2_1                -1.871873e-01 1 1  ON 41
eH2_2                -1.389009e-01 1 1  ON 42
eH2_3                -8.330081e-02 1 1  ON 43
eH2_4                -3.324851e-02 1 1  ON 44
eH2_5                 5.756791e-03 1 1  ON 45
eH2_6                 7.515060e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245677e-01 1 1  ON 48
eH2_9                 2.366634e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9729
    reference variance = 0.284194
====================================================
  Execution time = 2.0210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5279e-01
  Total weights = 2.0000e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352691042166
                                         uncertainty =       0.016867194909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352691042166
                                         uncertainty =       0.016867194909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419991088
  error estimate for blocks of size 2^( 2) =       0.000431883968
  error estimate for blocks of size 2^( 3) =       0.000445118088
  error estimate for blocks of size 2^( 4) =       0.000456036907
  error estimate for blocks of size 2^( 5) =       0.000465927098
  error estimate for blocks of size 2^( 6) =       0.000474018819
  error estimate for blocks of size 2^( 7) =       0.000478776766

      target function =                  N/A
              le_mean =     -16.906045304581
             les_mean =     286.167152691900
             stat err =       0.000468689898
             autocorr =       1.245348882441
              std dev =       0.593957092510
             le_variance =       0.352785027743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352692451221
                                         uncertainty =       0.016867262877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352692451221
                                         uncertainty =       0.016867262877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419991926
  error estimate for blocks of size 2^( 2) =       0.000431884772
  error estimate for blocks of size 2^( 3) =       0.000445118881
  error estimate for blocks of size 2^( 4) =       0.000456037661
  error estimate for blocks of size 2^( 5) =       0.000465927810
  error estimate for blocks of size 2^( 6) =       0.000474019572
  error estimate for blocks of size 2^( 7) =       0.000478777391

      target function =                  N/A
              le_mean =     -16.906045287397
             les_mean =     286.167153519160
             stat err =       0.000468690608
             autocorr =       1.245347689316
              std dev =       0.593958278015
             le_variance =       0.352786436023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352691750129
                                         uncertainty =       0.016867228900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352691750129
                                         uncertainty =       0.016867228900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419991509
  error estimate for blocks of size 2^( 2) =       0.000431884372
  error estimate for blocks of size 2^( 3) =       0.000445118487
  error estimate for blocks of size 2^( 4) =       0.000456037286
  error estimate for blocks of size 2^( 5) =       0.000465927456
  error estimate for blocks of size 2^( 6) =       0.000474019197
  error estimate for blocks of size 2^( 7) =       0.000478777080

      target function =                  N/A
              le_mean =     -16.906045295884
             les_mean =     286.167153105393
             stat err =       0.000468690255
             autocorr =       1.245348283086
              std dev =       0.593957688153
             le_variance =       0.352785735316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352691130758
                                         uncertainty =       0.016867199158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352691130758
                                         uncertainty =       0.016867199158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419991141
  error estimate for blocks of size 2^( 2) =       0.000431884019
  error estimate for blocks of size 2^( 3) =       0.000445118138
  error estimate for blocks of size 2^( 4) =       0.000456036954
  error estimate for blocks of size 2^( 5) =       0.000465927143
  error estimate for blocks of size 2^( 6) =       0.000474018866
  error estimate for blocks of size 2^( 7) =       0.000478776806

      target function =                  N/A
              le_mean =     -16.906045303489
             les_mean =     286.167152743523
             stat err =       0.000468689942
             autocorr =       1.245348807440
              std dev =       0.593957167047
             le_variance =       0.352785116287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906045304581        initial  <--
     6.1035e+01     6.1035e+02             2.9239e-06       -16.906045287397
     2.4414e+02     2.4414e+03             7.3378e-07       -16.906045295884
     9.7656e+02     9.7656e+03             1.8362e-07       -16.906045303489

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7653
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.940436e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536692e-02 1 1  ON 2
 uu_3                -3.754533e-02 1 1  ON 3
 uu_4                -8.367380e-02 1 1  ON 4
 uu_5                -1.196076e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292971e-01 1 1  ON 9
 ud_0                 4.558638e-01 1 1  ON 10
 ud_1                 1.904530e-01 1 1  ON 11
 ud_2                 7.065000e-02 1 1  ON 12
 ud_3                -3.571990e-04 1 1  ON 13
 ud_4                -5.819386e-02 1 1  ON 14
 ud_5                -1.010008e-01 1 1  ON 15
 ud_6                -1.294216e-01 1 1  ON 16
 ud_7                -1.475761e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055368e-01 1 1  ON 20
 eO_1                -3.850614e-01 1 1  ON 21
 eO_2                 2.874504e-02 1 1  ON 22
 eO_3                 3.441146e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.509937e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260680e-01 1 1  ON 29
eH1_0                -2.929924e-01 1 1  ON 30
eH1_1                -1.888770e-01 1 1  ON 31
eH1_2                -1.404864e-01 1 1  ON 32
eH1_3                -8.512749e-02 1 1  ON 33
eH1_4                -3.494099e-02 1 1  ON 34
eH1_5                 4.465347e-03 1 1  ON 35
eH1_6                 7.327510e-02 1 1  ON 36
eH1_7                 1.571886e-01 1 1  ON 37
eH1_8                 2.281114e-01 1 1  ON 38
eH1_9                 2.117583e-01 1 1  ON 39
eH2_0                -2.909221e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389011e-01 1 1  ON 42
eH2_3                -8.330063e-02 1 1  ON 43
eH2_4                -3.324854e-02 1 1  ON 44
eH2_5                 5.756651e-03 1 1  ON 45
eH2_6                 7.515057e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245680e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8364
    reference variance = 0.359871
====================================================
  Execution time = 2.2585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338321456302
                                         uncertainty =       0.004139012856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338321456302
                                         uncertainty =       0.004139012856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411274600
  error estimate for blocks of size 2^( 2) =       0.000424179467
  error estimate for blocks of size 2^( 3) =       0.000437579189
  error estimate for blocks of size 2^( 4) =       0.000450402690
  error estimate for blocks of size 2^( 5) =       0.000462864823
  error estimate for blocks of size 2^( 6) =       0.000472060059
  error estimate for blocks of size 2^( 7) =       0.000479893875

      target function =                  N/A
              le_mean =     -16.905864661634
             les_mean =     286.146553382155
             stat err =       0.000466305362
             autocorr =       1.285514679816
              std dev =       0.581630117715
             le_variance =       0.338293593833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586466163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864661634       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864661247       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864661143       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864661926       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864662389       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864662080       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864661882       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.437723e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864661634       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864661537       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864661511       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864661706       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864661822       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864661747       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864661696       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 8.596785e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864661634       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905864661609       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905864661603       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905864661645       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905864661678       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905864661666       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905864661650       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.149351e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8100e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.940436e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536688e-02 1 1  ON 2
 uu_3                -3.754534e-02 1 1  ON 3
 uu_4                -8.367384e-02 1 1  ON 4
 uu_5                -1.196076e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292971e-01 1 1  ON 9
 ud_0                 4.558638e-01 1 1  ON 10
 ud_1                 1.904530e-01 1 1  ON 11
 ud_2                 7.064999e-02 1 1  ON 12
 ud_3                -3.572240e-04 1 1  ON 13
 ud_4                -5.819389e-02 1 1  ON 14
 ud_5                -1.010008e-01 1 1  ON 15
 ud_6                -1.294217e-01 1 1  ON 16
 ud_7                -1.475761e-01 1 1  ON 17
 ud_8                -1.500138e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055367e-01 1 1  ON 20
 eO_1                -3.850614e-01 1 1  ON 21
 eO_2                 2.874509e-02 1 1  ON 22
 eO_3                 3.441146e-01 1 1  ON 23
 eO_4                 5.686541e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.509938e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260681e-01 1 1  ON 29
eH1_0                -2.929924e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404864e-01 1 1  ON 32
eH1_3                -8.512750e-02 1 1  ON 33
eH1_4                -3.494099e-02 1 1  ON 34
eH1_5                 4.465329e-03 1 1  ON 35
eH1_6                 7.327509e-02 1 1  ON 36
eH1_7                 1.571886e-01 1 1  ON 37
eH1_8                 2.281114e-01 1 1  ON 38
eH1_9                 2.117583e-01 1 1  ON 39
eH2_0                -2.909222e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389011e-01 1 1  ON 42
eH2_3                -8.330065e-02 1 1  ON 43
eH2_4                -3.324853e-02 1 1  ON 44
eH2_5                 5.756663e-03 1 1  ON 45
eH2_6                 7.515061e-02 1 1  ON 46
eH2_7                 1.575640e-01 1 1  ON 47
eH2_8                 2.245680e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8926
    reference variance = 0.248325
====================================================
  Execution time = 1.9954e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.0000e+06
  Execution time = 1.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280564962
                                         uncertainty =       0.009401714954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280564962
                                         uncertainty =       0.009401714954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414912120
  error estimate for blocks of size 2^( 2) =       0.000427686579
  error estimate for blocks of size 2^( 3) =       0.000440533643
  error estimate for blocks of size 2^( 4) =       0.000452831067
  error estimate for blocks of size 2^( 5) =       0.000463275304
  error estimate for blocks of size 2^( 6) =       0.000470708148
  error estimate for blocks of size 2^( 7) =       0.000473351954

      target function =                  N/A
              le_mean =     -16.906460333586
             les_mean =     286.172704974081
             stat err =       0.000465041618
             autocorr =       1.256236477105
              std dev =       0.586774347703
             le_variance =       0.344304135122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280738217
                                         uncertainty =       0.009401715012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280738217
                                         uncertainty =       0.009401715012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414912225
  error estimate for blocks of size 2^( 2) =       0.000427686681
  error estimate for blocks of size 2^( 3) =       0.000440533740
  error estimate for blocks of size 2^( 4) =       0.000452831161
  error estimate for blocks of size 2^( 5) =       0.000463275396
  error estimate for blocks of size 2^( 6) =       0.000470708238
  error estimate for blocks of size 2^( 7) =       0.000473352045

      target function =                  N/A
              le_mean =     -16.906460334208
             les_mean =     286.172705168326
             stat err =       0.000465041710
             autocorr =       1.256236338818
              std dev =       0.586774495283
             le_variance =       0.344304308314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280651630
                                         uncertainty =       0.009401714983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280651630
                                         uncertainty =       0.009401714983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414912172
  error estimate for blocks of size 2^( 2) =       0.000427686630
  error estimate for blocks of size 2^( 3) =       0.000440533691
  error estimate for blocks of size 2^( 4) =       0.000452831114
  error estimate for blocks of size 2^( 5) =       0.000463275350
  error estimate for blocks of size 2^( 6) =       0.000470708193
  error estimate for blocks of size 2^( 7) =       0.000473351999

      target function =                  N/A
              le_mean =     -16.906460333897
             les_mean =     286.172705071249
             stat err =       0.000465041664
             autocorr =       1.256236407928
              std dev =       0.586774421528
             le_variance =       0.344304221759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280575796
                                         uncertainty =       0.009401714958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344280575796
                                         uncertainty =       0.009401714958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414912127
  error estimate for blocks of size 2^( 2) =       0.000427686586
  error estimate for blocks of size 2^( 3) =       0.000440533649
  error estimate for blocks of size 2^( 4) =       0.000452831073
  error estimate for blocks of size 2^( 5) =       0.000463275310
  error estimate for blocks of size 2^( 6) =       0.000470708154
  error estimate for blocks of size 2^( 7) =       0.000473351959

      target function =                  N/A
              le_mean =     -16.906460333625
             les_mean =     286.172704986228
             stat err =       0.000465041624
             autocorr =       1.256236468465
              std dev =       0.586774356932
             le_variance =       0.344304145953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906460333586        initial
     6.1035e+02     6.1035e+03             3.4377e-07       -16.906460334208  <--
     2.4414e+03     2.4414e+04             8.5968e-08       -16.906460333897
     9.7656e+03     9.7656e+04             2.1494e-08       -16.906460333625

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9499e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.940437e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536674e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367397e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292971e-01 1 1  ON 9
 ud_0                 4.558639e-01 1 1  ON 10
 ud_1                 1.904531e-01 1 1  ON 11
 ud_2                 7.064997e-02 1 1  ON 12
 ud_3                -3.572992e-04 1 1  ON 13
 ud_4                -5.819397e-02 1 1  ON 14
 ud_5                -1.010007e-01 1 1  ON 15
 ud_6                -1.294220e-01 1 1  ON 16
 ud_7                -1.475761e-01 1 1  ON 17
 ud_8                -1.500136e-01 1 1  ON 18
 ud_9                -1.420268e-01 1 1  ON 19
 eO_0                -7.055367e-01 1 1  ON 20
 eO_1                -3.850616e-01 1 1  ON 21
 eO_2                 2.874521e-02 1 1  ON 22
 eO_3                 3.441146e-01 1 1  ON 23
 eO_4                 5.686542e-01 1 1  ON 24
 eO_5                 5.258463e-01 1 1  ON 25
 eO_6                 2.820706e-01 1 1  ON 26
 eO_7                -6.509939e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260681e-01 1 1  ON 29
eH1_0                -2.929925e-01 1 1  ON 30
eH1_1                -1.888771e-01 1 1  ON 31
eH1_2                -1.404865e-01 1 1  ON 32
eH1_3                -8.512755e-02 1 1  ON 33
eH1_4                -3.494101e-02 1 1  ON 34
eH1_5                 4.465274e-03 1 1  ON 35
eH1_6                 7.327508e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281115e-01 1 1  ON 38
eH1_9                 2.117585e-01 1 1  ON 39
eH2_0                -2.909224e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389011e-01 1 1  ON 42
eH2_3                -8.330072e-02 1 1  ON 43
eH2_4                -3.324851e-02 1 1  ON 44
eH2_5                 5.756701e-03 1 1  ON 45
eH2_6                 7.515071e-02 1 1  ON 46
eH2_7                 1.575640e-01 1 1  ON 47
eH2_8                 2.245680e-01 1 1  ON 48
eH2_9                 2.366633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.198961
====================================================
  Execution time = 2.0923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5221e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351806505315
                                         uncertainty =       0.010323344425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351806505315
                                         uncertainty =       0.010323344425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419648272
  error estimate for blocks of size 2^( 2) =       0.000432553098
  error estimate for blocks of size 2^( 3) =       0.000446057790
  error estimate for blocks of size 2^( 4) =       0.000457603255
  error estimate for blocks of size 2^( 5) =       0.000469424843
  error estimate for blocks of size 2^( 6) =       0.000477725436
  error estimate for blocks of size 2^( 7) =       0.000482441346

      target function =                  N/A
              le_mean =     -16.906480087284
             les_mean =     286.181278110735
             stat err =       0.000471798720
             autocorr =       1.263987086767
              std dev =       0.593472278285
             le_variance =       0.352209345093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648008728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480087284       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906480089971       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906480090962       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906480090250       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480091123       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480091900       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906480092768       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.448895e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480087284       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906480087957       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906480088204       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906480088026       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480088243       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480088437       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906480088655       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.623195e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480087284       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906480087453       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906480087514       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906480087471       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480087524       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480087572       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906480087628       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.058583e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6521e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.940438e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536661e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367411e-02 1 1  ON 4
 uu_5                -1.196080e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561812e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558640e-01 1 1  ON 10
 ud_1                 1.904530e-01 1 1  ON 11
 ud_2                 7.064978e-02 1 1  ON 12
 ud_3                -3.574342e-04 1 1  ON 13
 ud_4                -5.819409e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294221e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500132e-01 1 1  ON 18
 ud_9                -1.420265e-01 1 1  ON 19
 eO_0                -7.055365e-01 1 1  ON 20
 eO_1                -3.850619e-01 1 1  ON 21
 eO_2                 2.874528e-02 1 1  ON 22
 eO_3                 3.441145e-01 1 1  ON 23
 eO_4                 5.686544e-01 1 1  ON 24
 eO_5                 5.258463e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509932e-02 1 1  ON 27
 eO_8                -3.291272e-01 1 1  ON 28
 eO_9                -2.260683e-01 1 1  ON 29
eH1_0                -2.929926e-01 1 1  ON 30
eH1_1                -1.888772e-01 1 1  ON 31
eH1_2                -1.404868e-01 1 1  ON 32
eH1_3                -8.512735e-02 1 1  ON 33
eH1_4                -3.494115e-02 1 1  ON 34
eH1_5                 4.465307e-03 1 1  ON 35
eH1_6                 7.327515e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281115e-01 1 1  ON 38
eH1_9                 2.117586e-01 1 1  ON 39
eH2_0                -2.909225e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389010e-01 1 1  ON 42
eH2_3                -8.330095e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756656e-03 1 1  ON 45
eH2_6                 7.515063e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245680e-01 1 1  ON 48
eH2_9                 2.366635e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.302502
====================================================
  Execution time = 2.0246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3852e-01
  Total weights = 2.0000e+06
  Execution time = 2.1687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541083109
                                         uncertainty =       0.003089054121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541083109
                                         uncertainty =       0.003089054121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411411741
  error estimate for blocks of size 2^( 2) =       0.000424288146
  error estimate for blocks of size 2^( 3) =       0.000437651262
  error estimate for blocks of size 2^( 4) =       0.000449723268
  error estimate for blocks of size 2^( 5) =       0.000460077430
  error estimate for blocks of size 2^( 6) =       0.000469635327
  error estimate for blocks of size 2^( 7) =       0.000474537741

      target function =                  N/A
              le_mean =     -16.906116641718
             les_mean =     286.155298974778
             stat err =       0.000463493441
             autocorr =       1.269210989691
              std dev =       0.581824063321
             le_variance =       0.338519240660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541986739
                                         uncertainty =       0.003089062092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541986739
                                         uncertainty =       0.003089062092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411412289
  error estimate for blocks of size 2^( 2) =       0.000424288672
  error estimate for blocks of size 2^( 3) =       0.000437651771
  error estimate for blocks of size 2^( 4) =       0.000449723752
  error estimate for blocks of size 2^( 5) =       0.000460077903
  error estimate for blocks of size 2^( 6) =       0.000469635771
  error estimate for blocks of size 2^( 7) =       0.000474538208

      target function =                  N/A
              le_mean =     -16.906116646308
             les_mean =     286.155300032920
             stat err =       0.000463493909
             autocorr =       1.269210162482
              std dev =       0.581824839290
             le_variance =       0.338520143615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541535819
                                         uncertainty =       0.003089058118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541535819
                                         uncertainty =       0.003089058118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411412016
  error estimate for blocks of size 2^( 2) =       0.000424288409
  error estimate for blocks of size 2^( 3) =       0.000437651517
  error estimate for blocks of size 2^( 4) =       0.000449723511
  error estimate for blocks of size 2^( 5) =       0.000460077667
  error estimate for blocks of size 2^( 6) =       0.000469635549
  error estimate for blocks of size 2^( 7) =       0.000474537975

      target function =                  N/A
              le_mean =     -16.906116644017
             les_mean =     286.155299504882
             stat err =       0.000463493675
             autocorr =       1.269210575256
              std dev =       0.581824452075
             le_variance =       0.338519693032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541139724
                                         uncertainty =       0.003089054621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338541139724
                                         uncertainty =       0.003089054621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411411775
  error estimate for blocks of size 2^( 2) =       0.000424288179
  error estimate for blocks of size 2^( 3) =       0.000437651294
  error estimate for blocks of size 2^( 4) =       0.000449723298
  error estimate for blocks of size 2^( 5) =       0.000460077460
  error estimate for blocks of size 2^( 6) =       0.000469635355
  error estimate for blocks of size 2^( 7) =       0.000474537770

      target function =                  N/A
              le_mean =     -16.906116642005
             les_mean =     286.155299041066
             stat err =       0.000463493471
             autocorr =       1.269210937862
              std dev =       0.581824111938
             le_variance =       0.338519297233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906116641718        initial
     1.5259e+02     1.5259e+03             1.4489e-06       -16.906116646308  <--
     6.1035e+02     6.1035e+03             3.6232e-07       -16.906116644017
     2.4414e+03     2.4414e+04             9.0586e-08       -16.906116642005

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 3.1325e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578389e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465406e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.310592
====================================================
  Execution time = 2.0797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3502e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335078317307
                                         uncertainty =       0.003298171058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335078317307
                                         uncertainty =       0.003298171058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409281080
  error estimate for blocks of size 2^( 2) =       0.000422283836
  error estimate for blocks of size 2^( 3) =       0.000435868704
  error estimate for blocks of size 2^( 4) =       0.000447914830
  error estimate for blocks of size 2^( 5) =       0.000457764808
  error estimate for blocks of size 2^( 6) =       0.000463802402
  error estimate for blocks of size 2^( 7) =       0.000468465723

      target function =                  N/A
              le_mean =     -16.907118361441
             les_mean =     286.185673125410
             stat err =       0.000459486941
             autocorr =       1.260384365212
              std dev =       0.578810854371
             le_variance =       0.335022005138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690711836144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907118361441       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907118382352       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907118395890       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907118405463       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907118414021       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907118408636       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907118408029       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907118408828       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.428007e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907118361441       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907118366676       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907118370083       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907118372495       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907118374669       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907118373332       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907118373160       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907118373362       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.365219e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907118361441       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907118362750       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907118363604       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907118364208       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907118364753       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907118364419       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907118364377       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907118364426       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.418236e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6466e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.940449e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536632e-02 1 1  ON 2
 uu_3                -3.754489e-02 1 1  ON 3
 uu_4                -8.367482e-02 1 1  ON 4
 uu_5                -1.196087e-01 1 1  ON 5
 uu_6                -1.485010e-01 1 1  ON 6
 uu_7                -1.640991e-01 1 1  ON 7
 uu_8                -1.561812e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558648e-01 1 1  ON 10
 ud_1                 1.904527e-01 1 1  ON 11
 ud_2                 7.064974e-02 1 1  ON 12
 ud_3                -3.577712e-04 1 1  ON 13
 ud_4                -5.819449e-02 1 1  ON 14
 ud_5                -1.009998e-01 1 1  ON 15
 ud_6                -1.294232e-01 1 1  ON 16
 ud_7                -1.475768e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420257e-01 1 1  ON 19
 eO_0                -7.055345e-01 1 1  ON 20
 eO_1                -3.850634e-01 1 1  ON 21
 eO_2                 2.874593e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686557e-01 1 1  ON 24
 eO_5                 5.258466e-01 1 1  ON 25
 eO_6                 2.820697e-01 1 1  ON 26
 eO_7                -6.509938e-02 1 1  ON 27
 eO_8                -3.291274e-01 1 1  ON 28
 eO_9                -2.260693e-01 1 1  ON 29
eH1_0                -2.929931e-01 1 1  ON 30
eH1_1                -1.888779e-01 1 1  ON 31
eH1_2                -1.404879e-01 1 1  ON 32
eH1_3                -8.512629e-02 1 1  ON 33
eH1_4                -3.494187e-02 1 1  ON 34
eH1_5                 4.466088e-03 1 1  ON 35
eH1_6                 7.327555e-02 1 1  ON 36
eH1_7                 1.571882e-01 1 1  ON 37
eH1_8                 2.281114e-01 1 1  ON 38
eH1_9                 2.117594e-01 1 1  ON 39
eH2_0                -2.909234e-01 1 1  ON 40
eH2_1                -1.871876e-01 1 1  ON 41
eH2_2                -1.388999e-01 1 1  ON 42
eH2_3                -8.330170e-02 1 1  ON 43
eH2_4                -3.324820e-02 1 1  ON 44
eH2_5                 5.756058e-03 1 1  ON 45
eH2_6                 7.514997e-02 1 1  ON 46
eH2_7                 1.575636e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366643e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9675
    reference variance = 1.04138
====================================================
  Execution time = 2.0161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3435e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334290968630
                                         uncertainty =       0.003773488047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334290968630
                                         uncertainty =       0.003773488047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408867733
  error estimate for blocks of size 2^( 2) =       0.000421454787
  error estimate for blocks of size 2^( 3) =       0.000435143374
  error estimate for blocks of size 2^( 4) =       0.000447515693
  error estimate for blocks of size 2^( 5) =       0.000458358736
  error estimate for blocks of size 2^( 6) =       0.000466453824
  error estimate for blocks of size 2^( 7) =       0.000471809939

      target function =                  N/A
              le_mean =     -16.905854480346
             les_mean =     286.142261190057
             stat err =       0.000461034548
             autocorr =       1.271455792626
              std dev =       0.578226293584
             le_variance =       0.334345646592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291752248
                                         uncertainty =       0.003773441398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291752248
                                         uncertainty =       0.003773441398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408868215
  error estimate for blocks of size 2^( 2) =       0.000421455246
  error estimate for blocks of size 2^( 3) =       0.000435143859
  error estimate for blocks of size 2^( 4) =       0.000447516124
  error estimate for blocks of size 2^( 5) =       0.000458359189
  error estimate for blocks of size 2^( 6) =       0.000466454374
  error estimate for blocks of size 2^( 7) =       0.000471810273

      target function =                  N/A
              le_mean =     -16.905854466766
             les_mean =     286.142261518236
             stat err =       0.000461034990
             autocorr =       1.271455236205
              std dev =       0.578226974404
             le_variance =       0.334346433928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291367624
                                         uncertainty =       0.003773464548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291367624
                                         uncertainty =       0.003773464548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408867978
  error estimate for blocks of size 2^( 2) =       0.000421455021
  error estimate for blocks of size 2^( 3) =       0.000435143621
  error estimate for blocks of size 2^( 4) =       0.000447515913
  error estimate for blocks of size 2^( 5) =       0.000458358967
  error estimate for blocks of size 2^( 6) =       0.000466454103
  error estimate for blocks of size 2^( 7) =       0.000471810110

      target function =                  N/A
              le_mean =     -16.905854473417
             les_mean =     286.142261356658
             stat err =       0.000461034773
             autocorr =       1.271455509762
              std dev =       0.578226640222
             le_variance =       0.334346047462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291018714
                                         uncertainty =       0.003773485104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291018714
                                         uncertainty =       0.003773485104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408867764
  error estimate for blocks of size 2^( 2) =       0.000421454817
  error estimate for blocks of size 2^( 3) =       0.000435143405
  error estimate for blocks of size 2^( 4) =       0.000447515721
  error estimate for blocks of size 2^( 5) =       0.000458358765
  error estimate for blocks of size 2^( 6) =       0.000466453859
  error estimate for blocks of size 2^( 7) =       0.000471809961

      target function =                  N/A
              le_mean =     -16.905854479473
             les_mean =     286.142261210872
             stat err =       0.000461034576
             autocorr =       1.271455757132
              std dev =       0.578226337096
             le_variance =       0.334345696911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905854480346        initial  <--
     3.8147e+01     3.8147e+02             5.4280e-06       -16.905854466766
     1.5259e+02     1.5259e+03             1.3652e-06       -16.905854473417
     6.1035e+02     6.1035e+03             3.4182e-07       -16.905854479473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7269
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578389e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465406e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.296924
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331474236696
                                         uncertainty =       0.002488466844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331474236696
                                         uncertainty =       0.002488466844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407109245
  error estimate for blocks of size 2^( 2) =       0.000419544857
  error estimate for blocks of size 2^( 3) =       0.000432906235
  error estimate for blocks of size 2^( 4) =       0.000445793895
  error estimate for blocks of size 2^( 5) =       0.000457379736
  error estimate for blocks of size 2^( 6) =       0.000465518520
  error estimate for blocks of size 2^( 7) =       0.000467061450

      target function =                  N/A
              le_mean =     -16.906590369071
             les_mean =     286.164273617129
             stat err =       0.000458938400
             autocorr =       1.270828262823
              std dev =       0.575739416140
             le_variance =       0.331475875297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659036907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906590369071       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906590370005       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906590372375       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906590372845       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906590373168       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590372894       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590373254       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.112584e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906590369071       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906590369305       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906590369898       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906590370015       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906590370096       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590370028       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590370118       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.278766e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906590369071       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906590369130       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906590369278       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906590369307       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906590369329       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590369310       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590369328       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.197303e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6166e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536621e-02 1 1  ON 2
 uu_3                -3.754538e-02 1 1  ON 3
 uu_4                -8.367452e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904527e-01 1 1  ON 11
 ud_2                 7.064925e-02 1 1  ON 12
 ud_3                -3.578015e-04 1 1  ON 13
 ud_4                -5.819444e-02 1 1  ON 14
 ud_5                -1.010005e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874548e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820701e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404876e-01 1 1  ON 32
eH1_3                -8.512679e-02 1 1  ON 33
eH1_4                -3.494156e-02 1 1  ON 34
eH1_5                 4.465376e-03 1 1  ON 35
eH1_6                 7.327528e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281117e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330171e-02 1 1  ON 43
eH2_4                -3.324846e-02 1 1  ON 44
eH2_5                 5.756602e-03 1 1  ON 45
eH2_6                 7.515037e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.227265
====================================================
  Execution time = 2.0148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4012e-01
  Total weights = 2.0000e+06
  Execution time = 1.8896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198565950
                                         uncertainty =       0.004194621478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198565950
                                         uncertainty =       0.004194621478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384264
  error estimate for blocks of size 2^( 2) =       0.000425111525
  error estimate for blocks of size 2^( 3) =       0.000437806004
  error estimate for blocks of size 2^( 4) =       0.000450728166
  error estimate for blocks of size 2^( 5) =       0.000461185776
  error estimate for blocks of size 2^( 6) =       0.000468660497
  error estimate for blocks of size 2^( 7) =       0.000475689040

      target function =                  N/A
              le_mean =     -16.906198766266
             les_mean =     286.159678115999
             stat err =       0.000464065870
             autocorr =       1.266353890607
              std dev =       0.583199418365
             le_variance =       0.340121561581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198339507
                                         uncertainty =       0.004194617549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198339507
                                         uncertainty =       0.004194617549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384126
  error estimate for blocks of size 2^( 2) =       0.000425111395
  error estimate for blocks of size 2^( 3) =       0.000437805882
  error estimate for blocks of size 2^( 4) =       0.000450728055
  error estimate for blocks of size 2^( 5) =       0.000461185665
  error estimate for blocks of size 2^( 6) =       0.000468660378
  error estimate for blocks of size 2^( 7) =       0.000475688919

      target function =                  N/A
              le_mean =     -16.906198764918
             les_mean =     286.159677844044
             stat err =       0.000464065754
             autocorr =       1.266354102681
              std dev =       0.583199224269
             le_variance =       0.340121335187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198452708
                                         uncertainty =       0.004194619512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198452708
                                         uncertainty =       0.004194619512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384195
  error estimate for blocks of size 2^( 2) =       0.000425111460
  error estimate for blocks of size 2^( 3) =       0.000437805943
  error estimate for blocks of size 2^( 4) =       0.000450728110
  error estimate for blocks of size 2^( 5) =       0.000461185720
  error estimate for blocks of size 2^( 6) =       0.000468660437
  error estimate for blocks of size 2^( 7) =       0.000475688980

      target function =                  N/A
              le_mean =     -16.906198765591
             les_mean =     286.159677979980
             stat err =       0.000464065812
             autocorr =       1.266353996673
              std dev =       0.583199321299
             le_variance =       0.340121448363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198551794
                                         uncertainty =       0.004194621232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340198551794
                                         uncertainty =       0.004194621232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384255
  error estimate for blocks of size 2^( 2) =       0.000425111517
  error estimate for blocks of size 2^( 3) =       0.000437805996
  error estimate for blocks of size 2^( 4) =       0.000450728159
  error estimate for blocks of size 2^( 5) =       0.000461185769
  error estimate for blocks of size 2^( 6) =       0.000468660489
  error estimate for blocks of size 2^( 7) =       0.000475689033

      target function =                  N/A
              le_mean =     -16.906198766181
             les_mean =     286.159678098994
             stat err =       0.000464065862
             autocorr =       1.266353903875
              std dev =       0.583199406231
             le_variance =       0.340121547428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906198766266        initial  <--
     3.8147e+02     3.8147e+03             5.1126e-07       -16.906198764918
     1.5259e+03     1.5259e+04             1.2788e-07       -16.906198765591
     6.1035e+03     6.1035e+04             3.1973e-08       -16.906198766181

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7544
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578389e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465406e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.96
    reference variance = 0.477879
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5410e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354116736942
                                         uncertainty =       0.017164920866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354116736942
                                         uncertainty =       0.017164920866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420775235
  error estimate for blocks of size 2^( 2) =       0.000433323227
  error estimate for blocks of size 2^( 3) =       0.000446071518
  error estimate for blocks of size 2^( 4) =       0.000457212301
  error estimate for blocks of size 2^( 5) =       0.000465998724
  error estimate for blocks of size 2^( 6) =       0.000474903532
  error estimate for blocks of size 2^( 7) =       0.000482913846

      target function =                  N/A
              le_mean =     -16.905797319422
             les_mean =     286.160086424540
             stat err =       0.000470257101
             autocorr =       1.249022845348
              std dev =       0.595066043578
             le_variance =       0.354103596220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579731942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905797319422       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905797319424       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797319445       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797319356       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905797319324       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797319275       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797319324       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.612671e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905797319422       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905797319422       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797319428       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797319405       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905797319398       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797319388       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797319401       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.403277e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905797319422       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905797319422       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797319423       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797319444       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905797319401       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797319458       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797319418       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.508261e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6304e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578380e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874550e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512677e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465400e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756519e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9583
    reference variance = 0.523742
====================================================
  Execution time = 2.0160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4155e-01
  Total weights = 2.0000e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580385472
                                         uncertainty =       0.004466177898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580385472
                                         uncertainty =       0.004466177898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413251695
  error estimate for blocks of size 2^( 2) =       0.000425597134
  error estimate for blocks of size 2^( 3) =       0.000438101403
  error estimate for blocks of size 2^( 4) =       0.000449971787
  error estimate for blocks of size 2^( 5) =       0.000459696479
  error estimate for blocks of size 2^( 6) =       0.000468580222
  error estimate for blocks of size 2^( 7) =       0.000471636583

      target function =                  N/A
              le_mean =     -16.905877265411
             les_mean =     286.150239868829
             stat err =       0.000462471267
             autocorr =       1.252391827884
              std dev =       0.584426151435
             le_variance =       0.341553926481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580378733
                                         uncertainty =       0.004466178352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580378733
                                         uncertainty =       0.004466178352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413251691
  error estimate for blocks of size 2^( 2) =       0.000425597129
  error estimate for blocks of size 2^( 3) =       0.000438101399
  error estimate for blocks of size 2^( 4) =       0.000449971782
  error estimate for blocks of size 2^( 5) =       0.000459696474
  error estimate for blocks of size 2^( 6) =       0.000468580221
  error estimate for blocks of size 2^( 7) =       0.000471636582

      target function =                  N/A
              le_mean =     -16.905877265015
             les_mean =     286.150239848726
             stat err =       0.000462471265
             autocorr =       1.252391838233
              std dev =       0.584426145681
             le_variance =       0.341553919756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580382102
                                         uncertainty =       0.004466178125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580382102
                                         uncertainty =       0.004466178125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413251693
  error estimate for blocks of size 2^( 2) =       0.000425597132
  error estimate for blocks of size 2^( 3) =       0.000438101401
  error estimate for blocks of size 2^( 4) =       0.000449971784
  error estimate for blocks of size 2^( 5) =       0.000459696476
  error estimate for blocks of size 2^( 6) =       0.000468580221
  error estimate for blocks of size 2^( 7) =       0.000471636582

      target function =                  N/A
              le_mean =     -16.905877265213
             les_mean =     286.150239858776
             stat err =       0.000462471266
             autocorr =       1.252391833066
              std dev =       0.584426148558
             le_variance =       0.341553923118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580385051
                                         uncertainty =       0.004466177926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341580385051
                                         uncertainty =       0.004466177926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413251695
  error estimate for blocks of size 2^( 2) =       0.000425597133
  error estimate for blocks of size 2^( 3) =       0.000438101403
  error estimate for blocks of size 2^( 4) =       0.000449971786
  error estimate for blocks of size 2^( 5) =       0.000459696478
  error estimate for blocks of size 2^( 6) =       0.000468580221
  error estimate for blocks of size 2^( 7) =       0.000471636583

      target function =                  N/A
              le_mean =     -16.905877265386
             les_mean =     286.150239867572
             stat err =       0.000462471267
             autocorr =       1.252391828533
              std dev =       0.584426151075
             le_variance =       0.341553926061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905877265411        initial  <--
     3.8147e+03     3.8147e+04             5.6127e-08       -16.905877265015
     1.5259e+04     1.5259e+05             1.4033e-08       -16.905877265213
     6.1035e+04     6.1035e+05             3.5083e-09       -16.905877265386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7359
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578389e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465406e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6046e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9411
    reference variance = 0.487127
====================================================
  Execution time = 2.0803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3727e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337369249870
                                         uncertainty =       0.003165063409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337369249870
                                         uncertainty =       0.003165063409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410651236
  error estimate for blocks of size 2^( 2) =       0.000422840374
  error estimate for blocks of size 2^( 3) =       0.000435376087
  error estimate for blocks of size 2^( 4) =       0.000447426524
  error estimate for blocks of size 2^( 5) =       0.000458183024
  error estimate for blocks of size 2^( 6) =       0.000465030947
  error estimate for blocks of size 2^( 7) =       0.000471197242

      target function =                  N/A
              le_mean =     -16.906413130073
             les_mean =     286.164073631742
             stat err =       0.000460459435
             autocorr =       1.257292955903
              std dev =       0.580748547726
             le_variance =       0.337268875685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641313007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413130073       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413130073       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413130077       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906413130070       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906413130091       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413130069       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413130116       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 3.699121e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413130073       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413130073       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413130074       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906413130072       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906413130131       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413129933       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413130090       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 9.247844e-10

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413130073       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413130073       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413130073       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906413129508       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906413130073       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906413131007       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413129851       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 2.311967e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6371e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578384e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465405e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8935
    reference variance = 0.222004
====================================================
  Execution time = 2.2340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3573e-01
  Total weights = 2.0000e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985866
                                         uncertainty =       0.002844728456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985866
                                         uncertainty =       0.002844728456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409716091
  error estimate for blocks of size 2^( 2) =       0.000422285577
  error estimate for blocks of size 2^( 3) =       0.000434922332
  error estimate for blocks of size 2^( 4) =       0.000446540553
  error estimate for blocks of size 2^( 5) =       0.000458322371
  error estimate for blocks of size 2^( 6) =       0.000465842786
  error estimate for blocks of size 2^( 7) =       0.000470592477

      target function =                  N/A
              le_mean =     -16.906149294395
             les_mean =     286.153618347102
             stat err =       0.000460324547
             autocorr =       1.262298968015
              std dev =       0.579426052753
             le_variance =       0.335734550609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985962
                                         uncertainty =       0.002844728453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985962
                                         uncertainty =       0.002844728453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409716091
  error estimate for blocks of size 2^( 2) =       0.000422285577
  error estimate for blocks of size 2^( 3) =       0.000434922332
  error estimate for blocks of size 2^( 4) =       0.000446540553
  error estimate for blocks of size 2^( 5) =       0.000458322371
  error estimate for blocks of size 2^( 6) =       0.000465842786
  error estimate for blocks of size 2^( 7) =       0.000470592477

      target function =                  N/A
              le_mean =     -16.906149294404
             les_mean =     286.153618347500
             stat err =       0.000460324547
             autocorr =       1.262298967937
              std dev =       0.579426052837
             le_variance =       0.335734550706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985914
                                         uncertainty =       0.002844728454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985914
                                         uncertainty =       0.002844728454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409716091
  error estimate for blocks of size 2^( 2) =       0.000422285577
  error estimate for blocks of size 2^( 3) =       0.000434922332
  error estimate for blocks of size 2^( 4) =       0.000446540553
  error estimate for blocks of size 2^( 5) =       0.000458322371
  error estimate for blocks of size 2^( 6) =       0.000465842786
  error estimate for blocks of size 2^( 7) =       0.000470592477

      target function =                  N/A
              le_mean =     -16.906149294399
             les_mean =     286.153618347301
             stat err =       0.000460324547
             autocorr =       1.262298967975
              std dev =       0.579426052795
             le_variance =       0.335734550658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985872
                                         uncertainty =       0.002844728456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335727985872
                                         uncertainty =       0.002844728456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409716091
  error estimate for blocks of size 2^( 2) =       0.000422285577
  error estimate for blocks of size 2^( 3) =       0.000434922332
  error estimate for blocks of size 2^( 4) =       0.000446540553
  error estimate for blocks of size 2^( 5) =       0.000458322371
  error estimate for blocks of size 2^( 6) =       0.000465842786
  error estimate for blocks of size 2^( 7) =       0.000470592477

      target function =                  N/A
              le_mean =     -16.906149294395
             les_mean =     286.153618347127
             stat err =       0.000460324547
             autocorr =       1.262298968010
              std dev =       0.579426052759
             le_variance =       0.335734550616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906149294395        initial
     3.8147e+04     3.8147e+05             3.6991e-09       -16.906149294404  <--
     1.5259e+05     1.5259e+06             9.2478e-10       -16.906149294399
     6.1035e+05     6.1035e+06             2.3120e-10       -16.906149294395

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 3.1884e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578369e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465403e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756521e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.308776
====================================================
  Execution time = 2.0483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3513e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335151981008
                                         uncertainty =       0.002720480438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335151981008
                                         uncertainty =       0.002720480438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409345461
  error estimate for blocks of size 2^( 2) =       0.000421795376
  error estimate for blocks of size 2^( 3) =       0.000434794617
  error estimate for blocks of size 2^( 4) =       0.000447620145
  error estimate for blocks of size 2^( 5) =       0.000456554352
  error estimate for blocks of size 2^( 6) =       0.000464745910
  error estimate for blocks of size 2^( 7) =       0.000470452625

      target function =                  N/A
              le_mean =     -16.906651415625
             les_mean =     286.169989335225
             stat err =       0.000459843258
             autocorr =       1.261942851375
              std dev =       0.578901903024
             le_variance =       0.335127413325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665141563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906651415625       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906651415681       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651415727       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906651415756       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906651415750       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906651415713       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906651415742       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.610509e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906651415625       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906651415639       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651415651       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906651415656       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906651415651       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906651415648       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906651415661       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 4.026287e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906651415625       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906651415629       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651415632       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906651415615       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906651415670       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906651415692       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906651415677       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.006573e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6074e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578350e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465401e-03 1 1  ON 35
eH1_6                 7.327535e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330165e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756523e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9824
    reference variance = 0.3929
====================================================
  Execution time = 2.0215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3098e-01
  Total weights = 2.0000e+06
  Execution time = 1.8839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048177982
                                         uncertainty =       0.002681861556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048177982
                                         uncertainty =       0.002681861556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406807107
  error estimate for blocks of size 2^( 2) =       0.000419341223
  error estimate for blocks of size 2^( 3) =       0.000432494258
  error estimate for blocks of size 2^( 4) =       0.000444728314
  error estimate for blocks of size 2^( 5) =       0.000455030293
  error estimate for blocks of size 2^( 6) =       0.000464509807
  error estimate for blocks of size 2^( 7) =       0.000470466312

      target function =                  N/A
              le_mean =     -16.906391657449
             les_mean =     286.157062753733
             stat err =       0.000458683682
             autocorr =       1.271304302472
              std dev =       0.575312127603
             le_variance =       0.330984044168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048173406
                                         uncertainty =       0.002681861574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048173406
                                         uncertainty =       0.002681861574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406807104
  error estimate for blocks of size 2^( 2) =       0.000419341221
  error estimate for blocks of size 2^( 3) =       0.000432494255
  error estimate for blocks of size 2^( 4) =       0.000444728312
  error estimate for blocks of size 2^( 5) =       0.000455030290
  error estimate for blocks of size 2^( 6) =       0.000464509805
  error estimate for blocks of size 2^( 7) =       0.000470466310

      target function =                  N/A
              le_mean =     -16.906391657389
             les_mean =     286.157062747139
             stat err =       0.000458683679
             autocorr =       1.271304308156
              std dev =       0.575312123626
             le_variance =       0.330984039591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048175694
                                         uncertainty =       0.002681861565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048175694
                                         uncertainty =       0.002681861565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406807105
  error estimate for blocks of size 2^( 2) =       0.000419341222
  error estimate for blocks of size 2^( 3) =       0.000432494256
  error estimate for blocks of size 2^( 4) =       0.000444728313
  error estimate for blocks of size 2^( 5) =       0.000455030292
  error estimate for blocks of size 2^( 6) =       0.000464509806
  error estimate for blocks of size 2^( 7) =       0.000470466311

      target function =                  N/A
              le_mean =     -16.906391657419
             les_mean =     286.157062750436
             stat err =       0.000458683680
             autocorr =       1.271304305315
              std dev =       0.575312125615
             le_variance =       0.330984041879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048177696
                                         uncertainty =       0.002681861557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331048177696
                                         uncertainty =       0.002681861557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406807107
  error estimate for blocks of size 2^( 2) =       0.000419341223
  error estimate for blocks of size 2^( 3) =       0.000432494258
  error estimate for blocks of size 2^( 4) =       0.000444728314
  error estimate for blocks of size 2^( 5) =       0.000455030293
  error estimate for blocks of size 2^( 6) =       0.000464509807
  error estimate for blocks of size 2^( 7) =       0.000470466312

      target function =                  N/A
              le_mean =     -16.906391657445
             les_mean =     286.157062753321
             stat err =       0.000458683681
             autocorr =       1.271304302825
              std dev =       0.575312127355
             le_variance =       0.330984043882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906391657449        initial  <--
     9.5367e+03     9.5367e+04             1.6105e-08       -16.906391657389
     3.8147e+04     3.8147e+05             4.0263e-09       -16.906391657419
     1.5259e+05     1.5259e+06             1.0066e-09       -16.906391657445

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8070
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578369e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465403e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756521e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9671
    reference variance = 0.166024
====================================================
  Execution time = 2.0753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337523185923
                                         uncertainty =       0.006903057649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337523185923
                                         uncertainty =       0.006903057649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410780083
  error estimate for blocks of size 2^( 2) =       0.000423531388
  error estimate for blocks of size 2^( 3) =       0.000436303490
  error estimate for blocks of size 2^( 4) =       0.000448692784
  error estimate for blocks of size 2^( 5) =       0.000459313680
  error estimate for blocks of size 2^( 6) =       0.000467051654
  error estimate for blocks of size 2^( 7) =       0.000473287623

      target function =                  N/A
              le_mean =     -16.906834918529
             les_mean =     286.178547346799
             stat err =       0.000462086435
             autocorr =       1.265399570026
              std dev =       0.580930764510
             le_variance =       0.337480553154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683491853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906834918529       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906834918528       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834918528       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834918527       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834918525       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834918596       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834918545       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.018413e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906834918529       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906834918529       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834918529       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834918524       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834918529       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834918511       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834918562       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.046042e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906834918529       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906834918529       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834918529       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834918529       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834918529       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834918779       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834918153       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.261512e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6240e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578368e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465403e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756521e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9607
    reference variance = 0.31528
====================================================
  Execution time = 2.0146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4278e-01
  Total weights = 2.0000e+06
  Execution time = 1.8961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855317701
                                         uncertainty =       0.003842893185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855317701
                                         uncertainty =       0.003842893185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991134
  error estimate for blocks of size 2^( 2) =       0.000426814009
  error estimate for blocks of size 2^( 3) =       0.000439511769
  error estimate for blocks of size 2^( 4) =       0.000451183524
  error estimate for blocks of size 2^( 5) =       0.000461281724
  error estimate for blocks of size 2^( 6) =       0.000467832335
  error estimate for blocks of size 2^( 7) =       0.000472745820

      target function =                  N/A
              le_mean =     -16.906349302313
             les_mean =     286.167423877986
             stat err =       0.000463260851
             autocorr =       1.252186797014
              std dev =       0.585471875972
             le_variance =       0.342777317555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855318626
                                         uncertainty =       0.003842893193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855318626
                                         uncertainty =       0.003842893193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991134
  error estimate for blocks of size 2^( 2) =       0.000426814010
  error estimate for blocks of size 2^( 3) =       0.000439511769
  error estimate for blocks of size 2^( 4) =       0.000451183524
  error estimate for blocks of size 2^( 5) =       0.000461281725
  error estimate for blocks of size 2^( 6) =       0.000467832335
  error estimate for blocks of size 2^( 7) =       0.000472745820

      target function =                  N/A
              le_mean =     -16.906349302314
             les_mean =     286.167423878936
             stat err =       0.000463260851
             autocorr =       1.252186796234
              std dev =       0.585471876762
             le_variance =       0.342777318479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855318164
                                         uncertainty =       0.003842893189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855318164
                                         uncertainty =       0.003842893189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991134
  error estimate for blocks of size 2^( 2) =       0.000426814009
  error estimate for blocks of size 2^( 3) =       0.000439511769
  error estimate for blocks of size 2^( 4) =       0.000451183524
  error estimate for blocks of size 2^( 5) =       0.000461281724
  error estimate for blocks of size 2^( 6) =       0.000467832335
  error estimate for blocks of size 2^( 7) =       0.000472745820

      target function =                  N/A
              le_mean =     -16.906349302313
             les_mean =     286.167423878461
             stat err =       0.000463260851
             autocorr =       1.252186796629
              std dev =       0.585471876367
             le_variance =       0.342777318017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855317759
                                         uncertainty =       0.003842893185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342855317759
                                         uncertainty =       0.003842893185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413991134
  error estimate for blocks of size 2^( 2) =       0.000426814009
  error estimate for blocks of size 2^( 3) =       0.000439511769
  error estimate for blocks of size 2^( 4) =       0.000451183524
  error estimate for blocks of size 2^( 5) =       0.000461281724
  error estimate for blocks of size 2^( 6) =       0.000467832335
  error estimate for blocks of size 2^( 7) =       0.000472745820

      target function =                  N/A
              le_mean =     -16.906349302313
             les_mean =     286.167423878045
             stat err =       0.000463260851
             autocorr =       1.252186796960
              std dev =       0.585471876022
             le_variance =       0.342777317612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906349302313        initial
     9.5367e+04     9.5367e+05             2.0184e-09       -16.906349302314  <--
     3.8147e+05     3.8147e+06             5.0460e-10       -16.906349302313
     1.5259e+06     1.5259e+07             1.2615e-10       -16.906349302313

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 2.9715e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578364e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465403e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8634
    reference variance = 0.264125
====================================================
  Execution time = 2.0991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4326e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343322373793
                                         uncertainty =       0.007481322759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343322373793
                                         uncertainty =       0.007481322759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414283917
  error estimate for blocks of size 2^( 2) =       0.000426742821
  error estimate for blocks of size 2^( 3) =       0.000439254020
  error estimate for blocks of size 2^( 4) =       0.000449988586
  error estimate for blocks of size 2^( 5) =       0.000459606798
  error estimate for blocks of size 2^( 6) =       0.000466249725
  error estimate for blocks of size 2^( 7) =       0.000472749536

      target function =                  N/A
              le_mean =     -16.906452873937
             les_mean =     286.171410935341
             stat err =       0.000462148661
             autocorr =       1.244420767481
              std dev =       0.585885934553
             le_variance =       0.343262328307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645287394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452873937       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452873932       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452873948       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452873941       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452873947       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452873926       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452873872       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.392765e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452873937       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452873936       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452873940       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452873938       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452873981       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452873974       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452873930       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.348209e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452873937       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452873937       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452873938       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452873938       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452873938       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452874137       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452874043       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.870533e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6581e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578361e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465402e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330165e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8143
    reference variance = 0.265493
====================================================
  Execution time = 2.0085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3764e-01
  Total weights = 2.0000e+06
  Execution time = 1.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635915025
                                         uncertainty =       0.003317846071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635915025
                                         uncertainty =       0.003317846071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410876480
  error estimate for blocks of size 2^( 2) =       0.000423826146
  error estimate for blocks of size 2^( 3) =       0.000437693949
  error estimate for blocks of size 2^( 4) =       0.000450646242
  error estimate for blocks of size 2^( 5) =       0.000462152472
  error estimate for blocks of size 2^( 6) =       0.000472273481
  error estimate for blocks of size 2^( 7) =       0.000479764732

      target function =                  N/A
              le_mean =     -16.906430415812
             les_mean =     286.165028198989
             stat err =       0.000466209232
             autocorr =       1.287476099236
              std dev =       0.581067090027
             le_variance =       0.337638963112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635917208
                                         uncertainty =       0.003317846089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635917208
                                         uncertainty =       0.003317846089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410876481
  error estimate for blocks of size 2^( 2) =       0.000423826147
  error estimate for blocks of size 2^( 3) =       0.000437693950
  error estimate for blocks of size 2^( 4) =       0.000450646243
  error estimate for blocks of size 2^( 5) =       0.000462152473
  error estimate for blocks of size 2^( 6) =       0.000472273482
  error estimate for blocks of size 2^( 7) =       0.000479764733

      target function =                  N/A
              le_mean =     -16.906430415803
             les_mean =     286.165028200867
             stat err =       0.000466209233
             autocorr =       1.287476096629
              std dev =       0.581067091903
             le_variance =       0.337638965293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635916117
                                         uncertainty =       0.003317846080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635916117
                                         uncertainty =       0.003317846080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410876480
  error estimate for blocks of size 2^( 2) =       0.000423826147
  error estimate for blocks of size 2^( 3) =       0.000437693949
  error estimate for blocks of size 2^( 4) =       0.000450646243
  error estimate for blocks of size 2^( 5) =       0.000462152472
  error estimate for blocks of size 2^( 6) =       0.000472273481
  error estimate for blocks of size 2^( 7) =       0.000479764732

      target function =                  N/A
              le_mean =     -16.906430415808
             les_mean =     286.165028199928
             stat err =       0.000466209232
             autocorr =       1.287476097935
              std dev =       0.581067090965
             le_variance =       0.337638964203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635915162
                                         uncertainty =       0.003317846072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337635915162
                                         uncertainty =       0.003317846072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410876480
  error estimate for blocks of size 2^( 2) =       0.000423826146
  error estimate for blocks of size 2^( 3) =       0.000437693949
  error estimate for blocks of size 2^( 4) =       0.000450646242
  error estimate for blocks of size 2^( 5) =       0.000462152472
  error estimate for blocks of size 2^( 6) =       0.000472273481
  error estimate for blocks of size 2^( 7) =       0.000479764732

      target function =                  N/A
              le_mean =     -16.906430415812
             les_mean =     286.165028199106
             stat err =       0.000466209232
             autocorr =       1.287476099078
              std dev =       0.581067090144
             le_variance =       0.337638963248


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906430415812        initial  <--
     2.3842e+04     2.3842e+05             9.3928e-09       -16.906430415803
     9.5367e+04     9.5367e+05             2.3482e-09       -16.906430415808
     3.8147e+05     3.8147e+06             5.8705e-10       -16.906430415812

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7118
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578364e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465403e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9837
    reference variance = 0.373956
====================================================
  Execution time = 2.0721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3749e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337403231043
                                         uncertainty =       0.002981447649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337403231043
                                         uncertainty =       0.002981447649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410783279
  error estimate for blocks of size 2^( 2) =       0.000423673281
  error estimate for blocks of size 2^( 3) =       0.000436002625
  error estimate for blocks of size 2^( 4) =       0.000447431436
  error estimate for blocks of size 2^( 5) =       0.000456705336
  error estimate for blocks of size 2^( 6) =       0.000462095703
  error estimate for blocks of size 2^( 7) =       0.000468001793

      target function =                  N/A
              le_mean =     -16.906421356044
             les_mean =     286.164568704752
             stat err =       0.000458558567
             autocorr =       1.246132168591
              std dev =       0.580935285041
             le_variance =       0.337485805406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642135604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421356044       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421356051       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421356053       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421356068       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421356014       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421356131       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421356281       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.695591e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421356044       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421356046       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421356046       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421356046       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421356505       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421356308       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421356233       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.423903e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421356044       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421356044       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421356044       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421356044       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421359361       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421356114       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421357435       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.059776e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6239e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578364e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465402e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9003
    reference variance = 0.247719
====================================================
  Execution time = 2.0160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3745e-01
  Total weights = 2.0000e+06
  Execution time = 1.8835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412615
                                         uncertainty =       0.004072035689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412615
                                         uncertainty =       0.004072035689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410762531
  error estimate for blocks of size 2^( 2) =       0.000423493931
  error estimate for blocks of size 2^( 3) =       0.000436142170
  error estimate for blocks of size 2^( 4) =       0.000446583667
  error estimate for blocks of size 2^( 5) =       0.000457317155
  error estimate for blocks of size 2^( 6) =       0.000463702087
  error estimate for blocks of size 2^( 7) =       0.000470747881

      target function =                  N/A
              le_mean =     -16.905911240854
             les_mean =     286.147286429274
             stat err =       0.000459587697
             autocorr =       1.251858221660
              std dev =       0.580905942797
             le_variance =       0.337451714377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412653
                                         uncertainty =       0.004072035694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412653
                                         uncertainty =       0.004072035694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410762531
  error estimate for blocks of size 2^( 2) =       0.000423493931
  error estimate for blocks of size 2^( 3) =       0.000436142170
  error estimate for blocks of size 2^( 4) =       0.000446583667
  error estimate for blocks of size 2^( 5) =       0.000457317155
  error estimate for blocks of size 2^( 6) =       0.000463702087
  error estimate for blocks of size 2^( 7) =       0.000470747881

      target function =                  N/A
              le_mean =     -16.905911240859
             les_mean =     286.147286429497
             stat err =       0.000459587697
             autocorr =       1.251858221772
              std dev =       0.580905942830
             le_variance =       0.337451714415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412634
                                         uncertainty =       0.004072035691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412634
                                         uncertainty =       0.004072035691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410762531
  error estimate for blocks of size 2^( 2) =       0.000423493931
  error estimate for blocks of size 2^( 3) =       0.000436142170
  error estimate for blocks of size 2^( 4) =       0.000446583667
  error estimate for blocks of size 2^( 5) =       0.000457317155
  error estimate for blocks of size 2^( 6) =       0.000463702087
  error estimate for blocks of size 2^( 7) =       0.000470747881

      target function =                  N/A
              le_mean =     -16.905911240856
             les_mean =     286.147286429385
             stat err =       0.000459587697
             autocorr =       1.251858221727
              std dev =       0.580905942813
             le_variance =       0.337451714396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412617
                                         uncertainty =       0.004072035689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337536412617
                                         uncertainty =       0.004072035689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410762531
  error estimate for blocks of size 2^( 2) =       0.000423493931
  error estimate for blocks of size 2^( 3) =       0.000436142170
  error estimate for blocks of size 2^( 4) =       0.000446583667
  error estimate for blocks of size 2^( 5) =       0.000457317155
  error estimate for blocks of size 2^( 6) =       0.000463702087
  error estimate for blocks of size 2^( 7) =       0.000470747881

      target function =                  N/A
              le_mean =     -16.905911240854
             les_mean =     286.147286429288
             stat err =       0.000459587697
             autocorr =       1.251858221678
              std dev =       0.580905942799
             le_variance =       0.337451714379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905911240854        initial
     2.3842e+05     2.3842e+06             9.6956e-10       -16.905911240859  <--
     9.5367e+05     9.5367e+06             2.4239e-10       -16.905911240856
     3.8147e+06     3.8147e+07             6.0598e-11       -16.905911240854

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 2.9727e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578365e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465402e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.181195
====================================================
  Execution time = 2.0619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334970597480
                                         uncertainty =       0.003250288619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334970597480
                                         uncertainty =       0.003250288619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409252063
  error estimate for blocks of size 2^( 2) =       0.000422289663
  error estimate for blocks of size 2^( 3) =       0.000435135343
  error estimate for blocks of size 2^( 4) =       0.000447131969
  error estimate for blocks of size 2^( 5) =       0.000458183413
  error estimate for blocks of size 2^( 6) =       0.000466969411
  error estimate for blocks of size 2^( 7) =       0.000471128469

      target function =                  N/A
              le_mean =     -16.906606306994
             les_mean =     286.168311154374
             stat err =       0.000460853315
             autocorr =       1.268071311785
              std dev =       0.578769817955
             le_variance =       0.334974502175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660630699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906606306994       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906606306994       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906606306998       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906606307003       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906606307001       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906606307004       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906606307007       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 2.433412e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906606306994       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906606306994       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906606306995       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906606306915       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906606306941       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906606306889       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906606307011       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 6.083537e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906606306994       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906606306994       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906606306994       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906606306998       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906606306563       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906606307074       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906606307314       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.520885e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064160 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6085e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578364e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465402e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756522e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9407
    reference variance = 0.300443
====================================================
  Execution time = 2.0704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3625e-01
  Total weights = 2.0000e+06
  Execution time = 2.1618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366587570
                                         uncertainty =       0.002818894563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366587570
                                         uncertainty =       0.002818894563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410030536
  error estimate for blocks of size 2^( 2) =       0.000422218642
  error estimate for blocks of size 2^( 3) =       0.000434943637
  error estimate for blocks of size 2^( 4) =       0.000446898930
  error estimate for blocks of size 2^( 5) =       0.000456806980
  error estimate for blocks of size 2^( 6) =       0.000464766594
  error estimate for blocks of size 2^( 7) =       0.000469857283

      target function =                  N/A
              le_mean =     -16.906902540939
             les_mean =     286.179603442338
             stat err =       0.000459582447
             autocorr =       1.256303191329
              std dev =       0.579870745634
             le_variance =       0.336250081643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366588562
                                         uncertainty =       0.002818894578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366588562
                                         uncertainty =       0.002818894578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410030537
  error estimate for blocks of size 2^( 2) =       0.000422218643
  error estimate for blocks of size 2^( 3) =       0.000434943638
  error estimate for blocks of size 2^( 4) =       0.000446898930
  error estimate for blocks of size 2^( 5) =       0.000456806981
  error estimate for blocks of size 2^( 6) =       0.000464766594
  error estimate for blocks of size 2^( 7) =       0.000469857284

      target function =                  N/A
              le_mean =     -16.906902540943
             les_mean =     286.179603443470
             stat err =       0.000459582447
             autocorr =       1.256303190849
              std dev =       0.579870746491
             le_variance =       0.336250082636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366588066
                                         uncertainty =       0.002818894571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366588066
                                         uncertainty =       0.002818894571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410030537
  error estimate for blocks of size 2^( 2) =       0.000422218642
  error estimate for blocks of size 2^( 3) =       0.000434943637
  error estimate for blocks of size 2^( 4) =       0.000446898930
  error estimate for blocks of size 2^( 5) =       0.000456806981
  error estimate for blocks of size 2^( 6) =       0.000464766594
  error estimate for blocks of size 2^( 7) =       0.000469857283

      target function =                  N/A
              le_mean =     -16.906902540941
             les_mean =     286.179603442904
             stat err =       0.000459582447
             autocorr =       1.256303191090
              std dev =       0.579870746063
             le_variance =       0.336250082139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366587632
                                         uncertainty =       0.002818894564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336366587632
                                         uncertainty =       0.002818894564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410030536
  error estimate for blocks of size 2^( 2) =       0.000422218642
  error estimate for blocks of size 2^( 3) =       0.000434943637
  error estimate for blocks of size 2^( 4) =       0.000446898930
  error estimate for blocks of size 2^( 5) =       0.000456806980
  error estimate for blocks of size 2^( 6) =       0.000464766594
  error estimate for blocks of size 2^( 7) =       0.000469857283

      target function =                  N/A
              le_mean =     -16.906902540940
             les_mean =     286.179603442409
             stat err =       0.000459582447
             autocorr =       1.256303191296
              std dev =       0.579870745688
             le_variance =       0.336250081705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906902540939        initial
     5.9605e+04     5.9605e+05             2.4334e-09       -16.906902540943  <--
     2.3842e+05     2.3842e+06             6.0835e-10       -16.906902540941
     9.5367e+05     9.5367e+06             1.5209e-10       -16.906902540940

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 3.0721e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536620e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578361e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465400e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330164e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756521e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6812e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8888
    reference variance = 0.389651
====================================================
  Execution time = 2.2734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3788e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337911922806
                                         uncertainty =       0.003119295357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337911922806
                                         uncertainty =       0.003119295357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411026249
  error estimate for blocks of size 2^( 2) =       0.000423445880
  error estimate for blocks of size 2^( 3) =       0.000437264508
  error estimate for blocks of size 2^( 4) =       0.000449670637
  error estimate for blocks of size 2^( 5) =       0.000462226232
  error estimate for blocks of size 2^( 6) =       0.000472557904
  error estimate for blocks of size 2^( 7) =       0.000480087308

      target function =                  N/A
              le_mean =     -16.906513416549
             les_mean =     286.168080889157
             stat err =       0.000466135520
             autocorr =       1.286131221757
              std dev =       0.581278895318
             le_variance =       0.337885154142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651341655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906513416549       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906513416545       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906513416546       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906513416561       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906513416589       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906513416593       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906513416585       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906513416605       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.183194e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906513416549       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906513416548       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906513416548       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906513416552       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906513416580       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906513416561       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906513416556       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906513416567       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 2.957993e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906513416549       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906513416549       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906513416549       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906513416550       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906513416551       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906513416505       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906513416304       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906513416404       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.394983e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8264e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578357e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465398e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330165e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756520e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8134
    reference variance = 0.506162
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4145e-01
  Total weights = 2.0000e+06
  Execution time = 1.8838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482624276
                                         uncertainty =       0.004397513821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482624276
                                         uncertainty =       0.004397513821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413188212
  error estimate for blocks of size 2^( 2) =       0.000425680657
  error estimate for blocks of size 2^( 3) =       0.000438241304
  error estimate for blocks of size 2^( 4) =       0.000450187390
  error estimate for blocks of size 2^( 5) =       0.000461094552
  error estimate for blocks of size 2^( 6) =       0.000468911455
  error estimate for blocks of size 2^( 7) =       0.000474855152

      target function =                  N/A
              le_mean =     -16.906523918491
             les_mean =     286.171999833465
             stat err =       0.000463762137
             autocorr =       1.259780063311
              std dev =       0.584336373754
             le_variance =       0.341448997692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482620743
                                         uncertainty =       0.004397513777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482620743
                                         uncertainty =       0.004397513777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413188210
  error estimate for blocks of size 2^( 2) =       0.000425680655
  error estimate for blocks of size 2^( 3) =       0.000438241302
  error estimate for blocks of size 2^( 4) =       0.000450187389
  error estimate for blocks of size 2^( 5) =       0.000461094551
  error estimate for blocks of size 2^( 6) =       0.000468911454
  error estimate for blocks of size 2^( 7) =       0.000474855150

      target function =                  N/A
              le_mean =     -16.906523918543
             les_mean =     286.171999831689
             stat err =       0.000463762136
             autocorr =       1.259780069614
              std dev =       0.584336370731
             le_variance =       0.341448994159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482622510
                                         uncertainty =       0.004397513799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482622510
                                         uncertainty =       0.004397513799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413188211
  error estimate for blocks of size 2^( 2) =       0.000425680656
  error estimate for blocks of size 2^( 3) =       0.000438241303
  error estimate for blocks of size 2^( 4) =       0.000450187389
  error estimate for blocks of size 2^( 5) =       0.000461094552
  error estimate for blocks of size 2^( 6) =       0.000468911454
  error estimate for blocks of size 2^( 7) =       0.000474855151

      target function =                  N/A
              le_mean =     -16.906523918517
             les_mean =     286.171999832577
             stat err =       0.000463762137
             autocorr =       1.259780066463
              std dev =       0.584336372243
             le_variance =       0.341448995926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482624056
                                         uncertainty =       0.004397513818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341482624056
                                         uncertainty =       0.004397513818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413188212
  error estimate for blocks of size 2^( 2) =       0.000425680657
  error estimate for blocks of size 2^( 3) =       0.000438241304
  error estimate for blocks of size 2^( 4) =       0.000450187390
  error estimate for blocks of size 2^( 5) =       0.000461094552
  error estimate for blocks of size 2^( 6) =       0.000468911455
  error estimate for blocks of size 2^( 7) =       0.000474855151

      target function =                  N/A
              le_mean =     -16.906523918494
             les_mean =     286.171999833354
             stat err =       0.000463762137
             autocorr =       1.259780063699
              std dev =       0.584336373565
             le_variance =       0.341448997472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906523918491        initial
     1.4901e+04     1.4901e+05             1.1832e-08       -16.906523918543  <--
     5.9605e+04     5.9605e+05             2.9580e-09       -16.906523918517
     2.3842e+05     2.3842e+06             7.3950e-10       -16.906523918494

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.9790e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578344e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294224e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850627e-01 1 1  ON 21
 eO_2                 2.874549e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465394e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330165e-02 1 1  ON 43
eH2_4                -3.324848e-02 1 1  ON 44
eH2_5                 5.756517e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9109
    reference variance = 0.131288
====================================================
  Execution time = 2.0763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353518293576
                                         uncertainty =       0.011001597528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353518293576
                                         uncertainty =       0.011001597528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420380280
  error estimate for blocks of size 2^( 2) =       0.000432814296
  error estimate for blocks of size 2^( 3) =       0.000444890219
  error estimate for blocks of size 2^( 4) =       0.000456892543
  error estimate for blocks of size 2^( 5) =       0.000466524886
  error estimate for blocks of size 2^( 6) =       0.000472072564
  error estimate for blocks of size 2^( 7) =       0.000478325445

      target function =                  N/A
              le_mean =     -16.906181032538
             les_mean =     286.172396087624
             stat err =       0.000468453859
             autocorr =       1.241792328974
              std dev =       0.594507493132
             le_variance =       0.353439159390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618103254e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906181032538       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906181032477       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906181032354       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906181032341       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906181032393       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906181032435       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906181032422       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.364710e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906181032538       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906181032523       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906181032492       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906181032489       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906181032497       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906181032526       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906181032509       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.341279e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906181032538       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906181032534       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906181032527       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906181032526       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906181032552       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906181032540       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906181032457       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.353262e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6335e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064921e-02 1 1  ON 12
 ud_3                -3.578321e-04 1 1  ON 13
 ud_4                -5.819444e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874550e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512677e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465394e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330166e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756527e-03 1 1  ON 45
eH2_6                 7.515039e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8868
    reference variance = 0.203034
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4438e-01
  Total weights = 2.0000e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346770614
                                         uncertainty =       0.004789215971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346770614
                                         uncertainty =       0.004789215971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414959638
  error estimate for blocks of size 2^( 2) =       0.000427749740
  error estimate for blocks of size 2^( 3) =       0.000440102579
  error estimate for blocks of size 2^( 4) =       0.000452281553
  error estimate for blocks of size 2^( 5) =       0.000463179656
  error estimate for blocks of size 2^( 6) =       0.000471911121
  error estimate for blocks of size 2^( 7) =       0.000477029617

      target function =                  N/A
              le_mean =     -16.906871268109
             les_mean =     286.186678906737
             stat err =       0.000466100487
             autocorr =       1.261674717637
              std dev =       0.586841548059
             le_variance =       0.344383002528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346773694
                                         uncertainty =       0.004789216268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346773694
                                         uncertainty =       0.004789216268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414959640
  error estimate for blocks of size 2^( 2) =       0.000427749742
  error estimate for blocks of size 2^( 3) =       0.000440102581
  error estimate for blocks of size 2^( 4) =       0.000452281555
  error estimate for blocks of size 2^( 5) =       0.000463179659
  error estimate for blocks of size 2^( 6) =       0.000471911124
  error estimate for blocks of size 2^( 7) =       0.000477029618

      target function =                  N/A
              le_mean =     -16.906871268165
             les_mean =     286.186678911718
             stat err =       0.000466100489
             autocorr =       1.261674718380
              std dev =       0.586841550679
             le_variance =       0.344383005604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346772155
                                         uncertainty =       0.004789216119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346772155
                                         uncertainty =       0.004789216119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414959639
  error estimate for blocks of size 2^( 2) =       0.000427749741
  error estimate for blocks of size 2^( 3) =       0.000440102580
  error estimate for blocks of size 2^( 4) =       0.000452281554
  error estimate for blocks of size 2^( 5) =       0.000463179658
  error estimate for blocks of size 2^( 6) =       0.000471911122
  error estimate for blocks of size 2^( 7) =       0.000477029617

      target function =                  N/A
              le_mean =     -16.906871268137
             les_mean =     286.186678909228
             stat err =       0.000466100488
             autocorr =       1.261674718005
              std dev =       0.586841549369
             le_variance =       0.344383004066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346770807
                                         uncertainty =       0.004789215989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344346770807
                                         uncertainty =       0.004789215989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414959638
  error estimate for blocks of size 2^( 2) =       0.000427749740
  error estimate for blocks of size 2^( 3) =       0.000440102579
  error estimate for blocks of size 2^( 4) =       0.000452281553
  error estimate for blocks of size 2^( 5) =       0.000463179657
  error estimate for blocks of size 2^( 6) =       0.000471911121
  error estimate for blocks of size 2^( 7) =       0.000477029617

      target function =                  N/A
              le_mean =     -16.906871268112
             les_mean =     286.186678907048
             stat err =       0.000466100487
             autocorr =       1.261674717682
              std dev =       0.586841548222
             le_variance =       0.344383002720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906871268109        initial
     3.7253e+03     3.7253e+04             5.3647e-08       -16.906871268165  <--
     1.4901e+04     1.4901e+05             1.3413e-08       -16.906871268137
     5.9605e+04     5.9605e+05             3.3533e-09       -16.906871268112

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.9870e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578250e-04 1 1  ON 13
 ud_4                -5.819445e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874553e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512678e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465396e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330168e-02 1 1  ON 43
eH2_4                -3.324851e-02 1 1  ON 44
eH2_5                 5.756558e-03 1 1  ON 45
eH2_6                 7.515041e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9285
    reference variance = 0.256914
====================================================
  Execution time = 2.0728e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3390e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333912798196
                                         uncertainty =       0.003660249641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333912798196
                                         uncertainty =       0.003660249641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408595978
  error estimate for blocks of size 2^( 2) =       0.000421564532
  error estimate for blocks of size 2^( 3) =       0.000435050163
  error estimate for blocks of size 2^( 4) =       0.000447049077
  error estimate for blocks of size 2^( 5) =       0.000457124834
  error estimate for blocks of size 2^( 6) =       0.000465924303
  error estimate for blocks of size 2^( 7) =       0.000471524461

      target function =                  N/A
              le_mean =     -16.906595460280
             les_mean =     286.166871237369
             stat err =       0.000460405669
             autocorr =       1.269676700829
              std dev =       0.577841973854
             le_variance =       0.333901346747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659546028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906595460280       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906595459380       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906595459696       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906595459951       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906595460117       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906595460216       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906595459907       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.597615e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906595460280       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906595460055       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906595460134       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906595460198       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906595460238       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906595460264       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906595460187       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 3.994183e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906595460280       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906595460224       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906595460244       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906595460257       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906595460258       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906595460276       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906595460257       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 9.985547e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6370e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.940441e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536617e-02 1 1  ON 2
 uu_3                -3.754536e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064919e-02 1 1  ON 12
 ud_3                -3.578291e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874555e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820701e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512676e-02 1 1  ON 33
eH1_4                -3.494154e-02 1 1  ON 34
eH1_5                 4.465370e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330166e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756537e-03 1 1  ON 45
eH2_6                 7.515037e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.190688
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3696e-01
  Total weights = 2.0000e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012575908
                                         uncertainty =       0.003207903966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012575908
                                         uncertainty =       0.003207903966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410465369
  error estimate for blocks of size 2^( 2) =       0.000423548596
  error estimate for blocks of size 2^( 3) =       0.000436091269
  error estimate for blocks of size 2^( 4) =       0.000448223113
  error estimate for blocks of size 2^( 5) =       0.000457877532
  error estimate for blocks of size 2^( 6) =       0.000467523480
  error estimate for blocks of size 2^( 7) =       0.000473246381

      target function =                  N/A
              le_mean =     -16.905825639134
             les_mean =     286.143904010342
             stat err =       0.000461717627
             autocorr =       1.265318524639
              std dev =       0.580485691482
             le_variance =       0.336963638015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012670418
                                         uncertainty =       0.003207904557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012670418
                                         uncertainty =       0.003207904557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410465426
  error estimate for blocks of size 2^( 2) =       0.000423548650
  error estimate for blocks of size 2^( 3) =       0.000436091319
  error estimate for blocks of size 2^( 4) =       0.000448223160
  error estimate for blocks of size 2^( 5) =       0.000457877578
  error estimate for blocks of size 2^( 6) =       0.000467523522
  error estimate for blocks of size 2^( 7) =       0.000473246416

      target function =                  N/A
              le_mean =     -16.905825636816
             les_mean =     286.143904026436
             stat err =       0.000461717669
             autocorr =       1.265318403056
              std dev =       0.580485772871
             le_variance =       0.336963732505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012623179
                                         uncertainty =       0.003207904262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012623179
                                         uncertainty =       0.003207904262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410465398
  error estimate for blocks of size 2^( 2) =       0.000423548623
  error estimate for blocks of size 2^( 3) =       0.000436091294
  error estimate for blocks of size 2^( 4) =       0.000448223136
  error estimate for blocks of size 2^( 5) =       0.000457877555
  error estimate for blocks of size 2^( 6) =       0.000467523501
  error estimate for blocks of size 2^( 7) =       0.000473246398

      target function =                  N/A
              le_mean =     -16.905825637974
             les_mean =     286.143904018386
             stat err =       0.000461717648
             autocorr =       1.265318463827
              std dev =       0.580485732190
             le_variance =       0.336963685276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012581817
                                         uncertainty =       0.003207904003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337012581817
                                         uncertainty =       0.003207904003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410465372
  error estimate for blocks of size 2^( 2) =       0.000423548599
  error estimate for blocks of size 2^( 3) =       0.000436091273
  error estimate for blocks of size 2^( 4) =       0.000448223116
  error estimate for blocks of size 2^( 5) =       0.000457877535
  error estimate for blocks of size 2^( 6) =       0.000467523483
  error estimate for blocks of size 2^( 7) =       0.000473246383

      target function =                  N/A
              le_mean =     -16.905825638989
             les_mean =     286.143904011347
             stat err =       0.000461717629
             autocorr =       1.265318517039
              std dev =       0.580485696571
             le_variance =       0.336963643923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905825639134        initial  <--
     9.3132e+02     9.3132e+03             1.5976e-07       -16.905825636816
     3.7253e+03     3.7253e+04             3.9942e-08       -16.905825637974
     1.4901e+04     1.4901e+05             9.9855e-09       -16.905825638989

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0499
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578250e-04 1 1  ON 13
 ud_4                -5.819445e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874553e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512678e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465396e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330168e-02 1 1  ON 43
eH2_4                -3.324851e-02 1 1  ON 44
eH2_5                 5.756558e-03 1 1  ON 45
eH2_6                 7.515041e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6426e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8587
    reference variance = 0.298549
====================================================
  Execution time = 2.0903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339365149569
                                         uncertainty =       0.003501611797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339365149569
                                         uncertainty =       0.003501611797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411898438
  error estimate for blocks of size 2^( 2) =       0.000424424689
  error estimate for blocks of size 2^( 3) =       0.000436993951
  error estimate for blocks of size 2^( 4) =       0.000449533416
  error estimate for blocks of size 2^( 5) =       0.000460393992
  error estimate for blocks of size 2^( 6) =       0.000467768038
  error estimate for blocks of size 2^( 7) =       0.000471040161

      target function =                  N/A
              le_mean =     -16.906200795356
             les_mean =     286.158945808939
             stat err =       0.000462183902
             autocorr =       1.259068445580
              std dev =       0.582512356705
             le_variance =       0.339320645714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620079536e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200795356       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200795355       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200795352       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200795346       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200795355       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200795374       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200795377       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.168377e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200795356       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200795355       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200795355       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200795355       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200795350       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200795361       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200795390       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.420991e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200795356       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200795356       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200795355       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200795355       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200795356       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200795273       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200795625       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.355251e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6506e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.940440e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536619e-02 1 1  ON 2
 uu_3                -3.754537e-02 1 1  ON 3
 uu_4                -8.367453e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578240e-04 1 1  ON 13
 ud_4                -5.819445e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874553e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291270e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512678e-02 1 1  ON 33
eH1_4                -3.494155e-02 1 1  ON 34
eH1_5                 4.465398e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330168e-02 1 1  ON 43
eH2_4                -3.324852e-02 1 1  ON 44
eH2_5                 5.756559e-03 1 1  ON 45
eH2_6                 7.515041e-02 1 1  ON 46
eH2_7                 1.575637e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9226
    reference variance = 0.283612
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3544e-01
  Total weights = 2.0000e+06
  Execution time = 1.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536789691
                                         uncertainty =       0.003523056929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536789691
                                         uncertainty =       0.003523056929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536960
  error estimate for blocks of size 2^( 2) =       0.000422294145
  error estimate for blocks of size 2^( 3) =       0.000435924932
  error estimate for blocks of size 2^( 4) =       0.000448375791
  error estimate for blocks of size 2^( 5) =       0.000458537378
  error estimate for blocks of size 2^( 6) =       0.000465381293
  error estimate for blocks of size 2^( 7) =       0.000469973840

      target function =                  N/A
              le_mean =     -16.906476705322
             les_mean =     286.164395462663
             stat err =       0.000460567075
             autocorr =       1.264735103220
              std dev =       0.579172722756
             le_variance =       0.335441042784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536794509
                                         uncertainty =       0.003523056987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536794509
                                         uncertainty =       0.003523056987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536963
  error estimate for blocks of size 2^( 2) =       0.000422294148
  error estimate for blocks of size 2^( 3) =       0.000435924935
  error estimate for blocks of size 2^( 4) =       0.000448375793
  error estimate for blocks of size 2^( 5) =       0.000458537381
  error estimate for blocks of size 2^( 6) =       0.000465381296
  error estimate for blocks of size 2^( 7) =       0.000469973842

      target function =                  N/A
              le_mean =     -16.906476705466
             les_mean =     286.164395472362
             stat err =       0.000460567078
             autocorr =       1.264735099745
              std dev =       0.579172726920
             le_variance =       0.335441047608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536792100
                                         uncertainty =       0.003523056958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536792100
                                         uncertainty =       0.003523056958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536961
  error estimate for blocks of size 2^( 2) =       0.000422294146
  error estimate for blocks of size 2^( 3) =       0.000435924933
  error estimate for blocks of size 2^( 4) =       0.000448375792
  error estimate for blocks of size 2^( 5) =       0.000458537380
  error estimate for blocks of size 2^( 6) =       0.000465381294
  error estimate for blocks of size 2^( 7) =       0.000469973841

      target function =                  N/A
              le_mean =     -16.906476705394
             les_mean =     286.164395467513
             stat err =       0.000460567077
             autocorr =       1.264735101488
              std dev =       0.579172724838
             le_variance =       0.335441045196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536789992
                                         uncertainty =       0.003523056933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335536789992
                                         uncertainty =       0.003523056933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536960
  error estimate for blocks of size 2^( 2) =       0.000422294145
  error estimate for blocks of size 2^( 3) =       0.000435924932
  error estimate for blocks of size 2^( 4) =       0.000448375791
  error estimate for blocks of size 2^( 5) =       0.000458537378
  error estimate for blocks of size 2^( 6) =       0.000465381293
  error estimate for blocks of size 2^( 7) =       0.000469973840

      target function =                  N/A
              le_mean =     -16.906476705331
             les_mean =     286.164395463270
             stat err =       0.000460567076
             autocorr =       1.264735103013
              std dev =       0.579172723016
             le_variance =       0.335441043086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906476705322        initial
     9.3132e+03     9.3132e+04             2.1684e-08       -16.906476705466  <--
     3.7253e+04     3.7253e+05             5.4210e-09       -16.906476705394
     1.4901e+05     1.4901e+06             1.3553e-09       -16.906476705331

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 2.9650e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.940441e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536618e-02 1 1  ON 2
 uu_3                -3.754536e-02 1 1  ON 3
 uu_4                -8.367454e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578208e-04 1 1  ON 13
 ud_4                -5.819445e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874554e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512678e-02 1 1  ON 33
eH1_4                -3.494154e-02 1 1  ON 34
eH1_5                 4.465407e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330169e-02 1 1  ON 43
eH2_4                -3.324852e-02 1 1  ON 44
eH2_5                 5.756561e-03 1 1  ON 45
eH2_6                 7.515042e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9333
    reference variance = 0.296314
====================================================
  Execution time = 2.0611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934292373
                                         uncertainty =       0.002863148244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336934292373
                                         uncertainty =       0.002863148244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410454221
  error estimate for blocks of size 2^( 2) =       0.000423503215
  error estimate for blocks of size 2^( 3) =       0.000436695213
  error estimate for blocks of size 2^( 4) =       0.000448981433
  error estimate for blocks of size 2^( 5) =       0.000459654292
  error estimate for blocks of size 2^( 6) =       0.000465811583
  error estimate for blocks of size 2^( 7) =       0.000472831014

      target function =                  N/A
              le_mean =     -16.906190170084
             les_mean =     286.156211233100
             stat err =       0.000461819581
             autocorr =       1.265946153556
              std dev =       0.580469925612
             le_variance =       0.336945334540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619017008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190170084       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190170085       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190170093       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190170164       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190170134       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190170097       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190170127       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 6.678186e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190170084       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190170084       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190170086       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190170103       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190170096       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190170083       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190170087       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 1.669679e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190170084       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190170084       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190170084       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190170089       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190170081       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190170091       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190170102       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 4.174281e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6151e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.940441e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536618e-02 1 1  ON 2
 uu_3                -3.754535e-02 1 1  ON 3
 uu_4                -8.367454e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292964e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578224e-04 1 1  ON 13
 ud_4                -5.819445e-02 1 1  ON 14
 ud_5                -1.010006e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874555e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260686e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512679e-02 1 1  ON 33
eH1_4                -3.494154e-02 1 1  ON 34
eH1_5                 4.465402e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909227e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330170e-02 1 1  ON 43
eH2_4                -3.324852e-02 1 1  ON 44
eH2_5                 5.756557e-03 1 1  ON 45
eH2_6                 7.515041e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.342797
====================================================
  Execution time = 2.0413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3214e-01
  Total weights = 2.0000e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057448671
                                         uncertainty =       0.002798072552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057448671
                                         uncertainty =       0.002798072552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407516396
  error estimate for blocks of size 2^( 2) =       0.000420372129
  error estimate for blocks of size 2^( 3) =       0.000433227234
  error estimate for blocks of size 2^( 4) =       0.000446105643
  error estimate for blocks of size 2^( 5) =       0.000457610749
  error estimate for blocks of size 2^( 6) =       0.000467317219
  error estimate for blocks of size 2^( 7) =       0.000474891167

      target function =                  N/A
              le_mean =     -16.906134486250
             les_mean =     286.149522327597
             stat err =       0.000461481195
             autocorr =       1.282383265938
              std dev =       0.576315214539
             le_variance =       0.332139226510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057476150
                                         uncertainty =       0.002798072840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057476150
                                         uncertainty =       0.002798072840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407516413
  error estimate for blocks of size 2^( 2) =       0.000420372145
  error estimate for blocks of size 2^( 3) =       0.000433227250
  error estimate for blocks of size 2^( 4) =       0.000446105658
  error estimate for blocks of size 2^( 5) =       0.000457610766
  error estimate for blocks of size 2^( 6) =       0.000467317236
  error estimate for blocks of size 2^( 7) =       0.000474891181

      target function =                  N/A
              le_mean =     -16.906134486254
             les_mean =     286.149522355223
             stat err =       0.000461481210
             autocorr =       1.282383246297
              std dev =       0.576315238389
             le_variance =       0.332139254000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057462413
                                         uncertainty =       0.002798072696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057462413
                                         uncertainty =       0.002798072696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407516405
  error estimate for blocks of size 2^( 2) =       0.000420372137
  error estimate for blocks of size 2^( 3) =       0.000433227242
  error estimate for blocks of size 2^( 4) =       0.000446105651
  error estimate for blocks of size 2^( 5) =       0.000457610758
  error estimate for blocks of size 2^( 6) =       0.000467317228
  error estimate for blocks of size 2^( 7) =       0.000474891174

      target function =                  N/A
              le_mean =     -16.906134486252
             les_mean =     286.149522341411
             stat err =       0.000461481202
             autocorr =       1.282383256117
              std dev =       0.576315226466
             le_variance =       0.332139240257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057450389
                                         uncertainty =       0.002798072570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332057450389
                                         uncertainty =       0.002798072570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407516397
  error estimate for blocks of size 2^( 2) =       0.000420372130
  error estimate for blocks of size 2^( 3) =       0.000433227235
  error estimate for blocks of size 2^( 4) =       0.000446105644
  error estimate for blocks of size 2^( 5) =       0.000457610751
  error estimate for blocks of size 2^( 6) =       0.000467317221
  error estimate for blocks of size 2^( 7) =       0.000474891168

      target function =                  N/A
              le_mean =     -16.906134486250
             les_mean =     286.149522329324
             stat err =       0.000461481196
             autocorr =       1.282383264710
              std dev =       0.576315216030
             le_variance =       0.332139228228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906134486250        initial
     2.3283e+03     2.3283e+04             6.6782e-08       -16.906134486254  <--
     9.3132e+03     9.3132e+04             1.6697e-08       -16.906134486252
     3.7253e+04     3.7253e+05             4.1743e-09       -16.906134486250

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 2.9944e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.940441e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536616e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367455e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561807e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558641e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064920e-02 1 1  ON 12
 ud_3                -3.578271e-04 1 1  ON 13
 ud_4                -5.819445e-02 1 1  ON 14
 ud_5                -1.010005e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055358e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874559e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820700e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260687e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512683e-02 1 1  ON 33
eH1_4                -3.494153e-02 1 1  ON 34
eH1_5                 4.465389e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909228e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389007e-01 1 1  ON 42
eH2_3                -8.330175e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756547e-03 1 1  ON 45
eH2_6                 7.515038e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245681e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.0264
    reference variance = 0.398468
====================================================
  Execution time = 2.2686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3277e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332828372715
                                         uncertainty =       0.005168509442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332828372715
                                         uncertainty =       0.005168509442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407902317
  error estimate for blocks of size 2^( 2) =       0.000420326814
  error estimate for blocks of size 2^( 3) =       0.000432826024
  error estimate for blocks of size 2^( 4) =       0.000444224576
  error estimate for blocks of size 2^( 5) =       0.000453253985
  error estimate for blocks of size 2^( 6) =       0.000460275800
  error estimate for blocks of size 2^( 7) =       0.000464633693

      target function =                  N/A
              le_mean =     -16.906614685278
             les_mean =     286.166388550499
             stat err =       0.000455597013
             autocorr =       1.247525387054
              std dev =       0.576860988811
             le_variance =       0.332768600412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661468528e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906614685278       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906614687069       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614686665       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906614686119       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906614686156       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614685966       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906614685753       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906614685803       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.391603e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906614685278       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906614685726       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614685625       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906614685488       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906614685497       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614685451       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906614685398       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906614685409       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.479824e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906614685278       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906614685390       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906614685365       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906614685331       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906614685333       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614685322       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906614685314       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906614685284       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.120007e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8244e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.940441e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536614e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196088e-01 1 1  ON 5
 uu_6                -1.485005e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561808e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558642e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064922e-02 1 1  ON 12
 ud_3                -3.578306e-04 1 1  ON 13
 ud_4                -5.819443e-02 1 1  ON 14
 ud_5                -1.010005e-01 1 1  ON 15
 ud_6                -1.294225e-01 1 1  ON 16
 ud_7                -1.475763e-01 1 1  ON 17
 ud_8                -1.500121e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055357e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874563e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686551e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820701e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291271e-01 1 1  ON 28
 eO_9                -2.260687e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512679e-02 1 1  ON 33
eH1_4                -3.494158e-02 1 1  ON 34
eH1_5                 4.465416e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117591e-01 1 1  ON 39
eH2_0                -2.909228e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389006e-01 1 1  ON 42
eH2_3                -8.330180e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756569e-03 1 1  ON 45
eH2_6                 7.515035e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9366
    reference variance = 0.292083
====================================================
  Execution time = 2.2222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3991e-01
  Total weights = 2.0000e+06
  Execution time = 1.8974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339885891983
                                         uncertainty =       0.003757602587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339885891983
                                         uncertainty =       0.003757602587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412254582
  error estimate for blocks of size 2^( 2) =       0.000424590782
  error estimate for blocks of size 2^( 3) =       0.000437005282
  error estimate for blocks of size 2^( 4) =       0.000448140359
  error estimate for blocks of size 2^( 5) =       0.000458362401
  error estimate for blocks of size 2^( 6) =       0.000463949407
  error estimate for blocks of size 2^( 7) =       0.000469554915

      target function =                  N/A
              le_mean =     -16.906927215643
             les_mean =     286.184095386415
             stat err =       0.000460001771
             autocorr =       1.245053528081
              std dev =       0.583016021494
             le_variance =       0.339907681319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339886003052
                                         uncertainty =       0.003757605658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339886003052
                                         uncertainty =       0.003757605658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412254650
  error estimate for blocks of size 2^( 2) =       0.000424590847
  error estimate for blocks of size 2^( 3) =       0.000437005345
  error estimate for blocks of size 2^( 4) =       0.000448140417
  error estimate for blocks of size 2^( 5) =       0.000458362461
  error estimate for blocks of size 2^( 6) =       0.000463949472
  error estimate for blocks of size 2^( 7) =       0.000469554995

      target function =                  N/A
              le_mean =     -16.906927215757
             les_mean =     286.184095501417
             stat err =       0.000460001836
             autocorr =       1.245053477054
              std dev =       0.583016116806
             le_variance =       0.339907792455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339885947554
                                         uncertainty =       0.003757604124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339885947554
                                         uncertainty =       0.003757604124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412254616
  error estimate for blocks of size 2^( 2) =       0.000424590815
  error estimate for blocks of size 2^( 3) =       0.000437005313
  error estimate for blocks of size 2^( 4) =       0.000448140388
  error estimate for blocks of size 2^( 5) =       0.000458362431
  error estimate for blocks of size 2^( 6) =       0.000463949440
  error estimate for blocks of size 2^( 7) =       0.000469554955

      target function =                  N/A
              le_mean =     -16.906927215700
             les_mean =     286.184095443944
             stat err =       0.000460001803
             autocorr =       1.245053502547
              std dev =       0.583016069181
             le_variance =       0.339907736923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339885898931
                                         uncertainty =       0.003757602779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339885898931
                                         uncertainty =       0.003757602779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412254587
  error estimate for blocks of size 2^( 2) =       0.000424590786
  error estimate for blocks of size 2^( 3) =       0.000437005286
  error estimate for blocks of size 2^( 4) =       0.000448140363
  error estimate for blocks of size 2^( 5) =       0.000458362405
  error estimate for blocks of size 2^( 6) =       0.000463949411
  error estimate for blocks of size 2^( 7) =       0.000469554920

      target function =                  N/A
              le_mean =     -16.906927215650
             les_mean =     286.184095393607
             stat err =       0.000460001775
             autocorr =       1.245053524888
              std dev =       0.583016027456
             le_variance =       0.339907688270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906927215643        initial
     5.8208e+02     5.8208e+03             3.3916e-07       -16.906927215757  <--
     2.3283e+03     2.3283e+04             8.4798e-08       -16.906927215700
     9.3132e+03     9.3132e+04             2.1200e-08       -16.906927215650

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 3.1769e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536607e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064927e-02 1 1  ON 12
 ud_3                -3.578410e-04 1 1  ON 13
 ud_4                -5.819436e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874576e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260688e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465497e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330196e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756636e-03 1 1  ON 45
eH2_6                 7.515025e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9082
    reference variance = 0.279228
====================================================
  Execution time = 2.0899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4330e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343359563351
                                         uncertainty =       0.003952229677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343359563351
                                         uncertainty =       0.003952229677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414307017
  error estimate for blocks of size 2^( 2) =       0.000427038814
  error estimate for blocks of size 2^( 3) =       0.000439912943
  error estimate for blocks of size 2^( 4) =       0.000452456495
  error estimate for blocks of size 2^( 5) =       0.000463736075
  error estimate for blocks of size 2^( 6) =       0.000472803854
  error estimate for blocks of size 2^( 7) =       0.000479356531

      target function =                  N/A
              le_mean =     -16.905531381568
             les_mean =     286.140291730520
             stat err =       0.000467088239
             autocorr =       1.271022636647
              std dev =       0.585918602697
             le_variance =       0.343300608986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553138157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905531381568       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905531382232       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905531382469       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905531384169       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905531385997       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905531386376       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905531386311       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905531386827       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.283141e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905531381568       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905531381734       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905531381793       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905531382218       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905531382675       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905531382769       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905531382755       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905531382883       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.208667e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905531381568       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905531381610       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905531381624       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905531381731       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905531381845       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905531381869       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905531381865       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905531381900       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.022177e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6402e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536593e-02 1 1  ON 2
 uu_3                -3.754539e-02 1 1  ON 3
 uu_4                -8.367464e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485006e-01 1 1  ON 6
 uu_7                -1.640987e-01 1 1  ON 7
 uu_8                -1.561809e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558644e-01 1 1  ON 10
 ud_1                 1.904527e-01 1 1  ON 11
 ud_2                 7.064907e-02 1 1  ON 12
 ud_3                -3.577819e-04 1 1  ON 13
 ud_4                -5.819450e-02 1 1  ON 14
 ud_5                -1.010003e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475764e-01 1 1  ON 17
 ud_8                -1.500119e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850628e-01 1 1  ON 21
 eO_2                 2.874582e-02 1 1  ON 22
 eO_3                 3.441139e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258466e-01 1 1  ON 25
 eO_6                 2.820701e-01 1 1  ON 26
 eO_7                -6.509901e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260690e-01 1 1  ON 29
eH1_0                -2.929931e-01 1 1  ON 30
eH1_1                -1.888772e-01 1 1  ON 31
eH1_2                -1.404879e-01 1 1  ON 32
eH1_3                -8.512663e-02 1 1  ON 33
eH1_4                -3.494194e-02 1 1  ON 34
eH1_5                 4.465434e-03 1 1  ON 35
eH1_6                 7.327539e-02 1 1  ON 36
eH1_7                 1.571885e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117594e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330211e-02 1 1  ON 43
eH2_4                -3.324848e-02 1 1  ON 44
eH2_5                 5.756442e-03 1 1  ON 45
eH2_6                 7.515013e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9218
    reference variance = 0.318123
====================================================
  Execution time = 2.0213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337177246999
                                         uncertainty =       0.004510362561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337177246999
                                         uncertainty =       0.004510362561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410557707
  error estimate for blocks of size 2^( 2) =       0.000423462178
  error estimate for blocks of size 2^( 3) =       0.000435973405
  error estimate for blocks of size 2^( 4) =       0.000448544932
  error estimate for blocks of size 2^( 5) =       0.000459206150
  error estimate for blocks of size 2^( 6) =       0.000468418289
  error estimate for blocks of size 2^( 7) =       0.000476131045

      target function =                  N/A
              le_mean =     -16.905973884791
             les_mean =     286.149068086908
             stat err =       0.000463075104
             autocorr =       1.272197234206
              std dev =       0.580616277964
             le_variance =       0.337115262237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337178698958
                                         uncertainty =       0.004510372564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337178698958
                                         uncertainty =       0.004510372564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410558592
  error estimate for blocks of size 2^( 2) =       0.000423463013
  error estimate for blocks of size 2^( 3) =       0.000435974196
  error estimate for blocks of size 2^( 4) =       0.000448545694
  error estimate for blocks of size 2^( 5) =       0.000459206884
  error estimate for blocks of size 2^( 6) =       0.000468419018
  error estimate for blocks of size 2^( 7) =       0.000476131738

      target function =                  N/A
              le_mean =     -16.905973878046
             les_mean =     286.149069311434
             stat err =       0.000463075833
             autocorr =       1.272195759105
              std dev =       0.580617528860
             le_variance =       0.337116714819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337177974617
                                         uncertainty =       0.004510367573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337177974617
                                         uncertainty =       0.004510367573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410558151
  error estimate for blocks of size 2^( 2) =       0.000423462597
  error estimate for blocks of size 2^( 3) =       0.000435973802
  error estimate for blocks of size 2^( 4) =       0.000448545314
  error estimate for blocks of size 2^( 5) =       0.000459206518
  error estimate for blocks of size 2^( 6) =       0.000468418654
  error estimate for blocks of size 2^( 7) =       0.000476131392

      target function =                  N/A
              le_mean =     -16.905973881409
             les_mean =     286.149068700479
             stat err =       0.000463075470
             autocorr =       1.272196494893
              std dev =       0.580616904824
             le_variance =       0.337115990167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337177338001
                                         uncertainty =       0.004510363188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337177338001
                                         uncertainty =       0.004510363188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410557763
  error estimate for blocks of size 2^( 2) =       0.000423462231
  error estimate for blocks of size 2^( 3) =       0.000435973455
  error estimate for blocks of size 2^( 4) =       0.000448544980
  error estimate for blocks of size 2^( 5) =       0.000459206196
  error estimate for blocks of size 2^( 6) =       0.000468418335
  error estimate for blocks of size 2^( 7) =       0.000476131089

      target function =                  N/A
              le_mean =     -16.905973884368
             les_mean =     286.149068163639
             stat err =       0.000463075150
             autocorr =       1.272197141739
              std dev =       0.580616356365
             le_variance =       0.337115353278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905973884791        initial  <--
     1.4552e+02     1.4552e+03             1.2831e-06       -16.905973878046
     5.8208e+02     5.8208e+03             3.2087e-07       -16.905973881409
     2.3283e+03     2.3283e+04             8.0222e-08       -16.905973884368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6962
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536607e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064927e-02 1 1  ON 12
 ud_3                -3.578410e-04 1 1  ON 13
 ud_4                -5.819436e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874576e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260688e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465497e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330196e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756636e-03 1 1  ON 45
eH2_6                 7.515025e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.227328
====================================================
  Execution time = 2.0482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338168920682
                                         uncertainty =       0.003128329250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338168920682
                                         uncertainty =       0.003128329250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411227209
  error estimate for blocks of size 2^( 2) =       0.000423676223
  error estimate for blocks of size 2^( 3) =       0.000435986263
  error estimate for blocks of size 2^( 4) =       0.000448118876
  error estimate for blocks of size 2^( 5) =       0.000457751223
  error estimate for blocks of size 2^( 6) =       0.000465997117
  error estimate for blocks of size 2^( 7) =       0.000471375666

      target function =                  N/A
              le_mean =     -16.906717147238
             les_mean =     286.175300162901
             stat err =       0.000460810720
             autocorr =       1.255687187916
              std dev =       0.581563096581
             le_variance =       0.338215635305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671714724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906717147238       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906717146785       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906717146244       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906717146236       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906717146478       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906717146558       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906717146554       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.241242e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906717147238       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906717147125       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906717146989       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906717146987       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906717147047       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906717147068       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906717147067       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.103236e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906717147238       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906717147209       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906717147176       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906717147175       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906717147192       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906717147173       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906717147152       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 7.758171e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6037e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536606e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558642e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064928e-02 1 1  ON 12
 ud_3                -3.578444e-04 1 1  ON 13
 ud_4                -5.819435e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874577e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260689e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494176e-02 1 1  ON 34
eH1_5                 4.465504e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330198e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756611e-03 1 1  ON 45
eH2_6                 7.515025e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.334045
====================================================
  Execution time = 2.0364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3866e-01
  Total weights = 2.0000e+06
  Execution time = 1.8978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739336973
                                         uncertainty =       0.003670928573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739336973
                                         uncertainty =       0.003670928573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411498033
  error estimate for blocks of size 2^( 2) =       0.000424494006
  error estimate for blocks of size 2^( 3) =       0.000437934073
  error estimate for blocks of size 2^( 4) =       0.000450241260
  error estimate for blocks of size 2^( 5) =       0.000462033156
  error estimate for blocks of size 2^( 6) =       0.000471110415
  error estimate for blocks of size 2^( 7) =       0.000476984672

      target function =                  N/A
              le_mean =     -16.906078125096
             les_mean =     286.154138665180
             stat err =       0.000465092376
             autocorr =       1.277447065762
              std dev =       0.581946099452
             le_variance =       0.338661262667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739302435
                                         uncertainty =       0.003670928250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739302435
                                         uncertainty =       0.003670928250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411498012
  error estimate for blocks of size 2^( 2) =       0.000424493987
  error estimate for blocks of size 2^( 3) =       0.000437934056
  error estimate for blocks of size 2^( 4) =       0.000450241245
  error estimate for blocks of size 2^( 5) =       0.000462033141
  error estimate for blocks of size 2^( 6) =       0.000471110400
  error estimate for blocks of size 2^( 7) =       0.000476984658

      target function =                  N/A
              le_mean =     -16.906078124562
             les_mean =     286.154138612604
             stat err =       0.000465092361
             autocorr =       1.277447114906
              std dev =       0.581946069776
             le_variance =       0.338661228128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739319703
                                         uncertainty =       0.003670928411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739319703
                                         uncertainty =       0.003670928411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411498023
  error estimate for blocks of size 2^( 2) =       0.000424493997
  error estimate for blocks of size 2^( 3) =       0.000437934065
  error estimate for blocks of size 2^( 4) =       0.000450241253
  error estimate for blocks of size 2^( 5) =       0.000462033149
  error estimate for blocks of size 2^( 6) =       0.000471110408
  error estimate for blocks of size 2^( 7) =       0.000476984665

      target function =                  N/A
              le_mean =     -16.906078124829
             les_mean =     286.154138638889
             stat err =       0.000465092369
             autocorr =       1.277447090338
              std dev =       0.581946084612
             le_variance =       0.338661245396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739334814
                                         uncertainty =       0.003670928553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338739334814
                                         uncertainty =       0.003670928553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411498032
  error estimate for blocks of size 2^( 2) =       0.000424494005
  error estimate for blocks of size 2^( 3) =       0.000437934072
  error estimate for blocks of size 2^( 4) =       0.000450241259
  error estimate for blocks of size 2^( 5) =       0.000462033155
  error estimate for blocks of size 2^( 6) =       0.000471110414
  error estimate for blocks of size 2^( 7) =       0.000476984671

      target function =                  N/A
              le_mean =     -16.906078125062
             les_mean =     286.154138661893
             stat err =       0.000465092375
             autocorr =       1.277447068845
              std dev =       0.581946097597
             le_variance =       0.338661260508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906078125096        initial  <--
     1.4552e+03     1.4552e+04             1.2412e-07       -16.906078124562
     5.8208e+03     5.8208e+04             3.1032e-08       -16.906078124829
     2.3283e+04     2.3283e+05             7.7582e-09       -16.906078125062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8694
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536607e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064927e-02 1 1  ON 12
 ud_3                -3.578410e-04 1 1  ON 13
 ud_4                -5.819436e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874576e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260688e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465497e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330196e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756636e-03 1 1  ON 45
eH2_6                 7.515025e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.803
    reference variance = 0.207286
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3759e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337668089987
                                         uncertainty =       0.003761060012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337668089987
                                         uncertainty =       0.003761060012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410849212
  error estimate for blocks of size 2^( 2) =       0.000423626098
  error estimate for blocks of size 2^( 3) =       0.000436432697
  error estimate for blocks of size 2^( 4) =       0.000448104510
  error estimate for blocks of size 2^( 5) =       0.000457963437
  error estimate for blocks of size 2^( 6) =       0.000465274955
  error estimate for blocks of size 2^( 7) =       0.000472671221

      target function =                  N/A
              le_mean =     -16.906436715084
             les_mean =     286.165196383012
             stat err =       0.000461003531
             autocorr =       1.259051763596
              std dev =       0.581028528271
             le_variance =       0.337594150665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643671508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436715084       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436715099       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436715091       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436715086       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436715091       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436715102       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436715105       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.132638e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436715084       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436715088       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436715086       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436715086       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436715104       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436715061       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436715033       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 2.831628e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436715084       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436715085       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436715085       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436715119       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436714970       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436715027       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436715107       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 7.079087e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6164e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536607e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064928e-02 1 1  ON 12
 ud_3                -3.578421e-04 1 1  ON 13
 ud_4                -5.819436e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874576e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260688e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465495e-03 1 1  ON 35
eH1_6                 7.327532e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330196e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756635e-03 1 1  ON 45
eH2_6                 7.515025e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9005
    reference variance = 0.226446
====================================================
  Execution time = 2.0292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3208e-01
  Total weights = 2.0000e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108980409
                                         uncertainty =       0.003637605168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108980409
                                         uncertainty =       0.003637605168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407478910
  error estimate for blocks of size 2^( 2) =       0.000420148533
  error estimate for blocks of size 2^( 3) =       0.000432702075
  error estimate for blocks of size 2^( 4) =       0.000444969372
  error estimate for blocks of size 2^( 5) =       0.000456382359
  error estimate for blocks of size 2^( 6) =       0.000462925418
  error estimate for blocks of size 2^( 7) =       0.000465155499

      target function =                  N/A
              le_mean =     -16.907294952688
             les_mean =     286.188700575124
             stat err =       0.000457358162
             autocorr =       1.259802880066
              std dev =       0.576262200712
             le_variance =       0.332078123969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108981252
                                         uncertainty =       0.003637605210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108981252
                                         uncertainty =       0.003637605210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407478910
  error estimate for blocks of size 2^( 2) =       0.000420148534
  error estimate for blocks of size 2^( 3) =       0.000432702075
  error estimate for blocks of size 2^( 4) =       0.000444969373
  error estimate for blocks of size 2^( 5) =       0.000456382359
  error estimate for blocks of size 2^( 6) =       0.000462925419
  error estimate for blocks of size 2^( 7) =       0.000465155500

      target function =                  N/A
              le_mean =     -16.907294952748
             les_mean =     286.188700577987
             stat err =       0.000457358163
             autocorr =       1.259802879061
              std dev =       0.576262201446
             le_variance =       0.332078124815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108980830
                                         uncertainty =       0.003637605189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108980830
                                         uncertainty =       0.003637605189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407478910
  error estimate for blocks of size 2^( 2) =       0.000420148533
  error estimate for blocks of size 2^( 3) =       0.000432702075
  error estimate for blocks of size 2^( 4) =       0.000444969373
  error estimate for blocks of size 2^( 5) =       0.000456382359
  error estimate for blocks of size 2^( 6) =       0.000462925419
  error estimate for blocks of size 2^( 7) =       0.000465155499

      target function =                  N/A
              le_mean =     -16.907294952718
             les_mean =     286.188700576556
             stat err =       0.000457358162
             autocorr =       1.259802879563
              std dev =       0.576262201079
             le_variance =       0.332078124392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108980462
                                         uncertainty =       0.003637605171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332108980462
                                         uncertainty =       0.003637605171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407478910
  error estimate for blocks of size 2^( 2) =       0.000420148533
  error estimate for blocks of size 2^( 3) =       0.000432702075
  error estimate for blocks of size 2^( 4) =       0.000444969372
  error estimate for blocks of size 2^( 5) =       0.000456382359
  error estimate for blocks of size 2^( 6) =       0.000462925419
  error estimate for blocks of size 2^( 7) =       0.000465155499

      target function =                  N/A
              le_mean =     -16.907294952692
             les_mean =     286.188700575303
             stat err =       0.000457358162
             autocorr =       1.259802880000
              std dev =       0.576262200757
             le_variance =       0.332078124022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907294952688        initial
     1.4552e+04     1.4552e+05             1.1326e-08       -16.907294952748  <--
     5.8208e+04     5.8208e+05             2.8316e-09       -16.907294952718
     2.3283e+05     2.3283e+06             7.0791e-10       -16.907294952692

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.9807e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536607e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064928e-02 1 1  ON 12
 ud_3                -3.578454e-04 1 1  ON 13
 ud_4                -5.819436e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874577e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260688e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465491e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330197e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756633e-03 1 1  ON 45
eH2_6                 7.515025e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5977e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8379
    reference variance = 0.228486
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335324728085
                                         uncertainty =       0.003936056375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335324728085
                                         uncertainty =       0.003936056375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409457760
  error estimate for blocks of size 2^( 2) =       0.000422323106
  error estimate for blocks of size 2^( 3) =       0.000435251648
  error estimate for blocks of size 2^( 4) =       0.000446994395
  error estimate for blocks of size 2^( 5) =       0.000456270392
  error estimate for blocks of size 2^( 6) =       0.000463457905
  error estimate for blocks of size 2^( 7) =       0.000469384473

      target function =                  N/A
              le_mean =     -16.906089138714
             les_mean =     286.151161112522
             stat err =       0.000459026791
             autocorr =       1.256775934856
              std dev =       0.579060717050
             le_variance =       0.335311314030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608913871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906089138714       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906089138647       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906089138706       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906089138596       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906089138512       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906089138690       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089138664       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.695714e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906089138714       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906089138697       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906089138712       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906089138685       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906089138665       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906089138713       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089138702       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.674013e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906089138714       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906089138710       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906089138714       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906089138725       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906089138702       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906089138734       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089138722       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 4.185087e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5977e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536606e-02 1 1  ON 2
 uu_3                -3.754532e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064929e-02 1 1  ON 12
 ud_3                -3.578439e-04 1 1  ON 13
 ud_4                -5.819435e-02 1 1  ON 14
 ud_5                -1.010004e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874578e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260688e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465495e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871874e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330197e-02 1 1  ON 43
eH2_4                -3.324850e-02 1 1  ON 44
eH2_5                 5.756630e-03 1 1  ON 45
eH2_6                 7.515024e-02 1 1  ON 46
eH2_7                 1.575638e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8488
    reference variance = 0.273292
====================================================
  Execution time = 2.0141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3858e-01
  Total weights = 2.0000e+06
  Execution time = 1.8929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625788522
                                         uncertainty =       0.004787303414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625788522
                                         uncertainty =       0.004787303414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411446785
  error estimate for blocks of size 2^( 2) =       0.000423901318
  error estimate for blocks of size 2^( 3) =       0.000436550805
  error estimate for blocks of size 2^( 4) =       0.000448421978
  error estimate for blocks of size 2^( 5) =       0.000459443563
  error estimate for blocks of size 2^( 6) =       0.000465925550
  error estimate for blocks of size 2^( 7) =       0.000469761346

      target function =                  N/A
              le_mean =     -16.906350299614
             les_mean =     286.163257196985
             stat err =       0.000460888109
             autocorr =       1.254768656175
              std dev =       0.581873622891
             le_variance =       0.338576913016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625806377
                                         uncertainty =       0.004787303471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625806377
                                         uncertainty =       0.004787303471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411446795
  error estimate for blocks of size 2^( 2) =       0.000423901328
  error estimate for blocks of size 2^( 3) =       0.000436550814
  error estimate for blocks of size 2^( 4) =       0.000448421986
  error estimate for blocks of size 2^( 5) =       0.000459443571
  error estimate for blocks of size 2^( 6) =       0.000465925559
  error estimate for blocks of size 2^( 7) =       0.000469761355

      target function =                  N/A
              le_mean =     -16.906350299736
             les_mean =     286.163257218936
             stat err =       0.000460888118
             autocorr =       1.254768637924
              std dev =       0.581873638196
             le_variance =       0.338576930828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625797450
                                         uncertainty =       0.004787303442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625797450
                                         uncertainty =       0.004787303442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411446790
  error estimate for blocks of size 2^( 2) =       0.000423901323
  error estimate for blocks of size 2^( 3) =       0.000436550810
  error estimate for blocks of size 2^( 4) =       0.000448421982
  error estimate for blocks of size 2^( 5) =       0.000459443567
  error estimate for blocks of size 2^( 6) =       0.000465925554
  error estimate for blocks of size 2^( 7) =       0.000469761351

      target function =                  N/A
              le_mean =     -16.906350299675
             les_mean =     286.163257207961
             stat err =       0.000460888113
             autocorr =       1.254768647060
              std dev =       0.581873630544
             le_variance =       0.338576921923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625789638
                                         uncertainty =       0.004787303417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338625789638
                                         uncertainty =       0.004787303417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411446785
  error estimate for blocks of size 2^( 2) =       0.000423901319
  error estimate for blocks of size 2^( 3) =       0.000436550805
  error estimate for blocks of size 2^( 4) =       0.000448421978
  error estimate for blocks of size 2^( 5) =       0.000459443563
  error estimate for blocks of size 2^( 6) =       0.000465925551
  error estimate for blocks of size 2^( 7) =       0.000469761347

      target function =                  N/A
              le_mean =     -16.906350299622
             les_mean =     286.163257198357
             stat err =       0.000460888110
             autocorr =       1.254768655041
              std dev =       0.581873623848
             le_variance =       0.338576914130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906350299614        initial
     3.6380e+03     3.6380e+04             6.6957e-08       -16.906350299736  <--
     1.4552e+04     1.4552e+05             1.6740e-08       -16.906350299675
     5.8208e+04     5.8208e+05             4.1851e-09       -16.906350299622

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 2.9664e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536604e-02 1 1  ON 2
 uu_3                -3.754533e-02 1 1  ON 3
 uu_4                -8.367456e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064931e-02 1 1  ON 12
 ud_3                -3.578394e-04 1 1  ON 13
 ud_4                -5.819434e-02 1 1  ON 14
 ud_5                -1.010003e-01 1 1  ON 15
 ud_6                -1.294226e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055355e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874583e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509908e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260689e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512666e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465506e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117592e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330198e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756623e-03 1 1  ON 45
eH2_6                 7.515023e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.413315
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3743e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337511134011
                                         uncertainty =       0.003819019842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337511134011
                                         uncertainty =       0.003819019842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410750816
  error estimate for blocks of size 2^( 2) =       0.000422826739
  error estimate for blocks of size 2^( 3) =       0.000435125554
  error estimate for blocks of size 2^( 4) =       0.000446401376
  error estimate for blocks of size 2^( 5) =       0.000456989140
  error estimate for blocks of size 2^( 6) =       0.000463006016
  error estimate for blocks of size 2^( 7) =       0.000467286626

      target function =                  N/A
              le_mean =     -16.906458087228
             les_mean =     286.165757352280
             stat err =       0.000458420789
             autocorr =       1.245580324294
              std dev =       0.580889374826
             le_variance =       0.337432465786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645808723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458087228       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458087648       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458087743       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458087633       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458087544       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458087535       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458087408       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.669489e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458087228       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458087333       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458087357       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458087328       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458087306       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458087312       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458087275       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 4.174593e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458087228       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458087255       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458087261       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458087250       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458087248       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458087246       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458087229       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.043703e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6659e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536604e-02 1 1  ON 2
 uu_3                -3.754531e-02 1 1  ON 3
 uu_4                -8.367457e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292965e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904528e-01 1 1  ON 11
 ud_2                 7.064933e-02 1 1  ON 12
 ud_3                -3.578404e-04 1 1  ON 13
 ud_4                -5.819434e-02 1 1  ON 14
 ud_5                -1.010003e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500123e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055354e-01 1 1  ON 20
 eO_1                -3.850629e-01 1 1  ON 21
 eO_2                 2.874584e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291273e-01 1 1  ON 28
 eO_9                -2.260689e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888773e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512666e-02 1 1  ON 33
eH1_4                -3.494175e-02 1 1  ON 34
eH1_5                 4.465512e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117593e-01 1 1  ON 39
eH2_0                -2.909229e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330197e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756622e-03 1 1  ON 45
eH2_6                 7.515024e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9746
    reference variance = 0.500555
====================================================
  Execution time = 2.0243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 1.8868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521130996
                                         uncertainty =       0.003377199557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521130996
                                         uncertainty =       0.003377199557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829204
  error estimate for blocks of size 2^( 2) =       0.000423397707
  error estimate for blocks of size 2^( 3) =       0.000436019718
  error estimate for blocks of size 2^( 4) =       0.000448596549
  error estimate for blocks of size 2^( 5) =       0.000458102296
  error estimate for blocks of size 2^( 6) =       0.000465348773
  error estimate for blocks of size 2^( 7) =       0.000470178760

      target function =                  N/A
              le_mean =     -16.906415018292
             les_mean =     286.164429872238
             stat err =       0.000460556595
             autocorr =       1.256734083229
              std dev =       0.581000232604
             le_variance =       0.337561270286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521068045
                                         uncertainty =       0.003377198844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521068045
                                         uncertainty =       0.003377198844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829166
  error estimate for blocks of size 2^( 2) =       0.000423397670
  error estimate for blocks of size 2^( 3) =       0.000436019682
  error estimate for blocks of size 2^( 4) =       0.000448596514
  error estimate for blocks of size 2^( 5) =       0.000458102263
  error estimate for blocks of size 2^( 6) =       0.000465348743
  error estimate for blocks of size 2^( 7) =       0.000470178734

      target function =                  N/A
              le_mean =     -16.906415018433
             les_mean =     286.164429813972
             stat err =       0.000460556564
             autocorr =       1.256734148765
              std dev =       0.581000178372
             le_variance =       0.337561207268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521099515
                                         uncertainty =       0.003377199201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521099515
                                         uncertainty =       0.003377199201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829185
  error estimate for blocks of size 2^( 2) =       0.000423397688
  error estimate for blocks of size 2^( 3) =       0.000436019700
  error estimate for blocks of size 2^( 4) =       0.000448596532
  error estimate for blocks of size 2^( 5) =       0.000458102280
  error estimate for blocks of size 2^( 6) =       0.000465348758
  error estimate for blocks of size 2^( 7) =       0.000470178747

      target function =                  N/A
              le_mean =     -16.906415018362
             les_mean =     286.164429843099
             stat err =       0.000460556579
             autocorr =       1.256734116010
              std dev =       0.581000205483
             le_variance =       0.337561238772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521127061
                                         uncertainty =       0.003377199512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337521127061
                                         uncertainty =       0.003377199512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829202
  error estimate for blocks of size 2^( 2) =       0.000423397705
  error estimate for blocks of size 2^( 3) =       0.000436019716
  error estimate for blocks of size 2^( 4) =       0.000448596547
  error estimate for blocks of size 2^( 5) =       0.000458102294
  error estimate for blocks of size 2^( 6) =       0.000465348771
  error estimate for blocks of size 2^( 7) =       0.000470178758

      target function =                  N/A
              le_mean =     -16.906415018301
             les_mean =     286.164429868596
             stat err =       0.000460556593
             autocorr =       1.256734087327
              std dev =       0.581000229214
             le_variance =       0.337561266347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906415018292        initial
     9.0949e+02     9.0949e+03             1.6695e-07       -16.906415018433  <--
     3.6380e+03     3.6380e+04             4.1746e-08       -16.906415018362
     1.4552e+04     1.4552e+05             1.0437e-08       -16.906415018301

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 3.3726e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536603e-02 1 1  ON 2
 uu_3                -3.754527e-02 1 1  ON 3
 uu_4                -8.367461e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904529e-01 1 1  ON 11
 ud_2                 7.064940e-02 1 1  ON 12
 ud_3                -3.578435e-04 1 1  ON 13
 ud_4                -5.819432e-02 1 1  ON 14
 ud_5                -1.010002e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500123e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055353e-01 1 1  ON 20
 eO_1                -3.850630e-01 1 1  ON 21
 eO_2                 2.874584e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291274e-01 1 1  ON 28
 eO_9                -2.260690e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888774e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494180e-02 1 1  ON 34
eH1_5                 4.465530e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571883e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117593e-01 1 1  ON 39
eH2_0                -2.909230e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389006e-01 1 1  ON 42
eH2_3                -8.330197e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756620e-03 1 1  ON 45
eH2_6                 7.515024e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.463307
====================================================
  Execution time = 2.0589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4241e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342334169295
                                         uncertainty =       0.005440259984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342334169295
                                         uncertainty =       0.005440259984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413767954
  error estimate for blocks of size 2^( 2) =       0.000426396487
  error estimate for blocks of size 2^( 3) =       0.000438790262
  error estimate for blocks of size 2^( 4) =       0.000449877959
  error estimate for blocks of size 2^( 5) =       0.000460094493
  error estimate for blocks of size 2^( 6) =       0.000466959092
  error estimate for blocks of size 2^( 7) =       0.000472541832

      target function =                  N/A
              le_mean =     -16.906877800905
             les_mean =     286.184924643373
             stat err =       0.000462368344
             autocorr =       1.248712563180
              std dev =       0.585156252510
             le_variance =       0.342407839852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690687780090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906877800905       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906877801143       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906877802220       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906877803590       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906877802427       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906877802227       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906877802074       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 6.651651e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906877800905       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906877800964       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906877801234       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906877801577       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906877801286       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906877801236       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906877801197       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.663530e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906877800905       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906877800920       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906877800987       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906877801073       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906877801000       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906877800988       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906877800979       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 4.159210e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6108e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.940445e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536596e-02 1 1  ON 2
 uu_3                -3.754514e-02 1 1  ON 3
 uu_4                -8.367465e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640987e-01 1 1  ON 7
 uu_8                -1.561814e-01 1 1  ON 8
 uu_9                -1.292967e-01 1 1  ON 9
 ud_0                 4.558642e-01 1 1  ON 10
 ud_1                 1.904530e-01 1 1  ON 11
 ud_2                 7.064944e-02 1 1  ON 12
 ud_3                -3.578183e-04 1 1  ON 13
 ud_4                -5.819426e-02 1 1  ON 14
 ud_5                -1.010001e-01 1 1  ON 15
 ud_6                -1.294228e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500123e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055353e-01 1 1  ON 20
 eO_1                -3.850630e-01 1 1  ON 21
 eO_2                 2.874595e-02 1 1  ON 22
 eO_3                 3.441140e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291275e-01 1 1  ON 28
 eO_9                -2.260691e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888774e-01 1 1  ON 31
eH1_2                -1.404878e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494174e-02 1 1  ON 34
eH1_5                 4.465513e-03 1 1  ON 35
eH1_6                 7.327528e-02 1 1  ON 36
eH1_7                 1.571883e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117594e-01 1 1  ON 39
eH2_0                -2.909230e-01 1 1  ON 40
eH2_1                -1.871877e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330191e-02 1 1  ON 43
eH2_4                -3.324848e-02 1 1  ON 44
eH2_5                 5.756680e-03 1 1  ON 45
eH2_6                 7.515022e-02 1 1  ON 46
eH2_7                 1.575640e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.995
    reference variance = 0.192024
====================================================
  Execution time = 2.0179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4873e-01
  Total weights = 2.0000e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806782496
                                         uncertainty =       0.007824112254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806782496
                                         uncertainty =       0.007824112254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417570926
  error estimate for blocks of size 2^( 2) =       0.000429983426
  error estimate for blocks of size 2^( 3) =       0.000442719324
  error estimate for blocks of size 2^( 4) =       0.000454176959
  error estimate for blocks of size 2^( 5) =       0.000463916162
  error estimate for blocks of size 2^( 6) =       0.000470334502
  error estimate for blocks of size 2^( 7) =       0.000472731634

      target function =                  N/A
              le_mean =     -16.906735624931
             les_mean =     286.186440273258
             stat err =       0.000465289814
             autocorr =       1.241613957164
              std dev =       0.590534466668
             le_variance =       0.348730956322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806236205
                                         uncertainty =       0.007824096035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806236205
                                         uncertainty =       0.007824096035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417570599
  error estimate for blocks of size 2^( 2) =       0.000429983112
  error estimate for blocks of size 2^( 3) =       0.000442719020
  error estimate for blocks of size 2^( 4) =       0.000454176662
  error estimate for blocks of size 2^( 5) =       0.000463915874
  error estimate for blocks of size 2^( 6) =       0.000470334237
  error estimate for blocks of size 2^( 7) =       0.000472731354

      target function =                  N/A
              le_mean =     -16.906735619254
             les_mean =     286.186439535404
             stat err =       0.000465289532
             autocorr =       1.241614392911
              std dev =       0.590534004442
             le_variance =       0.348730410402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806509000
                                         uncertainty =       0.007824104135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806509000
                                         uncertainty =       0.007824104135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417570762
  error estimate for blocks of size 2^( 2) =       0.000429983269
  error estimate for blocks of size 2^( 3) =       0.000442719172
  error estimate for blocks of size 2^( 4) =       0.000454176811
  error estimate for blocks of size 2^( 5) =       0.000463916018
  error estimate for blocks of size 2^( 6) =       0.000470334369
  error estimate for blocks of size 2^( 7) =       0.000472731494

      target function =                  N/A
              le_mean =     -16.906735622088
             les_mean =     286.186439903840
             stat err =       0.000465289673
             autocorr =       1.241614175292
              std dev =       0.590534235258
             le_variance =       0.348730683012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806748297
                                         uncertainty =       0.007824111239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348806748297
                                         uncertainty =       0.007824111239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417570905
  error estimate for blocks of size 2^( 2) =       0.000429983406
  error estimate for blocks of size 2^( 3) =       0.000442719305
  error estimate for blocks of size 2^( 4) =       0.000454176941
  error estimate for blocks of size 2^( 5) =       0.000463916144
  error estimate for blocks of size 2^( 6) =       0.000470334486
  error estimate for blocks of size 2^( 7) =       0.000472731616

      target function =                  N/A
              le_mean =     -16.906735624575
             les_mean =     286.186440227063
             stat err =       0.000465289797
             autocorr =       1.241613984440
              std dev =       0.590534437732
             le_variance =       0.348730922147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906735624931        initial  <--
     2.2737e+02     2.2737e+03             6.6517e-07       -16.906735619254
     9.0949e+02     9.0949e+03             1.6635e-07       -16.906735622088
     3.6380e+03     3.6380e+04             4.1592e-08       -16.906735624575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7036
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536603e-02 1 1  ON 2
 uu_3                -3.754527e-02 1 1  ON 3
 uu_4                -8.367461e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561813e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904529e-01 1 1  ON 11
 ud_2                 7.064940e-02 1 1  ON 12
 ud_3                -3.578435e-04 1 1  ON 13
 ud_4                -5.819432e-02 1 1  ON 14
 ud_5                -1.010002e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500123e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055353e-01 1 1  ON 20
 eO_1                -3.850630e-01 1 1  ON 21
 eO_2                 2.874584e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509911e-02 1 1  ON 27
 eO_8                -3.291274e-01 1 1  ON 28
 eO_9                -2.260690e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888774e-01 1 1  ON 31
eH1_2                -1.404877e-01 1 1  ON 32
eH1_3                -8.512665e-02 1 1  ON 33
eH1_4                -3.494180e-02 1 1  ON 34
eH1_5                 4.465530e-03 1 1  ON 35
eH1_6                 7.327533e-02 1 1  ON 36
eH1_7                 1.571883e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117593e-01 1 1  ON 39
eH2_0                -2.909230e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389006e-01 1 1  ON 42
eH2_3                -8.330197e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756620e-03 1 1  ON 45
eH2_6                 7.515024e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366641e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9767
    reference variance = 0.374235
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3317e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333039570912
                                         uncertainty =       0.002774951058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333039570912
                                         uncertainty =       0.002774951058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408145996
  error estimate for blocks of size 2^( 2) =       0.000421168227
  error estimate for blocks of size 2^( 3) =       0.000435040015
  error estimate for blocks of size 2^( 4) =       0.000448244827
  error estimate for blocks of size 2^( 5) =       0.000459748587
  error estimate for blocks of size 2^( 6) =       0.000470054512
  error estimate for blocks of size 2^( 7) =       0.000475520823

      target function =                  N/A
              le_mean =     -16.905469160102
             les_mean =     286.128053664447
             stat err =       0.000463392187
             autocorr =       1.289039822693
              std dev =       0.577205602775
             le_variance =       0.333166307875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690546916010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905469160102       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905469160579       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469160764       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905469160611       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469160411       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469160454       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469160498       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469160539       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 8.286721e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905469160102       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905469160221       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469160267       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905469160229       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469160181       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469160191       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469160201       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469160210       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.071855e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905469160102       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905469160132       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469160143       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905469160134       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469160125       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469160141       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469160102       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469160113       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 5.179747e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6149e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.940444e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536602e-02 1 1  ON 2
 uu_3                -3.754528e-02 1 1  ON 3
 uu_4                -8.367462e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561812e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558643e-01 1 1  ON 10
 ud_1                 1.904529e-01 1 1  ON 11
 ud_2                 7.064940e-02 1 1  ON 12
 ud_3                -3.578487e-04 1 1  ON 13
 ud_4                -5.819432e-02 1 1  ON 14
 ud_5                -1.010002e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500123e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055353e-01 1 1  ON 20
 eO_1                -3.850631e-01 1 1  ON 21
 eO_2                 2.874585e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509910e-02 1 1  ON 27
 eO_8                -3.291274e-01 1 1  ON 28
 eO_9                -2.260690e-01 1 1  ON 29
eH1_0                -2.929929e-01 1 1  ON 30
eH1_1                -1.888774e-01 1 1  ON 31
eH1_2                -1.404878e-01 1 1  ON 32
eH1_3                -8.512666e-02 1 1  ON 33
eH1_4                -3.494181e-02 1 1  ON 34
eH1_5                 4.465536e-03 1 1  ON 35
eH1_6                 7.327534e-02 1 1  ON 36
eH1_7                 1.571883e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117593e-01 1 1  ON 39
eH2_0                -2.909230e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389006e-01 1 1  ON 42
eH2_3                -8.330198e-02 1 1  ON 43
eH2_4                -3.324849e-02 1 1  ON 44
eH2_5                 5.756613e-03 1 1  ON 45
eH2_6                 7.515024e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.231007
====================================================
  Execution time = 2.0342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7768e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730437489
                                         uncertainty =       0.032637654297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730437489
                                         uncertainty =       0.032637654297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434557785
  error estimate for blocks of size 2^( 2) =       0.000445956764
  error estimate for blocks of size 2^( 3) =       0.000458257582
  error estimate for blocks of size 2^( 4) =       0.000470320351
  error estimate for blocks of size 2^( 5) =       0.000480755969
  error estimate for blocks of size 2^( 6) =       0.000489061633
  error estimate for blocks of size 2^( 7) =       0.000493169570

      target function =                  N/A
              le_mean =     -16.905953531601
             les_mean =     286.188945560850
             stat err =       0.000483326881
             autocorr =       1.237048793255
              std dev =       0.614557513198
             le_variance =       0.377680937028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730526233
                                         uncertainty =       0.032637659589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730526233
                                         uncertainty =       0.032637659589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434557836
  error estimate for blocks of size 2^( 2) =       0.000445956813
  error estimate for blocks of size 2^( 3) =       0.000458257630
  error estimate for blocks of size 2^( 4) =       0.000470320398
  error estimate for blocks of size 2^( 5) =       0.000480756014
  error estimate for blocks of size 2^( 6) =       0.000489061677
  error estimate for blocks of size 2^( 7) =       0.000493169611

      target function =                  N/A
              le_mean =     -16.905953531659
             les_mean =     286.188945651586
             stat err =       0.000483326925
             autocorr =       1.237048729190
              std dev =       0.614557585437
             le_variance =       0.377681025819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730481867
                                         uncertainty =       0.032637656943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730481867
                                         uncertainty =       0.032637656943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434557811
  error estimate for blocks of size 2^( 2) =       0.000445956788
  error estimate for blocks of size 2^( 3) =       0.000458257606
  error estimate for blocks of size 2^( 4) =       0.000470320374
  error estimate for blocks of size 2^( 5) =       0.000480755992
  error estimate for blocks of size 2^( 6) =       0.000489061655
  error estimate for blocks of size 2^( 7) =       0.000493169590

      target function =                  N/A
              le_mean =     -16.905953531630
             les_mean =     286.188945606225
             stat err =       0.000483326903
             autocorr =       1.237048761215
              std dev =       0.614557549323
             le_variance =       0.377680981430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730443036
                                         uncertainty =       0.032637654628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377730443036
                                         uncertainty =       0.032637654628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434557788
  error estimate for blocks of size 2^( 2) =       0.000445956767
  error estimate for blocks of size 2^( 3) =       0.000458257585
  error estimate for blocks of size 2^( 4) =       0.000470320354
  error estimate for blocks of size 2^( 5) =       0.000480755972
  error estimate for blocks of size 2^( 6) =       0.000489061636
  error estimate for blocks of size 2^( 7) =       0.000493169573

      target function =                  N/A
              le_mean =     -16.905953531605
             les_mean =     286.188945566522
             stat err =       0.000483326884
             autocorr =       1.237048789247
              std dev =       0.614557517714
             le_variance =       0.377680942578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905953531601        initial
     2.2737e+03     2.2737e+04             8.2867e-08       -16.905953531659  <--
     9.0949e+03     9.0949e+04             2.0719e-08       -16.905953531630
     3.6380e+04     3.6380e+05             5.1797e-09       -16.905953531605

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 2.9811e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.940445e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536599e-02 1 1  ON 2
 uu_3                -3.754529e-02 1 1  ON 3
 uu_4                -8.367465e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640989e-01 1 1  ON 7
 uu_8                -1.561812e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558644e-01 1 1  ON 10
 ud_1                 1.904529e-01 1 1  ON 11
 ud_2                 7.064939e-02 1 1  ON 12
 ud_3                -3.578644e-04 1 1  ON 13
 ud_4                -5.819433e-02 1 1  ON 14
 ud_5                -1.010002e-01 1 1  ON 15
 ud_6                -1.294228e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420255e-01 1 1  ON 19
 eO_0                -7.055353e-01 1 1  ON 20
 eO_1                -3.850631e-01 1 1  ON 21
 eO_2                 2.874588e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509909e-02 1 1  ON 27
 eO_8                -3.291274e-01 1 1  ON 28
 eO_9                -2.260690e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888774e-01 1 1  ON 31
eH1_2                -1.404878e-01 1 1  ON 32
eH1_3                -8.512668e-02 1 1  ON 33
eH1_4                -3.494181e-02 1 1  ON 34
eH1_5                 4.465555e-03 1 1  ON 35
eH1_6                 7.327538e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117594e-01 1 1  ON 39
eH2_0                -2.909230e-01 1 1  ON 40
eH2_1                -1.871876e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330200e-02 1 1  ON 43
eH2_4                -3.324847e-02 1 1  ON 44
eH2_5                 5.756592e-03 1 1  ON 45
eH2_6                 7.515022e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245682e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5967e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.221
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340327737457
                                         uncertainty =       0.003335868757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340327737457
                                         uncertainty =       0.003335868757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412472157
  error estimate for blocks of size 2^( 2) =       0.000424973642
  error estimate for blocks of size 2^( 3) =       0.000438125044
  error estimate for blocks of size 2^( 4) =       0.000451068772
  error estimate for blocks of size 2^( 5) =       0.000462179163
  error estimate for blocks of size 2^( 6) =       0.000471631075
  error estimate for blocks of size 2^( 7) =       0.000477082294

      target function =                  N/A
              le_mean =     -16.906527178169
             les_mean =     286.170927616157
             stat err =       0.000465490326
             autocorr =       1.273597048191
              std dev =       0.583323718116
             le_variance =       0.340266560117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652717817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527178169       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906527178564       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906527178629       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906527178956       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906527179435       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906527179972       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906527179656       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 3.307711e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527178169       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906527178268       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906527178284       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906527178366       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906527178486       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906527178620       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906527178541       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 8.270053e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527178169       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906527178194       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906527178198       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906527178216       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906527178248       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906527178282       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906527178262       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.067562e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6124e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.940445e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536597e-02 1 1  ON 2
 uu_3                -3.754530e-02 1 1  ON 3
 uu_4                -8.367465e-02 1 1  ON 4
 uu_5                -1.196090e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640988e-01 1 1  ON 7
 uu_8                -1.561812e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558644e-01 1 1  ON 10
 ud_1                 1.904529e-01 1 1  ON 11
 ud_2                 7.064939e-02 1 1  ON 12
 ud_3                -3.578624e-04 1 1  ON 13
 ud_4                -5.819432e-02 1 1  ON 14
 ud_5                -1.010001e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500122e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055352e-01 1 1  ON 20
 eO_1                -3.850632e-01 1 1  ON 21
 eO_2                 2.874590e-02 1 1  ON 22
 eO_3                 3.441141e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509908e-02 1 1  ON 27
 eO_8                -3.291274e-01 1 1  ON 28
 eO_9                -2.260691e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888774e-01 1 1  ON 31
eH1_2                -1.404878e-01 1 1  ON 32
eH1_3                -8.512668e-02 1 1  ON 33
eH1_4                -3.494186e-02 1 1  ON 34
eH1_5                 4.465557e-03 1 1  ON 35
eH1_6                 7.327539e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117594e-01 1 1  ON 39
eH2_0                -2.909231e-01 1 1  ON 40
eH2_1                -1.871876e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330203e-02 1 1  ON 43
eH2_4                -3.324844e-02 1 1  ON 44
eH2_5                 5.756572e-03 1 1  ON 45
eH2_6                 7.515024e-02 1 1  ON 46
eH2_7                 1.575639e-01 1 1  ON 47
eH2_8                 2.245683e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0108
    reference variance = 0.424261
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2977e-01
  Total weights = 2.0000e+06
  Execution time = 1.8950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763785529
                                         uncertainty =       0.003420011868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763785529
                                         uncertainty =       0.003420011868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406061730
  error estimate for blocks of size 2^( 2) =       0.000418638722
  error estimate for blocks of size 2^( 3) =       0.000431230891
  error estimate for blocks of size 2^( 4) =       0.000443594888
  error estimate for blocks of size 2^( 5) =       0.000453697225
  error estimate for blocks of size 2^( 6) =       0.000461212304
  error estimate for blocks of size 2^( 7) =       0.000466078109

      target function =                  N/A
              le_mean =     -16.905803445298
             les_mean =     286.135962222550
             stat err =       0.000456145632
             autocorr =       1.261894129206
              std dev =       0.574258005056
             le_variance =       0.329772256371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763817368
                                         uncertainty =       0.003420012384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763817368
                                         uncertainty =       0.003420012384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406061749
  error estimate for blocks of size 2^( 2) =       0.000418638741
  error estimate for blocks of size 2^( 3) =       0.000431230912
  error estimate for blocks of size 2^( 4) =       0.000443594911
  error estimate for blocks of size 2^( 5) =       0.000453697250
  error estimate for blocks of size 2^( 6) =       0.000461212332
  error estimate for blocks of size 2^( 7) =       0.000466078139

      target function =                  N/A
              le_mean =     -16.905803445400
             les_mean =     286.135962257733
             stat err =       0.000456145658
             autocorr =       1.261894152916
              std dev =       0.574258032694
             le_variance =       0.329772288114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763801468
                                         uncertainty =       0.003420012126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763801468
                                         uncertainty =       0.003420012126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406061739
  error estimate for blocks of size 2^( 2) =       0.000418638731
  error estimate for blocks of size 2^( 3) =       0.000431230902
  error estimate for blocks of size 2^( 4) =       0.000443594900
  error estimate for blocks of size 2^( 5) =       0.000453697237
  error estimate for blocks of size 2^( 6) =       0.000461212318
  error estimate for blocks of size 2^( 7) =       0.000466078124

      target function =                  N/A
              le_mean =     -16.905803445349
             les_mean =     286.135962240159
             stat err =       0.000456145645
             autocorr =       1.261894141053
              std dev =       0.574258018892
             le_variance =       0.329772272262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763787522
                                         uncertainty =       0.003420011900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763787522
                                         uncertainty =       0.003420011900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406061731
  error estimate for blocks of size 2^( 2) =       0.000418638723
  error estimate for blocks of size 2^( 3) =       0.000431230892
  error estimate for blocks of size 2^( 4) =       0.000443594890
  error estimate for blocks of size 2^( 5) =       0.000453697226
  error estimate for blocks of size 2^( 6) =       0.000461212306
  error estimate for blocks of size 2^( 7) =       0.000466078111

      target function =                  N/A
              le_mean =     -16.905803445305
             les_mean =     286.135962224752
             stat err =       0.000456145633
             autocorr =       1.261894130689
              std dev =       0.574258006786
             le_variance =       0.329772258358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905803445298        initial
     5.6843e+02     5.6843e+03             3.3077e-07       -16.905803445400  <--
     2.2737e+03     2.2737e+04             8.2701e-08       -16.905803445349
     9.0949e+03     9.0949e+04             2.0676e-08       -16.905803445305

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 3.0330e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.940446e-01 1 1  ON 0
 uu_1                 1.271355e-01 1 1  ON 1
 uu_2                 2.536593e-02 1 1  ON 2
 uu_3                -3.754534e-02 1 1  ON 3
 uu_4                -8.367464e-02 1 1  ON 4
 uu_5                -1.196091e-01 1 1  ON 5
 uu_6                -1.485003e-01 1 1  ON 6
 uu_7                -1.640987e-01 1 1  ON 7
 uu_8                -1.561811e-01 1 1  ON 8
 uu_9                -1.292966e-01 1 1  ON 9
 ud_0                 4.558644e-01 1 1  ON 10
 ud_1                 1.904529e-01 1 1  ON 11
 ud_2                 7.064939e-02 1 1  ON 12
 ud_3                -3.578565e-04 1 1  ON 13
 ud_4                -5.819431e-02 1 1  ON 14
 ud_5                -1.010000e-01 1 1  ON 15
 ud_6                -1.294227e-01 1 1  ON 16
 ud_7                -1.475766e-01 1 1  ON 17
 ud_8                -1.500123e-01 1 1  ON 18
 ud_9                -1.420256e-01 1 1  ON 19
 eO_0                -7.055351e-01 1 1  ON 20
 eO_1                -3.850633e-01 1 1  ON 21
 eO_2                 2.874596e-02 1 1  ON 22
 eO_3                 3.441143e-01 1 1  ON 23
 eO_4                 5.686553e-01 1 1  ON 24
 eO_5                 5.258465e-01 1 1  ON 25
 eO_6                 2.820701e-01 1 1  ON 26
 eO_7                -6.509903e-02 1 1  ON 27
 eO_8                -3.291275e-01 1 1  ON 28
 eO_9                -2.260692e-01 1 1  ON 29
eH1_0                -2.929930e-01 1 1  ON 30
eH1_1                -1.888775e-01 1 1  ON 31
eH1_2                -1.404879e-01 1 1  ON 32
eH1_3                -8.512666e-02 1 1  ON 33
eH1_4                -3.494199e-02 1 1  ON 34
eH1_5                 4.465564e-03 1 1  ON 35
eH1_6                 7.327543e-02 1 1  ON 36
eH1_7                 1.571884e-01 1 1  ON 37
eH1_8                 2.281117e-01 1 1  ON 38
eH1_9                 2.117595e-01 1 1  ON 39
eH2_0                -2.909233e-01 1 1  ON 40
eH2_1                -1.871877e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330212e-02 1 1  ON 43
eH2_4                -3.324833e-02 1 1  ON 44
eH2_5                 5.756512e-03 1 1  ON 45
eH2_6                 7.515030e-02 1 1  ON 46
eH2_7                 1.575640e-01 1 1  ON 47
eH2_8                 2.245684e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9615
    reference variance = 0.197799
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3067e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330708835014
                                         uncertainty =       0.003623507041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330708835014
                                         uncertainty =       0.003623507041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406615517
  error estimate for blocks of size 2^( 2) =       0.000419205289
  error estimate for blocks of size 2^( 3) =       0.000432197668
  error estimate for blocks of size 2^( 4) =       0.000445220871
  error estimate for blocks of size 2^( 5) =       0.000456390456
  error estimate for blocks of size 2^( 6) =       0.000463543981
  error estimate for blocks of size 2^( 7) =       0.000468692950

      target function =                  N/A
              le_mean =     -16.906711979204
             les_mean =     286.167582139372
             stat err =       0.000458462064
             autocorr =       1.271273271953
              std dev =       0.575041178474
             le_variance =       0.330672356941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690671197920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906711979204       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711979958       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711978634       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711978153       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711979617       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711982149       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711981196       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711981633       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+02 is 1.234552e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906711979204       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711979393       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711979060       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711978940       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711979306       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711979939       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711979702       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711979811       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 3.087224e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906711979204       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906711979251       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906711979168       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906711979137       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906711979230       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906711979388       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906711979325       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906711979362       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 7.718588e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6085e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.940448e-01 1 1  ON 0
 uu_1                 1.271356e-01 1 1  ON 1
 uu_2                 2.536578e-02 1 1  ON 2
 uu_3                -3.754528e-02 1 1  ON 3
 uu_4                -8.367460e-02 1 1  ON 4
 uu_5                -1.196091e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640984e-01 1 1  ON 7
 uu_8                -1.561812e-01 1 1  ON 8
 uu_9                -1.292969e-01 1 1  ON 9
 ud_0                 4.558645e-01 1 1  ON 10
 ud_1                 1.904531e-01 1 1  ON 11
 ud_2                 7.064953e-02 1 1  ON 12
 ud_3                -3.575715e-04 1 1  ON 13
 ud_4                -5.819432e-02 1 1  ON 14
 ud_5                -1.009999e-01 1 1  ON 15
 ud_6                -1.294228e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500125e-01 1 1  ON 18
 ud_9                -1.420259e-01 1 1  ON 19
 eO_0                -7.055349e-01 1 1  ON 20
 eO_1                -3.850632e-01 1 1  ON 21
 eO_2                 2.874601e-02 1 1  ON 22
 eO_3                 3.441144e-01 1 1  ON 23
 eO_4                 5.686552e-01 1 1  ON 24
 eO_5                 5.258464e-01 1 1  ON 25
 eO_6                 2.820702e-01 1 1  ON 26
 eO_7                -6.509888e-02 1 1  ON 27
 eO_8                -3.291277e-01 1 1  ON 28
 eO_9                -2.260694e-01 1 1  ON 29
eH1_0                -2.929931e-01 1 1  ON 30
eH1_1                -1.888775e-01 1 1  ON 31
eH1_2                -1.404879e-01 1 1  ON 32
eH1_3                -8.512664e-02 1 1  ON 33
eH1_4                -3.494193e-02 1 1  ON 34
eH1_5                 4.465619e-03 1 1  ON 35
eH1_6                 7.327550e-02 1 1  ON 36
eH1_7                 1.571883e-01 1 1  ON 37
eH1_8                 2.281116e-01 1 1  ON 38
eH1_9                 2.117596e-01 1 1  ON 39
eH2_0                -2.909233e-01 1 1  ON 40
eH2_1                -1.871875e-01 1 1  ON 41
eH2_2                -1.389005e-01 1 1  ON 42
eH2_3                -8.330222e-02 1 1  ON 43
eH2_4                -3.324827e-02 1 1  ON 44
eH2_5                 5.756527e-03 1 1  ON 45
eH2_6                 7.515002e-02 1 1  ON 46
eH2_7                 1.575641e-01 1 1  ON 47
eH2_8                 2.245684e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.861
    reference variance = 0.161924
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3653e-01
  Total weights = 2.0000e+06
  Execution time = 1.8824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585651112
                                         uncertainty =       0.003260335502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585651112
                                         uncertainty =       0.003260335502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410203383
  error estimate for blocks of size 2^( 2) =       0.000423185470
  error estimate for blocks of size 2^( 3) =       0.000436011807
  error estimate for blocks of size 2^( 4) =       0.000448038710
  error estimate for blocks of size 2^( 5) =       0.000458136329
  error estimate for blocks of size 2^( 6) =       0.000464139629
  error estimate for blocks of size 2^( 7) =       0.000469427476

      target function =                  N/A
              le_mean =     -16.906493116101
             les_mean =     286.166042946705
             stat err =       0.000459935536
             autocorr =       1.257174193272
              std dev =       0.580115187003
             le_variance =       0.336533630192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585838342
                                         uncertainty =       0.003260342275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585838342
                                         uncertainty =       0.003260342275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410203497
  error estimate for blocks of size 2^( 2) =       0.000423185581
  error estimate for blocks of size 2^( 3) =       0.000436011919
  error estimate for blocks of size 2^( 4) =       0.000448038822
  error estimate for blocks of size 2^( 5) =       0.000458136449
  error estimate for blocks of size 2^( 6) =       0.000464139802
  error estimate for blocks of size 2^( 7) =       0.000469427660

      target function =                  N/A
              le_mean =     -16.906493124564
             les_mean =     286.166043420281
             stat err =       0.000459935683
             autocorr =       1.257174297403
              std dev =       0.580115348539
             le_variance =       0.336533817611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585745194
                                         uncertainty =       0.003260338900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585745194
                                         uncertainty =       0.003260338900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410203440
  error estimate for blocks of size 2^( 2) =       0.000423185526
  error estimate for blocks of size 2^( 3) =       0.000436011863
  error estimate for blocks of size 2^( 4) =       0.000448038766
  error estimate for blocks of size 2^( 5) =       0.000458136390
  error estimate for blocks of size 2^( 6) =       0.000464139716
  error estimate for blocks of size 2^( 7) =       0.000469427569

      target function =                  N/A
              le_mean =     -16.906493120343
             les_mean =     286.166043184309
             stat err =       0.000459935610
             autocorr =       1.257174245166
              std dev =       0.580115268174
             le_variance =       0.336533724369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585662886
                                         uncertainty =       0.003260335927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585662886
                                         uncertainty =       0.003260335927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410203390
  error estimate for blocks of size 2^( 2) =       0.000423185477
  error estimate for blocks of size 2^( 3) =       0.000436011814
  error estimate for blocks of size 2^( 4) =       0.000448038717
  error estimate for blocks of size 2^( 5) =       0.000458136337
  error estimate for blocks of size 2^( 6) =       0.000464139640
  error estimate for blocks of size 2^( 7) =       0.000469427488

      target function =                  N/A
              le_mean =     -16.906493116632
             les_mean =     286.166042976425
             stat err =       0.000459935546
             autocorr =       1.257174199744
              std dev =       0.580115197161
             le_variance =       0.336533641978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906493116101        initial
     1.4211e+02     1.4211e+03             1.2346e-06       -16.906493124564  <--
     5.6843e+02     5.6843e+03             3.0872e-07       -16.906493120343
     2.2737e+03     2.2737e+04             7.7186e-08       -16.906493116632

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 2.9883e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.940456e-01 1 1  ON 0
 uu_1                 1.271358e-01 1 1  ON 1
 uu_2                 2.536534e-02 1 1  ON 2
 uu_3                -3.754511e-02 1 1  ON 3
 uu_4                -8.367447e-02 1 1  ON 4
 uu_5                -1.196093e-01 1 1  ON 5
 uu_6                -1.485004e-01 1 1  ON 6
 uu_7                -1.640976e-01 1 1  ON 7
 uu_8                -1.561815e-01 1 1  ON 8
 uu_9                -1.292976e-01 1 1  ON 9
 ud_0                 4.558648e-01 1 1  ON 10
 ud_1                 1.904536e-01 1 1  ON 11
 ud_2                 7.064995e-02 1 1  ON 12
 ud_3                -3.567183e-04 1 1  ON 13
 ud_4                -5.819436e-02 1 1  ON 14
 ud_5                -1.009994e-01 1 1  ON 15
 ud_6                -1.294231e-01 1 1  ON 16
 ud_7                -1.475762e-01 1 1  ON 17
 ud_8                -1.500131e-01 1 1  ON 18
 ud_9                -1.420268e-01 1 1  ON 19
 eO_0                -7.055343e-01 1 1  ON 20
 eO_1                -3.850631e-01 1 1  ON 21
 eO_2                 2.874616e-02 1 1  ON 22
 eO_3                 3.441148e-01 1 1  ON 23
 eO_4                 5.686550e-01 1 1  ON 24
 eO_5                 5.258462e-01 1 1  ON 25
 eO_6                 2.820705e-01 1 1  ON 26
 eO_7                -6.509844e-02 1 1  ON 27
 eO_8                -3.291282e-01 1 1  ON 28
 eO_9                -2.260702e-01 1 1  ON 29
eH1_0                -2.929934e-01 1 1  ON 30
eH1_1                -1.888776e-01 1 1  ON 31
eH1_2                -1.404879e-01 1 1  ON 32
eH1_3                -8.512658e-02 1 1  ON 33
eH1_4                -3.494175e-02 1 1  ON 34
eH1_5                 4.465787e-03 1 1  ON 35
eH1_6                 7.327569e-02 1 1  ON 36
eH1_7                 1.571880e-01 1 1  ON 37
eH1_8                 2.281115e-01 1 1  ON 38
eH1_9                 2.117598e-01 1 1  ON 39
eH2_0                -2.909233e-01 1 1  ON 40
eH2_1                -1.871870e-01 1 1  ON 41
eH2_2                -1.389003e-01 1 1  ON 42
eH2_3                -8.330253e-02 1 1  ON 43
eH2_4                -3.324809e-02 1 1  ON 44
eH2_5                 5.756572e-03 1 1  ON 45
eH2_6                 7.514920e-02 1 1  ON 46
eH2_7                 1.575641e-01 1 1  ON 47
eH2_8                 2.245687e-01 1 1  ON 48
eH2_9                 2.366642e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8644
    reference variance = 0.26394
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4033e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340205778129
                                         uncertainty =       0.003740194288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340205778129
                                         uncertainty =       0.003740194288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412512861
  error estimate for blocks of size 2^( 2) =       0.000425362233
  error estimate for blocks of size 2^( 3) =       0.000437904710
  error estimate for blocks of size 2^( 4) =       0.000449767267
  error estimate for blocks of size 2^( 5) =       0.000459173774
  error estimate for blocks of size 2^( 6) =       0.000464703362
  error estimate for blocks of size 2^( 7) =       0.000467181604

      target function =                  N/A
              le_mean =     -16.906365308502
             les_mean =     286.165521495412
             stat err =       0.000460206502
             autocorr =       1.244602054005
              std dev =       0.583381282738
             le_variance =       0.340333721049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636530850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365308502       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365307067       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365308366       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365314180       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365322545       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365338488       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365330227       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.5527e+01 is 4.906765e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365308502       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365308143       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365308466       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365309916       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365312003       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365316014       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365313946       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+02 is 1.227751e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365308502       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365308412       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365308493       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365308855       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365309377       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365310381       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365309864       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 3.070033e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103272 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6285e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.940461e-01 1 1  ON 0
 uu_1                 1.271364e-01 1 1  ON 1
 uu_2                 2.536536e-02 1 1  ON 2
 uu_3                -3.754475e-02 1 1  ON 3
 uu_4                -8.367427e-02 1 1  ON 4
 uu_5                -1.196089e-01 1 1  ON 5
 uu_6                -1.485008e-01 1 1  ON 6
 uu_7                -1.640981e-01 1 1  ON 7
 uu_8                -1.561828e-01 1 1  ON 8
 uu_9                -1.292980e-01 1 1  ON 9
 ud_0                 4.558649e-01 1 1  ON 10
 ud_1                 1.904542e-01 1 1  ON 11
 ud_2                 7.065027e-02 1 1  ON 12
 ud_3                -3.566191e-04 1 1  ON 13
 ud_4                -5.819485e-02 1 1  ON 14
 ud_5                -1.009990e-01 1 1  ON 15
 ud_6                -1.294232e-01 1 1  ON 16
 ud_7                -1.475765e-01 1 1  ON 17
 ud_8                -1.500134e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055341e-01 1 1  ON 20
 eO_1                -3.850635e-01 1 1  ON 21
 eO_2                 2.874670e-02 1 1  ON 22
 eO_3                 3.441153e-01 1 1  ON 23
 eO_4                 5.686554e-01 1 1  ON 24
 eO_5                 5.258463e-01 1 1  ON 25
 eO_6                 2.820707e-01 1 1  ON 26
 eO_7                -6.509853e-02 1 1  ON 27
 eO_8                -3.291289e-01 1 1  ON 28
 eO_9                -2.260709e-01 1 1  ON 29
eH1_0                -2.929937e-01 1 1  ON 30
eH1_1                -1.888782e-01 1 1  ON 31
eH1_2                -1.404880e-01 1 1  ON 32
eH1_3                -8.512662e-02 1 1  ON 33
eH1_4                -3.494096e-02 1 1  ON 34
eH1_5                 4.465459e-03 1 1  ON 35
eH1_6                 7.327549e-02 1 1  ON 36
eH1_7                 1.571882e-01 1 1  ON 37
eH1_8                 2.281113e-01 1 1  ON 38
eH1_9                 2.117601e-01 1 1  ON 39
eH2_0                -2.909245e-01 1 1  ON 40
eH2_1                -1.871878e-01 1 1  ON 41
eH2_2                -1.389003e-01 1 1  ON 42
eH2_3                -8.330297e-02 1 1  ON 43
eH2_4                -3.324790e-02 1 1  ON 44
eH2_5                 5.756918e-03 1 1  ON 45
eH2_6                 7.514973e-02 1 1  ON 46
eH2_7                 1.575647e-01 1 1  ON 47
eH2_8                 2.245691e-01 1 1  ON 48
eH2_9                 2.366644e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.214735
====================================================
  Execution time = 2.2359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.0000e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506834753
                                         uncertainty =       0.003106081149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506834753
                                         uncertainty =       0.003106081149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411375728
  error estimate for blocks of size 2^( 2) =       0.000424186654
  error estimate for blocks of size 2^( 3) =       0.000436905596
  error estimate for blocks of size 2^( 4) =       0.000448354016
  error estimate for blocks of size 2^( 5) =       0.000459044273
  error estimate for blocks of size 2^( 6) =       0.000466602958
  error estimate for blocks of size 2^( 7) =       0.000474485973

      target function =                  N/A
              le_mean =     -16.905946383680
             les_mean =     286.149482938231
             stat err =       0.000462121805
             autocorr =       1.261930955290
              std dev =       0.581773134129
             le_variance =       0.338459979594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506008949
                                         uncertainty =       0.003106068390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506008949
                                         uncertainty =       0.003106068390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411375226
  error estimate for blocks of size 2^( 2) =       0.000424186179
  error estimate for blocks of size 2^( 3) =       0.000436905125
  error estimate for blocks of size 2^( 4) =       0.000448353563
  error estimate for blocks of size 2^( 5) =       0.000459043828
  error estimate for blocks of size 2^( 6) =       0.000466602609
  error estimate for blocks of size 2^( 7) =       0.000474485702

      target function =                  N/A
              le_mean =     -16.905946406289
             les_mean =     286.149482876292
             stat err =       0.000462121426
             autocorr =       1.261931964056
              std dev =       0.581772423889
             le_variance =       0.338459153197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506417948
                                         uncertainty =       0.003106074733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506417948
                                         uncertainty =       0.003106074733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411375475
  error estimate for blocks of size 2^( 2) =       0.000424186414
  error estimate for blocks of size 2^( 3) =       0.000436905358
  error estimate for blocks of size 2^( 4) =       0.000448353788
  error estimate for blocks of size 2^( 5) =       0.000459044049
  error estimate for blocks of size 2^( 6) =       0.000466602782
  error estimate for blocks of size 2^( 7) =       0.000474485836

      target function =                  N/A
              le_mean =     -16.905946395067
             les_mean =     286.149482906124
             stat err =       0.000462121613
             autocorr =       1.261931463849
              std dev =       0.581772775651
             le_variance =       0.338459562489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506782525
                                         uncertainty =       0.003106080346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338506782525
                                         uncertainty =       0.003106080346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411375696
  error estimate for blocks of size 2^( 2) =       0.000424186624
  error estimate for blocks of size 2^( 3) =       0.000436905566
  error estimate for blocks of size 2^( 4) =       0.000448353987
  error estimate for blocks of size 2^( 5) =       0.000459044245
  error estimate for blocks of size 2^( 6) =       0.000466602936
  error estimate for blocks of size 2^( 7) =       0.000474485955

      target function =                  N/A
              le_mean =     -16.905946385105
             les_mean =     286.149482934144
             stat err =       0.000462121781
             autocorr =       1.261931018988
              std dev =       0.581773089209
             le_variance =       0.338459927328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905946383680        initial
     3.5527e+01     3.5527e+02             4.9068e-06       -16.905946406289  <--
     1.4211e+02     1.4211e+03             1.2278e-06       -16.905946395067
     5.6843e+02     5.6843e+03             3.0700e-07       -16.905946385105

*****************************************************************************
Applying the update for shift_i =   3.5527e+01     and shift_s =   3.5527e+02
*****************************************************************************

  Execution time = 3.1845e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.940475e-01 1 1  ON 0
 uu_1                 1.271382e-01 1 1  ON 1
 uu_2                 2.536545e-02 1 1  ON 2
 uu_3                -3.754366e-02 1 1  ON 3
 uu_4                -8.367364e-02 1 1  ON 4
 uu_5                -1.196077e-01 1 1  ON 5
 uu_6                -1.485018e-01 1 1  ON 6
 uu_7                -1.640998e-01 1 1  ON 7
 uu_8                -1.561864e-01 1 1  ON 8
 uu_9                -1.292992e-01 1 1  ON 9
 ud_0                 4.558652e-01 1 1  ON 10
 ud_1                 1.904559e-01 1 1  ON 11
 ud_2                 7.065126e-02 1 1  ON 12
 ud_3                -3.563254e-04 1 1  ON 13
 ud_4                -5.819627e-02 1 1  ON 14
 ud_5                -1.009977e-01 1 1  ON 15
 ud_6                -1.294233e-01 1 1  ON 16
 ud_7                -1.475775e-01 1 1  ON 17
 ud_8                -1.500142e-01 1 1  ON 18
 ud_9                -1.420269e-01 1 1  ON 19
 eO_0                -7.055337e-01 1 1  ON 20
 eO_1                -3.850645e-01 1 1  ON 21
 eO_2                 2.874833e-02 1 1  ON 22
 eO_3                 3.441169e-01 1 1  ON 23
 eO_4                 5.686567e-01 1 1  ON 24
 eO_5                 5.258466e-01 1 1  ON 25
 eO_6                 2.820716e-01 1 1  ON 26
 eO_7                -6.509880e-02 1 1  ON 27
 eO_8                -3.291310e-01 1 1  ON 28
 eO_9                -2.260732e-01 1 1  ON 29
eH1_0                -2.929949e-01 1 1  ON 30
eH1_1                -1.888800e-01 1 1  ON 31
eH1_2                -1.404881e-01 1 1  ON 32
eH1_3                -8.512674e-02 1 1  ON 33
eH1_4                -3.493859e-02 1 1  ON 34
eH1_5                 4.464480e-03 1 1  ON 35
eH1_6                 7.327490e-02 1 1  ON 36
eH1_7                 1.571889e-01 1 1  ON 37
eH1_8                 2.281110e-01 1 1  ON 38
eH1_9                 2.117609e-01 1 1  ON 39
eH2_0                -2.909279e-01 1 1  ON 40
eH2_1                -1.871901e-01 1 1  ON 41
eH2_2                -1.389004e-01 1 1  ON 42
eH2_3                -8.330426e-02 1 1  ON 43
eH2_4                -3.324735e-02 1 1  ON 44
eH2_5                 5.757959e-03 1 1  ON 45
eH2_6                 7.515133e-02 1 1  ON 46
eH2_7                 1.575663e-01 1 1  ON 47
eH2_8                 2.245705e-01 1 1  ON 48
eH2_9                 2.366648e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8135e+01 secs
  Total Execution time = 2.2705e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
